/*! For license information please see showcase.js.LICENSE */
!function(t){function e(e){for(var n,r,o=e[0],a=e[1],s=0,c=[];s<o.length;s++)r=o[s],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&c.push(i[r][0]),i[r]=0;for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a[n]);for(u&&u(e);c.length;)c.shift()()}var n={},r={7:0},i={7:0};function o(e){if(n[e])return n[e].exports;var r=n[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.e=function(t){var e=[];r[t]?e.push(r[t]):0!==r[t]&&{0:1,1:1,2:1}[t]&&e.push(r[t]=new Promise((function(e,n){for(var r="css/"+({0:"core~ws-gui",1:"vendors~core~ws-gui",2:"core",3:"encoders",4:"helpers",5:"polyfill-fetch",6:"sdkBindings",8:"vendors~control-kit",9:"vendors~vr"}[t]||t)+".css",i=o.p+r,a=document.getElementsByTagName("link"),s=0;s<a.length;s++){var c=(l=a[s]).getAttribute("data-href")||l.getAttribute("href");if("stylesheet"===l.rel&&(c===r||c===i))return e()}var u=document.getElementsByTagName("style");for(s=0;s<u.length;s++){var l;if((c=(l=u[s]).getAttribute("data-href"))===r||c===i)return e()}var h=document.createElement("link");h.rel="stylesheet",h.type="text/css",h.onload=e,h.onerror=function(e){var r=e&&e.target&&e.target.src||i,o=new Error("Loading CSS chunk "+t+" failed.\n("+r+")");o.request=r,n(o)},h.href=i,document.getElementsByTagName("head")[0].appendChild(h)})).then((function(){r[t]=0})));var n=i[t];if(0!==n)if(n)e.push(n[2]);else{var a=new Promise((function(e,r){n=i[t]=[e,r]}));e.push(n[2]=a);var s,c=document.createElement("script");c.charset="utf-8",c.timeout=120,o.nc&&c.setAttribute("nonce",o.nc),c.src=function(t){return o.p+"js/"+t+".js"}(t);var u=new Error;s=function(e){c.onerror=c.onload=null,clearTimeout(l);var n=i[t];if(0!==n){if(n){var r=e&&("load"===e.type?"missing":e.type),o=e&&e.target&&e.target.src;u.message="Loading chunk "+t+" failed.\n("+r+": "+o+")",u.name="ChunkLoadError",u.type=r,u.request=o,n[1](u)}i[t]=void 0}};var l=setTimeout((function(){s({type:"timeout",target:c})}),12e4);c.onerror=c.onload=s,document.head.appendChild(c)}return Promise.all(e)},o.m=t,o.c=n,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o.oe=function(t){throw console.error(t),t};var a=window.webpackJsonp=window.webpackJsonp||[],s=a.push.bind(a);a.push=e,a=a.slice();for(var c=0;c<a.length;c++)e(a[c]);var u=s;o(o.s=945)}([function(t,e,n){"use strict";var r;function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?c(t):e}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}n.d(e,"a",(function(){return v})),n.d(e,"b",(function(){return rt})),n.d(e,"c",(function(){return cc})),n.d(e,"d",(function(){return bo})),n.d(e,"e",(function(){return Bl})),n.d(e,"f",(function(){return p})),n.d(e,"g",(function(){return Qo})),n.d(e,"h",(function(){return Oe})),n.d(e,"i",(function(){return Il})),n.d(e,"j",(function(){return ar})),n.d(e,"k",(function(){return or})),n.d(e,"l",(function(){return dn})),n.d(e,"m",(function(){return In})),n.d(e,"n",(function(){return Y})),n.d(e,"o",(function(){return hr})),n.d(e,"p",(function(){return Al})),n.d(e,"q",(function(){return Dc})),n.d(e,"r",(function(){return k})),n.d(e,"s",(function(){return on})),n.d(e,"t",(function(){return jr})),n.d(e,"u",(function(){return yr})),n.d(e,"v",(function(){return tu})),n.d(e,"w",(function(){return d})),n.d(e,"x",(function(){return O})),n.d(e,"y",(function(){return D})),n.d(e,"z",(function(){return Tt})),n.d(e,"A",(function(){return Zt})),n.d(e,"B",(function(){return Mt})),n.d(e,"C",(function(){return un})),n.d(e,"D",(function(){return yc})),n.d(e,"E",(function(){return xn})),n.d(e,"F",(function(){return Z})),n.d(e,"G",(function(){return f})),n.d(e,"H",(function(){return gr})),n.d(e,"I",(function(){return ir})),n.d(e,"J",(function(){return wo})),n.d(e,"K",(function(){return $})),n.d(e,"L",(function(){return ou})),n.d(e,"M",(function(){return tl})),n.d(e,"N",(function(){return K})),n.d(e,"O",(function(){return Mo})),n.d(e,"P",(function(){return Oo})),n.d(e,"Q",(function(){return Ks})),n.d(e,"R",(function(){return gt})),n.d(e,"S",(function(){return bt})),n.d(e,"T",(function(){return ua})),n.d(e,"U",(function(){return cl})),n.d(e,"V",(function(){return ra})),n.d(e,"W",(function(){return pa})),n.d(e,"X",(function(){return fa})),n.d(e,"Y",(function(){return z})),n.d(e,"Z",(function(){return W})),n.d(e,"ab",(function(){return H})),n.d(e,"bb",(function(){return V})),n.d(e,"cb",(function(){return G})),n.d(e,"db",(function(){return pc})),n.d(e,"eb",(function(){return iu})),n.d(e,"fb",(function(){return st})),n.d(e,"gb",(function(){return at})),n.d(e,"hb",(function(){return hn})),n.d(e,"ib",(function(){return At})),n.d(e,"jb",(function(){return Xt})),n.d(e,"kb",(function(){return _})),n.d(e,"lb",(function(){return Qn})),n.d(e,"mb",(function(){return fn})),n.d(e,"nb",(function(){return zs})),n.d(e,"ob",(function(){return Us})),n.d(e,"pb",(function(){return w})),n.d(e,"qb",(function(){return L})),n.d(e,"rb",(function(){return N})),n.d(e,"sb",(function(){return U})),n.d(e,"tb",(function(){return B})),n.d(e,"ub",(function(){return F})),n.d(e,"vb",(function(){return j})),n.d(e,"wb",(function(){return y})),n.d(e,"xb",(function(){return m})),n.d(e,"yb",(function(){return rc})),n.d(e,"zb",(function(){return pe})),n.d(e,"Ab",(function(){return S})),n.d(e,"Bb",(function(){return A})),n.d(e,"Cb",(function(){return R})),n.d(e,"Db",(function(){return P})),n.d(e,"Eb",(function(){return M})),n.d(e,"Fb",(function(){return Zc})),n.d(e,"Gb",(function(){return fr})),n.d(e,"Hb",(function(){return He})),n.d(e,"Ib",(function(){return Sr})),n.d(e,"Jb",(function(){return xr})),n.d(e,"Kb",(function(){return Qc})),n.d(e,"Lb",(function(){return ba})),n.d(e,"Mb",(function(){return da})),n.d(e,"Nb",(function(){return Ku})),n.d(e,"Ob",(function(){return Fc})),n.d(e,"Pb",(function(){return Bt})),n.d(e,"Qb",(function(){return oc})),n.d(e,"Rb",(function(){return ot})),n.d(e,"Sb",(function(){return mt})),n.d(e,"Tb",(function(){return yt})),n.d(e,"Ub",(function(){return lt})),n.d(e,"Vb",(function(){return ht})),n.d(e,"Wb",(function(){return ft})),n.d(e,"Xb",(function(){return it})),n.d(e,"Yb",(function(){return vt})),n.d(e,"Zb",(function(){return dt})),n.d(e,"ac",(function(){return pt})),n.d(e,"bc",(function(){return ut})),n.d(e,"cc",(function(){return Fs})),n.d(e,"dc",(function(){return Fe})),n.d(e,"ec",(function(){return el})),n.d(e,"fc",(function(){return I})),n.d(e,"gc",(function(){return b})),n.d(e,"hc",(function(){return de})),n.d(e,"ic",(function(){return lr})),n.d(e,"jc",(function(){return J})),n.d(e,"kc",(function(){return Ko})),n.d(e,"lc",(function(){return Yo})),n.d(e,"mc",(function(){return Re})),n.d(e,"nc",(function(){return xs})),n.d(e,"oc",(function(){return _s})),n.d(e,"pc",(function(){return Xc})),n.d(e,"qc",(function(){return E})),n.d(e,"rc",(function(){return C})),n.d(e,"sc",(function(){return T})),n.d(e,"tc",(function(){return g})),n.d(e,"uc",(function(){return St})),n.d(e,"vc",(function(){return kt})),n.d(e,"wc",(function(){return _c})),n.d(e,"xc",(function(){return tn})),n.d(e,"yc",(function(){return _t})),n.d(e,"zc",(function(){return wt})),n.d(e,"Ac",(function(){return br})),n.d(e,"Bc",(function(){return ur})),n.d(e,"Cc",(function(){return q})),n.d(e,"Dc",(function(){return Q})),n.d(e,"Ec",(function(){return tt})),n.d(e,"Fc",(function(){return et})),n.d(e,"Gc",(function(){return nt})),n.d(e,"Hc",(function(){return X})),n.d(e,"Ic",(function(){return Dt})),n.d(e,"Jc",(function(){return zt})),n.d(e,"Kc",(function(){return Lt})),n.d(e,"Lc",(function(){return sc})),n.d(e,"Mc",(function(){return dr})),n.d(e,"Nc",(function(){return Nt})),n.d(e,"Oc",(function(){return xo})),n.d(e,"Pc",(function(){return Ma})),n.d(e,"Qc",(function(){return x})),n.d(e,"Rc",(function(){return xt})),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),void 0===Math.sign&&(Math.sign=function(t){return t<0?-1:t>0?1:+t}),"name"in Function.prototype==!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e});var f=0,p=1,d=2,y=0,m=1,v=100,g=101,b=102,w=103,_=104,x=200,S=201,T=202,M=203,E=204,P=205,O=206,A=207,D=208,R=209,C=210,I=1e3,k=1001,L=1002,N=1003,j=1004,B=1004,F=1005,U=1005,z=1006,G=1007,H=1007,V=1008,W=1008,q=1009,Y=1010,J=1011,X=1012,K=1013,Q=1014,Z=1015,$=1016,tt=1017,et=1018,nt=1019,rt=1021,it=1022,ot=1023,at=1024,st=1025,ct=ot,ut=33776,lt=33777,ht=33778,ft=33779,pt=35840,dt=35841,yt=35842,mt=35843,vt=36196,gt=2300,bt=2301,wt=1,_t=2,xt=3001,St=0,Tt=35048;function Mt(){}Object.assign(Mt.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)},removeEventListener:function(t,e){if(void 0!==this._listeners){var n=this._listeners[t];if(void 0!==n){var r=n.indexOf(e);-1!==r&&n.splice(r,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var n=e.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,t)}}}});for(var Et=[],Pt=0;Pt<256;Pt++)Et[Pt]=(Pt<16?"0":"")+Pt.toString(16);var Ot,At={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(Et[255&t]+Et[t>>8&255]+Et[t>>16&255]+Et[t>>24&255]+"-"+Et[255&e]+Et[e>>8&255]+"-"+Et[e>>16&15|64]+Et[e>>24&255]+"-"+Et[63&n|128]+Et[n>>8&255]+"-"+Et[n>>16&255]+Et[n>>24&255]+Et[255&r]+Et[r>>8&255]+Et[r>>16&255]+Et[r>>24&255]).toUpperCase()},clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,r,i){return r+(t-e)*(i-r)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*At.DEG2RAD},radToDeg:function(t){return t*At.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,n,r,i){var o=Math.cos,a=Math.sin,s=o(n/2),c=a(n/2),u=o((e+r)/2),l=a((e+r)/2),h=o((e-r)/2),f=a((e-r)/2),p=o((r-e)/2),d=a((r-e)/2);"XYX"===i?t.set(s*l,c*h,c*f,s*u):"YZY"===i?t.set(c*f,s*l,c*h,s*u):"ZXZ"===i?t.set(c*h,c*f,s*l,s*u):"XZX"===i?t.set(s*l,c*d,c*p,s*u):"YXY"===i?t.set(c*p,s*l,c*d,s*u):"ZYZ"===i?t.set(c*d,c*p,s*l,s*u):console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order.")}};function Dt(t,e){this.x=t||0,this.y=e||0}function Rt(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.defineProperties(Dt.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(Dt.prototype,{isVector2:!0,set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var e=this.x,n=this.y,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6],this.y=r[1]*e+r[4]*n+r[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var t=Math.atan2(-this.y,-this.x)+Math.PI;return t},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y;return e*e+n*n},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this},rotateAround:function(t,e){var n=Math.cos(e),r=Math.sin(e),i=this.x-t.x,o=this.y-t.y;return this.x=i*n-o*r+t.x,this.y=i*r+o*n+t.y,this}}),Object.assign(Rt.prototype,{isMatrix3:!0,set:function(t,e,n,r,i,o,a,s,c){var u=this.elements;return u[0]=t,u[1]=r,u[2]=a,u[3]=e,u[4]=i,u[5]=s,u[6]=n,u[7]=o,u[8]=c,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this},extractBasis:function(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this},setFromMatrix4:function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,r=e.elements,i=this.elements,o=n[0],a=n[3],s=n[6],c=n[1],u=n[4],l=n[7],h=n[2],f=n[5],p=n[8],d=r[0],y=r[3],m=r[6],v=r[1],g=r[4],b=r[7],w=r[2],_=r[5],x=r[8];return i[0]=o*d+a*v+s*w,i[3]=o*y+a*g+s*_,i[6]=o*m+a*b+s*x,i[1]=c*d+u*v+l*w,i[4]=c*y+u*g+l*_,i[7]=c*m+u*b+l*x,i[2]=h*d+f*v+p*w,i[5]=h*y+f*g+p*_,i[8]=h*m+f*b+p*x,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],c=t[7],u=t[8];return e*o*u-e*a*c-n*i*u+n*a*s+r*i*c-r*o*s},getInverse:function(t,e){void 0!==e&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");var n=t.elements,r=this.elements,i=n[0],o=n[1],a=n[2],s=n[3],c=n[4],u=n[5],l=n[6],h=n[7],f=n[8],p=f*c-u*h,d=u*l-f*s,y=h*s-c*l,m=i*p+o*d+a*y;if(0===m)return this.set(0,0,0,0,0,0,0,0,0);var v=1/m;return r[0]=p*v,r[1]=(a*h-f*o)*v,r[2]=(u*o-a*c)*v,r[3]=d*v,r[4]=(f*i-a*l)*v,r[5]=(a*s-u*i)*v,r[6]=y*v,r[7]=(o*l-h*i)*v,r[8]=(c*i-o*s)*v,this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},setUvTransform:function(t,e,n,r,i,o,a){var s=Math.cos(i),c=Math.sin(i);this.set(n*s,n*c,-n*(s*o+c*a)+o+t,-r*c,r*s,-r*(-c*o+s*a)+a+e,0,0,1)},scale:function(t,e){var n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this},rotate:function(t){var e=Math.cos(t),n=Math.sin(t),r=this.elements,i=r[0],o=r[3],a=r[6],s=r[1],c=r[4],u=r[7];return r[0]=e*i+n*s,r[3]=e*o+n*c,r[6]=e*a+n*u,r[1]=-n*i+e*s,r[4]=-n*o+e*c,r[7]=-n*a+e*u,this},translate:function(t,e){var n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this},equals:function(t){for(var e=this.elements,n=t.elements,r=0;r<9;r++)if(e[r]!==n[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<9;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}});var Ct={getDataURL:function(t){var e;if("undefined"==typeof HTMLCanvasElement)return t.src;if(t instanceof HTMLCanvasElement)e=t;else{void 0===Ot&&(Ot=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),Ot.width=t.width,Ot.height=t.height;var n=Ot.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=Ot}return e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}},It=0;function kt(t,e,n,r,i,o,a,s,c,u){Object.defineProperty(this,"id",{value:It++}),this.uuid=At.generateUUID(),this.name="",this.image=void 0!==t?t:kt.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:kt.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:k,this.wrapT=void 0!==r?r:k,this.magFilter=void 0!==i?i:z,this.minFilter=void 0!==o?o:V,this.anisotropy=void 0!==c?c:1,this.format=void 0!==a?a:ot,this.internalFormat=null,this.type=void 0!==s?s:q,this.offset=new Dt(0,0),this.repeat=new Dt(1,1),this.center=new Dt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Rt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==u?u:3e3,this.version=0,this.onUpdate=null}function Lt(t,e,n,r){this.x=t||0,this.y=e||0,this.z=n||0,this.w=void 0!==r?r:1}function Nt(t,e,n){this.width=t,this.height=e,this.scissor=new Lt(0,0,t,e),this.scissorTest=!1,this.viewport=new Lt(0,0,t,e),n=n||{},this.texture=new kt(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.image={},this.texture.image.width=t,this.texture.image.height=e,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:z,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function jt(t,e,n){Nt.call(this,t,e,n),this.samples=4}function Bt(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._w=void 0!==r?r:1}kt.DEFAULT_IMAGE=void 0,kt.DEFAULT_MAPPING=300,kt.prototype=Object.assign(Object.create(Mt.prototype),{constructor:kt,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){var e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var r=this.image;if(void 0===r.uuid&&(r.uuid=At.generateUUID()),!e&&void 0===t.images[r.uuid]){var i;if(Array.isArray(r)){i=[];for(var o=0,a=r.length;o<a;o++)i.push(Ct.getDataURL(r[o]))}else i=Ct.getDataURL(r);t.images[r.uuid]={uuid:r.uuid,url:i}}n.image=r.uuid}return e||(t.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case I:t.x=t.x-Math.floor(t.x);break;case k:t.x=t.x<0?0:1;break;case L:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case I:t.y=t.y-Math.floor(t.y);break;case k:t.y=t.y<0?0:1;break;case L:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}}),Object.defineProperty(kt.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.defineProperties(Lt.prototype,{width:{get:function(){return this.z},set:function(t){this.z=t}},height:{get:function(){return this.w},set:function(t){this.w=t}}}),Object.assign(Lt.prototype,{isVector4:!0,set:function(t,e,n,r){return this.x=t,this.y=e,this.z=n,this.w=r,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,n=this.y,r=this.z,i=this.w,o=t.elements;return this.x=o[0]*e+o[4]*n+o[8]*r+o[12]*i,this.y=o[1]*e+o[5]*n+o[9]*r+o[13]*i,this.z=o[2]*e+o[6]*n+o[10]*r+o[14]*i,this.w=o[3]*e+o[7]*n+o[11]*r+o[15]*i,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,n,r,i,o=t.elements,a=o[0],s=o[4],c=o[8],u=o[1],l=o[5],h=o[9],f=o[2],p=o[6],d=o[10];if(Math.abs(s-u)<.01&&Math.abs(c-f)<.01&&Math.abs(h-p)<.01){if(Math.abs(s+u)<.1&&Math.abs(c+f)<.1&&Math.abs(h+p)<.1&&Math.abs(a+l+d-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;var y=(a+1)/2,m=(l+1)/2,v=(d+1)/2,g=(s+u)/4,b=(c+f)/4,w=(h+p)/4;return y>m&&y>v?y<.01?(n=0,r=.707106781,i=.707106781):(r=g/(n=Math.sqrt(y)),i=b/n):m>v?m<.01?(n=.707106781,r=0,i=.707106781):(n=g/(r=Math.sqrt(m)),i=w/r):v<.01?(n=.707106781,r=.707106781,i=0):(n=b/(i=Math.sqrt(v)),r=w/i),this.set(n,r,i,e),this}var _=Math.sqrt((p-h)*(p-h)+(c-f)*(c-f)+(u-s)*(u-s));return Math.abs(_)<.001&&(_=1),this.x=(p-h)/_,this.y=(c-f)/_,this.z=(u-s)/_,this.w=Math.acos((a+l+d-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}}),Nt.prototype=Object.assign(Object.create(Mt.prototype),{constructor:Nt,isWebGLRenderTarget:!0,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.texture.image.width=t,this.texture.image.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),jt.prototype=Object.assign(Object.create(Nt.prototype),{constructor:jt,isWebGLMultisampleRenderTarget:!0,copy:function(t){return Nt.prototype.copy.call(this,t),this.samples=t.samples,this}}),Object.assign(Bt,{slerp:function(t,e,n,r){return n.copy(t).slerp(e,r)},slerpFlat:function(t,e,n,r,i,o,a){var s=n[r+0],c=n[r+1],u=n[r+2],l=n[r+3],h=i[o+0],f=i[o+1],p=i[o+2],d=i[o+3];if(l!==d||s!==h||c!==f||u!==p){var y=1-a,m=s*h+c*f+u*p+l*d,v=m>=0?1:-1,g=1-m*m;if(g>Number.EPSILON){var b=Math.sqrt(g),w=Math.atan2(b,m*v);y=Math.sin(y*w)/b,a=Math.sin(a*w)/b}var _=a*v;if(s=s*y+h*_,c=c*y+f*_,u=u*y+p*_,l=l*y+d*_,y===1-a){var x=1/Math.sqrt(s*s+c*c+u*u+l*l);s*=x,c*=x,u*=x,l*=x}}t[e]=s,t[e+1]=c,t[e+2]=u,t[e+3]=l}}),Object.defineProperties(Bt.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}}),Object.assign(Bt.prototype,{isQuaternion:!0,set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},setFromEuler:function(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=t._x,r=t._y,i=t._z,o=t.order,a=Math.cos,s=Math.sin,c=a(n/2),u=a(r/2),l=a(i/2),h=s(n/2),f=s(r/2),p=s(i/2);return"XYZ"===o?(this._x=h*u*l+c*f*p,this._y=c*f*l-h*u*p,this._z=c*u*p+h*f*l,this._w=c*u*l-h*f*p):"YXZ"===o?(this._x=h*u*l+c*f*p,this._y=c*f*l-h*u*p,this._z=c*u*p-h*f*l,this._w=c*u*l+h*f*p):"ZXY"===o?(this._x=h*u*l-c*f*p,this._y=c*f*l+h*u*p,this._z=c*u*p+h*f*l,this._w=c*u*l-h*f*p):"ZYX"===o?(this._x=h*u*l-c*f*p,this._y=c*f*l+h*u*p,this._z=c*u*p-h*f*l,this._w=c*u*l+h*f*p):"YZX"===o?(this._x=h*u*l+c*f*p,this._y=c*f*l+h*u*p,this._z=c*u*p-h*f*l,this._w=c*u*l-h*f*p):"XZY"===o&&(this._x=h*u*l-c*f*p,this._y=c*f*l-h*u*p,this._z=c*u*p+h*f*l,this._w=c*u*l+h*f*p),!1!==e&&this._onChangeCallback(),this},setFromAxisAngle:function(t,e){var n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this._onChangeCallback(),this},setFromRotationMatrix:function(t){var e,n=t.elements,r=n[0],i=n[4],o=n[8],a=n[1],s=n[5],c=n[9],u=n[2],l=n[6],h=n[10],f=r+s+h;return f>0?(e=.5/Math.sqrt(f+1),this._w=.25/e,this._x=(l-c)*e,this._y=(o-u)*e,this._z=(a-i)*e):r>s&&r>h?(e=2*Math.sqrt(1+r-s-h),this._w=(l-c)/e,this._x=.25*e,this._y=(i+a)/e,this._z=(o+u)/e):s>h?(e=2*Math.sqrt(1+s-r-h),this._w=(o-u)/e,this._x=(i+a)/e,this._y=.25*e,this._z=(c+l)/e):(e=2*Math.sqrt(1+h-r-s),this._w=(a-i)/e,this._x=(o+u)/e,this._y=(c+l)/e,this._z=.25*e),this._onChangeCallback(),this},setFromUnitVectors:function(t,e){var n=t.dot(e)+1;return n<1e-6?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(At.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,e){var n=this.angleTo(t);if(0===n)return this;var r=Math.min(1,e/n);return this.slerp(t,r),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var n=t._x,r=t._y,i=t._z,o=t._w,a=e._x,s=e._y,c=e._z,u=e._w;return this._x=n*u+o*a+r*c-i*s,this._y=r*u+o*s+i*a-n*c,this._z=i*u+o*c+n*s-r*a,this._w=o*u-n*a-r*s-i*c,this._onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var n=this._x,r=this._y,i=this._z,o=this._w,a=o*t._w+n*t._x+r*t._y+i*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=o,this._x=n,this._y=r,this._z=i,this;var s=1-a*a;if(s<=Number.EPSILON){var c=1-e;return this._w=c*o+e*this._w,this._x=c*n+e*this._x,this._y=c*r+e*this._y,this._z=c*i+e*this._z,this.normalize(),this._onChangeCallback(),this}var u=Math.sqrt(s),l=Math.atan2(u,a),h=Math.sin((1-e)*l)/u,f=Math.sin(e*l)/u;return this._w=o*h+this._w*f,this._x=n*h+this._x*f,this._y=r*h+this._y*f,this._z=i*h+this._z*f,this._onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},fromBufferAttribute:function(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}});var Ft=new zt,Ut=new Bt;function zt(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0}Object.assign(zt.prototype,{isVector3:!0,set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Ut.setFromEuler(t))},applyAxisAngle:function(t,e){return this.applyQuaternion(Ut.setFromAxisAngle(t,e))},applyMatrix3:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6]*r,this.y=i[1]*e+i[4]*n+i[7]*r,this.z=i[2]*e+i[5]*n+i[8]*r,this},applyNormalMatrix:function(t){return this.applyMatrix3(t).normalize()},applyMatrix4:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements,o=1/(i[3]*e+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*e+i[4]*n+i[8]*r+i[12])*o,this.y=(i[1]*e+i[5]*n+i[9]*r+i[13])*o,this.z=(i[2]*e+i[6]*n+i[10]*r+i[14])*o,this},applyQuaternion:function(t){var e=this.x,n=this.y,r=this.z,i=t.x,o=t.y,a=t.z,s=t.w,c=s*e+o*r-a*n,u=s*n+a*e-i*r,l=s*r+i*n-o*e,h=-i*e-o*n-a*r;return this.x=c*s+h*-i+u*-a-l*-o,this.y=u*s+h*-o+l*-i-c*-a,this.z=l*s+h*-a+c*-o-u*-i,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[4]*n+i[8]*r,this.y=i[1]*e+i[5]*n+i[9]*r,this.z=i[2]*e+i[6]*n+i[10]*r,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},cross:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)},crossVectors:function(t,e){var n=t.x,r=t.y,i=t.z,o=e.x,a=e.y,s=e.z;return this.x=r*s-i*a,this.y=i*o-n*s,this.z=n*a-r*o,this},projectOnVector:function(t){var e=t.lengthSq();if(0===e)return this.set(0,0,0);var n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)},projectOnPlane:function(t){return Ft.copy(this).projectOnVector(t),this.sub(Ft)},reflect:function(t){return this.sub(Ft.copy(t).multiplyScalar(2*this.dot(t)))},angleTo:function(t){var e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;var n=this.dot(t)/e;return Math.acos(At.clamp(n,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,e,n){var r=Math.sin(e)*t;return this.x=r*Math.sin(n),this.y=Math.cos(e)*t,this.z=r*Math.cos(n),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this},setFromMatrixPosition:function(t){var e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=r,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},setFromMatrix3Column:function(t,e){return this.fromArray(t.elements,3*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}});var Gt=new zt,Ht=new Xt,Vt=new zt(0,0,0),Wt=new zt(1,1,1),qt=new zt,Yt=new zt,Jt=new zt;function Xt(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}Object.assign(Xt.prototype,{isMatrix4:!0,set:function(t,e,n,r,i,o,a,s,c,u,l,h,f,p,d,y){var m=this.elements;return m[0]=t,m[4]=e,m[8]=n,m[12]=r,m[1]=i,m[5]=o,m[9]=a,m[13]=s,m[2]=c,m[6]=u,m[10]=l,m[14]=h,m[3]=f,m[7]=p,m[11]=d,m[15]=y,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new Xt).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this},copyPosition:function(t){var e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this},extractBasis:function(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this},extractRotation:function(t){var e=this.elements,n=t.elements,r=1/Gt.setFromMatrixColumn(t,0).length(),i=1/Gt.setFromMatrixColumn(t,1).length(),o=1/Gt.setFromMatrixColumn(t,2).length();return e[0]=n[0]*r,e[1]=n[1]*r,e[2]=n[2]*r,e[3]=0,e[4]=n[4]*i,e[5]=n[5]*i,e[6]=n[6]*i,e[7]=0,e[8]=n[8]*o,e[9]=n[9]*o,e[10]=n[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,n=t.x,r=t.y,i=t.z,o=Math.cos(n),a=Math.sin(n),s=Math.cos(r),c=Math.sin(r),u=Math.cos(i),l=Math.sin(i);if("XYZ"===t.order){var h=o*u,f=o*l,p=a*u,d=a*l;e[0]=s*u,e[4]=-s*l,e[8]=c,e[1]=f+p*c,e[5]=h-d*c,e[9]=-a*s,e[2]=d-h*c,e[6]=p+f*c,e[10]=o*s}else if("YXZ"===t.order){var y=s*u,m=s*l,v=c*u,g=c*l;e[0]=y+g*a,e[4]=v*a-m,e[8]=o*c,e[1]=o*l,e[5]=o*u,e[9]=-a,e[2]=m*a-v,e[6]=g+y*a,e[10]=o*s}else if("ZXY"===t.order){y=s*u,m=s*l,v=c*u,g=c*l;e[0]=y-g*a,e[4]=-o*l,e[8]=v+m*a,e[1]=m+v*a,e[5]=o*u,e[9]=g-y*a,e[2]=-o*c,e[6]=a,e[10]=o*s}else if("ZYX"===t.order){h=o*u,f=o*l,p=a*u,d=a*l;e[0]=s*u,e[4]=p*c-f,e[8]=h*c+d,e[1]=s*l,e[5]=d*c+h,e[9]=f*c-p,e[2]=-c,e[6]=a*s,e[10]=o*s}else if("YZX"===t.order){var b=o*s,w=o*c,_=a*s,x=a*c;e[0]=s*u,e[4]=x-b*l,e[8]=_*l+w,e[1]=l,e[5]=o*u,e[9]=-a*u,e[2]=-c*u,e[6]=w*l+_,e[10]=b-x*l}else if("XZY"===t.order){b=o*s,w=o*c,_=a*s,x=a*c;e[0]=s*u,e[4]=-l,e[8]=c*u,e[1]=b*l+x,e[5]=o*u,e[9]=w*l-_,e[2]=_*l-w,e[6]=a*u,e[10]=x*l+b}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(t){return this.compose(Vt,t,Wt)},lookAt:function(t,e,n){var r=this.elements;return Jt.subVectors(t,e),0===Jt.lengthSq()&&(Jt.z=1),Jt.normalize(),qt.crossVectors(n,Jt),0===qt.lengthSq()&&(1===Math.abs(n.z)?Jt.x+=1e-4:Jt.z+=1e-4,Jt.normalize(),qt.crossVectors(n,Jt)),qt.normalize(),Yt.crossVectors(Jt,qt),r[0]=qt.x,r[4]=Yt.x,r[8]=Jt.x,r[1]=qt.y,r[5]=Yt.y,r[9]=Jt.y,r[2]=qt.z,r[6]=Yt.z,r[10]=Jt.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,r=e.elements,i=this.elements,o=n[0],a=n[4],s=n[8],c=n[12],u=n[1],l=n[5],h=n[9],f=n[13],p=n[2],d=n[6],y=n[10],m=n[14],v=n[3],g=n[7],b=n[11],w=n[15],_=r[0],x=r[4],S=r[8],T=r[12],M=r[1],E=r[5],P=r[9],O=r[13],A=r[2],D=r[6],R=r[10],C=r[14],I=r[3],k=r[7],L=r[11],N=r[15];return i[0]=o*_+a*M+s*A+c*I,i[4]=o*x+a*E+s*D+c*k,i[8]=o*S+a*P+s*R+c*L,i[12]=o*T+a*O+s*C+c*N,i[1]=u*_+l*M+h*A+f*I,i[5]=u*x+l*E+h*D+f*k,i[9]=u*S+l*P+h*R+f*L,i[13]=u*T+l*O+h*C+f*N,i[2]=p*_+d*M+y*A+m*I,i[6]=p*x+d*E+y*D+m*k,i[10]=p*S+d*P+y*R+m*L,i[14]=p*T+d*O+y*C+m*N,i[3]=v*_+g*M+b*A+w*I,i[7]=v*x+g*E+b*D+w*k,i[11]=v*S+g*P+b*R+w*L,i[15]=v*T+g*O+b*C+w*N,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[4],r=t[8],i=t[12],o=t[1],a=t[5],s=t[9],c=t[13],u=t[2],l=t[6],h=t[10],f=t[14];return t[3]*(+i*s*l-r*c*l-i*a*h+n*c*h+r*a*f-n*s*f)+t[7]*(+e*s*f-e*c*h+i*o*h-r*o*f+r*c*u-i*s*u)+t[11]*(+e*c*l-e*a*f-i*o*l+n*o*f+i*a*u-n*c*u)+t[15]*(-r*a*u-e*s*l+e*a*h+r*o*l-n*o*h+n*s*u)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(t,e,n){var r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=e,r[14]=n),this},getInverse:function(t,e){void 0!==e&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate.");var n=this.elements,r=t.elements,i=r[0],o=r[1],a=r[2],s=r[3],c=r[4],u=r[5],l=r[6],h=r[7],f=r[8],p=r[9],d=r[10],y=r[11],m=r[12],v=r[13],g=r[14],b=r[15],w=p*g*h-v*d*h+v*l*y-u*g*y-p*l*b+u*d*b,_=m*d*h-f*g*h-m*l*y+c*g*y+f*l*b-c*d*b,x=f*v*h-m*p*h+m*u*y-c*v*y-f*u*b+c*p*b,S=m*p*l-f*v*l-m*u*d+c*v*d+f*u*g-c*p*g,T=i*w+o*_+a*x+s*S;if(0===T)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var M=1/T;return n[0]=w*M,n[1]=(v*d*s-p*g*s-v*a*y+o*g*y+p*a*b-o*d*b)*M,n[2]=(u*g*s-v*l*s+v*a*h-o*g*h-u*a*b+o*l*b)*M,n[3]=(p*l*s-u*d*s-p*a*h+o*d*h+u*a*y-o*l*y)*M,n[4]=_*M,n[5]=(f*g*s-m*d*s+m*a*y-i*g*y-f*a*b+i*d*b)*M,n[6]=(m*l*s-c*g*s-m*a*h+i*g*h+c*a*b-i*l*b)*M,n[7]=(c*d*s-f*l*s+f*a*h-i*d*h-c*a*y+i*l*y)*M,n[8]=x*M,n[9]=(m*p*s-f*v*s-m*o*y+i*v*y+f*o*b-i*p*b)*M,n[10]=(c*v*s-m*u*s+m*o*h-i*v*h-c*o*b+i*u*b)*M,n[11]=(f*u*s-c*p*s-f*o*h+i*p*h+c*o*y-i*u*y)*M,n[12]=S*M,n[13]=(f*v*a-m*p*a+m*o*d-i*v*d-f*o*g+i*p*g)*M,n[14]=(m*u*a-c*v*a-m*o*l+i*v*l+c*o*g-i*u*g)*M,n[15]=(c*p*a-f*u*a+f*o*l-i*p*l-c*o*d+i*u*d)*M,this},scale:function(t){var e=this.elements,n=t.x,r=t.y,i=t.z;return e[0]*=n,e[4]*=r,e[8]*=i,e[1]*=n,e[5]*=r,e[9]*=i,e[2]*=n,e[6]*=r,e[10]*=i,e[3]*=n,e[7]*=r,e[11]*=i,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,r))},makeTranslation:function(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var n=Math.cos(e),r=Math.sin(e),i=1-n,o=t.x,a=t.y,s=t.z,c=i*o,u=i*a;return this.set(c*o+n,c*a-r*s,c*s+r*a,0,c*a+r*s,u*a+n,u*s-r*o,0,c*s-r*a,u*s+r*o,i*s*s+n,0,0,0,0,1),this},makeScale:function(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(t,e,n){return this.set(1,e,n,0,t,1,n,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,n){var r=this.elements,i=e._x,o=e._y,a=e._z,s=e._w,c=i+i,u=o+o,l=a+a,h=i*c,f=i*u,p=i*l,d=o*u,y=o*l,m=a*l,v=s*c,g=s*u,b=s*l,w=n.x,_=n.y,x=n.z;return r[0]=(1-(d+m))*w,r[1]=(f+b)*w,r[2]=(p-g)*w,r[3]=0,r[4]=(f-b)*_,r[5]=(1-(h+m))*_,r[6]=(y+v)*_,r[7]=0,r[8]=(p+g)*x,r[9]=(y-v)*x,r[10]=(1-(h+d))*x,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this},decompose:function(t,e,n){var r=this.elements,i=Gt.set(r[0],r[1],r[2]).length(),o=Gt.set(r[4],r[5],r[6]).length(),a=Gt.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),t.x=r[12],t.y=r[13],t.z=r[14],Ht.copy(this);var s=1/i,c=1/o,u=1/a;return Ht.elements[0]*=s,Ht.elements[1]*=s,Ht.elements[2]*=s,Ht.elements[4]*=c,Ht.elements[5]*=c,Ht.elements[6]*=c,Ht.elements[8]*=u,Ht.elements[9]*=u,Ht.elements[10]*=u,e.setFromRotationMatrix(Ht),n.x=i,n.y=o,n.z=a,this},makePerspective:function(t,e,n,r,i,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements,s=2*i/(e-t),c=2*i/(n-r),u=(e+t)/(e-t),l=(n+r)/(n-r),h=-(o+i)/(o-i),f=-2*o*i/(o-i);return a[0]=s,a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=c,a[9]=l,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(t,e,n,r,i,o){var a=this.elements,s=1/(e-t),c=1/(n-r),u=1/(o-i),l=(e+t)*s,h=(n+r)*c,f=(o+i)*u;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-l,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(t){for(var e=this.elements,n=t.elements,r=0;r<16;r++)if(e[r]!==n[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<16;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}});var Kt=new Xt,Qt=new Bt;function Zt(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._order=r||Zt.DefaultOrder}function $t(){this.mask=1}Zt.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Zt.DefaultOrder="XYZ",Object.defineProperties(Zt.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}}}),Object.assign(Zt.prototype,{isEuler:!0,set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._order=r||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this},setFromRotationMatrix:function(t,e,n){var r=At.clamp,i=t.elements,o=i[0],a=i[4],s=i[8],c=i[1],u=i[5],l=i[9],h=i[2],f=i[6],p=i[10];return"XYZ"===(e=e||this._order)?(this._y=Math.asin(r(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-l,p),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(f,u),this._z=0)):"YXZ"===e?(this._x=Math.asin(-r(l,-1,1)),Math.abs(l)<.9999999?(this._y=Math.atan2(s,p),this._z=Math.atan2(c,u)):(this._y=Math.atan2(-h,o),this._z=0)):"ZXY"===e?(this._x=Math.asin(r(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-h,p),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(c,o))):"ZYX"===e?(this._y=Math.asin(-r(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(f,p),this._z=Math.atan2(c,o)):(this._x=0,this._z=Math.atan2(-a,u))):"YZX"===e?(this._z=Math.asin(r(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-l,u),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(s,p))):"XZY"===e?(this._z=Math.asin(-r(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(f,u),this._y=Math.atan2(s,o)):(this._x=Math.atan2(-l,p),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+e),this._order=e,!1!==n&&this._onChangeCallback(),this},setFromQuaternion:function(t,e,n){return Kt.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Kt,e,n)},setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(t){return Qt.setFromEuler(this),this.setFromQuaternion(Qt,t)},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new zt(this._x,this._y,this._z)},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}}),Object.assign($t.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask|=1<<t|0},enableAll:function(){this.mask=-1},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},disableAll:function(){this.mask=0},test:function(t){return 0!=(this.mask&t.mask)}});var te=0,ee=new zt,ne=new Bt,re=new Xt,ie=new zt,oe=new zt,ae=new zt,se=new Bt,ce=new zt(1,0,0),ue=new zt(0,1,0),le=new zt(0,0,1),he={type:"added"},fe={type:"removed"};function pe(){Object.defineProperty(this,"id",{value:te++}),this.uuid=At.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=pe.DefaultUp.clone();var t=new zt,e=new Zt,n=new Bt,r=new zt(1,1,1);e._onChange((function(){n.setFromEuler(e,!1)})),n._onChange((function(){e.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Xt},normalMatrix:{value:new Rt}}),this.matrix=new Xt,this.matrixWorld=new Xt,this.matrixAutoUpdate=pe.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new $t,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function de(){pe.call(this),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}pe.DefaultUp=new zt(0,1,0),pe.DefaultMatrixAutoUpdate=!0,pe.prototype=Object.assign(Object.create(Mt.prototype),{constructor:pe,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,e){return ne.setFromAxisAngle(t,e),this.quaternion.multiply(ne),this},rotateOnWorldAxis:function(t,e){return ne.setFromAxisAngle(t,e),this.quaternion.premultiply(ne),this},rotateX:function(t){return this.rotateOnAxis(ce,t)},rotateY:function(t){return this.rotateOnAxis(ue,t)},rotateZ:function(t){return this.rotateOnAxis(le,t)},translateOnAxis:function(t,e){return ee.copy(t).applyQuaternion(this.quaternion),this.position.add(ee.multiplyScalar(e)),this},translateX:function(t){return this.translateOnAxis(ce,t)},translateY:function(t){return this.translateOnAxis(ue,t)},translateZ:function(t){return this.translateOnAxis(le,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(re.getInverse(this.matrixWorld))},lookAt:function(t,e,n){t.isVector3?ie.copy(t):ie.set(t,e,n);var r=this.parent;this.updateWorldMatrix(!0,!1),oe.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?re.lookAt(oe,ie,this.up):re.lookAt(ie,oe,this.up),this.quaternion.setFromRotationMatrix(re),r&&(re.extractRotation(r.matrixWorld),ne.setFromRotationMatrix(re),this.quaternion.premultiply(ne.inverse()))},add:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(he)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}var n=this.children.indexOf(t);return-1!==n&&(t.parent=null,this.children.splice(n,1),t.dispatchEvent(fe)),this},attach:function(t){return this.updateWorldMatrix(!0,!1),re.getInverse(this.matrixWorld),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),re.multiply(t.parent.matrixWorld)),t.applyMatrix4(re),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n].getObjectByProperty(t,e);if(void 0!==i)return i}},getWorldPosition:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new zt),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new Bt),this.updateMatrixWorld(!0),this.matrixWorld.decompose(oe,t,ae),t},getWorldScale:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),t=new zt),this.updateMatrixWorld(!0),this.matrixWorld.decompose(oe,se,t),t},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new zt),this.updateMatrixWorld(!0);var e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()},raycast:function(){},traverse:function(t){t(this);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].updateMatrixWorld(t)},updateWorldMatrix:function(t,e){var n=this.parent;if(!0===t&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e)for(var r=this.children,i=0,o=r.length;i<o;i++)r[i].updateWorldMatrix(!1,!0)},toJSON:function(t){var e=void 0===t||"string"==typeof t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};function i(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){r.geometry=i(t.geometries,this.geometry);var o=this.geometry.parameters;if(void 0!==o&&void 0!==o.shapes){var a=o.shapes;if(Array.isArray(a))for(var s=0,c=a.length;s<c;s++){var u=a[s];i(t.shapes,u)}else i(t.shapes,a)}}if(void 0!==this.material)if(Array.isArray(this.material)){var l=[];for(s=0,c=this.material.length;s<c;s++)l.push(i(t.materials,this.material[s]));r.material=l}else r.material=i(t.materials,this.material);if(this.children.length>0){r.children=[];for(s=0;s<this.children.length;s++)r.children.push(this.children[s].toJSON(t).object)}if(e){var h=y(t.geometries),f=y(t.materials),p=y(t.textures),d=y(t.images);a=y(t.shapes);h.length>0&&(n.geometries=h),f.length>0&&(n.materials=f),p.length>0&&(n.textures=p),d.length>0&&(n.images=d),a.length>0&&(n.shapes=a)}return n.object=r,n;function y(t){var e=[];for(var n in t){var r=t[n];delete r.metadata,e.push(r)}return e}},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(var n=0;n<t.children.length;n++){var r=t.children[n];this.add(r.clone())}return this}}),de.prototype=Object.assign(Object.create(pe.prototype),{constructor:de,isScene:!0,copy:function(t,e){return pe.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},toJSON:function(t){var e=pe.prototype.toJSON.call(this,t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.environment&&(e.object.environment=this.environment.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e},dispose:function(){this.dispatchEvent({type:"dispose"})}});var ye=[new zt,new zt,new zt,new zt,new zt,new zt,new zt,new zt],me=new zt,ve=new Oe,ge=new zt,be=new zt,we=new zt,_e=new zt,xe=new zt,Se=new zt,Te=new zt,Me=new zt,Ee=new zt,Pe=new zt;function Oe(t,e){this.min=void 0!==t?t:new zt(1/0,1/0,1/0),this.max=void 0!==e?e:new zt(-1/0,-1/0,-1/0)}function Ae(t,e,n,r,i){var o,a;for(o=0,a=t.length-3;o<=a;o+=3){Pe.fromArray(t,o);var s=i.x*Math.abs(Pe.x)+i.y*Math.abs(Pe.y)+i.z*Math.abs(Pe.z),c=e.dot(Pe),u=n.dot(Pe),l=r.dot(Pe);if(Math.max(-Math.max(c,u,l),Math.min(c,u,l))>s)return!1}return!0}Object.assign(Oe.prototype,{isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,c=t.length;s<c;s+=3){var u=t[s],l=t[s+1],h=t[s+2];u<e&&(e=u),l<n&&(n=l),h<r&&(r=h),u>i&&(i=u),l>o&&(o=l),h>a&&(a=h)}return this.min.set(e,n,r),this.max.set(i,o,a),this},setFromBufferAttribute:function(t){for(var e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,c=t.count;s<c;s++){var u=t.getX(s),l=t.getY(s),h=t.getZ(s);u<e&&(e=u),l<n&&(n=l),h<r&&(r=h),u>i&&(i=u),l>o&&(o=l),h>a&&(a=h)}return this.min.set(e,n,r),this.max.set(i,o,a),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(t,e){var n=me.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this},setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new zt),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new zt),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(t){t.updateWorldMatrix(!1,!1);var e=t.geometry;void 0!==e&&(null===e.boundingBox&&e.computeBoundingBox(),ve.copy(e.boundingBox),ve.applyMatrix4(t.matrixWorld),this.union(ve));for(var n=t.children,r=0,i=n.length;r<i;r++)this.expandByObject(n[r]);return this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return void 0===e&&(console.warn("THREE.Box3: .getParameter() target is now required"),e=new zt),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(t){return this.clampPoint(t.center,me),me.distanceToSquared(t.center)<=t.radius*t.radius},intersectsPlane:function(t){var e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant},intersectsTriangle:function(t){if(this.isEmpty())return!1;this.getCenter(Te),Me.subVectors(this.max,Te),ge.subVectors(t.a,Te),be.subVectors(t.b,Te),we.subVectors(t.c,Te),_e.subVectors(be,ge),xe.subVectors(we,be),Se.subVectors(ge,we);var e=[0,-_e.z,_e.y,0,-xe.z,xe.y,0,-Se.z,Se.y,_e.z,0,-_e.x,xe.z,0,-xe.x,Se.z,0,-Se.x,-_e.y,_e.x,0,-xe.y,xe.x,0,-Se.y,Se.x,0];return!!Ae(e,ge,be,we,Me)&&(!!Ae(e=[1,0,0,0,1,0,0,0,1],ge,be,we,Me)&&(Ee.crossVectors(_e,xe),Ae(e=[Ee.x,Ee.y,Ee.z],ge,be,we,Me)))},clampPoint:function(t,e){return void 0===e&&(console.warn("THREE.Box3: .clampPoint() target is now required"),e=new zt),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return me.copy(t).clamp(this.min,this.max).sub(t).length()},getBoundingSphere:function(t){return void 0===t&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=.5*this.getSize(me).length(),t},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(t){return this.isEmpty()?this:(ye[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),ye[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),ye[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),ye[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),ye[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),ye[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),ye[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),ye[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(ye),this)},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});var De=new Oe;function Re(t,e){this.center=void 0!==t?t:new zt,this.radius=void 0!==e?e:0}Object.assign(Re.prototype,{set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(t,e){var n=this.center;void 0!==e?n.copy(e):De.setFromPoints(t).getCenter(n);for(var r=0,i=0,o=t.length;i<o;i++)r=Math.max(r,n.distanceToSquared(t[i]));return this.radius=Math.sqrt(r),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,e){var n=this.center.distanceToSquared(t);return void 0===e&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),e=new zt),e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e},getBoundingBox:function(t){return void 0===t&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new Oe),t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}});var Ce=new zt,Ie=new zt,ke=new zt,Le=new zt,Ne=new zt,je=new zt,Be=new zt;function Fe(t,e){this.origin=void 0!==t?t:new zt,this.direction=void 0!==e?e:new zt(0,0,-1)}Object.assign(Fe.prototype,{set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return void 0===e&&(console.warn("THREE.Ray: .at() target is now required"),e=new zt),e.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(t){return this.origin.copy(this.at(t,Ce)),this},closestPointToPoint:function(t,e){void 0===e&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),e=new zt),e.subVectors(t,this.origin);var n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(t){var e=Ce.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(Ce.copy(this.direction).multiplyScalar(e).add(this.origin),Ce.distanceToSquared(t))},distanceSqToSegment:function(t,e,n,r){Ie.copy(t).add(e).multiplyScalar(.5),ke.copy(e).sub(t).normalize(),Le.copy(this.origin).sub(Ie);var i,o,a,s,c=.5*t.distanceTo(e),u=-this.direction.dot(ke),l=Le.dot(this.direction),h=-Le.dot(ke),f=Le.lengthSq(),p=Math.abs(1-u*u);if(p>0)if(o=u*l-h,s=c*p,(i=u*h-l)>=0)if(o>=-s)if(o<=s){var d=1/p;a=(i*=d)*(i+u*(o*=d)+2*l)+o*(u*i+o+2*h)+f}else o=c,a=-(i=Math.max(0,-(u*o+l)))*i+o*(o+2*h)+f;else o=-c,a=-(i=Math.max(0,-(u*o+l)))*i+o*(o+2*h)+f;else o<=-s?a=-(i=Math.max(0,-(-u*c+l)))*i+(o=i>0?-c:Math.min(Math.max(-c,-h),c))*(o+2*h)+f:o<=s?(i=0,a=(o=Math.min(Math.max(-c,-h),c))*(o+2*h)+f):a=-(i=Math.max(0,-(u*c+l)))*i+(o=i>0?c:Math.min(Math.max(-c,-h),c))*(o+2*h)+f;else o=u>0?-c:c,a=-(i=Math.max(0,-(u*o+l)))*i+o*(o+2*h)+f;return n&&n.copy(this.direction).multiplyScalar(i).add(this.origin),r&&r.copy(ke).multiplyScalar(o).add(Ie),a},intersectSphere:function(t,e){Ce.subVectors(t.center,this.origin);var n=Ce.dot(this.direction),r=Ce.dot(Ce)-n*n,i=t.radius*t.radius;if(r>i)return null;var o=Math.sqrt(i-r),a=n-o,s=n+o;return a<0&&s<0?null:a<0?this.at(s,e):this.at(a,e)},intersectsSphere:function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null},intersectPlane:function(t,e){var n=this.distanceToPlane(t);return null===n?null:this.at(n,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0},intersectBox:function(t,e){var n,r,i,o,a,s,c=1/this.direction.x,u=1/this.direction.y,l=1/this.direction.z,h=this.origin;return c>=0?(n=(t.min.x-h.x)*c,r=(t.max.x-h.x)*c):(n=(t.max.x-h.x)*c,r=(t.min.x-h.x)*c),u>=0?(i=(t.min.y-h.y)*u,o=(t.max.y-h.y)*u):(i=(t.max.y-h.y)*u,o=(t.min.y-h.y)*u),n>o||i>r?null:((i>n||n!=n)&&(n=i),(o<r||r!=r)&&(r=o),l>=0?(a=(t.min.z-h.z)*l,s=(t.max.z-h.z)*l):(a=(t.max.z-h.z)*l,s=(t.min.z-h.z)*l),n>s||a>r?null:((a>n||n!=n)&&(n=a),(s<r||r!=r)&&(r=s),r<0?null:this.at(n>=0?n:r,e)))},intersectsBox:function(t){return null!==this.intersectBox(t,Ce)},intersectTriangle:function(t,e,n,r,i){Ne.subVectors(e,t),je.subVectors(n,t),Be.crossVectors(Ne,je);var o,a=this.direction.dot(Be);if(a>0){if(r)return null;o=1}else{if(!(a<0))return null;o=-1,a=-a}Le.subVectors(this.origin,t);var s=o*this.direction.dot(je.crossVectors(Le,je));if(s<0)return null;var c=o*this.direction.dot(Ne.cross(Le));if(c<0)return null;if(s+c>a)return null;var u=-o*Le.dot(Be);return u<0?null:this.at(u/a,i)},applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}});var Ue=new zt,ze=new zt,Ge=new Rt;function He(t,e){this.normal=void 0!==t?t:new zt(1,0,0),this.constant=void 0!==e?e:0}Object.assign(He.prototype,{isPlane:!0,set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,n,r){return this.normal.set(t,e,n),this.constant=r,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(t,e,n){var r=Ue.subVectors(n,e).cross(ze.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(r,t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return void 0===e&&(console.warn("THREE.Plane: .projectPoint() target is now required"),e=new zt),e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:function(t,e){void 0===e&&(console.warn("THREE.Plane: .intersectLine() target is now required"),e=new zt);var n=t.delta(Ue),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(t.start)?e.copy(t.start):void 0;var i=-(t.start.dot(this.normal)+this.constant)/r;return i<0||i>1?void 0:e.copy(n).multiplyScalar(i).add(t.start)},intersectsLine:function(t){var e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return void 0===t&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new zt),t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(t,e){var n=e||Ge.getNormalMatrix(t),r=this.coplanarPoint(Ue).applyMatrix4(t),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this},translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}});var Ve=new zt,We=new zt,qe=new zt,Ye=new zt,Je=new zt,Xe=new zt,Ke=new zt,Qe=new zt,Ze=new zt,$e=new zt;function tn(t,e,n){this.a=void 0!==t?t:new zt,this.b=void 0!==e?e:new zt,this.c=void 0!==n?n:new zt}Object.assign(tn,{getNormal:function(t,e,n,r){void 0===r&&(console.warn("THREE.Triangle: .getNormal() target is now required"),r=new zt),r.subVectors(n,e),Ve.subVectors(t,e),r.cross(Ve);var i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)},getBarycoord:function(t,e,n,r,i){Ve.subVectors(r,e),We.subVectors(n,e),qe.subVectors(t,e);var o=Ve.dot(Ve),a=Ve.dot(We),s=Ve.dot(qe),c=We.dot(We),u=We.dot(qe),l=o*c-a*a;if(void 0===i&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),i=new zt),0===l)return i.set(-2,-1,-1);var h=1/l,f=(c*s-a*u)*h,p=(o*u-a*s)*h;return i.set(1-f-p,p,f)},containsPoint:function(t,e,n,r){return tn.getBarycoord(t,e,n,r,Ye),Ye.x>=0&&Ye.y>=0&&Ye.x+Ye.y<=1},getUV:function(t,e,n,r,i,o,a,s){return this.getBarycoord(t,e,n,r,Ye),s.set(0,0),s.addScaledVector(i,Ye.x),s.addScaledVector(o,Ye.y),s.addScaledVector(a,Ye.z),s},isFrontFacing:function(t,e,n,r){return Ve.subVectors(n,e),We.subVectors(t,e),Ve.cross(We).dot(r)<0}}),Object.assign(tn.prototype,{set:function(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this},setFromPointsAndIndices:function(t,e,n,r){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[r]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},getArea:function(){return Ve.subVectors(this.c,this.b),We.subVectors(this.a,this.b),.5*Ve.cross(We).length()},getMidpoint:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new zt),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(t){return tn.getNormal(this.a,this.b,this.c,t)},getPlane:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new He),t.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(t,e){return tn.getBarycoord(t,this.a,this.b,this.c,e)},getUV:function(t,e,n,r,i){return tn.getUV(t,this.a,this.b,this.c,e,n,r,i)},containsPoint:function(t){return tn.containsPoint(t,this.a,this.b,this.c)},isFrontFacing:function(t){return tn.isFrontFacing(this.a,this.b,this.c,t)},intersectsBox:function(t){return t.intersectsTriangle(this)},closestPointToPoint:function(t,e){void 0===e&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),e=new zt);var n,r,i=this.a,o=this.b,a=this.c;Je.subVectors(o,i),Xe.subVectors(a,i),Qe.subVectors(t,i);var s=Je.dot(Qe),c=Xe.dot(Qe);if(s<=0&&c<=0)return e.copy(i);Ze.subVectors(t,o);var u=Je.dot(Ze),l=Xe.dot(Ze);if(u>=0&&l<=u)return e.copy(o);var h=s*l-u*c;if(h<=0&&s>=0&&u<=0)return n=s/(s-u),e.copy(i).addScaledVector(Je,n);$e.subVectors(t,a);var f=Je.dot($e),p=Xe.dot($e);if(p>=0&&f<=p)return e.copy(a);var d=f*c-s*p;if(d<=0&&c>=0&&p<=0)return r=c/(c-p),e.copy(i).addScaledVector(Xe,r);var y=u*p-f*l;if(y<=0&&l-u>=0&&f-p>=0)return Ke.subVectors(a,o),r=(l-u)/(l-u+(f-p)),e.copy(o).addScaledVector(Ke,r);var m=1/(y+d+h);return n=d*m,r=h*m,e.copy(i).addScaledVector(Je,n).addScaledVector(Xe,r)},equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}});var en={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},nn={h:0,s:0,l:0},rn={h:0,s:0,l:0};function on(t,e,n){return void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}function an(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}function sn(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function cn(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}function un(t,e,n,r,i,o){this.a=t,this.b=e,this.c=n,this.normal=r&&r.isVector3?r:new zt,this.vertexNormals=Array.isArray(r)?r:[],this.color=i&&i.isColor?i:new on,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0!==o?o:0}Object.assign(on.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.r=t,this.g=t,this.b=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,n){return this.r=t,this.g=e,this.b=n,this},setHSL:function(t,e,n){if(t=At.euclideanModulo(t,1),e=At.clamp(e,0,1),n=At.clamp(n,0,1),0===e)this.r=this.g=this.b=n;else{var r=n<=.5?n*(1+e):n+e-n*e,i=2*n-r;this.r=an(i,r,t+1/3),this.g=an(i,r,t),this.b=an(i,r,t-1/3)}return this},setStyle:function(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var r,i=n[1],o=n[2];switch(i){case"rgb":case"rgba":if(r=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,e(r[5]),this;if(r=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,e(r[5]),this;break;case"hsl":case"hsla":if(r=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o)){var a=parseFloat(r[1])/360,s=parseInt(r[2],10)/100,c=parseInt(r[3],10)/100;return e(r[5]),this.setHSL(a,s,c)}}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(t)){var u=n[1],l=u.length;if(3===l)return this.r=parseInt(u.charAt(0)+u.charAt(0),16)/255,this.g=parseInt(u.charAt(1)+u.charAt(1),16)/255,this.b=parseInt(u.charAt(2)+u.charAt(2),16)/255,this;if(6===l)return this.r=parseInt(u.charAt(0)+u.charAt(1),16)/255,this.g=parseInt(u.charAt(2)+u.charAt(3),16)/255,this.b=parseInt(u.charAt(4)+u.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this},setColorName:function(t){var e=en[t];return void 0!==e?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){void 0===e&&(e=2);var n=e>0?1/e:1;return this.r=Math.pow(t.r,n),this.g=Math.pow(t.g,n),this.b=Math.pow(t.b,n),this},convertGammaToLinear:function(t){return this.copyGammaToLinear(this,t),this},convertLinearToGamma:function(t){return this.copyLinearToGamma(this,t),this},copySRGBToLinear:function(t){return this.r=sn(t.r),this.g=sn(t.g),this.b=sn(t.b),this},copyLinearToSRGB:function(t){return this.r=cn(t.r),this.g=cn(t.g),this.b=cn(t.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){void 0===t&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});var e,n,r=this.r,i=this.g,o=this.b,a=Math.max(r,i,o),s=Math.min(r,i,o),c=(s+a)/2;if(s===a)e=0,n=0;else{var u=a-s;switch(n=c<=.5?u/(a+s):u/(2-a-s),a){case r:e=(i-o)/u+(i<o?6:0);break;case i:e=(o-r)/u+2;break;case o:e=(r-i)/u+4}e/=6}return t.h=e,t.s=n,t.l=c,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,n){return this.getHSL(nn),nn.h+=t,nn.s+=e,nn.l+=n,this.setHSL(nn.h,nn.s,nn.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},lerpHSL:function(t,e){this.getHSL(nn),t.getHSL(rn);var n=At.lerp(nn.h,rn.h,e),r=At.lerp(nn.s,rn.s,e),i=At.lerp(nn.l,rn.l,e);return this.setHSL(n,r,i),this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},toJSON:function(){return this.getHex()}}),on.NAMES=en,Object.assign(un.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,n=t.vertexNormals.length;e<n;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(e=0,n=t.vertexColors.length;e<n;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}});var ln=0;function hn(){Object.defineProperty(this,"id",{value:ln++}),this.uuid=At.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=m,this.side=f,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=E,this.blendDst=P,this.blendEquation=v,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function fn(t){hn.call(this),this.type="MeshBasicMaterial",this.color=new on(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(t)}hn.prototype=Object.assign(Object.create(Mt.prototype),{constructor:hn,isMaterial:!0,onBeforeCompile:function(){},setValues:function(t){if(void 0!==t)for(var e in t){var n=t[e];if(void 0!==n)if("shading"!==e){var r=this[e];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[e]=n:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n;else console.warn("THREE.Material: '"+e+"' parameter is undefined.")}},toJSON:function(t){var e=void 0===t||"string"==typeof t;e&&(t={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(t){var e=[];for(var n in t){var r=t[n];delete r.metadata,e.push(r)}return e}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,n.reflectivity=this.reflectivity,n.refractionRatio=this.refractionRatio,void 0!==this.combine&&(n.combine=this.combine),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==m&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),this.side!==f&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.morphNormals&&(n.morphNormals=!0),!0===this.skinning&&(n.skinning=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),e){var i=r(t.textures),o=r(t.images);i.length>0&&(n.textures=i),o.length>0&&(n.images=o)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;var e=t.clippingPlanes,n=null;if(null!==e){var r=e.length;n=new Array(r);for(var i=0;i!==r;++i)n[i]=e[i].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(hn.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),fn.prototype=Object.create(hn.prototype),fn.prototype.constructor=fn,fn.prototype.isMeshBasicMaterial=!0,fn.prototype.copy=function(t){return hn.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this};var pn=new zt;function dn(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===n,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}function yn(t,e,n){dn.call(this,new Int8Array(t),e,n)}function mn(t,e,n){dn.call(this,new Uint8Array(t),e,n)}function vn(t,e,n){dn.call(this,new Uint8ClampedArray(t),e,n)}function gn(t,e,n){dn.call(this,new Int16Array(t),e,n)}function bn(t,e,n){dn.call(this,new Uint16Array(t),e,n)}function wn(t,e,n){dn.call(this,new Int32Array(t),e,n)}function _n(t,e,n){dn.call(this,new Uint32Array(t),e,n)}function xn(t,e,n){dn.call(this,new Float32Array(t),e,n)}function Sn(t,e,n){dn.call(this,new Float64Array(t),e,n)}function Tn(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function Mn(t){if(0===t.length)return-1/0;for(var e=t[0],n=1,r=t.length;n<r;++n)t[n]>e&&(e=t[n]);return e}Object.defineProperty(dn.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(dn.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,e,n){t*=this.itemSize,n*=e.itemSize;for(var r=0,i=this.itemSize;r<i;r++)this.array[t+r]=e.array[n+r];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),o=new on),e[n++]=o.r,e[n++]=o.g,e[n++]=o.b}return this},copyVector2sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),o=new Dt),e[n++]=o.x,e[n++]=o.y}return this},copyVector3sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),o=new zt),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z}return this},copyVector4sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),o=new Lt),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z,e[n++]=o.w}return this},applyMatrix3:function(t){for(var e=0,n=this.count;e<n;e++)pn.x=this.getX(e),pn.y=this.getY(e),pn.z=this.getZ(e),pn.applyMatrix3(t),this.setXYZ(e,pn.x,pn.y,pn.z);return this},applyMatrix4:function(t){for(var e=0,n=this.count;e<n;e++)pn.x=this.getX(e),pn.y=this.getY(e),pn.z=this.getZ(e),pn.applyMatrix4(t),this.setXYZ(e,pn.x,pn.y,pn.z);return this},applyNormalMatrix:function(t){for(var e=0,n=this.count;e<n;e++)pn.x=this.getX(e),pn.y=this.getY(e),pn.z=this.getZ(e),pn.applyNormalMatrix(t),this.setXYZ(e,pn.x,pn.y,pn.z);return this},transformDirection:function(t){for(var e=0,n=this.count;e<n;e++)pn.x=this.getX(e),pn.y=this.getY(e),pn.z=this.getZ(e),pn.transformDirection(t),this.setXYZ(e,pn.x,pn.y,pn.z);return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this},setXYZ:function(t,e,n,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this},setXYZW:function(t,e,n,r,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this.array[t+3]=i,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),yn.prototype=Object.create(dn.prototype),yn.prototype.constructor=yn,mn.prototype=Object.create(dn.prototype),mn.prototype.constructor=mn,vn.prototype=Object.create(dn.prototype),vn.prototype.constructor=vn,gn.prototype=Object.create(dn.prototype),gn.prototype.constructor=gn,bn.prototype=Object.create(dn.prototype),bn.prototype.constructor=bn,wn.prototype=Object.create(dn.prototype),wn.prototype.constructor=wn,_n.prototype=Object.create(dn.prototype),_n.prototype.constructor=_n,xn.prototype=Object.create(dn.prototype),xn.prototype.constructor=xn,Sn.prototype=Object.create(dn.prototype),Sn.prototype.constructor=Sn,Object.assign(Tn.prototype,{computeGroups:function(t){for(var e,n=[],r=void 0,i=t.faces,o=0;o<i.length;o++){var a=i[o];a.materialIndex!==r&&(r=a.materialIndex,void 0!==e&&(e.count=3*o-e.start,n.push(e)),e={start:3*o,materialIndex:r})}void 0!==e&&(e.count=3*o-e.start,n.push(e)),this.groups=n},fromGeometry:function(t){var e,n=t.faces,r=t.vertices,i=t.faceVertexUvs,o=i[0]&&i[0].length>0,a=i[1]&&i[1].length>0,s=t.morphTargets,c=s.length;if(c>0){e=[];for(var u=0;u<c;u++)e[u]={name:s[u].name,data:[]};this.morphTargets.position=e}var l,h=t.morphNormals,f=h.length;if(f>0){l=[];for(u=0;u<f;u++)l[u]={name:h[u].name,data:[]};this.morphTargets.normal=l}var p=t.skinIndices,d=t.skinWeights,y=p.length===r.length,m=d.length===r.length;r.length>0&&0===n.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(u=0;u<n.length;u++){var v=n[u];this.vertices.push(r[v.a],r[v.b],r[v.c]);var g=v.vertexNormals;if(3===g.length)this.normals.push(g[0],g[1],g[2]);else{var b=v.normal;this.normals.push(b,b,b)}var w,_=v.vertexColors;if(3===_.length)this.colors.push(_[0],_[1],_[2]);else{var x=v.color;this.colors.push(x,x,x)}if(!0===o)void 0!==(w=i[0][u])?this.uvs.push(w[0],w[1],w[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",u),this.uvs.push(new Dt,new Dt,new Dt));if(!0===a)void 0!==(w=i[1][u])?this.uvs2.push(w[0],w[1],w[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",u),this.uvs2.push(new Dt,new Dt,new Dt));for(var S=0;S<c;S++){var T=s[S].vertices;e[S].data.push(T[v.a],T[v.b],T[v.c])}for(S=0;S<f;S++){var M=h[S].vertexNormals[u];l[S].data.push(M.a,M.b,M.c)}y&&this.skinIndices.push(p[v.a],p[v.b],p[v.c]),m&&this.skinWeights.push(d[v.a],d[v.b],d[v.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this}});var En=1,Pn=new Xt,On=new pe,An=new zt,Dn=new Oe,Rn=new Oe,Cn=new zt;function In(){Object.defineProperty(this,"id",{value:En+=2}),this.uuid=At.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}In.prototype=Object.assign(Object.create(Mt.prototype),{constructor:In,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){Array.isArray(t)?this.index=new(Mn(t)>65535?_n:bn)(t,1):this.index=t},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,e){return this.attributes[t]=e,this},deleteAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,n){this.groups.push({start:t,count:e,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix4:function(t){var e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);var n=this.attributes.normal;if(void 0!==n){var r=(new Rt).getNormalMatrix(t);n.applyNormalMatrix(r),n.needsUpdate=!0}var i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(t),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(t){return Pn.makeRotationX(t),this.applyMatrix4(Pn),this},rotateY:function(t){return Pn.makeRotationY(t),this.applyMatrix4(Pn),this},rotateZ:function(t){return Pn.makeRotationZ(t),this.applyMatrix4(Pn),this},translate:function(t,e,n){return Pn.makeTranslation(t,e,n),this.applyMatrix4(Pn),this},scale:function(t,e,n){return Pn.makeScale(t,e,n),this.applyMatrix4(Pn),this},lookAt:function(t){return On.lookAt(t),On.updateMatrix(),this.applyMatrix4(On.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(An).negate(),this.translate(An.x,An.y,An.z),this},setFromObject:function(t){var e=t.geometry;if(t.isPoints||t.isLine){var n=new xn(3*e.vertices.length,3),r=new xn(3*e.colors.length,3);if(this.setAttribute("position",n.copyVector3sArray(e.vertices)),this.setAttribute("color",r.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length){var i=new xn(e.lineDistances.length,1);this.setAttribute("lineDistance",i.copyArray(e.lineDistances))}null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t.isMesh&&e&&e.isGeometry&&this.fromGeometry(e);return this},setFromPoints:function(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n];e.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new xn(e,3)),this},updateFromObject:function(t){var e,n=t.geometry;if(t.isMesh){var r=n.__directGeometry;if(!0===n.elementsNeedUpdate&&(r=void 0,n.elementsNeedUpdate=!1),void 0===r)return this.fromGeometry(n);r.verticesNeedUpdate=n.verticesNeedUpdate,r.normalsNeedUpdate=n.normalsNeedUpdate,r.colorsNeedUpdate=n.colorsNeedUpdate,r.uvsNeedUpdate=n.uvsNeedUpdate,r.groupsNeedUpdate=n.groupsNeedUpdate,n.verticesNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.groupsNeedUpdate=!1,n=r}return!0===n.verticesNeedUpdate&&(void 0!==(e=this.attributes.position)&&(e.copyVector3sArray(n.vertices),e.needsUpdate=!0),n.verticesNeedUpdate=!1),!0===n.normalsNeedUpdate&&(void 0!==(e=this.attributes.normal)&&(e.copyVector3sArray(n.normals),e.needsUpdate=!0),n.normalsNeedUpdate=!1),!0===n.colorsNeedUpdate&&(void 0!==(e=this.attributes.color)&&(e.copyColorsArray(n.colors),e.needsUpdate=!0),n.colorsNeedUpdate=!1),n.uvsNeedUpdate&&(void 0!==(e=this.attributes.uv)&&(e.copyVector2sArray(n.uvs),e.needsUpdate=!0),n.uvsNeedUpdate=!1),n.lineDistancesNeedUpdate&&(void 0!==(e=this.attributes.lineDistance)&&(e.copyArray(n.lineDistances),e.needsUpdate=!0),n.lineDistancesNeedUpdate=!1),n.groupsNeedUpdate&&(n.computeGroups(t.geometry),this.groups=n.groups,n.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new Tn).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e=new Float32Array(3*t.vertices.length);if(this.setAttribute("position",new dn(e,3).copyVector3sArray(t.vertices)),t.normals.length>0){var n=new Float32Array(3*t.normals.length);this.setAttribute("normal",new dn(n,3).copyVector3sArray(t.normals))}if(t.colors.length>0){var r=new Float32Array(3*t.colors.length);this.setAttribute("color",new dn(r,3).copyColorsArray(t.colors))}if(t.uvs.length>0){var i=new Float32Array(2*t.uvs.length);this.setAttribute("uv",new dn(i,2).copyVector2sArray(t.uvs))}if(t.uvs2.length>0){var o=new Float32Array(2*t.uvs2.length);this.setAttribute("uv2",new dn(o,2).copyVector2sArray(t.uvs2))}for(var a in this.groups=t.groups,t.morphTargets){for(var s=[],c=t.morphTargets[a],u=0,l=c.length;u<l;u++){var h=c[u],f=new xn(3*h.data.length,3);f.name=h.name,s.push(f.copyVector3sArray(h.data))}this.morphAttributes[a]=s}if(t.skinIndices.length>0){var p=new xn(4*t.skinIndices.length,4);this.setAttribute("skinIndex",p.copyVector4sArray(t.skinIndices))}if(t.skinWeights.length>0){var d=new xn(4*t.skinWeights.length,4);this.setAttribute("skinWeight",d.copyVector4sArray(t.skinWeights))}return null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Oe);var t=this.attributes.position,e=this.morphAttributes.position;if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(var n=0,r=e.length;n<r;n++){var i=e[n];Dn.setFromBufferAttribute(i),this.morphTargetsRelative?(Cn.addVectors(this.boundingBox.min,Dn.min),this.boundingBox.expandByPoint(Cn),Cn.addVectors(this.boundingBox.max,Dn.max),this.boundingBox.expandByPoint(Cn)):(this.boundingBox.expandByPoint(Dn.min),this.boundingBox.expandByPoint(Dn.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Re);var t=this.attributes.position,e=this.morphAttributes.position;if(t){var n=this.boundingSphere.center;if(Dn.setFromBufferAttribute(t),e)for(var r=0,i=e.length;r<i;r++){var o=e[r];Rn.setFromBufferAttribute(o),this.morphTargetsRelative?(Cn.addVectors(Dn.min,Rn.min),Dn.expandByPoint(Cn),Cn.addVectors(Dn.max,Rn.max),Dn.expandByPoint(Cn)):(Dn.expandByPoint(Rn.min),Dn.expandByPoint(Rn.max))}Dn.getCenter(n);var a=0;for(r=0,i=t.count;r<i;r++)Cn.fromBufferAttribute(t,r),a=Math.max(a,n.distanceToSquared(Cn));if(e)for(r=0,i=e.length;r<i;r++){o=e[r];for(var s=this.morphTargetsRelative,c=0,u=o.count;c<u;c++)Cn.fromBufferAttribute(o,c),s&&(An.fromBufferAttribute(t,c),Cn.add(An)),a=Math.max(a,n.distanceToSquared(Cn))}this.boundingSphere.radius=Math.sqrt(a),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes;if(e.position){var n=e.position.array;if(void 0===e.normal)this.setAttribute("normal",new dn(new Float32Array(n.length),3));else for(var r=e.normal.array,i=0,o=r.length;i<o;i++)r[i]=0;var a,s,c,u=e.normal.array,l=new zt,h=new zt,f=new zt,p=new zt,d=new zt;if(t){var y=t.array;for(i=0,o=t.count;i<o;i+=3)a=3*y[i+0],s=3*y[i+1],c=3*y[i+2],l.fromArray(n,a),h.fromArray(n,s),f.fromArray(n,c),p.subVectors(f,h),d.subVectors(l,h),p.cross(d),u[a]+=p.x,u[a+1]+=p.y,u[a+2]+=p.z,u[s]+=p.x,u[s+1]+=p.y,u[s+2]+=p.z,u[c]+=p.x,u[c+1]+=p.y,u[c+2]+=p.z}else for(i=0,o=n.length;i<o;i+=9)l.fromArray(n,i),h.fromArray(n,i+3),f.fromArray(n,i+6),p.subVectors(f,h),d.subVectors(l,h),p.cross(d),u[i]=p.x,u[i+1]=p.y,u[i+2]=p.z,u[i+3]=p.x,u[i+4]=p.y,u[i+5]=p.z,u[i+6]=p.x,u[i+7]=p.y,u[i+8]=p.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},merge:function(t,e){if(t&&t.isBufferGeometry){void 0===e&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n=this.attributes;for(var r in n)if(void 0!==t.attributes[r])for(var i=n[r].array,o=t.attributes[r],a=o.array,s=o.itemSize*e,c=Math.min(a.length,i.length-s),u=0,l=s;u<c;u++,l++)i[l]=a[u];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t)},normalizeNormals:function(){for(var t=this.attributes.normal,e=0,n=t.count;e<n;e++)Cn.x=t.getX(e),Cn.y=t.getY(e),Cn.z=t.getZ(e),Cn.normalize(),t.setXYZ(e,Cn.x,Cn.y,Cn.z)},toNonIndexed:function(){function t(t,e){for(var n=t.array,r=t.itemSize,i=new n.constructor(e.length*r),o=0,a=0,s=0,c=e.length;s<c;s++){o=e[s]*r;for(var u=0;u<r;u++)i[a++]=n[o++]}return new dn(i,r)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var e=new In,n=this.index.array,r=this.attributes;for(var i in r){var o=t(r[i],n);e.setAttribute(i,o)}var a=this.morphAttributes;for(i in a){for(var s=[],c=a[i],u=0,l=c.length;u<l;u++){o=t(c[u],n);s.push(o)}e.morphAttributes[i]=s}e.morphTargetsRelative=this.morphTargetsRelative;for(var h=this.groups,f=(u=0,h.length);u<f;u++){var p=h[u];e.addGroup(p.start,p.count,p.materialIndex)}return e},toJSON:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){var e=this.parameters;for(var n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};var r=this.index;null!==r&&(t.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});var i=this.attributes;for(var n in i){var o=(f=i[n]).toJSON();""!==f.name&&(o.name=f.name),t.data.attributes[n]=o}var a={},s=!1;for(var n in this.morphAttributes){for(var c=this.morphAttributes[n],u=[],l=0,h=c.length;l<h;l++){var f;o=(f=c[l]).toJSON();""!==f.name&&(o.name=f.name),u.push(o)}u.length>0&&(a[n]=u,s=!0)}s&&(t.data.morphAttributes=a,t.data.morphTargetsRelative=this.morphTargetsRelative);var p=this.groups;p.length>0&&(t.data.groups=JSON.parse(JSON.stringify(p)));var d=this.boundingSphere;return null!==d&&(t.data.boundingSphere={center:d.center.toArray(),radius:d.radius}),t},clone:function(){return(new In).copy(this)},copy:function(t){var e,n,r;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var i=t.index;null!==i&&this.setIndex(i.clone());var o=t.attributes;for(e in o){var a=o[e];this.setAttribute(e,a.clone())}var s=t.morphAttributes;for(e in s){var c=[],u=s[e];for(n=0,r=u.length;n<r;n++)c.push(u[n].clone());this.morphAttributes[e]=c}this.morphTargetsRelative=t.morphTargetsRelative;var l=t.groups;for(n=0,r=l.length;n<r;n++){var h=l[n];this.addGroup(h.start,h.count,h.materialIndex)}var f=t.boundingBox;null!==f&&(this.boundingBox=f.clone());var p=t.boundingSphere;return null!==p&&(this.boundingSphere=p.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var kn=new Xt,Ln=new Fe,Nn=new Re,jn=new zt,Bn=new zt,Fn=new zt,Un=new zt,zn=new zt,Gn=new zt,Hn=new zt,Vn=new zt,Wn=new zt,qn=new Dt,Yn=new Dt,Jn=new Dt,Xn=new zt,Kn=new zt;function Qn(t,e){pe.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new In,this.material=void 0!==e?e:new fn,this.updateMorphTargets()}function Zn(t,e,n,r,i,o,a,s){if(null===(e.side===p?r.intersectTriangle(a,o,i,!0,s):r.intersectTriangle(i,o,a,e.side!==d,s)))return null;Kn.copy(s),Kn.applyMatrix4(t.matrixWorld);var c=n.ray.origin.distanceTo(Kn);return c<n.near||c>n.far?null:{distance:c,point:Kn.clone(),object:t}}function $n(t,e,n,r,i,o,a,s,c,u,l,h){jn.fromBufferAttribute(i,u),Bn.fromBufferAttribute(i,l),Fn.fromBufferAttribute(i,h);var f=t.morphTargetInfluences;if(e.morphTargets&&o&&f){Hn.set(0,0,0),Vn.set(0,0,0),Wn.set(0,0,0);for(var p=0,d=o.length;p<d;p++){var y=f[p],m=o[p];0!==y&&(Un.fromBufferAttribute(m,u),zn.fromBufferAttribute(m,l),Gn.fromBufferAttribute(m,h),a?(Hn.addScaledVector(Un,y),Vn.addScaledVector(zn,y),Wn.addScaledVector(Gn,y)):(Hn.addScaledVector(Un.sub(jn),y),Vn.addScaledVector(zn.sub(Bn),y),Wn.addScaledVector(Gn.sub(Fn),y)))}jn.add(Hn),Bn.add(Vn),Fn.add(Wn)}var v=Zn(t,e,n,r,jn,Bn,Fn,Xn);if(v){s&&(qn.fromBufferAttribute(s,u),Yn.fromBufferAttribute(s,l),Jn.fromBufferAttribute(s,h),v.uv=tn.getUV(Xn,jn,Bn,Fn,qn,Yn,Jn,new Dt)),c&&(qn.fromBufferAttribute(c,u),Yn.fromBufferAttribute(c,l),Jn.fromBufferAttribute(c,h),v.uv2=tn.getUV(Xn,jn,Bn,Fn,qn,Yn,Jn,new Dt));var g=new un(u,l,h);tn.getNormal(jn,Bn,Fn,g.normal),v.face=g}return v}Qn.prototype=Object.assign(Object.create(pe.prototype),{constructor:Qn,isMesh:!0,copy:function(t){return pe.prototype.copy.call(this,t),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this},updateMorphTargets:function(){var t,e,n,r=this.geometry;if(r.isBufferGeometry){var i=r.morphAttributes,o=Object.keys(i);if(o.length>0){var a=i[o[0]];if(void 0!==a)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=a.length;t<e;t++)n=a[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}else{var s=r.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(t,e){var n,r=this.geometry,i=this.material,o=this.matrixWorld;if(void 0!==i&&(null===r.boundingSphere&&r.computeBoundingSphere(),Nn.copy(r.boundingSphere),Nn.applyMatrix4(o),!1!==t.ray.intersectsSphere(Nn)&&(kn.getInverse(o),Ln.copy(t.ray).applyMatrix4(kn),null===r.boundingBox||!1!==Ln.intersectsBox(r.boundingBox))))if(r.isBufferGeometry){var a,s,c,u,l,h,f,p,d,y=r.index,m=r.attributes.position,v=r.morphAttributes.position,g=r.morphTargetsRelative,b=r.attributes.uv,w=r.attributes.uv2,_=r.groups,x=r.drawRange;if(null!==y)if(Array.isArray(i))for(u=0,h=_.length;u<h;u++)for(d=i[(p=_[u]).materialIndex],l=Math.max(p.start,x.start),f=Math.min(p.start+p.count,x.start+x.count);l<f;l+=3)a=y.getX(l),s=y.getX(l+1),c=y.getX(l+2),(n=$n(this,d,t,Ln,m,v,g,b,w,a,s,c))&&(n.faceIndex=Math.floor(l/3),n.face.materialIndex=p.materialIndex,e.push(n));else for(u=Math.max(0,x.start),h=Math.min(y.count,x.start+x.count);u<h;u+=3)a=y.getX(u),s=y.getX(u+1),c=y.getX(u+2),(n=$n(this,i,t,Ln,m,v,g,b,w,a,s,c))&&(n.faceIndex=Math.floor(u/3),e.push(n));else if(void 0!==m)if(Array.isArray(i))for(u=0,h=_.length;u<h;u++)for(d=i[(p=_[u]).materialIndex],l=Math.max(p.start,x.start),f=Math.min(p.start+p.count,x.start+x.count);l<f;l+=3)(n=$n(this,d,t,Ln,m,v,g,b,w,a=l,s=l+1,c=l+2))&&(n.faceIndex=Math.floor(l/3),n.face.materialIndex=p.materialIndex,e.push(n));else for(u=Math.max(0,x.start),h=Math.min(m.count,x.start+x.count);u<h;u+=3)(n=$n(this,i,t,Ln,m,v,g,b,w,a=u,s=u+1,c=u+2))&&(n.faceIndex=Math.floor(u/3),e.push(n))}else if(r.isGeometry){var S,T,M,E,P=Array.isArray(i),O=r.vertices,A=r.faces,D=r.faceVertexUvs[0];D.length>0&&(E=D);for(var R=0,C=A.length;R<C;R++){var I=A[R],k=P?i[I.materialIndex]:i;if(void 0!==k&&(S=O[I.a],T=O[I.b],M=O[I.c],n=Zn(this,k,t,Ln,S,T,M,Xn))){if(E&&E[R]){var L=E[R];qn.copy(L[0]),Yn.copy(L[1]),Jn.copy(L[2]),n.uv=tn.getUV(Xn,S,T,M,qn,Yn,Jn,new Dt)}n.face=I,n.faceIndex=R,e.push(n)}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var tr=0,er=new Xt,nr=new pe,rr=new zt;function ir(){Object.defineProperty(this,"id",{value:tr+=2}),this.uuid=At.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}ir.prototype=Object.assign(Object.create(Mt.prototype),{constructor:ir,isGeometry:!0,applyMatrix4:function(t){for(var e=(new Rt).getNormalMatrix(t),n=0,r=this.vertices.length;n<r;n++){this.vertices[n].applyMatrix4(t)}for(n=0,r=this.faces.length;n<r;n++){var i=this.faces[n];i.normal.applyMatrix3(e).normalize();for(var o=0,a=i.vertexNormals.length;o<a;o++)i.vertexNormals[o].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(t){return er.makeRotationX(t),this.applyMatrix4(er),this},rotateY:function(t){return er.makeRotationY(t),this.applyMatrix4(er),this},rotateZ:function(t){return er.makeRotationZ(t),this.applyMatrix4(er),this},translate:function(t,e,n){return er.makeTranslation(t,e,n),this.applyMatrix4(er),this},scale:function(t,e,n){return er.makeScale(t,e,n),this.applyMatrix4(er),this},lookAt:function(t){return nr.lookAt(t),nr.updateMatrix(),this.applyMatrix4(nr.matrix),this},fromBufferGeometry:function(t){var e=this,n=null!==t.index?t.index.array:void 0,r=t.attributes;if(void 0===r.position)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;var i=r.position.array,o=void 0!==r.normal?r.normal.array:void 0,a=void 0!==r.color?r.color.array:void 0,s=void 0!==r.uv?r.uv.array:void 0,c=void 0!==r.uv2?r.uv2.array:void 0;void 0!==c&&(this.faceVertexUvs[1]=[]);for(var u=0;u<i.length;u+=3)e.vertices.push((new zt).fromArray(i,u)),void 0!==a&&e.colors.push((new on).fromArray(a,u));function l(t,n,r,i){var u=void 0===a?[]:[e.colors[t].clone(),e.colors[n].clone(),e.colors[r].clone()],l=new un(t,n,r,void 0===o?[]:[(new zt).fromArray(o,3*t),(new zt).fromArray(o,3*n),(new zt).fromArray(o,3*r)],u,i);e.faces.push(l),void 0!==s&&e.faceVertexUvs[0].push([(new Dt).fromArray(s,2*t),(new Dt).fromArray(s,2*n),(new Dt).fromArray(s,2*r)]),void 0!==c&&e.faceVertexUvs[1].push([(new Dt).fromArray(c,2*t),(new Dt).fromArray(c,2*n),(new Dt).fromArray(c,2*r)])}var h=t.groups;if(h.length>0)for(u=0;u<h.length;u++)for(var f=h[u],p=f.start,d=p,y=p+f.count;d<y;d+=3)void 0!==n?l(n[d],n[d+1],n[d+2],f.materialIndex):l(d,d+1,d+2,f.materialIndex);else if(void 0!==n)for(u=0;u<n.length;u+=3)l(n[u],n[u+1],n[u+2]);else for(u=0;u<i.length/3;u+=3)l(u,u+1,u+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(rr).negate(),this.translate(rr.x,rr.y,rr.z),this},normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=this.boundingSphere.radius,n=0===e?1:1/e,r=new Xt;return r.set(n,0,0,-n*t.x,0,n,0,-n*t.y,0,0,n,-n*t.z,0,0,0,1),this.applyMatrix4(r),this},computeFaceNormals:function(){for(var t=new zt,e=new zt,n=0,r=this.faces.length;n<r;n++){var i=this.faces[n],o=this.vertices[i.a],a=this.vertices[i.b],s=this.vertices[i.c];t.subVectors(s,a),e.subVectors(o,a),t.cross(e),t.normalize(),i.normal.copy(t)}},computeVertexNormals:function(t){var e,n,r,i,o,a;for(void 0===t&&(t=!0),a=new Array(this.vertices.length),e=0,n=this.vertices.length;e<n;e++)a[e]=new zt;if(t){var s,c,u,l=new zt,h=new zt;for(r=0,i=this.faces.length;r<i;r++)o=this.faces[r],s=this.vertices[o.a],c=this.vertices[o.b],u=this.vertices[o.c],l.subVectors(u,c),h.subVectors(s,c),l.cross(h),a[o.a].add(l),a[o.b].add(l),a[o.c].add(l)}else for(this.computeFaceNormals(),r=0,i=this.faces.length;r<i;r++)a[(o=this.faces[r]).a].add(o.normal),a[o.b].add(o.normal),a[o.c].add(o.normal);for(e=0,n=this.vertices.length;e<n;e++)a[e].normalize();for(r=0,i=this.faces.length;r<i;r++){var f=(o=this.faces[r]).vertexNormals;3===f.length?(f[0].copy(a[o.a]),f[1].copy(a[o.b]),f[2].copy(a[o.c])):(f[0]=a[o.a].clone(),f[1]=a[o.b].clone(),f[2]=a[o.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var t,e,n;for(this.computeFaceNormals(),t=0,e=this.faces.length;t<e;t++){var r=(n=this.faces[t]).vertexNormals;3===r.length?(r[0].copy(n.normal),r[1].copy(n.normal),r[2].copy(n.normal)):(r[0]=n.normal.clone(),r[1]=n.normal.clone(),r[2]=n.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,e,n,r,i;for(n=0,r=this.faces.length;n<r;n++)for((i=this.faces[n]).__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]),t=0,e=i.vertexNormals.length;t<e;t++)i.__originalVertexNormals[t]?i.__originalVertexNormals[t].copy(i.vertexNormals[t]):i.__originalVertexNormals[t]=i.vertexNormals[t].clone();var o=new ir;for(o.faces=this.faces,t=0,e=this.morphTargets.length;t<e;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];var a=this.morphNormals[t].faceNormals,s=this.morphNormals[t].vertexNormals;for(n=0,r=this.faces.length;n<r;n++)c=new zt,u={a:new zt,b:new zt,c:new zt},a.push(c),s.push(u)}var c,u,l=this.morphNormals[t];for(o.vertices=this.morphTargets[t].vertices,o.computeFaceNormals(),o.computeVertexNormals(),n=0,r=this.faces.length;n<r;n++)i=this.faces[n],c=l.faceNormals[n],u=l.vertexNormals[n],c.copy(i.normal),u.a.copy(i.vertexNormals[0]),u.b.copy(i.vertexNormals[1]),u.c.copy(i.vertexNormals[2])}for(n=0,r=this.faces.length;n<r;n++)(i=this.faces[n]).normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Oe),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Re),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,n){if(t&&t.isGeometry){var r,i=this.vertices.length,o=this.vertices,a=t.vertices,s=this.faces,c=t.faces,u=this.colors,l=t.colors;void 0===n&&(n=0),void 0!==e&&(r=(new Rt).getNormalMatrix(e));for(var h=0,f=a.length;h<f;h++){var p=a[h].clone();void 0!==e&&p.applyMatrix4(e),o.push(p)}for(h=0,f=l.length;h<f;h++)u.push(l[h].clone());for(h=0,f=c.length;h<f;h++){var d,y,m,v=c[h],g=v.vertexNormals,b=v.vertexColors;(d=new un(v.a+i,v.b+i,v.c+i)).normal.copy(v.normal),void 0!==r&&d.normal.applyMatrix3(r).normalize();for(var w=0,_=g.length;w<_;w++)y=g[w].clone(),void 0!==r&&y.applyMatrix3(r).normalize(),d.vertexNormals.push(y);d.color.copy(v.color);for(w=0,_=b.length;w<_;w++)m=b[w],d.vertexColors.push(m.clone());d.materialIndex=v.materialIndex+n,s.push(d)}for(h=0,f=t.faceVertexUvs.length;h<f;h++){var x=t.faceVertexUvs[h];void 0===this.faceVertexUvs[h]&&(this.faceVertexUvs[h]=[]);for(w=0,_=x.length;w<_;w++){for(var S=x[w],T=[],M=0,E=S.length;M<E;M++)T.push(S[M].clone());this.faceVertexUvs[h].push(T)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t)},mergeMesh:function(t){t&&t.isMesh?(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t)},mergeVertices:function(){var t,e,n,r,i,o,a,s,c={},u=[],l=[],h=Math.pow(10,4);for(n=0,r=this.vertices.length;n<r;n++)t=this.vertices[n],void 0===c[e=Math.round(t.x*h)+"_"+Math.round(t.y*h)+"_"+Math.round(t.z*h)]?(c[e]=n,u.push(this.vertices[n]),l[n]=u.length-1):l[n]=l[c[e]];var f=[];for(n=0,r=this.faces.length;n<r;n++){(i=this.faces[n]).a=l[i.a],i.b=l[i.b],i.c=l[i.c],o=[i.a,i.b,i.c];for(var p=0;p<3;p++)if(o[p]===o[(p+1)%3]){f.push(n);break}}for(n=f.length-1;n>=0;n--){var d=f[n];for(this.faces.splice(d,1),a=0,s=this.faceVertexUvs.length;a<s;a++)this.faceVertexUvs[a].splice(d,1)}var y=this.vertices.length-u.length;return this.vertices=u,y},setFromPoints:function(t){this.vertices=[];for(var e=0,n=t.length;e<n;e++){var r=t[e];this.vertices.push(new zt(r.x,r.y,r.z||0))}return this},sortFacesByMaterialIndex:function(){for(var t=this.faces,e=t.length,n=0;n<e;n++)t[n]._id=n;t.sort((function(t,e){return t.materialIndex-e.materialIndex}));var r,i,o=this.faceVertexUvs[0],a=this.faceVertexUvs[1];o&&o.length===e&&(r=[]),a&&a.length===e&&(i=[]);for(n=0;n<e;n++){var s=t[n]._id;r&&r.push(o[s]),i&&i.push(a[s])}r&&(this.faceVertexUvs[0]=r),i&&(this.faceVertexUvs[1]=i)},toJSON:function(){var t={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var n in e)void 0!==e[n]&&(t[n]=e[n]);return t}for(var r=[],i=0;i<this.vertices.length;i++){var o=this.vertices[i];r.push(o.x,o.y,o.z)}var a=[],s=[],c={},u=[],l={},h=[],f={};for(i=0;i<this.faces.length;i++){var p=this.faces[i],d=void 0!==this.faceVertexUvs[0][i],y=p.normal.length()>0,m=p.vertexNormals.length>0,v=1!==p.color.r||1!==p.color.g||1!==p.color.b,g=p.vertexColors.length>0,b=0;if(b=S(b,0,0),b=S(b,1,!0),b=S(b,2,!1),b=S(b,3,d),b=S(b,4,y),b=S(b,5,m),b=S(b,6,v),b=S(b,7,g),a.push(b),a.push(p.a,p.b,p.c),a.push(p.materialIndex),d){var w=this.faceVertexUvs[0][i];a.push(E(w[0]),E(w[1]),E(w[2]))}if(y&&a.push(T(p.normal)),m){var _=p.vertexNormals;a.push(T(_[0]),T(_[1]),T(_[2]))}if(v&&a.push(M(p.color)),g){var x=p.vertexColors;a.push(M(x[0]),M(x[1]),M(x[2]))}}function S(t,e,n){return n?t|1<<e:t&~(1<<e)}function T(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==c[e]?c[e]:(c[e]=s.length/3,s.push(t.x,t.y,t.z),c[e])}function M(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==l[e]?l[e]:(l[e]=u.length,u.push(t.getHex()),l[e])}function E(t){var e=t.x.toString()+t.y.toString();return void 0!==f[e]?f[e]:(f[e]=h.length/2,h.push(t.x,t.y),f[e])}return t.data={},t.data.vertices=r,t.data.normals=s,u.length>0&&(t.data.colors=u),h.length>0&&(t.data.uvs=[h]),t.data.faces=a,t},clone:function(){return(new ir).copy(this)},copy:function(t){var e,n,r,i,o,a;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var s=t.vertices;for(e=0,n=s.length;e<n;e++)this.vertices.push(s[e].clone());var c=t.colors;for(e=0,n=c.length;e<n;e++)this.colors.push(c[e].clone());var u=t.faces;for(e=0,n=u.length;e<n;e++)this.faces.push(u[e].clone());for(e=0,n=t.faceVertexUvs.length;e<n;e++){var l=t.faceVertexUvs[e];for(void 0===this.faceVertexUvs[e]&&(this.faceVertexUvs[e]=[]),r=0,i=l.length;r<i;r++){var h=l[r],f=[];for(o=0,a=h.length;o<a;o++){var p=h[o];f.push(p.clone())}this.faceVertexUvs[e].push(f)}}var d=t.morphTargets;for(e=0,n=d.length;e<n;e++){var y={};if(y.name=d[e].name,void 0!==d[e].vertices)for(y.vertices=[],r=0,i=d[e].vertices.length;r<i;r++)y.vertices.push(d[e].vertices[r].clone());if(void 0!==d[e].normals)for(y.normals=[],r=0,i=d[e].normals.length;r<i;r++)y.normals.push(d[e].normals[r].clone());this.morphTargets.push(y)}var m=t.morphNormals;for(e=0,n=m.length;e<n;e++){var v={};if(void 0!==m[e].vertexNormals)for(v.vertexNormals=[],r=0,i=m[e].vertexNormals.length;r<i;r++){var g=m[e].vertexNormals[r],b={};b.a=g.a.clone(),b.b=g.b.clone(),b.c=g.c.clone(),v.vertexNormals.push(b)}if(void 0!==m[e].faceNormals)for(v.faceNormals=[],r=0,i=m[e].faceNormals.length;r<i;r++)v.faceNormals.push(m[e].faceNormals[r].clone());this.morphNormals.push(v)}var w=t.skinWeights;for(e=0,n=w.length;e<n;e++)this.skinWeights.push(w[e].clone());var _=t.skinIndices;for(e=0,n=_.length;e<n;e++)this.skinIndices.push(_[e].clone());var x=t.lineDistances;for(e=0,n=x.length;e<n;e++)this.lineDistances.push(x[e]);var S=t.boundingBox;null!==S&&(this.boundingBox=S.clone());var T=t.boundingSphere;return null!==T&&(this.boundingSphere=T.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var or=function(t){function e(t,n,r,i,o,c){var l;return a(this,e),(l=s(this,u(e).call(this))).type="BoxGeometry",l.parameters={width:t,height:n,depth:r,widthSegments:i,heightSegments:o,depthSegments:c},l.fromBufferGeometry(new ar(t,n,r,i,o,c)),l.mergeVertices(),l}return l(e,t),e}(ir),ar=function(t){function e(t,n,r,i,o,l){var h;a(this,e),(h=s(this,u(e).call(this))).type="BoxBufferGeometry",h.parameters={width:t,height:n,depth:r,widthSegments:i,heightSegments:o,depthSegments:l};var f=c(h);t=t||1,n=n||1,r=r||1,i=Math.floor(i)||1,o=Math.floor(o)||1,l=Math.floor(l)||1;var p=[],d=[],y=[],m=[],v=0,g=0;function b(t,e,n,r,i,o,a,s,c,u,l){var h,b,w=o/c,_=a/u,x=o/2,S=a/2,T=s/2,M=c+1,E=u+1,P=0,O=0,A=new zt;for(b=0;b<E;b++){var D=b*_-S;for(h=0;h<M;h++){var R=h*w-x;A[t]=R*r,A[e]=D*i,A[n]=T,d.push(A.x,A.y,A.z),A[t]=0,A[e]=0,A[n]=s>0?1:-1,y.push(A.x,A.y,A.z),m.push(h/c),m.push(1-b/u),P+=1}}for(b=0;b<u;b++)for(h=0;h<c;h++){var C=v+h+M*b,I=v+h+M*(b+1),k=v+(h+1)+M*(b+1),L=v+(h+1)+M*b;p.push(C,I,L),p.push(I,k,L),O+=6}f.addGroup(g,O,l),g+=O,v+=P}return(b("z","y","x",-1,-1,r,n,t,l,o,0),b("z","y","x",1,-1,r,n,-t,l,o,1),b("x","z","y",1,1,t,r,n,i,l,2),b("x","z","y",1,-1,t,r,-n,i,l,3),b("x","y","z",1,-1,t,n,r,i,o,4),b("x","y","z",-1,-1,t,n,-r,i,o,5),h.setIndex(p),h.setAttribute("position",new xn(d,3)),h.setAttribute("normal",new xn(y,3)),h.setAttribute("uv",new xn(m,2)),h)}return l(e,t),e}(In);function sr(t){var e={};for(var n in t)for(var r in e[n]={},t[n]){var i=t[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?e[n][r]=i.clone():Array.isArray(i)?e[n][r]=i.slice():e[n][r]=i}return e}function cr(t){for(var e={},n=0;n<t.length;n++){var r=sr(t[n]);for(var i in r)e[i]=r[i]}return e}var ur={clone:sr,merge:cr};function lr(t){hn.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function hr(){pe.call(this),this.type="Camera",this.matrixWorldInverse=new Xt,this.projectionMatrix=new Xt,this.projectionMatrixInverse=new Xt}function fr(t,e,n,r){hr.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==r?r:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}lr.prototype=Object.create(hn.prototype),lr.prototype.constructor=lr,lr.prototype.isShaderMaterial=!0,lr.prototype.copy=function(t){return hn.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=sr(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=t.extensions,this},lr.prototype.toJSON=function(t){var e=hn.prototype.toJSON.call(this,t);for(var n in e.uniforms={},this.uniforms){var r=this.uniforms[n].value;r&&r.isTexture?e.uniforms[n]={type:"t",value:r.toJSON(t).uuid}:r&&r.isColor?e.uniforms[n]={type:"c",value:r.getHex()}:r&&r.isVector2?e.uniforms[n]={type:"v2",value:r.toArray()}:r&&r.isVector3?e.uniforms[n]={type:"v3",value:r.toArray()}:r&&r.isVector4?e.uniforms[n]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?e.uniforms[n]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?e.uniforms[n]={type:"m4",value:r.toArray()}:e.uniforms[n]={value:r}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;var i={};for(var o in this.extensions)!0===this.extensions[o]&&(i[o]=!0);return Object.keys(i).length>0&&(e.extensions=i),e},hr.prototype=Object.assign(Object.create(pe.prototype),{constructor:hr,isCamera:!0,copy:function(t,e){return pe.prototype.copy.call(this,t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),t=new zt),this.updateMatrixWorld(!0);var e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()},updateMatrixWorld:function(t){pe.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(t,e){pe.prototype.updateWorldMatrix.call(this,t,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),fr.prototype=Object.assign(Object.create(hr.prototype),{constructor:fr,isPerspectiveCamera:!0,copy:function(t,e){return hr.prototype.copy.call(this,t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){var e=.5*this.getFilmHeight()/t;this.fov=2*At.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*At.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*At.RAD2DEG*Math.atan(Math.tan(.5*At.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,n,r,i,o){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.near,e=t*Math.tan(.5*At.DEG2RAD*this.fov)/this.zoom,n=2*e,r=this.aspect*n,i=-.5*r,o=this.view;if(null!==this.view&&this.view.enabled){var a=o.fullWidth,s=o.fullHeight;i+=o.offsetX*r/a,e-=o.offsetY*n/s,r*=o.width/a,n*=o.height/s}var c=this.filmOffset;0!==c&&(i+=t*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,e,e-n,t,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){var e=pe.prototype.toJSON.call(this,t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}});function pr(t,e,n,r){pe.call(this),this.type="CubeCamera";var i=new fr(90,1,t,e);i.up.set(0,-1,0),i.lookAt(new zt(1,0,0)),this.add(i);var o=new fr(90,1,t,e);o.up.set(0,-1,0),o.lookAt(new zt(-1,0,0)),this.add(o);var a=new fr(90,1,t,e);a.up.set(0,0,1),a.lookAt(new zt(0,1,0)),this.add(a);var s=new fr(90,1,t,e);s.up.set(0,0,-1),s.lookAt(new zt(0,-1,0)),this.add(s);var c=new fr(90,1,t,e);c.up.set(0,-1,0),c.lookAt(new zt(0,0,1)),this.add(c);var u=new fr(90,1,t,e);u.up.set(0,-1,0),u.lookAt(new zt(0,0,-1)),this.add(u),r=r||{format:it,magFilter:z,minFilter:z},this.renderTarget=new dr(n,r),this.renderTarget.texture.name="CubeCamera",this.update=function(t,e){null===this.parent&&this.updateMatrixWorld();var n=t.getRenderTarget(),r=this.renderTarget,l=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,t.setRenderTarget(r,0),t.render(e,i),t.setRenderTarget(r,1),t.render(e,o),t.setRenderTarget(r,2),t.render(e,a),t.setRenderTarget(r,3),t.render(e,s),t.setRenderTarget(r,4),t.render(e,c),r.texture.generateMipmaps=l,t.setRenderTarget(r,5),t.render(e,u),t.setRenderTarget(n)},this.clear=function(t,e,n,r){for(var i=t.getRenderTarget(),o=this.renderTarget,a=0;a<6;a++)t.setRenderTarget(o,a),t.clear(e,n,r);t.setRenderTarget(i)}}function dr(t,e,n){Number.isInteger(e)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),e=n),Nt.call(this,t,t,e)}function yr(t,e,n,r,i,o,a,s,c,u,l,h){kt.call(this,null,o,a,s,c,u,r,i,l,h),this.image={data:t||null,width:e||1,height:n||1},this.magFilter=void 0!==c?c:N,this.minFilter=void 0!==u?u:N,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}pr.prototype=Object.create(pe.prototype),pr.prototype.constructor=pr,dr.prototype=Object.create(Nt.prototype),dr.prototype.constructor=dr,dr.prototype.isWebGLCubeRenderTarget=!0,dr.prototype.fromEquirectangularTexture=function(t,e){this.texture.type=e.type,this.texture.format=e.format,this.texture.encoding=e.encoding;var n=new de,r={uniforms:{tEquirect:{value:null}},vertexShader:["varying vec3 vWorldDirection;","vec3 transformDirection( in vec3 dir, in mat4 matrix ) {","\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );","}","void main() {","\tvWorldDirection = transformDirection( position, modelMatrix );","\t#include <begin_vertex>","\t#include <project_vertex>","}"].join("\n"),fragmentShader:["uniform sampler2D tEquirect;","varying vec3 vWorldDirection;","#define RECIPROCAL_PI 0.31830988618","#define RECIPROCAL_PI2 0.15915494","void main() {","\tvec3 direction = normalize( vWorldDirection );","\tvec2 sampleUV;","\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;","\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;","\tgl_FragColor = texture2D( tEquirect, sampleUV );","}"].join("\n")},i=new lr({type:"CubemapFromEquirect",uniforms:sr(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:p,blending:y});i.uniforms.tEquirect.value=e;var o=new Qn(new ar(5,5,5),i);n.add(o);var a=new pr(1,10,1);return a.renderTarget=this,a.renderTarget.texture.name="CubeCameraTexture",a.update(t,n),o.geometry.dispose(),o.material.dispose(),this},yr.prototype=Object.create(kt.prototype),yr.prototype.constructor=yr,yr.prototype.isDataTexture=!0;var mr=new Re,vr=new zt;function gr(t,e,n,r,i,o){this.planes=[void 0!==t?t:new He,void 0!==e?e:new He,void 0!==n?n:new He,void 0!==r?r:new He,void 0!==i?i:new He,void 0!==o?o:new He]}Object.assign(gr.prototype,{set:function(t,e,n,r,i,o){var a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(n),a[3].copy(r),a[4].copy(i),a[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,n=0;n<6;n++)e[n].copy(t.planes[n]);return this},setFromProjectionMatrix:function(t){var e=this.planes,n=t.elements,r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],c=n[5],u=n[6],l=n[7],h=n[8],f=n[9],p=n[10],d=n[11],y=n[12],m=n[13],v=n[14],g=n[15];return e[0].setComponents(a-r,l-s,d-h,g-y).normalize(),e[1].setComponents(a+r,l+s,d+h,g+y).normalize(),e[2].setComponents(a+i,l+c,d+f,g+m).normalize(),e[3].setComponents(a-i,l-c,d-f,g-m).normalize(),e[4].setComponents(a-o,l-u,d-p,g-v).normalize(),e[5].setComponents(a+o,l+u,d+p,g+v).normalize(),this},intersectsObject:function(t){var e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),mr.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(mr)},intersectsSprite:function(t){return mr.center.set(0,0,0),mr.radius=.7071067811865476,mr.applyMatrix4(t.matrixWorld),this.intersectsSphere(mr)},intersectsSphere:function(t){for(var e=this.planes,n=t.center,r=-t.radius,i=0;i<6;i++){if(e[i].distanceToPoint(n)<r)return!1}return!0},intersectsBox:function(t){for(var e=this.planes,n=0;n<6;n++){var r=e[n];if(vr.x=r.normal.x>0?t.max.x:t.min.x,vr.y=r.normal.y>0?t.max.y:t.min.y,vr.z=r.normal.z>0?t.max.z:t.min.z,r.distanceToPoint(vr)<0)return!1}return!0},containsPoint:function(t){for(var e=this.planes,n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}});var br={common:{diffuse:{value:new on(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Rt},uv2Transform:{value:new Rt},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Dt(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new on(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new on(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Rt}},sprite:{diffuse:{value:new on(15658734)},opacity:{value:1},center:{value:new Dt(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Rt}}};function wr(){var t=null,e=!1,n=null;function r(i,o){!1!==e&&(n(i,o),t.requestAnimationFrame(r))}return{start:function(){!0!==e&&null!==n&&(t.requestAnimationFrame(r),e=!0)},stop:function(){e=!1},setAnimationLoop:function(t){n=t},setContext:function(e){t=e}}}function _r(t,e){var n=e.isWebGL2,r=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),r.get(t)},remove:function(e){e.isInterleavedBufferAttribute&&(e=e.data);var n=r.get(e);n&&(t.deleteBuffer(n.buffer),r.delete(e))},update:function(e,i){e.isInterleavedBufferAttribute&&(e=e.data);var o=r.get(e);void 0===o?r.set(e,function(e,n){var r=e.array,i=e.usage,o=t.createBuffer();t.bindBuffer(n,o),t.bufferData(n,r,i),e.onUploadCallback();var a=5126;return r instanceof Float32Array?a=5126:r instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):r instanceof Uint16Array?a=5123:r instanceof Int16Array?a=5122:r instanceof Uint32Array?a=5125:r instanceof Int32Array?a=5124:r instanceof Int8Array?a=5120:r instanceof Uint8Array&&(a=5121),{buffer:o,type:a,bytesPerElement:r.BYTES_PER_ELEMENT,version:e.version}}(e,i)):o.version<e.version&&(!function(e,r,i){var o=r.array,a=r.updateRange;t.bindBuffer(i,e),-1===a.count?t.bufferSubData(i,0,o):(n?t.bufferSubData(i,a.offset*o.BYTES_PER_ELEMENT,o,a.offset,a.count):t.bufferSubData(i,a.offset*o.BYTES_PER_ELEMENT,o.subarray(a.offset,a.offset+a.count)),a.count=-1)}(o.buffer,e,i),o.version=e.version)}}}function xr(t,e,n,r){ir.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r},this.fromBufferGeometry(new Sr(t,e,n,r)),this.mergeVertices()}function Sr(t,e,n,r){In.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r};var i,o,a=(t=t||1)/2,s=(e=e||1)/2,c=Math.floor(n)||1,u=Math.floor(r)||1,l=c+1,h=u+1,f=t/c,p=e/u,d=[],y=[],m=[],v=[];for(o=0;o<h;o++){var g=o*p-s;for(i=0;i<l;i++){var b=i*f-a;y.push(b,-g,0),m.push(0,0,1),v.push(i/c),v.push(1-o/u)}}for(o=0;o<u;o++)for(i=0;i<c;i++){var w=i+l*o,_=i+l*(o+1),x=i+1+l*(o+1),S=i+1+l*o;d.push(w,_,S),d.push(_,x,S)}this.setIndex(d),this.setAttribute("position",new xn(y,3)),this.setAttribute("normal",new xn(m,3)),this.setAttribute("uv",new xn(v,2))}xr.prototype=Object.create(ir.prototype),xr.prototype.constructor=xr,Sr.prototype=Object.create(In.prototype),Sr.prototype.constructor=Sr;var Tr={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha  = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n  return m[ 2 ][ 3 ] == - 1.0;\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_maxMipLevel 8.0\n#define cubeUV_minMipLevel 4.0\n#define cubeUV_maxTileSize 256.0\n#define cubeUV_minTileSize 16.0\nfloat getFace(vec3 direction) {\n    vec3 absDirection = abs(direction);\n    float face = -1.0;\n    if (absDirection.x > absDirection.z) {\n      if (absDirection.x > absDirection.y)\n        face = direction.x > 0.0 ? 0.0 : 3.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    } else {\n      if (absDirection.z > absDirection.y)\n        face = direction.z > 0.0 ? 2.0 : 5.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    }\n    return face;\n}\nvec2 getUV(vec3 direction, float face) {\n    vec2 uv;\n    if (face == 0.0) {\n      uv = vec2(-direction.z, direction.y) / abs(direction.x);\n    } else if (face == 1.0) {\n      uv = vec2(direction.x, -direction.z) / abs(direction.y);\n    } else if (face == 2.0) {\n      uv = direction.xy / abs(direction.z);\n    } else if (face == 3.0) {\n      uv = vec2(direction.z, direction.y) / abs(direction.x);\n    } else if (face == 4.0) {\n      uv = direction.xz / abs(direction.y);\n    } else {\n      uv = vec2(-direction.x, direction.y) / abs(direction.z);\n    }\n    return 0.5 * (uv + 1.0);\n}\nvec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {\n  float face = getFace(direction);\n  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);\n  mipInt = max(mipInt, cubeUV_minMipLevel);\n  float faceSize = exp2(mipInt);\n  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);\n  vec2 uv = getUV(direction, face) * (faceSize - 1.0);\n  vec2 f = fract(uv);\n  uv += 0.5 - f;\n  if (face > 2.0) {\n    uv.y += faceSize;\n    face -= 3.0;\n  }\n  uv.x += face * faceSize;\n  if(mipInt < cubeUV_maxMipLevel){\n    uv.y += 2.0 * cubeUV_maxTileSize;\n  }\n  uv.y += filterInt * 2.0 * cubeUV_minTileSize;\n  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);\n  uv *= texelSize;\n  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x += texelSize;\n  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.y += texelSize;\n  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x -= texelSize;\n  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  vec3 tm = mix(tl, tr, f.x);\n  vec3 bm = mix(bl, br, f.x);\n  return mix(tm, bm, f.y);\n}\n#define r0 1.0\n#define v0 0.339\n#define m0 -2.0\n#define r1 0.8\n#define v1 0.276\n#define m1 -1.0\n#define r4 0.4\n#define v4 0.046\n#define m4 2.0\n#define r5 0.305\n#define v5 0.016\n#define m5 3.0\n#define r6 0.21\n#define v6 0.0038\n#define m6 4.0\nfloat roughnessToMip(float roughness) {\n  float mip = 0.0;\n  if (roughness >= r1) {\n    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;\n  } else if (roughness >= r4) {\n    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;\n  } else if (roughness >= r5) {\n    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;\n  } else if (roughness >= r6) {\n    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;\n  } else {\n    mip = -2.0 * log2(1.16 * roughness);  }\n  return mip;\n}\nvec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {\n  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);\n  float mipF = fract(mip);\n  float mipInt = floor(mip);\n  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);\n  if (mipF == 0.0) {\n    return vec4(color0, 1.0);\n  } else {\n    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);\n    return vec4(mix(color0, color1, mipF), 1.0);\n  }\n}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\t\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t}  else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t  vec3 reflectVec = reflect( -viewDir, normal );\n\t\t  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) { \n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\t\tmat3 tsn = mat3( S, T, N );\n\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );\n}",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSPARENCY\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSPARENCY\n\tuniform float transparency;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSPARENCY\n\t\tdiffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},Mr={basic:{uniforms:cr([br.common,br.specularmap,br.envmap,br.aomap,br.lightmap,br.fog]),vertexShader:Tr.meshbasic_vert,fragmentShader:Tr.meshbasic_frag},lambert:{uniforms:cr([br.common,br.specularmap,br.envmap,br.aomap,br.lightmap,br.emissivemap,br.fog,br.lights,{emissive:{value:new on(0)}}]),vertexShader:Tr.meshlambert_vert,fragmentShader:Tr.meshlambert_frag},phong:{uniforms:cr([br.common,br.specularmap,br.envmap,br.aomap,br.lightmap,br.emissivemap,br.bumpmap,br.normalmap,br.displacementmap,br.fog,br.lights,{emissive:{value:new on(0)},specular:{value:new on(1118481)},shininess:{value:30}}]),vertexShader:Tr.meshphong_vert,fragmentShader:Tr.meshphong_frag},standard:{uniforms:cr([br.common,br.envmap,br.aomap,br.lightmap,br.emissivemap,br.bumpmap,br.normalmap,br.displacementmap,br.roughnessmap,br.metalnessmap,br.fog,br.lights,{emissive:{value:new on(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:Tr.meshphysical_vert,fragmentShader:Tr.meshphysical_frag},toon:{uniforms:cr([br.common,br.specularmap,br.aomap,br.lightmap,br.emissivemap,br.bumpmap,br.normalmap,br.displacementmap,br.gradientmap,br.fog,br.lights,{emissive:{value:new on(0)},specular:{value:new on(1118481)},shininess:{value:30}}]),vertexShader:Tr.meshtoon_vert,fragmentShader:Tr.meshtoon_frag},matcap:{uniforms:cr([br.common,br.bumpmap,br.normalmap,br.displacementmap,br.fog,{matcap:{value:null}}]),vertexShader:Tr.meshmatcap_vert,fragmentShader:Tr.meshmatcap_frag},points:{uniforms:cr([br.points,br.fog]),vertexShader:Tr.points_vert,fragmentShader:Tr.points_frag},dashed:{uniforms:cr([br.common,br.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Tr.linedashed_vert,fragmentShader:Tr.linedashed_frag},depth:{uniforms:cr([br.common,br.displacementmap]),vertexShader:Tr.depth_vert,fragmentShader:Tr.depth_frag},normal:{uniforms:cr([br.common,br.bumpmap,br.normalmap,br.displacementmap,{opacity:{value:1}}]),vertexShader:Tr.normal_vert,fragmentShader:Tr.normal_frag},sprite:{uniforms:cr([br.sprite,br.fog]),vertexShader:Tr.sprite_vert,fragmentShader:Tr.sprite_frag},background:{uniforms:{uvTransform:{value:new Rt},t2D:{value:null}},vertexShader:Tr.background_vert,fragmentShader:Tr.background_frag},cube:{uniforms:cr([br.envmap,{opacity:{value:1}}]),vertexShader:Tr.cube_vert,fragmentShader:Tr.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Tr.equirect_vert,fragmentShader:Tr.equirect_frag},distanceRGBA:{uniforms:cr([br.common,br.displacementmap,{referencePosition:{value:new zt},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Tr.distanceRGBA_vert,fragmentShader:Tr.distanceRGBA_frag},shadow:{uniforms:cr([br.lights,br.fog,{color:{value:new on(0)},opacity:{value:1}}]),vertexShader:Tr.shadow_vert,fragmentShader:Tr.shadow_frag}};function Er(t,e,n,r){var i,o,a=new on(0),s=0,c=null,u=0,l=null;function h(t,n){e.buffers.color.setClear(t.r,t.g,t.b,n,r)}return{getClearColor:function(){return a},setClearColor:function(t,e){a.set(t),h(a,s=void 0!==e?e:1)},getClearAlpha:function(){return s},setClearAlpha:function(t){h(a,s=t)},render:function(e,r,d,y){var m=r.background,v=t.xr,g=v.getSession&&v.getSession();if(g&&"additive"===g.environmentBlendMode&&(m=null),null===m?h(a,s):m&&m.isColor&&(h(m,1),y=!0),(t.autoClear||y)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),m&&(m.isCubeTexture||m.isWebGLCubeRenderTarget||306===m.mapping)){void 0===o&&((o=new Qn(new ar(1,1,1),new lr({type:"BackgroundCubeMaterial",uniforms:sr(Mr.cube.uniforms),vertexShader:Mr.cube.vertexShader,fragmentShader:Mr.cube.fragmentShader,side:p,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),o.geometry.deleteAttribute("uv"),o.onBeforeRender=function(t,e,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(o.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(o));var b=m.isWebGLCubeRenderTarget?m.texture:m;o.material.uniforms.envMap.value=b,o.material.uniforms.flipEnvMap.value=b.isCubeTexture?-1:1,c===m&&u===b.version&&l===t.toneMapping||(o.material.needsUpdate=!0,c=m,u=b.version,l=t.toneMapping),e.unshift(o,o.geometry,o.material,0,0,null)}else m&&m.isTexture&&(void 0===i&&((i=new Qn(new Sr(2,2),new lr({type:"BackgroundMaterial",uniforms:sr(Mr.background.uniforms),vertexShader:Mr.background.vertexShader,fragmentShader:Mr.background.fragmentShader,side:f,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(i.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(i)),i.material.uniforms.t2D.value=m,!0===m.matrixAutoUpdate&&m.updateMatrix(),i.material.uniforms.uvTransform.value.copy(m.matrix),c===m&&u===m.version&&l===t.toneMapping||(i.material.needsUpdate=!0,c=m,u=m.version,l=t.toneMapping),e.unshift(i,i.geometry,i.material,0,0,null))}}}function Pr(t,e,n,r){var i,o=r.isWebGL2;this.setMode=function(t){i=t},this.render=function(e,r){t.drawArrays(i,e,r),n.update(r,i)},this.renderInstances=function(r,a,s,c){if(0!==c){var u,l;if(o)u=t,l="drawArraysInstanced";else if(l="drawArraysInstancedANGLE",null===(u=e.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");u[l](i,a,s,c),n.update(s,i,c)}}}function Or(t,e,n){var r;function i(e){if("highp"===e){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var o="undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&t instanceof WebGL2ComputeRenderingContext,a=void 0!==n.precision?n.precision:"highp",s=i(a);s!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",s,"instead."),a=s);var c=!0===n.logarithmicDepthBuffer,u=t.getParameter(34930),l=t.getParameter(35660),h=t.getParameter(3379),f=t.getParameter(34076),p=t.getParameter(34921),d=t.getParameter(36347),y=t.getParameter(36348),m=t.getParameter(36349),v=l>0,g=o||!!e.get("OES_texture_float");return{isWebGL2:o,getMaxAnisotropy:function(){if(void 0!==r)return r;var n=e.get("EXT_texture_filter_anisotropic");return r=null!==n?t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:i,precision:a,logarithmicDepthBuffer:c,maxTextures:u,maxVertexTextures:l,maxTextureSize:h,maxCubemapSize:f,maxAttributes:p,maxVertexUniforms:d,maxVaryings:y,maxFragmentUniforms:m,vertexTextures:v,floatFragmentTextures:g,floatVertexTextures:v&&g,maxSamples:o?t.getParameter(36183):0}}function Ar(){var t=this,e=null,n=0,r=!1,i=!1,o=new He,a=new Rt,s={value:null,needsUpdate:!1};function c(){s.value!==e&&(s.value=e,s.needsUpdate=n>0),t.numPlanes=n,t.numIntersection=0}function u(e,n,r,i){var c=null!==e?e.length:0,u=null;if(0!==c){if(u=s.value,!0!==i||null===u){var l=r+4*c,h=n.matrixWorldInverse;a.getNormalMatrix(h),(null===u||u.length<l)&&(u=new Float32Array(l));for(var f=0,p=r;f!==c;++f,p+=4)o.copy(e[f]).applyMatrix4(h,a),o.normal.toArray(u,p),u[p+3]=o.constant}s.value=u,s.needsUpdate=!0}return t.numPlanes=c,t.numIntersection=0,u}this.uniform=s,this.numPlanes=0,this.numIntersection=0,this.init=function(t,i,o){var a=0!==t.length||i||0!==n||r;return r=i,e=u(t,o,0),n=t.length,a},this.beginShadows=function(){i=!0,u(null)},this.endShadows=function(){i=!1,c()},this.setState=function(t,o,a,l,h,f){if(!r||null===t||0===t.length||i&&!a)i?u(null):c();else{var p=i?0:n,d=4*p,y=h.clippingState||null;s.value=y,y=u(t,l,d,f);for(var m=0;m!==d;++m)y[m]=e[m];h.clippingState=y,this.numIntersection=o?this.numPlanes:0,this.numPlanes+=p}}}function Dr(t){var e={};return{get:function(n){if(void 0!==e[n])return e[n];var r;switch(n){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=t.getExtension(n)}return null===r&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),e[n]=r,r}}}function Rr(t,e,n){var r=new WeakMap,i=new WeakMap;function o(t){var a=t.target,s=r.get(a);for(var c in null!==s.index&&e.remove(s.index),s.attributes)e.remove(s.attributes[c]);a.removeEventListener("dispose",o),r.delete(a);var u=i.get(s);u&&(e.remove(u),i.delete(s)),n.memory.geometries--}function a(t){var n=[],r=t.index,o=t.attributes.position,a=0;if(null!==r){var s=r.array;a=r.version;for(var c=0,u=s.length;c<u;c+=3){var l=s[c+0],h=s[c+1],f=s[c+2];n.push(l,h,h,f,f,l)}}else{s=o.array;a=o.version;for(c=0,u=s.length/3-1;c<u;c+=3){l=c+0,h=c+1,f=c+2;n.push(l,h,h,f,f,l)}}var p=new(Mn(n)>65535?_n:bn)(n,1);p.version=a,e.update(p,34963);var d=i.get(t);d&&e.remove(d),i.set(t,p)}return{get:function(t,e){var i=r.get(e);return i||(e.addEventListener("dispose",o),e.isBufferGeometry?i=e:e.isGeometry&&(void 0===e._bufferGeometry&&(e._bufferGeometry=(new In).setFromObject(t)),i=e._bufferGeometry),r.set(e,i),n.memory.geometries++,i)},update:function(t){var n=t.index,r=t.attributes;for(var i in null!==n&&e.update(n,34963),r)e.update(r[i],34962);var o=t.morphAttributes;for(var i in o)for(var a=o[i],s=0,c=a.length;s<c;s++)e.update(a[s],34962)},getWireframeAttribute:function(t){var e=i.get(t);if(e){var n=t.index;null!==n&&e.version<n.version&&a(t)}else a(t);return i.get(t)}}}function Cr(t,e,n,r){var i,o,a,s=r.isWebGL2;this.setMode=function(t){i=t},this.setIndex=function(t){o=t.type,a=t.bytesPerElement},this.render=function(e,r){t.drawElements(i,r,o,e*a),n.update(r,i)},this.renderInstances=function(r,c,u,l){if(0!==l){var h,f;if(s)h=t,f="drawElementsInstanced";else if(f="drawElementsInstancedANGLE",null===(h=e.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");h[f](i,u,o,c*a,l),n.update(u,i,l)}}}function Ir(t){var e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(t,n,r){switch(r=r||1,e.calls++,n){case 4:e.triangles+=r*(t/3);break;case 1:e.lines+=r*(t/2);break;case 3:e.lines+=r*(t-1);break;case 2:e.lines+=r*t;break;case 0:e.points+=r*t;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function kr(t,e){return Math.abs(e[1])-Math.abs(t[1])}function Lr(t){var e={},n=new Float32Array(8);return{update:function(r,i,o,a){var s=r.morphTargetInfluences,c=void 0===s?0:s.length,u=e[i.id];if(void 0===u){u=[];for(var l=0;l<c;l++)u[l]=[l,0];e[i.id]=u}var h=o.morphTargets&&i.morphAttributes.position,f=o.morphNormals&&i.morphAttributes.normal;for(l=0;l<c;l++){0!==(d=u[l])[1]&&(h&&i.deleteAttribute("morphTarget"+l),f&&i.deleteAttribute("morphNormal"+l))}for(l=0;l<c;l++){(d=u[l])[0]=l,d[1]=s[l]}u.sort(kr);var p=0;for(l=0;l<8;l++){var d;if(d=u[l]){var y=d[0],m=d[1];if(m){h&&i.setAttribute("morphTarget"+l,h[y]),f&&i.setAttribute("morphNormal"+l,f[y]),n[l]=m,p+=m;continue}}n[l]=0}var v=i.morphTargetsRelative?1:1-p;a.getUniforms().setValue(t,"morphTargetBaseInfluence",v),a.getUniforms().setValue(t,"morphTargetInfluences",n)}}}function Nr(t,e,n,r){var i=new WeakMap;return{update:function(t){var o=r.render.frame,a=t.geometry,s=e.get(t,a);return i.get(s)!==o&&(a.isGeometry&&s.updateFromObject(t),e.update(s),i.set(s,o)),t.isInstancedMesh&&n.update(t.instanceMatrix,34962),s},dispose:function(){i=new WeakMap}}}function jr(t,e,n,r,i,o,a,s,c,u){t=void 0!==t?t:[],e=void 0!==e?e:301,a=void 0!==a?a:it,kt.call(this,t,e,n,r,i,o,a,s,c,u),this.flipY=!1}function Br(t,e,n,r){kt.call(this,null),this.image={data:t||null,width:e||1,height:n||1,depth:r||1},this.magFilter=N,this.minFilter=N,this.wrapR=k,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}function Fr(t,e,n,r){kt.call(this,null),this.image={data:t||null,width:e||1,height:n||1,depth:r||1},this.magFilter=N,this.minFilter=N,this.wrapR=k,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}Mr.physical={uniforms:cr([Mr.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Dt(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new on(0)},transparency:{value:0}}]),vertexShader:Tr.meshphysical_vert,fragmentShader:Tr.meshphysical_frag},jr.prototype=Object.create(kt.prototype),jr.prototype.constructor=jr,jr.prototype.isCubeTexture=!0,Object.defineProperty(jr.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}}),Br.prototype=Object.create(kt.prototype),Br.prototype.constructor=Br,Br.prototype.isDataTexture2DArray=!0,Fr.prototype=Object.create(kt.prototype),Fr.prototype.constructor=Fr,Fr.prototype.isDataTexture3D=!0;var Ur=new kt,zr=new Br,Gr=new Fr,Hr=new jr,Vr=[],Wr=[],qr=new Float32Array(16),Yr=new Float32Array(9),Jr=new Float32Array(4);function Xr(t,e,n){var r=t[0];if(r<=0||r>0)return t;var i=e*n,o=Vr[i];if(void 0===o&&(o=new Float32Array(i),Vr[i]=o),0!==e){r.toArray(o,0);for(var a=1,s=0;a!==e;++a)s+=n,t[a].toArray(o,s)}return o}function Kr(t,e){if(t.length!==e.length)return!1;for(var n=0,r=t.length;n<r;n++)if(t[n]!==e[n])return!1;return!0}function Qr(t,e){for(var n=0,r=e.length;n<r;n++)t[n]=e[n]}function Zr(t,e){var n=Wr[e];void 0===n&&(n=new Int32Array(e),Wr[e]=n);for(var r=0;r!==e;++r)n[r]=t.allocateTextureUnit();return n}function $r(t,e){var n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function ti(t,e){var n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Kr(n,e))return;t.uniform2fv(this.addr,e),Qr(n,e)}}function ei(t,e){var n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(void 0!==e.r)n[0]===e.r&&n[1]===e.g&&n[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(Kr(n,e))return;t.uniform3fv(this.addr,e),Qr(n,e)}}function ni(t,e){var n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Kr(n,e))return;t.uniform4fv(this.addr,e),Qr(n,e)}}function ri(t,e){var n=this.cache,r=e.elements;if(void 0===r){if(Kr(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),Qr(n,e)}else{if(Kr(n,r))return;Jr.set(r),t.uniformMatrix2fv(this.addr,!1,Jr),Qr(n,r)}}function ii(t,e){var n=this.cache,r=e.elements;if(void 0===r){if(Kr(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),Qr(n,e)}else{if(Kr(n,r))return;Yr.set(r),t.uniformMatrix3fv(this.addr,!1,Yr),Qr(n,r)}}function oi(t,e){var n=this.cache,r=e.elements;if(void 0===r){if(Kr(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),Qr(n,e)}else{if(Kr(n,r))return;qr.set(r),t.uniformMatrix4fv(this.addr,!1,qr),Qr(n,r)}}function ai(t,e,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.safeSetTexture2D(e||Ur,i)}function si(t,e,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(e||zr,i)}function ci(t,e,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(e||Gr,i)}function ui(t,e,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.safeSetTextureCube(e||Hr,i)}function li(t,e){var n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function hi(t,e){var n=this.cache;Kr(n,e)||(t.uniform2iv(this.addr,e),Qr(n,e))}function fi(t,e){var n=this.cache;Kr(n,e)||(t.uniform3iv(this.addr,e),Qr(n,e))}function pi(t,e){var n=this.cache;Kr(n,e)||(t.uniform4iv(this.addr,e),Qr(n,e))}function di(t,e){var n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function yi(t,e){t.uniform1fv(this.addr,e)}function mi(t,e){t.uniform1iv(this.addr,e)}function vi(t,e){t.uniform2iv(this.addr,e)}function gi(t,e){t.uniform3iv(this.addr,e)}function bi(t,e){t.uniform4iv(this.addr,e)}function wi(t,e){var n=Xr(e,this.size,2);t.uniform2fv(this.addr,n)}function _i(t,e){var n=Xr(e,this.size,3);t.uniform3fv(this.addr,n)}function xi(t,e){var n=Xr(e,this.size,4);t.uniform4fv(this.addr,n)}function Si(t,e){var n=Xr(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function Ti(t,e){var n=Xr(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function Mi(t,e){var n=Xr(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function Ei(t,e,n){var r=e.length,i=Zr(n,r);t.uniform1iv(this.addr,i);for(var o=0;o!==r;++o)n.safeSetTexture2D(e[o]||Ur,i[o])}function Pi(t,e,n){var r=e.length,i=Zr(n,r);t.uniform1iv(this.addr,i);for(var o=0;o!==r;++o)n.safeSetTextureCube(e[o]||Hr,i[o])}function Oi(t,e,n){this.id=t,this.addr=n,this.cache=[],this.setValue=function(t){switch(t){case 5126:return $r;case 35664:return ti;case 35665:return ei;case 35666:return ni;case 35674:return ri;case 35675:return ii;case 35676:return oi;case 5124:case 35670:return li;case 35667:case 35671:return hi;case 35668:case 35672:return fi;case 35669:case 35673:return pi;case 5125:return di;case 35678:case 36198:case 36298:case 36306:case 35682:return ai;case 35679:case 36299:case 36307:return ci;case 35680:case 36300:case 36308:case 36293:return ui;case 36289:case 36303:case 36311:case 36292:return si}}(e.type)}function Ai(t,e,n){this.id=t,this.addr=n,this.cache=[],this.size=e.size,this.setValue=function(t){switch(t){case 5126:return yi;case 35664:return wi;case 35665:return _i;case 35666:return xi;case 35674:return Si;case 35675:return Ti;case 35676:return Mi;case 5124:case 35670:return mi;case 35667:case 35671:return vi;case 35668:case 35672:return gi;case 35669:case 35673:return bi;case 35678:case 36198:case 36298:case 36306:case 35682:return Ei;case 35680:case 36300:case 36308:case 36293:return Pi}}(e.type)}function Di(t){this.id=t,this.seq=[],this.map={}}Ai.prototype.updateCache=function(t){var e=this.cache;t instanceof Float32Array&&e.length!==t.length&&(this.cache=new Float32Array(t.length)),Qr(e,t)},Di.prototype.setValue=function(t,e,n){for(var r=this.seq,i=0,o=r.length;i!==o;++i){var a=r[i];a.setValue(t,e[a.id],n)}};var Ri=/([\w\d_]+)(\])?(\[|\.)?/g;function Ci(t,e){t.seq.push(e),t.map[e.id]=e}function Ii(t,e,n){var r=t.name,i=r.length;for(Ri.lastIndex=0;;){var o=Ri.exec(r),a=Ri.lastIndex,s=o[1],c="]"===o[2],u=o[3];if(c&&(s|=0),void 0===u||"["===u&&a+2===i){Ci(n,void 0===u?new Oi(s,t,e):new Ai(s,t,e));break}var l=n.map[s];void 0===l&&Ci(n,l=new Di(s)),n=l}}function ki(t,e){this.seq=[],this.map={};for(var n=t.getProgramParameter(e,35718),r=0;r<n;++r){var i=t.getActiveUniform(e,r);Ii(i,t.getUniformLocation(e,i.name),this)}}function Li(t,e,n){var r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),r}ki.prototype.setValue=function(t,e,n,r){var i=this.map[e];void 0!==i&&i.setValue(t,n,r)},ki.prototype.setOptional=function(t,e,n){var r=e[n];void 0!==r&&this.setValue(t,n,r)},ki.upload=function(t,e,n,r){for(var i=0,o=e.length;i!==o;++i){var a=e[i],s=n[a.id];!1!==s.needsUpdate&&a.setValue(t,s.value,r)}},ki.seqWithValue=function(t,e){for(var n=[],r=0,i=t.length;r!==i;++r){var o=t[r];o.id in e&&n.push(o)}return n};var Ni=0;function ji(t){switch(t){case 3e3:return["Linear","( value )"];case xt:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:throw new Error("unsupported encoding: "+t)}}function Bi(t,e,n){var r=t.getShaderParameter(e,35713),i=t.getShaderInfoLog(e).trim();return r&&""===i?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+n+"\n"+i+function(t){for(var e=t.split("\n"),n=0;n<e.length;n++)e[n]=n+1+": "+e[n];return e.join("\n")}(t.getShaderSource(e))}function Fi(t,e){var n=ji(e);return"vec4 "+t+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function Ui(t,e){var n;switch(e){case 1:n="Linear";break;case 2:n="Reinhard";break;case 3:n="Uncharted2";break;case 4:n="OptimizedCineon";break;case 5:n="ACESFilmic";break;default:throw new Error("unsupported toneMapping: "+e)}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function zi(t){return""!==t}function Gi(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Hi(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}var Vi=/^[ \t]*#include +<([\w\d./]+)>/gm;function Wi(t){return t.replace(Vi,qi)}function qi(t,e){var n=Tr[e];if(void 0===n)throw new Error("Can not resolve #include <"+e+">");return Wi(n)}var Yi=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Ji=/#pragma unroll_loop_start[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}[\s]+?#pragma unroll_loop_end/g;function Xi(t){return t.replace(Ji,Qi).replace(Yi,Ki)}function Ki(t,e,n,r){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Qi(t,e,n,r)}function Qi(t,e,n,r){for(var i="",o=parseInt(e);o<parseInt(n);o++)i+=r.replace(/\[ i \]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return i}function Zi(t){var e="precision "+t.precision+" float;\nprecision "+t.precision+" int;";return"highp"===t.precision?e+="\n#define HIGH_PRECISION":"mediump"===t.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(e+="\n#define LOW_PRECISION"),e}function $i(t,e,n){var r,i,o,a,s,c=t.getContext(),u=n.defines,l=n.vertexShader,h=n.fragmentShader,f=function(t){var e="SHADOWMAP_TYPE_BASIC";return 1===t.shadowMapType?e="SHADOWMAP_TYPE_PCF":2===t.shadowMapType?e="SHADOWMAP_TYPE_PCF_SOFT":3===t.shadowMapType&&(e="SHADOWMAP_TYPE_VSM"),e}(n),p=function(t){var e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case 301:case 302:e="ENVMAP_TYPE_CUBE";break;case 306:case 307:e="ENVMAP_TYPE_CUBE_UV";break;case 303:case 304:e="ENVMAP_TYPE_EQUIREC";break;case 305:e="ENVMAP_TYPE_SPHERE"}return e}(n),d=function(t){var e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case 302:case 304:e="ENVMAP_MODE_REFRACTION"}return e}(n),y=function(t){var e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD"}return e}(n),m=t.gammaFactor>0?t.gammaFactor:1,v=n.isWebGL2?"":function(t){return[t.extensionDerivatives||t.envMapCubeUV||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading||"physical"===t.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(zi).join("\n")}(n),g=function(t){var e=[];for(var n in t){var r=t[n];!1!==r&&e.push("#define "+n+" "+r)}return e.join("\n")}(u),b=c.createProgram();if(n.isRawShaderMaterial?((r=[g].filter(zi).join("\n")).length>0&&(r+="\n"),(i=[v,g].filter(zi).join("\n")).length>0&&(i+="\n")):(r=[Zi(n),"#define SHADER_NAME "+n.shaderName,g,n.instancing?"#define USE_INSTANCING":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+m,"#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+d:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+f:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(zi).join("\n"),i=[v,Zi(n),"#define SHADER_NAME "+n.shaderName,g,n.alphaTest?"#define ALPHATEST "+n.alphaTest+(n.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+m,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+p:"",n.envMap?"#define "+d:"",n.envMap?"#define "+y:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.sheen?"#define USE_SHEEN":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+f:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==n.toneMapping?"#define TONE_MAPPING":"",0!==n.toneMapping?Tr.tonemapping_pars_fragment:"",0!==n.toneMapping?Ui("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.outputEncoding||n.mapEncoding||n.matcapEncoding||n.envMapEncoding||n.emissiveMapEncoding||n.lightMapEncoding?Tr.encodings_pars_fragment:"",n.mapEncoding?Fi("mapTexelToLinear",n.mapEncoding):"",n.matcapEncoding?Fi("matcapTexelToLinear",n.matcapEncoding):"",n.envMapEncoding?Fi("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMapEncoding?Fi("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.lightMapEncoding?Fi("lightMapTexelToLinear",n.lightMapEncoding):"",n.outputEncoding?(o="linearToOutputTexel",a=n.outputEncoding,s=ji(a),"vec4 "+o+"( vec4 value ) { return LinearTo"+s[0]+s[1]+"; }"):"",n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(zi).join("\n")),l=Hi(l=Gi(l=Wi(l),n),n),h=Hi(h=Gi(h=Wi(h),n),n),l=Xi(l),h=Xi(h),n.isWebGL2&&!n.isRawShaderMaterial){var w=!1,_=/^\s*#version\s+300\s+es\s*\n/;n.isShaderMaterial&&null!==l.match(_)&&null!==h.match(_)&&(w=!0,l=l.replace(_,""),h=h.replace(_,"")),r=["#version 300 es\n","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+r,i=["#version 300 es\n","#define varying in",w?"":"out highp vec4 pc_fragColor;",w?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+i}var x,S,T=i+h,M=Li(c,35633,r+l),E=Li(c,35632,T);if(c.attachShader(b,M),c.attachShader(b,E),void 0!==n.index0AttributeName?c.bindAttribLocation(b,0,n.index0AttributeName):!0===n.morphTargets&&c.bindAttribLocation(b,0,"position"),c.linkProgram(b),t.debug.checkShaderErrors){var P=c.getProgramInfoLog(b).trim(),O=c.getShaderInfoLog(M).trim(),A=c.getShaderInfoLog(E).trim(),D=!0,R=!0;if(!1===c.getProgramParameter(b,35714)){D=!1;var C=Bi(c,M,"vertex"),I=Bi(c,E,"fragment");console.error("THREE.WebGLProgram: shader error: ",c.getError(),"35715",c.getProgramParameter(b,35715),"gl.getProgramInfoLog",P,C,I)}else""!==P?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",P):""!==O&&""!==A||(R=!1);R&&(this.diagnostics={runnable:D,programLog:P,vertexShader:{log:O,prefix:r},fragmentShader:{log:A,prefix:i}})}return c.detachShader(b,M),c.detachShader(b,E),c.deleteShader(M),c.deleteShader(E),this.getUniforms=function(){return void 0===x&&(x=new ki(c,b)),x},this.getAttributes=function(){return void 0===S&&(S=function(t,e){for(var n={},r=t.getProgramParameter(e,35721),i=0;i<r;i++){var o=t.getActiveAttrib(e,i).name;n[o]=t.getAttribLocation(e,o)}return n}(c,b)),S},this.destroy=function(){c.deleteProgram(b),this.program=void 0},this.name=n.shaderName,this.id=Ni++,this.cacheKey=e,this.usedTimes=1,this.program=b,this.vertexShader=M,this.fragmentShader=E,this}function to(t,e,n){var r=[],i=n.isWebGL2,o=n.logarithmicDepthBuffer,a=n.floatVertexTextures,s=n.precision,c=n.maxVertexUniforms,u=n.vertexTextures,l={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},h=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen"];function f(t){var e;return t?t.isTexture?e=t.encoding:t.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),e=t.texture.encoding):e=3e3,e}this.getParameters=function(r,h,y,m,v,g,b){var w=m.fog,_=r.isMeshStandardMaterial?m.environment:null,x=r.envMap||_,S=l[r.type],T=b.isSkinnedMesh?function(t){var e=t.skeleton.bones;if(a)return 1024;var n=c,r=Math.floor((n-20)/4),i=Math.min(r,e.length);return i<e.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+e.length+" bones. This GPU supports "+i+"."),0):i}(b):0;null!==r.precision&&(s=n.getMaxPrecision(r.precision))!==r.precision&&console.warn("THREE.WebGLProgram.getParameters:",r.precision,"not supported, using",s,"instead.");var M=function(t,e){var n;if(e){var r=Mr[e];n={name:t.type,uniforms:ur.clone(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader}}else n={name:t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader};return n}(r,S);r.onBeforeCompile(M,t);var E=t.getRenderTarget();return{isWebGL2:i,shaderID:S,shaderName:M.name,uniforms:M.uniforms,vertexShader:M.vertexShader,fragmentShader:M.fragmentShader,defines:r.defines,isRawShaderMaterial:r.isRawShaderMaterial,isShaderMaterial:r.isShaderMaterial,precision:s,instancing:!0===b.isInstancedMesh,supportsVertexTextures:u,outputEncoding:null!==E?f(E.texture):t.outputEncoding,map:!!r.map,mapEncoding:f(r.map),matcap:!!r.matcap,matcapEncoding:f(r.matcap),envMap:!!x,envMapMode:x&&x.mapping,envMapEncoding:f(x),envMapCubeUV:!!x&&(306===x.mapping||307===x.mapping),lightMap:!!r.lightMap,lightMapEncoding:f(r.lightMap),aoMap:!!r.aoMap,emissiveMap:!!r.emissiveMap,emissiveMapEncoding:f(r.emissiveMap),bumpMap:!!r.bumpMap,normalMap:!!r.normalMap,objectSpaceNormalMap:1===r.normalMapType,tangentSpaceNormalMap:r.normalMapType===St,clearcoatMap:!!r.clearcoatMap,clearcoatRoughnessMap:!!r.clearcoatRoughnessMap,clearcoatNormalMap:!!r.clearcoatNormalMap,displacementMap:!!r.displacementMap,roughnessMap:!!r.roughnessMap,metalnessMap:!!r.metalnessMap,specularMap:!!r.specularMap,alphaMap:!!r.alphaMap,gradientMap:!!r.gradientMap,sheen:!!r.sheen,combine:r.combine,vertexTangents:r.normalMap&&r.vertexTangents,vertexColors:r.vertexColors,vertexUvs:!!(r.map||r.bumpMap||r.normalMap||r.specularMap||r.alphaMap||r.emissiveMap||r.roughnessMap||r.metalnessMap||r.clearcoatMap||r.clearcoatRoughnessMap||r.clearcoatNormalMap||r.displacementMap),uvsVertexOnly:!(r.map||r.bumpMap||r.normalMap||r.specularMap||r.alphaMap||r.emissiveMap||r.roughnessMap||r.metalnessMap||r.clearcoatNormalMap||!r.displacementMap),fog:!!w,useFog:r.fog,fogExp2:w&&w.isFogExp2,flatShading:r.flatShading,sizeAttenuation:r.sizeAttenuation,logarithmicDepthBuffer:o,skinning:r.skinning&&T>0,maxBones:T,useVertexTexture:a,morphTargets:r.morphTargets,morphNormals:r.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:h.directional.length,numPointLights:h.point.length,numSpotLights:h.spot.length,numRectAreaLights:h.rectArea.length,numHemiLights:h.hemi.length,numDirLightShadows:h.directionalShadowMap.length,numPointLightShadows:h.pointShadowMap.length,numSpotLightShadows:h.spotShadowMap.length,numClippingPlanes:v,numClipIntersection:g,dithering:r.dithering,shadowMapEnabled:t.shadowMap.enabled&&y.length>0,shadowMapType:t.shadowMap.type,toneMapping:r.toneMapped?t.toneMapping:0,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:r.premultipliedAlpha,alphaTest:r.alphaTest,doubleSided:r.side===d,flipSided:r.side===p,depthPacking:void 0!==r.depthPacking&&r.depthPacking,index0AttributeName:r.index0AttributeName,extensionDerivatives:r.extensions&&r.extensions.derivatives,extensionFragDepth:r.extensions&&r.extensions.fragDepth,extensionDrawBuffers:r.extensions&&r.extensions.drawBuffers,extensionShaderTextureLOD:r.extensions&&r.extensions.shaderTextureLOD,rendererExtensionFragDepth:i||null!==e.get("EXT_frag_depth"),rendererExtensionDrawBuffers:i||null!==e.get("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:i||null!==e.get("EXT_shader_texture_lod"),onBeforeCompile:r.onBeforeCompile}},this.getProgramCacheKey=function(e){var n=[];if(e.shaderID?n.push(e.shaderID):(n.push(e.fragmentShader),n.push(e.vertexShader)),void 0!==e.defines)for(var r in e.defines)n.push(r),n.push(e.defines[r]);if(void 0===e.isRawShaderMaterial){for(var i=0;i<h.length;i++)n.push(e[h[i]]);n.push(t.outputEncoding),n.push(t.gammaFactor)}return n.push(e.onBeforeCompile.toString()),n.join()},this.acquireProgram=function(e,n){for(var i,o=0,a=r.length;o<a;o++){var s=r[o];if(s.cacheKey===n){++(i=s).usedTimes;break}}return void 0===i&&(i=new $i(t,n,e),r.push(i)),i},this.releaseProgram=function(t){if(0==--t.usedTimes){var e=r.indexOf(t);r[e]=r[r.length-1],r.pop(),t.destroy()}},this.programs=r}function eo(){var t=new WeakMap;return{get:function(e){var n=t.get(e);return void 0===n&&(n={},t.set(e,n)),n},remove:function(e){t.delete(e)},update:function(e,n,r){t.get(e)[n]=r},dispose:function(){t=new WeakMap}}}function no(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program!==e.program?t.program.id-e.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function ro(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function io(){var t=[],e=0,n=[],r=[],i={id:-1};function o(n,r,o,a,s,c){var u=t[e];return void 0===u?(u={id:n.id,object:n,geometry:r,material:o,program:o.program||i,groupOrder:a,renderOrder:n.renderOrder,z:s,group:c},t[e]=u):(u.id=n.id,u.object=n,u.geometry=r,u.material=o,u.program=o.program||i,u.groupOrder=a,u.renderOrder=n.renderOrder,u.z=s,u.group=c),e++,u}return{opaque:n,transparent:r,init:function(){e=0,n.length=0,r.length=0},push:function(t,e,i,a,s,c){var u=o(t,e,i,a,s,c);(!0===i.transparent?r:n).push(u)},unshift:function(t,e,i,a,s,c){var u=o(t,e,i,a,s,c);(!0===i.transparent?r:n).unshift(u)},finish:function(){for(var n=e,r=t.length;n<r;n++){var i=t[n];if(null===i.id)break;i.id=null,i.object=null,i.geometry=null,i.material=null,i.program=null,i.group=null}},sort:function(t,e){n.length>1&&n.sort(t||no),r.length>1&&r.sort(e||ro)}}}function oo(){var t=new WeakMap;function e(n){var r=n.target;r.removeEventListener("dispose",e),t.delete(r)}return{get:function(n,r){var i,o=t.get(n);return void 0===o?(i=new io,t.set(n,new WeakMap),t.get(n).set(r,i),n.addEventListener("dispose",e)):void 0===(i=o.get(r))&&(i=new io,o.set(r,i)),i},dispose:function(){t=new WeakMap}}}function ao(){var t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];var n;switch(e.type){case"DirectionalLight":n={direction:new zt,color:new on};break;case"SpotLight":n={position:new zt,direction:new zt,color:new on,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new zt,color:new on,distance:0,decay:0};break;case"HemisphereLight":n={direction:new zt,skyColor:new on,groundColor:new on};break;case"RectAreaLight":n={color:new on,position:new zt,halfWidth:new zt,halfHeight:new zt}}return t[e.id]=n,n}}}var so=0;function co(t,e){return(e.castShadow?1:0)-(t.castShadow?1:0)}function uo(){for(var t,e=new ao,n=(t={},{get:function(e){if(void 0!==t[e.id])return t[e.id];var n;switch(e.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowRadius:1,shadowMapSize:new Dt};break;case"PointLight":n={shadowBias:0,shadowRadius:1,shadowMapSize:new Dt,shadowCameraNear:1,shadowCameraFar:1e3}}return t[e.id]=n,n}}),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},i=0;i<9;i++)r.probe.push(new zt);var o=new zt,a=new Xt,s=new Xt;return{setup:function(t,i,c){for(var u=0,l=0,h=0,f=0;f<9;f++)r.probe[f].set(0,0,0);var p=0,d=0,y=0,m=0,v=0,g=0,b=0,w=0,_=c.matrixWorldInverse;t.sort(co),f=0;for(var x=t.length;f<x;f++){var S=t[f],T=S.color,M=S.intensity,E=S.distance,P=S.shadow&&S.shadow.map?S.shadow.map.texture:null;if(S.isAmbientLight)u+=T.r*M,l+=T.g*M,h+=T.b*M;else if(S.isLightProbe)for(var O=0;O<9;O++)r.probe[O].addScaledVector(S.sh.coefficients[O],M);else if(S.isDirectionalLight){if((R=e.get(S)).color.copy(S.color).multiplyScalar(S.intensity),R.direction.setFromMatrixPosition(S.matrixWorld),o.setFromMatrixPosition(S.target.matrixWorld),R.direction.sub(o),R.direction.transformDirection(_),S.castShadow){var A=S.shadow;(D=n.get(S)).shadowBias=A.bias,D.shadowRadius=A.radius,D.shadowMapSize=A.mapSize,r.directionalShadow[p]=D,r.directionalShadowMap[p]=P,r.directionalShadowMatrix[p]=S.shadow.matrix,g++}r.directional[p]=R,p++}else if(S.isSpotLight){if((R=e.get(S)).position.setFromMatrixPosition(S.matrixWorld),R.position.applyMatrix4(_),R.color.copy(T).multiplyScalar(M),R.distance=E,R.direction.setFromMatrixPosition(S.matrixWorld),o.setFromMatrixPosition(S.target.matrixWorld),R.direction.sub(o),R.direction.transformDirection(_),R.coneCos=Math.cos(S.angle),R.penumbraCos=Math.cos(S.angle*(1-S.penumbra)),R.decay=S.decay,S.castShadow){A=S.shadow;(D=n.get(S)).shadowBias=A.bias,D.shadowRadius=A.radius,D.shadowMapSize=A.mapSize,r.spotShadow[y]=D,r.spotShadowMap[y]=P,r.spotShadowMatrix[y]=S.shadow.matrix,w++}r.spot[y]=R,y++}else if(S.isRectAreaLight){(R=e.get(S)).color.copy(T).multiplyScalar(M),R.position.setFromMatrixPosition(S.matrixWorld),R.position.applyMatrix4(_),s.identity(),a.copy(S.matrixWorld),a.premultiply(_),s.extractRotation(a),R.halfWidth.set(.5*S.width,0,0),R.halfHeight.set(0,.5*S.height,0),R.halfWidth.applyMatrix4(s),R.halfHeight.applyMatrix4(s),r.rectArea[m]=R,m++}else if(S.isPointLight){if((R=e.get(S)).position.setFromMatrixPosition(S.matrixWorld),R.position.applyMatrix4(_),R.color.copy(S.color).multiplyScalar(S.intensity),R.distance=S.distance,R.decay=S.decay,S.castShadow){var D;A=S.shadow;(D=n.get(S)).shadowBias=A.bias,D.shadowRadius=A.radius,D.shadowMapSize=A.mapSize,D.shadowCameraNear=A.camera.near,D.shadowCameraFar=A.camera.far,r.pointShadow[d]=D,r.pointShadowMap[d]=P,r.pointShadowMatrix[d]=S.shadow.matrix,b++}r.point[d]=R,d++}else if(S.isHemisphereLight){var R;(R=e.get(S)).direction.setFromMatrixPosition(S.matrixWorld),R.direction.transformDirection(_),R.direction.normalize(),R.skyColor.copy(S.color).multiplyScalar(M),R.groundColor.copy(S.groundColor).multiplyScalar(M),r.hemi[v]=R,v++}}r.ambient[0]=u,r.ambient[1]=l,r.ambient[2]=h;var C=r.hash;C.directionalLength===p&&C.pointLength===d&&C.spotLength===y&&C.rectAreaLength===m&&C.hemiLength===v&&C.numDirectionalShadows===g&&C.numPointShadows===b&&C.numSpotShadows===w||(r.directional.length=p,r.spot.length=y,r.rectArea.length=m,r.point.length=d,r.hemi.length=v,r.directionalShadow.length=g,r.directionalShadowMap.length=g,r.pointShadow.length=b,r.pointShadowMap.length=b,r.spotShadow.length=w,r.spotShadowMap.length=w,r.directionalShadowMatrix.length=g,r.pointShadowMatrix.length=b,r.spotShadowMatrix.length=w,C.directionalLength=p,C.pointLength=d,C.spotLength=y,C.rectAreaLength=m,C.hemiLength=v,C.numDirectionalShadows=g,C.numPointShadows=b,C.numSpotShadows=w,r.version=so++)},state:r}}function lo(){var t=new uo,e=[],n=[];return{init:function(){e.length=0,n.length=0},state:{lightsArray:e,shadowsArray:n,lights:t},setupLights:function(r){t.setup(e,n,r)},pushLight:function(t){e.push(t)},pushShadow:function(t){n.push(t)}}}function ho(){var t=new WeakMap;function e(n){var r=n.target;r.removeEventListener("dispose",e),t.delete(r)}return{get:function(n,r){var i;return!1===t.has(n)?(i=new lo,t.set(n,new WeakMap),t.get(n).set(r,i),n.addEventListener("dispose",e)):!1===t.get(n).has(r)?(i=new lo,t.get(n).set(r,i)):i=t.get(n).get(r),i},dispose:function(){t=new WeakMap}}}function fo(t){hn.call(this),this.type="MeshDepthMaterial",this.depthPacking=3200,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}function po(t){hn.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new zt,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}fo.prototype=Object.create(hn.prototype),fo.prototype.constructor=fo,fo.prototype.isMeshDepthMaterial=!0,fo.prototype.copy=function(t){return hn.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},po.prototype=Object.create(hn.prototype),po.prototype.constructor=po,po.prototype.isMeshDistanceMaterial=!0,po.prototype.copy=function(t){return hn.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this};function yo(t,e,n){var r=new gr,i=new Dt,o=new Dt,a=new Lt,s=[],c=[],u={},l={0:p,1:f,2:d},h=new lr({defines:{SAMPLE_RATE:.25,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new Dt},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n  float mean = 0.0;\n  float squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );\n  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n    #ifdef HORIZONAL_PASS\n      vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n      mean += distribution.x;\n      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n    #else\n      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );\n      mean += depth;\n      squared_mean += depth * depth;\n    #endif\n  }\n  mean = mean * HALF_SAMPLE_RATE;\n  squared_mean = squared_mean * HALF_SAMPLE_RATE;\n  float std_dev = sqrt( squared_mean - mean * mean );\n  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),m=h.clone();m.defines.HORIZONAL_PASS=1;var v=new In;v.setAttribute("position",new dn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var g=new Qn(v,h),b=this;function w(n,r){var i=e.update(g);h.uniforms.shadow_pass.value=n.map.texture,h.uniforms.resolution.value=n.mapSize,h.uniforms.radius.value=n.radius,t.setRenderTarget(n.mapPass),t.clear(),t.renderBufferDirect(r,null,i,h,g,null),m.uniforms.shadow_pass.value=n.mapPass.texture,m.uniforms.resolution.value=n.mapSize,m.uniforms.radius.value=n.radius,t.setRenderTarget(n.map),t.clear(),t.renderBufferDirect(r,null,i,m,g,null)}function _(t,e,n){var r=t<<0|e<<1|n<<2,i=s[r];return void 0===i&&(i=new fo({depthPacking:3201,morphTargets:t,skinning:e}),s[r]=i),i}function x(t,e,n){var r=t<<0|e<<1|n<<2,i=c[r];return void 0===i&&(i=new po({morphTargets:t,skinning:e}),c[r]=i),i}function S(e,n,r,i,o,a){var s=e.geometry,c=null,h=_,f=e.customDepthMaterial;if(!0===r.isPointLight&&(h=x,f=e.customDistanceMaterial),void 0===f){var p=!1;!0===n.morphTargets&&(!0===s.isBufferGeometry?p=s.morphAttributes&&s.morphAttributes.position&&s.morphAttributes.position.length>0:!0===s.isGeometry&&(p=s.morphTargets&&s.morphTargets.length>0));var d=!1;!0===e.isSkinnedMesh&&(!0===n.skinning?d=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",e)),c=h(p,d,!0===e.isInstancedMesh)}else c=f;if(t.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length){var y=c.uuid,m=n.uuid,v=u[y];void 0===v&&(v={},u[y]=v);var g=v[m];void 0===g&&(g=c.clone(),v[m]=g),c=g}return c.visible=n.visible,c.wireframe=n.wireframe,c.side=3===a?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:l[n.side],c.clipShadows=n.clipShadows,c.clippingPlanes=n.clippingPlanes,c.clipIntersection=n.clipIntersection,c.wireframeLinewidth=n.wireframeLinewidth,c.linewidth=n.linewidth,!0===r.isPointLight&&!0===c.isMeshDistanceMaterial&&(c.referencePosition.setFromMatrixPosition(r.matrixWorld),c.nearDistance=i,c.farDistance=o),c}function T(n,i,o,a,s){if(!1!==n.visible){if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&3===s)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,n.matrixWorld);var c=e.update(n),u=n.material;if(Array.isArray(u))for(var l=c.groups,h=0,f=l.length;h<f;h++){var p=l[h],d=u[p.materialIndex];if(d&&d.visible){var y=S(n,d,a,o.near,o.far,s);t.renderBufferDirect(o,null,c,y,n,p)}}else if(u.visible){y=S(n,u,a,o.near,o.far,s);t.renderBufferDirect(o,null,c,y,n,null)}}for(var m=n.children,v=0,g=m.length;v<g;v++)T(m[v],i,o,a,s)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(e,s,c){if(!1!==b.enabled&&(!1!==b.autoUpdate||!1!==b.needsUpdate)&&0!==e.length){var u=t.getRenderTarget(),l=t.getActiveCubeFace(),h=t.getActiveMipmapLevel(),f=t.state;f.setBlending(y),f.buffers.color.setClear(1,1,1,1),f.buffers.depth.setTest(!0),f.setScissorTest(!1);for(var p=0,d=e.length;p<d;p++){var m=e[p],v=m.shadow;if(void 0!==v){i.copy(v.mapSize);var g=v.getFrameExtents();if(i.multiply(g),o.copy(v.mapSize),(i.x>n||i.y>n)&&(console.warn("THREE.WebGLShadowMap:",m,"has shadow exceeding max texture size, reducing"),i.x>n&&(o.x=Math.floor(n/g.x),i.x=o.x*g.x,v.mapSize.x=o.x),i.y>n&&(o.y=Math.floor(n/g.y),i.y=o.y*g.y,v.mapSize.y=o.y)),null===v.map&&!v.isPointLightShadow&&3===this.type){var _={minFilter:z,magFilter:z,format:ot};v.map=new Nt(i.x,i.y,_),v.map.texture.name=m.name+".shadowMap",v.mapPass=new Nt(i.x,i.y,_),v.camera.updateProjectionMatrix()}if(null===v.map){_={minFilter:N,magFilter:N,format:ot};v.map=new Nt(i.x,i.y,_),v.map.texture.name=m.name+".shadowMap",v.camera.updateProjectionMatrix()}t.setRenderTarget(v.map),t.clear();for(var x=v.getViewportCount(),S=0;S<x;S++){var M=v.getViewport(S);a.set(o.x*M.x,o.y*M.y,o.x*M.z,o.y*M.w),f.viewport(a),v.updateMatrices(m,S),r=v.getFrustum(),T(s,c,v.camera,m,this.type)}v.isPointLightShadow||3!==this.type||w(v,c)}else console.warn("THREE.WebGLShadowMap:",m,"has no shadow.")}b.needsUpdate=!1,t.setRenderTarget(u,l,h)}}}function mo(t,e,n){var r,o,a=n.isWebGL2;var s=new function(){var e=!1,n=new Lt,r=null,i=new Lt(0,0,0,0);return{setMask:function(n){r===n||e||(t.colorMask(n,n,n,n),r=n)},setLocked:function(t){e=t},setClear:function(e,r,o,a,s){!0===s&&(e*=a,r*=a,o*=a),n.set(e,r,o,a),!1===i.equals(n)&&(t.clearColor(e,r,o,a),i.copy(n))},reset:function(){e=!1,r=null,i.set(-1,0,0,0)}}},c=new function(){var e=!1,n=null,r=null,i=null;return{setTest:function(t){t?st(2929):ct(2929)},setMask:function(r){n===r||e||(t.depthMask(r),n=r)},setFunc:function(e){if(r!==e){if(e)switch(e){case 0:t.depthFunc(512);break;case 1:t.depthFunc(519);break;case 2:t.depthFunc(513);break;case 3:t.depthFunc(515);break;case 4:t.depthFunc(514);break;case 5:t.depthFunc(518);break;case 6:t.depthFunc(516);break;case 7:t.depthFunc(517);break;default:t.depthFunc(515)}else t.depthFunc(515);r=e}},setLocked:function(t){e=t},setClear:function(e){i!==e&&(t.clearDepth(e),i=e)},reset:function(){e=!1,n=null,r=null,i=null}}},u=new function(){var e=!1,n=null,r=null,i=null,o=null,a=null,s=null,c=null,u=null;return{setTest:function(t){e||(t?st(2960):ct(2960))},setMask:function(r){n===r||e||(t.stencilMask(r),n=r)},setFunc:function(e,n,a){r===e&&i===n&&o===a||(t.stencilFunc(e,n,a),r=e,i=n,o=a)},setOp:function(e,n,r){a===e&&s===n&&c===r||(t.stencilOp(e,n,r),a=e,s=n,c=r)},setLocked:function(t){e=t},setClear:function(e){u!==e&&(t.clearStencil(e),u=e)},reset:function(){e=!1,n=null,r=null,i=null,o=null,a=null,s=null,c=null,u=null}}},l=t.getParameter(34921),h=new Uint8Array(l),f=new Uint8Array(l),I=new Uint8Array(l),k={},L=null,N=null,j=null,B=null,F=null,U=null,z=null,G=null,H=null,V=!1,W=null,q=null,Y=null,J=null,X=null,K=t.getParameter(35661),Q=!1,Z=0,$=t.getParameter(7938);-1!==$.indexOf("WebGL")?(Z=parseFloat(/^WebGL\ ([0-9])/.exec($)[1]),Q=Z>=1):-1!==$.indexOf("OpenGL ES")&&(Z=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec($)[1]),Q=Z>=2);var tt=null,et={},nt=new Lt,rt=new Lt;function it(e,n,r){var i=new Uint8Array(4),o=t.createTexture();t.bindTexture(e,o),t.texParameteri(e,10241,9728),t.texParameteri(e,10240,9728);for(var a=0;a<r;a++)t.texImage2D(n+a,0,6408,1,1,0,6408,5121,i);return o}var ot={};function at(n,r){(h[n]=1,0===f[n]&&(t.enableVertexAttribArray(n),f[n]=1),I[n]!==r)&&((a?t:e.get("ANGLE_instanced_arrays"))[a?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,r),I[n]=r)}function st(e){!0!==k[e]&&(t.enable(e),k[e]=!0)}function ct(e){!1!==k[e]&&(t.disable(e),k[e]=!1)}ot[3553]=it(3553,3553,1),ot[34067]=it(34067,34069,6),s.setClear(0,0,0,1),c.setClear(1),u.setClear(0),st(2929),c.setFunc(3),pt(!1),dt(1),st(2884),ft(y);var ut=(i(r={},v,32774),i(r,g,32778),i(r,b,32779),r);if(a)ut[w]=32775,ut[_]=32776;else{var lt=e.get("EXT_blend_minmax");null!==lt&&(ut[w]=lt.MIN_EXT,ut[_]=lt.MAX_EXT)}var ht=(i(o={},x,0),i(o,S,1),i(o,T,768),i(o,E,770),i(o,C,776),i(o,D,774),i(o,O,772),i(o,M,769),i(o,P,771),i(o,R,775),i(o,A,773),o);function ft(e,n,r,i,o,a,s,c){if(e!==y){if(N||(st(3042),N=!0),5===e)o=o||n,a=a||r,s=s||i,n===B&&o===z||(t.blendEquationSeparate(ut[n],ut[o]),B=n,z=o),r===F&&i===U&&a===G&&s===H||(t.blendFuncSeparate(ht[r],ht[i],ht[a],ht[s]),F=r,U=i,G=a,H=s),j=e,V=null;else if(e!==j||c!==V){if(B===v&&z===v||(t.blendEquation(32774),B=v,z=v),c)switch(e){case m:t.blendFuncSeparate(1,771,1,771);break;case 2:t.blendFunc(1,1);break;case 3:t.blendFuncSeparate(0,0,769,771);break;case 4:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}else switch(e){case m:t.blendFuncSeparate(770,771,1,771);break;case 2:t.blendFunc(770,1);break;case 3:t.blendFunc(0,769);break;case 4:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}F=null,U=null,G=null,H=null,j=e,V=c}}else N&&(ct(3042),N=!1)}function pt(e){W!==e&&(e?t.frontFace(2304):t.frontFace(2305),W=e)}function dt(e){0!==e?(st(2884),e!==q&&(1===e?t.cullFace(1029):2===e?t.cullFace(1028):t.cullFace(1032))):ct(2884),q=e}function yt(e,n,r){e?(st(32823),J===n&&X===r||(t.polygonOffset(n,r),J=n,X=r)):ct(32823)}function mt(e){void 0===e&&(e=33984+K-1),tt!==e&&(t.activeTexture(e),tt=e)}return{buffers:{color:s,depth:c,stencil:u},initAttributes:function(){for(var t=0,e=h.length;t<e;t++)h[t]=0},enableAttribute:function(t){at(t,0)},enableAttributeAndDivisor:at,disableUnusedAttributes:function(){for(var e=0,n=f.length;e!==n;++e)f[e]!==h[e]&&(t.disableVertexAttribArray(e),f[e]=0)},enable:st,disable:ct,useProgram:function(e){return L!==e&&(t.useProgram(e),L=e,!0)},setBlending:ft,setMaterial:function(t,e){t.side===d?ct(2884):st(2884);var n=t.side===p;e&&(n=!n),pt(n),t.blending===m&&!1===t.transparent?ft(y):ft(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),c.setFunc(t.depthFunc),c.setTest(t.depthTest),c.setMask(t.depthWrite),s.setMask(t.colorWrite);var r=t.stencilWrite;u.setTest(r),r&&(u.setMask(t.stencilWriteMask),u.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),u.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),yt(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)},setFlipSided:pt,setCullFace:dt,setLineWidth:function(e){e!==Y&&(Q&&t.lineWidth(e),Y=e)},setPolygonOffset:yt,setScissorTest:function(t){t?st(3089):ct(3089)},activeTexture:mt,bindTexture:function(e,n){null===tt&&mt();var r=et[tt];void 0===r&&(r={type:void 0,texture:void 0},et[tt]=r),r.type===e&&r.texture===n||(t.bindTexture(e,n||ot[e]),r.type=e,r.texture=n)},unbindTexture:function(){var e=et[tt];void 0!==e&&void 0!==e.type&&(t.bindTexture(e.type,null),e.type=void 0,e.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{t.texImage3D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(e){!1===nt.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),nt.copy(e))},viewport:function(e){!1===rt.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),rt.copy(e))},reset:function(){for(var e=0;e<f.length;e++)1===f[e]&&(t.disableVertexAttribArray(e),f[e]=0);k={},tt=null,et={},L=null,j=null,W=null,q=null,s.reset(),c.reset(),u.reset()}}}function vo(t,e,n,r,o,a,s){var c,u,l,h=o.isWebGL2,f=o.maxTextures,p=o.maxCubemapSize,d=o.maxTextureSize,y=o.maxSamples,m=new WeakMap,v=!1;try{v="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(t){}function g(t,e){return v?new OffscreenCanvas(t,e):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function b(t,e,n,r){var i=1;if((t.width>r||t.height>r)&&(i=r/Math.max(t.width,t.height)),i<1||!0===e){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){var o=e?At.floorPowerOfTwo:Math.floor,a=o(i*t.width),s=o(i*t.height);void 0===l&&(l=g(a,s));var c=n?g(a,s):l;return c.width=a,c.height=s,c.getContext("2d").drawImage(t,0,0,a,s),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+t.width+"x"+t.height+") to ("+a+"x"+s+")."),c}return"data"in t&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+t.width+"x"+t.height+")."),t}return t}function w(t){return At.isPowerOfTwo(t.width)&&At.isPowerOfTwo(t.height)}function _(t,e){return t.generateMipmaps&&e&&t.minFilter!==N&&t.minFilter!==z}function x(e,n,i,o){t.generateMipmap(e),r.get(n).__maxMipLevel=Math.log(Math.max(i,o))*Math.LOG2E}function S(n,r,i){if(!1===h)return r;if(null!==n){if(void 0!==t[n])return t[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}var o=r;return 6403===r&&(5126===i&&(o=33326),5131===i&&(o=33325),5121===i&&(o=33321)),6407===r&&(5126===i&&(o=34837),5131===i&&(o=34843),5121===i&&(o=32849)),6408===r&&(5126===i&&(o=34836),5131===i&&(o=34842),5121===i&&(o=32856)),33325!==o&&33326!==o&&34842!==o&&34836!==o||e.get("EXT_color_buffer_float"),o}function T(t){return t===N||t===j||t===F?9728:9729}function M(e){var n=e.target;n.removeEventListener("dispose",M),function(e){var n=r.get(e);if(void 0===n.__webglInit)return;t.deleteTexture(n.__webglTexture),r.remove(e)}(n),n.isVideoTexture&&m.delete(n),s.memory.textures--}function E(e){var n=e.target;n.removeEventListener("dispose",E),function(e){var n=r.get(e),i=r.get(e.texture);if(!e)return;void 0!==i.__webglTexture&&t.deleteTexture(i.__webglTexture);e.depthTexture&&e.depthTexture.dispose();if(e.isWebGLCubeRenderTarget)for(var o=0;o<6;o++)t.deleteFramebuffer(n.__webglFramebuffer[o]),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer[o]);else t.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer),n.__webglMultisampledFramebuffer&&t.deleteFramebuffer(n.__webglMultisampledFramebuffer),n.__webglColorRenderbuffer&&t.deleteRenderbuffer(n.__webglColorRenderbuffer),n.__webglDepthRenderbuffer&&t.deleteRenderbuffer(n.__webglDepthRenderbuffer);r.remove(e.texture),r.remove(e)}(n),s.memory.textures--}var P=0;function O(t,e){var i=r.get(t);if(t.isVideoTexture&&function(t){var e=s.render.frame;m.get(t)!==e&&(m.set(t,e),t.update())}(t),t.version>0&&i.__version!==t.version){var o=t.image;if(void 0===o)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==o.complete)return void H(i,t,e);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+e),n.bindTexture(3553,i.__webglTexture)}function A(e,i){if(6===e.image.length){var o=r.get(e);if(e.version>0&&o.__version!==e.version){U(o,e),n.activeTexture(33984+i),n.bindTexture(34067,o.__webglTexture),t.pixelStorei(37440,e.flipY);for(var s=e&&(e.isCompressedTexture||e.image[0].isCompressedTexture),c=e.image[0]&&e.image[0].isDataTexture,u=[],l=0;l<6;l++)u[l]=s||c?c?e.image[l].image:e.image[l]:b(e.image[l],!1,!0,p);var f,d=u[0],y=w(d)||h,m=a.convert(e.format),v=a.convert(e.type),g=S(e.internalFormat,m,v);if(B(34067,e,y),s){for(l=0;l<6;l++){f=u[l].mipmaps;for(var T=0;T<f.length;T++){var M=f[T];e.format!==ot&&e.format!==it?null!==m?n.compressedTexImage2D(34069+l,T,g,M.width,M.height,0,M.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(34069+l,T,g,M.width,M.height,0,m,v,M.data)}}o.__maxMipLevel=f.length-1}else{f=e.mipmaps;for(l=0;l<6;l++)if(c){n.texImage2D(34069+l,0,g,u[l].width,u[l].height,0,m,v,u[l].data);for(T=0;T<f.length;T++){var E=(M=f[T]).image[l].image;n.texImage2D(34069+l,T+1,g,E.width,E.height,0,m,v,E.data)}}else{n.texImage2D(34069+l,0,g,m,v,u[l]);for(T=0;T<f.length;T++){M=f[T];n.texImage2D(34069+l,T+1,g,m,v,M.image[l])}}o.__maxMipLevel=f.length}_(e,y)&&x(34067,e,d.width,d.height),o.__version=e.version,e.onUpdate&&e.onUpdate(e)}else n.activeTexture(33984+i),n.bindTexture(34067,o.__webglTexture)}}function D(t,e){n.activeTexture(33984+e),n.bindTexture(34067,r.get(t).__webglTexture)}var R=(i(c={},I,10497),i(c,k,33071),i(c,L,33648),c),C=(i(u={},N,9728),i(u,j,9984),i(u,F,9986),i(u,z,9729),i(u,G,9985),i(u,V,9987),u);function B(n,i,a){a?(t.texParameteri(n,10242,R[i.wrapS]),t.texParameteri(n,10243,R[i.wrapT]),32879!==n&&35866!==n||t.texParameteri(n,32882,R[i.wrapR]),t.texParameteri(n,10240,C[i.magFilter]),t.texParameteri(n,10241,C[i.minFilter])):(t.texParameteri(n,10242,33071),t.texParameteri(n,10243,33071),32879!==n&&35866!==n||t.texParameteri(n,32882,33071),i.wrapS===k&&i.wrapT===k||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(n,10240,T(i.magFilter)),t.texParameteri(n,10241,T(i.minFilter)),i.minFilter!==N&&i.minFilter!==z&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));var s=e.get("EXT_texture_filter_anisotropic");if(s){if(i.type===Z&&null===e.get("OES_texture_float_linear"))return;if(i.type===$&&null===(h||e.get("OES_texture_half_float_linear")))return;(i.anisotropy>1||r.get(i).__currentAnisotropy)&&(t.texParameterf(n,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(i.anisotropy,o.getMaxAnisotropy())),r.get(i).__currentAnisotropy=i.anisotropy)}}function U(e,n){void 0===e.__webglInit&&(e.__webglInit=!0,n.addEventListener("dispose",M),e.__webglTexture=t.createTexture(),s.memory.textures++)}function H(e,r,i){var o=3553;r.isDataTexture2DArray&&(o=35866),r.isDataTexture3D&&(o=32879),U(e,r),n.activeTexture(33984+i),n.bindTexture(o,e.__webglTexture),t.pixelStorei(37440,r.flipY),t.pixelStorei(37441,r.premultiplyAlpha),t.pixelStorei(3317,r.unpackAlignment);var s=function(t){return!h&&(t.wrapS!==k||t.wrapT!==k||t.minFilter!==N&&t.minFilter!==z)}(r)&&!1===w(r.image),c=b(r.image,s,!1,d),u=w(c)||h,l=a.convert(r.format),f=a.convert(r.type),p=S(r.internalFormat,l,f);B(o,r,u);var y,m=r.mipmaps;if(r.isDepthTexture)p=6402,h?p=r.type===Z?36012:r.type===Q?33190:1020===r.type?35056:33189:r.type===Z&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),1026===r.format&&6402===p&&r.type!==X&&r.type!==Q&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=X,f=a.convert(r.type)),1027===r.format&&6402===p&&(p=34041,1020!==r.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=1020,f=a.convert(r.type))),n.texImage2D(3553,0,p,c.width,c.height,0,l,f,null);else if(r.isDataTexture)if(m.length>0&&u){for(var v=0,g=m.length;v<g;v++)y=m[v],n.texImage2D(3553,v,p,y.width,y.height,0,l,f,y.data);r.generateMipmaps=!1,e.__maxMipLevel=m.length-1}else n.texImage2D(3553,0,p,c.width,c.height,0,l,f,c.data),e.__maxMipLevel=0;else if(r.isCompressedTexture){for(v=0,g=m.length;v<g;v++)y=m[v],r.format!==ot&&r.format!==it?null!==l?n.compressedTexImage2D(3553,v,p,y.width,y.height,0,y.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(3553,v,p,y.width,y.height,0,l,f,y.data);e.__maxMipLevel=m.length-1}else if(r.isDataTexture2DArray)n.texImage3D(35866,0,p,c.width,c.height,c.depth,0,l,f,c.data),e.__maxMipLevel=0;else if(r.isDataTexture3D)n.texImage3D(32879,0,p,c.width,c.height,c.depth,0,l,f,c.data),e.__maxMipLevel=0;else if(m.length>0&&u){for(v=0,g=m.length;v<g;v++)y=m[v],n.texImage2D(3553,v,p,l,f,y);r.generateMipmaps=!1,e.__maxMipLevel=m.length-1}else n.texImage2D(3553,0,p,l,f,c),e.__maxMipLevel=0;_(r,u)&&x(o,r,c.width,c.height),e.__version=r.version,r.onUpdate&&r.onUpdate(r)}function W(e,i,o,s){var c=a.convert(i.texture.format),u=a.convert(i.texture.type),l=S(i.texture.internalFormat,c,u);n.texImage2D(s,0,l,i.width,i.height,0,c,u,null),t.bindFramebuffer(36160,e),t.framebufferTexture2D(36160,o,s,r.get(i.texture).__webglTexture,0),t.bindFramebuffer(36160,null)}function q(e,n,r){if(t.bindRenderbuffer(36161,e),n.depthBuffer&&!n.stencilBuffer){var i=33189;if(r){var o=n.depthTexture;o&&o.isDepthTexture&&(o.type===Z?i=36012:o.type===Q&&(i=33190));var s=J(n);t.renderbufferStorageMultisample(36161,s,i,n.width,n.height)}else t.renderbufferStorage(36161,i,n.width,n.height);t.framebufferRenderbuffer(36160,36096,36161,e)}else if(n.depthBuffer&&n.stencilBuffer){if(r){s=J(n);t.renderbufferStorageMultisample(36161,s,35056,n.width,n.height)}else t.renderbufferStorage(36161,34041,n.width,n.height);t.framebufferRenderbuffer(36160,33306,36161,e)}else{var c=a.convert(n.texture.format),u=a.convert(n.texture.type);i=S(n.texture.internalFormat,c,u);if(r){s=J(n);t.renderbufferStorageMultisample(36161,s,i,n.width,n.height)}else t.renderbufferStorage(36161,i,n.width,n.height)}t.bindRenderbuffer(36161,null)}function Y(e){var n=r.get(e),i=!0===e.isWebGLCubeRenderTarget;if(e.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");!function(e,n){if(n&&n.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,e),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),O(n.depthTexture,0);var i=r.get(n.depthTexture).__webglTexture;if(1026===n.depthTexture.format)t.framebufferTexture2D(36160,36096,3553,i,0);else{if(1027!==n.depthTexture.format)throw new Error("Unknown depthTexture format");t.framebufferTexture2D(36160,33306,3553,i,0)}}(n.__webglFramebuffer,e)}else if(i){n.__webglDepthbuffer=[];for(var o=0;o<6;o++)t.bindFramebuffer(36160,n.__webglFramebuffer[o]),n.__webglDepthbuffer[o]=t.createRenderbuffer(),q(n.__webglDepthbuffer[o],e,!1)}else t.bindFramebuffer(36160,n.__webglFramebuffer),n.__webglDepthbuffer=t.createRenderbuffer(),q(n.__webglDepthbuffer,e,!1);t.bindFramebuffer(36160,null)}function J(t){return h&&t.isWebGLMultisampleRenderTarget?Math.min(y,t.samples):0}var K=!1,tt=!1;this.allocateTextureUnit=function(){var t=P;return t>=f&&console.warn("THREE.WebGLTextures: Trying to use "+t+" texture units while this GPU supports only "+f),P+=1,t},this.resetTextureUnits=function(){P=0},this.setTexture2D=O,this.setTexture2DArray=function(t,e){var i=r.get(t);t.version>0&&i.__version!==t.version?H(i,t,e):(n.activeTexture(33984+e),n.bindTexture(35866,i.__webglTexture))},this.setTexture3D=function(t,e){var i=r.get(t);t.version>0&&i.__version!==t.version?H(i,t,e):(n.activeTexture(33984+e),n.bindTexture(32879,i.__webglTexture))},this.setTextureCube=A,this.setTextureCubeDynamic=D,this.setupRenderTarget=function(e){var i=r.get(e),o=r.get(e.texture);e.addEventListener("dispose",E),o.__webglTexture=t.createTexture(),s.memory.textures++;var c=!0===e.isWebGLCubeRenderTarget,u=!0===e.isWebGLMultisampleRenderTarget,l=w(e)||h;if(!h||e.texture.format!==it||e.texture.type!==Z&&e.texture.type!==$||(e.texture.format=ot,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),c){i.__webglFramebuffer=[];for(var f=0;f<6;f++)i.__webglFramebuffer[f]=t.createFramebuffer()}else if(i.__webglFramebuffer=t.createFramebuffer(),u)if(h){i.__webglMultisampledFramebuffer=t.createFramebuffer(),i.__webglColorRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(36161,i.__webglColorRenderbuffer);var p=a.convert(e.texture.format),d=a.convert(e.texture.type),y=S(e.texture.internalFormat,p,d),m=J(e);t.renderbufferStorageMultisample(36161,m,y,e.width,e.height),t.bindFramebuffer(36160,i.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064,36161,i.__webglColorRenderbuffer),t.bindRenderbuffer(36161,null),e.depthBuffer&&(i.__webglDepthRenderbuffer=t.createRenderbuffer(),q(i.__webglDepthRenderbuffer,e,!0)),t.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(c){n.bindTexture(34067,o.__webglTexture),B(34067,e.texture,l);for(f=0;f<6;f++)W(i.__webglFramebuffer[f],e,36064,34069+f);_(e.texture,l)&&x(34067,e.texture,e.width,e.height),n.bindTexture(34067,null)}else n.bindTexture(3553,o.__webglTexture),B(3553,e.texture,l),W(i.__webglFramebuffer,e,36064,3553),_(e.texture,l)&&x(3553,e.texture,e.width,e.height),n.bindTexture(3553,null);e.depthBuffer&&Y(e)},this.updateRenderTargetMipmap=function(t){var e=t.texture;if(_(e,w(t)||h)){var i=t.isWebGLCubeRenderTarget?34067:3553,o=r.get(e).__webglTexture;n.bindTexture(i,o),x(i,e,t.width,t.height),n.bindTexture(i,null)}},this.updateMultisampleRenderTarget=function(e){if(e.isWebGLMultisampleRenderTarget)if(h){var n=r.get(e);t.bindFramebuffer(36008,n.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,n.__webglFramebuffer);var i=e.width,o=e.height,a=16384;e.depthBuffer&&(a|=256),e.stencilBuffer&&(a|=1024),t.blitFramebuffer(0,0,i,o,0,0,i,o,a,9728),t.bindFramebuffer(36160,n.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(t,e){t&&t.isWebGLRenderTarget&&(!1===K&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),K=!0),t=t.texture),O(t,e)},this.safeSetTextureCube=function(t,e){t&&t.isWebGLCubeRenderTarget&&(!1===tt&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),tt=!0),t=t.texture),t&&t.isCubeTexture||Array.isArray(t.image)&&6===t.image.length?A(t,e):D(t,e)}}function go(t,e,n){var r=n.isWebGL2;return{convert:function(t){var n;if(t===q)return 5121;if(t===tt)return 32819;if(t===et)return 32820;if(t===nt)return 33635;if(t===Y)return 5120;if(t===J)return 5122;if(t===X)return 5123;if(t===K)return 5124;if(t===Q)return 5125;if(t===Z)return 5126;if(t===$)return r?5131:null!==(n=e.get("OES_texture_half_float"))?n.HALF_FLOAT_OES:null;if(t===rt)return 6406;if(t===it)return 6407;if(t===ot)return 6408;if(t===at)return 6409;if(t===st)return 6410;if(1026===t)return 6402;if(1027===t)return 34041;if(1028===t)return 6403;if(1029===t)return 36244;if(1030===t)return 33319;if(1031===t)return 33320;if(1032===t)return 36248;if(1033===t)return 36249;if(t===ut||t===lt||t===ht||t===ft){if(null===(n=e.get("WEBGL_compressed_texture_s3tc")))return null;if(t===ut)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(t===lt)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(t===ht)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(t===ft)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(t===pt||t===dt||t===yt||t===mt){if(null===(n=e.get("WEBGL_compressed_texture_pvrtc")))return null;if(t===pt)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(t===dt)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(t===yt)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(t===mt)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(t===vt)return null!==(n=e.get("WEBGL_compressed_texture_etc1"))?n.COMPRESSED_RGB_ETC1_WEBGL:null;if((37492===t||37496===t)&&null!==(n=e.get("WEBGL_compressed_texture_etc"))){if(37492===t)return n.COMPRESSED_RGB8_ETC2;if(37496===t)return n.COMPRESSED_RGBA8_ETC2_EAC}return 37808===t||37809===t||37810===t||37811===t||37812===t||37813===t||37814===t||37815===t||37816===t||37817===t||37818===t||37819===t||37820===t||37821===t||37840===t||37841===t||37842===t||37843===t||37844===t||37845===t||37846===t||37847===t||37848===t||37849===t||37850===t||37851===t||37852===t||37853===t?null!==(n=e.get("WEBGL_compressed_texture_astc"))?t:null:36492===t?null!==(n=e.get("EXT_texture_compression_bptc"))?t:null:1020===t?r?34042:null!==(n=e.get("WEBGL_depth_texture"))?n.UNSIGNED_INT_24_8_WEBGL:null:void 0}}}function bo(t){fr.call(this),this.cameras=t||[]}function wo(){pe.call(this),this.type="Group"}function _o(t,e){var n=this,r=null,i=1,o=null,a="local-floor",s=null,c=[],u=new Map,l=new fr;l.layers.enable(1),l.viewport=new Lt;var h=new fr;h.layers.enable(2),h.viewport=new Lt;var f=new bo([l,h]);f.layers.enable(1),f.layers.enable(2);var p=null,d=null;function y(t){var e=u.get(t.inputSource);e&&(e.targetRay&&e.targetRay.dispatchEvent({type:t.type}),e.grip&&e.grip.dispatchEvent({type:t.type}))}function m(){u.forEach((function(t,e){t.targetRay&&(t.targetRay.dispatchEvent({type:"disconnected",data:e}),t.targetRay.visible=!1),t.grip&&(t.grip.dispatchEvent({type:"disconnected",data:e}),t.grip.visible=!1)})),u.clear(),t.setFramebuffer(null),t.setRenderTarget(t.getRenderTarget()),S.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function v(t){o=t,S.setContext(r),S.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}function g(t){for(var e=r.inputSources,n=0;n<c.length;n++)u.set(e[n],c[n]);for(n=0;n<t.removed.length;n++){var i=t.removed[n];(o=u.get(i))&&(o.targetRay&&o.targetRay.dispatchEvent({type:"disconnected",data:i}),o.grip&&o.grip.dispatchEvent({type:"disconnected",data:i}),u.delete(i))}for(n=0;n<t.added.length;n++){var o;i=t.added[n];(o=u.get(i))&&(o.targetRay&&o.targetRay.dispatchEvent({type:"connected",data:i}),o.grip&&o.grip.dispatchEvent({type:"connected",data:i}))}}this.enabled=!1,this.isPresenting=!1,this.getController=function(t){var e=c[t];return void 0===e&&(e={},c[t]=e),void 0===e.targetRay&&(e.targetRay=new wo,e.targetRay.matrixAutoUpdate=!1,e.targetRay.visible=!1),e.targetRay},this.getControllerGrip=function(t){var e=c[t];return void 0===e&&(e={},c[t]=e),void 0===e.grip&&(e.grip=new wo,e.grip.matrixAutoUpdate=!1,e.grip.visible=!1),e.grip},this.setFramebufferScaleFactor=function(t){i=t,1==n.isPresenting&&console.warn("WebXRManager: Cannot change framebuffer scale while presenting VR content")},this.setReferenceSpaceType=function(t){a=t},this.getReferenceSpace=function(){return o},this.getSession=function(){return r},this.setSession=function(t){if(null!==(r=t)){r.addEventListener("select",y),r.addEventListener("selectstart",y),r.addEventListener("selectend",y),r.addEventListener("squeeze",y),r.addEventListener("squeezestart",y),r.addEventListener("squeezeend",y),r.addEventListener("end",m);var n=e.getContextAttributes(),o={antialias:n.antialias,alpha:n.alpha,depth:n.depth,stencil:n.stencil,framebufferScaleFactor:i},s=new XRWebGLLayer(r,e,o);r.updateRenderState({baseLayer:s}),r.requestReferenceSpace(a).then(v),r.addEventListener("inputsourceschange",g)}};var b=new zt,w=new zt;function _(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.getInverse(t.matrixWorld)}this.getCamera=function(t){f.near=h.near=l.near=t.near,f.far=h.far=l.far=t.far,p===f.near&&d===f.far||(r.updateRenderState({depthNear:f.near,depthFar:f.far}),p=f.near,d=f.far);var e=t.parent,n=f.cameras;_(f,e);for(var i=0;i<n.length;i++)_(n[i],e);t.matrixWorld.copy(f.matrixWorld);for(var o=t.children,a=(i=0,o.length);i<a;i++)o[i].updateMatrixWorld(!0);return function(t,e,n){b.setFromMatrixPosition(e.matrixWorld),w.setFromMatrixPosition(n.matrixWorld);var r=b.distanceTo(w),i=e.projectionMatrix.elements,o=n.projectionMatrix.elements,a=i[14]/(i[10]-1),s=i[14]/(i[10]+1),c=(i[9]+1)/i[5],u=(i[9]-1)/i[5],l=(i[8]-1)/i[0],h=(o[8]+1)/o[0],f=a*l,p=a*h,d=r/(-l+h),y=d*-l;e.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(y),t.translateZ(d),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.getInverse(t.matrixWorld);var m=a+d,v=s+d,g=f-y,_=p+(r-y),x=c*s/v*m,S=u*s/v*m;t.projectionMatrix.makePerspective(g,_,x,S,m,v)}(f,l,h),f};var x=null;var S=new wr;S.setAnimationLoop((function(e,n){if(null!==(s=n.getViewerPose(o))){var i=s.views,a=r.renderState.baseLayer;t.setFramebuffer(a.framebuffer);for(var u=0;u<i.length;u++){var l=i[u],h=a.getViewport(l),p=f.cameras[u];p.matrix.fromArray(l.transform.matrix),p.projectionMatrix.fromArray(l.projectionMatrix),p.viewport.set(h.x,h.y,h.width,h.height),0===u&&f.matrix.copy(p.matrix)}}var d=r.inputSources;for(u=0;u<c.length;u++){var y=c[u],m=d[u],v=null,g=null;m&&(y.targetRay&&null!==(v=n.getPose(m.targetRaySpace,o))&&(y.targetRay.matrix.fromArray(v.transform.matrix),y.targetRay.matrix.decompose(y.targetRay.position,y.targetRay.rotation,y.targetRay.scale)),y.grip&&m.gripSpace&&null!==(g=n.getPose(m.gripSpace,o))&&(y.grip.matrix.fromArray(g.transform.matrix),y.grip.matrix.decompose(y.grip.position,y.grip.rotation,y.grip.scale))),y.targetRay&&(y.targetRay.visible=null!==v),y.grip&&(y.grip.visible=null!==g)}x&&x(e,n)})),this.setAnimationLoop=function(t){x=t},this.dispose=function(){}}function xo(t){var e=void 0!==(t=t||{}).canvas?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),n=void 0!==t.context?t.context:null,r=void 0!==t.alpha&&t.alpha,i=void 0===t.depth||t.depth,o=void 0===t.stencil||t.stencil,a=void 0!==t.antialias&&t.antialias,s=void 0===t.premultipliedAlpha||t.premultipliedAlpha,c=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,u=void 0!==t.powerPreference?t.powerPreference:"default",l=void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat,h=null,f=null;this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=3e3,this.physicallyCorrectLights=!1,this.toneMapping=1,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var d,y,m,v,g,b,w,_,x,S,T,M,E,P,O,A,D,R,C=this,I=!1,k=null,L=0,N=0,j=null,B=null,F=-1,U={geometry:null,program:null,wireframe:!1},z=null,G=null,H=new Lt,V=new Lt,W=null,Y=e.width,J=e.height,X=1,K=null,Q=null,tt=new Lt(0,0,Y,J),et=new Lt(0,0,Y,J),nt=!1,rt=new gr,it=new Ar,at=!1,st=!1,ct=new Xt,ut=new zt;function lt(){return null===j?X:1}try{var ht={alpha:r,depth:i,stencil:o,antialias:a,premultipliedAlpha:s,preserveDrawingBuffer:c,powerPreference:u,failIfMajorPerformanceCaveat:l,xrCompatible:!0};if(e.addEventListener("webglcontextlost",yt,!1),e.addEventListener("webglcontextrestored",mt,!1),null===(d=n||e.getContext("webgl",ht)||e.getContext("experimental-webgl",ht)))throw null!==e.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===d.getShaderPrecisionFormat&&(d.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(t){throw console.error("THREE.WebGLRenderer: "+t.message),t}function ft(){y=new Dr(d),!1===(m=new Or(d,y,t)).isWebGL2&&(y.get("WEBGL_depth_texture"),y.get("OES_texture_float"),y.get("OES_texture_half_float"),y.get("OES_texture_half_float_linear"),y.get("OES_standard_derivatives"),y.get("OES_element_index_uint"),y.get("ANGLE_instanced_arrays")),y.get("OES_texture_float_linear"),R=new go(d,y,m),(v=new mo(d,y,m)).scissor(V.copy(et).multiplyScalar(X).floor()),v.viewport(H.copy(tt).multiplyScalar(X).floor()),g=new Ir(d),b=new eo,w=new vo(d,y,v,b,m,R,g),_=new _r(d,m),x=new Rr(d,_,g),S=new Nr(d,x,_,g),O=new Lr(d),T=new to(C,y,m),M=new oo,E=new ho,P=new Er(C,v,S,s),A=new Pr(d,y,g,m),D=new Cr(d,y,g,m),g.programs=T.programs,C.capabilities=m,C.extensions=y,C.properties=b,C.renderLists=M,C.state=v,C.info=g}ft();var pt=new _o(C,d);this.xr=pt;var dt=new yo(C,S,m.maxTextureSize);function yt(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),I=!0}function mt(){console.log("THREE.WebGLRenderer: Context Restored."),I=!1,ft()}function vt(t){var e=t.target;e.removeEventListener("dispose",vt),function(t){gt(t),b.remove(t)}(e)}function gt(t){var e=b.get(t).program;t.program=void 0,void 0!==e&&T.releaseProgram(e)}this.shadowMap=dt,this.getContext=function(){return d},this.getContextAttributes=function(){return d.getContextAttributes()},this.forceContextLoss=function(){var t=y.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){var t=y.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return X},this.setPixelRatio=function(t){void 0!==t&&(X=t,this.setSize(Y,J,!1))},this.getSize=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),t=new Dt),t.set(Y,J)},this.setSize=function(t,n,r){pt.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(Y=t,J=n,e.width=Math.floor(t*X),e.height=Math.floor(n*X),!1!==r&&(e.style.width=t+"px",e.style.height=n+"px"),this.setViewport(0,0,t,n))},this.getDrawingBufferSize=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),t=new Dt),t.set(Y*X,J*X).floor()},this.setDrawingBufferSize=function(t,n,r){Y=t,J=n,X=r,e.width=Math.floor(t*r),e.height=Math.floor(n*r),this.setViewport(0,0,t,n)},this.getCurrentViewport=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),t=new Lt),t.copy(H)},this.getViewport=function(t){return t.copy(tt)},this.setViewport=function(t,e,n,r){t.isVector4?tt.set(t.x,t.y,t.z,t.w):tt.set(t,e,n,r),v.viewport(H.copy(tt).multiplyScalar(X).floor())},this.getScissor=function(t){return t.copy(et)},this.setScissor=function(t,e,n,r){t.isVector4?et.set(t.x,t.y,t.z,t.w):et.set(t,e,n,r),v.scissor(V.copy(et).multiplyScalar(X).floor())},this.getScissorTest=function(){return nt},this.setScissorTest=function(t){v.setScissorTest(nt=t)},this.setOpaqueSort=function(t){K=t},this.setTransparentSort=function(t){Q=t},this.getClearColor=function(){return P.getClearColor()},this.setClearColor=function(){P.setClearColor.apply(P,arguments)},this.getClearAlpha=function(){return P.getClearAlpha()},this.setClearAlpha=function(){P.setClearAlpha.apply(P,arguments)},this.clear=function(t,e,n){var r=0;(void 0===t||t)&&(r|=16384),(void 0===e||e)&&(r|=256),(void 0===n||n)&&(r|=1024),d.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",yt,!1),e.removeEventListener("webglcontextrestored",mt,!1),M.dispose(),E.dispose(),b.dispose(),S.dispose(),pt.dispose(),_t.stop(),this.forceContextLoss()},this.renderBufferImmediate=function(t,e){v.initAttributes();var n=b.get(t);t.hasPositions&&!n.position&&(n.position=d.createBuffer()),t.hasNormals&&!n.normal&&(n.normal=d.createBuffer()),t.hasUvs&&!n.uv&&(n.uv=d.createBuffer()),t.hasColors&&!n.color&&(n.color=d.createBuffer());var r=e.getAttributes();t.hasPositions&&(d.bindBuffer(34962,n.position),d.bufferData(34962,t.positionArray,35048),v.enableAttribute(r.position),d.vertexAttribPointer(r.position,3,5126,!1,0,0)),t.hasNormals&&(d.bindBuffer(34962,n.normal),d.bufferData(34962,t.normalArray,35048),v.enableAttribute(r.normal),d.vertexAttribPointer(r.normal,3,5126,!1,0,0)),t.hasUvs&&(d.bindBuffer(34962,n.uv),d.bufferData(34962,t.uvArray,35048),v.enableAttribute(r.uv),d.vertexAttribPointer(r.uv,2,5126,!1,0,0)),t.hasColors&&(d.bindBuffer(34962,n.color),d.bufferData(34962,t.colorArray,35048),v.enableAttribute(r.color),d.vertexAttribPointer(r.color,3,5126,!1,0,0)),v.disableUnusedAttributes(),d.drawArrays(4,0,t.count),t.count=0};var bt=new de;this.renderBufferDirect=function(t,e,n,r,i,o){null===e&&(e=bt);var a=i.isMesh&&i.matrixWorld.determinant()<0,s=Et(t,e,r,i);v.setMaterial(r,a);var c=!1;U.geometry===n.id&&U.program===s.id&&U.wireframe===(!0===r.wireframe)||(U.geometry=n.id,U.program=s.id,U.wireframe=!0===r.wireframe,c=!0),(r.morphTargets||r.morphNormals)&&(O.update(i,n,r,s),c=!0);var u=n.index,l=n.attributes.position;if(null===u){if(void 0===l||0===l.count)return}else if(0===u.count)return;var h,f=1;!0===r.wireframe&&(u=x.getWireframeAttribute(n),f=2);var p=A;null!==u&&(h=_.get(u),(p=D).setIndex(h)),c&&(!function(t,e,n,r){if(!1===m.isWebGL2&&(t.isInstancedMesh||e.isInstancedBufferGeometry)&&null===y.get("ANGLE_instanced_arrays"))return;v.initAttributes();var i=e.attributes,o=r.getAttributes(),a=n.defaultAttributeValues;for(var s in o){var c=o[s];if(c>=0){var u=i[s];if(void 0!==u){var l=u.normalized,h=u.itemSize;if(void 0===(S=_.get(u)))continue;var f=S.buffer,p=S.type,g=S.bytesPerElement;if(u.isInterleavedBufferAttribute){var b=u.data,w=b.stride,x=u.offset;b&&b.isInstancedInterleavedBuffer?(v.enableAttributeAndDivisor(c,b.meshPerAttribute),void 0===e.maxInstancedCount&&(e.maxInstancedCount=b.meshPerAttribute*b.count)):v.enableAttribute(c),d.bindBuffer(34962,f),d.vertexAttribPointer(c,h,p,l,w*g,x*g)}else u.isInstancedBufferAttribute?(v.enableAttributeAndDivisor(c,u.meshPerAttribute),void 0===e.maxInstancedCount&&(e.maxInstancedCount=u.meshPerAttribute*u.count)):v.enableAttribute(c),d.bindBuffer(34962,f),d.vertexAttribPointer(c,h,p,l,0,0)}else if("instanceMatrix"===s){var S;if(void 0===(S=_.get(t.instanceMatrix)))continue;f=S.buffer,p=S.type;v.enableAttributeAndDivisor(c+0,1),v.enableAttributeAndDivisor(c+1,1),v.enableAttributeAndDivisor(c+2,1),v.enableAttributeAndDivisor(c+3,1),d.bindBuffer(34962,f),d.vertexAttribPointer(c+0,4,p,!1,64,0),d.vertexAttribPointer(c+1,4,p,!1,64,16),d.vertexAttribPointer(c+2,4,p,!1,64,32),d.vertexAttribPointer(c+3,4,p,!1,64,48)}else if(void 0!==a){var T=a[s];if(void 0!==T)switch(T.length){case 2:d.vertexAttrib2fv(c,T);break;case 3:d.vertexAttrib3fv(c,T);break;case 4:d.vertexAttrib4fv(c,T);break;default:d.vertexAttrib1fv(c,T)}}}}v.disableUnusedAttributes()}(i,n,r,s),null!==u&&d.bindBuffer(34963,h.buffer));var g=null!==u?u.count:l.count,b=n.drawRange.start*f,w=n.drawRange.count*f,S=null!==o?o.start*f:0,T=null!==o?o.count*f:1/0,M=Math.max(b,S),E=Math.min(g,b+w,S+T)-1,P=Math.max(0,E-M+1);if(0!==P){if(i.isMesh)!0===r.wireframe?(v.setLineWidth(r.wireframeLinewidth*lt()),p.setMode(1)):p.setMode(4);else if(i.isLine){var R=r.linewidth;void 0===R&&(R=1),v.setLineWidth(R*lt()),i.isLineSegments?p.setMode(1):i.isLineLoop?p.setMode(2):p.setMode(3)}else i.isPoints?p.setMode(0):i.isSprite&&p.setMode(4);i.isInstancedMesh?p.renderInstances(n,M,P,i.count):n.isInstancedBufferGeometry?p.renderInstances(n,M,P,n.maxInstancedCount):p.render(M,P)}},this.compile=function(t,e){(f=E.get(t,e)).init(),t.traverse((function(t){t.isLight&&(f.pushLight(t),t.castShadow&&f.pushShadow(t))})),f.setupLights(e);var n={};t.traverse((function(e){if(e.material)if(Array.isArray(e.material))for(var r=0;r<e.material.length;r++)e.material[r].uuid in n==!1&&(Mt(e.material[r],t,e),n[e.material[r].uuid]=!0);else e.material.uuid in n==!1&&(Mt(e.material,t,e),n[e.material.uuid]=!0)}))};var wt=null;var _t=new wr;function xt(t,e,n,r){if(!1!==t.visible){if(t.layers.test(e.layers))if(t.isGroup)n=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(e);else if(t.isLight)f.pushLight(t),t.castShadow&&f.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||rt.intersectsSprite(t)){r&&ut.setFromMatrixPosition(t.matrixWorld).applyMatrix4(ct);var i=S.update(t);(o=t.material).visible&&h.push(t,i,o,n,ut.z,null)}}else if(t.isImmediateRenderObject)r&&ut.setFromMatrixPosition(t.matrixWorld).applyMatrix4(ct),h.push(t,null,t.material,n,ut.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.frame!==g.render.frame&&(t.skeleton.update(),t.skeleton.frame=g.render.frame),!t.frustumCulled||rt.intersectsObject(t))){r&&ut.setFromMatrixPosition(t.matrixWorld).applyMatrix4(ct);i=S.update(t);var o=t.material;if(Array.isArray(o))for(var a=i.groups,s=0,c=a.length;s<c;s++){var u=a[s],l=o[u.materialIndex];l&&l.visible&&h.push(t,i,l,n,ut.z,u)}else o.visible&&h.push(t,i,o,n,ut.z,null)}var p=t.children;for(s=0,c=p.length;s<c;s++)xt(p[s],e,n,r)}}function St(t,e,n,r){for(var i=0,o=t.length;i<o;i++){var a=t[i],s=a.object,c=a.geometry,u=void 0===r?a.material:r,l=a.group;if(n.isArrayCamera){G=n;for(var h=n.cameras,p=0,d=h.length;p<d;p++){var y=h[p];s.layers.test(y.layers)&&(v.viewport(H.copy(y.viewport)),f.setupLights(y),Tt(s,e,y,c,u,l))}}else G=null,Tt(s,e,n,c,u,l)}}function Tt(t,e,n,r,i,o){if(t.onBeforeRender(C,e,n,r,i,o),f=E.get(e,G||n),t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.isImmediateRenderObject){var a=Et(n,e,i,t);v.setMaterial(i),U.geometry=null,U.program=null,U.wireframe=!1,function(t,e){t.render((function(t){C.renderBufferImmediate(t,e)}))}(t,a)}else C.renderBufferDirect(n,e,r,i,t,o);t.onAfterRender(C,e,n,r,i,o),f=E.get(e,G||n)}function Mt(t,e,n){var r=b.get(t),i=f.state.lights,o=f.state.shadowsArray,a=i.state.version,s=T.getParameters(t,i.state,o,e,it.numPlanes,it.numIntersection,n),c=T.getProgramCacheKey(s),u=r.program,l=!0;if(void 0===u)t.addEventListener("dispose",vt);else if(u.cacheKey!==c)gt(t);else if(r.lightsStateVersion!==a)r.lightsStateVersion=a,l=!1;else{if(void 0!==s.shaderID)return;l=!1}l&&(u=T.acquireProgram(s,c),r.program=u,r.uniforms=s.uniforms,r.environment=t.isMeshStandardMaterial?e.environment:null,r.outputEncoding=C.outputEncoding,t.program=u);var h=u.getAttributes();if(t.morphTargets){t.numSupportedMorphTargets=0;for(var p=0;p<C.maxMorphTargets;p++)h["morphTarget"+p]>=0&&t.numSupportedMorphTargets++}if(t.morphNormals){t.numSupportedMorphNormals=0;for(p=0;p<C.maxMorphNormals;p++)h["morphNormal"+p]>=0&&t.numSupportedMorphNormals++}var d=r.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(r.numClippingPlanes=it.numPlanes,r.numIntersection=it.numIntersection,d.clippingPlanes=it.uniform),r.fog=e.fog,r.needsLights=function(t){return t.isMeshLambertMaterial||t.isMeshToonMaterial||t.isMeshPhongMaterial||t.isMeshStandardMaterial||t.isShadowMaterial||t.isShaderMaterial&&!0===t.lights}(t),r.lightsStateVersion=a,r.needsLights&&(d.ambientLightColor.value=i.state.ambient,d.lightProbe.value=i.state.probe,d.directionalLights.value=i.state.directional,d.directionalLightShadows.value=i.state.directionalShadow,d.spotLights.value=i.state.spot,d.spotLightShadows.value=i.state.spotShadow,d.rectAreaLights.value=i.state.rectArea,d.pointLights.value=i.state.point,d.pointLightShadows.value=i.state.pointShadow,d.hemisphereLights.value=i.state.hemi,d.directionalShadowMap.value=i.state.directionalShadowMap,d.directionalShadowMatrix.value=i.state.directionalShadowMatrix,d.spotShadowMap.value=i.state.spotShadowMap,d.spotShadowMatrix.value=i.state.spotShadowMatrix,d.pointShadowMap.value=i.state.pointShadowMap,d.pointShadowMatrix.value=i.state.pointShadowMatrix);var y=r.program.getUniforms(),m=ki.seqWithValue(y.seq,d);r.uniformsList=m}function Et(t,e,n,r){w.resetTextureUnits();var i=e.fog,o=n.isMeshStandardMaterial?e.environment:null,a=b.get(n),s=f.state.lights;if(at&&(st||t!==z)){var c=t===z&&n.id===F;it.setState(n.clippingPlanes,n.clipIntersection,n.clipShadows,t,a,c)}n.version===a.__version?void 0===a.program?Mt(n,e,r):n.fog&&a.fog!==i?Mt(n,e,r):a.environment!==o?Mt(n,e,r):a.needsLights&&a.lightsStateVersion!==s.state.version?Mt(n,e,r):void 0===a.numClippingPlanes||a.numClippingPlanes===it.numPlanes&&a.numIntersection===it.numIntersection?a.outputEncoding!==C.outputEncoding&&Mt(n,e,r):Mt(n,e,r):(Mt(n,e,r),a.__version=n.version);var u,l,h=!1,y=!1,g=!1,_=a.program,x=_.getUniforms(),S=a.uniforms;if(v.useProgram(_.program)&&(h=!0,y=!0,g=!0),n.id!==F&&(F=n.id,y=!0),h||z!==t){if(x.setValue(d,"projectionMatrix",t.projectionMatrix),m.logarithmicDepthBuffer&&x.setValue(d,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),z!==t&&(z=t,y=!0,g=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshStandardMaterial||n.envMap){var T=x.map.cameraPosition;void 0!==T&&T.setValue(d,ut.setFromMatrixPosition(t.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&x.setValue(d,"isOrthographic",!0===t.isOrthographicCamera),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.skinning)&&x.setValue(d,"viewMatrix",t.matrixWorldInverse)}if(n.skinning){x.setOptional(d,r,"bindMatrix"),x.setOptional(d,r,"bindMatrixInverse");var M=r.skeleton;if(M){var E=M.bones;if(m.floatVertexTextures){if(void 0===M.boneTexture){var P=Math.sqrt(4*E.length);P=At.ceilPowerOfTwo(P),P=Math.max(P,4);var O=new Float32Array(P*P*4);O.set(M.boneMatrices);var A=new yr(O,P,P,ot,Z);M.boneMatrices=O,M.boneTexture=A,M.boneTextureSize=P}x.setValue(d,"boneTexture",M.boneTexture,w),x.setValue(d,"boneTextureSize",M.boneTextureSize)}else x.setOptional(d,M,"boneMatrices")}}return(y||a.receiveShadow!==r.receiveShadow)&&(a.receiveShadow=r.receiveShadow,x.setValue(d,"receiveShadow",r.receiveShadow)),y&&(x.setValue(d,"toneMappingExposure",C.toneMappingExposure),x.setValue(d,"toneMappingWhitePoint",C.toneMappingWhitePoint),a.needsLights&&(l=g,(u=S).ambientLightColor.needsUpdate=l,u.lightProbe.needsUpdate=l,u.directionalLights.needsUpdate=l,u.directionalLightShadows.needsUpdate=l,u.pointLights.needsUpdate=l,u.pointLightShadows.needsUpdate=l,u.spotLights.needsUpdate=l,u.spotLightShadows.needsUpdate=l,u.rectAreaLights.needsUpdate=l,u.hemisphereLights.needsUpdate=l),i&&n.fog&&function(t,e){t.fogColor.value.copy(e.color),e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)}(S,i),n.isMeshBasicMaterial?Pt(S,n):n.isMeshLambertMaterial?(Pt(S,n),function(t,e){e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)}(S,n)):n.isMeshToonMaterial?(Pt(S,n),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4),e.gradientMap&&(t.gradientMap.value=e.gradientMap);e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap);e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===p&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===p&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(S,n)):n.isMeshPhongMaterial?(Pt(S,n),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap);e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===p&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===p&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(S,n)):n.isMeshStandardMaterial?(Pt(S,n,o),n.isMeshPhysicalMaterial?function(t,e,n){Ot(t,e,n),t.reflectivity.value=e.reflectivity,t.clearcoat.value=e.clearcoat,t.clearcoatRoughness.value=e.clearcoatRoughness,e.sheen&&t.sheen.value.copy(e.sheen);e.clearcoatMap&&(t.clearcoatMap.value=e.clearcoatMap);e.clearcoatRoughnessMap&&(t.clearcoatRoughnessMap.value=e.clearcoatRoughnessMap);e.clearcoatNormalMap&&(t.clearcoatNormalScale.value.copy(e.clearcoatNormalScale),t.clearcoatNormalMap.value=e.clearcoatNormalMap,e.side===p&&t.clearcoatNormalScale.value.negate());t.transparency.value=e.transparency}(S,n,o):Ot(S,n,o)):n.isMeshMatcapMaterial?(Pt(S,n),function(t,e){e.matcap&&(t.matcap.value=e.matcap);e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===p&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===p&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(S,n)):n.isMeshDepthMaterial?(Pt(S,n),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(S,n)):n.isMeshDistanceMaterial?(Pt(S,n),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias);t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance}(S,n)):n.isMeshNormalMaterial?(Pt(S,n),function(t,e){e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===p&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===p&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(S,n)):n.isLineBasicMaterial?(function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity}(S,n),n.isLineDashedMaterial&&function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}(S,n)):n.isPointsMaterial?function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.size.value=e.size*X,t.scale.value=.5*J,e.map&&(t.map.value=e.map);e.alphaMap&&(t.alphaMap.value=e.alphaMap);var n;e.map?n=e.map:e.alphaMap&&(n=e.alphaMap);void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),t.uvTransform.value.copy(n.matrix))}(S,n):n.isSpriteMaterial?function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.rotation.value=e.rotation,e.map&&(t.map.value=e.map);e.alphaMap&&(t.alphaMap.value=e.alphaMap);var n;e.map?n=e.map:e.alphaMap&&(n=e.alphaMap);void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),t.uvTransform.value.copy(n.matrix))}(S,n):n.isShadowMaterial&&(S.color.value.copy(n.color),S.opacity.value=n.opacity),void 0!==S.ltc_1&&(S.ltc_1.value=br.LTC_1),void 0!==S.ltc_2&&(S.ltc_2.value=br.LTC_2),ki.upload(d,a.uniformsList,S,w),n.isShaderMaterial&&(n.uniformsNeedUpdate=!1)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(ki.upload(d,a.uniformsList,S,w),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&x.setValue(d,"center",r.center),x.setValue(d,"modelViewMatrix",r.modelViewMatrix),x.setValue(d,"normalMatrix",r.normalMatrix),x.setValue(d,"modelMatrix",r.matrixWorld),_}function Pt(t,e,n){t.opacity.value=e.opacity,e.color&&t.diffuse.value.copy(e.color),e.emissive&&t.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity),e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.specularMap&&(t.specularMap.value=e.specularMap);var r,i,o=e.envMap||n;o&&(t.envMap.value=o,t.flipEnvMap.value=o.isCubeTexture?-1:1,t.reflectivity.value=e.reflectivity,t.refractionRatio.value=e.refractionRatio,t.maxMipLevel.value=b.get(o).__maxMipLevel),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.aoMap&&(t.aoMap.value=e.aoMap,t.aoMapIntensity.value=e.aoMapIntensity),e.map?r=e.map:e.specularMap?r=e.specularMap:e.displacementMap?r=e.displacementMap:e.normalMap?r=e.normalMap:e.bumpMap?r=e.bumpMap:e.roughnessMap?r=e.roughnessMap:e.metalnessMap?r=e.metalnessMap:e.alphaMap?r=e.alphaMap:e.emissiveMap&&(r=e.emissiveMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),t.uvTransform.value.copy(r.matrix)),e.aoMap?i=e.aoMap:e.lightMap&&(i=e.lightMap),void 0!==i&&(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate&&i.updateMatrix(),t.uv2Transform.value.copy(i.matrix))}function Ot(t,e,n){t.roughness.value=e.roughness,t.metalness.value=e.metalness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap),e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===p&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===p&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),(e.envMap||n)&&(t.envMapIntensity.value=e.envMapIntensity)}_t.setAnimationLoop((function(t){pt.isPresenting||wt&&wt(t)})),"undefined"!=typeof window&&_t.setContext(window),this.setAnimationLoop=function(t){wt=t,pt.setAnimationLoop(t),_t.start()},this.render=function(t,e){var n,r;if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),n=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),r=arguments[3]),e&&e.isCamera){if(!I){U.geometry=null,U.program=null,U.wireframe=!1,F=-1,z=null,!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),pt.enabled&&pt.isPresenting&&(e=pt.getCamera(e)),(f=E.get(t,e)).init(),t.onBeforeRender(C,t,e,n||j),ct.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),rt.setFromProjectionMatrix(ct),st=this.localClippingEnabled,at=it.init(this.clippingPlanes,st,e),(h=M.get(t,e)).init(),xt(t,e,0,C.sortObjects),h.finish(),!0===C.sortObjects&&h.sort(K,Q),at&&it.beginShadows();var i=f.state.shadowsArray;dt.render(i,t,e),f.setupLights(e),at&&it.endShadows(),this.info.autoReset&&this.info.reset(),void 0!==n&&this.setRenderTarget(n),P.render(h,t,e,r);var o=h.opaque,a=h.transparent;if(t.overrideMaterial){var s=t.overrideMaterial;o.length&&St(o,t,e,s),a.length&&St(a,t,e,s)}else o.length&&St(o,t,e),a.length&&St(a,t,e);t.onAfterRender(C,t,e),null!==j&&(w.updateRenderTargetMipmap(j),w.updateMultisampleRenderTarget(j)),v.buffers.depth.setTest(!0),v.buffers.depth.setMask(!0),v.buffers.color.setMask(!0),v.setPolygonOffset(!1),h=null,f=null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFramebuffer=function(t){k!==t&&null===j&&d.bindFramebuffer(36160,t),k=t},this.getActiveCubeFace=function(){return L},this.getActiveMipmapLevel=function(){return N},this.getRenderTarget=function(){return j},this.setRenderTarget=function(t,e,n){j=t,L=e,N=n,t&&void 0===b.get(t).__webglFramebuffer&&w.setupRenderTarget(t);var r=k,i=!1;if(t){var o=b.get(t).__webglFramebuffer;t.isWebGLCubeRenderTarget?(r=o[e||0],i=!0):r=t.isWebGLMultisampleRenderTarget?b.get(t).__webglMultisampledFramebuffer:o,H.copy(t.viewport),V.copy(t.scissor),W=t.scissorTest}else H.copy(tt).multiplyScalar(X).floor(),V.copy(et).multiplyScalar(X).floor(),W=nt;if(B!==r&&(d.bindFramebuffer(36160,r),B=r),v.viewport(H),v.scissor(V),v.setScissorTest(W),i){var a=b.get(t.texture);d.framebufferTexture2D(36160,36064,34069+(e||0),a.__webglTexture,n||0)}},this.readRenderTargetPixels=function(t,e,n,r,i,o,a){if(t&&t.isWebGLRenderTarget){var s=b.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==a&&(s=s[a]),s){var c=!1;s!==B&&(d.bindFramebuffer(36160,s),c=!0);try{var u=t.texture,l=u.format,h=u.type;if(l!==ot&&R.convert(l)!==d.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(h===q||R.convert(h)===d.getParameter(35738)||h===Z&&(m.isWebGL2||y.get("OES_texture_float")||y.get("WEBGL_color_buffer_float"))||h===$&&(m.isWebGL2?y.get("EXT_color_buffer_float"):y.get("EXT_color_buffer_half_float"))))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===d.checkFramebufferStatus(36160)?e>=0&&e<=t.width-r&&n>=0&&n<=t.height-i&&d.readPixels(e,n,r,i,R.convert(l),R.convert(h),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{c&&d.bindFramebuffer(36160,B)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(t,e,n){void 0===n&&(n=0);var r=Math.pow(2,-n),i=Math.floor(e.image.width*r),o=Math.floor(e.image.height*r),a=R.convert(e.format);w.setTexture2D(e,0),d.copyTexImage2D(3553,n,a,t.x,t.y,i,o,0),v.unbindTexture()},this.copyTextureToTexture=function(t,e,n,r){var i=e.image.width,o=e.image.height,a=R.convert(n.format),s=R.convert(n.type);w.setTexture2D(n,0),e.isDataTexture?d.texSubImage2D(3553,r||0,t.x,t.y,i,o,a,s,e.image.data):d.texSubImage2D(3553,r||0,t.x,t.y,a,s,e.image),v.unbindTexture()},this.initTexture=function(t){w.setTexture2D(t,0),v.unbindTexture()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function So(t,e){this.name="",this.color=new on(t),this.density=void 0!==e?e:25e-5}function To(t,e,n){this.name="",this.color=new on(t),this.near=void 0!==e?e:1,this.far=void 0!==n?n:1e3}function Mo(t,e){this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}bo.prototype=Object.assign(Object.create(fr.prototype),{constructor:bo,isArrayCamera:!0}),wo.prototype=Object.assign(Object.create(pe.prototype),{constructor:wo,isGroup:!0}),Object.assign(_o.prototype,Mt.prototype),Object.assign(So.prototype,{isFogExp2:!0,clone:function(){return new So(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),Object.assign(To.prototype,{isFog:!0,clone:function(){return new To(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),Object.defineProperty(Mo.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(Mo.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this},copyAt:function(t,e,n){t*=this.stride,n*=e.stride;for(var r=0,i=this.stride;r<i;r++)this.array[t+r]=e.array[n+r];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(t){return this.onUploadCallback=t,this}});var Eo,Po=new zt;function Oo(t,e,n,r){this.data=t,this.itemSize=e,this.offset=n,this.normalized=!0===r}function Ao(t){hn.call(this),this.type="SpriteMaterial",this.color=new on(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(t)}Object.defineProperties(Oo.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(Oo.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(t){for(var e=0,n=this.data.count;e<n;e++)Po.x=this.getX(e),Po.y=this.getY(e),Po.z=this.getZ(e),Po.applyMatrix4(t),this.setXYZ(e,Po.x,Po.y,Po.z);return this},setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this},setXYZ:function(t,e,n,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this},setXYZW:function(t,e,n,r,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this.data.array[t+3]=i,this}}),Ao.prototype=Object.create(hn.prototype),Ao.prototype.constructor=Ao,Ao.prototype.isSpriteMaterial=!0,Ao.prototype.copy=function(t){return hn.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this};var Do=new zt,Ro=new zt,Co=new zt,Io=new Dt,ko=new Dt,Lo=new Xt,No=new zt,jo=new zt,Bo=new zt,Fo=new Dt,Uo=new Dt,zo=new Dt;function Go(t){if(pe.call(this),this.type="Sprite",void 0===Eo){Eo=new In;var e=new Mo(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);Eo.setIndex([0,1,2,0,2,3]),Eo.setAttribute("position",new Oo(e,3,0,!1)),Eo.setAttribute("uv",new Oo(e,2,3,!1))}this.geometry=Eo,this.material=void 0!==t?t:new Ao,this.center=new Dt(.5,.5)}function Ho(t,e,n,r,i,o){Io.subVectors(t,n).addScalar(.5).multiply(r),void 0!==i?(ko.x=o*Io.x-i*Io.y,ko.y=i*Io.x+o*Io.y):ko.copy(Io),t.copy(e),t.x+=ko.x,t.y+=ko.y,t.applyMatrix4(Lo)}Go.prototype=Object.assign(Object.create(pe.prototype),{constructor:Go,isSprite:!0,raycast:function(t,e){null===t.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Ro.setFromMatrixScale(this.matrixWorld),Lo.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),Co.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Ro.multiplyScalar(-Co.z);var n,r,i=this.material.rotation;0!==i&&(r=Math.cos(i),n=Math.sin(i));var o=this.center;Ho(No.set(-.5,-.5,0),Co,o,Ro,n,r),Ho(jo.set(.5,-.5,0),Co,o,Ro,n,r),Ho(Bo.set(.5,.5,0),Co,o,Ro,n,r),Fo.set(0,0),Uo.set(1,0),zo.set(1,1);var a=t.ray.intersectTriangle(No,jo,Bo,!1,Do);if(null!==a||(Ho(jo.set(-.5,.5,0),Co,o,Ro,n,r),Uo.set(0,1),null!==(a=t.ray.intersectTriangle(No,Bo,jo,!1,Do)))){var s=t.ray.origin.distanceTo(Do);s<t.near||s>t.far||e.push({distance:s,point:Do.clone(),uv:tn.getUV(Do,No,jo,Bo,Fo,Uo,zo,new Dt),face:null,object:this})}},clone:function(){return new this.constructor(this.material).copy(this)},copy:function(t){return pe.prototype.copy.call(this,t),void 0!==t.center&&this.center.copy(t.center),this}});var Vo=new zt,Wo=new zt;function qo(){pe.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}function Yo(t,e){t&&t.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Qn.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Xt,this.bindMatrixInverse=new Xt}qo.prototype=Object.assign(Object.create(pe.prototype),{constructor:qo,isLOD:!0,copy:function(t){pe.prototype.copy.call(this,t,!1);for(var e=t.levels,n=0,r=e.length;n<r;n++){var i=e[n];this.addLevel(i.object.clone(),i.distance)}return this.autoUpdate=t.autoUpdate,this},addLevel:function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var n=this.levels,r=0;r<n.length&&!(e<n[r].distance);r++);return n.splice(r,0,{distance:e,object:t}),this.add(t),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(t){var e=this.levels;if(e.length>0){for(var n=1,r=e.length;n<r&&!(t<e[n].distance);n++);return e[n-1].object}return null},raycast:function(t,e){if(this.levels.length>0){Vo.setFromMatrixPosition(this.matrixWorld);var n=t.ray.origin.distanceTo(Vo);this.getObjectForDistance(n).raycast(t,e)}},update:function(t){var e=this.levels;if(e.length>1){Vo.setFromMatrixPosition(t.matrixWorld),Wo.setFromMatrixPosition(this.matrixWorld);var n=Vo.distanceTo(Wo)/t.zoom;e[0].object.visible=!0;for(var r=1,i=e.length;r<i&&n>=e[r].distance;r++)e[r-1].object.visible=!1,e[r].object.visible=!0;for(this._currentLevel=r-1;r<i;r++)e[r].object.visible=!1}},toJSON:function(t){var e=pe.prototype.toJSON.call(this,t);!1===this.autoUpdate&&(e.object.autoUpdate=!1),e.object.levels=[];for(var n=this.levels,r=0,i=n.length;r<i;r++){var o=n[r];e.object.levels.push({object:o.object.uuid,distance:o.distance})}return e}}),Yo.prototype=Object.assign(Object.create(Qn.prototype),{constructor:Yo,isSkinnedMesh:!0,bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var t=new Lt,e=this.geometry.attributes.skinWeight,n=0,r=e.count;n<r;n++){t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.w=e.getW(n);var i=1/t.manhattanLength();i!==1/0?t.multiplyScalar(i):t.set(1,0,0,0),e.setXYZW(n,t.x,t.y,t.z,t.w)}},updateMatrixWorld:function(t){Qn.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Jo=new Xt,Xo=new Xt;function Ko(t,e){if(t=t||[],this.bones=t.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),this.frame=-1,void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new Xt)}}function Qo(){pe.call(this),this.type="Bone"}Object.assign(Ko.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var n=new Xt;this.bones[t]&&n.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(n)}},pose:function(){var t,e,n;for(e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&t.matrixWorld.getInverse(this.boneInverses[e]);for(e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:function(){for(var t=this.bones,e=this.boneInverses,n=this.boneMatrices,r=this.boneTexture,i=0,o=t.length;i<o;i++){var a=t[i]?t[i].matrixWorld:Xo;Jo.multiplyMatrices(a,e[i]),Jo.toArray(n,16*i)}void 0!==r&&(r.needsUpdate=!0)},clone:function(){return new Ko(this.bones,this.boneInverses)},getBoneByName:function(t){for(var e=0,n=this.bones.length;e<n;e++){var r=this.bones[e];if(r.name===t)return r}},dispose:function(){this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=void 0)}}),Qo.prototype=Object.assign(Object.create(pe.prototype),{constructor:Qo,isBone:!0});var Zo=new Xt,$o=new Xt,ta=[],ea=new Qn;function na(t,e,n){Qn.call(this,t,e),this.instanceMatrix=new dn(new Float32Array(16*n),16),this.count=n,this.frustumCulled=!1}function ra(t){hn.call(this),this.type="LineBasicMaterial",this.color=new on(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(t)}na.prototype=Object.assign(Object.create(Qn.prototype),{constructor:na,isInstancedMesh:!0,getMatrixAt:function(t,e){e.fromArray(this.instanceMatrix.array,16*t)},raycast:function(t,e){var n=this.matrixWorld,r=this.count;if(ea.geometry=this.geometry,ea.material=this.material,void 0!==ea.material)for(var i=0;i<r;i++)this.getMatrixAt(i,Zo),$o.multiplyMatrices(n,Zo),ea.matrixWorld=$o,ea.raycast(t,ta),ta.length>0&&(ta[0].instanceId=i,ta[0].object=this,e.push(ta[0]),ta.length=0)},setMatrixAt:function(t,e){e.toArray(this.instanceMatrix.array,16*t)},updateMorphTargets:function(){}}),ra.prototype=Object.create(hn.prototype),ra.prototype.constructor=ra,ra.prototype.isLineBasicMaterial=!0,ra.prototype.copy=function(t){return hn.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this};var ia=new zt,oa=new zt,aa=new Xt,sa=new Fe,ca=new Re;function ua(t,e,n){1===n&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),pe.call(this),this.type="Line",this.geometry=void 0!==t?t:new In,this.material=void 0!==e?e:new ra}ua.prototype=Object.assign(Object.create(pe.prototype),{constructor:ua,isLine:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(null===t.index){for(var e=t.attributes.position,n=[0],r=1,i=e.count;r<i;r++)ia.fromBufferAttribute(e,r-1),oa.fromBufferAttribute(e,r),n[r]=n[r-1],n[r]+=ia.distanceTo(oa);t.setAttribute("lineDistance",new xn(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry){var o=t.vertices;(n=t.lineDistances)[0]=0;for(r=1,i=o.length;r<i;r++)n[r]=n[r-1],n[r]+=o[r-1].distanceTo(o[r])}return this},raycast:function(t,e){var n=this.geometry,r=this.matrixWorld,i=t.params.Line.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),ca.copy(n.boundingSphere),ca.applyMatrix4(r),ca.radius+=i,!1!==t.ray.intersectsSphere(ca)){aa.getInverse(r),sa.copy(t.ray).applyMatrix4(aa);var o=i/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,s=new zt,c=new zt,u=new zt,l=new zt,h=this&&this.isLineSegments?2:1;if(n.isBufferGeometry){var f=n.index,p=n.attributes.position.array;if(null!==f)for(var d=f.array,y=0,m=d.length-1;y<m;y+=h){var v=d[y],g=d[y+1];if(s.fromArray(p,3*v),c.fromArray(p,3*g),!(sa.distanceSqToSegment(s,c,l,u)>a))l.applyMatrix4(this.matrixWorld),(_=t.ray.origin.distanceTo(l))<t.near||_>t.far||e.push({distance:_,point:u.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}else for(y=0,m=p.length/3-1;y<m;y+=h){if(s.fromArray(p,3*y),c.fromArray(p,3*y+3),!(sa.distanceSqToSegment(s,c,l,u)>a))l.applyMatrix4(this.matrixWorld),(_=t.ray.origin.distanceTo(l))<t.near||_>t.far||e.push({distance:_,point:u.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}else if(n.isGeometry){var b=n.vertices,w=b.length;for(y=0;y<w-1;y+=h){var _;if(!(sa.distanceSqToSegment(b[y],b[y+1],l,u)>a))l.applyMatrix4(this.matrixWorld),(_=t.ray.origin.distanceTo(l))<t.near||_>t.far||e.push({distance:_,point:u.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var la=new zt,ha=new zt;function fa(t,e){ua.call(this,t,e),this.type="LineSegments"}function pa(t,e){ua.call(this,t,e),this.type="LineLoop"}function da(t){hn.call(this),this.type="PointsMaterial",this.color=new on(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(t)}fa.prototype=Object.assign(Object.create(ua.prototype),{constructor:fa,isLineSegments:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(null===t.index){for(var e=t.attributes.position,n=[],r=0,i=e.count;r<i;r+=2)la.fromBufferAttribute(e,r),ha.fromBufferAttribute(e,r+1),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+la.distanceTo(ha);t.setAttribute("lineDistance",new xn(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry){var o=t.vertices;for(n=t.lineDistances,r=0,i=o.length;r<i;r+=2)la.copy(o[r]),ha.copy(o[r+1]),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+la.distanceTo(ha)}return this}}),pa.prototype=Object.assign(Object.create(ua.prototype),{constructor:pa,isLineLoop:!0}),da.prototype=Object.create(hn.prototype),da.prototype.constructor=da,da.prototype.isPointsMaterial=!0,da.prototype.copy=function(t){return hn.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this};var ya=new Xt,ma=new Fe,va=new Re,ga=new zt;function ba(t,e){pe.call(this),this.type="Points",this.geometry=void 0!==t?t:new In,this.material=void 0!==e?e:new da,this.updateMorphTargets()}function wa(t,e,n,r,i,o,a){var s=ma.distanceSqToPoint(t);if(s<n){var c=new zt;ma.closestPointToPoint(t,c),c.applyMatrix4(r);var u=i.ray.origin.distanceTo(c);if(u<i.near||u>i.far)return;o.push({distance:u,distanceToRay:Math.sqrt(s),point:c,index:e,face:null,object:a})}}function _a(t,e,n,r,i,o,a,s,c){kt.call(this,t,e,n,r,i,o,a,s,c),this.format=void 0!==a?a:it,this.minFilter=void 0!==o?o:z,this.magFilter=void 0!==i?i:z,this.generateMipmaps=!1}function xa(t,e,n,r,i,o,a,s,c,u,l,h){kt.call(this,null,o,a,s,c,u,r,i,l,h),this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}function Sa(t,e,n,r,i,o,a,s,c){kt.call(this,t,e,n,r,i,o,a,s,c),this.needsUpdate=!0}function Ta(t,e,n,r,i,o,a,s,c,u){if(1026!==(u=void 0!==u?u:1026)&&1027!==u)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&1026===u&&(n=X),void 0===n&&1027===u&&(n=1020),kt.call(this,null,r,i,o,a,s,u,n,c),this.image={width:t,height:e},this.magFilter=void 0!==a?a:N,this.minFilter=void 0!==s?s:N,this.flipY=!1,this.generateMipmaps=!1}function Ma(t){In.call(this),this.type="WireframeGeometry";var e,n,r,i,o,a,s,c,u,l,h=[],f=[0,0],p={},d=["a","b","c"];if(t&&t.isGeometry){var y=t.faces;for(e=0,r=y.length;e<r;e++){var m=y[e];for(n=0;n<3;n++)s=m[d[n]],c=m[d[(n+1)%3]],f[0]=Math.min(s,c),f[1]=Math.max(s,c),void 0===p[u=f[0]+","+f[1]]&&(p[u]={index1:f[0],index2:f[1]})}for(u in p)a=p[u],l=t.vertices[a.index1],h.push(l.x,l.y,l.z),l=t.vertices[a.index2],h.push(l.x,l.y,l.z)}else if(t&&t.isBufferGeometry){var v,g,b,w,_,x,S;if(l=new zt,null!==t.index){for(v=t.attributes.position,g=t.index,0===(b=t.groups).length&&(b=[{start:0,count:g.count,materialIndex:0}]),i=0,o=b.length;i<o;++i)for(e=_=(w=b[i]).start,r=_+w.count;e<r;e+=3)for(n=0;n<3;n++)s=g.getX(e+n),c=g.getX(e+(n+1)%3),f[0]=Math.min(s,c),f[1]=Math.max(s,c),void 0===p[u=f[0]+","+f[1]]&&(p[u]={index1:f[0],index2:f[1]});for(u in p)a=p[u],l.fromBufferAttribute(v,a.index1),h.push(l.x,l.y,l.z),l.fromBufferAttribute(v,a.index2),h.push(l.x,l.y,l.z)}else for(e=0,r=(v=t.attributes.position).count/3;e<r;e++)for(n=0;n<3;n++)x=3*e+n,l.fromBufferAttribute(v,x),h.push(l.x,l.y,l.z),S=3*e+(n+1)%3,l.fromBufferAttribute(v,S),h.push(l.x,l.y,l.z)}this.setAttribute("position",new xn(h,3))}function Ea(t,e,n){ir.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:n},this.fromBufferGeometry(new Pa(t,e,n)),this.mergeVertices()}function Pa(t,e,n){In.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:e,stacks:n};var r,i,o=[],a=[],s=[],c=[],u=new zt,l=new zt,h=new zt,f=new zt,p=new zt;t.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");var d=e+1;for(r=0;r<=n;r++){var y=r/n;for(i=0;i<=e;i++){var m=i/e;t(m,y,l),a.push(l.x,l.y,l.z),m-1e-5>=0?(t(m-1e-5,y,h),f.subVectors(l,h)):(t(m+1e-5,y,h),f.subVectors(h,l)),y-1e-5>=0?(t(m,y-1e-5,h),p.subVectors(l,h)):(t(m,y+1e-5,h),p.subVectors(h,l)),u.crossVectors(f,p).normalize(),s.push(u.x,u.y,u.z),c.push(m,y)}}for(r=0;r<n;r++)for(i=0;i<e;i++){var v=r*d+i,g=r*d+i+1,b=(r+1)*d+i+1,w=(r+1)*d+i;o.push(v,g,w),o.push(g,b,w)}this.setIndex(o),this.setAttribute("position",new xn(a,3)),this.setAttribute("normal",new xn(s,3)),this.setAttribute("uv",new xn(c,2))}function Oa(t,e,n,r){ir.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r},this.fromBufferGeometry(new Aa(t,e,n,r)),this.mergeVertices()}function Aa(t,e,n,r){In.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r},n=n||1;var i=[],o=[];function a(t,e,n,r){var i,o,a=Math.pow(2,r),c=[];for(i=0;i<=a;i++){c[i]=[];var u=t.clone().lerp(n,i/a),l=e.clone().lerp(n,i/a),h=a-i;for(o=0;o<=h;o++)c[i][o]=0===o&&i===a?u:u.clone().lerp(l,o/h)}for(i=0;i<a;i++)for(o=0;o<2*(a-i)-1;o++){var f=Math.floor(o/2);o%2==0?(s(c[i][f+1]),s(c[i+1][f]),s(c[i][f])):(s(c[i][f+1]),s(c[i+1][f+1]),s(c[i+1][f]))}}function s(t){i.push(t.x,t.y,t.z)}function c(e,n){var r=3*e;n.x=t[r+0],n.y=t[r+1],n.z=t[r+2]}function u(t,e,n,r){r<0&&1===t.x&&(o[e]=t.x-1),0===n.x&&0===n.z&&(o[e]=r/2/Math.PI+.5)}function l(t){return Math.atan2(t.z,-t.x)}!function(t){for(var n=new zt,r=new zt,i=new zt,o=0;o<e.length;o+=3)c(e[o+0],n),c(e[o+1],r),c(e[o+2],i),a(n,r,i,t)}(r=r||0),function(t){for(var e=new zt,n=0;n<i.length;n+=3)e.x=i[n+0],e.y=i[n+1],e.z=i[n+2],e.normalize().multiplyScalar(t),i[n+0]=e.x,i[n+1]=e.y,i[n+2]=e.z}(n),function(){for(var t=new zt,e=0;e<i.length;e+=3){t.x=i[e+0],t.y=i[e+1],t.z=i[e+2];var n=l(t)/2/Math.PI+.5,r=(a=t,Math.atan2(-a.y,Math.sqrt(a.x*a.x+a.z*a.z))/Math.PI+.5);o.push(n,1-r)}var a;(function(){for(var t=new zt,e=new zt,n=new zt,r=new zt,a=new Dt,s=new Dt,c=new Dt,h=0,f=0;h<i.length;h+=9,f+=6){t.set(i[h+0],i[h+1],i[h+2]),e.set(i[h+3],i[h+4],i[h+5]),n.set(i[h+6],i[h+7],i[h+8]),a.set(o[f+0],o[f+1]),s.set(o[f+2],o[f+3]),c.set(o[f+4],o[f+5]),r.copy(t).add(e).add(n).divideScalar(3);var p=l(r);u(a,f+0,t,p),u(s,f+2,e,p),u(c,f+4,n,p)}})(),function(){for(var t=0;t<o.length;t+=6){var e=o[t+0],n=o[t+2],r=o[t+4],i=Math.max(e,n,r),a=Math.min(e,n,r);i>.9&&a<.1&&(e<.2&&(o[t+0]+=1),n<.2&&(o[t+2]+=1),r<.2&&(o[t+4]+=1))}}()}(),this.setAttribute("position",new xn(i,3)),this.setAttribute("normal",new xn(i.slice(),3)),this.setAttribute("uv",new xn(o,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}function Da(t,e){ir.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Ra(t,e)),this.mergeVertices()}function Ra(t,e){Aa.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Ca(t,e){ir.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Ia(t,e)),this.mergeVertices()}function Ia(t,e){Aa.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:e}}function ka(t,e){ir.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new La(t,e)),this.mergeVertices()}function La(t,e){var n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1];Aa.call(this,r,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Na(t,e){ir.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new ja(t,e)),this.mergeVertices()}function ja(t,e){var n=(1+Math.sqrt(5))/2,r=1/n,i=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r];Aa.call(this,i,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Ba(t,e,n,r,i,o){ir.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:i},void 0!==o&&console.warn("THREE.TubeGeometry: taper has been removed.");var a=new Fa(t,e,n,r,i);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals,this.fromBufferGeometry(a),this.mergeVertices()}function Fa(t,e,n,r,i){In.call(this),this.type="TubeBufferGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:i},e=e||64,n=n||1,r=r||8,i=i||!1;var o=t.computeFrenetFrames(e,i);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;var a,s,c=new zt,u=new zt,l=new Dt,h=new zt,f=[],p=[],d=[],y=[];function m(i){h=t.getPointAt(i/e,h);var a=o.normals[i],l=o.binormals[i];for(s=0;s<=r;s++){var d=s/r*Math.PI*2,y=Math.sin(d),m=-Math.cos(d);u.x=m*a.x+y*l.x,u.y=m*a.y+y*l.y,u.z=m*a.z+y*l.z,u.normalize(),p.push(u.x,u.y,u.z),c.x=h.x+n*u.x,c.y=h.y+n*u.y,c.z=h.z+n*u.z,f.push(c.x,c.y,c.z)}}!function(){for(a=0;a<e;a++)m(a);m(!1===i?e:0),function(){for(a=0;a<=e;a++)for(s=0;s<=r;s++)l.x=a/e,l.y=s/r,d.push(l.x,l.y)}(),function(){for(s=1;s<=e;s++)for(a=1;a<=r;a++){var t=(r+1)*(s-1)+(a-1),n=(r+1)*s+(a-1),i=(r+1)*s+a,o=(r+1)*(s-1)+a;y.push(t,n,o),y.push(n,i,o)}}()}(),this.setIndex(y),this.setAttribute("position",new xn(f,3)),this.setAttribute("normal",new xn(p,3)),this.setAttribute("uv",new xn(d,2))}function Ua(t,e,n,r,i,o,a){ir.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:i,q:o},void 0!==a&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new za(t,e,n,r,i,o)),this.mergeVertices()}function za(t,e,n,r,i,o){In.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:i,q:o},t=t||1,e=e||.4,n=Math.floor(n)||64,r=Math.floor(r)||8,i=i||2,o=o||3;var a,s,c=[],u=[],l=[],h=[],f=new zt,p=new zt,d=new zt,y=new zt,m=new zt,v=new zt,g=new zt;for(a=0;a<=n;++a){var b=a/n*i*Math.PI*2;for(P(b,i,o,t,d),P(b+.01,i,o,t,y),v.subVectors(y,d),g.addVectors(y,d),m.crossVectors(v,g),g.crossVectors(m,v),m.normalize(),g.normalize(),s=0;s<=r;++s){var w=s/r*Math.PI*2,_=-e*Math.cos(w),x=e*Math.sin(w);f.x=d.x+(_*g.x+x*m.x),f.y=d.y+(_*g.y+x*m.y),f.z=d.z+(_*g.z+x*m.z),u.push(f.x,f.y,f.z),p.subVectors(f,d).normalize(),l.push(p.x,p.y,p.z),h.push(a/n),h.push(s/r)}}for(s=1;s<=n;s++)for(a=1;a<=r;a++){var S=(r+1)*(s-1)+(a-1),T=(r+1)*s+(a-1),M=(r+1)*s+a,E=(r+1)*(s-1)+a;c.push(S,T,E),c.push(T,M,E)}function P(t,e,n,r,i){var o=Math.cos(t),a=Math.sin(t),s=n/e*t,c=Math.cos(s);i.x=r*(2+c)*.5*o,i.y=r*(2+c)*a*.5,i.z=r*Math.sin(s)*.5}this.setIndex(c),this.setAttribute("position",new xn(u,3)),this.setAttribute("normal",new xn(l,3)),this.setAttribute("uv",new xn(h,2))}function Ga(t,e,n,r,i){ir.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:r,arc:i},this.fromBufferGeometry(new Ha(t,e,n,r,i)),this.mergeVertices()}function Ha(t,e,n,r,i){In.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:r,arc:i},t=t||1,e=e||.4,n=Math.floor(n)||8,r=Math.floor(r)||6,i=i||2*Math.PI;var o,a,s=[],c=[],u=[],l=[],h=new zt,f=new zt,p=new zt;for(o=0;o<=n;o++)for(a=0;a<=r;a++){var d=a/r*i,y=o/n*Math.PI*2;f.x=(t+e*Math.cos(y))*Math.cos(d),f.y=(t+e*Math.cos(y))*Math.sin(d),f.z=e*Math.sin(y),c.push(f.x,f.y,f.z),h.x=t*Math.cos(d),h.y=t*Math.sin(d),p.subVectors(f,h).normalize(),u.push(p.x,p.y,p.z),l.push(a/r),l.push(o/n)}for(o=1;o<=n;o++)for(a=1;a<=r;a++){var m=(r+1)*o+a-1,v=(r+1)*(o-1)+a-1,g=(r+1)*(o-1)+a,b=(r+1)*o+a;s.push(m,v,b),s.push(v,g,b)}this.setIndex(s),this.setAttribute("position",new xn(c,3)),this.setAttribute("normal",new xn(u,3)),this.setAttribute("uv",new xn(l,2))}ba.prototype=Object.assign(Object.create(pe.prototype),{constructor:ba,isPoints:!0,raycast:function(t,e){var n=this.geometry,r=this.matrixWorld,i=t.params.Points.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),va.copy(n.boundingSphere),va.applyMatrix4(r),va.radius+=i,!1!==t.ray.intersectsSphere(va)){ya.getInverse(r),ma.copy(t.ray).applyMatrix4(ya);var o=i/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o;if(n.isBufferGeometry){var s=n.index,c=n.attributes.position.array;if(null!==s)for(var u=s.array,l=0,h=u.length;l<h;l++){var f=u[l];ga.fromArray(c,3*f),wa(ga,f,a,r,t,e,this)}else{l=0;for(var p=c.length/3;l<p;l++)ga.fromArray(c,3*l),wa(ga,l,a,r,t,e,this)}}else{var d=n.vertices;for(l=0,p=d.length;l<p;l++)wa(d[l],l,a,r,t,e,this)}}},updateMorphTargets:function(){var t,e,n,r=this.geometry;if(r.isBufferGeometry){var i=r.morphAttributes,o=Object.keys(i);if(o.length>0){var a=i[o[0]];if(void 0!==a)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=a.length;t<e;t++)n=a[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}else{var s=r.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),_a.prototype=Object.assign(Object.create(kt.prototype),{constructor:_a,isVideoTexture:!0,update:function(){var t=this.image;t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),xa.prototype=Object.create(kt.prototype),xa.prototype.constructor=xa,xa.prototype.isCompressedTexture=!0,Sa.prototype=Object.create(kt.prototype),Sa.prototype.constructor=Sa,Sa.prototype.isCanvasTexture=!0,Ta.prototype=Object.create(kt.prototype),Ta.prototype.constructor=Ta,Ta.prototype.isDepthTexture=!0,Ma.prototype=Object.create(In.prototype),Ma.prototype.constructor=Ma,Ea.prototype=Object.create(ir.prototype),Ea.prototype.constructor=Ea,Pa.prototype=Object.create(In.prototype),Pa.prototype.constructor=Pa,Oa.prototype=Object.create(ir.prototype),Oa.prototype.constructor=Oa,Aa.prototype=Object.create(In.prototype),Aa.prototype.constructor=Aa,Da.prototype=Object.create(ir.prototype),Da.prototype.constructor=Da,Ra.prototype=Object.create(Aa.prototype),Ra.prototype.constructor=Ra,Ca.prototype=Object.create(ir.prototype),Ca.prototype.constructor=Ca,Ia.prototype=Object.create(Aa.prototype),Ia.prototype.constructor=Ia,ka.prototype=Object.create(ir.prototype),ka.prototype.constructor=ka,La.prototype=Object.create(Aa.prototype),La.prototype.constructor=La,Na.prototype=Object.create(ir.prototype),Na.prototype.constructor=Na,ja.prototype=Object.create(Aa.prototype),ja.prototype.constructor=ja,Ba.prototype=Object.create(ir.prototype),Ba.prototype.constructor=Ba,Fa.prototype=Object.create(In.prototype),Fa.prototype.constructor=Fa,Fa.prototype.toJSON=function(){var t=In.prototype.toJSON.call(this);return t.path=this.parameters.path.toJSON(),t},Ua.prototype=Object.create(ir.prototype),Ua.prototype.constructor=Ua,za.prototype=Object.create(In.prototype),za.prototype.constructor=za,Ga.prototype=Object.create(ir.prototype),Ga.prototype.constructor=Ga,Ha.prototype=Object.create(In.prototype),Ha.prototype.constructor=Ha;var Va=function(t,e,n){n=n||2;var r,i,o,a,s,c,u,l=e&&e.length,h=l?e[0]*n:t.length,f=Wa(t,0,h,n,!0),p=[];if(!f||f.next===f.prev)return p;if(l&&(f=function(t,e,n,r){var i,o,a,s,c,u=[];for(i=0,o=e.length;i<o;i++)a=e[i]*r,s=i<o-1?e[i+1]*r:t.length,(c=Wa(t,a,s,r,!1))===c.next&&(c.steiner=!0),u.push(es(c));for(u.sort(Za),i=0;i<u.length;i++)$a(u[i],n),n=qa(n,n.next);return n}(t,e,f,n)),t.length>80*n){r=o=t[0],i=a=t[1];for(var d=n;d<h;d+=n)(s=t[d])<r&&(r=s),(c=t[d+1])<i&&(i=c),s>o&&(o=s),c>a&&(a=c);u=0!==(u=Math.max(o-r,a-i))?1/u:0}return Ya(f,p,n,r,i,u),p};function Wa(t,e,n,r,i){var o,a;if(i===function(t,e,n,r){for(var i=0,o=e,a=n-r;o<n;o+=r)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}(t,e,n,r)>0)for(o=e;o<n;o+=r)a=us(o,t[o],t[o+1],a);else for(o=n-r;o>=e;o-=r)a=us(o,t[o],t[o+1],a);return a&&os(a,a.next)&&(ls(a),a=a.next),a}function qa(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!os(r,r.next)&&0!==is(r.prev,r,r.next))r=r.next;else{if(ls(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function Ya(t,e,n,r,i,o,a){if(t){!a&&o&&function(t,e,n,r){var i=t;do{null===i.z&&(i.z=ts(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,a,s,c,u=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,r=n,s=0,e=0;e<u&&(s++,r=r.nextZ);e++);for(c=u;s>0||c>0&&r;)0!==s&&(0===c||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,c--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,u*=2}while(a>1)}(i)}(t,r,i,o);for(var s,c,u=t;t.prev!==t.next;)if(s=t.prev,c=t.next,o?Xa(t,r,i,o):Ja(t))e.push(s.i/n),e.push(t.i/n),e.push(c.i/n),ls(t),t=c.next,u=c.next;else if((t=c)===u){a?1===a?Ya(t=Ka(t,e,n),e,n,r,i,o,2):2===a&&Qa(t,e,n,r,i,o):Ya(qa(t),e,n,r,i,o,1);break}}}function Ja(t){var e=t.prev,n=t,r=t.next;if(is(e,n,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(ns(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&is(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function Xa(t,e,n,r){var i=t.prev,o=t,a=t.next;if(is(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,c=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,u=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,l=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,h=ts(s,c,e,n,r),f=ts(u,l,e,n,r),p=t.prevZ,d=t.nextZ;p&&p.z>=h&&d&&d.z<=f;){if(p!==t.prev&&p!==t.next&&ns(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&is(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,d!==t.prev&&d!==t.next&&ns(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&is(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;p&&p.z>=h;){if(p!==t.prev&&p!==t.next&&ns(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&is(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;d&&d.z<=f;){if(d!==t.prev&&d!==t.next&&ns(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&is(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function Ka(t,e,n){var r=t;do{var i=r.prev,o=r.next.next;!os(i,o)&&as(i,r,r.next,o)&&ss(i,o)&&ss(o,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(o.i/n),ls(r),ls(r.next),r=t=o),r=r.next}while(r!==t);return r}function Qa(t,e,n,r,i,o){var a=t;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&rs(a,s)){var c=cs(a,s);return a=qa(a,a.next),c=qa(c,c.next),Ya(a,e,n,r,i,o),void Ya(c,e,n,r,i,o)}s=s.next}a=a.next}while(a!==t)}function Za(t,e){return t.x-e.x}function $a(t,e){if(e=function(t,e){var n,r=e,i=t.x,o=t.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a){if(a=s,s===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===a)return n.prev;var c,u=n,l=n.x,h=n.y,f=1/0;r=n.next;for(;r!==u;)i>=r.x&&r.x>=l&&i!==r.x&&ns(o<h?i:a,o,l,h,o<h?a:i,o,r.x,r.y)&&((c=Math.abs(o-r.y)/(i-r.x))<f||c===f&&r.x>n.x)&&ss(r,t)&&(n=r,f=c),r=r.next;return n}(t,e)){var n=cs(e,t);qa(n,n.next)}}function ts(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function es(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function ns(t,e,n,r,i,o,a,s){return(i-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(r-s)-(n-a)*(e-s)>=0&&(n-a)*(o-s)-(i-a)*(r-s)>=0}function rs(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&as(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&ss(t,e)&&ss(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)}function is(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function os(t,e){return t.x===e.x&&t.y===e.y}function as(t,e,n,r){return!!(os(t,n)&&os(e,r)||os(t,r)&&os(n,e))||is(t,e,n)>0!=is(t,e,r)>0&&is(n,r,t)>0!=is(n,r,e)>0}function ss(t,e){return is(t.prev,t,t.next)<0?is(t,e,t.next)>=0&&is(t,t.prev,e)>=0:is(t,e,t.prev)<0||is(t,t.next,e)<0}function cs(t,e){var n=new hs(t.i,t.x,t.y),r=new hs(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function us(t,e,n,r){var i=new hs(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function ls(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function hs(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var fs={area:function(t){for(var e=t.length,n=0,r=e-1,i=0;i<e;r=i++)n+=t[r].x*t[i].y-t[i].x*t[r].y;return.5*n},isClockWise:function(t){return fs.area(t)<0},triangulateShape:function(t,e){var n=[],r=[],i=[];ps(t),ds(n,t);var o=t.length;e.forEach(ps);for(var a=0;a<e.length;a++)r.push(o),o+=e[a].length,ds(n,e[a]);var s=Va(n,r);for(a=0;a<s.length;a+=3)i.push(s.slice(a,a+3));return i}};function ps(t){var e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function ds(t,e){for(var n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}function ys(t,e){ir.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},this.fromBufferGeometry(new ms(t,e)),this.mergeVertices()}function ms(t,e){In.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];for(var n=this,r=[],i=[],o=0,a=t.length;o<a;o++){s(t[o])}function s(t){var o=[],a=void 0!==e.curveSegments?e.curveSegments:12,s=void 0!==e.steps?e.steps:1,c=void 0!==e.depth?e.depth:100,u=void 0===e.bevelEnabled||e.bevelEnabled,l=void 0!==e.bevelThickness?e.bevelThickness:6,h=void 0!==e.bevelSize?e.bevelSize:l-2,f=void 0!==e.bevelOffset?e.bevelOffset:0,p=void 0!==e.bevelSegments?e.bevelSegments:3,d=e.extrudePath,y=void 0!==e.UVGenerator?e.UVGenerator:vs;void 0!==e.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),c=e.amount);var m,v,g,b,w,_,x,S,T=!1;d&&(m=d.getSpacedPoints(s),T=!0,u=!1,v=d.computeFrenetFrames(s,!1),g=new zt,b=new zt,w=new zt),u||(p=0,l=0,h=0,f=0);var M=t.extractPoints(a),E=M.shape,P=M.holes;if(!fs.isClockWise(E))for(E=E.reverse(),x=0,S=P.length;x<S;x++)_=P[x],fs.isClockWise(_)&&(P[x]=_.reverse());var O=fs.triangulateShape(E,P),A=E;for(x=0,S=P.length;x<S;x++)_=P[x],E=E.concat(_);function D(t,e,n){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(n).add(t)}var R,C,I,k,L,N,j=E.length,B=O.length;function F(t,e,n){var r,i,o,a=t.x-e.x,s=t.y-e.y,c=n.x-t.x,u=n.y-t.y,l=a*a+s*s,h=a*u-s*c;if(Math.abs(h)>Number.EPSILON){var f=Math.sqrt(l),p=Math.sqrt(c*c+u*u),d=e.x-s/f,y=e.y+a/f,m=((n.x-u/p-d)*u-(n.y+c/p-y)*c)/(a*u-s*c),v=(r=d+a*m-t.x)*r+(i=y+s*m-t.y)*i;if(v<=2)return new Dt(r,i);o=Math.sqrt(v/2)}else{var g=!1;a>Number.EPSILON?c>Number.EPSILON&&(g=!0):a<-Number.EPSILON?c<-Number.EPSILON&&(g=!0):Math.sign(s)===Math.sign(u)&&(g=!0),g?(r=-s,i=a,o=Math.sqrt(l)):(r=a,i=s,o=Math.sqrt(l/2))}return new Dt(r/o,i/o)}for(var U=[],z=0,G=A.length,H=G-1,V=z+1;z<G;z++,H++,V++)H===G&&(H=0),V===G&&(V=0),U[z]=F(A[z],A[H],A[V]);var W,q,Y=[],J=U.concat();for(x=0,S=P.length;x<S;x++){for(_=P[x],W=[],z=0,H=(G=_.length)-1,V=z+1;z<G;z++,H++,V++)H===G&&(H=0),V===G&&(V=0),W[z]=F(_[z],_[H],_[V]);Y.push(W),J=J.concat(W)}for(R=0;R<p;R++){for(I=R/p,k=l*Math.cos(I*Math.PI/2),C=h*Math.sin(I*Math.PI/2)+f,z=0,G=A.length;z<G;z++)K((L=D(A[z],U[z],C)).x,L.y,-k);for(x=0,S=P.length;x<S;x++)for(_=P[x],W=Y[x],z=0,G=_.length;z<G;z++)K((L=D(_[z],W[z],C)).x,L.y,-k)}for(C=h+f,z=0;z<j;z++)L=u?D(E[z],J[z],C):E[z],T?(b.copy(v.normals[0]).multiplyScalar(L.x),g.copy(v.binormals[0]).multiplyScalar(L.y),w.copy(m[0]).add(b).add(g),K(w.x,w.y,w.z)):K(L.x,L.y,0);for(q=1;q<=s;q++)for(z=0;z<j;z++)L=u?D(E[z],J[z],C):E[z],T?(b.copy(v.normals[q]).multiplyScalar(L.x),g.copy(v.binormals[q]).multiplyScalar(L.y),w.copy(m[q]).add(b).add(g),K(w.x,w.y,w.z)):K(L.x,L.y,c/s*q);for(R=p-1;R>=0;R--){for(I=R/p,k=l*Math.cos(I*Math.PI/2),C=h*Math.sin(I*Math.PI/2)+f,z=0,G=A.length;z<G;z++)K((L=D(A[z],U[z],C)).x,L.y,c+k);for(x=0,S=P.length;x<S;x++)for(_=P[x],W=Y[x],z=0,G=_.length;z<G;z++)L=D(_[z],W[z],C),T?K(L.x,L.y+m[s-1].y,m[s-1].x+k):K(L.x,L.y,c+k)}function X(t,e){var n,r;for(z=t.length;--z>=0;){n=z,(r=z-1)<0&&(r=t.length-1);var i=0,o=s+2*p;for(i=0;i<o;i++){var a=j*i,c=j*(i+1);Z(e+n+a,e+r+a,e+r+c,e+n+c)}}}function K(t,e,n){o.push(t),o.push(e),o.push(n)}function Q(t,e,i){$(t),$(e),$(i);var o=r.length/3,a=y.generateTopUV(n,r,o-3,o-2,o-1);tt(a[0]),tt(a[1]),tt(a[2])}function Z(t,e,i,o){$(t),$(e),$(o),$(e),$(i),$(o);var a=r.length/3,s=y.generateSideWallUV(n,r,a-6,a-3,a-2,a-1);tt(s[0]),tt(s[1]),tt(s[3]),tt(s[1]),tt(s[2]),tt(s[3])}function $(t){r.push(o[3*t+0]),r.push(o[3*t+1]),r.push(o[3*t+2])}function tt(t){i.push(t.x),i.push(t.y)}!function(){var t=r.length/3;if(u){var e=0,i=j*e;for(z=0;z<B;z++)Q((N=O[z])[2]+i,N[1]+i,N[0]+i);for(i=j*(e=s+2*p),z=0;z<B;z++)Q((N=O[z])[0]+i,N[1]+i,N[2]+i)}else{for(z=0;z<B;z++)Q((N=O[z])[2],N[1],N[0]);for(z=0;z<B;z++)Q((N=O[z])[0]+j*s,N[1]+j*s,N[2]+j*s)}n.addGroup(t,r.length/3-t,0)}(),function(){var t=r.length/3,e=0;for(X(A,e),e+=A.length,x=0,S=P.length;x<S;x++)X(_=P[x],e),e+=_.length;n.addGroup(t,r.length/3-t,1)}()}this.setAttribute("position",new xn(r,3)),this.setAttribute("uv",new xn(i,2)),this.computeVertexNormals()}ys.prototype=Object.create(ir.prototype),ys.prototype.constructor=ys,ys.prototype.toJSON=function(){var t=ir.prototype.toJSON.call(this);return gs(this.parameters.shapes,this.parameters.options,t)},ms.prototype=Object.create(In.prototype),ms.prototype.constructor=ms,ms.prototype.toJSON=function(){var t=In.prototype.toJSON.call(this);return gs(this.parameters.shapes,this.parameters.options,t)};var vs={generateTopUV:function(t,e,n,r,i){var o=e[3*n],a=e[3*n+1],s=e[3*r],c=e[3*r+1],u=e[3*i],l=e[3*i+1];return[new Dt(o,a),new Dt(s,c),new Dt(u,l)]},generateSideWallUV:function(t,e,n,r,i,o){var a=e[3*n],s=e[3*n+1],c=e[3*n+2],u=e[3*r],l=e[3*r+1],h=e[3*r+2],f=e[3*i],p=e[3*i+1],d=e[3*i+2],y=e[3*o],m=e[3*o+1],v=e[3*o+2];return Math.abs(s-l)<.01?[new Dt(a,1-c),new Dt(u,1-h),new Dt(f,1-d),new Dt(y,1-v)]:[new Dt(s,1-c),new Dt(l,1-h),new Dt(p,1-d),new Dt(m,1-v)]}};function gs(t,e,n){if(n.shapes=[],Array.isArray(t))for(var r=0,i=t.length;r<i;r++){var o=t[r];n.shapes.push(o.uuid)}else n.shapes.push(t.uuid);return void 0!==e.extrudePath&&(n.options.extrudePath=e.extrudePath.toJSON()),n}function bs(t,e){ir.call(this),this.type="TextGeometry",this.parameters={text:t,parameters:e},this.fromBufferGeometry(new ws(t,e)),this.mergeVertices()}function ws(t,e){var n=(e=e||{}).font;if(!n||!n.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new ir;var r=n.generateShapes(t,e.size);e.depth=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),ms.call(this,r,e),this.type="TextBufferGeometry"}function _s(t,e,n,r,i,o,a){ir.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new xs(t,e,n,r,i,o,a)),this.mergeVertices()}function xs(t,e,n,r,i,o,a){In.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:a},t=t||1,e=Math.max(3,Math.floor(e)||8),n=Math.max(2,Math.floor(n)||6),r=void 0!==r?r:0,i=void 0!==i?i:2*Math.PI,o=void 0!==o?o:0,a=void 0!==a?a:Math.PI;var s,c,u=Math.min(o+a,Math.PI),l=0,h=[],f=new zt,p=new zt,d=[],y=[],m=[],v=[];for(c=0;c<=n;c++){var g=[],b=c/n,w=0;for(0==c&&0==o?w=.5/e:c==n&&u==Math.PI&&(w=-.5/e),s=0;s<=e;s++){var _=s/e;f.x=-t*Math.cos(r+_*i)*Math.sin(o+b*a),f.y=t*Math.cos(o+b*a),f.z=t*Math.sin(r+_*i)*Math.sin(o+b*a),y.push(f.x,f.y,f.z),p.copy(f).normalize(),m.push(p.x,p.y,p.z),v.push(_+w,1-b),g.push(l++)}h.push(g)}for(c=0;c<n;c++)for(s=0;s<e;s++){var x=h[c][s+1],S=h[c][s],T=h[c+1][s],M=h[c+1][s+1];(0!==c||o>0)&&d.push(x,S,M),(c!==n-1||u<Math.PI)&&d.push(S,T,M)}this.setIndex(d),this.setAttribute("position",new xn(y,3)),this.setAttribute("normal",new xn(m,3)),this.setAttribute("uv",new xn(v,2))}function Ss(t,e,n,r,i,o){ir.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:o},this.fromBufferGeometry(new Ts(t,e,n,r,i,o)),this.mergeVertices()}function Ts(t,e,n,r,i,o){In.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:o},t=t||.5,e=e||1,i=void 0!==i?i:0,o=void 0!==o?o:2*Math.PI,n=void 0!==n?Math.max(3,n):8;var a,s,c,u=[],l=[],h=[],f=[],p=t,d=(e-t)/(r=void 0!==r?Math.max(1,r):1),y=new zt,m=new Dt;for(s=0;s<=r;s++){for(c=0;c<=n;c++)a=i+c/n*o,y.x=p*Math.cos(a),y.y=p*Math.sin(a),l.push(y.x,y.y,y.z),h.push(0,0,1),m.x=(y.x/e+1)/2,m.y=(y.y/e+1)/2,f.push(m.x,m.y);p+=d}for(s=0;s<r;s++){var v=s*(n+1);for(c=0;c<n;c++){var g=a=c+v,b=a+n+1,w=a+n+2,_=a+1;u.push(g,b,_),u.push(b,w,_)}}this.setIndex(u),this.setAttribute("position",new xn(l,3)),this.setAttribute("normal",new xn(h,3)),this.setAttribute("uv",new xn(f,2))}function Ms(t,e,n,r){ir.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},this.fromBufferGeometry(new Es(t,e,n,r)),this.mergeVertices()}function Es(t,e,n,r){In.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},e=Math.floor(e)||12,n=n||0,r=r||2*Math.PI,r=At.clamp(r,0,2*Math.PI);var i,o,a,s=[],c=[],u=[],l=1/e,h=new zt,f=new Dt;for(o=0;o<=e;o++){var p=n+o*l*r,d=Math.sin(p),y=Math.cos(p);for(a=0;a<=t.length-1;a++)h.x=t[a].x*d,h.y=t[a].y,h.z=t[a].x*y,c.push(h.x,h.y,h.z),f.x=o/e,f.y=a/(t.length-1),u.push(f.x,f.y)}for(o=0;o<e;o++)for(a=0;a<t.length-1;a++){var m=i=a+o*t.length,v=i+t.length,g=i+t.length+1,b=i+1;s.push(m,v,b),s.push(v,g,b)}if(this.setIndex(s),this.setAttribute("position",new xn(c,3)),this.setAttribute("uv",new xn(u,2)),this.computeVertexNormals(),r===2*Math.PI){var w=this.attributes.normal.array,_=new zt,x=new zt,S=new zt;for(i=e*t.length*3,o=0,a=0;o<t.length;o++,a+=3)_.x=w[a+0],_.y=w[a+1],_.z=w[a+2],x.x=w[i+a+0],x.y=w[i+a+1],x.z=w[i+a+2],S.addVectors(_,x).normalize(),w[a+0]=w[i+a+0]=S.x,w[a+1]=w[i+a+1]=S.y,w[a+2]=w[i+a+2]=S.z}}function Ps(t,e){ir.call(this),this.type="ShapeGeometry","object"===o(e)&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),e=e.curveSegments),this.parameters={shapes:t,curveSegments:e},this.fromBufferGeometry(new Os(t,e)),this.mergeVertices()}function Os(t,e){In.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:e},e=e||12;var n=[],r=[],i=[],o=[],a=0,s=0;if(!1===Array.isArray(t))u(t);else for(var c=0;c<t.length;c++)u(t[c]),this.addGroup(a,s,c),a+=s,s=0;function u(t){var a,c,u,l=r.length/3,h=t.extractPoints(e),f=h.shape,p=h.holes;for(!1===fs.isClockWise(f)&&(f=f.reverse()),a=0,c=p.length;a<c;a++)u=p[a],!0===fs.isClockWise(u)&&(p[a]=u.reverse());var d=fs.triangulateShape(f,p);for(a=0,c=p.length;a<c;a++)u=p[a],f=f.concat(u);for(a=0,c=f.length;a<c;a++){var y=f[a];r.push(y.x,y.y,0),i.push(0,0,1),o.push(y.x,y.y)}for(a=0,c=d.length;a<c;a++){var m=d[a],v=m[0]+l,g=m[1]+l,b=m[2]+l;n.push(v,g,b),s+=3}}this.setIndex(n),this.setAttribute("position",new xn(r,3)),this.setAttribute("normal",new xn(i,3)),this.setAttribute("uv",new xn(o,2))}function As(t,e){if(e.shapes=[],Array.isArray(t))for(var n=0,r=t.length;n<r;n++){var i=t[n];e.shapes.push(i.uuid)}else e.shapes.push(t.uuid);return e}function Ds(t,e){In.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:e},e=void 0!==e?e:1;var n,r,i,o,a=[],s=Math.cos(At.DEG2RAD*e),c=[0,0],u={},l=["a","b","c"];t.isBufferGeometry?(o=new ir).fromBufferGeometry(t):o=t.clone(),o.mergeVertices(),o.computeFaceNormals();for(var h=o.vertices,f=o.faces,p=0,d=f.length;p<d;p++)for(var y=f[p],m=0;m<3;m++)n=y[l[m]],r=y[l[(m+1)%3]],c[0]=Math.min(n,r),c[1]=Math.max(n,r),void 0===u[i=c[0]+","+c[1]]?u[i]={index1:c[0],index2:c[1],face1:p,face2:void 0}:u[i].face2=p;for(i in u){var v=u[i];if(void 0===v.face2||f[v.face1].normal.dot(f[v.face2].normal)<=s){var g=h[v.index1];a.push(g.x,g.y,g.z),g=h[v.index2],a.push(g.x,g.y,g.z)}}this.setAttribute("position",new xn(a,3))}function Rs(t,e,n,r,i,o,a,s){ir.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new Cs(t,e,n,r,i,o,a,s)),this.mergeVertices()}function Cs(t,e,n,r,i,o,a,s){In.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s};var c=this;t=void 0!==t?t:1,e=void 0!==e?e:1,n=n||1,r=Math.floor(r)||8,i=Math.floor(i)||1,o=void 0!==o&&o,a=void 0!==a?a:0,s=void 0!==s?s:2*Math.PI;var u=[],l=[],h=[],f=[],p=0,d=[],y=n/2,m=0;function v(n){var i,o,d,v=new Dt,g=new zt,b=0,w=!0===n?t:e,_=!0===n?1:-1;for(o=p,i=1;i<=r;i++)l.push(0,y*_,0),h.push(0,_,0),f.push(.5,.5),p++;for(d=p,i=0;i<=r;i++){var x=i/r*s+a,S=Math.cos(x),T=Math.sin(x);g.x=w*T,g.y=y*_,g.z=w*S,l.push(g.x,g.y,g.z),h.push(0,_,0),v.x=.5*S+.5,v.y=.5*T*_+.5,f.push(v.x,v.y),p++}for(i=0;i<r;i++){var M=o+i,E=d+i;!0===n?u.push(E,E+1,M):u.push(E+1,E,M),b+=3}c.addGroup(m,b,!0===n?1:2),m+=b}!function(){var o,v,g=new zt,b=new zt,w=0,_=(e-t)/n;for(v=0;v<=i;v++){var x=[],S=v/i,T=S*(e-t)+t;for(o=0;o<=r;o++){var M=o/r,E=M*s+a,P=Math.sin(E),O=Math.cos(E);b.x=T*P,b.y=-S*n+y,b.z=T*O,l.push(b.x,b.y,b.z),g.set(P,_,O).normalize(),h.push(g.x,g.y,g.z),f.push(M,1-S),x.push(p++)}d.push(x)}for(o=0;o<r;o++)for(v=0;v<i;v++){var A=d[v][o],D=d[v+1][o],R=d[v+1][o+1],C=d[v][o+1];u.push(A,D,C),u.push(D,R,C),w+=6}c.addGroup(m,w,0),m+=w}(),!1===o&&(t>0&&v(!0),e>0&&v(!1)),this.setIndex(u),this.setAttribute("position",new xn(l,3)),this.setAttribute("normal",new xn(h,3)),this.setAttribute("uv",new xn(f,2))}function Is(t,e,n,r,i,o,a){Rs.call(this,0,t,e,n,r,i,o,a),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:a}}function ks(t,e,n,r,i,o,a){Cs.call(this,0,t,e,n,r,i,o,a),this.type="ConeBufferGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:a}}function Ls(t,e,n,r){ir.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:r},this.fromBufferGeometry(new Ns(t,e,n,r)),this.mergeVertices()}function Ns(t,e,n,r){In.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:r},t=t||1,e=void 0!==e?Math.max(3,e):8,n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI;var i,o,a=[],s=[],c=[],u=[],l=new zt,h=new Dt;for(s.push(0,0,0),c.push(0,0,1),u.push(.5,.5),o=0,i=3;o<=e;o++,i+=3){var f=n+o/e*r;l.x=t*Math.cos(f),l.y=t*Math.sin(f),s.push(l.x,l.y,l.z),c.push(0,0,1),h.x=(s[i]/t+1)/2,h.y=(s[i+1]/t+1)/2,u.push(h.x,h.y)}for(i=1;i<=e;i++)a.push(i,i+1,0);this.setIndex(a),this.setAttribute("position",new xn(s,3)),this.setAttribute("normal",new xn(c,3)),this.setAttribute("uv",new xn(u,2))}bs.prototype=Object.create(ir.prototype),bs.prototype.constructor=bs,ws.prototype=Object.create(ms.prototype),ws.prototype.constructor=ws,_s.prototype=Object.create(ir.prototype),_s.prototype.constructor=_s,xs.prototype=Object.create(In.prototype),xs.prototype.constructor=xs,Ss.prototype=Object.create(ir.prototype),Ss.prototype.constructor=Ss,Ts.prototype=Object.create(In.prototype),Ts.prototype.constructor=Ts,Ms.prototype=Object.create(ir.prototype),Ms.prototype.constructor=Ms,Es.prototype=Object.create(In.prototype),Es.prototype.constructor=Es,Ps.prototype=Object.create(ir.prototype),Ps.prototype.constructor=Ps,Ps.prototype.toJSON=function(){var t=ir.prototype.toJSON.call(this);return As(this.parameters.shapes,t)},Os.prototype=Object.create(In.prototype),Os.prototype.constructor=Os,Os.prototype.toJSON=function(){var t=In.prototype.toJSON.call(this);return As(this.parameters.shapes,t)},Ds.prototype=Object.create(In.prototype),Ds.prototype.constructor=Ds,Rs.prototype=Object.create(ir.prototype),Rs.prototype.constructor=Rs,Cs.prototype=Object.create(In.prototype),Cs.prototype.constructor=Cs,Is.prototype=Object.create(Rs.prototype),Is.prototype.constructor=Is,ks.prototype=Object.create(Cs.prototype),ks.prototype.constructor=ks,Ls.prototype=Object.create(ir.prototype),Ls.prototype.constructor=Ls,Ns.prototype=Object.create(In.prototype),Ns.prototype.constructor=Ns;var js=Object.freeze({__proto__:null,WireframeGeometry:Ma,ParametricGeometry:Ea,ParametricBufferGeometry:Pa,TetrahedronGeometry:Da,TetrahedronBufferGeometry:Ra,OctahedronGeometry:Ca,OctahedronBufferGeometry:Ia,IcosahedronGeometry:ka,IcosahedronBufferGeometry:La,DodecahedronGeometry:Na,DodecahedronBufferGeometry:ja,PolyhedronGeometry:Oa,PolyhedronBufferGeometry:Aa,TubeGeometry:Ba,TubeBufferGeometry:Fa,TorusKnotGeometry:Ua,TorusKnotBufferGeometry:za,TorusGeometry:Ga,TorusBufferGeometry:Ha,TextGeometry:bs,TextBufferGeometry:ws,SphereGeometry:_s,SphereBufferGeometry:xs,RingGeometry:Ss,RingBufferGeometry:Ts,PlaneGeometry:xr,PlaneBufferGeometry:Sr,LatheGeometry:Ms,LatheBufferGeometry:Es,ShapeGeometry:Ps,ShapeBufferGeometry:Os,ExtrudeGeometry:ys,ExtrudeBufferGeometry:ms,EdgesGeometry:Ds,ConeGeometry:Is,ConeBufferGeometry:ks,CylinderGeometry:Rs,CylinderBufferGeometry:Cs,CircleGeometry:Ls,CircleBufferGeometry:Ns,BoxGeometry:or,BoxBufferGeometry:ar});function Bs(t){hn.call(this),this.type="ShadowMaterial",this.color=new on(0),this.transparent=!0,this.setValues(t)}function Fs(t){lr.call(this,t),this.type="RawShaderMaterial"}function Us(t){hn.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new on(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new on(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=St,this.normalScale=new Dt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(t)}function zs(t){Us.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Dt(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,this.sheen=null,this.transparency=0,this.setValues(t)}function Gs(t){hn.call(this),this.type="MeshPhongMaterial",this.color=new on(16777215),this.specular=new on(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new on(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=St,this.normalScale=new Dt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Hs(t){hn.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new on(16777215),this.specular=new on(1118481),this.shininess=30,this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new on(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=St,this.normalScale=new Dt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Vs(t){hn.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=St,this.normalScale=new Dt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Ws(t){hn.call(this),this.type="MeshLambertMaterial",this.color=new on(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new on(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function qs(t){hn.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new on(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=St,this.normalScale=new Dt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Ys(t){ra.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}Bs.prototype=Object.create(hn.prototype),Bs.prototype.constructor=Bs,Bs.prototype.isShadowMaterial=!0,Bs.prototype.copy=function(t){return hn.prototype.copy.call(this,t),this.color.copy(t.color),this},Fs.prototype=Object.create(lr.prototype),Fs.prototype.constructor=Fs,Fs.prototype.isRawShaderMaterial=!0,Us.prototype=Object.create(hn.prototype),Us.prototype.constructor=Us,Us.prototype.isMeshStandardMaterial=!0,Us.prototype.copy=function(t){return hn.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.vertexTangents=t.vertexTangents,this},zs.prototype=Object.create(Us.prototype),zs.prototype.constructor=zs,zs.prototype.isMeshPhysicalMaterial=!0,zs.prototype.copy=function(t){return Us.prototype.copy.call(this,t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.reflectivity=t.reflectivity,t.sheen?this.sheen=(this.sheen||new on).copy(t.sheen):this.sheen=null,this.transparency=t.transparency,this},Gs.prototype=Object.create(hn.prototype),Gs.prototype.constructor=Gs,Gs.prototype.isMeshPhongMaterial=!0,Gs.prototype.copy=function(t){return hn.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Hs.prototype=Object.create(hn.prototype),Hs.prototype.constructor=Hs,Hs.prototype.isMeshToonMaterial=!0,Hs.prototype.copy=function(t){return hn.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Vs.prototype=Object.create(hn.prototype),Vs.prototype.constructor=Vs,Vs.prototype.isMeshNormalMaterial=!0,Vs.prototype.copy=function(t){return hn.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Ws.prototype=Object.create(hn.prototype),Ws.prototype.constructor=Ws,Ws.prototype.isMeshLambertMaterial=!0,Ws.prototype.copy=function(t){return hn.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},qs.prototype=Object.create(hn.prototype),qs.prototype.constructor=qs,qs.prototype.isMeshMatcapMaterial=!0,qs.prototype.copy=function(t){return hn.prototype.copy.call(this,t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Ys.prototype=Object.create(ra.prototype),Ys.prototype.constructor=Ys,Ys.prototype.isLineDashedMaterial=!0,Ys.prototype.copy=function(t){return ra.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var Js=Object.freeze({__proto__:null,ShadowMaterial:Bs,SpriteMaterial:Ao,RawShaderMaterial:Fs,ShaderMaterial:lr,PointsMaterial:da,MeshPhysicalMaterial:zs,MeshStandardMaterial:Us,MeshPhongMaterial:Gs,MeshToonMaterial:Hs,MeshNormalMaterial:Vs,MeshLambertMaterial:Ws,MeshDepthMaterial:fo,MeshDistanceMaterial:po,MeshBasicMaterial:fn,MeshMatcapMaterial:qs,LineDashedMaterial:Ys,LineBasicMaterial:ra,Material:hn}),Xs={arraySlice:function(t,e,n){return Xs.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==n?n:t.length)):t.slice(e,n)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){for(var e=t.length,n=new Array(e),r=0;r!==e;++r)n[r]=r;return n.sort((function(e,n){return t[e]-t[n]})),n},sortedArray:function(t,e,n){for(var r=t.length,i=new t.constructor(r),o=0,a=0;a!==r;++o)for(var s=n[o]*e,c=0;c!==e;++c)i[a++]=t[s+c];return i},flattenJSON:function(t,e,n,r){for(var i=1,o=t[0];void 0!==o&&void 0===o[r];)o=t[i++];if(void 0!==o){var a=o[r];if(void 0!==a)if(Array.isArray(a))do{void 0!==(a=o[r])&&(e.push(o.time),n.push.apply(n,a)),o=t[i++]}while(void 0!==o);else if(void 0!==a.toArray)do{void 0!==(a=o[r])&&(e.push(o.time),a.toArray(n,n.length)),o=t[i++]}while(void 0!==o);else do{void 0!==(a=o[r])&&(e.push(o.time),n.push(a)),o=t[i++]}while(void 0!==o)}},subclip:function(t,e,n,r,i){i=i||30;var o=t.clone();o.name=e;for(var a=[],s=0;s<o.tracks.length;++s){for(var c=o.tracks[s],u=c.getValueSize(),l=[],h=[],f=0;f<c.times.length;++f){var p=c.times[f]*i;if(!(p<n||p>=r)){l.push(c.times[f]);for(var d=0;d<u;++d)h.push(c.values[f*u+d])}}0!==l.length&&(c.times=Xs.convertArray(l,c.times.constructor),c.values=Xs.convertArray(h,c.values.constructor),a.push(c))}o.tracks=a;var y=1/0;for(s=0;s<o.tracks.length;++s)y>o.tracks[s].times[0]&&(y=o.tracks[s].times[0]);for(s=0;s<o.tracks.length;++s)o.tracks[s].shift(-1*y);return o.resetDuration(),o}};function Ks(t,e,n,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new e.constructor(n),this.sampleValues=e,this.valueSize=n}function Qs(t,e,n,r){Ks.call(this,t,e,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function Zs(t,e,n,r){Ks.call(this,t,e,n,r)}function $s(t,e,n,r){Ks.call(this,t,e,n,r)}function tc(t,e,n,r){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=Xs.convertArray(e,this.TimeBufferType),this.values=Xs.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}function ec(t,e,n){tc.call(this,t,e,n)}function nc(t,e,n,r){tc.call(this,t,e,n,r)}function rc(t,e,n,r){tc.call(this,t,e,n,r)}function ic(t,e,n,r){Ks.call(this,t,e,n,r)}function oc(t,e,n,r){tc.call(this,t,e,n,r)}function ac(t,e,n,r){tc.call(this,t,e,n,r)}function sc(t,e,n,r){tc.call(this,t,e,n,r)}function cc(t,e,n){this.name=t,this.tracks=n,this.duration=void 0!==e?e:-1,this.uuid=At.generateUUID(),this.duration<0&&this.resetDuration()}function uc(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var e=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return rc;case"vector":case"vector2":case"vector3":case"vector4":return sc;case"color":return nc;case"quaternion":return oc;case"bool":case"boolean":return ec;case"string":return ac}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);if(void 0===t.times){var n=[],r=[];Xs.flattenJSON(t.keys,n,r,"value"),t.times=n,t.values=r}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}Object.assign(Ks.prototype,{evaluate:function(t){var e=this.parameterPositions,n=this._cachedIndex,r=e[n],i=e[n-1];t:{e:{var o;n:{r:if(!(t<r)){for(var a=n+2;;){if(void 0===r){if(t<i)break r;return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,t,i)}if(n===a)break;if(i=r,t<(r=e[++n]))break e}o=e.length;break n}if(t>=i)break t;var s=e[1];t<s&&(n=2,i=s);for(a=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(n===a)break;if(r=i,t>=(i=e[--n-1]))break e}o=n,n=0}for(;n<o;){var c=n+o>>>1;t<e[c]?o=c:n=c+1}if(r=e[n],void 0===(i=e[n-1]))return this._cachedIndex=0,this.beforeStart_(0,t,r);if(void 0===r)return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,i,t)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,t,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){for(var e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=t*r,o=0;o!==r;++o)e[o]=n[i+o];return e},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(Ks.prototype,{beforeStart_:Ks.prototype.copySampleValue_,afterEnd_:Ks.prototype.copySampleValue_}),Qs.prototype=Object.assign(Object.create(Ks.prototype),{constructor:Qs,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(t,e,n){var r=this.parameterPositions,i=t-2,o=t+1,a=r[i],s=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:i=t,a=2*e-n;break;case 2402:a=e+r[i=r.length-2]-r[i+1];break;default:i=t,a=n}if(void 0===s)switch(this.getSettings_().endingEnd){case 2401:o=t,s=2*n-e;break;case 2402:o=1,s=n+r[1]-r[0];break;default:o=t-1,s=e}var c=.5*(n-e),u=this.valueSize;this._weightPrev=c/(e-a),this._weightNext=c/(s-n),this._offsetPrev=i*u,this._offsetNext=o*u},interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,c=s-a,u=this._offsetPrev,l=this._offsetNext,h=this._weightPrev,f=this._weightNext,p=(n-e)/(r-e),d=p*p,y=d*p,m=-h*y+2*h*d-h*p,v=(1+h)*y+(-1.5-2*h)*d+(-.5+h)*p+1,g=(-1-f)*y+(1.5+f)*d+.5*p,b=f*y-f*d,w=0;w!==a;++w)i[w]=m*o[u+w]+v*o[c+w]+g*o[s+w]+b*o[l+w];return i}}),Zs.prototype=Object.assign(Object.create(Ks.prototype),{constructor:Zs,interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,c=s-a,u=(n-e)/(r-e),l=1-u,h=0;h!==a;++h)i[h]=o[c+h]*l+o[s+h]*u;return i}}),$s.prototype=Object.assign(Object.create(Ks.prototype),{constructor:$s,interpolate_:function(t){return this.copySampleValue_(t-1)}}),Object.assign(tc,{toJSON:function(t){var e,n=t.constructor;if(void 0!==n.toJSON)e=n.toJSON(t);else{e={name:t.name,times:Xs.convertArray(t.times,Array),values:Xs.convertArray(t.values,Array)};var r=t.getInterpolation();r!==t.DefaultInterpolation&&(e.interpolation=r)}return e.type=t.ValueTypeName,e}}),Object.assign(tc.prototype,{constructor:tc,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:bt,InterpolantFactoryMethodDiscrete:function(t){return new $s(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new Zs(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new Qs(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var e;switch(t){case gt:e=this.InterpolantFactoryMethodDiscrete;break;case bt:e=this.InterpolantFactoryMethodLinear;break;case 2302:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=e,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return gt;case this.InterpolantFactoryMethodLinear:return bt;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,n=0,r=e.length;n!==r;++n)e[n]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,n=0,r=e.length;n!==r;++n)e[n]*=t;return this},trim:function(t,e){for(var n=this.times,r=n.length,i=0,o=r-1;i!==r&&n[i]<t;)++i;for(;-1!==o&&n[o]>e;)--o;if(++o,0!==i||o!==r){i>=o&&(i=(o=Math.max(o,1))-1);var a=this.getValueSize();this.times=Xs.arraySlice(n,i,o),this.values=Xs.arraySlice(this.values,i*a,o*a)}return this},validate:function(){var t=!0,e=this.getValueSize();e-Math.floor(e)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);var n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);for(var o=null,a=0;a!==i;a++){var s=n[a];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,s),t=!1;break}if(null!==o&&o>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,s,o),t=!1;break}o=s}if(void 0!==r&&Xs.isTypedArray(r)){a=0;for(var c=r.length;a!==c;++a){var u=r[a];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,u),t=!1;break}}}return t},optimize:function(){for(var t=Xs.arraySlice(this.times),e=Xs.arraySlice(this.values),n=this.getValueSize(),r=2302===this.getInterpolation(),i=1,o=t.length-1,a=1;a<o;++a){var s=!1,c=t[a];if(c!==t[a+1]&&(1!==a||c!==c[0]))if(r)s=!0;else for(var u=a*n,l=u-n,h=u+n,f=0;f!==n;++f){var p=e[u+f];if(p!==e[l+f]||p!==e[h+f]){s=!0;break}}if(s){if(a!==i){t[i]=t[a];var d=a*n,y=i*n;for(f=0;f!==n;++f)e[y+f]=e[d+f]}++i}}if(o>0){t[i]=t[o];for(d=o*n,y=i*n,f=0;f!==n;++f)e[y+f]=e[d+f];++i}return i!==t.length?(this.times=Xs.arraySlice(t,0,i),this.values=Xs.arraySlice(e,0,i*n)):(this.times=t,this.values=e),this},clone:function(){var t=Xs.arraySlice(this.times,0),e=Xs.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,t,e);return n.createInterpolant=this.createInterpolant,n}}),ec.prototype=Object.assign(Object.create(tc.prototype),{constructor:ec,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:gt,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),nc.prototype=Object.assign(Object.create(tc.prototype),{constructor:nc,ValueTypeName:"color"}),rc.prototype=Object.assign(Object.create(tc.prototype),{constructor:rc,ValueTypeName:"number"}),ic.prototype=Object.assign(Object.create(Ks.prototype),{constructor:ic,interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,c=(n-e)/(r-e),u=s+a;s!==u;s+=4)Bt.slerpFlat(i,0,o,s-a,o,s,c);return i}}),oc.prototype=Object.assign(Object.create(tc.prototype),{constructor:oc,ValueTypeName:"quaternion",DefaultInterpolation:bt,InterpolantFactoryMethodLinear:function(t){return new ic(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),ac.prototype=Object.assign(Object.create(tc.prototype),{constructor:ac,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:gt,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),sc.prototype=Object.assign(Object.create(tc.prototype),{constructor:sc,ValueTypeName:"vector"}),Object.assign(cc,{parse:function(t){for(var e=[],n=t.tracks,r=1/(t.fps||1),i=0,o=n.length;i!==o;++i)e.push(uc(n[i]).scale(r));return new cc(t.name,t.duration,e)},toJSON:function(t){for(var e=[],n=t.tracks,r={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid},i=0,o=n.length;i!==o;++i)e.push(tc.toJSON(n[i]));return r},CreateFromMorphTargetSequence:function(t,e,n,r){for(var i=e.length,o=[],a=0;a<i;a++){var s=[],c=[];s.push((a+i-1)%i,a,(a+1)%i),c.push(0,1,0);var u=Xs.getKeyframeOrder(s);s=Xs.sortedArray(s,1,u),c=Xs.sortedArray(c,1,u),r||0!==s[0]||(s.push(i),c.push(c[0])),o.push(new rc(".morphTargetInfluences["+e[a].name+"]",s,c).scale(1/n))}return new cc(t,-1,o)},findByName:function(t,e){var n=t;if(!Array.isArray(t)){var r=t;n=r.geometry&&r.geometry.animations||r.animations}for(var i=0;i<n.length;i++)if(n[i].name===e)return n[i];return null},CreateClipsFromMorphTargetSequences:function(t,e,n){for(var r={},i=/^([\w-]*?)([\d]+)$/,o=0,a=t.length;o<a;o++){var s=t[o],c=s.name.match(i);if(c&&c.length>1){var u=r[h=c[1]];u||(r[h]=u=[]),u.push(s)}}var l=[];for(var h in r)l.push(cc.CreateFromMorphTargetSequence(h,r[h],e,n));return l},parseAnimation:function(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(t,e,n,r,i){if(0!==n.length){var o=[],a=[];Xs.flattenJSON(n,o,a,r),0!==o.length&&i.push(new t(e,o,a))}},r=[],i=t.name||"default",o=t.length||-1,a=t.fps||30,s=t.hierarchy||[],c=0;c<s.length;c++){var u=s[c].keys;if(u&&0!==u.length)if(u[0].morphTargets){for(var l={},h=0;h<u.length;h++)if(u[h].morphTargets)for(var f=0;f<u[h].morphTargets.length;f++)l[u[h].morphTargets[f]]=-1;for(var p in l){var d=[],y=[];for(f=0;f!==u[h].morphTargets.length;++f){var m=u[h];d.push(m.time),y.push(m.morphTarget===p?1:0)}r.push(new rc(".morphTargetInfluence["+p+"]",d,y))}o=l.length*(a||1)}else{var v=".bones["+e[c].name+"]";n(sc,v+".position",u,"pos",r),n(oc,v+".quaternion",u,"rot",r),n(sc,v+".scale",u,"scl",r)}}return 0===r.length?null:new cc(i,o,r)}}),Object.assign(cc.prototype,{resetDuration:function(){for(var t=0,e=0,n=this.tracks.length;e!==n;++e){var r=this.tracks[e];t=Math.max(t,r.times[r.times.length-1])}return this.duration=t,this},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},validate:function(){for(var t=!0,e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},clone:function(){for(var t=[],e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new cc(this.name,this.duration,t)}});var lc={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};function hc(t,e,n){var r=this,i=!1,o=0,a=0,s=void 0,c=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){a++,!1===i&&void 0!==r.onStart&&r.onStart(t,o,a),i=!0},this.itemEnd=function(t){o++,void 0!==r.onProgress&&r.onProgress(t,o,a),o===a&&(i=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(t){void 0!==r.onError&&r.onError(t)},this.resolveURL=function(t){return s?s(t):t},this.setURLModifier=function(t){return s=t,this},this.addHandler=function(t,e){return c.push(t,e),this},this.removeHandler=function(t){var e=c.indexOf(t);return-1!==e&&c.splice(e,2),this},this.getHandler=function(t){for(var e=0,n=c.length;e<n;e+=2){var r=c[e],i=c[e+1];if(r.global&&(r.lastIndex=0),r.test(t))return i}return null}}var fc=new hc;function pc(t){this.manager=void 0!==t?t:fc,this.crossOrigin="anonymous",this.path="",this.resourcePath=""}Object.assign(pc.prototype,{load:function(){},parse:function(){},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this},setResourcePath:function(t){return this.resourcePath=t,this}});var dc={};function yc(t){pc.call(this,t)}function mc(t){pc.call(this,t)}function vc(t){pc.call(this,t)}function gc(t){pc.call(this,t)}function bc(t){pc.call(this,t)}function wc(t){pc.call(this,t)}function _c(t){pc.call(this,t)}function xc(){this.type="Curve",this.arcLengthDivisions=200}function Sc(t,e,n,r,i,o,a,s){xc.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=e||0,this.xRadius=n||1,this.yRadius=r||1,this.aStartAngle=i||0,this.aEndAngle=o||2*Math.PI,this.aClockwise=a||!1,this.aRotation=s||0}function Tc(t,e,n,r,i,o){Sc.call(this,t,e,n,n,r,i,o),this.type="ArcCurve"}function Mc(){var t=0,e=0,n=0,r=0;function i(i,o,a,s){t=i,e=a,n=-3*i+3*o-2*a-s,r=2*i-2*o+a+s}return{initCatmullRom:function(t,e,n,r,o){i(e,n,o*(n-t),o*(r-e))},initNonuniformCatmullRom:function(t,e,n,r,o,a,s){var c=(e-t)/o-(n-t)/(o+a)+(n-e)/a,u=(n-e)/a-(r-e)/(a+s)+(r-n)/s;i(e,n,c*=a,u*=a)},calc:function(i){var o=i*i;return t+e*i+n*o+r*(o*i)}}}yc.prototype=Object.assign(Object.create(pc.prototype),{constructor:yc,load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,o=lc.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout((function(){e&&e(o),i.manager.itemEnd(t)}),0),o;if(void 0===dc[t]){var a=t.match(/^data:(.*?)(;base64)?,(.*)$/);if(a){var s=a[1],c=!!a[2],u=a[3];u=decodeURIComponent(u),c&&(u=atob(u));try{var l,h=(this.responseType||"").toLowerCase();switch(h){case"arraybuffer":case"blob":for(var f=new Uint8Array(u.length),p=0;p<u.length;p++)f[p]=u.charCodeAt(p);l="blob"===h?new Blob([f.buffer],{type:s}):f.buffer;break;case"document":var d=new DOMParser;l=d.parseFromString(u,s);break;case"json":l=JSON.parse(u);break;default:l=u}setTimeout((function(){e&&e(l),i.manager.itemEnd(t)}),0)}catch(e){setTimeout((function(){r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)}),0)}}else{dc[t]=[],dc[t].push({onLoad:e,onProgress:n,onError:r});var y=new XMLHttpRequest;for(var m in y.open("GET",t,!0),y.addEventListener("load",(function(e){var n=this.response,r=dc[t];if(delete dc[t],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),lc.add(t,n);for(var o=0,a=r.length;o<a;o++){(s=r[o]).onLoad&&s.onLoad(n)}i.manager.itemEnd(t)}else{for(o=0,a=r.length;o<a;o++){var s;(s=r[o]).onError&&s.onError(e)}i.manager.itemError(t),i.manager.itemEnd(t)}}),!1),y.addEventListener("progress",(function(e){for(var n=dc[t],r=0,i=n.length;r<i;r++){var o=n[r];o.onProgress&&o.onProgress(e)}}),!1),y.addEventListener("error",(function(e){var n=dc[t];delete dc[t];for(var r=0,o=n.length;r<o;r++){var a=n[r];a.onError&&a.onError(e)}i.manager.itemError(t),i.manager.itemEnd(t)}),!1),y.addEventListener("abort",(function(e){var n=dc[t];delete dc[t];for(var r=0,o=n.length;r<o;r++){var a=n[r];a.onError&&a.onError(e)}i.manager.itemError(t),i.manager.itemEnd(t)}),!1),void 0!==this.responseType&&(y.responseType=this.responseType),void 0!==this.withCredentials&&(y.withCredentials=this.withCredentials),y.overrideMimeType&&y.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)y.setRequestHeader(m,this.requestHeader[m]);y.send(null)}return i.manager.itemStart(t),y}dc[t].push({onLoad:e,onProgress:n,onError:r})},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}}),mc.prototype=Object.assign(Object.create(pc.prototype),{constructor:mc,load:function(t,e,n,r){var i=this,o=new yc(i.manager);o.setPath(i.path),o.load(t,(function(t){e(i.parse(JSON.parse(t)))}),n,r)},parse:function(t){for(var e=[],n=0;n<t.length;n++){var r=cc.parse(t[n]);e.push(r)}return e}}),vc.prototype=Object.assign(Object.create(pc.prototype),{constructor:vc,load:function(t,e,n,r){var i=this,o=[],a=new xa;a.image=o;var s=new yc(this.manager);function c(c){s.load(t[c],(function(t){var n=i.parse(t,!0);o[c]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},6===(u+=1)&&(1===n.mipmapCount&&(a.minFilter=z),a.format=n.format,a.needsUpdate=!0,e&&e(a))}),n,r)}if(s.setPath(this.path),s.setResponseType("arraybuffer"),Array.isArray(t))for(var u=0,l=0,h=t.length;l<h;++l)c(l);else s.load(t,(function(t){var n=i.parse(t,!0);if(n.isCubemap)for(var r=n.mipmaps.length/n.mipmapCount,s=0;s<r;s++){o[s]={mipmaps:[]};for(var c=0;c<n.mipmapCount;c++)o[s].mipmaps.push(n.mipmaps[s*n.mipmapCount+c]),o[s].format=n.format,o[s].width=n.width,o[s].height=n.height}else a.image.width=n.width,a.image.height=n.height,a.mipmaps=n.mipmaps;1===n.mipmapCount&&(a.minFilter=z),a.format=n.format,a.needsUpdate=!0,e&&e(a)}),n,r);return a}}),gc.prototype=Object.assign(Object.create(pc.prototype),{constructor:gc,load:function(t,e,n,r){var i=this,o=new yr,a=new yc(this.manager);return a.setResponseType("arraybuffer"),a.setPath(this.path),a.load(t,(function(t){var n=i.parse(t);n&&(void 0!==n.image?o.image=n.image:void 0!==n.data&&(o.image.width=n.width,o.image.height=n.height,o.image.data=n.data),o.wrapS=void 0!==n.wrapS?n.wrapS:k,o.wrapT=void 0!==n.wrapT?n.wrapT:k,o.magFilter=void 0!==n.magFilter?n.magFilter:z,o.minFilter=void 0!==n.minFilter?n.minFilter:z,o.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.format&&(o.format=n.format),void 0!==n.type&&(o.type=n.type),void 0!==n.mipmaps&&(o.mipmaps=n.mipmaps,o.minFilter=V),1===n.mipmapCount&&(o.minFilter=z),o.needsUpdate=!0,e&&e(o,n))}),n,r),o}}),bc.prototype=Object.assign(Object.create(pc.prototype),{constructor:bc,load:function(t,e,n,r){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,o=lc.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout((function(){e&&e(o),i.manager.itemEnd(t)}),0),o;var a=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){a.removeEventListener("load",s,!1),a.removeEventListener("error",c,!1),lc.add(t,this),e&&e(this),i.manager.itemEnd(t)}function c(e){a.removeEventListener("load",s,!1),a.removeEventListener("error",c,!1),r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)}return a.addEventListener("load",s,!1),a.addEventListener("error",c,!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),i.manager.itemStart(t),a.src=t,a}}),wc.prototype=Object.assign(Object.create(pc.prototype),{constructor:wc,load:function(t,e,n,r){var i=new jr,o=new bc(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);var a=0;function s(n){o.load(t[n],(function(t){i.images[n]=t,6===++a&&(i.needsUpdate=!0,e&&e(i))}),void 0,r)}for(var c=0;c<t.length;++c)s(c);return i}}),_c.prototype=Object.assign(Object.create(pc.prototype),{constructor:_c,load:function(t,e,n,r){var i=new kt,o=new bc(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(t,(function(n){i.image=n;var r=t.search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/);i.format=r?it:ot,i.needsUpdate=!0,void 0!==e&&e(i)}),n,r),i}}),Object.assign(xc.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,e){var n=this.getUtoTmapping(t);return this.getPoint(n,e)},getPoints:function(t){void 0===t&&(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return e},getSpacedPoints:function(t){void 0===t&&(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,n,r=[],i=this.getPoint(0),o=0;for(r.push(0),n=1;n<=t;n++)o+=(e=this.getPoint(n/t)).distanceTo(i),r.push(o),i=e;return this.cacheArcLengths=r,r},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){var n,r=this.getLengths(),i=0,o=r.length;n=e||t*r[o-1];for(var a,s=0,c=o-1;s<=c;)if((a=r[i=Math.floor(s+(c-s)/2)]-n)<0)s=i+1;else{if(!(a>0)){c=i;break}c=i-1}if(r[i=c]===n)return i/(o-1);var u=r[i];return(i+(n-u)/(r[i+1]-u))/(o-1)},getTangent:function(t){var e=t-1e-4,n=t+1e-4;e<0&&(e=0),n>1&&(n=1);var r=this.getPoint(e);return this.getPoint(n).clone().sub(r).normalize()},getTangentAt:function(t){var e=this.getUtoTmapping(t);return this.getTangent(e)},computeFrenetFrames:function(t,e){var n,r,i,o=new zt,a=[],s=[],c=[],u=new zt,l=new Xt;for(n=0;n<=t;n++)r=n/t,a[n]=this.getTangentAt(r),a[n].normalize();s[0]=new zt,c[0]=new zt;var h=Number.MAX_VALUE,f=Math.abs(a[0].x),p=Math.abs(a[0].y),d=Math.abs(a[0].z);for(f<=h&&(h=f,o.set(1,0,0)),p<=h&&(h=p,o.set(0,1,0)),d<=h&&o.set(0,0,1),u.crossVectors(a[0],o).normalize(),s[0].crossVectors(a[0],u),c[0].crossVectors(a[0],s[0]),n=1;n<=t;n++)s[n]=s[n-1].clone(),c[n]=c[n-1].clone(),u.crossVectors(a[n-1],a[n]),u.length()>Number.EPSILON&&(u.normalize(),i=Math.acos(At.clamp(a[n-1].dot(a[n]),-1,1)),s[n].applyMatrix4(l.makeRotationAxis(u,i))),c[n].crossVectors(a[n],s[n]);if(!0===e)for(i=Math.acos(At.clamp(s[0].dot(s[t]),-1,1)),i/=t,a[0].dot(u.crossVectors(s[0],s[t]))>0&&(i=-i),n=1;n<=t;n++)s[n].applyMatrix4(l.makeRotationAxis(a[n],i*n)),c[n].crossVectors(a[n],s[n]);return{tangents:a,normals:s,binormals:c}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){var t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),Sc.prototype=Object.create(xc.prototype),Sc.prototype.constructor=Sc,Sc.prototype.isEllipseCurve=!0,Sc.prototype.getPoint=function(t,e){for(var n=e||new Dt,r=2*Math.PI,i=this.aEndAngle-this.aStartAngle,o=Math.abs(i)<Number.EPSILON;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=o?0:r),!0!==this.aClockwise||o||(i===r?i=-r:i-=r);var a=this.aStartAngle+t*i,s=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){var u=Math.cos(this.aRotation),l=Math.sin(this.aRotation),h=s-this.aX,f=c-this.aY;s=h*u-f*l+this.aX,c=h*l+f*u+this.aY}return n.set(s,c)},Sc.prototype.copy=function(t){return xc.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Sc.prototype.toJSON=function(){var t=xc.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},Sc.prototype.fromJSON=function(t){return xc.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Tc.prototype=Object.create(Sc.prototype),Tc.prototype.constructor=Tc,Tc.prototype.isArcCurve=!0;var Ec=new zt,Pc=new Mc,Oc=new Mc,Ac=new Mc;function Dc(t,e,n,r){xc.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=e||!1,this.curveType=n||"centripetal",this.tension=r||.5}function Rc(t,e,n,r,i){var o=.5*(r-e),a=.5*(i-n),s=t*t;return(2*n-2*r+o+a)*(t*s)+(-3*n+3*r-2*o-a)*s+o*t+n}function Cc(t,e,n,r){return function(t,e){var n=1-t;return n*n*e}(t,e)+function(t,e){return 2*(1-t)*t*e}(t,n)+function(t,e){return t*t*e}(t,r)}function Ic(t,e,n,r,i){return function(t,e){var n=1-t;return n*n*n*e}(t,e)+function(t,e){var n=1-t;return 3*n*n*t*e}(t,n)+function(t,e){return 3*(1-t)*t*t*e}(t,r)+function(t,e){return t*t*t*e}(t,i)}function kc(t,e,n,r){xc.call(this),this.type="CubicBezierCurve",this.v0=t||new Dt,this.v1=e||new Dt,this.v2=n||new Dt,this.v3=r||new Dt}function Lc(t,e,n,r){xc.call(this),this.type="CubicBezierCurve3",this.v0=t||new zt,this.v1=e||new zt,this.v2=n||new zt,this.v3=r||new zt}function Nc(t,e){xc.call(this),this.type="LineCurve",this.v1=t||new Dt,this.v2=e||new Dt}function jc(t,e){xc.call(this),this.type="LineCurve3",this.v1=t||new zt,this.v2=e||new zt}function Bc(t,e,n){xc.call(this),this.type="QuadraticBezierCurve",this.v0=t||new Dt,this.v1=e||new Dt,this.v2=n||new Dt}function Fc(t,e,n){xc.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new zt,this.v1=e||new zt,this.v2=n||new zt}function Uc(t){xc.call(this),this.type="SplineCurve",this.points=t||[]}Dc.prototype=Object.create(xc.prototype),Dc.prototype.constructor=Dc,Dc.prototype.isCatmullRomCurve3=!0,Dc.prototype.getPoint=function(t,e){var n,r,i,o,a=e||new zt,s=this.points,c=s.length,u=(c-(this.closed?0:1))*t,l=Math.floor(u),h=u-l;if(this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/c)+1)*c:0===h&&l===c-1&&(l=c-2,h=1),this.closed||l>0?n=s[(l-1)%c]:(Ec.subVectors(s[0],s[1]).add(s[0]),n=Ec),r=s[l%c],i=s[(l+1)%c],this.closed||l+2<c?o=s[(l+2)%c]:(Ec.subVectors(s[c-1],s[c-2]).add(s[c-1]),o=Ec),"centripetal"===this.curveType||"chordal"===this.curveType){var f="chordal"===this.curveType?.5:.25,p=Math.pow(n.distanceToSquared(r),f),d=Math.pow(r.distanceToSquared(i),f),y=Math.pow(i.distanceToSquared(o),f);d<1e-4&&(d=1),p<1e-4&&(p=d),y<1e-4&&(y=d),Pc.initNonuniformCatmullRom(n.x,r.x,i.x,o.x,p,d,y),Oc.initNonuniformCatmullRom(n.y,r.y,i.y,o.y,p,d,y),Ac.initNonuniformCatmullRom(n.z,r.z,i.z,o.z,p,d,y)}else"catmullrom"===this.curveType&&(Pc.initCatmullRom(n.x,r.x,i.x,o.x,this.tension),Oc.initCatmullRom(n.y,r.y,i.y,o.y,this.tension),Ac.initCatmullRom(n.z,r.z,i.z,o.z,this.tension));return a.set(Pc.calc(h),Oc.calc(h),Ac.calc(h)),a},Dc.prototype.copy=function(t){xc.prototype.copy.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push(r.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},Dc.prototype.toJSON=function(){var t=xc.prototype.toJSON.call(this);t.points=[];for(var e=0,n=this.points.length;e<n;e++){var r=this.points[e];t.points.push(r.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},Dc.prototype.fromJSON=function(t){xc.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push((new zt).fromArray(r))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},kc.prototype=Object.create(xc.prototype),kc.prototype.constructor=kc,kc.prototype.isCubicBezierCurve=!0,kc.prototype.getPoint=function(t,e){var n=e||new Dt,r=this.v0,i=this.v1,o=this.v2,a=this.v3;return n.set(Ic(t,r.x,i.x,o.x,a.x),Ic(t,r.y,i.y,o.y,a.y)),n},kc.prototype.copy=function(t){return xc.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},kc.prototype.toJSON=function(){var t=xc.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},kc.prototype.fromJSON=function(t){return xc.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},Lc.prototype=Object.create(xc.prototype),Lc.prototype.constructor=Lc,Lc.prototype.isCubicBezierCurve3=!0,Lc.prototype.getPoint=function(t,e){var n=e||new zt,r=this.v0,i=this.v1,o=this.v2,a=this.v3;return n.set(Ic(t,r.x,i.x,o.x,a.x),Ic(t,r.y,i.y,o.y,a.y),Ic(t,r.z,i.z,o.z,a.z)),n},Lc.prototype.copy=function(t){return xc.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},Lc.prototype.toJSON=function(){var t=xc.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},Lc.prototype.fromJSON=function(t){return xc.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},Nc.prototype=Object.create(xc.prototype),Nc.prototype.constructor=Nc,Nc.prototype.isLineCurve=!0,Nc.prototype.getPoint=function(t,e){var n=e||new Dt;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n},Nc.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},Nc.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},Nc.prototype.copy=function(t){return xc.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Nc.prototype.toJSON=function(){var t=xc.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Nc.prototype.fromJSON=function(t){return xc.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},jc.prototype=Object.create(xc.prototype),jc.prototype.constructor=jc,jc.prototype.isLineCurve3=!0,jc.prototype.getPoint=function(t,e){var n=e||new zt;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n},jc.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},jc.prototype.copy=function(t){return xc.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},jc.prototype.toJSON=function(){var t=xc.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},jc.prototype.fromJSON=function(t){return xc.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},Bc.prototype=Object.create(xc.prototype),Bc.prototype.constructor=Bc,Bc.prototype.isQuadraticBezierCurve=!0,Bc.prototype.getPoint=function(t,e){var n=e||new Dt,r=this.v0,i=this.v1,o=this.v2;return n.set(Cc(t,r.x,i.x,o.x),Cc(t,r.y,i.y,o.y)),n},Bc.prototype.copy=function(t){return xc.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Bc.prototype.toJSON=function(){var t=xc.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Bc.prototype.fromJSON=function(t){return xc.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},Fc.prototype=Object.create(xc.prototype),Fc.prototype.constructor=Fc,Fc.prototype.isQuadraticBezierCurve3=!0,Fc.prototype.getPoint=function(t,e){var n=e||new zt,r=this.v0,i=this.v1,o=this.v2;return n.set(Cc(t,r.x,i.x,o.x),Cc(t,r.y,i.y,o.y),Cc(t,r.z,i.z,o.z)),n},Fc.prototype.copy=function(t){return xc.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Fc.prototype.toJSON=function(){var t=xc.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Fc.prototype.fromJSON=function(t){return xc.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},Uc.prototype=Object.create(xc.prototype),Uc.prototype.constructor=Uc,Uc.prototype.isSplineCurve=!0,Uc.prototype.getPoint=function(t,e){var n=e||new Dt,r=this.points,i=(r.length-1)*t,o=Math.floor(i),a=i-o,s=r[0===o?o:o-1],c=r[o],u=r[o>r.length-2?r.length-1:o+1],l=r[o>r.length-3?r.length-1:o+2];return n.set(Rc(a,s.x,c.x,u.x,l.x),Rc(a,s.y,c.y,u.y,l.y)),n},Uc.prototype.copy=function(t){xc.prototype.copy.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push(r.clone())}return this},Uc.prototype.toJSON=function(){var t=xc.prototype.toJSON.call(this);t.points=[];for(var e=0,n=this.points.length;e<n;e++){var r=this.points[e];t.points.push(r.toArray())}return t},Uc.prototype.fromJSON=function(t){xc.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push((new Dt).fromArray(r))}return this};var zc=Object.freeze({__proto__:null,ArcCurve:Tc,CatmullRomCurve3:Dc,CubicBezierCurve:kc,CubicBezierCurve3:Lc,EllipseCurve:Sc,LineCurve:Nc,LineCurve3:jc,QuadraticBezierCurve:Bc,QuadraticBezierCurve3:Fc,SplineCurve:Uc});function Gc(){xc.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function Hc(t){Gc.call(this),this.type="Path",this.currentPoint=new Dt,t&&this.setFromPoints(t)}function Vc(t){Hc.call(this,t),this.uuid=At.generateUUID(),this.type="Shape",this.holes=[]}function Wc(t,e){pe.call(this),this.type="Light",this.color=new on(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0}function qc(t,e,n){Wc.call(this,t,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(pe.DefaultUp),this.updateMatrix(),this.groundColor=new on(e)}function Yc(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new Dt(512,512),this.map=null,this.mapPass=null,this.matrix=new Xt,this._frustum=new gr,this._frameExtents=new Dt(1,1),this._viewportCount=1,this._viewports=[new Lt(0,0,1,1)]}function Jc(){Yc.call(this,new fr(50,1,.5,500))}function Xc(t,e,n,r,i,o){Wc.call(this,t,e),this.type="SpotLight",this.position.copy(pe.DefaultUp),this.updateMatrix(),this.target=new pe,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==r?r:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==o?o:1,this.shadow=new Jc}function Kc(){Yc.call(this,new fr(90,1,.5,500)),this._frameExtents=new Dt(4,2),this._viewportCount=6,this._viewports=[new Lt(2,1,1,1),new Lt(0,1,1,1),new Lt(3,1,1,1),new Lt(1,1,1,1),new Lt(3,0,1,1),new Lt(1,0,1,1)],this._cubeDirections=[new zt(1,0,0),new zt(-1,0,0),new zt(0,0,1),new zt(0,0,-1),new zt(0,1,0),new zt(0,-1,0)],this._cubeUps=[new zt(0,1,0),new zt(0,1,0),new zt(0,1,0),new zt(0,1,0),new zt(0,0,1),new zt(0,0,-1)]}function Qc(t,e,n,r){Wc.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==r?r:1,this.shadow=new Kc}function Zc(t,e,n,r,i,o){hr.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==t?t:-1,this.right=void 0!==e?e:1,this.top=void 0!==n?n:1,this.bottom=void 0!==r?r:-1,this.near=void 0!==i?i:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}function $c(){Yc.call(this,new Zc(-5,5,5,-5,.5,500))}function tu(t,e){Wc.call(this,t,e),this.type="DirectionalLight",this.position.copy(pe.DefaultUp),this.updateMatrix(),this.target=new pe,this.shadow=new $c}function eu(t,e){Wc.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0}function nu(t,e,n,r){Wc.call(this,t,e),this.type="RectAreaLight",this.width=void 0!==n?n:10,this.height=void 0!==r?r:10}function ru(t){pc.call(this,t),this.textures={}}Gc.prototype=Object.assign(Object.create(xc.prototype),{constructor:Gc,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new Nc(e,t))},getPoint:function(t){for(var e=t*this.getLength(),n=this.getCurveLengths(),r=0;r<n.length;){if(n[r]>=e){var i=n[r]-e,o=this.curves[r],a=o.getLength(),s=0===a?0:1-i/a;return o.getPointAt(s)}r++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,n=0,r=this.curves.length;n<r;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t},getSpacedPoints:function(t){void 0===t&&(t=40);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t){t=t||12;for(var e,n=[],r=0,i=this.curves;r<i.length;r++)for(var o=i[r],a=o&&o.isEllipseCurve?2*t:o&&(o.isLineCurve||o.isLineCurve3)?1:o&&o.isSplineCurve?t*o.points.length:t,s=o.getPoints(a),c=0;c<s.length;c++){var u=s[c];e&&e.equals(u)||(n.push(u),e=u)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},copy:function(t){xc.prototype.copy.call(this,t),this.curves=[];for(var e=0,n=t.curves.length;e<n;e++){var r=t.curves[e];this.curves.push(r.clone())}return this.autoClose=t.autoClose,this},toJSON:function(){var t=xc.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(var e=0,n=this.curves.length;e<n;e++){var r=this.curves[e];t.curves.push(r.toJSON())}return t},fromJSON:function(t){xc.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(var e=0,n=t.curves.length;e<n;e++){var r=t.curves[e];this.curves.push((new zc[r.type]).fromJSON(r))}return this}}),Hc.prototype=Object.assign(Object.create(Gc.prototype),{constructor:Hc,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y);return this},moveTo:function(t,e){return this.currentPoint.set(t,e),this},lineTo:function(t,e){var n=new Nc(this.currentPoint.clone(),new Dt(t,e));return this.curves.push(n),this.currentPoint.set(t,e),this},quadraticCurveTo:function(t,e,n,r){var i=new Bc(this.currentPoint.clone(),new Dt(t,e),new Dt(n,r));return this.curves.push(i),this.currentPoint.set(n,r),this},bezierCurveTo:function(t,e,n,r,i,o){var a=new kc(this.currentPoint.clone(),new Dt(t,e),new Dt(n,r),new Dt(i,o));return this.curves.push(a),this.currentPoint.set(i,o),this},splineThru:function(t){var e=new Uc([this.currentPoint.clone()].concat(t));return this.curves.push(e),this.currentPoint.copy(t[t.length-1]),this},arc:function(t,e,n,r,i,o){var a=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(t+a,e+s,n,r,i,o),this},absarc:function(t,e,n,r,i,o){return this.absellipse(t,e,n,n,r,i,o),this},ellipse:function(t,e,n,r,i,o,a,s){var c=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(t+c,e+u,n,r,i,o,a,s),this},absellipse:function(t,e,n,r,i,o,a,s){var c=new Sc(t,e,n,r,i,o,a,s);if(this.curves.length>0){var u=c.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(c);var l=c.getPoint(1);return this.currentPoint.copy(l),this},copy:function(t){return Gc.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){var t=Gc.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return Gc.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}),Vc.prototype=Object.assign(Object.create(Hc.prototype),{constructor:Vc,getPointsHoles:function(t){for(var e=[],n=0,r=this.holes.length;n<r;n++)e[n]=this.holes[n].getPoints(t);return e},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){Hc.prototype.copy.call(this,t),this.holes=[];for(var e=0,n=t.holes.length;e<n;e++){var r=t.holes[e];this.holes.push(r.clone())}return this},toJSON:function(){var t=Hc.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(var e=0,n=this.holes.length;e<n;e++){var r=this.holes[e];t.holes.push(r.toJSON())}return t},fromJSON:function(t){Hc.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(var e=0,n=t.holes.length;e<n;e++){var r=t.holes[e];this.holes.push((new Hc).fromJSON(r))}return this}}),Wc.prototype=Object.assign(Object.create(pe.prototype),{constructor:Wc,isLight:!0,copy:function(t){return pe.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){var e=pe.prototype.toJSON.call(this,t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}),qc.prototype=Object.assign(Object.create(Wc.prototype),{constructor:qc,isHemisphereLight:!0,copy:function(t){return Wc.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Object.assign(Yc.prototype,{_projScreenMatrix:new Xt,_lightPositionWorld:new zt,_lookTarget:new zt,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(t){var e=this.camera,n=this.matrix,r=this._projScreenMatrix,i=this._lookTarget,o=this._lightPositionWorld;o.setFromMatrixPosition(t.matrixWorld),e.position.copy(o),i.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(i),e.updateMatrixWorld(),r.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(r),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(e.projectionMatrix),n.multiply(e.matrixWorldInverse)},getViewport:function(t){return this._viewports[t]},getFrameExtents:function(){return this._frameExtents},copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t={};return 0!==this.bias&&(t.bias=this.bias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),Jc.prototype=Object.assign(Object.create(Yc.prototype),{constructor:Jc,isSpotLightShadow:!0,updateMatrices:function(t){var e=this.camera,n=2*At.RAD2DEG*t.angle,r=this.mapSize.width/this.mapSize.height,i=t.distance||e.far;n===e.fov&&r===e.aspect&&i===e.far||(e.fov=n,e.aspect=r,e.far=i,e.updateProjectionMatrix()),Yc.prototype.updateMatrices.call(this,t)}}),Xc.prototype=Object.assign(Object.create(Wc.prototype),{constructor:Xc,isSpotLight:!0,copy:function(t){return Wc.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),Kc.prototype=Object.assign(Object.create(Yc.prototype),{constructor:Kc,isPointLightShadow:!0,updateMatrices:function(t,e){void 0===e&&(e=0);var n=this.camera,r=this.matrix,i=this._lightPositionWorld,o=this._lookTarget,a=this._projScreenMatrix;i.setFromMatrixPosition(t.matrixWorld),n.position.copy(i),o.copy(n.position),o.add(this._cubeDirections[e]),n.up.copy(this._cubeUps[e]),n.lookAt(o),n.updateMatrixWorld(),r.makeTranslation(-i.x,-i.y,-i.z),a.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(a)}}),Qc.prototype=Object.assign(Object.create(Wc.prototype),{constructor:Qc,isPointLight:!0,copy:function(t){return Wc.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),Zc.prototype=Object.assign(Object.create(hr.prototype),{constructor:Zc,isOrthographicCamera:!0,copy:function(t,e){return hr.prototype.copy.call(this,t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,e,n,r,i,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,i=n-t,o=n+t,a=r+e,s=r-e;if(null!==this.view&&this.view.enabled){var c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o=(i+=c*this.view.offsetX)+c*this.view.width,s=(a-=u*this.view.offsetY)-u*this.view.height}this.projectionMatrix.makeOrthographic(i,o,a,s,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){var e=pe.prototype.toJSON.call(this,t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}),$c.prototype=Object.assign(Object.create(Yc.prototype),{constructor:$c,isDirectionalLightShadow:!0,updateMatrices:function(t){Yc.prototype.updateMatrices.call(this,t)}}),tu.prototype=Object.assign(Object.create(Wc.prototype),{constructor:tu,isDirectionalLight:!0,copy:function(t){return Wc.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),eu.prototype=Object.assign(Object.create(Wc.prototype),{constructor:eu,isAmbientLight:!0}),nu.prototype=Object.assign(Object.create(Wc.prototype),{constructor:nu,isRectAreaLight:!0,copy:function(t){return Wc.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){var e=Wc.prototype.toJSON.call(this,t);return e.object.width=this.width,e.object.height=this.height,e}}),ru.prototype=Object.assign(Object.create(pc.prototype),{constructor:ru,load:function(t,e,n,r){var i=this,o=new yc(i.manager);o.setPath(i.path),o.load(t,(function(t){e(i.parse(JSON.parse(t)))}),n,r)},parse:function(t){var e=this.textures;function n(t){return void 0===e[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),e[t]}var r=new Js[t.type];if(void 0!==t.uuid&&(r.uuid=t.uuid),void 0!==t.name&&(r.name=t.name),void 0!==t.color&&r.color.setHex(t.color),void 0!==t.roughness&&(r.roughness=t.roughness),void 0!==t.metalness&&(r.metalness=t.metalness),void 0!==t.sheen&&(r.sheen=(new on).setHex(t.sheen)),void 0!==t.emissive&&r.emissive.setHex(t.emissive),void 0!==t.specular&&r.specular.setHex(t.specular),void 0!==t.shininess&&(r.shininess=t.shininess),void 0!==t.clearcoat&&(r.clearcoat=t.clearcoat),void 0!==t.clearcoatRoughness&&(r.clearcoatRoughness=t.clearcoatRoughness),void 0!==t.fog&&(r.fog=t.fog),void 0!==t.flatShading&&(r.flatShading=t.flatShading),void 0!==t.blending&&(r.blending=t.blending),void 0!==t.combine&&(r.combine=t.combine),void 0!==t.side&&(r.side=t.side),void 0!==t.opacity&&(r.opacity=t.opacity),void 0!==t.transparent&&(r.transparent=t.transparent),void 0!==t.alphaTest&&(r.alphaTest=t.alphaTest),void 0!==t.depthTest&&(r.depthTest=t.depthTest),void 0!==t.depthWrite&&(r.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(r.colorWrite=t.colorWrite),void 0!==t.stencilWrite&&(r.stencilWrite=t.stencilWrite),void 0!==t.stencilWriteMask&&(r.stencilWriteMask=t.stencilWriteMask),void 0!==t.stencilFunc&&(r.stencilFunc=t.stencilFunc),void 0!==t.stencilRef&&(r.stencilRef=t.stencilRef),void 0!==t.stencilFuncMask&&(r.stencilFuncMask=t.stencilFuncMask),void 0!==t.stencilFail&&(r.stencilFail=t.stencilFail),void 0!==t.stencilZFail&&(r.stencilZFail=t.stencilZFail),void 0!==t.stencilZPass&&(r.stencilZPass=t.stencilZPass),void 0!==t.wireframe&&(r.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(r.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(r.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(r.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(r.rotation=t.rotation),1!==t.linewidth&&(r.linewidth=t.linewidth),void 0!==t.dashSize&&(r.dashSize=t.dashSize),void 0!==t.gapSize&&(r.gapSize=t.gapSize),void 0!==t.scale&&(r.scale=t.scale),void 0!==t.polygonOffset&&(r.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(r.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(r.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.skinning&&(r.skinning=t.skinning),void 0!==t.morphTargets&&(r.morphTargets=t.morphTargets),void 0!==t.morphNormals&&(r.morphNormals=t.morphNormals),void 0!==t.dithering&&(r.dithering=t.dithering),void 0!==t.vertexTangents&&(r.vertexTangents=t.vertexTangents),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.toneMapped&&(r.toneMapped=t.toneMapped),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.vertexColors&&("number"==typeof t.vertexColors?r.vertexColors=t.vertexColors>0:r.vertexColors=t.vertexColors),void 0!==t.uniforms)for(var i in t.uniforms){var o=t.uniforms[i];switch(r.uniforms[i]={},o.type){case"t":r.uniforms[i].value=n(o.value);break;case"c":r.uniforms[i].value=(new on).setHex(o.value);break;case"v2":r.uniforms[i].value=(new Dt).fromArray(o.value);break;case"v3":r.uniforms[i].value=(new zt).fromArray(o.value);break;case"v4":r.uniforms[i].value=(new Lt).fromArray(o.value);break;case"m3":r.uniforms[i].value=(new Rt).fromArray(o.value);case"m4":r.uniforms[i].value=(new Xt).fromArray(o.value);break;default:r.uniforms[i].value=o.value}}if(void 0!==t.defines&&(r.defines=t.defines),void 0!==t.vertexShader&&(r.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(r.fragmentShader=t.fragmentShader),void 0!==t.extensions)for(var a in t.extensions)r.extensions[a]=t.extensions[a];if(void 0!==t.shading&&(r.flatShading=1===t.shading),void 0!==t.size&&(r.size=t.size),void 0!==t.sizeAttenuation&&(r.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(r.map=n(t.map)),void 0!==t.matcap&&(r.matcap=n(t.matcap)),void 0!==t.alphaMap&&(r.alphaMap=n(t.alphaMap)),void 0!==t.bumpMap&&(r.bumpMap=n(t.bumpMap)),void 0!==t.bumpScale&&(r.bumpScale=t.bumpScale),void 0!==t.normalMap&&(r.normalMap=n(t.normalMap)),void 0!==t.normalMapType&&(r.normalMapType=t.normalMapType),void 0!==t.normalScale){var s=t.normalScale;!1===Array.isArray(s)&&(s=[s,s]),r.normalScale=(new Dt).fromArray(s)}return void 0!==t.displacementMap&&(r.displacementMap=n(t.displacementMap)),void 0!==t.displacementScale&&(r.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(r.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(r.roughnessMap=n(t.roughnessMap)),void 0!==t.metalnessMap&&(r.metalnessMap=n(t.metalnessMap)),void 0!==t.emissiveMap&&(r.emissiveMap=n(t.emissiveMap)),void 0!==t.emissiveIntensity&&(r.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(r.specularMap=n(t.specularMap)),void 0!==t.envMap&&(r.envMap=n(t.envMap)),void 0!==t.envMapIntensity&&(r.envMapIntensity=t.envMapIntensity),void 0!==t.reflectivity&&(r.reflectivity=t.reflectivity),void 0!==t.refractionRatio&&(r.refractionRatio=t.refractionRatio),void 0!==t.lightMap&&(r.lightMap=n(t.lightMap)),void 0!==t.lightMapIntensity&&(r.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(r.aoMap=n(t.aoMap)),void 0!==t.aoMapIntensity&&(r.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(r.gradientMap=n(t.gradientMap)),void 0!==t.clearcoatMap&&(r.clearcoatMap=n(t.clearcoatMap)),void 0!==t.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=n(t.clearcoatRoughnessMap)),void 0!==t.clearcoatNormalMap&&(r.clearcoatNormalMap=n(t.clearcoatNormalMap)),void 0!==t.clearcoatNormalScale&&(r.clearcoatNormalScale=(new Dt).fromArray(t.clearcoatNormalScale)),r},setTextures:function(t){return this.textures=t,this}});var iu={decodeText:function(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);for(var e="",n=0,r=t.length;n<r;n++)e+=String.fromCharCode(t[n]);try{return decodeURIComponent(escape(e))}catch(t){return e}},extractUrlBase:function(t){var e=t.lastIndexOf("/");return-1===e?"./":t.substr(0,e+1)}};function ou(){In.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function au(t,e,n,r){"number"==typeof n&&(r=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),dn.call(this,t,e,n),this.meshPerAttribute=r||1}function su(t){pc.call(this,t)}ou.prototype=Object.assign(Object.create(In.prototype),{constructor:ou,isInstancedBufferGeometry:!0,copy:function(t){return In.prototype.copy.call(this,t),this.maxInstancedCount=t.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t=In.prototype.toJSON.call(this);return t.maxInstancedCount=this.maxInstancedCount,t.isInstancedBufferGeometry=!0,t}}),au.prototype=Object.assign(Object.create(dn.prototype),{constructor:au,isInstancedBufferAttribute:!0,copy:function(t){return dn.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},toJSON:function(){var t=dn.prototype.toJSON.call(this);return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}),su.prototype=Object.assign(Object.create(pc.prototype),{constructor:su,load:function(t,e,n,r){var i=this,o=new yc(i.manager);o.setPath(i.path),o.load(t,(function(t){e(i.parse(JSON.parse(t)))}),n,r)},parse:function(t){var e=t.isInstancedBufferGeometry?new ou:new In,n=t.data.index;if(void 0!==n){var r=new cu[n.type](n.array);e.setIndex(new dn(r,1))}var i=t.data.attributes;for(var o in i){var a=i[o],s=(r=new cu[a.type](a.array),new(a.isInstancedBufferAttribute?au:dn)(r,a.itemSize,a.normalized));void 0!==a.name&&(s.name=a.name),e.setAttribute(o,s)}var c=t.data.morphAttributes;if(c)for(var o in c){for(var u=c[o],l=[],h=0,f=u.length;h<f;h++){a=u[h],s=new dn(r=new cu[a.type](a.array),a.itemSize,a.normalized);void 0!==a.name&&(s.name=a.name),l.push(s)}e.morphAttributes[o]=l}t.data.morphTargetsRelative&&(e.morphTargetsRelative=!0);var p=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==p){h=0;for(var d=p.length;h!==d;++h){var y=p[h];e.addGroup(y.start,y.count,y.materialIndex)}}var m=t.data.boundingSphere;if(void 0!==m){var v=new zt;void 0!==m.center&&v.fromArray(m.center),e.boundingSphere=new Re(v,m.radius)}return t.name&&(e.name=t.name),t.userData&&(e.userData=t.userData),e}});var cu={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function uu(t){pc.call(this,t)}uu.prototype=Object.assign(Object.create(pc.prototype),{constructor:uu,load:function(t,e,n,r){var i=this,o=""===this.path?iu.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||o;var a=new yc(i.manager);a.setPath(this.path),a.load(t,(function(n){var o=null;try{o=JSON.parse(n)}catch(e){return void 0!==r&&r(e),void console.error("THREE:ObjectLoader: Can't parse "+t+".",e.message)}var a=o.metadata;void 0!==a&&void 0!==a.type&&"geometry"!==a.type.toLowerCase()?i.parse(o,e):console.error("THREE.ObjectLoader: Can't load "+t)}),n,r)},parse:function(t,e){var n=this.parseShape(t.shapes),r=this.parseGeometries(t.geometries,n),i=this.parseImages(t.images,(function(){void 0!==e&&e(s)})),o=this.parseTextures(t.textures,i),a=this.parseMaterials(t.materials,o),s=this.parseObject(t.object,r,a);return t.animations&&(s.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0!==e&&e(s),s},parseShape:function(t){var e={};if(void 0!==t)for(var n=0,r=t.length;n<r;n++){var i=(new Vc).fromJSON(t[n]);e[i.uuid]=i}return e},parseGeometries:function(t,e){var n={};if(void 0!==t)for(var r=new su,i=0,o=t.length;i<o;i++){var a,s=t[i];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":a=new js[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":a=new js[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":a=new js[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":a=new js[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":a=new js[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":a=new js[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":a=new js[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":a=new js[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":a=new js[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":a=new js[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"TubeGeometry":case"TubeBufferGeometry":a=new js[s.type]((new zc[s.path.type]).fromJSON(s.path),s.tubularSegments,s.radius,s.radialSegments,s.closed);break;case"LatheGeometry":case"LatheBufferGeometry":a=new js[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":a=new js[s.type](s.vertices,s.indices,s.radius,s.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var c=[],u=0,l=s.shapes.length;u<l;u++){var h=e[s.shapes[u]];c.push(h)}a=new js[s.type](c,s.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(c=[],u=0,l=s.shapes.length;u<l;u++){h=e[s.shapes[u]];c.push(h)}var f=s.options.extrudePath;void 0!==f&&(s.options.extrudePath=(new zc[f.type]).fromJSON(f)),a=new js[s.type](c,s.options);break;case"BufferGeometry":case"InstancedBufferGeometry":a=r.parse(s);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),!0===a.isBufferGeometry&&void 0!==s.userData&&(a.userData=s.userData),n[s.uuid]=a}return n},parseMaterials:function(t,e){var n={},r={};if(void 0!==t){var i=new ru;i.setTextures(e);for(var o=0,a=t.length;o<a;o++){var s=t[o];if("MultiMaterial"===s.type){for(var c=[],u=0;u<s.materials.length;u++){var l=s.materials[u];void 0===n[l.uuid]&&(n[l.uuid]=i.parse(l)),c.push(n[l.uuid])}r[s.uuid]=c}else void 0===n[s.uuid]&&(n[s.uuid]=i.parse(s)),r[s.uuid]=n[s.uuid]}}return r},parseAnimations:function(t){for(var e=[],n=0;n<t.length;n++){var r=t[n],i=cc.parse(r);void 0!==r.uuid&&(i.uuid=r.uuid),e.push(i)}return e},parseImages:function(t,e){var n=this,r={};function i(t){return n.manager.itemStart(t),o.load(t,(function(){n.manager.itemEnd(t)}),void 0,(function(){n.manager.itemError(t),n.manager.itemEnd(t)}))}if(void 0!==t&&t.length>0){var o=new bc(new hc(e));o.setCrossOrigin(this.crossOrigin);for(var a=0,s=t.length;a<s;a++){var c=t[a],u=c.url;if(Array.isArray(u)){r[c.uuid]=[];for(var l=0,h=u.length;l<h;l++){var f=u[l],p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(f)?f:n.resourcePath+f;r[c.uuid].push(i(p))}}else{p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c.url)?c.url:n.resourcePath+c.url;r[c.uuid]=i(p)}}}return r},parseTextures:function(t,e){function n(t,e){return"number"==typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}var r={};if(void 0!==t)for(var i=0,o=t.length;i<o;i++){var a,s=t[i];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===e[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image),(a=Array.isArray(e[s.image])?new jr(e[s.image]):new kt(e[s.image])).needsUpdate=!0,a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),void 0!==s.mapping&&(a.mapping=n(s.mapping,hu)),void 0!==s.offset&&a.offset.fromArray(s.offset),void 0!==s.repeat&&a.repeat.fromArray(s.repeat),void 0!==s.center&&a.center.fromArray(s.center),void 0!==s.rotation&&(a.rotation=s.rotation),void 0!==s.wrap&&(a.wrapS=n(s.wrap[0],fu),a.wrapT=n(s.wrap[1],fu)),void 0!==s.format&&(a.format=s.format),void 0!==s.type&&(a.type=s.type),void 0!==s.encoding&&(a.encoding=s.encoding),void 0!==s.minFilter&&(a.minFilter=n(s.minFilter,pu)),void 0!==s.magFilter&&(a.magFilter=n(s.magFilter,pu)),void 0!==s.anisotropy&&(a.anisotropy=s.anisotropy),void 0!==s.flipY&&(a.flipY=s.flipY),void 0!==s.premultiplyAlpha&&(a.premultiplyAlpha=s.premultiplyAlpha),void 0!==s.unpackAlignment&&(a.unpackAlignment=s.unpackAlignment),r[s.uuid]=a}return r},parseObject:function(t,e,n){var r;function i(t){return void 0===e[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),e[t]}function o(t){if(void 0!==t){if(Array.isArray(t)){for(var e=[],r=0,i=t.length;r<i;r++){var o=t[r];void 0===n[o]&&console.warn("THREE.ObjectLoader: Undefined material",o),e.push(n[o])}return e}return void 0===n[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),n[t]}}switch(t.type){case"Scene":r=new de,void 0!==t.background&&Number.isInteger(t.background)&&(r.background=new on(t.background)),void 0!==t.fog&&("Fog"===t.fog.type?r.fog=new To(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(r.fog=new So(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":r=new fr(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(r.focus=t.focus),void 0!==t.zoom&&(r.zoom=t.zoom),void 0!==t.filmGauge&&(r.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(r.filmOffset=t.filmOffset),void 0!==t.view&&(r.view=Object.assign({},t.view));break;case"OrthographicCamera":r=new Zc(t.left,t.right,t.top,t.bottom,t.near,t.far),void 0!==t.zoom&&(r.zoom=t.zoom),void 0!==t.view&&(r.view=Object.assign({},t.view));break;case"AmbientLight":r=new eu(t.color,t.intensity);break;case"DirectionalLight":r=new tu(t.color,t.intensity);break;case"PointLight":r=new Qc(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":r=new nu(t.color,t.intensity,t.width,t.height);break;case"SpotLight":r=new Xc(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":r=new qc(t.color,t.groundColor,t.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":r=new Qn(a=i(t.geometry),s=o(t.material));break;case"InstancedMesh":var a=i(t.geometry),s=o(t.material),c=t.count,u=t.instanceMatrix;(r=new na(a,s,c)).instanceMatrix=new dn(new Float32Array(u.array),16);break;case"LOD":r=new qo;break;case"Line":r=new ua(i(t.geometry),o(t.material),t.mode);break;case"LineLoop":r=new pa(i(t.geometry),o(t.material));break;case"LineSegments":r=new fa(i(t.geometry),o(t.material));break;case"PointCloud":case"Points":r=new ba(i(t.geometry),o(t.material));break;case"Sprite":r=new Go(o(t.material));break;case"Group":r=new wo;break;default:r=new pe}if(r.uuid=t.uuid,void 0!==t.name&&(r.name=t.name),void 0!==t.matrix?(r.matrix.fromArray(t.matrix),void 0!==t.matrixAutoUpdate&&(r.matrixAutoUpdate=t.matrixAutoUpdate),r.matrixAutoUpdate&&r.matrix.decompose(r.position,r.quaternion,r.scale)):(void 0!==t.position&&r.position.fromArray(t.position),void 0!==t.rotation&&r.rotation.fromArray(t.rotation),void 0!==t.quaternion&&r.quaternion.fromArray(t.quaternion),void 0!==t.scale&&r.scale.fromArray(t.scale)),void 0!==t.castShadow&&(r.castShadow=t.castShadow),void 0!==t.receiveShadow&&(r.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(r.shadow.bias=t.shadow.bias),void 0!==t.shadow.radius&&(r.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&r.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(r.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.frustumCulled&&(r.frustumCulled=t.frustumCulled),void 0!==t.renderOrder&&(r.renderOrder=t.renderOrder),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.layers&&(r.layers.mask=t.layers),void 0!==t.children)for(var l=t.children,h=0;h<l.length;h++)r.add(this.parseObject(l[h],e,n));if("LOD"===t.type){void 0!==t.autoUpdate&&(r.autoUpdate=t.autoUpdate);for(var f=t.levels,p=0;p<f.length;p++){var d=f[p],y=r.getObjectByProperty("uuid",d.object);void 0!==y&&r.addLevel(y,d.distance)}}return r}});var lu,hu={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,SphericalReflectionMapping:305,CubeUVReflectionMapping:306,CubeUVRefractionMapping:307},fu={RepeatWrapping:I,ClampToEdgeWrapping:k,MirroredRepeatWrapping:L},pu={NearestFilter:N,NearestMipmapNearestFilter:j,NearestMipmapLinearFilter:F,LinearFilter:z,LinearMipmapNearestFilter:G,LinearMipmapLinearFilter:V};function du(t){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),pc.call(this,t),this.options=void 0}function yu(){this.type="ShapePath",this.color=new on,this.subPaths=[],this.currentPath=null}function mu(t){this.type="Font",this.data=t}function vu(t,e,n,r,i){var o=i.glyphs[t]||i.glyphs["?"];if(o){var a,s,c,u,l,h,f,p,d=new yu;if(o.o)for(var y=o._cachedOutline||(o._cachedOutline=o.o.split(" ")),m=0,v=y.length;m<v;){switch(y[m++]){case"m":a=y[m++]*e+n,s=y[m++]*e+r,d.moveTo(a,s);break;case"l":a=y[m++]*e+n,s=y[m++]*e+r,d.lineTo(a,s);break;case"q":c=y[m++]*e+n,u=y[m++]*e+r,l=y[m++]*e+n,h=y[m++]*e+r,d.quadraticCurveTo(l,h,c,u);break;case"b":c=y[m++]*e+n,u=y[m++]*e+r,l=y[m++]*e+n,h=y[m++]*e+r,f=y[m++]*e+n,p=y[m++]*e+r,d.bezierCurveTo(l,h,f,p,c,u)}}return{offsetX:o.ha*e,path:d}}console.error('THREE.Font: character "'+t+'" does not exists in font family '+i.familyName+".")}function gu(t){pc.call(this,t)}du.prototype=Object.assign(Object.create(pc.prototype),{constructor:du,setOptions:function(t){return this.options=t,this},load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,o=lc.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout((function(){e&&e(o),i.manager.itemEnd(t)}),0),o;fetch(t).then((function(t){return t.blob()})).then((function(t){return void 0===i.options?createImageBitmap(t):createImageBitmap(t,i.options)})).then((function(n){lc.add(t,n),e&&e(n),i.manager.itemEnd(t)})).catch((function(e){r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)})),i.manager.itemStart(t)}}),Object.assign(yu.prototype,{moveTo:function(t,e){return this.currentPath=new Hc,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e),this},lineTo:function(t,e){return this.currentPath.lineTo(t,e),this},quadraticCurveTo:function(t,e,n,r){return this.currentPath.quadraticCurveTo(t,e,n,r),this},bezierCurveTo:function(t,e,n,r,i,o){return this.currentPath.bezierCurveTo(t,e,n,r,i,o),this},splineThru:function(t){return this.currentPath.splineThru(t),this},toShapes:function(t,e){function n(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n],o=new Vc;o.curves=i.curves,e.push(o)}return e}function r(t,e){for(var n=e.length,r=!1,i=n-1,o=0;o<n;i=o++){var a=e[i],s=e[o],c=s.x-a.x,u=s.y-a.y;if(Math.abs(u)>Number.EPSILON){if(u<0&&(a=e[o],c=-c,s=e[i],u=-u),t.y<a.y||t.y>s.y)continue;if(t.y===a.y){if(t.x===a.x)return!0}else{var l=u*(t.x-a.x)-c*(t.y-a.y);if(0===l)return!0;if(l<0)continue;r=!r}}else{if(t.y!==a.y)continue;if(s.x<=t.x&&t.x<=a.x||a.x<=t.x&&t.x<=s.x)return!0}}return r}var i=fs.isClockWise,o=this.subPaths;if(0===o.length)return[];if(!0===e)return n(o);var a,s,c,u=[];if(1===o.length)return s=o[0],(c=new Vc).curves=s.curves,u.push(c),u;var l=!i(o[0].getPoints());l=t?!l:l;var h,f,p=[],d=[],y=[],m=0;d[m]=void 0,y[m]=[];for(var v=0,g=o.length;v<g;v++)a=i(h=(s=o[v]).getPoints()),(a=t?!a:a)?(!l&&d[m]&&m++,d[m]={s:new Vc,p:h},d[m].s.curves=s.curves,l&&m++,y[m]=[]):y[m].push({h:s,p:h[0]});if(!d[0])return n(o);if(d.length>1){for(var b=!1,w=[],_=0,x=d.length;_<x;_++)p[_]=[];for(_=0,x=d.length;_<x;_++)for(var S=y[_],T=0;T<S.length;T++){for(var M=S[T],E=!0,P=0;P<d.length;P++)r(M.p,d[P].p)&&(_!==P&&w.push({froms:_,tos:P,hole:T}),E?(E=!1,p[P].push(M)):b=!0);E&&p[_].push(M)}w.length>0&&(b||(y=p))}v=0;for(var O=d.length;v<O;v++){c=d[v].s,u.push(c);for(var A=0,D=(f=y[v]).length;A<D;A++)c.holes.push(f[A].h)}return u}}),Object.assign(mu.prototype,{isFont:!0,generateShapes:function(t,e){void 0===e&&(e=100);for(var n=[],r=function(t,e,n){for(var r=Array.from?Array.from(t):String(t).split(""),i=e/n.resolution,o=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*i,a=[],s=0,c=0,u=0;u<r.length;u++){var l=r[u];if("\n"===l)s=0,c-=o;else{var h=vu(l,i,s,c,n);s+=h.offsetX,a.push(h.path)}}return a}(t,e,this.data),i=0,o=r.length;i<o;i++)Array.prototype.push.apply(n,r[i].toShapes());return n}}),gu.prototype=Object.assign(Object.create(pc.prototype),{constructor:gu,load:function(t,e,n,r){var i=this,o=new yc(this.manager);o.setPath(this.path),o.load(t,(function(t){var n;try{n=JSON.parse(t)}catch(e){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(t.substring(65,t.length-2))}var r=i.parse(n);e&&e(r)}),n,r)},parse:function(t){return new mu(t)}});var bu=function(){return void 0===lu&&(lu=new(window.AudioContext||window.webkitAudioContext)),lu};function wu(t){pc.call(this,t)}function _u(){this.coefficients=[];for(var t=0;t<9;t++)this.coefficients.push(new zt)}function xu(t,e){Wc.call(this,void 0,e),this.sh=void 0!==t?t:new _u}function Su(t,e,n){xu.call(this,void 0,n);var r=(new on).set(t),i=(new on).set(e),o=new zt(r.r,r.g,r.b),a=new zt(i.r,i.g,i.b),s=Math.sqrt(Math.PI),c=s*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(a).multiplyScalar(s),this.sh.coefficients[1].copy(o).sub(a).multiplyScalar(c)}function Tu(t,e){xu.call(this,void 0,e);var n=(new on).set(t);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}wu.prototype=Object.assign(Object.create(pc.prototype),{constructor:wu,load:function(t,e,n,r){var i=new yc(this.manager);i.setResponseType("arraybuffer"),i.setPath(this.path),i.load(t,(function(t){var n=t.slice(0);bu().decodeAudioData(n,(function(t){e(t)}))}),n,r)}}),Object.assign(_u.prototype,{isSphericalHarmonics3:!0,set:function(t){for(var e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this},zero:function(){for(var t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this},getAt:function(t,e){var n=t.x,r=t.y,i=t.z,o=this.coefficients;return e.copy(o[0]).multiplyScalar(.282095),e.addScaledVector(o[1],.488603*r),e.addScaledVector(o[2],.488603*i),e.addScaledVector(o[3],.488603*n),e.addScaledVector(o[4],n*r*1.092548),e.addScaledVector(o[5],r*i*1.092548),e.addScaledVector(o[6],.315392*(3*i*i-1)),e.addScaledVector(o[7],n*i*1.092548),e.addScaledVector(o[8],.546274*(n*n-r*r)),e},getIrradianceAt:function(t,e){var n=t.x,r=t.y,i=t.z,o=this.coefficients;return e.copy(o[0]).multiplyScalar(.886227),e.addScaledVector(o[1],1.023328*r),e.addScaledVector(o[2],1.023328*i),e.addScaledVector(o[3],1.023328*n),e.addScaledVector(o[4],.858086*n*r),e.addScaledVector(o[5],.858086*r*i),e.addScaledVector(o[6],.743125*i*i-.247708),e.addScaledVector(o[7],.858086*n*i),e.addScaledVector(o[8],.429043*(n*n-r*r)),e},add:function(t){for(var e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this},addScaledSH:function(t,e){for(var n=0;n<9;n++)this.coefficients[n].addScaledVector(t.coefficients[n],e);return this},scale:function(t){for(var e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this},lerp:function(t,e){for(var n=0;n<9;n++)this.coefficients[n].lerp(t.coefficients[n],e);return this},equals:function(t){for(var e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0},copy:function(t){return this.set(t.coefficients)},clone:function(){return(new this.constructor).copy(this)},fromArray:function(t,e){void 0===e&&(e=0);for(var n=this.coefficients,r=0;r<9;r++)n[r].fromArray(t,e+3*r);return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);for(var n=this.coefficients,r=0;r<9;r++)n[r].toArray(t,e+3*r);return t}}),Object.assign(_u,{getBasisAt:function(t,e){var n=t.x,r=t.y,i=t.z;e[0]=.282095,e[1]=.488603*r,e[2]=.488603*i,e[3]=.488603*n,e[4]=1.092548*n*r,e[5]=1.092548*r*i,e[6]=.315392*(3*i*i-1),e[7]=1.092548*n*i,e[8]=.546274*(n*n-r*r)}}),xu.prototype=Object.assign(Object.create(Wc.prototype),{constructor:xu,isLightProbe:!0,copy:function(t){return Wc.prototype.copy.call(this,t),this.sh.copy(t.sh),this.intensity=t.intensity,this},toJSON:function(t){return Wc.prototype.toJSON.call(this,t)}}),Su.prototype=Object.assign(Object.create(xu.prototype),{constructor:Su,isHemisphereLightProbe:!0,copy:function(t){return xu.prototype.copy.call(this,t),this},toJSON:function(t){return xu.prototype.toJSON.call(this,t)}}),Tu.prototype=Object.assign(Object.create(xu.prototype),{constructor:Tu,isAmbientLightProbe:!0,copy:function(t){return xu.prototype.copy.call(this,t),this},toJSON:function(t){return xu.prototype.toJSON.call(this,t)}});var Mu=new Xt,Eu=new Xt;function Pu(t){this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}Object.assign(function(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new fr,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new fr,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}.prototype,{update:function(t){var e=this._cache;if(e.focus!==t.focus||e.fov!==t.fov||e.aspect!==t.aspect*this.aspect||e.near!==t.near||e.far!==t.far||e.zoom!==t.zoom||e.eyeSep!==this.eyeSep){e.focus=t.focus,e.fov=t.fov,e.aspect=t.aspect*this.aspect,e.near=t.near,e.far=t.far,e.zoom=t.zoom,e.eyeSep=this.eyeSep;var n,r,i=t.projectionMatrix.clone(),o=e.eyeSep/2,a=o*e.near/e.focus,s=e.near*Math.tan(At.DEG2RAD*e.fov*.5)/e.zoom;Eu.elements[12]=-o,Mu.elements[12]=o,n=-s*e.aspect+a,r=s*e.aspect+a,i.elements[0]=2*e.near/(r-n),i.elements[8]=(r+n)/(r-n),this.cameraL.projectionMatrix.copy(i),n=-s*e.aspect-a,r=s*e.aspect-a,i.elements[0]=2*e.near/(r-n),i.elements[8]=(r+n)/(r-n),this.cameraR.projectionMatrix.copy(i)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(Eu),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(Mu)}}),Object.assign(Pu.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var e=("undefined"==typeof performance?Date:performance).now();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}});var Ou=new zt,Au=new Bt,Du=new zt,Ru=new zt;function Cu(){pe.call(this),this.type="AudioListener",this.context=bu(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Pu}function Iu(t){pe.call(this),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this._startedAt=0,this._pausedAt=0,this.filters=[]}Cu.prototype=Object.assign(Object.create(pe.prototype),{constructor:Cu,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(t){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this},updateMatrixWorld:function(t){pe.prototype.updateMatrixWorld.call(this,t);var e=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Ou,Au,Du),Ru.set(0,0,-1).applyQuaternion(Au),e.positionX){var r=this.context.currentTime+this.timeDelta;e.positionX.linearRampToValueAtTime(Ou.x,r),e.positionY.linearRampToValueAtTime(Ou.y,r),e.positionZ.linearRampToValueAtTime(Ou.z,r),e.forwardX.linearRampToValueAtTime(Ru.x,r),e.forwardY.linearRampToValueAtTime(Ru.y,r),e.forwardZ.linearRampToValueAtTime(Ru.z,r),e.upX.linearRampToValueAtTime(n.x,r),e.upY.linearRampToValueAtTime(n.y,r),e.upZ.linearRampToValueAtTime(n.z,r)}else e.setPosition(Ou.x,Ou.y,Ou.z),e.setOrientation(Ru.x,Ru.y,Ru.z,n.x,n.y,n.z)}}),Iu.prototype=Object.assign(Object.create(pe.prototype),{constructor:Iu,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setMediaElementSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this},setMediaStreamSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this},setBuffer:function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(t){if(void 0===t&&(t=0),!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){this._startedAt=this.context.currentTime+t;var e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._pausedAt+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._pausedAt+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this._pausedAt=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t||(t=[]),!0===this.isPlaying?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},setDetune:function(t){if(this.detune=t,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},setLoopStart:function(t){return this.loopStart=t,this},setLoopEnd:function(t){return this.loopEnd=t,this},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}});var ku=new zt,Lu=new Bt,Nu=new zt,ju=new zt;function Bu(t){Iu.call(this,t),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function Fu(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function Uu(t,e,n){this.binding=t,this.valueSize=n;var r,i=Float64Array;switch(e){case"quaternion":r=this._slerp;break;case"string":case"bool":i=Array,r=this._select;break;default:r=this._lerp}this.buffer=new i(4*n),this._mixBufferRegion=r,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}Bu.prototype=Object.assign(Object.create(Iu.prototype),{constructor:Bu,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){return this.panner.refDistance=t,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){return this.panner.rolloffFactor=t,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){return this.panner.distanceModel=t,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){return this.panner.maxDistance=t,this},setDirectionalCone:function(t,e,n){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=e,this.panner.coneOuterGain=n,this},updateMatrixWorld:function(t){if(pe.prototype.updateMatrixWorld.call(this,t),!0!==this.hasPlaybackControl||!1!==this.isPlaying){this.matrixWorld.decompose(ku,Lu,Nu),ju.set(0,0,1).applyQuaternion(Lu);var e=this.panner;if(e.positionX){var n=this.context.currentTime+this.listener.timeDelta;e.positionX.linearRampToValueAtTime(ku.x,n),e.positionY.linearRampToValueAtTime(ku.y,n),e.positionZ.linearRampToValueAtTime(ku.z,n),e.orientationX.linearRampToValueAtTime(ju.x,n),e.orientationY.linearRampToValueAtTime(ju.y,n),e.orientationZ.linearRampToValueAtTime(ju.z,n)}else e.setPosition(ku.x,ku.y,ku.z),e.setOrientation(ju.x,ju.y,ju.z)}}}),Object.assign(Fu.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var t=0,e=this.getFrequencyData(),n=0;n<e.length;n++)t+=e[n];return t/e.length}}),Object.assign(Uu.prototype,{accumulate:function(t,e){var n=this.buffer,r=this.valueSize,i=t*r+r,o=this.cumulativeWeight;if(0===o){for(var a=0;a!==r;++a)n[i+a]=n[a];o=e}else{var s=e/(o+=e);this._mixBufferRegion(n,i,0,s,r)}this.cumulativeWeight=o},apply:function(t){var e=this.valueSize,n=this.buffer,r=t*e+e,i=this.cumulativeWeight,o=this.binding;if(this.cumulativeWeight=0,i<1){var a=3*e;this._mixBufferRegion(n,r,a,1-i,e)}for(var s=e,c=e+e;s!==c;++s)if(n[s]!==n[s+e]){o.setValue(n,r);break}},saveOriginalState:function(){var t=this.binding,e=this.buffer,n=this.valueSize,r=3*n;t.getValue(e,r);for(var i=n,o=r;i!==o;++i)e[i]=e[r+i%n];this.cumulativeWeight=0},restoreOriginalState:function(){var t=3*this.valueSize;this.binding.setValue(this.buffer,t)},_select:function(t,e,n,r,i){if(r>=.5)for(var o=0;o!==i;++o)t[e+o]=t[n+o]},_slerp:function(t,e,n,r){Bt.slerpFlat(t,e,t,e,t,n,r)},_lerp:function(t,e,n,r,i){for(var o=1-r,a=0;a!==i;++a){var s=e+a;t[s]=t[s]*o+t[n+a]*r}}});var zu=new RegExp("[\\[\\]\\.:\\/]","g"),Gu="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",Hu=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),Vu=/(WCOD+)?/.source.replace("WCOD",Gu),Wu=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),qu=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),Yu=new RegExp("^"+Hu+Vu+Wu+qu+"$"),Ju=["material","materials","bones"];function Xu(t,e,n){var r=n||Ku.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,r)}function Ku(t,e,n){this.path=e,this.parsedPath=n||Ku.parseTrackName(e),this.node=Ku.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function Qu(t,e,n){this._mixer=t,this._clip=e,this._localRoot=n||null;for(var r=e.tracks,i=r.length,o=new Array(i),a={endingStart:2400,endingEnd:2400},s=0;s!==i;++s){var c=r[s].createInterpolant(null);o[s]=c,c.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(i),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function Zu(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function $u(t){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}function tl(t,e,n){Mo.call(this,t,e),this.meshPerAttribute=n||1}function el(t,e,n,r){this.ray=new Fe(t,e),this.near=n||0,this.far=r||1/0,this.camera=null,this.layers=new $t,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function nl(t,e){return t.distance-e.distance}function rl(t,e,n,r){if(t.layers.test(e.layers)&&t.raycast(e,n),!0===r)for(var i=t.children,o=0,a=i.length;o<a;o++)rl(i[o],e,n,!0)}Object.assign(Xu.prototype,{getValue:function(t,e){this.bind();var n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(t,e)},setValue:function(t,e){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}}),Object.assign(Ku,{Composite:Xu,create:function(t,e,n){return t&&t.isAnimationObjectGroup?new Ku.Composite(t,e,n):new Ku(t,e,n)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(zu,"")},parseTrackName:function(t){var e=Yu.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);var n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var i=n.nodeName.substring(r+1);-1!==Ju.indexOf(i)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=i)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n},findNode:function(t,e){if(!e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){var n=t.skeleton.getBoneByName(e);if(void 0!==n)return n}if(t.children){var r=function t(n){for(var r=0;r<n.length;r++){var i=n[r];if(i.name===e||i.uuid===e)return i;var o=t(i.children);if(o)return o}return null}(t.children);if(r)return r}return null}}),Object.assign(Ku.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)t[e++]=n[r]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.targetObject[this.propertyName]=t[e]},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++]},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,n=e.objectName,r=e.propertyName,i=e.propertyIndex;if(t||(t=Ku.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(n){var o=e.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(var a=0;a<t.length;a++)if(t[a].name===o){o=a;break}break;default:if(void 0===t[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[n]}if(void 0!==o){if(void 0===t[o])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[o]}}var s=t[r];if(void 0!==s){var c=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?c=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(c=this.Versioning.MatrixWorldNeedsUpdate);var u=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(a=0;a<this.node.geometry.morphAttributes.position.length;a++)if(t.geometry.morphAttributes.position[a].name===i){i=a;break}}else{if(!t.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(a=0;a<this.node.geometry.morphTargets.length;a++)if(t.geometry.morphTargets[a].name===i){i=a;break}}}u=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(u=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(u=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=r;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][c]}else{var l=e.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+l+"."+r+" but it wasn't found.",t)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(Ku.prototype,{_getValue_unbound:Ku.prototype.getValue,_setValue_unbound:Ku.prototype.setValue}),Object.assign(function(){this.uuid=At.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var e=0,n=arguments.length;e!==n;++e)t[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}}.prototype,{isAnimationObjectGroup:!0,add:function(){for(var t=this._objects,e=t.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._paths,o=this._parsedPaths,a=this._bindings,s=a.length,c=void 0,u=0,l=arguments.length;u!==l;++u){var h=arguments[u],f=h.uuid,p=r[f];if(void 0===p){p=e++,r[f]=p,t.push(h);for(var d=0,y=s;d!==y;++d)a[d].push(new Ku(h,i[d],o[d]))}else if(p<n){c=t[p];var m=--n,v=t[m];r[v.uuid]=p,t[p]=v,r[f]=m,t[m]=h;for(d=0,y=s;d!==y;++d){var g=a[d],b=g[m],w=g[p];g[p]=b,void 0===w&&(w=new Ku(h,i[d],o[d])),g[m]=w}}else t[p]!==c&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=n},remove:function(){for(var t=this._objects,e=this.nCachedObjects_,n=this._indicesByUUID,r=this._bindings,i=r.length,o=0,a=arguments.length;o!==a;++o){var s=arguments[o],c=s.uuid,u=n[c];if(void 0!==u&&u>=e){var l=e++,h=t[l];n[h.uuid]=u,t[u]=h,n[c]=l,t[l]=s;for(var f=0,p=i;f!==p;++f){var d=r[f],y=d[l],m=d[u];d[u]=y,d[l]=m}}}this.nCachedObjects_=e},uncache:function(){for(var t=this._objects,e=t.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._bindings,o=i.length,a=0,s=arguments.length;a!==s;++a){var c=arguments[a],u=c.uuid,l=r[u];if(void 0!==l)if(delete r[u],l<n){var h=--n,f=t[h],p=t[g=--e];r[f.uuid]=l,t[l]=f,r[p.uuid]=h,t[h]=p,t.pop();for(var d=0,y=o;d!==y;++d){var m=(b=i[d])[h],v=b[g];b[l]=m,b[h]=v,b.pop()}}else{var g;r[(p=t[g=--e]).uuid]=l,t[l]=p,t.pop();for(d=0,y=o;d!==y;++d){var b;(b=i[d])[l]=b[g],b.pop()}}}this.nCachedObjects_=n},subscribe_:function(t,e){var n=this._bindingsIndicesByPath,r=n[t],i=this._bindings;if(void 0!==r)return i[r];var o=this._paths,a=this._parsedPaths,s=this._objects,c=s.length,u=this.nCachedObjects_,l=new Array(c);r=i.length,n[t]=r,o.push(t),a.push(e),i.push(l);for(var h=u,f=s.length;h!==f;++h){var p=s[h];l[h]=new Ku(p,t,e)}return l},unsubscribe_:function(t){var e=this._bindingsIndicesByPath,n=e[t];if(void 0!==n){var r=this._paths,i=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a];e[t[a]]=n,o[n]=s,o.pop(),i[n]=i[a],i.pop(),r[n]=r[a],r.pop()}}}),Object.assign(Qu.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){var r=this._clip.duration,i=t._clip.duration,o=i/r,a=r/i;t.warp(1,o,e),this.warp(a,1,e)}return this},crossFadeTo:function(t,e,n){return t.crossFadeFrom(this,e,n)},stopFading:function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,e,n){var r=this._mixer,i=r.time,o=this._timeScaleInterpolant,a=this.timeScale;null===o&&(o=r._lendControlInterpolant(),this._timeScaleInterpolant=o);var s=o.parameterPositions,c=o.sampleValues;return s[0]=i,s[1]=i+n,c[0]=t/a,c[1]=e/a,this},stopWarping:function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,n,r){if(this.enabled){var i=this._startTime;if(null!==i){var o=(t-i)*n;if(o<0||0===n)return;this._startTime=null,e=n*o}e*=this._updateTimeScale(t);var a=this._updateTime(e),s=this._updateWeight(t);if(s>0)for(var c=this._interpolants,u=this._propertyBindings,l=0,h=c.length;l!==h;++l)c[l].evaluate(a),u[l].accumulate(r,s)}else this._updateWeight(t)},_updateWeight:function(t){var e=0;if(this.enabled){e=this.weight;var n=this._weightInterpolant;if(null!==n){var r=n.evaluate(t)[0];e*=r,t>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=e,e},_updateTimeScale:function(t){var e=0;if(!this.paused){e=this.timeScale;var n=this._timeScaleInterpolant;if(null!==n)e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}return this._effectiveTimeScale=e,e},_updateTime:function(t){var e=this.time+t,n=this._clip.duration,r=this.loop,i=this._loopCount,o=2202===r;if(0===t)return-1===i?e:o&&1==(1&i)?n-e:e;if(2200===r){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(e>=n)e=n;else{if(!(e<0)){this.time=e;break t}e=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=e,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(-1===i&&(t>=0?(i=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),e>=n||e<0){var a=Math.floor(e/n);e-=n*a,i+=Math.abs(a);var s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,e=t>0?n:0,this.time=e,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===s){var c=t<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=i,this.time=e,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=e;if(o&&1==(1&i))return n-e}return e},_setEndings:function(t,e,n){var r=this._interpolantSettings;n?(r.endingStart=2401,r.endingEnd=2401):(r.endingStart=t?this.zeroSlopeAtStart?2401:2400:2402,r.endingEnd=e?this.zeroSlopeAtEnd?2401:2400:2402)},_scheduleFading:function(t,e,n){var r=this._mixer,i=r.time,o=this._weightInterpolant;null===o&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);var a=o.parameterPositions,s=o.sampleValues;return a[0]=i,s[0]=e,a[1]=i+t,s[1]=n,this}}),Zu.prototype=Object.assign(Object.create(Mt.prototype),{constructor:Zu,_bindAction:function(t,e){var n=t._localRoot||this._root,r=t._clip.tracks,i=r.length,o=t._propertyBindings,a=t._interpolants,s=n.uuid,c=this._bindingsByRootAndName,u=c[s];void 0===u&&(u={},c[s]=u);for(var l=0;l!==i;++l){var h=r[l],f=h.name,p=u[f];if(void 0!==p)o[l]=p;else{if(void 0!==(p=o[l])){null===p._cacheIndex&&(++p.referenceCount,this._addInactiveBinding(p,s,f));continue}var d=e&&e._propertyBindings[l].binding.parsedPath;++(p=new Uu(Ku.create(n,f,d),h.ValueTypeName,h.getValueSize())).referenceCount,this._addInactiveBinding(p,s,f),o[l]=p}a[l].resultBuffer=p.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var e=(t._localRoot||this._root).uuid,n=t._clip.uuid,r=this._actionsByClip[n];this._bindAction(t,r&&r.knownActions[0]),this._addInactiveAction(t,n,e)}for(var i=t._propertyBindings,o=0,a=i.length;o!==a;++o){var s=i[o];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,n=0,r=e.length;n!==r;++n){var i=e[n];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){var e=t._cacheIndex;return null!==e&&e<this._nActiveActions},_addInactiveAction:function(t,e,n){var r=this._actions,i=this._actionsByClip,o=i[e];if(void 0===o)o={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,i[e]=o;else{var a=o.knownActions;t._byClipCacheIndex=a.length,a.push(t)}t._cacheIndex=r.length,r.push(t),o.actionByRoot[n]=t},_removeInactiveAction:function(t){var e=this._actions,n=e[e.length-1],r=t._cacheIndex;n._cacheIndex=r,e[r]=n,e.pop(),t._cacheIndex=null;var i=t._clip.uuid,o=this._actionsByClip,a=o[i],s=a.knownActions,c=s[s.length-1],u=t._byClipCacheIndex;c._byClipCacheIndex=u,s[u]=c,s.pop(),t._byClipCacheIndex=null,delete a.actionByRoot[(t._localRoot||this._root).uuid],0===s.length&&delete o[i],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var e=t._propertyBindings,n=0,r=e.length;n!==r;++n){var i=e[n];0==--i.referenceCount&&this._removeInactiveBinding(i)}},_lendAction:function(t){var e=this._actions,n=t._cacheIndex,r=this._nActiveActions++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_takeBackAction:function(t){var e=this._actions,n=t._cacheIndex,r=--this._nActiveActions,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_addInactiveBinding:function(t,e,n){var r=this._bindingsByRootAndName,i=r[e],o=this._bindings;void 0===i&&(i={},r[e]=i),i[n]=t,t._cacheIndex=o.length,o.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,n=t.binding,r=n.rootNode.uuid,i=n.path,o=this._bindingsByRootAndName,a=o[r],s=e[e.length-1],c=t._cacheIndex;s._cacheIndex=c,e[c]=s,e.pop(),delete a[i],0===Object.keys(a).length&&delete o[r]},_lendBinding:function(t){var e=this._bindings,n=t._cacheIndex,r=this._nActiveBindings++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_takeBackBinding:function(t){var e=this._bindings,n=t._cacheIndex,r=--this._nActiveBindings,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,n=t[e];return void 0===n&&((n=new Zs(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=e,t[e]=n),n},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,n=t.__cacheIndex,r=--this._nActiveControlInterpolants,i=e[r];t.__cacheIndex=r,e[r]=t,i.__cacheIndex=n,e[n]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,e){var n=e||this._root,r=n.uuid,i="string"==typeof t?cc.findByName(n,t):t,o=null!==i?i.uuid:t,a=this._actionsByClip[o],s=null;if(void 0!==a){var c=a.actionByRoot[r];if(void 0!==c)return c;s=a.knownActions[0],null===i&&(i=s._clip)}if(null===i)return null;var u=new Qu(this,i,e);return this._bindAction(u,s),this._addInactiveAction(u,o,r),u},existingAction:function(t,e){var n=e||this._root,r=n.uuid,i="string"==typeof t?cc.findByName(n,t):t,o=i?i.uuid:t,a=this._actionsByClip[o];return void 0!==a&&a.actionByRoot[r]||null},stopAllAction:function(){var t=this._actions,e=this._nActiveActions,n=this._bindings,r=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var i=0;i!==e;++i)t[i].reset();for(i=0;i!==r;++i)n[i].useCount=0;return this},update:function(t){t*=this.timeScale;for(var e=this._actions,n=this._nActiveActions,r=this.time+=t,i=Math.sign(t),o=this._accuIndex^=1,a=0;a!==n;++a){e[a]._update(r,t,i,o)}var s=this._bindings,c=this._nActiveBindings;for(a=0;a!==c;++a)s[a].apply(o);return this},setTime:function(t){this.time=0;for(var e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(t)},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions,n=t.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){for(var o=i.knownActions,a=0,s=o.length;a!==s;++a){var c=o[a];this._deactivateAction(c);var u=c._cacheIndex,l=e[e.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,l._cacheIndex=u,e[u]=l,e.pop(),this._removeInactiveBindingsForAction(c)}delete r[n]}},uncacheRoot:function(t){var e=t.uuid,n=this._actionsByClip;for(var r in n){var i=n[r].actionByRoot[e];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var o=this._bindingsByRootAndName[e];if(void 0!==o)for(var a in o){var s=o[a];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(t,e){var n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}),$u.prototype.clone=function(){return new $u(void 0===this.value.clone?this.value:this.value.clone())},tl.prototype=Object.assign(Object.create(Mo.prototype),{constructor:tl,isInstancedInterleavedBuffer:!0,copy:function(t){return Mo.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),Object.assign(el.prototype,{set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,e,n){var r=n||[];return rl(t,this,r,e),r.sort(nl),r},intersectObjects:function(t,e,n){var r=n||[];if(!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),r;for(var i=0,o=t.length;i<o;i++)rl(t[i],this,r,e);return r.sort(nl),r}}),Object.assign(function(t,e,n){return this.radius=void 0!==t?t:1,this.phi=void 0!==e?e:0,this.theta=void 0!==n?n:0,this}.prototype,{set:function(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,e,n){return this.radius=Math.sqrt(t*t+e*e+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,n),this.phi=Math.acos(At.clamp(e/this.radius,-1,1))),this}}),Object.assign(function(t,e,n){return this.radius=void 0!==t?t:1,this.theta=void 0!==e?e:0,this.y=void 0!==n?n:0,this}.prototype,{set:function(t,e,n){return this.radius=t,this.theta=e,this.y=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,e,n){return this.radius=Math.sqrt(t*t+n*n),this.theta=Math.atan2(t,n),this.y=e,this}});var il=new Dt;function ol(t,e){this.min=void 0!==t?t:new Dt(1/0,1/0),this.max=void 0!==e?e:new Dt(-1/0,-1/0)}Object.assign(ol.prototype,{set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(t,e){var n=il.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box2: .getCenter() target is now required"),t=new Dt),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box2: .getSize() target is now required"),t=new Dt),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){return void 0===e&&(console.warn("THREE.Box2: .getParameter() target is now required"),e=new Dt),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){return void 0===e&&(console.warn("THREE.Box2: .clampPoint() target is now required"),e=new Dt),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return il.copy(t).clamp(this.min,this.max).sub(t).length()},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});var al=new zt,sl=new zt;function cl(t,e){this.start=void 0!==t?t:new zt,this.end=void 0!==e?e:new zt}function ul(t){pe.call(this),this.material=t,this.render=function(){}}Object.assign(cl.prototype,{set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){return void 0===t&&(console.warn("THREE.Line3: .getCenter() target is now required"),t=new zt),t.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return void 0===t&&(console.warn("THREE.Line3: .delta() target is now required"),t=new zt),t.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){return void 0===e&&(console.warn("THREE.Line3: .at() target is now required"),e=new zt),this.delta(e).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(t,e){al.subVectors(t,this.start),sl.subVectors(this.end,this.start);var n=sl.dot(sl),r=sl.dot(al)/n;return e&&(r=At.clamp(r,0,1)),r},closestPointToPoint:function(t,e,n){var r=this.closestPointToPointParameter(t,e);return void 0===n&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new zt),this.delta(n).multiplyScalar(r).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}}),ul.prototype=Object.create(pe.prototype),ul.prototype.constructor=ul,ul.prototype.isImmediateRenderObject=!0;var ll=new zt;function hl(t,e){pe.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e;for(var n=new In,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],i=0,o=1;i<32;i++,o++){var a=i/32*Math.PI*2,s=o/32*Math.PI*2;r.push(Math.cos(a),Math.sin(a),1,Math.cos(s),Math.sin(s),1)}n.setAttribute("position",new xn(r,3));var c=new ra({fog:!1,toneMapped:!1});this.cone=new fa(n,c),this.add(this.cone),this.update()}hl.prototype=Object.create(pe.prototype),hl.prototype.constructor=hl,hl.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},hl.prototype.update=function(){this.light.updateMatrixWorld();var t=this.light.distance?this.light.distance:1e3,e=t*Math.tan(this.light.angle);this.cone.scale.set(e,e,t),ll.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(ll),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};var fl=new zt,pl=new Xt,dl=new Xt;function yl(t){for(var e=function t(e){var n=[];e&&e.isBone&&n.push(e);for(var r=0;r<e.children.length;r++)n.push.apply(n,t(e.children[r]));return n}(t),n=new In,r=[],i=[],o=new on(0,0,1),a=new on(0,1,0),s=0;s<e.length;s++){var c=e[s];c.parent&&c.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(o.r,o.g,o.b),i.push(a.r,a.g,a.b))}n.setAttribute("position",new xn(r,3)),n.setAttribute("color",new xn(i,3));var u=new ra({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});fa.call(this,n,u),this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}function ml(t,e,n){this.light=t,this.light.updateMatrixWorld(),this.color=n;var r=new xs(e,4,2),i=new fn({wireframe:!0,fog:!1,toneMapped:!1});Qn.call(this,r,i),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}yl.prototype=Object.create(fa.prototype),yl.prototype.constructor=yl,yl.prototype.isSkeletonHelper=!0,yl.prototype.updateMatrixWorld=function(t){var e=this.bones,n=this.geometry,r=n.getAttribute("position");dl.getInverse(this.root.matrixWorld);for(var i=0,o=0;i<e.length;i++){var a=e[i];a.parent&&a.parent.isBone&&(pl.multiplyMatrices(dl,a.matrixWorld),fl.setFromMatrixPosition(pl),r.setXYZ(o,fl.x,fl.y,fl.z),pl.multiplyMatrices(dl,a.parent.matrixWorld),fl.setFromMatrixPosition(pl),r.setXYZ(o+1,fl.x,fl.y,fl.z),o+=2)}n.getAttribute("position").needsUpdate=!0,pe.prototype.updateMatrixWorld.call(this,t)},ml.prototype=Object.create(Qn.prototype),ml.prototype.constructor=ml,ml.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},ml.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)};var vl=new zt,gl=new on,bl=new on;function wl(t,e,n){pe.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;var r=new Ia(e);r.rotateY(.5*Math.PI),this.material=new fn({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);var i=r.getAttribute("position"),o=new Float32Array(3*i.count);r.setAttribute("color",new dn(o,3)),this.add(new Qn(r,this.material)),this.update()}function _l(t,e,n,r){t=t||10,e=e||10,n=new on(void 0!==n?n:4473924),r=new on(void 0!==r?r:8947848);for(var i=e/2,o=t/e,a=t/2,s=[],c=[],u=0,l=0,h=-a;u<=e;u++,h+=o){s.push(-a,0,h,a,0,h),s.push(h,0,-a,h,0,a);var f=u===i?n:r;f.toArray(c,l),l+=3,f.toArray(c,l),l+=3,f.toArray(c,l),l+=3,f.toArray(c,l),l+=3}var p=new In;p.setAttribute("position",new xn(s,3)),p.setAttribute("color",new xn(c,3));var d=new ra({vertexColors:!0,toneMapped:!1});fa.call(this,p,d)}function xl(t,e,n,r,i,o){t=t||10,e=e||16,n=n||8,r=r||64,i=new on(void 0!==i?i:4473924),o=new on(void 0!==o?o:8947848);var a,s,c,u,l,h,f,p=[],d=[];for(u=0;u<=e;u++)c=u/e*(2*Math.PI),a=Math.sin(c)*t,s=Math.cos(c)*t,p.push(0,0,0),p.push(a,0,s),f=1&u?i:o,d.push(f.r,f.g,f.b),d.push(f.r,f.g,f.b);for(u=0;u<=n;u++)for(f=1&u?i:o,h=t-t/n*u,l=0;l<r;l++)c=l/r*(2*Math.PI),a=Math.sin(c)*h,s=Math.cos(c)*h,p.push(a,0,s),d.push(f.r,f.g,f.b),c=(l+1)/r*(2*Math.PI),a=Math.sin(c)*h,s=Math.cos(c)*h,p.push(a,0,s),d.push(f.r,f.g,f.b);var y=new In;y.setAttribute("position",new xn(p,3)),y.setAttribute("color",new xn(d,3));var m=new ra({vertexColors:!0,toneMapped:!1});fa.call(this,y,m)}wl.prototype=Object.create(pe.prototype),wl.prototype.constructor=wl,wl.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},wl.prototype.update=function(){var t=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var e=t.geometry.getAttribute("color");gl.copy(this.light.color),bl.copy(this.light.groundColor);for(var n=0,r=e.count;n<r;n++){var i=n<r/2?gl:bl;e.setXYZ(n,i.r,i.g,i.b)}e.needsUpdate=!0}t.lookAt(vl.setFromMatrixPosition(this.light.matrixWorld).negate())},_l.prototype=Object.assign(Object.create(fa.prototype),{constructor:_l,copy:function(t){return fa.prototype.copy.call(this,t),this.geometry.copy(t.geometry),this.material.copy(t.material),this},clone:function(){return(new this.constructor).copy(this)}}),xl.prototype=Object.create(fa.prototype),xl.prototype.constructor=xl;var Sl=new zt,Tl=new zt,Ml=new zt;function El(t,e,n){pe.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===e&&(e=1);var r=new In;r.setAttribute("position",new xn([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));var i=new ra({fog:!1,toneMapped:!1});this.lightPlane=new ua(r,i),this.add(this.lightPlane),(r=new In).setAttribute("position",new xn([0,0,0,0,0,1],3)),this.targetLine=new ua(r,i),this.add(this.targetLine),this.update()}El.prototype=Object.create(pe.prototype),El.prototype.constructor=El,El.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},El.prototype.update=function(){Sl.setFromMatrixPosition(this.light.matrixWorld),Tl.setFromMatrixPosition(this.light.target.matrixWorld),Ml.subVectors(Tl,Sl),this.lightPlane.lookAt(Tl),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Tl),this.targetLine.scale.z=Ml.length()};var Pl=new zt,Ol=new hr;function Al(t){var e=new In,n=new ra({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],i=[],o={},a=new on(16755200),s=new on(16711680),c=new on(43775),u=new on(16777215),l=new on(3355443);function h(t,e,n){f(t,n),f(e,n)}function f(t,e){r.push(0,0,0),i.push(e.r,e.g,e.b),void 0===o[t]&&(o[t]=[]),o[t].push(r.length/3-1)}h("n1","n2",a),h("n2","n4",a),h("n4","n3",a),h("n3","n1",a),h("f1","f2",a),h("f2","f4",a),h("f4","f3",a),h("f3","f1",a),h("n1","f1",a),h("n2","f2",a),h("n3","f3",a),h("n4","f4",a),h("p","n1",s),h("p","n2",s),h("p","n3",s),h("p","n4",s),h("u1","u2",c),h("u2","u3",c),h("u3","u1",c),h("c","t",u),h("p","c",l),h("cn1","cn2",l),h("cn3","cn4",l),h("cf1","cf2",l),h("cf3","cf4",l),e.setAttribute("position",new xn(r,3)),e.setAttribute("color",new xn(i,3)),fa.call(this,e,n),this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()}function Dl(t,e,n,r,i,o,a){Pl.set(i,o,a).unproject(r);var s=e[t];if(void 0!==s)for(var c=n.getAttribute("position"),u=0,l=s.length;u<l;u++)c.setXYZ(s[u],Pl.x,Pl.y,Pl.z)}Al.prototype=Object.create(fa.prototype),Al.prototype.constructor=Al,Al.prototype.update=function(){var t=this.geometry,e=this.pointMap;Ol.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Dl("c",e,t,Ol,0,0,-1),Dl("t",e,t,Ol,0,0,1),Dl("n1",e,t,Ol,-1,-1,-1),Dl("n2",e,t,Ol,1,-1,-1),Dl("n3",e,t,Ol,-1,1,-1),Dl("n4",e,t,Ol,1,1,-1),Dl("f1",e,t,Ol,-1,-1,1),Dl("f2",e,t,Ol,1,-1,1),Dl("f3",e,t,Ol,-1,1,1),Dl("f4",e,t,Ol,1,1,1),Dl("u1",e,t,Ol,.7,1.1,-1),Dl("u2",e,t,Ol,-.7,1.1,-1),Dl("u3",e,t,Ol,0,2,-1),Dl("cf1",e,t,Ol,-1,0,1),Dl("cf2",e,t,Ol,1,0,1),Dl("cf3",e,t,Ol,0,-1,1),Dl("cf4",e,t,Ol,0,1,1),Dl("cn1",e,t,Ol,-1,0,-1),Dl("cn2",e,t,Ol,1,0,-1),Dl("cn3",e,t,Ol,0,-1,-1),Dl("cn4",e,t,Ol,0,1,-1),t.getAttribute("position").needsUpdate=!0};var Rl=new Oe;function Cl(t,e){this.object=t,void 0===e&&(e=16776960);var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),i=new In;i.setIndex(new dn(n,1)),i.setAttribute("position",new dn(r,3)),fa.call(this,i,new ra({color:e,toneMapped:!1})),this.matrixAutoUpdate=!1,this.update()}function Il(t,e){this.type="Box3Helper",this.box=t,e=e||16776960;var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new In;r.setIndex(new dn(n,1)),r.setAttribute("position",new xn([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),fa.call(this,r,new ra({color:e,toneMapped:!1})),this.geometry.computeBoundingSphere()}function kl(t,e,n){this.type="PlaneHelper",this.plane=t,this.size=void 0===e?1:e;var r=void 0!==n?n:16776960,i=new In;i.setAttribute("position",new xn([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),i.computeBoundingSphere(),ua.call(this,i,new ra({color:r,toneMapped:!1}));var o=new In;o.setAttribute("position",new xn([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),o.computeBoundingSphere(),this.add(new Qn(o,new fn({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}Cl.prototype=Object.create(fa.prototype),Cl.prototype.constructor=Cl,Cl.prototype.update=function(t){if(void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&Rl.setFromObject(this.object),!Rl.isEmpty()){var e=Rl.min,n=Rl.max,r=this.geometry.attributes.position,i=r.array;i[0]=n.x,i[1]=n.y,i[2]=n.z,i[3]=e.x,i[4]=n.y,i[5]=n.z,i[6]=e.x,i[7]=e.y,i[8]=n.z,i[9]=n.x,i[10]=e.y,i[11]=n.z,i[12]=n.x,i[13]=n.y,i[14]=e.z,i[15]=e.x,i[16]=n.y,i[17]=e.z,i[18]=e.x,i[19]=e.y,i[20]=e.z,i[21]=n.x,i[22]=e.y,i[23]=e.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}},Cl.prototype.setFromObject=function(t){return this.object=t,this.update(),this},Cl.prototype.copy=function(t){return fa.prototype.copy.call(this,t),this.object=t.object,this},Cl.prototype.clone=function(){return(new this.constructor).copy(this)},Il.prototype=Object.create(fa.prototype),Il.prototype.constructor=Il,Il.prototype.updateMatrixWorld=function(t){var e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),pe.prototype.updateMatrixWorld.call(this,t))},kl.prototype=Object.create(ua.prototype),kl.prototype.constructor=kl,kl.prototype.updateMatrixWorld=function(t){var e=-this.plane.constant;Math.abs(e)<1e-8&&(e=1e-8),this.scale.set(.5*this.size,.5*this.size,e),this.children[0].material.side=e<0?p:f,this.lookAt(this.plane.normal),pe.prototype.updateMatrixWorld.call(this,t)};var Ll,Nl,jl=new zt;function Bl(t,e,n,r,i,o){pe.call(this),void 0===t&&(t=new zt(0,0,1)),void 0===e&&(e=new zt(0,0,0)),void 0===n&&(n=1),void 0===r&&(r=16776960),void 0===i&&(i=.2*n),void 0===o&&(o=.2*i),void 0===Ll&&((Ll=new In).setAttribute("position",new xn([0,0,0,0,1,0],3)),(Nl=new Cs(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(e),this.line=new ua(Ll,new ra({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Qn(Nl,new fn({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(n,i,o)}function Fl(t){var e=[0,0,0,t=t||1,0,0,0,0,0,0,t,0,0,0,0,0,0,t],n=new In;n.setAttribute("position",new xn(e,3)),n.setAttribute("color",new xn([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var r=new ra({vertexColors:!0,toneMapped:!1});fa.call(this,n,r)}Bl.prototype=Object.create(pe.prototype),Bl.prototype.constructor=Bl,Bl.prototype.setDirection=function(t){if(t.y>.99999)this.quaternion.set(0,0,0,1);else if(t.y<-.99999)this.quaternion.set(1,0,0,0);else{jl.set(t.z,0,-t.x).normalize();var e=Math.acos(t.y);this.quaternion.setFromAxisAngle(jl,e)}},Bl.prototype.setLength=function(t,e,n){void 0===e&&(e=.2*t),void 0===n&&(n=.2*e),this.line.scale.set(1,Math.max(1e-4,t-e),1),this.line.updateMatrix(),this.cone.scale.set(n,e,n),this.cone.position.y=t,this.cone.updateMatrix()},Bl.prototype.setColor=function(t){this.line.material.color.set(t),this.cone.material.color.set(t)},Bl.prototype.copy=function(t){return pe.prototype.copy.call(this,t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this},Bl.prototype.clone=function(){return(new this.constructor).copy(this)},Fl.prototype=Object.create(fa.prototype),Fl.prototype.constructor=Fl;var Ul,zl,Gl,Hl,Vl=Math.pow(2,8),Wl=[.125,.215,.35,.446,.526,.582],ql=5+Wl.length,Yl=(i(r={},3e3,0),i(r,xt,1),i(r,3002,2),i(r,3004,3),i(r,3005,4),i(r,3006,5),i(r,3007,6),r),Jl=new Zc,Xl=(Ul=20,zl=new Float32Array(Ul),Gl=new zt(0,1,0),(Hl=new Fs({defines:{n:Ul},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:zl},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:Gl},inputEncoding:{value:Yl[3e3]},outputEncoding:{value:Yl[3e3]}},vertexShader:"\nprecision mediump float;\nprecision mediump int;\nattribute vec3 position;\nattribute vec2 uv;\nattribute float faceIndex;\nvarying vec3 vOutputDirection;\nvec3 getDirection(vec2 uv, float face) {\n\tuv = 2.0 * uv - 1.0;\n\tvec3 direction = vec3(uv, 1.0);\n\tif (face == 0.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 1.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 3.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.x *= -1.0;\n\t} else if (face == 4.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.y *= -1.0;\n\t} else if (face == 5.0) {\n\t\tdirection.xz *= -1.0;\n\t}\n\treturn direction;\n}\nvoid main() {\n\tvOutputDirection = getDirection(uv, faceIndex);\n\tgl_Position = vec4( position, 1.0 );\n}\n\t",fragmentShader:"\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform sampler2D envMap;\nuniform int samples;\nuniform float weights[n];\nuniform bool latitudinal;\nuniform float dTheta;\nuniform float mipInt;\nuniform vec3 poleAxis;\n\n".concat("\nuniform int inputEncoding;\nuniform int outputEncoding;\n\n#include <encodings_pars_fragment>\n\nvec4 inputTexelToLinear(vec4 value){\n\tif(inputEncoding == 0){\n\t\treturn value;\n\t}else if(inputEncoding == 1){\n\t\treturn sRGBToLinear(value);\n\t}else if(inputEncoding == 2){\n\t\treturn RGBEToLinear(value);\n\t}else if(inputEncoding == 3){\n\t\treturn RGBMToLinear(value, 7.0);\n\t}else if(inputEncoding == 4){\n\t\treturn RGBMToLinear(value, 16.0);\n\t}else if(inputEncoding == 5){\n\t\treturn RGBDToLinear(value, 256.0);\n\t}else{\n\t\treturn GammaToLinear(value, 2.2);\n\t}\n}\n\nvec4 linearToOutputTexel(vec4 value){\n\tif(outputEncoding == 0){\n\t\treturn value;\n\t}else if(outputEncoding == 1){\n\t\treturn LinearTosRGB(value);\n\t}else if(outputEncoding == 2){\n\t\treturn LinearToRGBE(value);\n\t}else if(outputEncoding == 3){\n\t\treturn LinearToRGBM(value, 7.0);\n\t}else if(outputEncoding == 4){\n\t\treturn LinearToRGBM(value, 16.0);\n\t}else if(outputEncoding == 5){\n\t\treturn LinearToRGBD(value, 256.0);\n\t}else{\n\t\treturn LinearToGamma(value, 2.2);\n\t}\n}\n\nvec4 envMapTexelToLinear(vec4 color) {\n\treturn inputTexelToLinear(color);\n}\n\t","\n\n#define ENVMAP_TYPE_CUBE_UV\n#include <cube_uv_reflection_fragment>\n\nvec3 getSample(float theta, vec3 axis) {\n\tfloat cosTheta = cos(theta);\n\t// Rodrigues' axis-angle rotation\n\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t+ cross(axis, vOutputDirection) * sin(theta)\n\t\t+ axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);\n\treturn bilinearCubeUV(envMap, sampleDirection, mipInt);\n}\n\nvoid main() {\n\tvec3 axis = latitudinal ? poleAxis : cross(poleAxis, vOutputDirection);\n\tif (all(equal(axis, vec3(0.0))))\n\t\taxis = vec3(vOutputDirection.z, 0.0, - vOutputDirection.x);\n\taxis = normalize(axis);\n\tgl_FragColor = vec4(0.0);\n\tgl_FragColor.rgb += weights[0] * getSample(0.0, axis);\n\tfor (int i = 1; i < n; i++) {\n\t\tif (i >= samples)\n\t\t\tbreak;\n\t\tfloat theta = dTheta * float(i);\n\t\tgl_FragColor.rgb += weights[i] * getSample(-1.0 * theta, axis);\n\t\tgl_FragColor.rgb += weights[i] * getSample(theta, axis);\n\t}\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t"),blending:y,depthTest:!1,depthWrite:!1})).type="SphericalGaussianBlur",Hl),Kl=null,Ql=null,Zl=function(){for(var t=[],e=[],n=[],r=8,i=0;i<ql;i++){var o=Math.pow(2,r);e.push(o);var a=1/o;i>4?a=Wl[i-8+4-1]:0==i&&(a=0),n.push(a);for(var s=1/(o-1),c=-s/2,u=1+s/2,l=[c,c,u,c,u,u,c,c,u,u,c,u],h=new Float32Array(108),f=new Float32Array(72),p=new Float32Array(36),d=0;d<6;d++){var y=d%3*2/3-1,m=d>2?0:-1,v=[y,m,0,y+2/3,m,0,y+2/3,m+1,0,y,m,0,y+2/3,m+1,0,y,m+1,0];h.set(v,18*d),f.set(l,12*d);var g=[d,d,d,d,d,d];p.set(g,6*d)}var b=new In;b.setAttribute("position",new dn(h,3)),b.setAttribute("uv",new dn(f,2)),b.setAttribute("faceIndex",new dn(p,1)),t.push(b),r>4&&r--}return{_lodPlanes:t,_sizeLods:e,_sigmas:n}}(),$l=Zl._lodPlanes,th=Zl._sizeLods,eh=Zl._sigmas,nh=null,rh=null,ih=null,oh=(1+Math.sqrt(5))/2,ah=1/oh,sh=[new zt(1,1,1),new zt(-1,1,1),new zt(1,1,-1),new zt(-1,1,-1),new zt(0,oh,ah),new zt(0,oh,-ah),new zt(ah,0,oh),new zt(-ah,0,oh),new zt(oh,ah,0),new zt(-oh,ah,0)];function ch(t){rh=t,fh(Xl)}function uh(t){var e={magFilter:N,minFilter:N,generateMipmaps:!1,type:t?t.type:q,format:t?t.format:ct,encoding:t?t.encoding:3002,depthBuffer:!1,stencilBuffer:!1},n=ph(e);return n.depthBuffer=!t,nh=ph(e),n}function lh(t){nh.dispose(),rh.setRenderTarget(ih),t.scissorTest=!1,t.setSize(t.width,t.height)}function hh(t,e,n,r){var i=new fr(90,1,e,n),o=[1,1,1,1,-1,1],a=[1,1,-1,-1,-1,1],s=rh.outputEncoding,c=rh.toneMapping,u=rh.toneMappingExposure,l=rh.getClearColor(),h=rh.getClearAlpha();rh.toneMapping=1,rh.toneMappingExposure=1,rh.outputEncoding=3e3,t.scale.z*=-1;var f=t.background;if(f&&f.isColor){f.convertSRGBToLinear();var p=Math.max(f.r,f.g,f.b),d=Math.min(Math.max(Math.ceil(Math.log2(p)),-128),127);f=f.multiplyScalar(Math.pow(2,-d));var y=(d+128)/255;rh.setClearColor(f,y),t.background=null}for(var m=0;m<6;m++){var v=m%3;0==v?(i.up.set(0,o[m],0),i.lookAt(a[m],0,0)):1==v?(i.up.set(0,0,o[m]),i.lookAt(0,a[m],0)):(i.up.set(0,o[m],0),i.lookAt(0,0,a[m])),dh(r,v*Vl,m>2?Vl:0,Vl,Vl),rh.setRenderTarget(r),rh.render(t,i)}rh.toneMapping=c,rh.toneMappingExposure=u,rh.outputEncoding=s,rh.setClearColor(l,h),t.scale.z*=-1}function fh(t){var e=new de;e.add(new Qn($l[0],t)),rh.compile(e,Jl)}function ph(t){var e=new Nt(3*Vl,3*Vl,t);return e.texture.mapping=306,e.texture.name="PMREM.cubeUv",e.scissorTest=!0,e}function dh(t,e,n,r,i){t.viewport.set(e,n,r,i),t.scissor.set(e,n,r,i)}function yh(t){var e=rh.autoClear;rh.autoClear=!1;for(var n=1;n<ql;n++){mh(t,n-1,n,Math.sqrt(eh[n]*eh[n]-eh[n-1]*eh[n-1]),sh[(n-1)%sh.length])}rh.autoClear=e}function mh(t,e,n,r,i){vh(t,nh,e,n,r,"latitudinal",i),vh(nh,t,n,n,r,"longitudinal",i)}function vh(t,e,n,r,i,o,a){"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");var s=new de;s.add(new Qn($l[r],Xl));var c=Xl.uniforms,u=th[n]-1,l=isFinite(i)?Math.PI/(2*u):2*Math.PI/39,h=i/l,f=isFinite(i)?1+Math.floor(3*h):20;f>20&&console.warn("sigmaRadians, ".concat(i,", is too large and will clip, as it requested ").concat(f," samples when the maximum is set to ").concat(20));for(var p=[],d=0,y=0;y<20;++y){var m=y/h,v=Math.exp(-m*m/2);p.push(v),0==y?d+=v:y<f&&(d+=2*v)}for(y=0;y<p.length;y++)p[y]=p[y]/d;c.envMap.value=t.texture,c.samples.value=f,c.weights.value=p,c.latitudinal.value="latitudinal"===o,a&&(c.poleAxis.value=a),c.dTheta.value=l,c.mipInt.value=8-n,c.inputEncoding.value=Yl[t.texture.encoding],c.outputEncoding.value=Yl[t.texture.encoding];var g=th[r];dh(e,m=3*Math.max(0,Vl-2*g),(0===r?0:2*Vl)+2*g*(r>4?r-8+4:0),3*g,2*g),rh.setRenderTarget(e),rh.render(s,Jl)}function gh(){var t=new Fs({uniforms:{envMap:{value:null},texelSize:{value:new Dt(1,1)},inputEncoding:{value:Yl[3e3]},outputEncoding:{value:Yl[3e3]}},vertexShader:"\nprecision mediump float;\nprecision mediump int;\nattribute vec3 position;\nattribute vec2 uv;\nattribute float faceIndex;\nvarying vec3 vOutputDirection;\nvec3 getDirection(vec2 uv, float face) {\n\tuv = 2.0 * uv - 1.0;\n\tvec3 direction = vec3(uv, 1.0);\n\tif (face == 0.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 1.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 3.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.x *= -1.0;\n\t} else if (face == 4.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.y *= -1.0;\n\t} else if (face == 5.0) {\n\t\tdirection.xz *= -1.0;\n\t}\n\treturn direction;\n}\nvoid main() {\n\tvOutputDirection = getDirection(uv, faceIndex);\n\tgl_Position = vec4( position, 1.0 );\n}\n\t",fragmentShader:"\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform sampler2D envMap;\nuniform vec2 texelSize;\n\n".concat("\nuniform int inputEncoding;\nuniform int outputEncoding;\n\n#include <encodings_pars_fragment>\n\nvec4 inputTexelToLinear(vec4 value){\n\tif(inputEncoding == 0){\n\t\treturn value;\n\t}else if(inputEncoding == 1){\n\t\treturn sRGBToLinear(value);\n\t}else if(inputEncoding == 2){\n\t\treturn RGBEToLinear(value);\n\t}else if(inputEncoding == 3){\n\t\treturn RGBMToLinear(value, 7.0);\n\t}else if(inputEncoding == 4){\n\t\treturn RGBMToLinear(value, 16.0);\n\t}else if(inputEncoding == 5){\n\t\treturn RGBDToLinear(value, 256.0);\n\t}else{\n\t\treturn GammaToLinear(value, 2.2);\n\t}\n}\n\nvec4 linearToOutputTexel(vec4 value){\n\tif(outputEncoding == 0){\n\t\treturn value;\n\t}else if(outputEncoding == 1){\n\t\treturn LinearTosRGB(value);\n\t}else if(outputEncoding == 2){\n\t\treturn LinearToRGBE(value);\n\t}else if(outputEncoding == 3){\n\t\treturn LinearToRGBM(value, 7.0);\n\t}else if(outputEncoding == 4){\n\t\treturn LinearToRGBM(value, 16.0);\n\t}else if(outputEncoding == 5){\n\t\treturn LinearToRGBD(value, 256.0);\n\t}else{\n\t\treturn LinearToGamma(value, 2.2);\n\t}\n}\n\nvec4 envMapTexelToLinear(vec4 color) {\n\treturn inputTexelToLinear(color);\n}\n\t","\n\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n\nvoid main() {\n\tgl_FragColor = vec4(0.0);\n\tvec3 outputDirection = normalize(vOutputDirection);\n\tvec2 uv;\n\tuv.y = asin(clamp(outputDirection.y, -1.0, 1.0)) * RECIPROCAL_PI + 0.5;\n\tuv.x = atan(outputDirection.z, outputDirection.x) * RECIPROCAL_PI2 + 0.5;\n\tvec2 f = fract(uv / texelSize - 0.5);\n\tuv -= f * texelSize;\n\tvec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.x += texelSize.x;\n\tvec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.y += texelSize.y;\n\tvec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.x -= texelSize.x;\n\tvec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tvec3 tm = mix(tl, tr, f.x);\n\tvec3 bm = mix(bl, br, f.x);\n\tgl_FragColor.rgb = mix(tm, bm, f.y);\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t"),blending:y,depthTest:!1,depthWrite:!1});return t.type="EquirectangularToCubeUV",t}function bh(){var t=new Fs({uniforms:{envMap:{value:null},inputEncoding:{value:Yl[3e3]},outputEncoding:{value:Yl[3e3]}},vertexShader:"\nprecision mediump float;\nprecision mediump int;\nattribute vec3 position;\nattribute vec2 uv;\nattribute float faceIndex;\nvarying vec3 vOutputDirection;\nvec3 getDirection(vec2 uv, float face) {\n\tuv = 2.0 * uv - 1.0;\n\tvec3 direction = vec3(uv, 1.0);\n\tif (face == 0.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 1.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 3.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.x *= -1.0;\n\t} else if (face == 4.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.y *= -1.0;\n\t} else if (face == 5.0) {\n\t\tdirection.xz *= -1.0;\n\t}\n\treturn direction;\n}\nvoid main() {\n\tvOutputDirection = getDirection(uv, faceIndex);\n\tgl_Position = vec4( position, 1.0 );\n}\n\t",fragmentShader:"\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform samplerCube envMap;\n\n".concat("\nuniform int inputEncoding;\nuniform int outputEncoding;\n\n#include <encodings_pars_fragment>\n\nvec4 inputTexelToLinear(vec4 value){\n\tif(inputEncoding == 0){\n\t\treturn value;\n\t}else if(inputEncoding == 1){\n\t\treturn sRGBToLinear(value);\n\t}else if(inputEncoding == 2){\n\t\treturn RGBEToLinear(value);\n\t}else if(inputEncoding == 3){\n\t\treturn RGBMToLinear(value, 7.0);\n\t}else if(inputEncoding == 4){\n\t\treturn RGBMToLinear(value, 16.0);\n\t}else if(inputEncoding == 5){\n\t\treturn RGBDToLinear(value, 256.0);\n\t}else{\n\t\treturn GammaToLinear(value, 2.2);\n\t}\n}\n\nvec4 linearToOutputTexel(vec4 value){\n\tif(outputEncoding == 0){\n\t\treturn value;\n\t}else if(outputEncoding == 1){\n\t\treturn LinearTosRGB(value);\n\t}else if(outputEncoding == 2){\n\t\treturn LinearToRGBE(value);\n\t}else if(outputEncoding == 3){\n\t\treturn LinearToRGBM(value, 7.0);\n\t}else if(outputEncoding == 4){\n\t\treturn LinearToRGBM(value, 16.0);\n\t}else if(outputEncoding == 5){\n\t\treturn LinearToRGBD(value, 256.0);\n\t}else{\n\t\treturn LinearToGamma(value, 2.2);\n\t}\n}\n\nvec4 envMapTexelToLinear(vec4 color) {\n\treturn inputTexelToLinear(color);\n}\n\t","\n\nvoid main() {\n\tgl_FragColor = vec4(0.0);\n\tgl_FragColor.rgb = envMapTexelToLinear(textureCube(envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ))).rgb;\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t"),blending:y,depthTest:!1,depthWrite:!1});return t.type="CubemapToCubeUV",t}ch.prototype={constructor:ch,fromScene:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;ih=rh.getRenderTarget();var i=uh();return hh(t,n,r,i),e>0&&mh(i,0,0,e),yh(i),lh(i),i},fromEquirectangular:function(t){return t.magFilter=N,t.minFilter=N,t.generateMipmaps=!1,this.fromCubemap(t)},fromCubemap:function(t){ih=rh.getRenderTarget();var e=uh(t);return function(t,e){var n=new de;t.isCubeTexture?null==Ql&&(Ql=bh()):null==Kl&&(Kl=gh());var r=t.isCubeTexture?Ql:Kl;n.add(new Qn($l[0],r));var i=r.uniforms;i.envMap.value=t,t.isCubeTexture||i.texelSize.value.set(1/t.image.width,1/t.image.height);i.inputEncoding.value=Yl[t.encoding],i.outputEncoding.value=Yl[t.encoding],dh(e,0,0,3*Vl,2*Vl),rh.setRenderTarget(e),rh.render(n,Jl)}(t,e),yh(e),lh(e),e},compileCubemapShader:function(){null==Ql&&fh(Ql=bh())},compileEquirectangularShader:function(){null==Kl&&fh(Kl=gh())},dispose:function(){Xl.dispose(),null!=Ql&&Ql.dispose(),null!=Kl&&Kl.dispose();for(var t=0;t<$l.length;t++)$l[t].dispose()}};function wh(t){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Dc.call(this,t),this.type="catmullrom"}xc.create=function(t,e){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(xc.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},Object.assign(Gc.prototype,{createPointsGeometry:function(t){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var e=this.getPoints(t);return this.createGeometry(e)},createSpacedPointsGeometry:function(t){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var e=this.getSpacedPoints(t);return this.createGeometry(e)},createGeometry:function(t){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var e=new ir,n=0,r=t.length;n<r;n++){var i=t[n];e.vertices.push(new zt(i.x,i.y,i.z||0))}return e}}),Object.assign(Hc.prototype,{fromPoints:function(t){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)}}),Object.create(Dc.prototype),Object.create(Dc.prototype),wh.prototype=Object.create(Dc.prototype),Object.assign(wh.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),_l.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},yl.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(pc.prototype,{extractUrlBase:function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),iu.extractUrlBase(t)}}),pc.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Object.assign(uu.prototype,{setTexturePath:function(t){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(t)}}),Object.assign(ol.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(Oe.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),gr.prototype.setFromMatrix=function(t){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(t)},cl.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},Object.assign(At,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),At.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),At.ceilPowerOfTwo(t)}}),Object.assign(Rt.prototype,{flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(Xt.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new zt).setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,e,n,r,i,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,e,r,n,i,o)}}),He.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},Bt.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},Object.assign(Fe.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(tn.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(t,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,e)},midpoint:function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},normal:function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},plane:function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)}}),Object.assign(tn,{barycoordFromPoint:function(t,e,n,r,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),tn.getBarycoord(t,e,n,r,i)},normal:function(t,e,n,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),tn.getNormal(t,e,n,r)}}),Object.assign(Vc.prototype,{extractAllPoints:function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new ys(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Ps(this,t)}}),Object.assign(Dt.prototype,{fromAttribute:function(t,e,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},distanceToManhattan:function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(zt.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,e,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},distanceToManhattan:function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Lt.prototype,{fromAttribute:function(t,e,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(ir.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(t){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.assign(pe.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(t){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.defineProperties(pe.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign(Qn.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties(Qn.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(qo.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Ko.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Yo.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(xc.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),fr.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(Wc.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(dn.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Tt},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Tt)}}}),Object.assign(dn.prototype,{setDynamic:function(t){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?Tt:35044),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(In.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addAttribute:function(t,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(t,e):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(t,new dn(arguments[1],arguments[2])))},addDrawCall:function(t,e,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(t){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(t)},applyMatrix:function(t){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.defineProperties(In.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(el.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(t){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=t}}}),Object.defineProperties(Mo.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===Tt},set:function(t){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(t)}}}),Object.assign(Mo.prototype,{setDynamic:function(t){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?Tt:35044),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(ms.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties($u.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(hn.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new on}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===t}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(t){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=t}}}),Object.defineProperties(Gs.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(lr.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Object.assign(xo.prototype,{clearTarget:function(t,e,n,r){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(t),this.clear(e,n,r)},animate:function(t){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(t)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(xo.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(t){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===t?xt:3e3}}}),Object.defineProperties(yo.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Nt.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Object.defineProperties(Iu.prototype,{load:{value:function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var e=this;return(new wu).load(t,(function(t){e.setBuffer(t)})),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),Fu.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},pr.prototype.updateCubeMap=function(t,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,e)};Ct.crossOrigin=void 0,Ct.loadTexture=function(t,e,n,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new _c;i.setCrossOrigin(this.crossOrigin);var o=i.load(t,n,void 0,r);return e&&(o.mapping=e),o},Ct.loadTextureCube=function(t,e,n,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new wc;i.setCrossOrigin(this.crossOrigin);var o=i.load(t,n,void 0,r);return e&&(o.mapping=e),o},Ct.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Ct.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"115"}}))},function(t,e,n){"use strict";var r,i,o=n(44),a=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(t){function e(e,n){var r=t.call(this,e)||this;return r.mode=n,r}return a(e,t),e}(o.a);n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return c})),n.d(e,"b",(function(){return u})),function(t){t[t.Panorama=1]="Panorama",t[t.Dollhouse=2]="Dollhouse",t[t.Floorplan=3]="Floorplan",t[t.Outdoor=4]="Outdoor",t[t.Transition=-1]="Transition"}(i||(i={}));var c=function(t){switch(t){case"0":case 0:return i.Panorama;case"1":case 1:return i.Floorplan;case"2":case 2:return i.Dollhouse;case"3":case 3:return i.Transition}throw new s("No known conversion for Workshop int to viewmode for int: "+t,t)};function u(t){switch(t){case i.Panorama:return 0;case i.Floorplan:return 1;case i.Dollhouse:return 2;case i.Transition:return 3}throw new s("No known conversion for Viewmode to Workshop int",t)}},function(t,e,n){"use strict";var r,i=window.navigationStart||Date.now();!function(t){t[t.ERROR=0]="ERROR",t[t.WARN=1]="WARN",t[t.INFO=2]="INFO",t[t.DEBUG=3]="DEBUG",t[t.VERBOSE=4]="VERBOSE"}(r||(r={}));var o=function(){function t(t){var e;this.timers={},this.handlers=((e={})[r.VERBOSE]=console.log,e[r.DEBUG]=console.log,e[r.INFO]=console.info,e[r.WARN]=console.warn,e[r.ERROR]=console.error,e);var n=t.split(new RegExp("/|\\\\"));this.prefix="["+n[n.length-1].replace(".js","")+"]"}return t.prototype.message=function(e){return t.level>=e&&console?(this.handlers[e]?this.handlers[e]:console.log).bind(console,this.getPrefix()):function(){}},Object.defineProperty(t.prototype,"verbose",{get:function(){return this.message(r.VERBOSE)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"debug",{get:function(){return this.message(r.DEBUG)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"info",{get:function(){return this.message(r.INFO)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"warn",{get:function(){return this.message(r.WARN)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"error",{get:function(){return this.message(r.ERROR)},enumerable:!0,configurable:!0}),t.prototype.time=function(e){t.level>=r.DEBUG&&(this.timers[e]=Date.now())},t.prototype.timeEnd=function(e){if(t.level>=r.DEBUG){var n=this.timers[e];if(!n)return;var i=(Date.now()-n)/1e3;this.debug(e,i+"s")}},t.prototype.getPrefix=function(){var t=(Date.now()-i)/1e3+"s";return this.prefix+" "+t},t.level=r.INFO,t}();e.a=o},function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return r}));var r,i=n(0),o=function(){function t(){}return t.UP=new i.Jc(0,1,0),t.DOWN=new i.Jc(0,-1,0),t.LEFT=new i.Jc(-1,0,0),t.RIGHT=new i.Jc(1,0,0),t.FORWARD=new i.Jc(0,0,-1),t.BACK=new i.Jc(0,0,1),t.ZERO=new i.Jc(0,0,0),t.UNIT=new i.Jc(1,1,1),t.HORIZONTAL_PLANE=new i.Jc(1,0,1),t}();!function(t){t.NONE="NONE",t.UP="UP",t.DOWN="DOWN",t.LEFT="LEFT",t.RIGHT="RIGHT",t.FORWARD="FORWARD",t.BACK="BACK",t.ZERO="ZERO",t.UNIT="UNIT",t.HORIZONTAL_PLANE="HORIZONTAL_PLANE"}(r||(r={}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(2),i=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},o=function(){function t(){this.bindings=[],this.log=new r.a("module")}return t.prototype.init=function(t,e){return Promise.resolve()},t.prototype.onUpdate=function(t){},t.prototype.dispose=function(t){var e,n;try{for(var r=i(this.bindings),o=r.next();!o.done;o=r.next()){o.value.cancel()}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}this.bindings=[]},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=function(){}},function(t,e,n){"use strict";n.d(e,"B",(function(){return a})),n.d(e,"n",(function(){return s})),n.d(e,"r",(function(){return c})),n.d(e,"k",(function(){return u})),n.d(e,"m",(function(){return l})),n.d(e,"q",(function(){return h})),n.d(e,"j",(function(){return f})),n.d(e,"h",(function(){return p})),n.d(e,"o",(function(){return d})),n.d(e,"b",(function(){return y})),n.d(e,"p",(function(){return m})),n.d(e,"g",(function(){return v})),n.d(e,"A",(function(){return g})),n.d(e,"z",(function(){return b})),n.d(e,"e",(function(){return w})),n.d(e,"w",(function(){return _})),n.d(e,"s",(function(){return x})),n.d(e,"a",(function(){return S})),n.d(e,"t",(function(){return T})),n.d(e,"x",(function(){return M})),n.d(e,"v",(function(){return E})),n.d(e,"l",(function(){return P})),n.d(e,"i",(function(){return O})),n.d(e,"y",(function(){return A})),n.d(e,"u",(function(){return D})),n.d(e,"c",(function(){return R})),n.d(e,"d",(function(){return C})),n.d(e,"f",(function(){return I}));var r=n(2),i=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},o=new r.a("util-browser"),a=function(){var t=window.innerWidth/window.innerHeight;return isFinite(t)?t:1},s=function(){var t=navigator.userAgent||navigator.vendor,e=new RegExp("(android|bbd+|meego).+mobile|android|avantgo|bada/|blackberry|blazer|compal|elaine|fennec|\n    hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|\n    palm( os)?|phone|p(ixi|re)/|plucker|pocket|psp|series(4|6)0|symbian|treo|up.(browser|link)|vodafone|\n    wap|windows ce|xda|xiino","i"),n=new RegExp("1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|\n    amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|\n    br(e|v)w|bumb|bw-(n|u)|c55/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|\n    devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|\n    g560|gene|gf-5|g-mo|go(.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|\n    a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|\n    jemu|jigs|kddi|keji|kgt( |/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|/(k|l|u)|50|54|-[a-w])|libw|lynx|\n    m1-w|m3ga|m50/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|\n    zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|\n    nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|\n    po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55/|\n    sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|\n    sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|\n    tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|\n    vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|\n    zeto|zte-","i");return(e.test(t)||n.test(t.substr(0,4))||c())&&!d()},c=function(){var t=window.navigator.userAgent;return/iPad/.test(t)||l()&&navigator.maxTouchPoints>1},u=function(){var t=window.navigator.userAgent;return/iPod|iPhone|iPad/.test(t)},l=function(){var t=window.navigator.platform;return/MAC/.test(t.toUpperCase())},h=function(){var t=window.navigator.platform;return/WIN/.test(t.toUpperCase())},f=function(){var t=window.navigator.userAgent;return/Trident\//.test(t)},p=function(){return-1!==window.navigator.userAgent.indexOf("Android")},d=function(){return-1!==window.navigator.userAgent.indexOf("OculusBrowser")},y=function(){return"ontouchstart"in window},m=function(){return"share"in navigator&&(s()||c())},v=function(){return window.parent!==window},g=function(t,e){var n=new RegExp("[#&?]"+t+"=([^#&?]*)").exec(window.location.href);if(!n)return e;var r=n[1];return"boolean"==typeof e?"true"===r||"1"===r:"number"==typeof e?parseFloat(r):decodeURIComponent(r)},b=function(t,e){var n=new RegExp(t+"=([^;]+)|$").exec(document.cookie);if(!n)return e;var r=n[1];return"boolean"==typeof e?"true"===r||"1"===r:"number"==typeof e?parseFloat(r):r},w=function(t,e){if(!("localStorage"in window))return e;var n;try{n=window.localStorage.getItem(t)}catch(t){return o.debug(t),e}return null===n?e:"boolean"==typeof e?"true"===n:"number"==typeof e?parseFloat(n):n},_=function(t,e){try{window.localStorage.setItem(t,e)}catch(t){o.error(t)}},x=function(t){var e=/[#&?]([^=]+)=([^#&?]+)/g;t=t||window.location.href;for(var n,r={};null!==(n=e.exec(t));)r[n[1]]=decodeURIComponent(n[2]);return r},S=function(){return window.location.search.substr(1).split("&")},T=function(t){var e=Object.keys(t).map((function(e){return e+"="+t[e]})).join("&"),n=""+window.location.origin+window.location.pathname+"?"+e;window.location.replace(n)},M=function(t){void 0===t&&(t="");var e=""+window.location.origin+window.location.pathname+window.location.search+"#"+t;window.location.replace(e)},E=function(){var t=window.URL||window.webkitURL,e=document.createElement("a");return document.body.appendChild(e),e.style.display="none",function(n,r){var i=t.createObjectURL(n);e.href=i,e.download=r,e.click(),t.revokeObjectURL(i)}}(),P=function(){return a()>1},O=function(){return!!(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)},A=function(){return!s()&&!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.webkitFullscreenEnabled||document.msFullscreenEnabled)},D=function(t){t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()},R=function(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()};function C(t){try{return document.featurePolicy.allowsFeature(t)}catch(e){return o.warn(e),o.warn("Feature Policy check failed, defaulting "+t+" to false."),!1}}var I=function(){return function(t){var e={language:"en",region:void 0,script:void 0,ext:void 0},n=new RegExp([/^([a-z]{2,3})/,/(?:[_-]([ut]{1}[_-][a-z\-\_]+))?/,/(?:[_-]([a-z]{4}))?/,/(?:[_-]([a-z]{2}))?$/].map((function(t){return t.source})).join(""),"i").exec(t);if(n){var r=i(n,5),o=r[1],a=r[2],s=r[3],c=r[4];Object.assign(e,{language:o,ext:a,script:s,region:c})}return e}(navigator.language).language}},function(t,e,n){"use strict";n.d(e,"b",(function(){return u})),n.d(e,"c",(function(){return l})),n.d(e,"a",(function(){return r})),n.d(e,"i",(function(){return h})),n.d(e,"h",(function(){return f})),n.d(e,"l",(function(){return p})),n.d(e,"o",(function(){return d})),n.d(e,"e",(function(){return y})),n.d(e,"f",(function(){return m})),n.d(e,"d",(function(){return v})),n.d(e,"k",(function(){return g})),n.d(e,"n",(function(){return b})),n.d(e,"r",(function(){return w})),n.d(e,"g",(function(){return _})),n.d(e,"m",(function(){return P})),n.d(e,"j",(function(){return O})),n.d(e,"q",(function(){return A})),n.d(e,"p",(function(){return D}));var r,i=n(0),o=n(68),a=n(3),s=new i.H,c=new o.a,u=(new i.mc,Math.PI/180),l=180/Math.PI;!function(t){t.fromVisionVector=function(t){return new i.Jc(t.x,t.z,-t.y)},t.toVisionVector=function(t){return new i.Jc(t.x,-t.z,t.y)},t.fromVisionQuaternion=function(t){return new i.Pb(t.x,t.z,-t.y,t.w).multiply((new i.Pb).setFromAxisAngle(new i.Jc(0,1,0),i.ib.degToRad(90)))},t.toVisionQuaternion=function(t){var e=new i.Pb(t.x,t.y,t.z,t.w).multiply((new i.Pb).setFromAxisAngle(new i.Jc(0,1,0),i.ib.degToRad(-90)));return e.set(e.x,-e.z,e.y,e.w),e}}(r||(r={}));var h=function(t){return new i.Jc(-t.x,t.y,t.z)},f=function(t){return new i.Pb(t.z,t.w,t.x,t.y)},p=function(t){return Math.cos(i.ib.degToRad(t/2))};function d(t,e,n){return e<=t&&t<=n}var y=function(t,e,n){return Math.max(e,Math.min(t,n))},m=function(t){t.r=y(t.r,0,1),t.g=y(t.g,0,1),t.b=y(t.b,0,1)},v=function(t,e){var n=new i.Jc(0,0,-1);return n.clone().applyQuaternion(t).angleTo(n.clone().applyQuaternion(e))},g=function(t,e,n,r){return c.identity().makeRotationFromQuaternion(e).setPosition(t),c.getInverse(c),c.premultiply(n),s.setFromProjectionMatrix(c.asThreeMatrix4()),s.intersectsBox(r)},b=function(t){var e=t.getSize(new i.Jc),n=Math.max(e.x,e.y,e.z);return(new i.h).setFromCenterAndSize(t.getCenter(new i.Jc),new i.Jc(n,n,n))},w=function(t,e,n,r,i){return(i-r)*((t-e)/(n-e))+r},_=function(t,e,n,r,i){var o=w(t,e,n,r,i);return y(o,r,i)};function x(t){return 0===t.x&&0===t.y&&0===t.z}var S,T,M,E,P=(S=new i.Jc,T=new i.jb,function(t){return x(t)?t.clone():(S.copy(a.b.FORWARD).applyQuaternion(t),T.lookAt(a.b.ZERO,S,a.b.UP),(new i.Pb).setFromRotationMatrix(T))}),O=function(){var t=new i.Jc,e=new i.jb;return function(n,r){return x(n)?r.copy(n):(t.copy(a.b.FORWARD).applyQuaternion(n).setY(0).normalize(),e.lookAt(a.b.ZERO,t,a.b.UP),r.setFromRotationMatrix(e))}}(),A=(M=new i.Jc,E=new i.dc,function(t,e,n,r){return r=r||new i.Jc,E.origin.copy(t),E.lookAt(e),r.copy(E.at(n,M))}),D=function(){var t=new i.Jc,e=new i.dc;return function(n,r,o,a){return a=a||new i.Jc,e.set(n,r),a.copy(e.at(o,t))}}()},function(t,e,n){"use strict";var r,i=n(45),o=n(130),a=n(101),s=n(208),c=n(187),u=n(257),l=n(255),h=n(256),f=n(346),p=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),d=function(t){function e(e,n,r){var i=t.call(this)||this;return i.position=e,i.buttons=n,i.threshold=r,i}return p(e,t),e}(a.a),y=function(t){function e(){return t.call(this)||this}return p(e,t),e}(a.a),m=n(136);n(155);n.d(e,"m",(function(){return i.a})),n.d(e,"n",(function(){return i.c})),n.d(e,"f",(function(){return o.a})),n.d(e,"a",(function(){return s.b})),n.d(e,"b",(function(){return c.a})),n.d(e,"d",(function(){return c.c})),n.d(e,"c",(function(){return c.b})),n.d(e,"j",(function(){return u.b})),n.d(e,"i",(function(){return u.a})),n.d(e,"l",(function(){return l.b})),n.d(e,"k",(function(){return l.a})),n.d(e,"p",(function(){return h.b})),n.d(e,"o",(function(){return h.a})),n.d(e,"q",(function(){return f.a})),n.d(e,"h",(function(){return d})),n.d(e,"g",(function(){return y})),n.d(e,"e",(function(){return m.a})),n.d(e,"r",(function(){return m.b}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=function(){function t(){this.msgId=-1}return t.prototype.setID=function(t){if(-1!==this.msgId)throw Error("Message.msgId can only be set once.");this.msgId=t},t}()},function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.Instant=0]="Instant",t[t.FadeToBlack=1]="FadeToBlack",t[t.Interpolate=2]="Interpolate"}(r||(r={}))},function(t,e,n){"use strict";n.r(e),n.d(e,"h",(function(){return s})),n.d(e,"createElement",(function(){return s})),n.d(e,"cloneElement",(function(){return h})),n.d(e,"createRef",(function(){return F})),n.d(e,"Component",(function(){return j})),n.d(e,"render",(function(){return B})),n.d(e,"rerender",(function(){return y})),n.d(e,"options",(function(){return i}));var r=function(){},i={},o=[],a=[];function s(t,e){var n,s,c,u,l=a;for(u=arguments.length;u-- >2;)o.push(arguments[u]);for(e&&null!=e.children&&(o.length||o.push(e.children),delete e.children);o.length;)if((s=o.pop())&&void 0!==s.pop)for(u=s.length;u--;)o.push(s[u]);else"boolean"==typeof s&&(s=null),(c="function"!=typeof t)&&(null==s?s="":"number"==typeof s?s=String(s):"string"!=typeof s&&(c=!1)),c&&n?l[l.length-1]+=s:l===a?l=[s]:l.push(s),n=c;var h=new r;return h.nodeName=t,h.children=l,h.attributes=null==e?void 0:e,h.key=null==e?void 0:e.key,void 0!==i.vnode&&i.vnode(h),h}function c(t,e){for(var n in e)t[n]=e[n];return t}function u(t,e){null!=t&&("function"==typeof t?t(e):t.current=e)}var l="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout;function h(t,e){return s(t.nodeName,c(c({},t.attributes),e),arguments.length>2?[].slice.call(arguments,2):t.children)}var f=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,p=[];function d(t){!t._dirty&&(t._dirty=!0)&&1==p.push(t)&&(i.debounceRendering||l)(y)}function y(){for(var t;t=p.pop();)t._dirty&&L(t)}function m(t,e,n){return"string"==typeof e||"number"==typeof e?void 0!==t.splitText:"string"==typeof e.nodeName?!t._componentConstructor&&v(t,e.nodeName):n||t._componentConstructor===e.nodeName}function v(t,e){return t.normalizedNodeName===e||t.nodeName.toLowerCase()===e.toLowerCase()}function g(t){var e=c({},t.attributes);e.children=t.children;var n=t.nodeName.defaultProps;if(void 0!==n)for(var r in n)void 0===e[r]&&(e[r]=n[r]);return e}function b(t){var e=t.parentNode;e&&e.removeChild(t)}function w(t,e,n,r,i){if("className"===e&&(e="class"),"key"===e);else if("ref"===e)u(n,null),u(r,t);else if("class"!==e||i)if("style"===e){if(r&&"string"!=typeof r&&"string"!=typeof n||(t.style.cssText=r||""),r&&"object"==typeof r){if("string"!=typeof n)for(var o in n)o in r||(t.style[o]="");for(var o in r)t.style[o]="number"==typeof r[o]&&!1===f.test(o)?r[o]+"px":r[o]}}else if("dangerouslySetInnerHTML"===e)r&&(t.innerHTML=r.__html||"");else if("o"==e[0]&&"n"==e[1]){var a=e!==(e=e.replace(/Capture$/,""));e=e.toLowerCase().substring(2),r?n||t.addEventListener(e,_,a):t.removeEventListener(e,_,a),(t._listeners||(t._listeners={}))[e]=r}else if("list"!==e&&"type"!==e&&!i&&e in t){try{t[e]=null==r?"":r}catch(t){}null!=r&&!1!==r||"spellcheck"==e||t.removeAttribute(e)}else{var s=i&&e!==(e=e.replace(/^xlink:?/,""));null==r||!1===r?s?t.removeAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase()):t.removeAttribute(e):"function"!=typeof r&&(s?t.setAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase(),r):t.setAttribute(e,r))}else t.className=r||""}function _(t){return this._listeners[t.type](i.event&&i.event(t)||t)}var x=[],S=0,T=!1,M=!1;function E(){for(var t;t=x.shift();)i.afterMount&&i.afterMount(t),t.componentDidMount&&t.componentDidMount()}function P(t,e,n,r,i,o){S++||(T=null!=i&&void 0!==i.ownerSVGElement,M=null!=t&&!("__preactattr_"in t));var a=O(t,e,n,r,o);return i&&a.parentNode!==i&&i.appendChild(a),--S||(M=!1,o||E()),a}function O(t,e,n,r,i){var o=t,a=T;if(null!=e&&"boolean"!=typeof e||(e=""),"string"==typeof e||"number"==typeof e)return t&&void 0!==t.splitText&&t.parentNode&&(!t._component||i)?t.nodeValue!=e&&(t.nodeValue=e):(o=document.createTextNode(e),t&&(t.parentNode&&t.parentNode.replaceChild(o,t),A(t,!0))),o.__preactattr_=!0,o;var s,c,u=e.nodeName;if("function"==typeof u)return function(t,e,n,r){var i=t&&t._component,o=i,a=t,s=i&&t._componentConstructor===e.nodeName,c=s,u=g(e);for(;i&&!c&&(i=i._parentComponent);)c=i.constructor===e.nodeName;i&&c&&(!r||i._component)?(k(i,u,3,n,r),t=i.base):(o&&!s&&(N(o),t=a=null),i=C(e.nodeName,u,n),t&&!i.nextBase&&(i.nextBase=t,a=null),k(i,u,1,n,r),t=i.base,a&&t!==a&&(a._component=null,A(a,!1)));return t}(t,e,n,r);if(T="svg"===u||"foreignObject"!==u&&T,u=String(u),(!t||!v(t,u))&&(s=u,(c=T?document.createElementNS("http://www.w3.org/2000/svg",s):document.createElement(s)).normalizedNodeName=s,o=c,t)){for(;t.firstChild;)o.appendChild(t.firstChild);t.parentNode&&t.parentNode.replaceChild(o,t),A(t,!0)}var l=o.firstChild,h=o.__preactattr_,f=e.children;if(null==h){h=o.__preactattr_={};for(var p=o.attributes,d=p.length;d--;)h[p[d].name]=p[d].value}return!M&&f&&1===f.length&&"string"==typeof f[0]&&null!=l&&void 0!==l.splitText&&null==l.nextSibling?l.nodeValue!=f[0]&&(l.nodeValue=f[0]):(f&&f.length||null!=l)&&function(t,e,n,r,i){var o,a,s,c,u,l=t.childNodes,h=[],f={},p=0,d=0,y=l.length,v=0,g=e?e.length:0;if(0!==y)for(var w=0;w<y;w++){var _=l[w],x=_.__preactattr_;null!=(S=g&&x?_._component?_._component.__key:x.key:null)?(p++,f[S]=_):(x||(void 0!==_.splitText?!i||_.nodeValue.trim():i))&&(h[v++]=_)}if(0!==g)for(w=0;w<g;w++){var S;if(c=e[w],u=null,null!=(S=c.key))p&&void 0!==f[S]&&(u=f[S],f[S]=void 0,p--);else if(d<v)for(o=d;o<v;o++)if(void 0!==h[o]&&m(a=h[o],c,i)){u=a,h[o]=void 0,o===v-1&&v--,o===d&&d++;break}u=O(u,c,n,r),s=l[w],u&&u!==t&&u!==s&&(null==s?t.appendChild(u):u===s.nextSibling?b(s):t.insertBefore(u,s))}if(p)for(var w in f)void 0!==f[w]&&A(f[w],!1);for(;d<=v;)void 0!==(u=h[v--])&&A(u,!1)}(o,f,n,r,M||null!=h.dangerouslySetInnerHTML),function(t,e,n){var r;for(r in n)e&&null!=e[r]||null==n[r]||w(t,r,n[r],n[r]=void 0,T);for(r in e)"children"===r||"innerHTML"===r||r in n&&e[r]===("value"===r||"checked"===r?t[r]:n[r])||w(t,r,n[r],n[r]=e[r],T)}(o,e.attributes,h),T=a,o}function A(t,e){var n=t._component;n?N(n):(null!=t.__preactattr_&&u(t.__preactattr_.ref,null),!1!==e&&null!=t.__preactattr_||b(t),D(t))}function D(t){for(t=t.lastChild;t;){var e=t.previousSibling;A(t,!0),t=e}}var R=[];function C(t,e,n){var r,i=R.length;for(t.prototype&&t.prototype.render?(r=new t(e,n),j.call(r,e,n)):((r=new j(e,n)).constructor=t,r.render=I);i--;)if(R[i].constructor===t)return r.nextBase=R[i].nextBase,R.splice(i,1),r;return r}function I(t,e,n){return this.constructor(t,n)}function k(t,e,n,r,o){t._disable||(t._disable=!0,t.__ref=e.ref,t.__key=e.key,delete e.ref,delete e.key,void 0===t.constructor.getDerivedStateFromProps&&(!t.base||o?t.componentWillMount&&t.componentWillMount():t.componentWillReceiveProps&&t.componentWillReceiveProps(e,r)),r&&r!==t.context&&(t.prevContext||(t.prevContext=t.context),t.context=r),t.prevProps||(t.prevProps=t.props),t.props=e,t._disable=!1,0!==n&&(1!==n&&!1===i.syncComponentUpdates&&t.base?d(t):L(t,1,o)),u(t.__ref,t))}function L(t,e,n,r){if(!t._disable){var o,a,s,u=t.props,l=t.state,h=t.context,f=t.prevProps||u,p=t.prevState||l,d=t.prevContext||h,y=t.base,m=t.nextBase,v=y||m,b=t._component,w=!1,_=d;if(t.constructor.getDerivedStateFromProps&&(l=c(c({},l),t.constructor.getDerivedStateFromProps(u,l)),t.state=l),y&&(t.props=f,t.state=p,t.context=d,2!==e&&t.shouldComponentUpdate&&!1===t.shouldComponentUpdate(u,l,h)?w=!0:t.componentWillUpdate&&t.componentWillUpdate(u,l,h),t.props=u,t.state=l,t.context=h),t.prevProps=t.prevState=t.prevContext=t.nextBase=null,t._dirty=!1,!w){o=t.render(u,l,h),t.getChildContext&&(h=c(c({},h),t.getChildContext())),y&&t.getSnapshotBeforeUpdate&&(_=t.getSnapshotBeforeUpdate(f,p));var T,M,O=o&&o.nodeName;if("function"==typeof O){var D=g(o);(a=b)&&a.constructor===O&&D.key==a.__key?k(a,D,1,h,!1):(T=a,t._component=a=C(O,D,h),a.nextBase=a.nextBase||m,a._parentComponent=t,k(a,D,0,h,!1),L(a,1,n,!0)),M=a.base}else s=v,(T=b)&&(s=t._component=null),(v||1===e)&&(s&&(s._component=null),M=P(s,o,h,n||!y,v&&v.parentNode,!0));if(v&&M!==v&&a!==b){var R=v.parentNode;R&&M!==R&&(R.replaceChild(M,v),T||(v._component=null,A(v,!1)))}if(T&&N(T),t.base=M,M&&!r){for(var I=t,j=t;j=j._parentComponent;)(I=j).base=M;M._component=I,M._componentConstructor=I.constructor}}for(!y||n?x.push(t):w||(t.componentDidUpdate&&t.componentDidUpdate(f,p,_),i.afterUpdate&&i.afterUpdate(t));t._renderCallbacks.length;)t._renderCallbacks.pop().call(t);S||r||E()}}function N(t){i.beforeUnmount&&i.beforeUnmount(t);var e=t.base;t._disable=!0,t.componentWillUnmount&&t.componentWillUnmount(),t.base=null;var n=t._component;n?N(n):e&&(null!=e.__preactattr_&&u(e.__preactattr_.ref,null),t.nextBase=e,b(e),R.push(t),D(e)),u(t.__ref,null)}function j(t,e){this._dirty=!0,this.context=e,this.props=t,this.state=this.state||{},this._renderCallbacks=[]}function B(t,e,n){return P(n,t,{},!1,e,!1)}function F(){return{}}c(j.prototype,{setState:function(t,e){this.prevState||(this.prevState=this.state),this.state=c(c({},this.state),"function"==typeof t?t(this.state,this.props):t),e&&this._renderCallbacks.push(e),d(this)},forceUpdate:function(t){t&&this._renderCallbacks.push(t),L(this,2)},render:function(){}});var U={h:s,createElement:s,cloneElement:h,createRef:F,Component:j,render:B,rerender:y,options:i};e.default=U},function(t,e,n){"use strict";var r=n(23),i=n(125),o=n(38),a=n(30),s=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};var c=n(69),u=function(t){if(!t||0===Object.keys(t).length)throw new Error("createObservableProxy() only works on objects that has predefined keys. Did you mean createObservableMap or createObservableArray?");if(t instanceof c.a)throw new Error("Using ObservableProxy on an ObservableObject is a BUG!");if(t.isObservableProxy)return t;var e={},n=new i.a,r=Object.create(t);Object.defineProperties(r,{isObservableProxy:{value:!0},onPropertyChanged:{value:function(t,n){return e[t].onChanged(n)}},removeOnPropertyChanged:{value:function(t,n){return e[t].removeOnChanged(n)}},deepCopy:{value:function(){return Object(a.a)(t)}}}),function t(e,n){var r,i,o=Object.getOwnPropertyNames(n);try{for(var a=s(o),c=a.next();!c.done;c=a.next()){var u=c.value;void 0===e[u]&&("function"==typeof n[u]?Object.defineProperty(e,u,{value:n[u].bind(e)}):Object.defineProperty(e,u,{value:n[u],writable:!0}))}}catch(t){r={error:t}}finally{try{c&&!c.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}null!==Object.getPrototypeOf(Object.getPrototypeOf(n))&&t(e,Object.getPrototypeOf(n))}(r,n);var u=function(n){if(t.hasOwnProperty(n)){var i=Object(o.b)(t[n]);e[n]=i,r.addChildObservable(i),Object.defineProperty(r,n,{get:function(){return t[n]},set:function(r){t[n]=r,e[n].value=r},enumerable:!0})}};for(var l in t)u(l);return Object.seal(r),r};n.d(e,"a",(function(){return h})),n.d(e,"b",(function(){return f})),n.d(e,"c",(function(){return d})),n.d(e,"d",(function(){return y}));var l,h,f,p=(l=function(t,e){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});!function(t){t[t.UNINITIALIZED=0]="UNINITIALIZED",t[t.WAITING=1]="WAITING",t[t.LOADING=2]="LOADING",t[t.STARTING=3]="STARTING",t[t.PLAYING=4]="PLAYING",t[t.ERROR=5]="ERROR"}(h||(h={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBVR=1]="WEBVR",t[t.SHOWCASE=2]="SHOWCASE",t[t.WORKSHOP=3]="WORKSHOP"}(f||(f={}));var d=function(t){function e(e,n){var r;void 0===n&&(n=f.UNKNOWN);var i=t.call(this)||this;return i.name="app",i.phase=e,i.application=n,i.phaseTimes=u(((r={})[h.UNINITIALIZED]=0,r[h.WAITING]=0,r[h.LOADING]=0,r[h.STARTING]=0,r[h.PLAYING]=0,r[h.ERROR]=0,r)),i.error=null,i}return p(e,t),e.prototype.copy=function(t){this.phase=t.phase,this.phaseTimes[h.UNINITIALIZED]=t.phaseTimes[h.UNINITIALIZED],this.phaseTimes[h.WAITING]=t.phaseTimes[h.WAITING],this.phaseTimes[h.LOADING]=t.phaseTimes[h.LOADING],this.phaseTimes[h.STARTING]=t.phaseTimes[h.STARTING],this.phaseTimes[h.PLAYING]=t.phaseTimes[h.PLAYING],this.phaseTimes[h.ERROR]=t.phaseTimes[h.ERROR],this.application=t.application,this.error=t.error},e}(r.a),y=function(){return new d(h.UNINITIALIZED)}},function(t,e,n){"use strict";var r,i,o,a;n.d(e,"d",(function(){return o})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return c})),function(t){t[t.BASE=1]="BASE",t[t.STANDARD=2]="STANDARD",t[t.HIGH=3]="HIGH",t[t.ULTRAHIGH=4]="ULTRAHIGH"}(o||(o={})),function(t){t[t.BASE=512]="BASE",t[t.STANDARD=1024]="STANDARD",t[t.HIGH=2048]="HIGH",t[t.ULTRAHIGH=4096]="ULTRAHIGH"}(a||(a={}));var s=((r={})[o.BASE]=512,r[o.STANDARD]=1024,r[o.HIGH]=2048,r[o.ULTRAHIGH]=4096,r),c=((i={})[a.BASE]=o.BASE,i[a.STANDARD]=o.STANDARD,i[a.HIGH]=o.HIGH,i[a.ULTRAHIGH]=o.ULTRAHIGH,i)},function(t,e,n){"use strict";n.d(e,"d",(function(){return o})),n.d(e,"c",(function(){return a})),n.d(e,"g",(function(){return s})),n.d(e,"e",(function(){return c})),n.d(e,"H",(function(){return u})),n.d(e,"G",(function(){return l})),n.d(e,"f",(function(){return h})),n.d(e,"b",(function(){return f})),n.d(e,"a",(function(){return p})),n.d(e,"I",(function(){return d})),n.d(e,"z",(function(){return y})),n.d(e,"x",(function(){return m})),n.d(e,"y",(function(){return v})),n.d(e,"A",(function(){return g})),n.d(e,"C",(function(){return b})),n.d(e,"B",(function(){return w})),n.d(e,"v",(function(){return _})),n.d(e,"t",(function(){return x})),n.d(e,"w",(function(){return S})),n.d(e,"u",(function(){return T})),n.d(e,"n",(function(){return M})),n.d(e,"m",(function(){return E})),n.d(e,"l",(function(){return P})),n.d(e,"o",(function(){return O})),n.d(e,"p",(function(){return A})),n.d(e,"q",(function(){return D})),n.d(e,"s",(function(){return R})),n.d(e,"r",(function(){return C})),n.d(e,"k",(function(){return I})),n.d(e,"h",(function(){return k})),n.d(e,"j",(function(){return L})),n.d(e,"i",(function(){return N})),n.d(e,"D",(function(){return j})),n.d(e,"F",(function(){return B})),n.d(e,"E",(function(){return F})),n.d(e,"J",(function(){return U}));var r=n(6),i=n(97),o="features/smoothertour",a="features/sc2pandirection",s="TourSpeed &wts",c="ToursMetersPerSecond",u=.4,l=10,h=1.25,f=.8,p=6,d=3,y=1e3*f,m=1e3*h,v=1e3*p,g=600,b=400,w=1200,_=1200,x=35,S=15,T=120,M=1200,E=75,P=400,O=i.DEFAULT_TRANSITION_TIME-g,A=35,D=A/3500*1e3,R=2,C=52,I=0,k=.2*D,L=k,N=90,j=3500,B=1e3,F=7e3,U=Object.freeze({panAtSnapshot:r.A("kb",1),snapshotPanZoomDuration:r.A("st",3500),snapshotPanAngle:r.A("sspa",A),walkingTourIncludeExtraPanosDistance:.4,walkingStageMinimumDistance:.8,maxWalkingSweepsBetweenSnapshots:40,autoStartDelay:r.A("ts",-1)})},function(t,e,n){"use strict";var r,i=n(22),o=n(23),a=n(139),s=n(124),c=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),u=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},l=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},h=function(t){function e(e){var n,r,i=t.call(this)||this;if(i.name="sweeps",i.transitionActive=!1,i.sweepList=new a.a,i.sweepMap={},e)try{for(var o=l(e),c=o.next();!c.done;c=o.next()){var u=c.value;i.sweepMap[u.id]=u,i.sweepList.push(u)}}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i.transition={progress:new s.a(0),pending:!1,active:!1,from:void 0,to:void 0},i}return c(e,t),e.prototype.canTransition=function(){return!this.transition.pending&&!this.transition.active},Object.defineProperty(e.prototype,"currentSweepIndex",{get:function(){if(this.currentSweep)return this.sweepMap[this.currentSweep].index},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentSweepObject",{get:function(){if(this.currentSweep)return this.getSweep(this.currentSweep)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentAlignedSweepObject",{get:function(){if(this.currentSweep&&!this.isSweepUnaligned(this.currentSweep))return this.getSweep(this.currentSweep)},enumerable:!0,configurable:!0}),e.prototype.makeSweepChangeSubscription=function(t){return this.onPropertyChanged("currentSweep",t)},e.prototype.copy=function(t){var e=this,n=!1;if(this.sweepList.length===t.sweepList.length){n=!0;for(var r=0;r<this.sweepList.length;r++){var i=this.sweepList.get(r),o=t.sweepList.get(r);if(i.id!==o.id){n=!1;break}}}n||(this.sweepMap={},this.sweepList.length=0,t.sweepList.forEach((function(t){e.addSweep(t)}))),this.currentSweep=t.currentSweep,this.transition.progress.copy(t.transition.progress),this.transition.pending=t.transition.pending,this.transition.active=t.transition.active,this.transition.to=t.transition.to,this.transition.from=t.transition.from,this.transitionActive=t.transitionActive,this.commit()},e.prototype.clone=function(){var t=new e;return t.copy(this),t},e.prototype.addSweep=function(t){this.containsSweep(t.id)||(this.sweepList.push(t),this.sweepMap[t.id]=t)},e.prototype.getSweep=function(t){return this.sweepMap[t]},e.prototype.getSweepByIndex=function(t){for(var e=0;e<this.sweepList.length;e++){var n=this.sweepList.get(e);if(n.index===t)return n}return null},e.prototype.containsSweep=function(t){return t in this.sweepMap},e.prototype.getFirstSweep=function(){for(var t=-1;++t<this.sweepList.length;){var e=this.sweepList.get(t);if(e.enabled)return e}throw new Error("First enabled sweep not found")},e.prototype.getStartSweep=function(t){var e=t&&t.pano&&t.pano.uuid?this.getSweep(t.pano.uuid):null;return e&&e.enabled?e:this.getFirstSweep()},e.prototype.getClosestSweep=function(t,e){var n=Number.MAX_VALUE,r=null;return this.iterate((function(o){if(o.enabled&&(!e||o.alignmentType===i.a.ALIGNED)){var a=t.distanceTo(o.position);a<n&&(n=a,r=o)}})),r},e.prototype.getFirstAlignedSweep=function(){for(var t=-1;++t<this.sweepList.length;){var e=this.sweepList.get(t);if(e.enabled&&e.alignmentType===i.a.ALIGNED)return e}return null},e.prototype.setTransitionPending=function(t){this.transition.pending=t},e.prototype.activateTransition=function(t,e){this.transition.active=!0,this.transition.from=e,this.transition.to=t,this.transitionActive=!0},e.prototype.deactivateTransition=function(){this.transition.active=!1,this.transition.from=void 0,this.transition.to=void 0,this.transitionActive=!1},e.prototype.isSweepUnaligned=function(t){if(!t)return!1;var e=this.getSweep(t);return e&&e.alignmentType!==i.a.ALIGNED},e.prototype.isSweepAligned=function(t){var e=this.getSweep(t);return e&&e.alignmentType===i.a.ALIGNED},e.prototype.isSweepDisabled=function(t){if(void 0===t&&(t=this.currentSweep),!t)return!1;var e=this.getSweep(t);return e&&!e.enabled},e.prototype.sweeps=function(){var t,e,n,r,i;return u(this,(function(o){switch(o.label){case 0:o.trys.push([0,5,6,7]),n=l(this.sweepList),r=n.next(),o.label=1;case 1:return r.done?[3,4]:[4,r.value];case 2:o.sent(),o.label=3;case 3:return r=n.next(),[3,1];case 4:return[3,7];case 5:return i=o.sent(),t={error:i},[3,7];case 6:try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}return[7];case 7:return[2]}}))},e.prototype.iterate=function(t){this.sweepList.forEach((function(e,n){t(e,n)}))},e.prototype.filter=function(t){return this.sweepList.filter(t)},e.prototype.sortByScore=function(t,e){return this.sweepList.filter((function(e){return t.every((function(t){return t(e)}))})).map((function(t){return{sweep:t,score:e.reduce((function(e,n){return e+n(t)}),0)}})).sort((function(t,e){return e.score-t.score}))},e.prototype.getSweepList=function(){return this.sweepList.values()},e.prototype.getConnectedSweeps=function(t,e){var n,r,i=[t],o=new Set;for(e=e||function(t){return!0};i.length;){var a=i.pop(),s=this.getSweep(a);o.add(a);try{for(var c=l(s.neighbours),u=c.next();!u.done;u=c.next()){var h=u.value;e(this.getSweep(h))&&!o.has(h)&&i.push(h)}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}}return o},e.prototype.equals=function(t){if(this.sweepMap.length!==t.sweepMap.length||this.currentSweep!==t.currentSweep||this.transition.active!==t.transition.active||this.transition.from!==t.transition.from||this.transition.pending!==t.transition.pending||this.transition.to!==t.transition.to)return!1;for(var e in this.sweepMap){if(!t.containsSweep(e))return!1;if(!this.sweepMap[e].equals(t.getSweep(e)))return!1}return!0},e}(o.a);e.a=h},function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.ESCAPE=27]="ESCAPE",t[t.ZERO=48]="ZERO",t[t.ONE=49]="ONE",t[t.TWO=50]="TWO",t[t.THREE=51]="THREE",t[t.FOUR=52]="FOUR",t[t.FIVE=53]="FIVE",t[t.SIX=54]="SIX",t[t.SEVEN=55]="SEVEN",t[t.EIGHT=56]="EIGHT",t[t.NINE=57]="NINE",t[t.LEFTARROW=37]="LEFTARROW",t[t.UPARROW=38]="UPARROW",t[t.RIGHTARROW=39]="RIGHTARROW",t[t.DOWNARROW=40]="DOWNARROW",t[t.TAB=9]="TAB",t[t.A=65]="A",t[t.B=66]="B",t[t.C=67]="C",t[t.D=68]="D",t[t.E=69]="E",t[t.F=70]="F",t[t.G=71]="G",t[t.H=72]="H",t[t.I=73]="I",t[t.J=74]="J",t[t.K=75]="K",t[t.L=76]="L",t[t.M=77]="M",t[t.N=78]="N",t[t.O=79]="O",t[t.P=80]="P",t[t.Q=81]="Q",t[t.R=82]="R",t[t.S=83]="S",t[t.T=84]="T",t[t.U=85]="U",t[t.V=86]="V",t[t.W=87]="W",t[t.X=88]="X",t[t.Y=89]="Y",t[t.Z=90]="Z",t[t.SPACE=32]="SPACE",t[t.RETURN=13]="RETURN",t[t.DELETE=46]="DELETE",t[t.BACKSPACE=8]="BACKSPACE",t[t.SEMICOLON=186]="SEMICOLON",t[t.PLUSEQUALS=187]="PLUSEQUALS",t[t.DASHUNDERSCORE=189]="DASHUNDERSCORE",t[t.OPENBRACKET=219]="OPENBRACKET",t[t.SHIFT=16]="SHIFT",t[t.ALT=18]="ALT",t[t.CONTROL=17]="CONTROL"}(r||(r={}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r,i=n(23),o=n(1),a=n(38),s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(t){function e(){var e=t.call(this)||this;return e.name="viewmode",e.isPano=function(){return e.currentMode===o.a.Panorama},e.isFloorplan=function(){return e.currentMode===o.a.Floorplan},e.isDollhouse=function(){return e.currentMode===o.a.Dollhouse},e.currentModeObservable=Object(a.b)(null),e.transition={active:!1,progress:0,from:null,to:null,startTime:0,transitionTime:0},e}return s(e,t),Object.defineProperty(e.prototype,"currentMode",{get:function(){return this.currentModeObservable.value},set:function(t){t!==this.currentModeObservable.value&&(this.currentModeObservable.value=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"closestMode",{get:function(){return this.currentMode===o.a.Transition?this.transition.progress<.5?this.transition.from:this.transition.to:this.currentMode},enumerable:!0,configurable:!0}),e.prototype.makeModeChangeSubscription=function(t){return this.currentModeObservable.onChanged(t)},e.prototype.copyTransition=function(t){this.transition.active=t.active,this.transition.progress=t.progress,this.transition.from=t.from,this.transition.to=t.to,this.transition.startTime=t.startTime,this.transition.transitionTime=t.transitionTime},e.prototype.activateTransition=function(t,e,n){this.transition.active=!0,this.transition.progress=0,this.transition.startTime=Date.now(),this.transition.transitionTime=n,this.transition.to=e,this.transition.from=t},e.prototype.deactivateTransition=function(){this.transition.active=!1},e.prototype.clone=function(){var t=new e;return t.copy(this),t},e.prototype.copy=function(t){this.currentMode=t.currentMode,this.copyTransition(t.transition)},e.prototype.canStartTransition=function(){var t=this.transition.active,e=this.currentMode===o.a.Transition;return!t&&!e},e.prototype.transitionActive=function(){return!this.canStartTransition()},e.prototype.isAlreadyInMode=function(t){var e=this.transition.from===this.transition.to,n=this.currentMode===t;return this.transition.active&&e||n},e.prototype.canSwitchViewMode=function(t){return this.canStartTransition()&&!this.isAlreadyInMode(t)},e}(i.a)},function(t,e,n){"use strict";var r=n(79),i=n(23),o=n(124),a=n(0),s=function(t,e){return t&&e?t.equals(e):t===e},c=n(28),u=n(68),l=n(69),h=n(7);n.d(e,"b",(function(){return y})),n.d(e,"a",(function(){return g}));var f,p=(f=function(t,e){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}f(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.startTime=0,e.duration=0,e.active=!1,e.type=null,e.progress=new o.a(0),e.blackoutProgress=new o.a(0),e.from={position:new a.Jc,rotation:new a.Pb,projection:new u.a},e.to={position:new a.Jc,rotation:new a.Pb,projection:new u.a},e.rotationDelay=0,e.rotationDuration=1,e.matrixDelay=0,e.matrixDuration=1,e.activeInternal=!1,e}return p(e,t),e}(l.a),y=function(t,e,n){void 0===n&&(n=!0),e.position=m(t.position,e.position,n),e.rotation=m(t.rotation,e.rotation,n),e.projection=m(t.projection,e.projection,n),e.focalDistance=t.focalDistance},m=function(t,e,n){return void 0===n&&(n=!0),t&&!e?e=t.clone():t&&e?e.copy(t):n&&(e=void 0),e},v=function(t){function e(e){var n=t.call(this)||this;return n.position=new a.Jc,n.rotation=new a.Pb,n.focalDistance=-1,n.projection=Object(r.c)(e),n}return p(e,t),e.prototype.aspect=function(){return this.projection.elements[5]/this.projection.elements[0]},e}(l.a),g=function(t){function e(e,n){var i=t.call(this)||this;return i._width=e,i._height=n,i.name="camera",i._baseProjection=new u.a,i._orthoMatrix=new u.a,i._perspectiveMatrix=new u.a,i.pose=new v(e/n),i.transition=new d,i.setCameraDimensions(e,n),i._baseFovY=a.ib.DEG2RAD*r.a.fov,i}return p(e,t),e.prototype.setCameraDimensions=function(t,e){if(void 0!==t&&void 0!==e){this._width=t,this._height=e;var n=t/e,i=this.isOrtho()?Object(r.b)(t,e,e/(2*this.orthoZoom()),this._orthoMatrix):this._perspectiveMatrix.makePerspectiveFov(h.c*this.fovY(),n,r.a.near,r.a.far);if(this.pose.projection.copy(i),this.transition.active&&this.transition.to.projection)if(Object(c.n)(this.transition.to.projection)){var o=Object(c.e)(this.transition.to.projection);this.transition.to.projection.copy(Object(r.b)(t,e,e/(2*o)))}else{var a=2*h.c*Math.atan(1/this.transition.to.projection.elements[5]);this.transition.to.projection.makePerspectiveFov(a,n,r.a.near,r.a.far)}this.pose.commit()}},e.prototype.setBaseProjection=function(t){this._baseProjection=t},Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baseFovY",{get:function(){return this._baseFovY},enumerable:!0,configurable:!0}),e.prototype.aspect=function(){return this.pose.aspect()},e.prototype.fovY=function(){return 2*Math.atan(1/this.pose.projection.elements[5])},e.prototype.fovX=function(){return 2*Math.atan(1*this.aspect()/this.pose.projection.elements[5])},e.prototype.isOrtho=function(){return Object(c.n)(this.pose.projection)},e.prototype.baseZoom=function(){return this.pose.projection.elements[0]/2},e.prototype.defaultZoom=function(){return Object(c.n)(this._baseProjection)?Object(c.e)(this._baseProjection):this.perspectiveZoom()},e.prototype.zoom=function(){return this.isOrtho()?this.orthoZoom():this.perspectiveZoom()},e.prototype.orthoZoom=function(){return Object(c.e)(this.pose.projection)},e.prototype.perspectiveZoom=function(){return this.baseFovY/this.fovY()},e.prototype.copyTransition=function(t){this.transition.active=t.active,this.transition.activeInternal=t.activeInternal,this.transition.type=t.type,this.transition.startTime=t.startTime,this.transition.duration=t.duration,this.transition.rotationDelay=t.rotationDelay,this.transition.rotationDuration=t.rotationDuration,this.transition.matrixDelay=t.matrixDelay,this.transition.matrixDuration=t.matrixDuration,t.progress&&this.transition.progress.copy(t.progress),t.blackoutProgress&&this.transition.blackoutProgress.copy(t.blackoutProgress),t.from&&y(t.from,this.transition.from),t.to&&y(t.to,this.transition.to)},e.prototype.canTransition=function(){return!this.transition.active},e.prototype.clone=function(){var t=new e(this.width,this.height);return t.copy(this),t},e.prototype.copy=function(t){this.pose.position.copy(t.pose.position),this.pose.rotation.copy(t.pose.rotation),this.pose.focalDistance=t.pose.focalDistance,this.pose.projection.copy(t.pose.projection),this.pose.commit(),this._baseFovY=t.baseFovY,this.copyTransition(t.transition),this.transition.commit(),this._width=t.width,this._height=t.height},e.prototype.shallowIsEqual=function(t){return this.pose.position.equals(t.pose.position)&&this.pose.rotation.equals(t.pose.rotation)&&this.pose.projection.equals(t.pose.projection)&&this.pose.focalDistance===t.pose.focalDistance&&this.baseFovY===t.baseFovY},e.prototype.isEqual=function(t){return this.shallowIsEqual(t)&&this.transitionIsEqual(t.transition)},e.prototype.transitionIsEqual=function(t){return this.transition.active===t.active&&this.transition.type===t.type&&this.transition.progress.equals(t.progress)&&this.transition.blackoutProgress.equals(t.blackoutProgress)&&this.transition.rotationDelay===t.rotationDelay&&this.transition.rotationDuration===t.rotationDuration&&this.transition.matrixDelay===t.matrixDelay&&this.transition.matrixDuration===t.matrixDuration&&this.transition.activeInternal===t.activeInternal&&s(this.transition.from.position,t.from.position)&&s(this.transition.from.rotation,t.from.rotation)&&s(this.transition.from.projection,t.from.projection)&&s(this.transition.to.position,t.to.position)&&s(this.transition.to.rotation,t.to.rotation)&&s(this.transition.to.projection,t.to.projection)&&this.transition.startTime===t.startTime&&this.transition.duration===t.duration},e}(i.a)},function(t,e,n){"use strict";var r,i,o,a,s,c,u;n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return l})),n.d(e,"e",(function(){return h})),n.d(e,"d",(function(){return f})),n.d(e,"c",(function(){return p})),function(t){t[t.CLOSED=0]="CLOSED",t[t.IDLE=1]="IDLE",t[t.EDITING=2]="EDITING",t[t.CREATING=3]="CREATING",t[t.POINT_PLACED=4]="POINT_PLACED",t[t.CREATING_NEXT_POINT=5]="CREATING_NEXT_POINT",t[t.CONFIRMING_POINT=6]="CONFIRMING_POINT"}(u||(u={}));var l={mobile:(r={},r[u.POINT_PLACED]=!0,r[u.EDITING]=!0,r),desktop:(i={},i[u.CREATING]=!0,i[u.CREATING_NEXT_POINT]=!0,i[u.EDITING]=!0,i)},h={mobile:(o={},o[u.CREATING_NEXT_POINT]=!0,o[u.POINT_PLACED]=!0,o[u.EDITING]=!0,o),desktop:(a={},a[u.CREATING]=!0,a[u.CREATING_NEXT_POINT]=!0,a[u.EDITING]=!0,a)},f=((s={})[u.IDLE]=!0,s[u.EDITING]=!0,s),p=((c={})[u.IDLE]=!0,c[u.EDITING]=!0,c)},function(t,e,n){"use strict";n.d(e,"q",(function(){return s})),n.d(e,"d",(function(){return c})),n.d(e,"c",(function(){return u})),n.d(e,"p",(function(){return l})),n.d(e,"a",(function(){return h})),n.d(e,"e",(function(){return f})),n.d(e,"f",(function(){return p})),n.d(e,"g",(function(){return d})),n.d(e,"l",(function(){return y})),n.d(e,"h",(function(){return m})),n.d(e,"i",(function(){return v})),n.d(e,"k",(function(){return g})),n.d(e,"m",(function(){return b})),n.d(e,"o",(function(){return w})),n.d(e,"b",(function(){return _})),n.d(e,"j",(function(){return x})),n.d(e,"n",(function(){return T}));n(497),n(0);for(var r=n(348),i=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},o=[],a=0;a<256;a++)o[a]=(a<16?"0":"")+a.toString(16);function s(){var t;return(t=self.crypto?crypto.getRandomValues(new Uint8Array(16)):n(703).randomFillSync(new Uint8Array(16)))[6]=15&t[6]|64,t[8]=63&t[8]|128,o[t[0]]+o[t[1]]+o[t[2]]+o[t[3]]+"-"+o[t[4]]+o[t[5]]+"-"+o[t[6]]+o[t[7]]+"-"+o[t[8]]+o[t[9]]+"-"+o[t[10]]+o[t[11]]+o[t[12]]+o[t[13]]+o[t[14]]+o[t[15]]}var c=function(t){return new Promise((function(e,n){setTimeout(e,t)}))},u=function(t){var e,n=-1;return{promise:new Promise((function(r,i){e=r,n=window.setTimeout(r,t)})).then((function(){n=-1})),cancel:function(){-1!==n&&(window.clearTimeout(n),e())}}},l=function(t){var e,n,r={};try{for(var o=i(t),a=o.next();!a.done;a=o.next()){var s=a.value;r[s]=s}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return r},h=function(t,e){var n,r;if(e.setLength(0),0===t.length)return e;var o=0;try{for(var a=i(t),s=a.next();!s.done;s=a.next()){var c=s.value;e.add(c),o++}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return e.divideScalar(o),e},f=function(t){return!t.replace(/\n/g,"").trim().length},p=function(t,e){var n,r;if(t.size!==e.size)return!1;try{for(var o=i(t),a=o.next();!a.done;a=o.next()){var s=a.value;if(!e.has(s))return!1}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return!0},d=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0},y=function(t,e,n){if(void 0===n&&(n=!0),0===t.length)return null;n&&t.sort((function(t,e){return t-e}));var r=e/100;return t[Math.floor(t.length*r)]},m=function(t,e){var n,r;try{for(var o=i(e),a=o.next();!a.done;a=o.next()){if(!(0,a.value)(t))return!1}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return!0},v=function(t){return[g(t.getMonth()+1),".",g(t.getDate()),".",t.getFullYear(),"_",g(t.getHours()),".",g(t.getMinutes()),".",g(t.getSeconds())].join("")},g=function(t,e,n,r){void 0===e&&(e=2),void 0===n&&(n="0"),void 0===r&&(r=10);var i=t.toString(r),o=e-i.length+1;return o>0?new Array(o).join(n)+i:i},b=function(t){for(var e="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=0;r<t;r++)e+=n.charAt(Math.floor(Math.random()*n.length));return e},w=function(t){for(var e=[],n=0;n<t.length;n+=8192)e.push(String.fromCharCode.apply(null,t.subarray(n,n+8192)));return btoa(e.join(""))},_=function(t){var e,n;void 0===t&&(t=[]);var r={};try{for(var o=i(t),a=o.next();!a.done;a=o.next()){r[a.value]=!0}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return r};function x(t,e){return t.hasOwnProperty(e)}var S,T=function(t,e,n){if(!(Math.abs(t)<4294967295)||!(e<32)||!(n<32))throw new r.a("argument out of range");var i=1&(t>>>e^t>>>n);return(t^=i<<e|i<<n)>>>0};S={}},function(t,e,n){"use strict";n.d(e,"b",(function(){return l})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return o}));var r,i,o,a=n(23),s=n(142),c=n(74),u=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=function(t){function e(e){var n=t.call(this)||this;return n.name="player-options",n.options=new h(e),n}return u(e,t),e.prototype.copy=function(t){this.options=Object.assign({},t.options)},e.prototype.resetDefaultTourOptions=function(){this.options.fast_transitions=c.c,this.options.transition_speed=c.g,this.options.transition_time=c.h,this.options.pan_speed=c.f,this.options.dollhouse_pan_speed=c.b,this.options.zoom_duration=c.i,this.options.pan_angle=c.d,this.options.pan_direction=c.e},e}(a.a),h=function(t){this.presented_by=!1,this.highlight_reel=!0,this.floor_plan=!0,this.tour_buttons=!0,this.labels=!0,this.measurements=!0,this.measurements_saved=!0,this.dollhouse=!0,this.autoplay=!1,this.contact_email=!1,this.address=!1,this.contact_name=!1,this.model_summary=!1,this.contact_phone=!1,this.model_name=!1,this.external_url=!1,this.unit_type=i.USFractional,this.background_color=s.a.default,this.fast_transitions=c.c,this.transition_speed=c.g,this.transition_time=c.h,this.pan_speed=c.f,this.dollhouse_pan_speed=c.b,this.zoom_duration=c.i,this.pan_angle=c.d,this.pan_direction=c.e,t&&(this.presented_by=!!t.presented_by,this.highlight_reel=!!t.highlight_reel,this.floor_plan=!!t.floor_plan,this.tour_buttons=!!t.tour_buttons,this.labels=!!t.labels,this.dollhouse=!!t.dollhouse,this.fast_transitions=!!t.fast_transitions,this.contact_email=!!t.contact_email,this.address=!!t.address,this.contact_name=!!t.contact_name,this.model_summary=!!t.model_summary,this.contact_phone=!!t.contact_phone,this.model_name=!!t.model_name,this.external_url=!!t.external_url,this.autoplay=!!t.autoplay,void 0!==t.measurements&&(this.measurements=t.measurements),void 0!==t.measurements_saved&&(this.measurements_saved=t.measurements_saved),void 0!==t.unit_type&&(this.unit_type=t.unit_type),void 0!==t.background_color&&void 0!==s.a[t.background_color]&&(this.background_color=t.background_color),void 0!==t.transition_speed&&(this.transition_speed=t.transition_speed),void 0!==t.transition_time&&(this.transition_time=t.transition_time),void 0!==t.pan_speed&&(this.pan_speed=t.pan_speed),void 0!==t.dollhouse_pan_speed&&(this.dollhouse_pan_speed=t.dollhouse_pan_speed),void 0!==t.zoom_duration&&(this.zoom_duration=t.zoom_duration),void 0!==t.pan_angle&&(this.pan_angle=t.pan_angle),void 0!==t.pan_direction&&(this.pan_direction=t.pan_direction))};!function(t){t.USFractional="imperial",t.Metric="metric"}(i||(i={})),function(t){t.PresentedBy="presented_by",t.HighlightReel="highlight_reel",t.FloorPlan="floor_plan",t.TourButtons="tour_buttons",t.Labels="labels",t.Measurements="measurements",t.SavedMeasurements="measurements_saved",t.Dollhouse="dollhouse",t.InstantTransitions="fast_transitions",t.TransitionSpeed="transition_speed",t.TransitionTime="transition_time",t.PanSpeed="pan_speed",t.DollhousePanSpeed="dollhouse_pan_speed",t.ZoomDuration="zoom_duration",t.PanAngle="pan_angle",t.PanDirection="pan_direction",t.AutoPlay="autoplay",t.Units="unit_type",t.DetailsEmail="contact_email",t.DetailsAddress="address",t.DetailsName="contact_name",t.DetailsSummary="model_summary",t.DetailsPhone="contact_phone",t.DetailsModelName="model_name",t.DetailsExternalUrl="external_url",t.BackgroundColor="background_color"}(o||(o={}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o}));var r,i,o,a=n(0),s=n(69),c=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});!function(t){t.ALIGNED="aligned",t.UNALIGNED="unaligned"}(i||(i={})),function(t){t.UNPLACED="unplaced",t.AUTO="auto",t.MANUAL="manual"}(o||(o={}));var u=function(t){function e(e){var n=t.call(this)||this;if(!e)return n;n.id=e.id,n.index=e.index,n.name=e.name||"",n.position=e.position||new a.Jc,n.floorPosition=e.floorPosition||new a.Jc;var r=Number.parseInt(e.floor,10);n.floor=isNaN(r)?-1:r;var s=Number.parseInt(e.room,10);return n.room=isNaN(s)?-1:s,n.rotation=e.rotation||new a.Pb,n.enabled=e.enabled||!1,n.vrenabled=e.vrenabled||!1,n.neighbours=e.neighbours||[],n.alignmentType=e.alignmentType||i.ALIGNED,n.placementType=e.placementType||o.UNPLACED,n}return c(e,t),e.prototype.equals=function(t){return this.id===t.id&&this.index===t.index&&this.name===t.name&&this.position.equals(t.position)&&this.floor===t.floor&&this.room===t.room&&this.rotation.equals(t.rotation)&&this.enabled===t.enabled&&this.vrenabled===t.vrenabled&&this.alignmentType===t.alignmentType&&this.placementType===t.placementType},e.prototype.copy=function(t){return this.id=t.id,this.index=t.index,this.name=t.name,this.position=(new a.Jc).copy(t.position),this.floorPosition=(new a.Jc).copy(t.floorPosition),this.floor=t.floor,this.room=t.room,this.rotation=(new a.Pb).copy(t.rotation),this.enabled=t.enabled,this.vrenabled=t.vrenabled,this.neighbours=t.neighbours.slice(),this.alignmentType=t.alignmentType,this.placementType=t.placementType,this},e}(s.a);e.c=u},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(69),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},i=function(){function t(){var t=this;this.base=new Promise((function(e,n){t.resolver=e,t.rejecter=n})),this._promise=new o(this.base,this),this.progressCallbacks=[]}return t.prototype.then=function(t,e){return this.base.then(t,e)},t.prototype.catch=function(t){return this.base.catch(t)},t.prototype.resolve=function(t){return this.resolver(t),this},t.prototype.reject=function(t){return this.rejecter(t),this},t.prototype.notify=function(t){var e,n;try{for(var i=r(this.progressCallbacks),o=i.next();!o.done;o=i.next()){(0,o.value)(t)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}},t.prototype.progress=function(t){return this.progressCallbacks.push(t),this},t.prototype.promise=function(){return this._promise},t.prototype.nativePromise=function(){return this.base},t.resolve=function(){var e=new t;return e.resolve(),e.promise()},t.reject=function(e){var n=new t;return n.reject(e),n.promise()},t.all=function(e){var n,i,o=[];try{for(var a=r(e),s=a.next();!s.done;s=a.next()){var c=s.value;c.nativePromise?o.push(c.nativePromise()):o.push(c)}}catch(t){n={error:t}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}var u=new t;return Promise.all(o).then((function(t){return u.resolve(t)}),(function(t){return u.reject(t)})),u.promise()},t}(),o=function(){function t(t,e){this.basePromise=t,this.baseDeferred=e}return t.prototype.then=function(t,e){return this.baseDeferred.then(t,e),this},t.prototype.catch=function(t){return this.baseDeferred.catch(t),this},t.prototype.progress=function(t){return this.baseDeferred.progress(t),this},t.prototype.nativePromise=function(){return this.basePromise},t}()},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(100),a=n(82),s=n(0),c=n(80),u={copyCubeMap:{uniforms:{tDiffuse:{type:"t",value:null},alpha:{type:"f",value:1}},vertexShader:n(81)+n(795),fragmentShader:c+n(796)}},l=n(239),h=n(196),f=n(350),p=n(94),d=function(t,e){switch(t){case p.a.GL_TEXTURE_CUBE_MAP_POSITIVE_X:e.set(0,-Math.PI/2,0);break;case p.a.GL_TEXTURE_CUBE_MAP_NEGATIVE_X:e.set(0,Math.PI/2,0);break;case p.a.GL_TEXTURE_CUBE_MAP_POSITIVE_Y:e.set(Math.PI/2,Math.PI,0);break;case p.a.GL_TEXTURE_CUBE_MAP_NEGATIVE_Y:e.set(-Math.PI/2,Math.PI,0);break;case p.a.GL_TEXTURE_CUBE_MAP_POSITIVE_Z:e.set(0,-Math.PI,0);break;case p.a.GL_TEXTURE_CUBE_MAP_NEGATIVE_Z:e.set(0,0,0)}},y=function(t,e){var n,r=e.extensions,i=e.getContext();switch(t){case s.fc:return i.REPEAT;case s.r:return i.CLAMP_TO_EDGE;case s.qb:return i.MIRRORED_REPEAT;case s.rb:return i.NEAREST;case s.tb:return i.NEAREST_MIPMAP_NEAREST;case s.sb:return i.NEAREST_MIPMAP_LINEAR;case s.Y:return i.LINEAR;case s.ab:return i.LINEAR_MIPMAP_NEAREST;case s.Z:return i.LINEAR_MIPMAP_LINEAR;case s.Cc:return i.UNSIGNED_BYTE;case s.Ec:return i.UNSIGNED_SHORT_4_4_4_4;case s.Fc:return i.UNSIGNED_SHORT_5_5_5_1;case s.Gc:return i.UNSIGNED_SHORT_5_6_5;case s.n:return i.BYTE;case s.jc:return i.SHORT;case s.Hc:return i.UNSIGNED_SHORT;case s.N:return i.INT;case s.Dc:return i.UNSIGNED_INT;case s.F:return i.FLOAT}if(null!==(n=r.get("OES_texture_half_float"))&&t===s.K)return n.HALF_FLOAT_OES;switch(t){case s.b:return i.ALPHA;case s.Xb:return i.RGB;case s.Rb:return i.RGBA;case s.gb:return i.LUMINANCE;case s.fb:return i.LUMINANCE_ALPHA;case s.a:return i.FUNC_ADD;case s.tc:return i.FUNC_SUBTRACT;case s.gc:return i.FUNC_REVERSE_SUBTRACT;case s.Qc:return i.ZERO;case s.Ab:return i.ONE;case s.sc:return i.SRC_COLOR;case s.Eb:return i.ONE_MINUS_SRC_COLOR;case s.qc:return i.SRC_ALPHA;case s.Db:return i.ONE_MINUS_SRC_ALPHA;case s.x:return i.DST_ALPHA;case s.Bb:return i.ONE_MINUS_DST_ALPHA;case s.y:return i.DST_COLOR;case s.Cb:return i.ONE_MINUS_DST_COLOR;case s.rc:return i.SRC_ALPHA_SATURATE}if(null!==(n=r.get("WEBGL_compressed_texture_s3tc"))){if(t===s.bc)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(t===s.Ub)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(t===s.Vb)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(t===s.Wb)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(null!==(n=r.get("WEBGL_compressed_texture_pvrtc"))){if(t===s.ac)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(t===s.Zb)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(t===s.Tb)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(t===s.Sb)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(null!==(n=r.get("WEBGL_compressed_texture_etc1"))&&t===s.Yb)return n.COMPRESSED_RGB_ETC1_WEBGL;if(null!==(n=r.get("EXT_blend_minmax"))){if(t===s.pb)return n.MIN_EXT;if(t===s.kb)return n.MAX_EXT}return 0},m=function(){function t(t){var e,n,r,i,o,a,c=this;this.threeRenderer=t,this.cachedSize=new s.Ic,this.renderToCubeMap=(a=!1,function(t,u,h,f,p,d,y,m,v,g,b,w,_,x,S,T){a||((n=new s.Fb(-.5,.5,.5,-.5,-200,200)).position.z=150,(e=new s.hc).name="rttCube",e.add(n),r=new s.cc({uniforms:{tDiffuse:{type:"t",value:null},alpha:{type:"f",value:1}},vertexShader:l.a.basicTextured.vertexShader,fragmentShader:l.a.basicTextured.fragmentShader,depthWrite:!1,depthTest:!1,side:s.w}),i=new s.Ib(1,1),(o=new s.lb(i,r)).position.z=0,e.add(o),a=!0);var M=i.getAttribute("uv");M.setUsage(s.z),M.needsUpdate=!0;var E=M.array,P=p/h,O=d/f,A=y/h,D=m/f;E[0]=P,E[1]=O+D,E[2]=P+A,E[3]=O+D,E[4]=P,E[5]=O,E[6]=P+A,E[7]=O;var R=i.getAttribute("position");R.setUsage(s.z),R.needsUpdate=!0;var C=R.array,I=v/u.width-.5,k=g/u.height-.5,L=b/u.width,N=w/u.height;C[0]=I,C[1]=k+N,C[3]=I+L,C[4]=k+N,C[6]=I,C[7]=k,C[9]=I+L,C[10]=k,r.uniforms.tDiffuse.value=t,r.blending=x||s.wb,r.transparent=!!S,null==T&&(T=1),r.uniforms.alpha.value=T,r.needsUpdate=!0,u.viewport.set(0,0,u.width,u.height);var j=c.threeRenderer.getRenderTarget(),B=c.threeRenderer.autoClear,F=c.threeRenderer.xr.enabled;c.threeRenderer.xr.enabled=!1,c.threeRenderer.autoClear=!1,c.threeRenderer.setRenderTarget(u,_),c.threeRenderer.render(e,n),c.threeRenderer.setRenderTarget(j),c.threeRenderer.autoClear=B,c.threeRenderer.xr.enabled=F}),this.copyCubeMap=function(){var t,e,n,r,i,o=!1,a=new s.A,l=c;return function(c,h,f,p,y,m,v,g,b){if(!o){(e=new s.Fb(-1,1,1,-1,0,200)).position.set(0,0,0),(t=new s.hc).name="copyCube",t.add(e),n=new s.cc({uniforms:{tDiffuse:{type:"t",value:null},alpha:{type:"f",value:1}},vertexShader:u.copyCubeMap.vertexShader,fragmentShader:u.copyCubeMap.fragmentShader,depthWrite:!1,depthTest:!1,side:s.w}),r=new s.k(2,2,2),i=new s.lb(r,n),t.add(i),o=!0}var w=l.threeRenderer.getRenderTarget(),_=l.threeRenderer.autoClear,x=l.threeRenderer.xr.enabled;l.threeRenderer.xr.enabled=!1,l.threeRenderer.autoClear=!1;for(var S=0;S<6;S++){d(S,a),i.rotation.copy(a),i.matrixWorldNeedsUpdate=!0,i.updateMatrixWorld(!0),n.uniforms.tDiffuse.value=c,n.blending=v||s.wb,n.transparent=!!g,null==b&&(b=1),n.uniforms.alpha.value=b,n.needsUpdate=!0,h.viewport.set(0,0,y,m),l.threeRenderer.setRenderTarget(h,S),l.threeRenderer.render(t,e)}l.threeRenderer.setRenderTarget(w),l.threeRenderer.autoClear=_,l.threeRenderer.xr.enabled=x}}();try{var p=this.threeRenderer.getContext();this._maxCubemapSize=p.getParameter(p.MAX_CUBE_MAP_TEXTURE_SIZE),this._maxTextureSize=p.getParameter(p.MAX_TEXTURE_SIZE),this._gpuInfo=Object(f.a)(p)}catch(t){throw new h.b("Unable to create a WebGL rendering context")}}return Object.defineProperty(t.prototype,"renderer",{get:function(){return this.threeRenderer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxCubemapSize",{get:function(){return this._maxCubemapSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxTextureSize",{get:function(){return this._maxTextureSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"gpuInfo",{get:function(){return this._gpuInfo},enumerable:!0,configurable:!0}),t.prototype.getSize=function(){return this.threeRenderer.getSize(this.cachedSize)},t.prototype.getPixelRatio=function(){return this.threeRenderer.getPixelRatio()},t.prototype.dispose=function(){this.threeRenderer.dispose()},t.prototype.initSizedTexture2D=function(t,e){var n=this.threeRenderer.getContext(),r=this.threeRenderer.state;(e=e||new s.vc).addEventListener("dispose",(function(){return n.deleteTexture(a.__webglTexture)}));var i=y(e.format,this.threeRenderer),o=y(e.type,this.threeRenderer),a=this.threeRenderer.properties.get(e),c=n.createTexture();r.bindTexture(n.TEXTURE_2D,c),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,e.flipY),n.texImage2D(n.TEXTURE_2D,0,i,t,t,0,i,o,null);var u=y(e.wrapS,this.threeRenderer),l=y(e.wrapT,this.threeRenderer);return n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,u),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,l),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,y(e.magFilter,this.threeRenderer)),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,y(e.minFilter,this.threeRenderer)),e.generateMipmaps&&n.generateMipmap(n.TEXTURE_2D),r.bindTexture(n.TEXTURE_2D,null),a.__webglTexture=c,e},t.prototype.initSizedCubeMap=function(t,e){var n=this.threeRenderer.getContext(),r=this.threeRenderer.state,i=new s.t([null,null,null,null,null,null]);i.flipY=!1,i.generateMipmaps=e;var o=y(i.format,this.threeRenderer),a=y(i.type,this.threeRenderer),c=this.threeRenderer.properties.get(i),u=n.createTexture();r.bindTexture(n.TEXTURE_CUBE_MAP,u),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,i.flipY);for(var l=0;l<6;l++)n.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+l,0,o,t,t,0,o,a,null);return e?(i.magFilter=s.Y,i.minFilter=s.Z,n.texParameteri(n.TEXTURE_CUBE_MAP,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_CUBE_MAP,n.TEXTURE_MIN_FILTER,n.LINEAR_MIPMAP_LINEAR),n.generateMipmap(n.TEXTURE_CUBE_MAP)):(i.magFilter=s.Y,i.minFilter=s.Y,n.texParameteri(n.TEXTURE_CUBE_MAP,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_CUBE_MAP,n.TEXTURE_MIN_FILTER,n.LINEAR)),r.bindTexture(n.TEXTURE_CUBE_MAP,null),c.__image__webglTextureCube=u,i},t.prototype.initRenderTargetCube=function(t){return new s.Mc(t,{stencilBuffer:!1,depthBuffer:!1,generateMipmaps:!1})},t.prototype.deallocateCubeTexture=function(t){var e=this.threeRenderer.getContext(),n=this.threeRenderer.properties.get(t);e.deleteTexture(n.__image__webglTextureCube)},t.prototype.uploadTexture2D=function(t,e,n,r){var i=this.threeRenderer.getContext(),o=this.threeRenderer.state,a=i.getParameter(i.TEXTURE_BINDING_2D),s=this.threeRenderer.properties.get(e);o.bindTexture(i.TEXTURE_2D,s.__webglTexture),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,e.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,e.unpackAlignment),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,y(e.wrapS,this.threeRenderer)),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,y(e.wrapT,this.threeRenderer)),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,y(e.magFilter,this.threeRenderer)),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,y(e.minFilter,this.threeRenderer));var c=y(e.format,this.threeRenderer),u=y(e.type,this.threeRenderer);i.texSubImage2D(i.TEXTURE_2D,0,n,r,c,u,t),e.generateMipmaps&&i.generateMipmap(i.TEXTURE_2D),o.bindTexture(i.TEXTURE_2D,a)},t}(),v=n(18),g=n(212),b=n(88),w=n(307),_=n(2),x=n(42),S=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),T=function(t){function e(e){var n=t.call(this,new s.Ib(2,2,1,1),new s.cc({uniforms:s.Bc.clone(l.a.screenSpaceColored.uniforms),vertexShader:l.a.screenSpaceColored.vertexShader,fragmentShader:l.a.screenSpaceColored.fragmentShader,transparent:!0,depthTest:!1,depthWrite:!1}))||this;return n._opacity=1,n.material.uniforms.color.value=new s.s(e),n.renderOrder=x.a.colorOverlay,n.name="ScreenOverlayMesh",n}return S(e,t),Object.defineProperty(e.prototype,"opacity",{get:function(){return this._opacity},set:function(t){this.visible=t>0,this._opacity=t,this.material.uniforms.opacity.value=t},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.material.dispose(),this.geometry.dispose()},e}(s.lb),M=function(){function t(t,e){this.scene=t,this.cameraData=e}return t.prototype.init=function(){this.blackoutOverlayMesh=new T(0)},t.prototype.dispose=function(){this.blackoutOverlayMesh.dispose()},t.prototype.render=function(t){this.blackoutOverlayMesh.opacity=this.cameraData.transition.blackoutProgress.value},t.prototype.activate=function(t){this.scene.addChild(this.scene.ids.CameraRig,this.blackoutOverlayMesh)},t.prototype.deactivate=function(t){this.scene.removeChild(this.scene.ids.CameraRig,this.blackoutOverlayMesh)},t}();n.d(e,"MAX_RESOLUTION",(function(){return D}));var E=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),P=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},O=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},A=new _.a("webgl-renderer"),D=3686400,R=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="webgl-renderer",e.contextLostError=null,e.setContextLostError=function(t){e.contextLostError=t},e.getPixelRatioFor=function(t,e){var n=window.devicePixelRatio||1;return t*e*n<=D?n:1},e}return E(e,t),e.prototype.init=function(t,e){return P(this,void 0,void 0,(function(){var n,r,i,c,u=this;return O(this,(function(l){switch(l.label){case 0:if(!("WebGLRenderingContext"in window))throw new h.c("WebGL not supported");this.canvas=t.canvas,this.engine=e;try{(n=new s.Oc({canvas:this.canvas,antialias:t.antialias,alpha:!0})).autoClear=!1,n.xr.enabled=!0}catch(t){throw new h.b("Unable to create a WebGL rendering context")}return this._cwfRenderer=new m(n),r=this,[4,e.market.waitForData(v.a)];case 1:return r.cameraData=l.sent(),(i=new s.hc).name="main",this.scene=new a.b(i,n,this.cameraData),e.addComponent(this,this.scene),e.addComponent(this,new M(this.scene,this.cameraData)),[4,e.market.waitForData(o.a)];case 2:return c=l.sent(),this.setSize(c.width,c.height),this.bindings.push(e.subscribe(g.a,(function(t){return u.setSize(t.width,t.height)}))),this.canvas.addEventListener("webglcontextlost",this.setContextLostError),[2]}}))}))},e.prototype.dispose=function(e){t.prototype.dispose.call(this,e),this.canvas.removeEventListener("webglcontextlost",this.setContextLostError)},e.prototype.onUpdate=function(t){if(this.contextLostError)throw new h.a("WebGL context lost: "+(this.contextLostError.statusMessage||"no status given"))},Object.defineProperty(e.prototype,"gpuInfo",{get:function(){return this._cwfRenderer.gpuInfo},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxCubemapSize",{get:function(){return this._cwfRenderer.maxCubemapSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxTextureSize",{get:function(){return this._cwfRenderer.maxTextureSize},enumerable:!0,configurable:!0}),e.prototype.getScene=function(){return this.scene},e.prototype.getCamera=function(){return this.scene.camera},Object.defineProperty(e.prototype,"cwfRenderer",{get:function(){return this._cwfRenderer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textureManager",{get:function(){return this._cwfRenderer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"threeRenderer",{get:function(){return this.cwfRenderer.renderer},enumerable:!0,configurable:!0}),e.prototype.renderOnce=function(){return P(this,void 0,void 0,(function(){var t=this;return O(this,(function(e){return this.scene.startRender(!0),[2,this.engine.after(b.a.Render).then((function(){return t.scene.startRender(!1)}))]}))}))},e.prototype.startRender=function(t){void 0===t&&(t=!0),this.scene.startRender(t),this.engine.broadcast(new w.a(this.cwfRenderer.getPixelRatio()))},e.prototype.setSize=function(t,e){var n=this.getPixelRatioFor(t,e);n!==this.cwfRenderer.getPixelRatio()&&(A.debug("Setting pixel ratio to "+n),this.engine.broadcast(new w.a(n))),this.threeRenderer.xr.isPresenting&&A.error("setting size while in xr is a no no, it resets the viewport",t,e),this.threeRenderer.setPixelRatio(n),this.threeRenderer.setSize(t,e,!1),this.scene.setCameraDirty()},e}(i.a);e.default=R},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r,i=n(23),o=n(84),a=n(6),s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="settings",e.properties=Object(o.b)(),e}return s(e,t),e.prototype.clone=function(){var t=new e;return t.copy(this),t},e.prototype.copy=function(t){var e,n,r=t.properties;try{for(var i=c(r.keys),o=i.next();!o.done;o=i.next()){var a=o.value,s=r.get(a);s&&"function"==typeof s.clone?this.setProperty(a,s.clone()):this.setProperty(a,s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}},e.prototype.setProperty=function(t,e){var n=this.properties.get(t);null!=e&&n===e||(this.properties.set(t,e),this.commit([t]))},e.prototype.notifyPropertyObserver=function(t,e){t(this.properties.get(e))},e.prototype.setLocalStorageProperty=function(t,e){Object(a.w)(t,e),this.setProperty(t,e)},e.prototype.hasProperty=function(t){return this.properties.has(t)},e.prototype.tryGetProperty=function(t,e){return this.hasProperty(t)?this.properties.get(t):e},e.prototype.getProperty=function(t){if(this.hasProperty(t))return this.properties.get(t);throw new Error("SettingsData: "+t+" not found")},e.prototype.checkUrlParam=function(t,e,n){void 0===n&&(n=0);var r=this.tryGetProperty(t,n);return"number"==typeof r?r===e:parseInt(r,10)===e},e.prototype.iterate=function(t){var e,n;try{for(var r=c(this.properties.keys),i=r.next();!i.done;i=r.next()){var o=i.value;t(o,this.getProperty(o))}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},e}(i.a)},function(t,e,n){"use strict";var r,i;n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return o})),n.d(e,"d",(function(){return a})),function(t){t[t.PRIMARY=0]="PRIMARY",t[t.MIDDLE=1]="MIDDLE",t[t.SECONDARY=2]="SECONDARY",t[t.BACK=3]="BACK",t[t.FORWARD=4]="FORWARD",t[t.COUNT=5]="COUNT"}(r||(r={})),function(t){t[t.NONE=0]="NONE",t[t.PRIMARY=1]="PRIMARY",t[t.SECONDARY=4]="SECONDARY",t[t.MIDDLE=2]="MIDDLE",t[t.BACK=8]="BACK",t[t.FORWARD=16]="FORWARD",t[t.ALL=31]="ALL"}(i||(i={}));var o=function(t){var e=i[r[t]];return"number"==typeof e?e:void 0},a=function(t){var e=r[i[t]];return"number"==typeof e?e:void 0}},function(t,e,n){"use strict";n.d(e,"n",(function(){return U})),n.d(e,"b",(function(){return z})),n.d(e,"c",(function(){return G})),n.d(e,"d",(function(){return H})),n.d(e,"i",(function(){return V})),n.d(e,"l",(function(){return W})),n.d(e,"j",(function(){return q})),n.d(e,"k",(function(){return Y})),n.d(e,"h",(function(){return J})),n.d(e,"f",(function(){return X})),n.d(e,"r",(function(){return K})),n.d(e,"q",(function(){return Q})),n.d(e,"g",(function(){return Z})),n.d(e,"o",(function(){return $})),n.d(e,"a",(function(){return tt})),n.d(e,"m",(function(){return et})),n.d(e,"e",(function(){return nt})),n.d(e,"p",(function(){return rt}));var r,i,o,a,s,c,u,l,h,f,p,d,y,m,v,g,b,w,_,x,S,T,M,E,P,O,A,D,R,C,I,k=n(0),L=n(68),N=n(3),j=n(274),B=n(61),F=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},U=function(t){return 1===t.elements[15]},z=(r=new k.zb,i=new k.Jc,function(t,e){if(e.intersectBox(t,i),!i)return null;var n=new k.Jc;return Object(j.a)(i.x,t.max.x,B.a.epsilon)?n.x=-1:Object(j.a)(i.x,t.min.x,B.a.epsilon)?n.x=1:Object(j.a)(i.y,t.max.y,B.a.epsilon)?n.y=-1:Object(j.a)(i.y,t.min.y,B.a.epsilon)?n.y=1:Object(j.a)(i.z,t.max.z,B.a.epsilon)?n.z=-1:n.z=1,t.containsPoint(e.origin)||n.multiplyScalar(-1),{distance:e.origin.distanceTo(i),point:i,object:r,face:{normal:n}}}),G=(o=new k.Jc,function(t,e,n,r){return o.copy(t).sub(e),o.clampLength(n,r),e.clone().add(o)}),H=function(){var t=new k.Jc;return function(e,n,r,i){t.copy(n).sub(e);var o=Math.atan2(Math.sqrt(Math.pow(t.x,2)+Math.pow(t.z,2)),t.y),a=Math.min(Math.max(r,o),i);return Math.abs(o-a)>Number.EPSILON?V(e,n,o-a,!1):e}}(),V=function(){var t=new k.Jc,e=new k.Jc;return function(n,r,i,o){return t.copy(r).sub(n),o?e.copy(N.b.UP):e.copy(t).applyAxisAngle(N.b.UP,-1*Math.PI/2).setY(0).normalize(),t.applyAxisAngle(e,i),r.clone().sub(t)}}(),W=(a=new k.Jc,s=new k.Jc,function(t,e,n){return a.copy(t).sub(e).normalize(),s.copy(t).sub(n).normalize(),(new k.Pb).setFromUnitVectors(a,s)}),q=(c=new L.a,function(t,e){return c.setPosition(t),c.lookAt(t,e,N.b.UP),(new k.Pb).setFromRotationMatrix(c.asThreeMatrix4())}),Y=(u=new k.Jc,function(t,e,n){return u.copy(N.b.FORWARD).applyQuaternion(t).normalize(),u.clone().multiplyScalar(-1*n).add(e)}),J=(l=new k.dc,h=new k.Jc,f=new k.Jc,function(t,e,n){return f.set(0,0,0),h.copy(N.b.FORWARD).applyQuaternion(e),l.set(t,h),l.intersectPlane(n,f)}),X=(p=new k.Jc,d=new k.Jc,y=new k.Jc,m=new k.Jc,v=[new k.Jc,new k.Jc,new k.Jc,new k.Jc,new k.Jc,new k.Jc,new k.Jc,new k.Jc],g=new k.Jc,b=new k.Jc,w=new k.Jc,_=new k.Jc,x=new k.Hb,S=new k.Jc,T=new k.dc,M=new k.Jc,E=new k.Jc,function(t,e,n,r,i,o){p.copy(N.b.FORWARD).applyQuaternion(e).setY(0),d.copy(p).setY(n).normalize(),m.copy(d).applyAxisAngle(N.b.UP,-Math.PI/2).setY(0).normalize(),y.copy(m).cross(d).normalize();for(var a=0,s=r.max,c=r.min,u=[s,c],l=0;l<2;l++)for(var h=u[l].x,f=0;f<2;f++)for(var P=u[f].y,O=0;O<2;O++){var A=u[O].z;v[a].set(h,P,A),a++}g.copy(c),w.copy(t).setY(c.y);var D=b.copy(g).sub(w).dot(d);v.forEach((function(t){if(t.y!==s.y){var e=b.copy(t).sub(w).dot(d);e<D&&(g.copy(t),D=e)}}));var R=Math.sign(g.dot(m));_.copy(g).setX(g.x===s.x?c.x:s.x),Math.sign(_.dot(m))!==R?x.set(S.set(0,0,-1*Math.sign(g.z)),Math.abs(g.z)):(_.copy(g).setZ(g.z===s.z?c.z:s.z),x.set(S.set(-1*Math.sign(g.x),0,0),Math.abs(g.x))),T.set(t,M.copy(d).multiplyScalar(-1)),T.intersectPlane(x,E);var C=Math.min(Math.abs(E&&E.dot(d)),D),I=0,k=0;v.forEach((function(e){b.copy(e).sub(t);var n=Math.abs(b.dot(m)),r=Math.abs(b.dot(y));n>I&&(I=n),r>k&&(k=r)}));var L=I/Math.tan(i*o/2),j=k/Math.tan(i/2),B=Math.max(L,j)+Math.abs(C),F=t.clone().add(d.clone().multiplyScalar(1.1*-B));return{position:F,rotation:q(F,t)}}),K=(P=new k.jb,function(){var t=new k.jb,e=new k.Kc;return function(n,r,i,o,a){return a=a||new k.Ic,t.makeRotationFromQuaternion(i).setPosition(r),t.getInverse(t),t.premultiply(o.asThreeMatrix4()),e.x=n.x,e.y=n.y,e.z=n.z,e.w=1,e.applyMatrix4(t),e.x/=e.w,e.y/=e.w,e.z/=e.w,e.w=1,a.x=e.x,a.y=e.y,a}}()),Q=(O=new k.Jc,function(t,e,n){void 0===n&&(n=N.b.UP);var r=t.angleTo(e);return Math.sign(O.crossVectors(t,e).dot(n))*r}),Z=(A=new L.a,D=new k.Jc,function(t,e,n,r){return r=r||new L.a,t.parent?t.parent.getWorldPosition(D):t.getWorldPosition(D),r.lookAt(e,D,n),t.parent&&r.premultiply(A.getInverse(t.parent.matrixWorld)),r.extractRotation(r),r}),$=function(t){return!!t&&1===t.elements[15]},tt=function(t,e,n,r,i){void 0===i&&(i=1.5);var o=1/t.elements[5];if($(t))return i*r/(2*o);var a=e.distanceTo(n),s=Math.atan(o);return r*(i/(2*Math.tan(s)*a))},et=(R=new k.Jc,C=new k.jb,function(t,e,n){var r=R.set(0,0,-t).applyMatrix4(e).z;return R.set(2/n,0,r).applyMatrix4(C.getInverse(e)),R.x}),nt=function(t){return 1/t.elements[5]},rt=(I=new k.Jc,function(t,e,n){var r=n.angleTo(N.b.UP),i=Math.abs(r-Math.PI);return r<.2||i<.2?(t.quaternion.setFromUnitVectors(N.b.FORWARD,n),!0):(t.lookAt(I.copy(e).add(n)),!1)});!function(){var t=new k.Jc,e=new k.Jc(1e4,1e4,1e4),n=[new k.U,new k.U,new k.U,new k.U],r=[new k.Jc,new k.Jc,new k.Jc,new k.Jc]}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=function(){function t(t){this.matcher=t}return t.isValue=function(e){return new t(new i(e))},t.isType=function(e){return new t(new o(e))},t.isInstanceOf=function(e){return new t(new a(e))},t.is=function(e){return new t(new s(e))},t.isAny=function(){return new t(new c)},t.prototype.compare=function(t){return this.matcher.matches(t)},t}(),i=function(){function t(t){this.value=t}return t.prototype.matches=function(t){return this.value===t},t}(),o=function(){function t(t){this.type=t}return t.prototype.matches=function(t){return Object.getPrototypeOf(t).constructor===this.type},t}(),a=function(){function t(t){this.type=t}return t.prototype.matches=function(t){if("object"==typeof t)return t instanceof this.type;var e=this.type;switch(typeof t){case"number":return e===Number;case"string":return e===String;case"boolean":return e===Boolean;case"function":return e===Function}return!1},t}(),s=function(){function t(t){this.predicate=t}return t.prototype.matches=function(t){return this.predicate(t)},t}(),c=function(){function t(){}return t.prototype.matches=function(){return!0},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"e",(function(){return o})),n.d(e,"c",(function(){return a})),n.d(e,"b",(function(){return s})),n.d(e,"d",(function(){return c}));var r=function(t){return"propertyObservers"===t||"changeObservers"===t||"isObservable"===t||"childChangeFunctions"===t||"isObservableProxy"===t||"diffRoot"===t||"elementChangedHandlers"===t||"knownKeysMap"===t||"knownKeysList"===t||"isVector2"===t||"isVector3"===t||"isQuaternion"===t||"onPropertyChanged"===t||"removeOnPropertyChanged"===t||"onChanged"===t||"target"===t},i=function(t,e){if(void 0===e&&(e=[]),void 0!==t){if(t in e)return{};if(t instanceof Date)return new Date(t);if(null===t)return null;if(t.deepCopy)return t.deepCopy();if(t.isQuaternion)return{x:t.x,y:t.y,z:t.z,w:t.w};if("object"==typeof t){var n=Array.isArray(t)||ArrayBuffer.isView(t)?[]:{};for(var o in t)if(!r(o)){var a=t[o];a instanceof Date?n[o]=new Date(a):"function"!=typeof a&&(n[o]="object"==typeof a?i(a,e.concat(t)):a)}return n}return t}},o=function(t,e){for(var n in e)if("function"!=typeof e[n]&&(!r(n)||t.hasOwnProperty(n))){var a=e[n];if(t.hasOwnProperty(n)){var s=t[n];(null===s?null:typeof s)!==(null===a?null:typeof a)?t[n]=i(a):"object"==typeof s?s instanceof Date?t[n]=new Date(a):o(s,a):t[n]=a}else t[n]=i(a)}},a=function(t,e){var n={};for(var r in t){var i=t[r],o=e[r];s(i,o)&&(void 0===i||void 0===o?n[r]=o:typeof i!=typeof o?n[r]=o:"object"!=typeof i?n[r]=o:Array.isArray(o)?s(i,o)&&(n[r]=o):n[r]=a(i,o))}for(var r in e)r in t||(n[r]=e[r]);return n},s=function(t,e){if("object"!=typeof t)return t!==e;if(!e)return!0;for(var n in e)if(!(n in t))return!0;for(var n in t)if(s(t[n],e[n]))return!0;return!1};function c(t){return"number"==typeof t}},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(73),a=n(344),s=n(27),c=n(45),u=new(n(2).a)("passive-support"),l=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});return window.addEventListener("testPassive",(function(){}),e),window.removeEventListener("testPassive",(function(){}),e),t}catch(t){return u.warn("Passive Option for addEventListener is not supported, Safari zoom may not perform as expected: "+t),!1}}(),h=n(20),f=n(6),p=function(){function t(e,n,r,i){var o=this;if(this.config=e,this.canvasData=r,this.handledTouchesAsPointer=0,this.lastTouchEnd=0,this.activeButtons=s.b.NONE,this.preventDoubleTap=function(e){e.cancelable&&e.timeStamp-o.lastTouchEnd<=t.doubleTapThreshold&&e.preventDefault(),o.lastTouchEnd=e.timeStamp},this.preventMultiTouchGesture=function(t){var e=t.touches&&t.touches.length>1,n="scale"in t&&1!==t.scale;(e||n)&&t.cancelable&&t.preventDefault()},this.onEventCallback=i,window.PointerEvent||(n.addEventListener("mousedown",(function(t){return o.onMouseDown(t)})),n.addEventListener("mouseup",(function(t){return o.onMouseUp(t)})),n.addEventListener("mousemove",(function(t){return o.onMouseMove(t)})),n.addEventListener("mouseenter",(function(t){return o.onMouseEnter(t)}))),n.addEventListener("contextmenu",(function(t){return t.preventDefault()})),n.addEventListener("touchstart",(function(t){return o.onTouchStart(t)})),n.addEventListener("touchend",(function(t){return o.onTouchEnd(t)})),n.addEventListener("touchmove",(function(t){return o.onTouchMove(t)})),n.addEventListener("touchcancel",(function(t){return o.onTouchEnd(t)})),n.addEventListener("pointerdown",(function(t){return o.onPointerDown(t)})),n.addEventListener("pointerup",(function(t){return o.onPointerUp(t)})),n.addEventListener("pointermove",(function(t){return o.onPointerMove(t)})),n.addEventListener("pointercancel",(function(t){return o.onPointerUp(t)})),n.addEventListener("pointerenter",(function(t){return o.onMouseEnter(t)})),Object(f.k)()||Object(f.r)()){var a=!!l&&{passive:!1};document.addEventListener("touchmove",this.preventMultiTouchGesture,a),document.addEventListener("touchend",this.preventDoubleTap,a)}}return t.prototype.onMouseDown=function(t){t.currentTarget.focus(),this.tryPreventDefault(t),this.activeButtons|=1<<t.button,this.onEventCallback(new c.a(this.getPointerId(t),this.getPointerPosition(t),t.button,!0,c.b.MOUSE))},t.prototype.onMouseUp=function(t){this.tryPreventDefault(t),this.activeButtons&=~(1<<t.button),this.onEventCallback(new c.a(this.getPointerId(t),this.getPointerPosition(t),t.button,!1,c.b.MOUSE))},t.prototype.onMouseMove=function(t){this.tryPreventDefault(t),this.onEventCallback(new c.c(this.getPointerId(t),this.getPointerPosition(t),this.activeButtons,c.b.MOUSE))},t.prototype.onMouseEnter=function(t){for(var e=Object(h.n)(t.buttons,s.a.MIDDLE,s.a.SECONDARY),n=(this.activeButtons^e)&~e,r=s.a.PRIMARY;r<s.a.COUNT;++r){var i=Object(s.c)(r);i&&(n&i)>0&&this.onEventCallback(new c.a(this.getPointerId(t),this.getPointerPosition(t),r,!1,c.b.MOUSE))}this.activeButtons=e},t.prototype.onTouchStart=function(t){if(t.currentTarget.focus(),t.cancelable&&t.preventDefault(),this.handledTouchesAsPointer)--this.handledTouchesAsPointer;else for(var e=0;e<t.changedTouches.length;e++){var n=t.changedTouches.item(e),r=this.getTouchPosition(n);this.onEventCallback(new c.a(n.identifier,r,s.a.PRIMARY,!0,c.b.TOUCH))}},t.prototype.onTouchEnd=function(t){if(t.cancelable&&t.preventDefault(),this.handledTouchesAsPointer)--this.handledTouchesAsPointer;else for(var e=0;e<t.changedTouches.length;e++){var n=t.changedTouches.item(e),r=this.getTouchPosition(n);this.onEventCallback(new c.a(n.identifier,r,s.a.PRIMARY,!1,c.b.TOUCH))}},t.prototype.onTouchMove=function(t){if(t.cancelable&&t.preventDefault(),this.handledTouchesAsPointer)--this.handledTouchesAsPointer;else for(var e=0;e<t.changedTouches.length;e++){var n=t.changedTouches.item(e),r=this.getTouchPosition(n);this.onEventCallback(new c.c(n.identifier,r,s.b.PRIMARY,c.b.TOUCH))}},t.prototype.onPointerDown=function(t){switch(this.tryPreventDefault(t),t.pointerType){case c.b.MOUSE:this.onMouseDown(t);break;case c.b.GAMEPAD:case c.b.TOUCH:++this.handledTouchesAsPointer,this.onEventCallback(new c.a(t.pointerId,this.getPointerPosition(t),s.a.PRIMARY,!0,t.pointerType))}},t.prototype.onPointerUp=function(t){switch(this.tryPreventDefault(t),t.pointerType){case c.b.MOUSE:this.onMouseUp(t);break;case c.b.GAMEPAD:case c.b.TOUCH:++this.handledTouchesAsPointer,this.onEventCallback(new c.a(t.pointerId,this.getPointerPosition(t),s.a.PRIMARY,!1,t.pointerType))}},t.prototype.onPointerMove=function(t){switch(this.tryPreventDefault(t),t.pointerType){case c.b.MOUSE:-1!==t.button?this.activeButtons<t.buttons?this.onMouseDown(t):this.activeButtons>t.buttons&&this.onMouseUp(t):this.onMouseMove(t);break;case c.b.GAMEPAD:case c.b.TOUCH:++this.handledTouchesAsPointer,this.onEventCallback(new c.c(t.pointerId,this.getPointerPosition(t),s.b.PRIMARY,t.pointerType))}},t.prototype.getPointerId=function(t){return Object(a.a)(t)?t.pointerId:0},t.prototype.getPointerPosition=function(t){return this.normalizePosition(t.clientX,t.clientY)},t.prototype.getTouchPosition=function(t){return this.normalizePosition(t.clientX,t.clientY)},t.prototype.normalizePosition=function(t,e){return{x:2*(t-this.canvasData.x)/this.canvasData.width-1,y:-2*(e-this.canvasData.y)/this.canvasData.height+1}},t.prototype.tryPreventDefault=function(t){this.config.pointerPreventDefault&&t.cancelable&&t.preventDefault()},t.doubleTapThreshold=300,t}(),d=n(16),y=n(77),m=n(130);!function(t){t[t.SEMICOLON=59]="SEMICOLON",t[t.PLUSEQUALS=61]="PLUSEQUALS",t[t.DASHUNDERSCORE=173]="DASHUNDERSCORE"}(r||(r={}));var v,g=function(){function t(t){this.keysDown={},this.onEventCallback=t,this.bindHandlers()}return t.prototype.bindHandlers=function(){var t=this;if(window&&window.document){var e=window.document;window.addEventListener("blur",(function(){Object.keys(t.keysDown).forEach((function(e){return t.keysDown[e]=!1}))})),e.addEventListener("keydown",(function(e){if(!e.ctrlKey&&!e.metaKey){e.preventDefault();var n=t.translateFirefoxKeys(e.which||e.keyCode);t.keysDown[n]=!0,t.onEventCallback(new m.a(n,y.a.DOWN,e))}})),e.addEventListener("keyup",(function(e){if(!e.ctrlKey&&!e.metaKey){e.preventDefault();var n=t.translateFirefoxKeys(e.which||e.keyCode);t.keysDown[n]&&t.onEventCallback(new m.a(n,y.a.PRESSED,e)),t.keysDown[n]=!1,t.onEventCallback(new m.a(n,y.a.UP,e))}}))}},t.prototype.translateFirefoxKeys=function(t){switch(t){case r.SEMICOLON:return d.a.SEMICOLON;case r.PLUSEQUALS:return d.a.PLUSEQUALS;case r.DASHUNDERSCORE:return d.a.DASHUNDERSCORE}return t},t}(),b=n(0);!function(t){t[t.WAITING=0]="WAITING",t[t.WAITINGTOEXCEEDTHRESHOLD=1]="WAITINGTOEXCEEDTHRESHOLD",t[t.GESTURING=2]="GESTURING"}(v||(v={}));var w,_=n(208),x=function(){function t(t,e){void 0===t&&(t=.04),void 0===e&&(e=300),this.startPosition=new b.Ic,this.pointerDelta=new b.Ic,this.activeButtons=s.b.NONE,this.state=v.WAITING,this.dragLimit=t,this.holdLimit=e}return t.prototype.start=function(t){if(this.state===v.WAITING&&this.startPosition.copy(t.position),0==(t.buttons&t.buttons-1))this.startTime=Date.now(),this.activeButtons=t.buttons,this.state=v.WAITINGTOEXCEEDTHRESHOLD;else if(this.activeButtons)return this.state=v.GESTURING,new _.a(t.position,this.activeButtons)},t.prototype.stop=function(){var t;return this.state===v.WAITINGTOEXCEEDTHRESHOLD&&Date.now()-this.startTime<this.holdLimit&&(t=new _.b(this.startPosition.add(this.pointerDelta),Object(s.d)(this.activeButtons)),this.pointerDelta.set(0,0)),this.state=v.WAITING,t},t.prototype.onMove=function(t){if(this.state===v.WAITINGTOEXCEEDTHRESHOLD&&(this.pointerDelta.copy(t.position).sub(this.startPosition),this.pointerDelta.length()>this.dragLimit))return this.state=v.GESTURING,new _.a(t.position,t.buttons)},t.prototype.compareState=function(t){return t===this.state},t}(),S=n(187),T=function(){function t(t){void 0===t&&(t=.04),this.startPosition=new b.Ic,this.previousPosition=new b.Ic,this.pointerDelta=new b.Ic,this.lastPointerMove=Date.now(),this.state=v.WAITING,this.threshold=t}return t.prototype.start=function(t){return this.state===v.WAITING&&(this.startPosition.copy(t.position),this.previousPosition.copy(this.startPosition),this.state=v.WAITINGTOEXCEEDTHRESHOLD),new S.a(t.position,t.buttons)},t.prototype.stop=function(){this.state===v.WAITING&&this.pointerDelta.set(0,0),this.state=v.WAITING;var t=Date.now()-this.lastPointerMove,e=(new b.Ic).copy(this.previousPosition).sub(this.startPosition);return new S.b(this.previousPosition,this.pointerDelta,s.b.NONE,t,e)},t.prototype.onMove=function(t){var e;return this.state===v.WAITINGTOEXCEEDTHRESHOLD&&(this.pointerDelta.copy(t.position).sub(this.startPosition),this.pointerDelta.length()>this.threshold&&(this.state=v.GESTURING)),this.state===v.GESTURING&&(this.pointerDelta.copy(t.position).sub(this.previousPosition),this.pointerDelta.length()>0&&(e=new S.c(this.previousPosition,this.pointerDelta,t.buttons))),this.previousPosition.copy(t.position),this.lastPointerMove=Date.now(),e},t.prototype.compareState=function(t){return t===this.state},t.prototype.compareStartPoint=function(t){return t.equals(this.startPosition)},t.prototype.compareDelta=function(t){return t.equals(this.pointerDelta)},t}(),M=n(255),E=2*Math.SQRT2,P=function(){function t(t){void 0===t&&(t=.04),this.threshold=t,this.startDistance=0,this.previousDistance=0,this.pointerDelta=new b.Ic,this.lastPointerMove=Date.now(),this.pinchDelta=0,this.state=v.WAITING}return t.prototype.start=function(t,e){this.state===v.WAITING&&(this.state=v.WAITINGTOEXCEEDTHRESHOLD,this.startDistance=t.position.distanceTo(e.position)/E,this.previousDistance=this.startDistance)},t.prototype.stop=function(){this.state=v.WAITING;var t=Date.now()-this.lastPointerMove;return new M.a(this.pinchDelta,t)},t.prototype.onMove=function(t,e){this.pointerDelta.copy(t.position).sub(e.position);var n,r=this.pointerDelta.length()/E;if(this.state===v.WAITINGTOEXCEEDTHRESHOLD){var i=r-this.startDistance;Math.abs(i)>this.threshold&&(this.state=v.GESTURING)}if(this.state===v.GESTURING){i=r-this.previousDistance;Math.abs(i)>0&&(this.pinchDelta=i,n=new M.b(i))}return this.previousDistance=r,this.lastPointerMove=Date.now(),n},t}(),O=n(7),A=n(256),D=function(){function t(t){void 0===t&&(t=.1),this.startPointerDelta=new b.Ic,this.previousPointerDelta=new b.Ic,this.pointerDelta=new b.Ic,this.lastPointerMove=Date.now(),this.angleWithDirection=0,this.state=v.WAITING,this.threshold=t}return t.prototype.start=function(t,e){this.state===v.WAITING&&(this.state=v.WAITINGTOEXCEEDTHRESHOLD,this.startPointerDelta.copy(t.position).sub(e.position).normalize(),this.pointerDelta.copy(this.startPointerDelta),this.previousPointerDelta.copy(this.pointerDelta))},t.prototype.stop=function(){this.state=v.WAITING;var t=Date.now()-this.lastPointerMove;return new A.a(this.angleWithDirection,t)},t.prototype.onMove=function(t,e){var n,r;(this.pointerDelta.copy(t.position).sub(e.position).normalize(),this.state===v.WAITINGTOEXCEEDTHRESHOLD)&&((r=Math.acos(Object(O.e)(this.pointerDelta.dot(this.startPointerDelta),-1,1)))>this.threshold&&(this.state=v.GESTURING));if(this.state===v.GESTURING&&(r=Math.acos(Object(O.e)(this.pointerDelta.dot(this.previousPointerDelta),-1,1)))>0){var i=this.previousPointerDelta.x*this.pointerDelta.y-this.previousPointerDelta.y*this.pointerDelta.x;this.angleWithDirection=i>=0?r:-r,n=new A.b(this.angleWithDirection)}return this.previousPointerDelta.copy(this.pointerDelta),this.lastPointerMove=Date.now(),n},t.prototype.compareState=function(t){return t===this.state},t}(),R=n(257),C=function(){function t(t){void 0===t&&(t=.04),this.startEpicenter=new b.Ic,this.previousEpicenter=new b.Ic,this.deltaEpicenter=new b.Ic,this.currentEpicenter=new b.Ic,this.pointerCount=0,this.lastPointerMove=Date.now(),this.state=v.WAITING,this.threshold=t}return t.prototype.start=function(t){this.state===v.WAITING&&(Object(h.a)(this.getPointerPositions(t),this.startEpicenter),this.previousEpicenter.copy(this.startEpicenter),this.currentEpicenter.copy(this.previousEpicenter),this.state=v.WAITINGTOEXCEEDTHRESHOLD,this.pointerCount=t.length)},t.prototype.stop=function(){this.state=v.WAITING;var t=this.pointerCount;this.pointerCount=0;var e=Date.now()-this.lastPointerMove;return new R.a(t,this.currentEpicenter,this.deltaEpicenter,e)},t.prototype.onMove=function(t){var e;(Object(h.a)(this.getPointerPositions(t),this.currentEpicenter),this.state===v.WAITINGTOEXCEEDTHRESHOLD)&&(this.currentEpicenter.distanceTo(this.startEpicenter)>this.threshold&&(this.state=v.GESTURING));return this.state===v.GESTURING&&(this.deltaEpicenter.copy(this.currentEpicenter).sub(this.previousEpicenter),e=new R.b(t.length,this.currentEpicenter,this.deltaEpicenter)),this.previousEpicenter.copy(this.currentEpicenter),this.lastPointerMove=Date.now(),e},t.prototype.getPointerPositions=function(t){return t.map((function(t){return t.position}))},t}(),I=n(346),k=n(8),L=function(){function t(t,e){void 0===e&&(e=500),this.onEventCallback=t,this.state=v.WAITING,this.startPosition=new b.Ic,this.pointerDelta=new b.Ic,this.lpThreshold=e}return t.prototype.start=function(t){var e=this;this.state===v.WAITING&&this.startPosition.copy(t.position),0==(t.buttons&t.buttons-1)&&(this.state=v.WAITINGTOEXCEEDTHRESHOLD,this.holdTimeout=window.setTimeout((function(){e.onEventCallback(new k.h(t.position,t.buttons,e.lpThreshold))}),this.lpThreshold))},t.prototype.stop=function(){this.state===v.WAITING&&this.pointerDelta.set(0,0),window.clearTimeout(this.holdTimeout),this.onEventCallback(new k.g),this.state=v.WAITING},t.prototype.onMove=function(t){this.state===v.WAITINGTOEXCEEDTHRESHOLD&&(this.pointerDelta.copy(t.position).sub(this.startPosition),this.pointerDelta.length()>.1&&(window.clearTimeout(this.holdTimeout),this.onEventCallback(new k.g)))},t}();!function(t){t[t.NONE=0]="NONE",t[t.CLICK_DRAG_LONGPRESS=1]="CLICK_DRAG_LONGPRESS",t[t.PINCH_ROTATE=2]="PINCH_ROTATE",t[t.MULTI_SWIPE_ONLY=3]="MULTI_SWIPE_ONLY"}(w||(w={}));var N,j=function(){function t(t,e,n){this.activeGesture=w.NONE,this.pointers=[],this.couldBeClick=!1,this.onEventCallback=n,this.clicker=new x(t.dragThreshold),this.longPress=new L(n,t.holdThreshold),this.dragger=new T(t.dragThreshold),this.pincher=new P(t.pinchThreshold),this.rotater=new D(t.rotateThreshold),this.multiswiper=new C(t.dragThreshold),t.disableWheel||this.bindWheelHandlers(e.element)}return Object.defineProperty(t.prototype,"activePointers",{get:function(){return this.pointers.length},enumerable:!0,configurable:!0}),t.prototype.onPointerChange=function(t){this.isMoveEvent(t)?this.onPointerMove(t):this.onPointerButton(t)},t.prototype.isMoveEvent=function(t){return!t.hasOwnProperty("down")},t.prototype.onPointerMove=function(t){this.movePointer(t.id,t.position,t.buttons)},t.prototype.onPointerButton=function(t){t.down?this.addPointer(t.id,t.position,t.button):this.removePointer(t.id,t.button)},t.prototype.bindWheelHandlers=function(t){var e=this;t.addEventListener("wheel",(function(t){t.preventDefault(),e.onEventCallback(new I.a({x:t.clientX,y:t.clientY},{x:e.normalizeWheelDelta(t.deltaMode,t.deltaX),y:e.normalizeWheelDelta(t.deltaMode,t.deltaY)}))}))},t.prototype.normalizeWheelDelta=function(t,e){return t===WheelEvent.DOM_DELTA_LINE?.7*e*e*e+13*e:e},t.prototype.addPointer=function(t,e,n){var r=Object(s.c)(n);if(r){var i=this.getPointer(t);i&&0==(i.buttons&r)?(i.buttons|=r,i.activeButtons++):this.pointers.push({id:t,position:new b.Ic(e.x,e.y),buttons:r,activeButtons:1}),this.toggleGestures()}},t.prototype.removePointer=function(t,e){var n=Object(s.c)(e);if(n){var r=this.getPointerIndex(t);if(-1!==r){var i=this.pointers[r];0!=(i.buttons&n)&&(i.buttons&=~n,i.activeButtons--),i.activeButtons||this.pointers.splice(r,1),this.toggleGestures()}}},t.prototype.movePointer=function(t,e,n){var r=this.getPointer(t);if(r)switch(r.position.copy(e),r.buttons!==n&&this.updateOffscreenPointer(r,n),this.activeGesture){case w.CLICK_DRAG_LONGPRESS:var i=this.clicker.onMove(r);i&&this.onEventCallback(i);var o=this.dragger.onMove(r);o&&this.onEventCallback(o),this.longPress.onMove(r);break;case w.PINCH_ROTATE:var a=this.pincher.onMove(this.pointers[0],this.pointers[1]),s=this.rotater.onMove(this.pointers[0],this.pointers[1]);a&&this.onEventCallback(a),s&&this.onEventCallback(s);case w.MULTI_SWIPE_ONLY:var c=this.multiswiper.onMove(this.pointers);c&&this.onEventCallback(c)}},t.prototype.getPointer=function(t){var e=this.getPointerIndex(t);if(-1!==e)return this.pointers[e]},t.prototype.toggleGestures=function(){var t=this.activeGesture;if(this.activeGesture=this.pointers.length,t===w.CLICK_DRAG_LONGPRESS&&this.activeGesture===w.NONE&&this.couldBeClick){var e=this.clicker.stop();e&&this.onEventCallback(e)}if(this.couldBeClick=t===w.NONE&&this.activeGesture===w.CLICK_DRAG_LONGPRESS,this.activeGesture===w.CLICK_DRAG_LONGPRESS){var n=this.clicker.start(this.pointers[0]);n&&this.onEventCallback(n);var r=this.dragger.start(this.pointers[0]);r&&this.onEventCallback(r),this.longPress.start(this.pointers[0])}else if(t===w.CLICK_DRAG_LONGPRESS){var i=this.dragger.stop();this.longPress.stop(),this.onEventCallback(i)}this.activeGesture===w.PINCH_ROTATE?(this.pincher.start(this.pointers[0],this.pointers[1]),this.rotater.start(this.pointers[0],this.pointers[1]),this.multiswiper.start(this.pointers)):t===w.PINCH_ROTATE&&(this.onEventCallback(this.pincher.stop()),this.onEventCallback(this.rotater.stop()),this.onEventCallback(this.multiswiper.stop())),this.activeGesture===w.MULTI_SWIPE_ONLY?this.multiswiper.start(this.pointers):t===w.MULTI_SWIPE_ONLY&&this.onEventCallback(this.multiswiper.stop())},t.prototype.getPointerIndex=function(t){for(var e=0;e<this.pointers.length;e++){if(this.pointers[e].id===t)return e}return-1},t.prototype.updateOffscreenPointer=function(t,e){if(t.buttons=e,0===e){var n=this.getPointerIndex(t.id);this.pointers.splice(n,1),this.toggleGestures()}},t}(),B=n(191),F=n(136),U=n(211),z=n(100),G=n(91),H=(N=function(t,e){return(N=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}N(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),V=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},W=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},q=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},Y=function(){function t(t,e,n){this._renew=t,this._cancel=e,this.active=n}return t.prototype.renew=function(){this.active()||this._renew()},t.prototype.cancel=function(){this.active()&&this._cancel()},t}(),J=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="input-ini",e.fallbackHandlerMap={},e.meshHandlerMap={},e.priorityHandlerMap={},e.unfilteredHandlerMap={},e.captureHandlerMap={},e.gesturing=!1,e.gestureCapture=new B.a((function(t){return t.object.id})),e.activeIntersections=new B.a((function(t){return t.object.id})),e.eventTypeLookup=new o.a,e.meshTypeLookup=new o.a,e.hoveredMesh=null,e.registerMesh=function(t,n){e.raycaster.targets.addTarget(t,n)},e.unregisterMesh=function(t){e.raycaster.targets.removeTarget(t)},e.onPointerEvent=function(t){var n,r,i,o,a=!t.hasOwnProperty("down"),s=!a&&t.down,c=!s&&!a;if(a||s){e.raycaster.pointer.updatePointer(t.position),e.activeIntersections.clear();try{for(var u=q(e.raycaster.pointer.cast()),l=u.next();!l.done;l=u.next()){var h=l.value;e.activeIntersections.add(h)}}catch(t){n={error:t}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}if(!e.gesturing){e.gestureCapture.clear();try{for(var f=q(e.activeIntersections),p=f.next();!p.done;p=f.next()){h=p.value;e.gestureCapture.add(h)}}catch(t){i={error:t}}finally{try{p&&!p.done&&(o=f.return)&&o.call(f)}finally{if(i)throw i.error}}e.updateHoveredMesh()}s&&(e.gesturing=!0),e.onEvent(t)}e.inputGesture.onPointerChange(t),c&&e.onEvent(t),0===e.inputGesture.activePointers&&(e.activeIntersections.clear(),e.gestureCapture.clear(),e.gesturing=!1)},e.onEvent=function(t){var n,r,i,o,a,s,c=e.eventTypeLookup.getIndexByInstance(t),u=e.captureHandlerMap[c];if(u&&u.length>0){try{for(var l=q(u),h=l.next();!h.done;h=l.next()){(0,h.value)(t)}}catch(t){n={error:t}}finally{try{h&&!h.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}u.length=0}else{var f=e.unfilteredHandlerMap[c];if(f)try{for(var p=q(f),d=p.next();!d.done;d=p.next()){(0,d.value)(t)}}catch(t){i={error:t}}finally{try{d&&!d.done&&(o=p.return)&&o.call(p)}finally{if(i)throw i.error}}var y=e.iterateMeshCallbacks(t,e.gesturing?e.gestureCapture:e.activeIntersections),m=e.fallbackHandlerMap[c];if(!y&&m)try{for(var v=q(m),g=v.next();!g.done;g=v.next()){(0,g.value)(t)}}catch(t){a={error:t}}finally{try{g&&!g.done&&(s=v.return)&&s.call(v)}finally{if(a)throw a.error}}}},e}return H(e,t),e.prototype.init=function(t,e){return V(this,void 0,void 0,(function(){var n,r,i,o;return W(this,(function(a){switch(a.label){case 0:return n={disableWheel:!!t.disableWheel},[4,e.getModule(U.default)];case 1:return r=a.sent(),[4,e.market.waitForData(z.a)];case 2:return i=a.sent(),o=this,[4,e.getModule(G.default)];case 3:return o.raycaster=a.sent(),new p({pointerPreventDefault:t.pointerPreventDefault},r.element,i,this.onPointerEvent),new g(this.onEvent),this.inputGesture=new j(n,r,this.onEvent),[2]}}))}))},e.prototype.registerHandler=function(t,e){var n=this;this.insertHandler(t,this.fallbackHandlerMap,e);var r=this.eventTypeLookup.getIndexByType(t,!0);return new Y((function(){return n.registerHandler(t,e)}),(function(){return n.unregisterHandler(t,e)}),(function(){return-1!==n.fallbackHandlerMap[r].indexOf(e)}))},e.prototype.unregisterHandler=function(t,e){this.removeHandler(t,this.fallbackHandlerMap,e)},e.prototype.registerMeshHandler=function(t,e,n){return this._registerMeshHandler(t,{comparator:e,callback:n})},e.prototype._registerMeshHandler=function(t,e){var n=this,r=this.eventTypeLookup.getIndexByType(t,!0);this.meshHandlerMap[r]||(this.meshHandlerMap[r]=[]);var i=this.meshHandlerMap[r];return i.push(e),new Y((function(){return n._registerMeshHandler(t,e)}),(function(){return n.unregisterMeshHandler(t,e)}),(function(){return-1!==i.indexOf(e)}))},e.prototype.unregisterMeshHandler=function(t,e){var n=this.eventTypeLookup.getIndexByType(t,!0);if(this.meshHandlerMap[n]){var r=this.meshHandlerMap[n],i=r.indexOf(e);i>-1&&r.splice(i,1)}},e.prototype.registerPriorityHandler=function(t,e,n){var r=this,i=this.eventTypeLookup.getIndexByType(t,!0),a=this.meshTypeLookup.getIndexByType(e,!0);this.priorityHandlerMap[i]||(this.priorityHandlerMap[i]={});var s=this.priorityHandlerMap[i];if(s[a]){var c=Object(o.c)(t),u=Object(o.c)(e);throw Error(c+" already has a priority handler registered for mesh type: "+u)}return s[a]=n,new Y((function(){return r.registerPriorityHandler(t,e,n)}),(function(){return r.unregisterPriorityHandler(t,e,n)}),(function(){return void 0!==s[a]}))},e.prototype.unregisterPriorityHandler=function(t,e,n){var r=this.eventTypeLookup.getIndexByType(t),i=this.priorityHandlerMap[r];if(i){var o=this.meshTypeLookup.getIndexByType(e),a=i[o];a&&n===a&&delete i[o]}},e.prototype.registerUnfilteredHandler=function(t,e){var n=this;this.insertHandler(t,this.unfilteredHandlerMap,e);var r=this.eventTypeLookup.getIndexByType(t);return new Y((function(){return n.registerUnfilteredHandler(t,e)}),(function(){return n.unregisterUnfilteredHandler(t,e)}),(function(){return-1!==n.unfilteredHandlerMap[r].indexOf(e)}))},e.prototype.unregisterUnfilteredHandler=function(t,e){this.removeHandler(t,this.unfilteredHandlerMap,e)},e.prototype.captureNext=function(t,e){return this.insertHandler(t,this.captureHandlerMap,e),e},e.prototype.removeCaptureHandler=function(t,e){this.removeHandler(t,this.captureHandlerMap,e)},e.prototype.updateHoveredMesh=function(){var t,e,n,r,i=this.activeIntersections.getByIndex(0),a=!1;if(this.hoveredMesh&&(void 0===i||i.object!==this.hoveredMesh)){var s=this.getMeshHandler(F.b,Object(o.b)(this.hoveredMesh),this.priorityHandlerMap);if(s&&(a=s(new F.b,this.hoveredMesh,i)||!1),!a){var c=this.meshHandlerMap[this.eventTypeLookup.getIndexByType(F.b)];if(c)try{for(var u=q(c),l=u.next();!l.done;l=u.next()){(m=l.value).comparator.compare(this.hoveredMesh)&&m.callback(new F.b,this.hoveredMesh,i)}}catch(e){t={error:e}}finally{try{l&&!l.done&&(e=u.return)&&e.call(u)}finally{if(t)throw t.error}}}}var h=!1;if(i&&i.object!==this.hoveredMesh){var f=this.getMeshHandler(F.a,Object(o.b)(i.object),this.priorityHandlerMap);if(f&&(h=f(new F.a,i.object,i)||!1),!h){var p=this.meshHandlerMap[this.eventTypeLookup.getIndexByType(F.a)];if(p)try{for(var d=q(p),y=d.next();!y.done;y=d.next()){var m;(m=y.value).comparator.compare(i.object)&&m.callback(new F.a,i.object,i)}}catch(t){n={error:t}}finally{try{y&&!y.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}}}this.hoveredMesh=i&&i.object||null},e.prototype.iterateMeshCallbacks=function(t,e){var n,r,i,o,a=!1,s=this.eventTypeLookup.getIndexByInstance(t);try{for(var c=q(e),u=c.next();!u.done;u=c.next()){var l=u.value;if(a)break;var h=l.object,f=this.activeIntersections.get(h.id);for(var p in this.priorityHandlerMap[s])if(l.object instanceof this.meshTypeLookup.getTypeByIndex(parseInt(p,10))){var d=this.priorityHandlerMap[s]&&this.priorityHandlerMap[s][p];if(d&&(a=!0,d(t,h,f)))return!0}var y=this.meshHandlerMap[s];if(y)try{for(var m=q(y),v=m.next();!v.done;v=m.next()){var g=v.value;g.comparator.compare(h)&&(a=!0,g.callback(t,h,f))}}catch(t){i={error:t}}finally{try{v&&!v.done&&(o=m.return)&&o.call(m)}finally{if(i)throw i.error}}}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}return a},e.prototype.insertHandler=function(t,e,n){var r=this.eventTypeLookup.getIndexByType(t,!0);e[r]||(e[r]=[]),e[r].push(n)},e.prototype.removeHandler=function(t,e,n){var r=e[this.eventTypeLookup.getIndexByType(t)];if(r)for(var i=0;i<r.length;i++)if(r[i]===n){r.splice(i,1);break}},e.prototype.getMeshHandler=function(t,e,n){var r=n[this.eventTypeLookup.getIndexByType(t)];return r?r[this.meshTypeLookup.getIndexByType(e)]:null},e}(i.a);e.default=J},function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"d",(function(){return h})),n.d(e,"c",(function(){return f})),n.d(e,"a",(function(){return p}));var r,i,o,a,s=n(5),c=n(1),u=n(10),l=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});!function(t){t.INSIDE="mode.inside",t.OUTSIDE="mode.outside",t.DOLLHOUSE="mode.dollhouse",t.FLOORPLAN="mode.floorplan",t.TRANSITIONING="mode.transitioning"}(a||(a={}));(i={})[a.INSIDE]=c.a.Panorama,i[a.DOLLHOUSE]=c.a.Dollhouse,i[a.FLOORPLAN]=c.a.Floorplan,i[a.TRANSITIONING]=c.a.Transition,i[a.OUTSIDE]=c.a.Outdoor;var h=((o={})[c.a.Panorama]=a.INSIDE,o[c.a.Dollhouse]=a.DOLLHOUSE,o[c.a.Floorplan]=a.FLOORPLAN,o[c.a.Transition]=a.TRANSITIONING,o[c.a.Outdoor]=a.OUTSIDE,o),f=function(t){var e=h[t];return void 0!==e?e:a.OUTSIDE},p=function(t){function e(e,n,r){void 0===n&&(n=u.a.Interpolate),void 0===r&&(r={});var i=t.call(this)||this;return i.payload={mode:e,transitionType:n,pose:r},i}return l(e,t),e.id="CHANGE_VIEWMODE",e}(s.a)},function(t,e,n){"use strict";var r,i,o;n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return o})),function(t){t[t.Pan=0]="Pan",t[t.PanDollhouse=1]="PanDollhouse",t[t.Zoom=2]="Zoom",t[t.Delay=3]="Delay",t[t.None=4]="None"}(r||(r={})),function(t){t[t.Left=1]="Left",t[t.Auto=0]="Auto",t[t.Right=-1]="Right"}(i||(i={})),function(t){t[t.Move=0]="Move",t[t.Burns=1]="Burns",t[t.Zoom=2]="Zoom",t[t.Path=3]="Path",t[t.FloorChange=4]="FloorChange",t[t.Delay=5]="Delay",t[t.Nop=6]="Nop"}(o||(o={}))},function(t,e,n){"use strict";n.d(e,"d",(function(){return i})),n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return f})),n.d(e,"a",(function(){return p}));var r,i,o,a=n(23),s=n(139),c=n(38),u=n(84),l=n(69),h=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});!function(t){t.UP="Up",t.DOWN="Down",t.LEFT="Left",t.LEFT_UP="LeftUp",t.LEFT_DOWN="LeftDown",t.RIGHT="Right",t.RIGHT_UP="RightUp",t.RIGHT_DOWN="RightDown"}(i||(i={})),function(t){t[t.CLOSED=0]="CLOSED",t[t.IDLE=1]="IDLE",t[t.DISABLED=2]="DISABLED",t[t.CREATING=3]="CREATING",t[t.PRESSING=4]="PRESSING",t[t.PLACING=5]="PLACING",t[t.PLACED=6]="PLACED",t[t.EDITING=7]="EDITING"}(o||(o={}));var f=function(t){function e(e){var n=t.call(this)||this;return n.mattertags=e,n.name="tag-view",n.visitedTags=new s.a,n.toolStateObservable=Object(c.b)(o.CLOSED),n.openTagObservable=Object(c.b)(null),n.selectedTagObservable=Object(c.b)(null),n.uncommittedTagObservable=Object(c.b)(null),n.progressObservable=new c.a(-1),n.screenPositionObservable=new c.a(null),n.viewedTags=0,n.creatingNewMattertag=!1,n.tagCapabilities={},n.getViewData=function(t){var e=n.mattertags.getTag(t),r=n.derivedData[t];return e&&!r&&n.makeViewData&&(n.derivedData[t]=n.makeViewData(e)),n.derivedData[t]},n.derivedData={},n.activeBillboards=Object(u.b)(),n}return h(e,t),e.prototype.setViewDataFactory=function(t){this.makeViewData=t},e.prototype.openBillboard=function(t){this.openTag&&this.openTag!==t&&this.closeBillboard(this.openTag),this.openTag!==t&&this.setOpenTag(t)},e.prototype.hideBillboard=function(t){this.openTag===t&&this.setOpenTag(null)},e.prototype.closeBillboard=function(t){this.openTag===t&&this.setOpenTag(null),this.selectedTag===t&&this.setSelectedTag(null)},e.prototype.closeOpenBillboard=function(){this.openTag&&this.closeBillboard(this.openTag)},e.prototype.setTagCapabilities=function(t,e){var n=this.tagCapabilities[t]||{};n.opening=e.opening,n.navigating=e.navigating,this.tagCapabilities[t]=n,this.openTag!==t||this.tagCapabilities.opening||this.closeBillboard(t)},e.prototype.getTagCount=function(){return this.mattertags.collection.length},Object.defineProperty(e.prototype,"navigating",{get:function(){return this.navigatingTag},enumerable:!0,configurable:!0}),e.prototype.setNavigatingTag=function(t){this.navigatingTag=t},e.prototype.setSelectedTag=function(t){this.selectedTagObservable.value=t},Object.defineProperty(e.prototype,"selectedTag",{get:function(){return this.selectedTagObservable.value},enumerable:!0,configurable:!0}),e.prototype.onSelectedTagChanged=function(t){return this.selectedTagObservable.onChanged(t)},e.prototype.setUncommittedTag=function(t){this.uncommittedTagObservable.value=t},Object.defineProperty(e.prototype,"uncommittedTag",{get:function(){return this.uncommittedTagObservable.value},enumerable:!0,configurable:!0}),e.prototype.onUncommittedChanged=function(t){return this.uncommittedTagObservable.onChanged(t)},e.prototype.setProgress=function(t){this.progressObservable.value=t},Object.defineProperty(e.prototype,"progress",{get:function(){return this.progressObservable.value},enumerable:!0,configurable:!0}),e.prototype.onProgressChanged=function(t,e){void 0===e&&(e=!1);var n=this.progressObservable.onChanged(t);return e&&n.renew(),n},Object.defineProperty(e.prototype,"screenPosition",{get:function(){return this.screenPositionObservable.value},enumerable:!0,configurable:!0}),e.prototype.setScreenPosition=function(t){this.screenPositionObservable.value=t},e.prototype.onScreenPositionChanged=function(t,e){void 0===e&&(e=!1);var n=this.screenPositionObservable.onChanged(t);return e&&n.renew(),n},e.prototype.setToolState=function(t){switch(t){case o.CREATING:this.creatingNewMattertag=!0;break;case o.IDLE:case o.CLOSED:this.creatingNewMattertag=!1}this.toolStateObservable.value=t},Object.defineProperty(e.prototype,"toolState",{get:function(){return this.toolStateObservable.value},enumerable:!0,configurable:!0}),e.prototype.onToolStateChanged=function(t){return this.toolStateObservable.onChanged(t)},Object.defineProperty(e.prototype,"openTag",{get:function(){return this.openTagObservable.value},enumerable:!0,configurable:!0}),e.prototype.setOpenTag=function(t){this.openTagObservable.value=t},e.prototype.onOpenTagChanged=function(t){return this.openTagObservable.onChanged(t)},e.prototype.isCreatingNewMattertag=function(){return this.creatingNewMattertag},e.prototype.visitTag=function(t){this.viewedTags++,-1===this.visitedTags.indexOf(t)&&this.visitedTags.push(t)},e.prototype.getViewedTagCount=function(){return this.viewedTags},e.prototype.getVisitedTags=function(){return this.visitedTags.values()},e.prototype.setNavigatingPosition=function(t){this.navigatingPosition=t},e.prototype.getNavigatingPosition=function(){return this.navigatingPosition},e}(a.a),p=function(t){function e(e){var n=t.call(this)||this;return n.sid=e,n.closing=!1,n.position=null,n.distance=0,n.timeoutId=0,n}return h(e,t),e}(l.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return h})),n.d(e,"c",(function(){return f}));var r,i=n(124),o=n(23),a=n(49),s=(n(232),n(38)),c=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),u=-1,l=new s.a(u),h=function(t){function e(e,n,r){var o=t.call(this)||this;return o.floors=e,o.localize=n,o.floorsVisiblePerMode=r,o.name="floors-view",o.getFloorMin=function(t){var e=void 0!==t?t:o.currentFloor,n=o.floors.getFloor(Math.max(e,0));return n?n.bottom:0},o.isHidden=function(t){var e=-1===o.currentFloor,n=t===o.currentFloor,r=o.floorsVisiblePerMode();return!(e||n||r)},o.getHighestVisibleFloor=function(){return o.currentFloor>-1?o.currentFloor:o.totalFloors-1},o.updateViewData=function(){o.floors.iterate((function(t){o.derivedData[t.floorIndex]={floorIndex:t.floorIndex,name:o.getFloorName(t.floorIndex)}})),o.commit()},o.getViewData=function(t){var e=o.floors.getFloor(t),n=o.derivedData[t];return e&&!n&&(o.derivedData[t]={floorIndex:e.floorIndex,name:o.getFloorName(e.floorIndex)}),o.derivedData[t]},o.derivedData={},o._transition={from:-1,to:-1,progress:new i.a(0),promise:Promise.resolve()},o.updateViewData(),o}return c(e,t),e.prototype.makeFloorChangeSubscription=function(t){return l.onChanged(t)},Object.defineProperty(e.prototype,"currentFloor",{get:function(){return l.value},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nearestFloor",{get:function(){return this.transitionActive?this.transition.progress.value>.5?this.transition.to:this.transition.from:this.currentFloor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"transitionActive",{get:function(){return this.transition.progress.active},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"transition",{get:function(){return this._transition},enumerable:!0,configurable:!0}),e.prototype.transitionToFloorInstant=function(t){l.value=t,this.commit()},e.prototype.transitionToFloor=function(t,e,n,r){var i=this,o=this._transition.progress;o.modifyAnimation(0,1,n),this._transition={from:t,to:e,progress:o,promise:r},this.commit(),r.then((function(){i.transitionToFloorInstant(e)}))},Object.defineProperty(e.prototype,"totalFloors",{get:function(){return this.floors.getFloorCount()},enumerable:!0,configurable:!0}),e.prototype.iterate=function(t){var e=this;this.floors.iterate((function(n){var r=e.getViewData(n.floorIndex);t(r)}))},e.prototype.getFloorNames=function(){var t=this,e=[];return this.floors.iterate((function(n){e.push(t.getFloorName(n.floorIndex))})),e},e.prototype.getFloorName=function(t){if(t<0)return this.localize(a.a.FLOOR_ALL);var e=this.floors.getFloor(t);return e?void 0!==e.name&&""!==e.name?e.name:this.localize(a.a.FLOOR_NAME)+(t+1):this.localize(a.a.FLOOR_ALL)},e.prototype.getFloorsVisibility=function(){if(-1===this.currentFloor)return[];for(var t=[],e=0;e<this.totalFloors;e++)t[e]=e===this.currentFloor?1:0;return t},e}(o.a);function f(t){return t===l.value||l.value===u||t===u}},function(t,e,n){"use strict";n.d(e,"e",(function(){return i})),n.d(e,"d",(function(){return o})),n.d(e,"b",(function(){return a})),n.d(e,"f",(function(){return s})),n.d(e,"a",(function(){return c})),n.d(e,"h",(function(){return u})),n.d(e,"g",(function(){return l})),n.d(e,"c",(function(){return h}));var r=n(67),i=.01,o=.001,a=!0,s={highResThreshold:1081,desktopSize:192,desktopSizeHighRes:320,mobileSize:128},c={smoothness:.4,perspective:{fov:40,thresholdClose:1,thresholdFar:8,offsetClose:.25,offsetFar:.5,scale:1},ortho:{fov:5,thresholdClose:5,thresholdFar:20,offsetClose:15,offsetFar:30,scale:4}},u={desktop:r.a.Edges,floorplan:r.a.Axes,mobile:r.a.Edges,alt:r.a.Free,shift:r.a.PlanarAxes,shiftAlt:r.a.EdgesAndPlanarAxes,disabled:r.a.Free},l={mobile:.15,desktop:.1},h={SCALE:.1,SCALE_NDC:.5,SCALE_ASPECT:.035,SCALE_DISTANCE:.025}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return c}));var r,i=n(125),o=n(30),a=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(t){function e(e){var n=t.call(this)||this;return n.value=e,n}return a(e,t),e.prototype.notifyObserver=function(t){t(this.value)},Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(t){this._value!==t&&(this.removeChildObservables(this._value),this.addChildObservable(t),this._value=t,this.setDirty())},enumerable:!0,configurable:!0}),e.prototype.deepCopy=function(){return Object(o.a)(this._value)},e}(i.a),c=function(t){return new s(t)}},function(t,e,n){"use strict";n.d(e,"b",(function(){return v})),n.d(e,"a",(function(){return g})),n.d(e,"g",(function(){return b})),n.d(e,"c",(function(){return w})),n.d(e,"f",(function(){return _})),n.d(e,"e",(function(){return x})),n.d(e,"d",(function(){return S})),n.d(e,"i",(function(){return T})),n.d(e,"h",(function(){return E}));var r,i,o,a,s,c,u,l,h,f=n(94),p=n(0),d=n(133),y=n(236),m=n(7),v=512,g=6,b=function(t,e,n,r,i,o,a,s){var c=t/e,u=2*(e/t),l=u/2,h=2*(r/c)-1+l,p=2*((i=c-1-i)/c)-1+l;switch(o=o||d.a.Center){case d.a.UpperLeft:h-=l,p+=l,h+=a*u;break;case d.a.UpperRight:h+=l,p+=l,p-=a*u;break;case d.a.LowerRight:h+=l,p-=l,h-=a*u;break;case d.a.LowerLeft:h-=l,p-=l,p+=a*u;break;case d.a.Center:}switch(n){case f.a.GL_TEXTURE_CUBE_MAP_POSITIVE_X:s.set(-1,p,-h);break;case f.a.GL_TEXTURE_CUBE_MAP_NEGATIVE_X:s.set(1,p,h);break;case f.a.GL_TEXTURE_CUBE_MAP_POSITIVE_Y:s.set(-h,1,-p);break;case f.a.GL_TEXTURE_CUBE_MAP_NEGATIVE_Y:s.set(-h,-1,p);break;case f.a.GL_TEXTURE_CUBE_MAP_POSITIVE_Z:s.set(-h,p,1);break;case f.a.GL_TEXTURE_CUBE_MAP_NEGATIVE_Z:s.set(h,p,-1)}s.normalize()},w=function(t,e){var n=v;t<v&&(n=t);var r=Math.floor(t/n),i=r*r;return Math.floor(e/i)},_=function(t,e,n){var r=v;t<v&&(r=t);var i=w(t,e),o=Math.floor(t/r),a=e-i*(o*o);n.tileX=a%o,n.tileY=Math.floor(a/o),n.face=i,n.faceTileIndex=a},x=function(t){if(t<=v)return g;var e=Math.floor(t/v);return e*e*g},S=(r=new p.jb,i=new p.Pb,function(t,e){i.copy(t),i.inverse(),r.makeRotationFromQuaternion(i),e.applyMatrix4(r),e.normalize()}),T=(a=new p.Jc,s=new p.Jc(0,0,-1),c=new p.Pb,u=function(t,e){t.push({face:e.face,faceTileIndex:e.faceTileIndex,tileX:e.tileX,tileY:e.tileY})},o={face:-1,faceTileIndex:-1,tileX:-1,tileY:-1},l=function(t,e,n){for(var r=x(t),i=0,a=0;a<r;a++)_(t,a,o),e&&!e(o)||(i++,n&&u(n,o));return i},function(t,e,n,r,i,o,u){void 0===i&&(i=!1),r.length=i?0:r.length;var h=e<v?e:v;if(!o&&!u)return l(e,null,r);var f=!!u;o=o||0,u=u||o,u=Math.max(0,Math.min(u,360)),o=Math.max(0,Math.min(o,360)),a.copy(n);var d=t.rotation||new p.Pb;return S(d,a),f?(c.setFromUnitVectors(a,s),l(e,(function(t){return M(e,h,t.face,t.tileX,t.tileY,c,o||0,u||0)}),r)):l(e,(function(t){return E(e,h,t.face,t.tileX,t.tileY,a,o||0)}),r)}),M=(h=new p.Jc,function(t,e,n,r,i,o,a,s){for(var c=Math.tan(.5*s*m.b),u=-c,l=Math.tan(.5*a*m.b),f=-l,p=Object(y.a)(n),v=0,g=0,w=0,_=0,x=0,S=d.a.Center;S<=d.a.LowerLeft;S++)if(b(t,e,p,r,i,S,0,h),h.applyQuaternion(o),!(h.z>=-1e-5)){var T=-1/h.z,M=h.x*T,E=h.y*T;E>c?v++:E<u&&g++,M>l?w++:M<f&&_++,x++}return g!==x&&v!==x&&w!==x&&_!==x}),E=function(){var t=new p.Jc,e=new p.Jc(0,1,0),n=new p.Jc(1,0,0);return function(r,i,o,a,s,c,u){var l=Object(y.a)(o);if(n.copy(c).cross(e),b(r,i,l,a,s,d.a.Center,0,t),P(t,c,u))return!0;for(var h=u/360,f=Math.floor(1/h),p=0,m=0;m<f;m++){for(var v=d.a.UpperLeft;v<=d.a.LowerLeft;v++)if(b(r,i,l,a,s,v,p,t),P(t,c,u))return!0;p+=h}return!1}}(),P=function(){var t=new p.Jc,e=new p.Jc;return function(n,r,i,o){if(e.copy(n),o){t.copy(o),t.normalize();var a=t.dot(n);t.x*=a,t.y*=a,t.z*=a,e.sub(t)}var s=i/2*m.b,c=Math.cos(s);return e.dot(r)>=c}}()},function(t,e,n){"use strict";n.d(e,"i",(function(){return a})),n.d(e,"e",(function(){return s})),n.d(e,"d",(function(){return c})),n.d(e,"a",(function(){return u})),n.d(e,"c",(function(){return l})),n.d(e,"k",(function(){return h})),n.d(e,"b",(function(){return f})),n.d(e,"h",(function(){return p})),n.d(e,"j",(function(){return d})),n.d(e,"g",(function(){return y})),n.d(e,"f",(function(){return m})),n.d(e,"l",(function(){return v}));var r=n(22),i=n(0),o=.25,a=function(t){return function(e){return e!==t}},s=function(t){return function(e){return-1!==t.neighbours.indexOf(e.id)}},c=function(t){return function(e){return t===e||s(t)(e)}},u=function(t,e,n){void 0===n&&(n=o);var r=new i.Jc;return function(i){return r.copy(i.position).sub(t).normalize().dot(e)>n}},l=function(){return function(t){return t.enabled}},h=function(t){return t.placementType===r.b.MANUAL},f=function(){return function(t){return t.alignmentType===r.a.ALIGNED}},p=function(){return function(t){return t.alignmentType!==r.a.ALIGNED}},d=function(t){return function(e){return t.floor===e.floor}},y=function(t){return function(e){return t===e.floor}},m=function(t,e){var n=new i.Jc;return e=e.clone(),function(r){return n.copy(r.position).sub(t).normalize().dot(e)>0}},v=function(t,e){return function(n){return t.distanceTo(n.position)<e}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}));var r=function(t){if(t){var e=t.valueOf();if(!isNaN(e))return t.toISOString()}return(new Date).toISOString()},i=function(t){if(t){var e=new Date(t);if(!isNaN(e.valueOf()))return e}return new Date}},function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.boundingSkybox=-100]="boundingSkybox",t[t.default=0]="default",t[t.ghostFloor=3]="ghostFloor",t[t.panoMarker=4]="panoMarker",t[t.reticule=5]="reticule",t[t.grid=5]="grid",t[t.pins=6]="pins",t[t.portals=9]="portals",t[t.rotators=10]="rotators",t[t.tags=15]="tags",t[t.lines=20]="lines",t[t.endpoints=21]="endpoints",t[t.labels=22]="labels",t[t.colorOverlay=1e3]="colorOverlay"}(r||(r={}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=function(){function t(t){this._mask=t}return Object.defineProperty(t.prototype,"mask",{get:function(){return this._mask},enumerable:!0,configurable:!0}),t.prototype.addLayers=function(t){this._mask|=t.mask},t.prototype.removeLayers=function(t){return this._mask&=~t.mask},t.prototype.clone=function(){return new t(this._mask)},t}(),i=function(){function t(){this.layerRegistry=[],this.unusedLayers=[];for(var t=1;t<32;t++)this.unusedLayers.push(t)}return Object.defineProperty(t,"ALL",{get:function(){return new r(-1)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"NONE",{get:function(){return new r(0)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DEFAULT",{get:function(){return new r(1)},enumerable:!0,configurable:!0}),t.prototype.claimLayer=function(t){var e=this.getLayer(t);if(e.mask)return e;if(0===this.unusedLayers.length)throw Error("All render layers have already been claimed");var n=this.unusedLayers[0];return this.layerRegistry[n]=t,this.unusedLayers.shift(),new r(1<<n)},t.prototype.getLayer=function(e){var n=this.layerRegistry.indexOf(e);return-1!==n?new r(1<<n):t.NONE},t.prototype.disposeLayer=function(t){var e=this.layerRegistry.indexOf(t);-1!==e&&this.unusedLayers.push(e)},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r,i=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=function(t){function e(e){var n=this.constructor,r=t.call(this,e)||this;return r.name="BaseException",Object.setPrototypeOf(r,n.prototype),r}return i(e,t),e}(Error)},function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return c})),n.d(e,"c",(function(){return u}));var r,i,o=n(155),a=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e}(o.a);!function(t){t.MOUSE="mouse",t.TOUCH="touch",t.PEN="pen",t.GAMEPAD="gamepad"}(i||(i={}));var c=function(t){function e(e,n,r,i,o){var a=t.call(this)||this;return a.id=e,a.position=n,a.button=r,a.down=i,a.device=o,a}return a(e,t),e}(s),u=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.id=e,o.position=n,o.buttons=r,o.device=i,o}return a(e,t),e}(s)},function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return a})),n.d(e,"d",(function(){return s})),n.d(e,"a",(function(){return c}));var r=n(0),i=n(6);e.e=Object.freeze({debugLOD:i.A("debuglod",!1),highQualityDam:i.A("highqdam",!1)});var o="features/mesh-rendering",a="wireframeEnabled",s=new r.Kc(0,0,0,.3),c={FADE_ADJACENT:1,FADE_OPAQUE:1,FADE_SELECTION:.6,FADE_ABOVE:.06,FADE_BELOW:.1,FADE_BELOW_MIN:i.A("below",0),FADE_MIN:0,FADE_CLICKABLE_THRESHOLD:i.A("clickable",.29),FADE_IN_END_ANGLE:i.A("endangle",28),FADE_IN_START_ANGLE:i.A("startangle",27),FADE_IN_VALUE:i.A("popval",.3),FADE_IN_HOVER_BOOST_VALUE:i.A("hover",.2),DISCARD_FOCAL_MULTI:i.A("discardthresh",.125)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(44),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e){void 0===e&&(e="Not implemented");var n=t.call(this,e)||this;return n.name="NotImplemented",n}return o(e,t),e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(0),i=new(n(2).a)("texture"),o=function(t,e){var n=new r.wc;return n.crossOrigin="anonymous",n.load(t,e,void 0,(function(){i.error("Failed to load "+t)}))}},function(t,e,n){"use strict";var r;!function(t){t.LOADING="LOADING",t.PRESENTED_BY_CAPS="PRESENTED_BY_CAPS",t.EXPLORE_3D_SPACE="EXPLORE_3D_SPACE",t.POWERED_BY="POWERED_BY",t.SC_LOCKOUT_MESSAGE="SC_LOCKOUT_MESSAGE",t.SC_LOCKOUT_TITLE="SC_LOCKOUT_TITLE",t.SC_PASSWORD_TITLE="SC_PASSWORD_TITLE",t.SC_PASSWORD_INVALID="SC_PASSWORD_INVALID",t.SC_PASSWORD_PLACEHOLDER="SC_PASSWORD_PLACEHOLDER",t.SC_PASSWORD_SUBMIT="SC_PASSWORD_SUBMIT",t.VIEW_INSIDE="VIEW_INSIDE",t.VIEW_INSIDE_MESH="VIEW_INSIDE_MESH",t.VIEW_DOLLHOUSE="VIEW_DOLLHOUSE",t.VIEW_FLOORPLAN="VIEW_FLOORPLAN",t.VIEW_FULLSCREEN="VIEW_FULLSCREEN",t.EXIT_FULLSCREEN="EXIT_FULLSCREEN",t.OPEN_HIGHLIGHTS="OPEN_HIGHLIGHTS",t.CLOSE_HIGHLIGHTS="CLOSE_HIGHLIGHTS",t.PAUSE="PAUSE",t.SOCIAL_SHARING="SOCIAL_SHARING",t.VIEW_IN_VR="VIEW_IN_VR",t.FLOOR_NAME="FLOOR_NAME",t.FLOOR_ALL="FLOOR_ALL",t.PRESENTED_BY="PRESENTED_BY",t.MORE="MORE",t.LESS="LESS",t.LEARN_MORE="LEARN_MORE",t.TERMS="TERMS",t.HELP="HELP",t.TERMS_FAIL="TERMS_FAIL",t.HELP_NAVIGATION_TAB="HELP_NAVIGATION_TAB",t.HELP_MORE_HELP_TAB="HELP_MORE_HELP_TAB",t.HELP_DESKTOP_360_2A="HELP_DESKTOP_360_2A",t.HELP_DESKTOP_360_2B="HELP_DESKTOP_360_2B",t.HELP_DESKTOP_DOLLHOUSE_1A="HELP_DESKTOP_DOLLHOUSE_1A",t.HELP_DESKTOP_DOLLHOUSE_1B="HELP_DESKTOP_DOLLHOUSE_1B",t.HELP_DESKTOP_DOLLHOUSE_2A="HELP_DESKTOP_DOLLHOUSE_2A",t.HELP_DESKTOP_DOLLHOUSE_3A="HELP_DESKTOP_DOLLHOUSE_3A",t.HELP_DESKTOP_FLOORPLAN_1A="HELP_DESKTOP_FLOORPLAN_1A",t.HELP_DESKTOP_FLOORPLAN_2A="HELP_DESKTOP_FLOORPLAN_2A",t.HELP_DESKTOP_FLOORPLAN_2B="HELP_DESKTOP_FLOORPLAN_2B",t.HELP_DESKTOP_FLOORPLAN_3A="HELP_DESKTOP_FLOORPLAN_3A",t.HELP_DESKTOP_FLOORPLAN_3B="HELP_DESKTOP_FLOORPLAN_3B",t.HELP_DESKTOP_MORE_360_B="HELP_DESKTOP_MORE_360_B",t.HELP_DESKTOP_MORE_DOLLHOUSE_B="HELP_DESKTOP_MORE_DOLLHOUSE_B",t.HELP_DESKTOP_MORE_FLOORS_B="HELP_DESKTOP_MORE_FLOORS_B",t.HELP_DESKTOP_MORE_FULLSCREEN_B="HELP_DESKTOP_MORE_FULLSCREEN_B",t.HELP_DESKTOP_MORE_HLR_B="HELP_DESKTOP_MORE_HLR_B",t.HELP_DESKTOP_MORE_INSIDE_B="HELP_DESKTOP_MORE_INSIDE_B",t.HELP_DESKTOP_MORE_MATTERTAG_B="HELP_DESKTOP_MORE_MATTERTAG_B",t.HELP_DESKTOP_MORE_TOUR_B="HELP_DESKTOP_MORE_TOUR_B",t.HELP_DESKTOP_MORE_VR_B="HELP_DESKTOP_MORE_VR_B",t.HELP_DESKTOP_MORE_ZOOM_B="HELP_DESKTOP_MORE_ZOOM_B",t.HELP_DESKTOP_PANORAMA_1A="HELP_DESKTOP_PANORAMA_1A",t.HELP_DESKTOP_PANORAMA_1B="HELP_DESKTOP_PANORAMA_1B",t.HELP_DESKTOP_PANORAMA_2A="HELP_DESKTOP_PANORAMA_2A",t.HELP_DESKTOP_PANORAMA_2B="HELP_DESKTOP_PANORAMA_2B",t.HELP_DESKTOP_PANORAMA_3A="HELP_DESKTOP_PANORAMA_3A",t.HELP_DESKTOP_PANORAMA_3B="HELP_DESKTOP_PANORAMA_3B",t.HELP_MOBILE_3="HELP_MOBILE_3",t.HELP_MOBILE_360_2="HELP_MOBILE_360_2",t.HELP_MOBILE_DOLLHOUSE_1="HELP_MOBILE_DOLLHOUSE_1",t.HELP_MOBILE_DOLLHOUSE_2="HELP_MOBILE_DOLLHOUSE_2",t.HELP_MOBILE_FLOORPLAN_1="HELP_MOBILE_FLOORPLAN_1",t.HELP_MOBILE_FLOORPLAN_2="HELP_MOBILE_FLOORPLAN_2",t.HELP_MOBILE_MORE_360_B="HELP_MOBILE_MORE_360_B",t.HELP_MOBILE_MORE_DOLLHOUSE_B="HELP_MOBILE_MORE_DOLLHOUSE_B",t.HELP_MOBILE_MORE_FLOORPLAN_B="HELP_MOBILE_MORE_FLOORPLAN_B",t.HELP_MOBILE_MORE_INSIDE_B="HELP_MOBILE_MORE_INSIDE_B",t.HELP_MOBILE_MORE_MATTERTAG_B="HELP_MOBILE_MORE_MATTERTAG_B",t.HELP_MOBILE_MORE_VR_B="HELP_MOBILE_MORE_VR_B",t.HELP_MOBILE_PANORAMA_1="HELP_MOBILE_PANORAMA_1",t.HELP_MOBILE_PANORAMA_2="HELP_MOBILE_PANORAMA_2",t.HELP_MORE_360_A="HELP_MORE_360_A",t.HELP_MORE_DOLLHOUSE_A="HELP_MORE_DOLLHOUSE_A",t.HELP_MORE_FLOORS_A="HELP_MORE_FLOORS_A",t.HELP_MORE_FLOORPLAN_A="HELP_MORE_FLOORPLAN_A",t.HELP_MORE_FULLSCREEN_A="HELP_MORE_FULLSCREEN_A",t.HELP_MORE_HLR_A="HELP_MORE_HLR_A",t.HELP_MORE_INSIDE_A="HELP_MORE_INSIDE_A",t.HELP_MORE_MATTERTAG_A="HELP_MORE_MATTERTAG_A",t.HELP_MORE_TOUR_A="HELP_MORE_TOUR_A",t.HELP_MORE_VR_A="HELP_MORE_VR_A",t.HELP_MORE_ZOOM_A="HELP_MORE_ZOOM_A",t.VR_APP_DL="VR_APP_DL",t.VR_APP_INSTRUCT="VR_APP_INSTRUCT",t.VR_APP_RECCOMMENDED="VR_APP_RECCOMMENDED",t.VR_APP_REQ="VR_APP_REQ",t.VR_ENTER="VR_ENTER",t.VR_LEARN_MORE_CAPS="VR_LEARN_MORE_CAPS",t.VR_QUEST="VR_QUEST",t.VR_RECOMMENDED="VR_RECOMMENDED",t.VR_SUPPORTS="VR_SUPPORTS",t.VR_VIEW_SPACE="VR_VIEW_SPACE",t.ERROR_WEBGL_UNSUPPORTED_PROBLEM="ERROR_WEBGL_UNSUPPORTED_PROBLEM",t.ERROR_BROWSER_SOLUTION="ERROR_BROWSER_SOLUTION",t.ERROR_BROWSER_EXPLANATION="ERROR_BROWSER_EXPLANATION",t.ERROR_LOADING_FAILED_PROBLEM="ERROR_LOADING_FAILED_PROBLEM",t.ERROR_LOADING_FAILED_ACTIONS_1="ERROR_LOADING_FAILED_ACTIONS_1",t.ERROR_LOADING_FAILED_ACTIONS_2="ERROR_LOADING_FAILED_ACTIONS_2",t.ERROR_GENERIC_PROBLEM="ERROR_GENERIC_PROBLEM",t.ERROR_GENERIC_SOLUTION="ERROR_GENERIC_SOLUTION",t.ERROR_GENERIC_ACTIONS_1="ERROR_GENERIC_ACTIONS_1",t.ERROR_GENERIC_ACTIONS_2="ERROR_GENERIC_ACTIONS_2",t.ERROR_GENERIC_ACTIONS_3="ERROR_GENERIC_ACTIONS_3",t.ERROR_GENERIC_ACTIONS_4="ERROR_GENERIC_ACTIONS_4",t.DESKTOP_SHORT_CTA="DESKTOP_SHORT_CTA",t.MOBILE_SHORT_CTA="MOBILE_SHORT_CTA",t.ROTATE="ROTATE",t.MOVE="MOVE",t.PLAY="PLAY",t.INSIDE="INSIDE",t.ZOOM="ZOOM",t.MEASUREMENT="MEASUREMENT",t.MEASUREMENT_START_ADDING="MEASUREMENT_START_ADDING",t.MEASUREMENT_CONTINUOUS_LINES="MEASUREMENT_CONTINUOUS_LINES",t.MEASUREMENT_SNAPPING="MEASUREMENT_SNAPPING",t.MEASUREMENT_UNITS="MEASUREMENT_UNITS",t.MEASUREMENT_IMPERIAL="MEASUREMENT_IMPERIAL",t.MEASUREMENT_METRIC="MEASUREMENT_METRIC",t.MEASUREMENT_SETTINGS="MEASUREMENT_SETTINGS",t.MEASUREMENT_HELP_CLICK_ANYWHERE="MEASUREMENT_HELP_CLICK_ANYWHERE",t.MEASUREMENT_HELP_ESCAPE="MEASUREMENT_HELP_ESCAPE",t.MEASUREMENT_HELP_PRESS_START="MEASUREMENT_HELP_PRESS_START",t.MEASUREMENT_HELP_DRAG_EDIT="MEASUREMENT_HELP_DRAG_EDIT",t.MEASUREMENT_HELP_PRESS_END="MEASUREMENT_HELP_PRESS_END",t.MEASUREMENT_MODE="MEASUREMENT_MODE",t.MEASUREMENT_HELP_MODAL_SUB_HEADER="MEASUREMENT_HELP_MODAL_SUB_HEADER",t.MEASUREMENT_HELP_MODAL_BODY_1="MEASUREMENT_HELP_MODAL_BODY_1",t.MEASUREMENT_HELP_MODAL_BODY_2="MEASUREMENT_HELP_MODAL_BODY_2",t.MEASUREMENT_NUDGE_TITLE="MEASUREMENT_NUDGE_TITLE",t.MEASUREMENT_NUDGE_MESSAGE="MEASUREMENT_NUDGE_MESSAGE",t.ON="ON",t.OFF="OFF",t.CLOSE="CLOSE",t.COPY="COPY",t.COPY_URL="COPY_URL",t.SHARE="SHARE",t.SHARE_COPIED="SHARE_COPIED",t.SHARE_CURRENT_LOCATION="SHARE_CURRENT_LOCATION",t.SHARE_DEFAULT_LOCATION="SHARE_DEFAULT_LOCATION",t.SHARE_ERROR_SWEEP_DISABLED="SHARE_ERROR_SWEEP_DISABLED",t.SHARE_EXPLORE="SHARE_EXPLORE",t.SHARE_LINK_TO_LOCATION="SHARE_LINK_TO_LOCATION",t.SHARE_AT="SHARE_AT",t.SHARE_WITH="SHARE_WITH",t.SHARE_3D="SHARE_3D",t.SHARE_MODAL_TITLE="SHARE_MODAL_TITLE",t.SHARED_TITLE="SHARED_TITLE",t.SHARED_MESSAGE="SHARED_MESSAGE",t.SHARED_MESSAGE_HASHTAG="SHARED_MESSAGE_HASHTAG"}(r||(r={})),e.a=r},function(t,e,n){"use strict";n.r(e);var r=n(4),i=n(583),o=n(0),a=n(2),s=n(120),c=n(358),u=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},l=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},h=new a.a("dam-loader"),f=function(){function t(){this.decoder=n(852).binary_mesh}return t.prototype.load=function(t,e,n){return u(this,void 0,Promise,(function(){var r;return l(this,(function(i){switch(i.label){case 0:return h.time("download"),[4,e.getFile(t,{responseType:"arraybuffer",onProgress:n})];case 1:return r=i.sent(),h.timeEnd("download"),[2,this.parse(r)]}}))}))},t.prototype.parse=function(t){h.time("parse proto");var e=this.decoder.read(new i(t));h.timeEnd("parse proto"),h.time("convert to webgl");var n=this.convertProtobufToSceneObject(e);return h.timeEnd("convert to webgl"),n},t.prototype.convertProtobufToSceneObject=function(t){if(0===t.chunk.length)return h.warn("No chunks in damfile..."),[];var e=new o.jb;return e.set(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),t.chunk.map((function(t){var n=new o.m;n.setAttribute("position",new o.l(new Float32Array(t.vertices.xyz,0,3),3)),t.vertices.uv.length>0&&n.setAttribute("uv",new o.l(new Float32Array(t.vertices.uv,0,2),2)),n.setIndex(new o.l(new Uint32Array(t.faces.faces,0,1),1)),n.applyMatrix4(e),n.computeBoundingBox();var r=Object(c.b)(t.chunk_name),i=r.floorIndex,a=r.roomIndex;return new s.a(i,a,n,t.material_name)}))},t}(),p=n(46);var d,y=function(){function t(){}return t.load=function(t,e,n,r){var i=this;void 0===r&&(r=0),p.e.highQualityDam&&0===r&&(r=1);var o=[{suffix:"_50k",extension:".dam"},{suffix:"",extension:".dam"}][r];if(!o)return Promise.reject("No suitable model file found...");var a=o.suffix,s=o.extension,c=new f,u=t+a+s;return c.load(u,e,n).catch((function(){return i.load(t,e,n,++r)}))},t}(),m=n(191),v=n(43),g=n(44),b=(d=function(t,e){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}d(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),w=function(t){function e(e){return t.call(this,e)||this}return b(e,t),e}(g.a),_=n(123),x=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),S=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},T=function(t){function e(e,n){void 0===n&&(n=v.a.ALL);var r=t.call(this)||this;return r.floorIndex=e,r.renderLayer=n,r.roomMeshes=new m.a((function(t){return t.roomIndex})),r._chunks=[],r.built=!1,r.name="FloorMesh:"+e,r}return x(e,t),e.prototype.dispose=function(){var t,e;try{for(var n=S(this.roomMeshes),r=n.next();!r.done;r=n.next()){var i=r.value;i.geometry.dispose(),this.remove(i)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.roomMeshes.clear()},e.prototype.addChunk=function(t){var e=this.getOrCreateRoomMesh(t.roomIndex);this._chunks.push(t),e.addChunk(t)},e.prototype.getOrCreateRoomMesh=function(t){var e=this.roomMeshes.get(t);return e||(e=new _.a(this.floorIndex,t,this.renderLayer),this.roomMeshes.add(e),this.add(e)),e},e.prototype.build=function(){var t,e;if(this.built)throw new Error("build() should only be called once");this.boundingBox=new o.h;try{for(var n=S(this.roomMeshes),r=n.next();!r.done;r=n.next()){var i=r.value;this.boundingBox.union(i.boundingBox)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.center=this.boundingBox.getCenter(new o.Jc),this.size=this.boundingBox.getSize(new o.Jc),this.built=!0},Object.defineProperty(e.prototype,"chunks",{get:function(){return this._chunks},enumerable:!0,configurable:!0}),e}(o.zb),M=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),E=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},P=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},O=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},A=new a.a("mesh"),D=function(t){function e(e,n,r,i){void 0===r&&(r=v.a.ALL);var o=t.call(this)||this;return o.renderLayer=r,o.maxEdgeLength=i,o.floorMeshes=new m.a((function(t){return t.floorIndex})),o.built=!1,o._chunks=[],o.uuid=e,o.name="ModelMesh:"+e,o.signedUrls=n,o.layers.mask=r.mask,o}return M(e,t),e.prototype.dispose=function(){var t,e;try{for(var n=O(this.floorMeshes),r=n.next();!r.done;r=n.next()){var i=r.value;i.dispose(),this.remove(i)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.floorMeshes.clear()},e.prototype.load=function(t){return void 0===t&&(t={}),E(this,void 0,Promise,(function(){var e,n,r,i,a,c,u,l,h,f,p,d,m,v,g,b,_=this;return P(this,(function(x){switch(x.label){case 0:return t.chunks?(c=t.chunks,[3,3]):[3,1];case 1:return[4,y.load(this.uuid,this.signedUrls,t.onProgress).catch((function(t){throw new w(t)}))];case 2:c=x.sent(),x.label=3;case 3:0===(a=c).length&&(A.warn("No geometry found for model, loading faux geometry, disabling outside view-mode"),(u=new o.Ib(5,5,1,1)).rotateX(-Math.PI/2),u.computeBoundingBox(),(l=new s.a(0,0,u)).forEachMaterial((function(t){return t.visible=!1})),a=[l]),a.forEach((function(t,e){_.addChunk(t)})),h=0,f=0;try{for(p=O(this.floorMeshes),d=p.next();!d.done;d=p.next()){m=d.value;try{for(v=O(m.roomMeshes),g=v.next();!g.done;g=v.next())(b=g.value).build(),h++,this.maxEdgeLength&&b.tessellate(this.maxEdgeLength)}catch(t){r={error:t}}finally{try{g&&!g.done&&(i=v.return)&&i.call(v)}finally{if(r)throw r.error}}m.build(),f++}}catch(t){e={error:t}}finally{try{d&&!d.done&&(n=p.return)&&n.call(p)}finally{if(e)throw e.error}}return this.build(),A.debug("FloorMeshes: "+f+" RoomMeshes: "+h+" Chunks: "+a.length),[2,this]}}))}))},e.prototype.addChunk=function(t){var e=this.getOrCreateFloorMesh(t.floorIndex);this._chunks.push(t),e.addChunk(t)},e.prototype.getOrCreateFloorMesh=function(t){var e=this.floorMeshes.get(t);return e||(e=new T(t,this.renderLayer),this.floorMeshes.add(e),this.add(e)),e},e.prototype.build=function(){var t,e;if(this.built)throw new Error("build() should only be called once");this.boundingBox=new o.h;try{for(var n=O(this.floorMeshes),r=n.next();!r.done;r=n.next()){var i=r.value;this.boundingBox.union(i.boundingBox)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.size=this.boundingBox.getSize(new o.Jc),this.center=this.boundingBox.getCenter(new o.Jc),this.built=!0},Object.defineProperty(e.prototype,"chunks",{get:function(){return this._chunks},enumerable:!0,configurable:!0}),e}(o.zb),R=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},C=function(){function t(t,e,n){this.addToRaycasting=t,this.removeFromRaycasting=e,this.mesh=n,this.clear()}return t.prototype.dispose=function(){this.clear()},t.prototype.activate=function(t){var e,n,r,i,o,a,s={};try{for(var c=R(Object.keys(this.groupNames)),u=c.next();!u.done;u=c.next()){var l=u.value;try{for(var h=R(this.groupColliders[l]),f=h.next();!f.done;f=h.next()){s[(y=f.value).id]=!0,this.addToRaycasting(y,!0)}}catch(t){r={error:t}}finally{try{f&&!f.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(e)throw e.error}}try{for(var p=R(this.allColliders),d=p.next();!d.done;d=p.next()){var y;s[(y=d.value).id]||this.addToRaycasting(y,!0)}}catch(t){o={error:t}}finally{try{d&&!d.done&&(a=p.return)&&a.call(p)}finally{if(o)throw o.error}}},t.prototype.deactivate=function(t){var e,n;try{for(var r=R(this.allColliders),i=r.next();!i.done;i=r.next()){var o=i.value;this.removeFromRaycasting(o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.init=function(){var t,e,n,r;try{for(var i=R(this.mesh.floorMeshes),o=i.next();!o.done;o=i.next()){var a=o.value,s=this.groupColliders[a.floorIndex];s||(this.groupColliders[a.floorIndex]=s=[]);try{for(var c=R(a.roomMeshes),u=c.next();!u.done;u=c.next()){var l=u.value;s.push(l),this.allColliders.push(l)}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},t.prototype.setSide=function(t){var e,n;try{for(var r=R(this.allColliders),i=r.next();!i.done;i=r.next()){var o=i.value;this.setSideRecursively(o,t)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.setSideRecursively=function(t,e){var n,r;t instanceof o.lb&&t.material&&t.material instanceof o.mb&&(t.material.side=e);try{for(var i=R(t.children),a=i.next();!a.done;a=i.next()){var s=a.value;this.setSideRecursively(s,e)}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype.getReadonlyColliderList=function(){return this.allColliders},t.prototype.getReadonlyColliderListForGroup=function(t){return this.groupColliders[t]},t.prototype.getGroupName=function(t){return this.groupNames[t]},t.prototype.render=function(){},t.prototype.setVisible=function(t){var e,n;if(this._visible!==t){this._visible=t;try{for(var r=R(this.allColliders),i=r.next();!i.done;i=r.next()){i.value.visible=t}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}},t.prototype.clear=function(){this.allColliders=[],this.groupColliders={},this.groupNames={}},t}(),I=n(1),k=n(17),L=n(12),N=n(26),j=n(56),B=n(180),F=n(110),U=n(83),z=n(20),G=n(309),H=n(411),V=n(57),W=n(18),q=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},Y=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},J=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},X=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},K=new a.a("modelrenderer"),Q=function(){function t(t,e,n,r,i,a,s,c){var u,l=this;this.scene=t,this.mesh=e,this.modelCollider=n,this.panoRenderer=r,this.meshData=i,this.sweepData=a,this.applicationData=s,this.renderOptions=c,this.chunkRenderingModeOverride=null,this.lastChunkRenderingModeOverride=null,this.fallbackMesh=new H.a,this.bindings=[],this.updateFallbackMesh=(u=new o.h,function(){if(l.sweepData.currentAlignedSweepObject&&l.viewmodeData.currentMode===I.a.Panorama){var t=u.copy(l.meshData.bounds).expandByScalar(.2);l.fallbackMesh.setBounds(t)}else l.cameraData&&l.fallbackMesh.setFromCenterAndSize(l.cameraData.pose.position)})}return t.prototype.init=function(){},t.prototype.dispose=function(){this.mesh.dispose()},t.prototype.activate=function(t){return q(this,void 0,void 0,(function(){var e,n,r,i,a,c,u,l,h,f,d,y,m,v,g,b,w,_,x=this;return Y(this,(function(S){switch(S.label){case 0:return[4,Promise.all([t.market.waitForData(k.a),t.market.waitForData(N.a),t.market.waitForData(W.a),t.getModule(j.default)])];case 1:for(y in e=J.apply(void 0,[S.sent(),4]),this.viewmodeData=e[0],this.settings=e[1],this.cameraData=e[2],this.settingsModule=e[3],this.scene.add(this.mesh),this.scene.add(this.fallbackMesh),this.fallbackMesh.layers.mask=this.mesh.layers.mask,this.updateRenderState(),this.bindings.push(this.viewmodeData.onChanged(this.updateRenderState.bind(this)),this.sweepData.onChanged(this.updateRenderState.bind(this)),this.settings.onChanged(this.updateRenderState.bind(this)),t.commandBinder.addBinding(B.a,(function(t){return q(x,void 0,void 0,(function(){return Y(this,(function(e){return this.chunkRenderingModeOverride=t.mode,this.updateRenderState(),[2]}))}))}))),this.settingsModule.registerButton("Mesh","Toggle visible",(function(){var t,e;try{for(var n=X(x.mesh.floorMeshes),r=n.next();!r.done;r=n.next()){var i=r.value;i.visible=!i.visible}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}})),this.settingsModule.registerButton("Mesh","Toggle depth",(function(){var e=x.chunkRenderingModeOverride?null:s.b.Depth;t.commandBinder.issueCommand(new B.a(e))})),this.settingsModule.registerButton("Mesh","Toggle transparent",(function(){var e=x.chunkRenderingModeOverride?null:s.b.Transparent;t.commandBinder.issueCommand(new B.a(e))})),this.settingsModule.registerButton("Mesh","Toggle wireframe",(function(){var e=x.chunkRenderingModeOverride?null:s.b.Wireframe;t.commandBinder.issueCommand(new B.a(e))})),a=!1,c=function(t,e){var n=new o.Kc(1,1,1,0);a=!a,function(t){var r,i,o,a,s,c;try{for(var u=X(x.mesh.floorMeshes),l=u.next();!l.done;l=u.next()){var h=l.value;try{for(var f=X(h.roomMeshes),p=f.next();!p.done;p=f.next()){var d=p.value,y=t?Object(G.b)(.5):n;try{for(var m=X(d.chunks),v=m.next();!v.done;v=m.next()){var g=v.value;e&&(y=t?Object(G.b)(.5):n),g.setColorOverlay(y)}}catch(t){s={error:t}}finally{try{v&&!v.done&&(c=m.return)&&c.call(m)}finally{if(s)throw s.error}}}}catch(t){o={error:t}}finally{try{p&&!p.done&&(a=f.return)&&a.call(f)}finally{if(o)throw o.error}}}}catch(t){r={error:t}}finally{try{l&&!l.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}}(t||a)},this.renderOptions.colorizeRooms&&c(!0),this.renderOptions.colorizeChunks&&c(!0,!0),this.settingsModule.registerButton("Mesh","Highlight Rooms",c),this.settingsModule.registerButton("Mesh","Highlight Chunks",(function(){return c(!a,!0)})),u=!1,this.settingsModule.registerButton("Mesh","Toggle flat shading",(function(){var t,e;u=!u;try{for(var n=X(x.mesh.chunks),r=n.next();!r.done;r=n.next()){r.value.setFlatShading(u)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}})),this.settingsModule.registerButton("Mesh","Cycle all chunk materials",(function(){l()})),l=function(){return q(x,void 0,void 0,(function(){var e,n,r,i,a,c,u,l,h,f,p,d,y,m,v,g,b,w,_,x,S,T,M,E,P,O;return Y(this,(function(A){switch(A.label){case 0:for(h in u=100,l=[],U.a)isNaN(Number(h))&&l.push(U.a[h]);for(p in f=[],s.b)isNaN(Number(p))&&f.push(s.b[p]);for(K.info("Available ChunkMaterialCapabilities: "+l),d=[],v=0;v<1<<l.length-1;v++){for(w={},y=l.length-1;y>=0;y--)m=l[y],w[m]=Boolean(v&1<<y);d.push(w)}K.info("There are "+d.length*f.length+" options to test"),v=0,A.label=1;case 1:return v<f.length?[4,t.commandBinder.issueCommand(new B.a(v))]:[3,13];case 2:A.sent(),A.label=3;case 3:A.trys.push([3,8,9,10]),g=X(d),b=g.next(),A.label=4;case 4:if(b.done)return[3,7];w=b.value,K.info("Testing ChunkRenderingMode."+s.b[v]+" with capabilities: "+JSON.stringify(w,void 0,2)),_=new o.Kc(Math.random(),Math.random(),Math.random(),.5);try{for(x=X(Object.keys(w)),S=x.next();!S.done;S=x.next()){T=S.value;try{for(M=X(this.mesh.chunks),E=M.next();!E.done;E=M.next())(P=E.value).setColorOverlay(_),P.setMeshPreviewSphere(new o.Jc(0,0,0)),P.overrideCapability(T,w[T])}catch(t){a={error:t}}finally{try{E&&!E.done&&(c=M.return)&&c.call(M)}finally{if(a)throw a.error}}}}catch(t){r={error:t}}finally{try{S&&!S.done&&(i=x.return)&&i.call(x)}finally{if(r)throw r.error}}return[4,Object(z.d)(u)];case 5:A.sent(),A.label=6;case 6:return b=g.next(),[3,4];case 7:return[3,10];case 8:return O=A.sent(),e={error:O},[3,10];case 9:try{b&&!b.done&&(n=g.return)&&n.call(g)}finally{if(e)throw e.error}return[7];case 10:return[4,Object(z.d)(u)];case 11:A.sent(),A.label=12;case 12:return v++,[3,1];case 13:return[4,t.commandBinder.issueCommand(new B.a(null))];case 14:return A.sent(),[2]}}))}))},h=function(t,e,n,r,i){x.settingsModule.registerSetting(t,e,n,!0,j.SettingPersistence.NONE,i),x.settings.onPropertyChanged(e,r)},f=function(t){var e,n;try{for(var r=X(x.mesh.chunks),i=r.next();!i.done;i=r.next()){i.value.setWireframe(t)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},this.renderOptions.wireframe&&f(!0),h("Wireframe",p.c,!1,f),(n={})[U.a.Wireframe]={Wireframe:["thickness","wireframeOpacity","stroke","fillEnabled","fill","insideAltColor","dualStroke","secondThickness"],"Wireframe Dashes":["dashEnabled","dashLength","dashAnimate","dashOverlap"],"Wireframe Advanced":["squeeze","squeezeMin","squeezeMax"]},d=n)for(v in m=F.a.modelChunk.uniforms[y],d[y]){g=function(t){h(v,t,m[t].value,(function(e){var n,r;try{for(var i=X(x.mesh.chunks),o=i.next();!o.done;o=i.next()){o.value.setMaterialsUniform(t,e)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}),m[t].range)};try{for(b=X(d[y][v]),w=b.next();!w.done;w=b.next())_=w.value,g(_)}catch(t){r={error:t}}finally{try{w&&!w.done&&(i=b.return)&&i.call(b)}finally{if(r)throw r.error}}}return[2]}}))}))},t.prototype.deactivate=function(t){var e,n;try{for(var r=X(this.bindings),i=r.next();!i.done;i=r.next()){i.value.cancel()}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}this.bindings=[],this.scene.remove(this.mesh),this.scene.remove(this.fallbackMesh),this.currentSweepId&&this.panoRenderer.freeTexture(this.currentSweepId),this.currentSweepId=null,this.targetSweepId=null},t.prototype.updateSweepRenderTarget=function(t,e,n,r){var i,o,a=this.panoRenderer.useTexture(e);if(a)try{for(var s=X(this.allChunks()),c=s.next();!c.done;c=s.next()){c.value.setProjectedPano(t,n,r,a)}}catch(t){i={error:t}}finally{try{c&&!c.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}},t.prototype.allChunks=function(){return Y(this,(function(t){switch(t.label){case 0:return[5,X(this.mesh.chunks)];case 1:return t.sent(),[4,this.fallbackMesh.chunk];case 2:return t.sent(),[2]}}))},t.prototype.updateExistingTexture=function(t,e,n,r){var i,o;try{for(var a=X(this.allChunks()),s=a.next();!s.done;s=a.next()){var c=s.value;t===this.currentSweepId&&c.setProjectedPano(0,n,r,e),t===this.targetSweepId&&c.setProjectedPano(1,n,r,e)}}catch(t){i={error:t}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(i)throw i.error}}},t.prototype.render=function(){},t.prototype.beforeRender=function(){var t,e,n=!this.displayingUnaligned(this.sweepData,this.viewmodeData);this.mesh.visible=n,this.modelCollider.setVisible(n);try{for(var r=X(this.mesh.chunks),i=r.next();!i.done;i=r.next()){var o=i.value;o.setMeshTextureOpacity(this.meshData.opacity.value),o.setProgress(this.sweepData.transition.progress.value)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}var a=Object(V.g)(this.meshData.opacity.value,0,1,1);this.fallbackMesh.chunk.setMeshTextureOpacity(a),this.fallbackMesh.chunk.setProgress(this.sweepData.transition.progress.value),this.updateFallbackMesh()},t.prototype.displayingUnaligned=function(t,e){return e.closestMode===I.a.Panorama&&!!t.currentSweep&&t.isSweepUnaligned(t.currentSweep)},t.prototype.updateChunkMaterialMode=function(t,e){var n,r,i=e||s.b.Standard,a=t?o.w:o.G;try{for(var c=X(this.mesh.chunks),u=c.next();!u.done;u=c.next()){var l=u.value;l.setRenderingMode(i),l.setSide(a)}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}},t.prototype.updateChunkedColliderSide=function(t){var e=t===I.a.Panorama?o.w:o.G;this.modelCollider.setSide(e)},t.prototype.updateRenderState=function(){if(this.mesh.visible=this.settings.tryGetProperty(p.b,!0),this.viewmodeData.currentMode!==this.lastViewmode||this.lastChunkRenderingModeOverride!==this.chunkRenderingModeOverride){this.lastChunkRenderingModeOverride=this.chunkRenderingModeOverride;var t=this.viewmodeData.currentMode===I.a.Panorama;this.updateChunkMaterialMode(t,this.chunkRenderingModeOverride),this.viewmodeData.currentMode&&this.updateChunkedColliderSide(this.viewmodeData.currentMode),this.lastViewmode=this.viewmodeData.currentMode}if(this.viewmodeData.transition.active&&this.viewmodeData.transition.to===I.a.Panorama||this.viewmodeData.currentMode===I.a.Panorama){var e=this.sweepData.currentSweep,n=this.sweepData.transition,r=n.active&&(this.applicationData.phase===L.a.PLAYING||this.applicationData.phase===L.a.STARTING),i=r?n.from:e,o=r?n.to:e;this.currentSweepId=this.handleSweepChange(0,this.sweepData,this.currentSweepId,i||null),this.targetSweepId=this.handleSweepChange(1,this.sweepData,this.targetSweepId,o||null)}},t.prototype.handleSweepChange=function(t,e,n,r){if(n!==r&&(n&&this.panoRenderer.freeTexture(n),r)){var i=e.getSweep(r);this.updateSweepRenderTarget(t,r,i.position,i.rotation)}return r},t}(),Z=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},$=function(t){var e=this;this.getChunks=t,this.enabled=null,this.toggleEnabled=function(t){var n,r;if(t!==e.enabled){try{for(var i=Z(e.getChunks()),o=i.next();!o.done;o=i.next())o.value.setColorOverlay(t?p.d:null)}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}e.enabled=t}}},tt=n(584),et=n(25),nt=n(96),rt=n(91),it=n(31),ot=n(308),at=n(276),st=n(176),ct=n(112),ut=n(98),lt=n(159),ht=n(52),ft=n(359),pt=n(15),dt=n(174),yt=n(178),mt=n(158),vt=n(22),gt=n(111),bt=n(3),wt=n(209),_t=n(207),xt=n(237),St=n(62);n.d(e,"TextureLOD",(function(){return Tt}));var Tt,Mt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Et=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},Pt=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Ot=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},At=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};!function(t){t[t.NONE=0]="NONE",t[t.RAYCAST=1]="RAYCAST"}(Tt||(Tt={}));var Dt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="model-mesh",e.renderingMesh=!0,e.colorOverlay=null,e.toggleMeshOverlayColor=function(t){e.colorOverlay||(e.colorOverlay=new $((function(){return e.modelMesh.chunks}))),e.colorOverlay.toggleEnabled(t)},e}return Mt(e,t),e.prototype.init=function(t,e){return Et(this,void 0,void 0,(function(){var n,r,i,a,s,c,u,l,h,f,p,d,y,m,v,g,b,w,_,x,S,T,M,E,P=this;return Pt(this,(function(O){switch(O.label){case 0:return this.market=e.market,[4,Promise.all([e.getModule(et.default),e.getModule(rt.default),e.getModule(nt.default),e.getModule(it.default),e.market.waitForData(W.a),e.market.waitForData(k.a),e.market.waitForData(pt.a)])];case 1:return n=Ot.apply(void 0,[O.sent(),7]),r=n[0],i=n[1],a=n[2],s=n[3],c=n[4],u=n[5],l=n[6],this.viewmodeData=u,h=r.getScene(),f=a.getSignedUrls(),p=a.getModel().uuid,this.renderingMesh=!!t.renderMeshGeometry,[4,e.getModuleByParent(st.a)];case 2:return d=O.sent(),this.panoRenderer=d.getRenderer(),this.modelMesh=new D(p,f,e.claimRenderLayer(this.name),t.maxEdgeLength),[4,this.modelMesh.load({onProgress:function(t){e.broadcast(new at.a(t.loaded,t.total))}})];case 3:return y=O.sent(),m=y.boundingBox.clone(),v=new o.h,l.iterate((function(t){t.placementType!==vt.b.UNPLACED&&(v.setFromCenterAndSize(t.position,bt.b.UNIT),m.union(v))})),this.meshData=new dt.a(0,m),this.market.register(this,dt.a,this.meshData),t.renderMeshGeometry?[4,e.getModule(lt.default)]:[3,5];case 4:b=O.sent(),this.modelTextureLoader=new tt.a(t.textureLOD,f,this.modelMesh,h.camera,c,r.cwfRenderer,b,i.picking,h,e),w=!1,x=u.currentMode,S=function(){var e=_===St.b.VrOrientOnly||_===St.b.VrWithController||_===St.b.VrWithTrackedController,n=P.modelTextureLoader.textureCount<=t.textureLODThreshold?ht.e.ULTRA:ht.e.MEDIUM,r=Math.max(n,x===I.a.Panorama&&0===P.meshData.opacity.value?n:t.maxQuality);P.modelTextureLoader.setQuality(n,r);var i=x!==I.a.Dollhouse&&x!==I.a.Floorplan,o=u.transition.active&&u.transition.to===I.a.Panorama;P.modelTextureLoader.autoLoadTiles=!(e||o||w&&i)&&t.textureLOD!==Tt.NONE},T=this.meshData.opacity,this.bindings.push(this.meshData.onChanged((function(t){t.opacity!==T&&S(),T=t.opacity})),e.subscribe(ct.a,(function(t){P.startOpacityTransition(),x=t.toMode,w=!0,S()})),e.subscribe(ut.a,(function(t){w=!1,x=t.toMode,S()})),e.subscribe(gt.c,(function(){w=!0,S()})),e.subscribe(gt.f,(function(){w=!1,S()})),e.subscribe(wt.a,(function(){w=!0,S()})),e.subscribe(mt.a,(function(t){l.getSweep(t.toSweep).alignmentType===vt.a.UNALIGNED&&P.setMeshOpacity(0)})),e.subscribe(_t.a,(function(){w=!1,S()})),e.subscribe(xt.a,(function(t){_=t.mode,S()})),e.subscribe(ot.a,(function(t){P.renderer.updateExistingTexture(t.sweepId,t.renderTarget.texture)}))),M=t.textureLOD!==Tt.NONE?ht.e.LOW:t.maxQuality,g=this.modelTextureLoader.loadAll(M).then((function(){S()})),O.label=5;case 5:return this.modelCollider=new C(s.registerMesh,s.unregisterMesh,y),i.setupOctree(y),e.addComponent(this,this.modelCollider),t.renderMeshGeometry?[4,e.market.waitForData(L.c)]:[3,8];case 6:return E=O.sent(),this.renderer=new Q(h.scene,y,this.modelCollider,this.panoRenderer,this.meshData,l,E,t),e.addComponent(this,this.renderer),[4,g];case 7:O.sent(),O.label=8;case 8:return e.broadcast(new at.b(this.modelMesh)),this.bindings.push(e.commandBinder.addBinding(yt.a,(function(t){return Et(P,void 0,void 0,(function(){return Pt(this,(function(e){return[2,this.setMeshOpacity(t.value)]}))}))})),e.commandBinder.addBinding(ft.a,(function(t){return Et(P,void 0,void 0,(function(){return Pt(this,(function(e){return[2,this.toggleMeshOverlayColor(t.enabled)]}))}))}))),[2]}}))}))},e.prototype.onUpdate=function(t){var e,n;this.modelTextureLoader&&this.modelTextureLoader.update(t),this.meshData.opacity.active&&(this.meshData.opacity.updateProgress(this.viewmodeData.transition.progress),this.meshData.commit());var r=performance.now()/1e3;try{for(var i=At(this.modelMesh.chunks),o=i.next();!o.done;o=i.next()){o.value.setTime(r)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}},Object.defineProperty(e.prototype,"mesh",{get:function(){return this.modelMesh},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"collider",{get:function(){return this.modelCollider},enumerable:!0,configurable:!0}),e.prototype.startOpacityTransition=function(){var t=this.viewmodeData.transition.to,e=this.meshData.opacity.value,n=t===I.a.Panorama?0:1,r=t===I.a.Panorama?V.b:V.g;this.meshData.opacity.value!==n&&this.meshData.opacity.modifyAnimation(e,n,1,r)},e.prototype.setMeshOpacity=function(t){this.meshData.opacity.modifyAnimation(t,t,0),this.meshData.commit()},e.prototype.isRenderingMesh=function(){return this.renderingMesh},e.prototype.getPanoRenderer=function(){return this.panoRenderer},e}(r.a);e.default=Dt},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r,i=n(23),o=n(62),a=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.name="interaction",n._source=e.defaultSource,n._mode=e.defaultMode,n}return a(e,t),Object.defineProperty(e,"defaultMode",{get:function(){return o.b.Desktop},enumerable:!0,configurable:!0}),Object.defineProperty(e,"defaultSource",{get:function(){return o.a.None},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mode",{get:function(){return this._mode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"source",{get:function(){return this._source},enumerable:!0,configurable:!0}),e.prototype.updateSource=function(t){this._source=t},e.prototype.updateMode=function(t){this._mode=t},e.prototype.copy=function(t){this.updateMode(t.mode),this.updateSource(t.source)},e.prototype.hasController=function(t){return void 0===t&&(t=this.mode),t===o.b.VrWithController||t===o.b.VrWithTrackedController},e.prototype.isVR=function(t){return void 0===t&&(t=this.mode),t===o.b.VrOrientOnly||t===o.b.VrWithController||t===o.b.VrWithTrackedController},e.prototype.isMobile=function(t){return void 0===t&&(t=this.mode),t===o.b.Mobile},e}(i.a)},function(t,e,n){"use strict";n.d(e,"e",(function(){return i})),n.d(e,"d",(function(){return a})),n.d(e,"a",(function(){return s})),n.d(e,"c",(function(){return c})),n.d(e,"b",(function(){return u})),n.d(e,"f",(function(){return l}));var r,i,o=n(0);!function(t){t[t.LOW=1]="LOW",t[t.MEDIUM=2]="MEDIUM",t[t.HIGH=3]="HIGH",t[t.ULTRA=4]="ULTRA"}(i||(i={}));var a=((r={})[i.LOW]={debugColor:new o.Kc(1,0,0,.5),textureSize:256,tileSize:256,assetType:"low",assetSize:512,texelSize:.096},r[i.MEDIUM]={debugColor:new o.Kc(1,1,0,.5),textureSize:512,tileSize:512,assetType:"low",assetSize:512,texelSize:.048},r[i.HIGH]={debugColor:new o.Kc(0,1,0,.5),textureSize:1024,tileSize:512,assetType:"high",assetSize:2048,texelSize:.024},r[i.ULTRA]={debugColor:new o.Kc(0,1,1,.5),textureSize:2048,tileSize:512,assetType:"high",assetSize:2048,texelSize:.012},r),s=[i.LOW,i.MEDIUM,i.HIGH,i.ULTRA],c=s[0],u=s[s.length-1],l=function(t){for(var e in a)if(a[e].tileSize===t)return parseInt(e,10);throw new Error("Not a valid texture size: "+t)}},function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return p}));var r,i,o,a=n(23),s=n(33),c=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),u=function(){return(u=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},l=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},h=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},f=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};!function(t){t[t.Inactive=0]="Inactive",t[t.Active=1]="Active",t[t.StopScheduled=2]="StopScheduled"}(i||(i={})),function(t){t[t.Beginning=0]="Beginning",t[t.Current=1]="Current",t[t.End=2]="End"}(o||(o={}));var p=function(t){function e(e,n,r,o,a){void 0===e&&(e={});var c=t.call(this)||this;return c.snapshots=e,c.activeReel=n,c.allowedModes=r,c.modelSweeps=o,c.looping=a,c.name="tour",c.enabledTourStops=[],c.tourPlaying=!1,c.tourEnded=!1,c.updateEnabledStops=function(t){var e,n;if(c.enabledTourStops=[],c.activeReel&&c.activeReel.reel){var r=function(e){if(e&&e.sid in c.snapshots){var n=c.snapshots[e.sid],r=n.metadata.camera_mode,i=n.metadata.scan_id,o=-1!==t.indexOf(r),a=c.modelSweeps.findIndex((function(t){return t.id===i})),s=void 0!==i&&-1!==a&&c.modelSweeps[a].enabled;o&&(!i||s)&&c.enabledTourStops.push(e.sid)}};try{for(var i=f(c.activeReel.reel),o=i.next();!o.done;o=i.next()){r(o.value)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}}},c.updateEnabledStops(r),c.tourState=i.Inactive,c.tourCurrentSnapshot=-1,c.transition={active:!1,type:s.c.Move,promise:Promise.resolve(),stop:function(){return Promise.resolve()},toIndex:-1},c.looping=a,c.commit(),c}return c(e,t),e.prototype.addSnapshotToTour=function(t,e){void 0===e&&(e=o.Current),this.snapshots[t.sid]=t,t.metadata.camera_mode in this.allowedModes&&this.enabledTourStops.push(t.sid);var n=this.tourCurrentSnapshotSid;switch(this.tourCurrentSnapshotSid=t.sid,e){case o.Beginning:this.tourCurrentSnapshot=0,this.activeReel.reel.insert(0,{sid:t.sid});break;case o.End:this.tourCurrentSnapshot=this.enabledTourStops.length-1,this.activeReel.reel.push({sid:t.sid});break;case o.Current:if(void 0===n)this.tourCurrentSnapshot=this.enabledTourStops.length-1,this.activeReel.reel.push({sid:t.sid});else{var r=this.activeReel.reel.findIndex((function(t){return!!t&&t.sid===n}))+1;(r<=0||r>this.activeReel.reel.length)&&(r=this.activeReel.reel.length-1),this.tourCurrentSnapshot=this.tourCurrentSnapshot+1,this.activeReel.reel.insert(r,{sid:t.sid})}break;default:throw new Error("Tours.addSnapshotToTour not implemented: "+e)}this.commit()},e.prototype.clearHighlightOverrides=function(t,e,n){if(e||n){var r={};e&&(r.transitionType=void 0),n&&(r.panDirection=void 0,r.panAngle=void 0),this.applyHighlightOverrides(t,r)}},e.prototype.clearAllHighlightOverrides=function(){var t=this;this.getReel().reel.forEach((function(e){e&&t.clearHighlightOverrides(e.sid,!0,!0)}))},e.prototype.resetAllTransitionTypeOverrides=function(){var t=this;if(this.activeReel&&this.activeReel.reel){var e=!1;this.activeReel.reel.forEach((function(n,r){n&&n.overrides&&n.overrides.transitionType&&(delete n.overrides.transitionType,t.activeReel.reel.update(r,n),e=!0)})),e&&this.activeReel.setDirty()}},e.prototype.resetAllPanSettingOverrides=function(){var t=this;if(this.activeReel&&this.activeReel.reel){var e=!1;this.activeReel.reel.forEach((function(n,r){n&&n.overrides&&(void 0===n.overrides.panAngle&&void 0===n.overrides.panDirection||(delete n.overrides.panAngle,delete n.overrides.panDirection,e=!0,t.activeReel.reel.update(r,n)))})),e&&this.activeReel.setDirty()}},e.prototype.applyHighlightOverrides=function(t,e){var n=this.activeReel.reel.findIndex((function(e){return!!e&&e.sid===t}));this.setHighlightOverrides(n,e)},e.prototype.setHighlightOverrides=function(t,e){var n=this.activeReel.reel.get(t);if(!n)throw Error("Highlight not found for "+t);var r={sid:n.sid};n.overrides?(r.overrides=u({},n.overrides),e.hasOwnProperty("panDirection")&&(r.overrides.panDirection=e.panDirection),e.hasOwnProperty("transitionType")&&(r.overrides.transitionType=e.transitionType),e.hasOwnProperty("panAngle")&&(r.overrides.panAngle=e.panAngle)):r.overrides={transitionType:e.transitionType,panDirection:e.panDirection,panAngle:e.panAngle},this.activeReel.reel.update(t,r)},e.prototype.moveTourStop=function(t,e){var n=this.activeReel.reel.findIndex((function(e){return!!e&&e.sid===t})),r=this.activeReel.reel.findIndex((function(t){return!!t&&t.sid===e}));this.activeReel.reel.move(n,r)},e.prototype.clear=function(){this.resetEmptyReel(),this.enabledTourStops.length=0,this.activeReel.reel.length=0,this.commit()},e.prototype.removeTourStop=function(t){var e=this.enabledTourStops.indexOf(t),n=this.activeReel.reel.findIndex((function(e){return!!e&&e.sid===t})),r=this.getTourIndexBySid(t);if(-1!==e&&this.enabledTourStops.splice(e,1),this.enabledTourStops.length>0){var i=r<=this.tourCurrentSnapshot?this.tourCurrentSnapshot-1:this.tourCurrentSnapshot;this.setTourCurrentSnapshotByIndex(Math.max(i,0))}else this.resetEmptyReel();this.activeReel.reel.remove(n)},e.prototype.getReel=function(){return this.activeReel},e.prototype.clone=function(){var t,n,r=new e({},this.activeReel,this.allowedModes,this.modelSweeps,this.looping);try{for(var i=f(Object.keys(this.snapshots)),o=i.next();!o.done;o=i.next()){var a=o.value,s=this.snapshots[a];r.snapshots[a]=s.clone()}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r},e.prototype.copy=function(t){for(var e in t.snapshots)this.snapshots[e]=t.snapshots[e];this.activeReel=t.activeReel,this.allowedModes=t.allowedModes,this.tourState=t.tourState,this.tourPlaying=t.tourPlaying,this.tourEnded=t.tourEnded,this.tourCurrentSnapshot=t.tourCurrentSnapshot,this.tourCurrentSnapshotSid=t.tourCurrentSnapshotSid,this.modelSweeps=t.modelSweeps,this.looping=t.looping,this.updateEnabledStops(this.allowedModes)},e.prototype.isLooping=function(){return this.looping},e.prototype.isTourActive=function(){return this.tourState!==i.Inactive},e.prototype.getCurrentTourState=function(){return{currentStep:this.getTourCurrentSnapshotIndex(),tourPlaying:this.tourPlaying,totalSteps:this.getSnapshotCount(),tourEnded:this.tourEnded,activeStep:this.transition&&-1!==this.transition.toIndex?this.transition.toIndex:this.getTourCurrentSnapshotIndex(),highlights:this.getReelHighlights(),transition:this.transition}},e.prototype.isTourTransitionActive=function(){return this.transition.active},e.prototype.getTourTransitionType=function(){return this.transition.type},e.prototype.useTransition=function(t){this.transition=t},e.prototype.setTourTransitionToIndex=function(t){this.transition.toIndex=t},e.prototype.stopTourTransition=function(){return l(this,void 0,Promise,(function(){return h(this,(function(t){switch(t.label){case 0:return[4,this.transition.stop()];case 1:return t.sent(),[2]}}))}))},e.prototype.iterateSnapshots=function(t){var e=this,n=0;this.activeReel.reel.forEach((function(r){if(r&&e.isEnabled(r.sid)){var i=e.snapshots[r.sid];t(i,n++)}}))},e.prototype.isSnapshotInTour=function(t){return-1!==this.activeReel.reel.findIndex((function(e){return!!e&&e.sid===t}))},e.prototype.getEnabledSnapshots=function(){var t=[];return this.iterateSnapshots((function(e,n){t.push(e)})),t},e.prototype.updateSnapshots=function(t){this.snapshots=t},e.prototype.getPhotosForTour=function(){var t=[],e=function(e){var r=n.snapshots[e];"tour"!==r.category&&"panorama"!==r.category&&t.push({name:r.name,sid:r.sid,thumbnailUrl:r.thumbnailUrl,inReel:-1!==n.activeReel.reel.findIndex((function(t){return!!t&&t.sid===e}))})},n=this;for(var r in this.snapshots)e(r);return t},e.prototype.getSnapshot=function(t){return this.snapshots[t]},e.prototype.getHighlightDescription=function(t){var e=this.activeReel.reel.findIndex((function(e){return!!e&&e.sid===t})),n=this.activeReel.reel.get(e);return{snapshot:this.getSnapshot(t),reelEntry:n}},e.prototype.getReelHighlights=function(){var t=this,e=[];return this.activeReel.reel.forEach((function(n){if(n&&t.isEnabled(n.sid)){var r=t.snapshots[n.sid];e.push({sid:r.sid,snapshot:r,panDirection:n.overrides&&n.overrides.panDirection,panAngle:n.overrides&&n.overrides.panAngle,transitionType:n.overrides&&n.overrides.transitionType})}})),e},e.prototype.getSnapshotCount=function(){return this.enabledTourStops.length},e.prototype.getTourState=function(){return this.tourState},e.prototype.setTourState=function(t){this.tourState=t},e.prototype.getTourCurrentSnapshotIndex=function(){return this.tourCurrentSnapshot},e.prototype.getTourCurrentSnapshotSid=function(){return this.tourCurrentSnapshotSid},e.prototype.getTourSnapshotSid=function(t){var e,n,r=0;try{for(var i=f(this.activeReel.reel),o=i.next();!o.done;o=i.next()){var a=o.value;if(a&&this.isEnabled(a.sid)){if(r===t)return a.sid;r++}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}throw new Error("getTourSnapshotSid() -> Invalid snapshot index.")},e.prototype.getTourSnapshotsWithSweepId=function(t){var e,n,r=[];try{for(var i=f(this.activeReel.reel),o=i.next();!o.done;o=i.next()){var a=o.value;a&&a.sid in this.snapshots&&this.snapshots[a.sid].metadata.scan_id===t&&r.push(a.sid)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r},e.prototype.setTourCurrentSnapshotByIndex=function(t){var e,n;if(t<0||t>this.getSnapshotCount())throw new Error("setTourCurrentSnapshotByIndex() -> Invalid tour index.");var r=-1;try{for(var i=f(this.activeReel.reel),o=i.next();!o.done;o=i.next()){var a=o.value;if(a&&this.isEnabled(a.sid)&&++r===t){this.tourCurrentSnapshot=t,this.tourCurrentSnapshotSid=a.sid;break}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}-1===r&&this.resetEmptyReel(),this.setTourTransitionToIndex(-1),this.commit()},e.prototype.getTourIndexBySid=function(t){var e,n,r=-1;try{for(var i=f(this.activeReel.reel),o=i.next();!o.done;o=i.next()){var a=o.value;if(a&&this.isEnabled(a.sid)&&(r++,a.sid===t))return r}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return-1},e.prototype.isEnabled=function(t){return-1!==this.enabledTourStops.indexOf(t)},e.prototype.resetEmptyReel=function(){this.tourCurrentSnapshot=-1,this.tourCurrentSnapshotSid=void 0,this.setTourTransitionToIndex(-1),this.commit()},e}(a.a)},function(t,e,n){"use strict";n.d(e,"c",(function(){return r})),n.d(e,"d",(function(){return i})),n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return a}));var r={FADE_DURATION:300,LABEL_HIDDEN_OPACITY:.15,DEPTH_WRITE_THRESHOD:.15,ALIGN_LABELS:!1,LABEL_SIZING:.14,LABEL_NDC_SCALEFACTOR:.5,LABEL_ASPECT_SCALEFACTOR:.035,OFFSET_TOWARDS_CAMERA:.25,HIDE_LABELS:!1},i={dottedLineDefault:2,lineDefault:6,lineSelected:6,endpointDefault:2.5,endpointSelected:3.75},o=.01,a=5},function(t,e,n){"use strict";n.d(e,"c",(function(){return o})),n.d(e,"f",(function(){return v})),n.d(e,"d",(function(){return g})),n.d(e,"b",(function(){return b})),n.d(e,"e",(function(){return w})),n.d(e,"a",(function(){return _}));var r,i,o,a=n(30),s=n(223),c=n(2),u=n(9),l=n(69),h=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),f=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},p=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},d=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},y=new c.a("datasync");!function(t){t[t.NONE=0]="NONE",t[t.LEGACY_SYNC=1]="LEGACY_SYNC",t[t.IGNORE_LEGACY_SAVE=2]="IGNORE_LEGACY_SAVE"}(i||(i={})),function(t){t.FLOOR_NAMES="FLOOR_NAMES",t.HIGHLIGHTS="HIGHLIGHTS",t.LABELS="LABELS",t.MATTERTAGS="MATTERTAGS",t.MEASUREMENTS="MEASUREMENTS",t.SETTINGS="SETTINGS",t.START_LOCATION="START_LOCATION",t.SWEEPS="SWEEPS"}(o||(o={}));var m,v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e}(u.a),g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dirty=!1,e.dirtyWS2=!1,e.sessionsSaving=0,e}return h(e,t),e}(l.a);!function(t){t[t.IDLE=0]="IDLE",t[t.LOADING=1]="LOADING",t[t.CLEAN=2]="CLEAN",t[t.DIRTY=3]="DIRTY"}(m||(m={}));var b=function(){function t(e,n){this.state=m.IDLE,this.diff={},this.deletedKeys=[],this.config=e,this.collectionData=n,this.config.extras||(this.config.extras=0),this.config.extras&i.LEGACY_SYNC||t.configuredSyncs.push(this)}return t.setGlobalStore=function(t){var e=this;if(this.sharedStore)throw Error("Attempting to overwrite sync's internal store");this.sharedStore=t,this.sharedStore.read().then((function(t){e.sharedState.lastPublished=t.lastPublished,e.sharedState.commit()}))},t.setMessageBus=function(t){this.msgBus=t},t.setAfterPublish=function(e){t.afterPublishCallback=e},t.publishAll=function(){return f(this,void 0,void 0,(function(){var t;return p(this,(function(e){switch(e.label){case 0:return t=this.configuredSyncs.map((function(t){return t.publish()})),[4,Promise.all(t)];case 1:return e.sent(),y.debug("sharedState.dirty = false"),this.sharedState.dirty=!1,this.sharedState.lastPublished=new Date,this.sharedState.commit(),this.sharedStore.update(this.sharedState),this.afterPublishCallback?[4,this.afterPublishCallback()]:[3,3];case 2:e.sent(),e.label=3;case 3:return[2,this.sharedState.lastPublished]}}))}))},t.resetEditStore=function(t){return f(this,void 0,void 0,(function(){var e;return p(this,(function(n){switch(n.label){case 0:return(e=this.configuredSyncs.find((function(e){return e.config.editStoreKey===t})))?[4,e.reset()]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},t.getStateOfEditStores=function(){var t=[];return this.configuredSyncs.forEach((function(e){void 0!==e.config.editStoreKey&&t.push({key:e.config.editStoreKey,dirty:e.isDirty()})})),t},Object.defineProperty(t,"globalSession",{get:function(){return this.sharedState},enumerable:!0,configurable:!0}),t.prototype.isDirty=function(){return this.state===m.DIRTY},t.prototype.load=function(){return f(this,void 0,Promise,(function(){var t,e,n,r,i,o,s,c,u,l,h,f,d,y=this;return p(this,(function(p){switch(p.label){case 0:if(this.state!==m.IDLE)throw Error("Data already loaded");return this.setState(m.LOADING),t=this.config.publishStores&&this.config.publishStores.length>0,e=t?this.config.publishStores.map((function(t){return y.loadStore(t)})):[],this.config.editStore&&e.push(this.loadStore(this.config.editStore)),this.config.legacyEditStore&&e.push(this.loadStore(this.config.legacyEditStore,!0)),[4,Promise.all(e)];case 1:if(n=p.sent(),r=function(t,e,n){return e&&e.modified&&n.modified&&e.modified>n.modified?e:(t&&y.setState(m.DIRTY),n)},i=function(t,e,n,r,i){if(!e)return t&&y.setState(m.DIRTY),n;if(r&&i&&i<r)return e;for(var o in n)n.hasOwnProperty(o)&&(t&&y.setState(m.DIRTY),e[o]=n[o]);return e},this.data=n[0].data||{},this.setState(m.CLEAN),this.publishedData=Object(a.a)(this.data),this.collectionData){for(s=1;s<n.length;s++)if(c=s>=this.config.publishStores.length,(o=n[s]).data){for(d in o.data)o.data.hasOwnProperty(d)&&(this.data[d]?this.config.partialData?this.data[d]=i(c,this.data[d],o.data[d]):this.data[d]=r(c,this.data[d],o.data[d]):(c&&this.setState(m.DIRTY),this.data[d]=o.data[d]));if(o.isLegacy)for(d in this.data)o.data[d]||(c&&this.setState(m.DIRTY),this.data[d]=null,this.diff[d]=null);o.isLegacy||(this.diff=o.data)}}else for(s=1;s<n.length;s++)c=s>=this.config.publishStores.length,(u=n[s].data)&&(l=u,this.config.partialData?(h=this.data.modified instanceof Date?this.data.modified:void 0,f=l.modified instanceof Date?l.modified:void 0,this.data=i(c,this.data,l,h,f)):this.data=r(c,this.data,l));for(d in this.data)this.data[d]||(this.deletedKeys.push(d),delete this.data[d]);return[2,this.data]}}))}))},t.prototype.loadStore=function(t,e){return void 0===e&&(e=!1),t.read().then((function(t){return{data:t,isLegacy:e}}))},Object.defineProperty(t.prototype,"monitorNeeded",{get:function(){return void 0!==this.config.editStore||void 0!==this.config.legacyEditStore||this.config.publishStores.length>0},enumerable:!0,configurable:!0}),t.prototype.addMonitor=function(t){var e=this;if(!this.monitorNeeded)throw Error("Adding a monitor unnecessarily!");this._monitor=t;this._monitor.onChanged((function(){return f(e,void 0,void 0,(function(){var t,e,n;return p(this,(function(r){switch(r.label){case 0:if(this.onDataChanged(),this.config.safeKeys){if(t=!1,this.collectionData)for(e in this.diff)for(n in this.diff[e])-1!==this.config.safeKeys.indexOf(n)&&(t=!0);else for(n in this.diff)-1!==this.config.safeKeys.indexOf(n)&&(t=!0);if(!t)return[2]}return this.setState(m.DIRTY),[4,this.saveSession()];case 1:return r.sent(),[2]}}))}))}))},Object.defineProperty(t.prototype,"monitor",{get:function(){return this._monitor},enumerable:!0,configurable:!0}),t.prototype.setState=function(e){this.config.extras&i.LEGACY_SYNC?e!==m.DIRTY||t.sharedState.dirtyWS2||(y.debug("sharedState.dirtyWS2 = true"),t.sharedState.dirtyWS2=!0,t.sharedState.commit()):(this.state=e,this.state!==m.DIRTY||t.sharedState.dirty||(y.debug("sharedState.dirty = true"),t.sharedState.dirty=!0,t.sharedState.commit()))},t.prototype.saveSession=function(){return f(this,void 0,Promise,(function(){return p(this,(function(e){switch(e.label){case 0:y.info("Saving session..."),t.sharedState.sessionsSaving++,t.sharedState.commit(),e.label=1;case 1:return e.trys.push([1,6,,7]),this.config.editStore?[4,this.config.editStore.update(this.data,this.diff)]:[3,3];case 2:e.sent(),e.label=3;case 3:return!this.config.legacyEditStore||this.config.extras&i.IGNORE_LEGACY_SAVE?[3,5]:[4,this.config.legacyEditStore.update(this.data,this.diff)];case 4:e.sent(),e.label=5;case 5:return[3,7];case 6:return e.sent(),t.msgBus.broadcast(new v),[3,7];case 7:return t.sharedState.sessionsSaving--,t.sharedState.commit(),[2]}}))}))},t.prototype.publish=function(){return f(this,void 0,Promise,(function(){var t,e,n,r,o,s,c,u;return p(this,(function(l){switch(l.label){case 0:if(this.state!==m.DIRTY)return[2];l.label=1;case 1:l.trys.push([1,10,11,12]),n=d(this.config.publishStores),r=n.next(),l.label=2;case 2:if(r.done)return[3,9];if(o=r.value,!this.isWritable(o))return[3,7];l.label=3;case 3:return l.trys.push([3,5,,6]),[4,o.update(this.data,this.diff)];case 4:return l.sent(),this.publishedData=Object(a.a)(this.data),[3,6];case 5:throw s=l.sent(),y.error("Failed to publish data: ",o.config,this.data,this.diff),s;case 6:return[3,8];case 7:throw Error("Trying to publish with readonly store");case 8:return r=n.next(),[3,2];case 9:return[3,12];case 10:return c=l.sent(),t={error:c},[3,12];case 11:try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}return[7];case 12:return l.trys.push([12,17,,18]),this.config.editStore?[4,this.config.editStore.delete()]:[3,14];case 13:l.sent(),l.label=14;case 14:return!this.config.legacyEditStore||this.config.extras&i.IGNORE_LEGACY_SAVE?[3,16]:[4,this.config.legacyEditStore.delete()];case 15:l.sent(),l.label=16;case 16:return this.setState(m.CLEAN),[3,18];case 17:throw u=l.sent(),Error("Failed to clear session data after publishing: "+u);case 18:return[2]}}))}))},t.prototype.reset=function(){return f(this,void 0,Promise,(function(){return p(this,(function(e){switch(e.label){case 0:switch(this.state){case m.CLEAN:return[3,1];case m.IDLE:return[3,2];case m.LOADING:return[3,3];case m.DIRTY:return[3,4]}return[3,12];case 1:return[2,this.data];case 2:throw Error("Attempting to reset a Sync that was not loaded.");case 3:throw Error("Attempting to reset a Sync that is still loading.");case 4:y.info("Clearing session..."),t.sharedState.sessionsSaving++,t.sharedState.commit(),e.label=5;case 5:return e.trys.push([5,10,,11]),this.config.editStore?[4,this.config.editStore.delete()]:[3,7];case 6:e.sent(),e.label=7;case 7:return!this.config.legacyEditStore||this.config.extras&i.IGNORE_LEGACY_SAVE?[3,9]:[4,this.config.legacyEditStore.delete()];case 8:e.sent(),e.label=9;case 9:return this.data=Object(a.a)(this.publishedData),this.setState(m.CLEAN),[3,11];case 10:return e.sent(),t.msgBus.broadcast(new v),[3,11];case 11:return t.sharedState.sessionsSaving--,t.sharedState.commit(),[2,this.data];case 12:return[2]}}))}))},t.prototype.isWritable=function(t){return void 0!==t.update},t.sharedState=new g,t.configuredSyncs=[],t}(),w=function(t){function e(e){return t.call(this,e,!1)||this}return h(e,t),e.prototype.onDataChanged=function(){var t=this.monitor.getDiffRecord();this.diff=t,this.diff.modified=new Date},e}(b),_=function(t){function e(e){return t.call(this,e,!0)||this}return h(e,t),e.prototype.onDataChanged=function(){var t,e,n=this.monitor.getDiffRecord();try{for(var r=d(n),i=r.next();!i.done;i=r.next()){var o=i.value;switch(o.action){case s.a.added:this.diff[o.index]=o.diff;break;case s.a.updated:this.diff[o.index]||(this.diff[o.index]={}),Object(a.e)(this.diff[o.index],o.diff);break;case s.a.removed:delete this.diff[o.index],this.data[o.index]=null}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}this.monitor.clearDiffRecord()},e}(b)},function(t,e,n){"use strict";n.r(e);var r,i=n(2),o=n(0),a=n(20),s=n(24),c=(n(806),function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))}),u=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},l=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};!function(t){t[t.Init=0]="Init",t[t.Loading=1]="Loading",t[t.Loaded=2]="Loaded"}(r||(r={}));var h=function(){function t(t){var e=this;this.onChange=t,this.settings={},this.helperObject={colors:{},vectors:{},quaternions:{}},this.initPromise=new s.a,this.loadState=r.Init,this.uninitError="ControlKit not yet initialized",this.lastKeys=[],this.lastKeysBufferLength=0,this.controlKit=void 0,this.updateRequired=!1,this.panels=[],this.onToggleCallbacks={},this.onKeyDown=function(t){e.lastKeys.unshift(t.keyCode),e.lastKeys.length>e.lastKeysBufferLength&&e.lastKeys.pop();for(var n=0;n<e.panels.length;n++){var r=e.panels[n].activationSequence;Object(a.g)(e.lastKeys,r)&&e.toggle(n)}},this.getPanelId=function(t){var n,r;try{for(var i=l(e.panels),o=i.next();!o.done;o=i.next()){var a=o.value;if(t===a.header)return a.index}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return-1},this.getSubGroup=function(t,n){var r=e.panels[t];if(r.guiPanel||(r.guiPanel=r.makeGuiPanel()),!r.allowSubGroups)return r.guiPanel;var i=r.subGroups[n];return i||(i=r.guiPanel.addSubGroup({label:n,enable:!1}),r.subGroups[n]=i),i},this.addColor=function(t,n,r,i){e.updateHelperObject(n+r,i),t.addColor(e.helperObject.colors,n+r,{label:r,colorMode:"hex",onChange:function(t){e.settings[n+r].setHex(parseInt(t.substring(1),16));var i={};i[r]=e.settings[n+r],e.onChange(i)}})},this.addVector3=function(t,n,r,i){e.updateHelperObject(r,i);var a=t.addSubGroup({label:r}),s=["x","y","z"];for(var c in s)a.addNumberInput(e.helperObject.vectors[n+r],s[c],{label:s[c],onChange:function(){e.settings[n+r]=new o.Jc(e.helperObject.vectors[r].x,e.helperObject.vectors[r].y,e.helperObject.vectors[r].z);var t={};t[r]=e.settings[n+r],e.onChange(t)}})},this.addQuaternion=function(t,n,r,i){e.updateHelperObject(r,i);var a=t.addSubGroup({label:r}),s=["x","y","z","w"];for(var c in s){var u=r+s[c];a.addNumberInput(e.helperObject.quaternions[n+r],u,{label:s[c],onChange:function(){e.settings[n+r]=new o.Pb(e.helperObject.quaternions[n+r].x,e.helperObject.quaternions[n+r].y,e.helperObject.quaternions[n+r].z,e.helperObject.quaternions[n+r].w);var t={};t[r]=e.settings[n+r],e.onChange(t)}})}}}return t.prototype.init=function(){},t.prototype.loadGuiPackage=function(){return c(this,void 0,Promise,(function(){var t=this;return u(this,(function(e){return this.loadState===r.Init&&(n.e(8).then(n.t.bind(null,1524,7)).then((function(e){var n=document.createElement("div");n.id="controlKitElement",(document.getElementById("control-kit-wrapper")||document.body).appendChild(n),t.controlKit=new e.default({opacity:.9,enable:!1,parentDomElementId:"controlKitElement"}),t.controlKit.setShortcutEnable(""),t.controlKit.enable(),t.initPromise.resolve(),t.loadState=r.Loaded})),this.loadState=r.Loading),[2,this.loadPromise]}))}))},Object.defineProperty(t.prototype,"loadPromise",{get:function(){return this.initPromise.nativePromise()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLoaded",{get:function(){return void 0!==this.controlKit},enumerable:!0,configurable:!0}),t.prototype.addPanel=function(t,e,n){var r=this;for(void 0===n&&(n={}),void 0===n.width&&(n.width=250),void 0===n.allowSubGroups&&(n.allowSubGroups=!0),void 0===n.ratio&&(n.ratio=60),this.lastKeysBufferLength=Math.max(this.lastKeysBufferLength,e.length);this.lastKeysBufferLength>this.lastKeys.length;)this.lastKeys.unshift(-1);return this.panels.push({index:this.panels.length,header:t,guiPanel:null,makeGuiPanel:function(){return r.controlKit.addPanel({label:t,align:"right",ratio:n.ratio,width:n.width})},subGroups:[],allowSubGroups:n.allowSubGroups,activationSequence:e.reverse()}),this.panels.length-1},t.prototype.isVisible=function(t){if(!this.controlKit)throw new Error(this.uninitError);return this.panels[t].guiPanel._enabled},t.prototype.toggle=function(t){var e=this;this.controlKit?this.toggleVisibility(t):this.loadGuiPackage().then((function(){e.toggleVisibility(t)}))},t.prototype.onToggle=function(t,e){this.onToggleCallbacks[t]||(this.onToggleCallbacks[t]=[]),this.onToggleCallbacks[t].push(e)},t.prototype.toggleVisibility=function(t){var e,n;if(!this.controlKit)throw new Error(this.uninitError);var r=this.panels[t].guiPanel._enabled;if(r?this.panels[t].guiPanel.disable():this.panels[t].guiPanel.enable(),this.onToggleCallbacks[t])try{for(var i=l(this.onToggleCallbacks[t]),o=i.next();!o.done;o=i.next()){(0,o.value)(!r)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}},t.prototype.dispose=function(){var t=document.getElementById("controlKit");t&&t.remove(),this.controlKit=void 0},t.prototype.activate=function(t){window.addEventListener("keydown",this.onKeyDown)},t.prototype.deactivate=function(t){this.controlKit&&this.controlKit.disable(),window.removeEventListener("keydown",this.onKeyDown)},t.prototype.render=function(){this.controlKit&&this.updateRequired&&this.controlKit.update()},t.prototype.updateSetting=function(t,e,n){if(!this.controlKit)throw new Error(this.uninitError);var r=this.settings[t+e];n&&"function"==typeof n.equals&&"function"==typeof n.copy&&r&&"function"==typeof r.equals&&"function"==typeof r.copy?n.equals(this.settings[t+e])||(this.settings[t+e].copy(n),this.updateHelperObject(name,n),this.updateRequired=!0):n!==this.settings[t+e]&&(this.settings[t+e]=n,this.updateRequired=!0)},t.prototype.getSetting=function(t,e){return this.settings[t+e]},t.prototype.isRegistered=function(t,e){return void 0!==this.settings[t+e]},t.prototype.addControl=function(t,e,n,r,i,a){var s=this;if(void 0===a&&(a=2),!this.controlKit)throw new Error(this.uninitError);var c=this.getSubGroup(t,e);this.settings[t+n]=r;var u=typeof r;if(("string"===u&&"true"===r||"false"===r)&&(u="boolean"),r instanceof o.s)this.addColor(c,t,n,r);else if(r instanceof o.Jc)this.addVector3(c,t,n,r);else if(r instanceof o.Pb)this.addQuaternion(c,t,n,r);else switch(u){case"string":c.addStringInput(this.settings,t+n,{label:n,onChange:function(e){var r={};s.settings[t+n]=e,r[n]=s.settings[t+n],s.onChange(r)}});break;case"number":this.settings[t+n+"_range"]=i||[0,10],c.addSlider(this.settings,t+n,t+n+"_range",{label:n,onChange:function(){var e={};e[n]=s.settings[t+n],s.onChange(e)},dp:a});break;case"boolean":c.addCheckbox(this.settings,t+n,{label:n,ratio:10,onChange:function(){var e={};e[n]=s.settings[t+n],s.onChange(e)}});break;default:c.addStringOutput(this.settings,t+n,{label:n})}},t.prototype.addButton=function(t,e,n,r){if(!this.controlKit)throw new Error(this.uninitError);this.getSubGroup(t,e).addButton(n,r,{label:"none",ratio:100})},t.prototype.addSlider=function(t,e,n,r,i,o,a){var s=this;if(!this.controlKit)throw new Error(this.uninitError);var c=this.getSubGroup(t,e);this.settings[t+n]=r,this.settings[t+n+"_range"]=[i,o],c.addSlider(this.settings,t+n,t+n+"_range",{label:n,dp:a,onChange:function(){var e={};e[n]=s.settings[t+n],s.onChange(e)}})},t.prototype.updateHelperObject=function(t,e){e instanceof o.s?this.helperObject.colors[t]="#"+e.getHexString():e instanceof o.Jc?(this.helperObject.vectors[t]={},this.helperObject.vectors[t].x=e.x,this.helperObject.vectors[t].y=e.y,this.helperObject.vectors[t].z=e.z):e instanceof o.Pb&&(this.helperObject.quaternions[t]={},this.helperObject.quaternions[t].x=e.x,this.helperObject.quaternions[t].y=e.y,this.helperObject.quaternions[t].z=e.z,this.helperObject.quaternions[t].w=e.w)},t}(),f=n(4),p=n(26),d=n(6);n.d(e,"SettingPersistence",(function(){return m}));var y,m,v=(y=function(t,e){return(y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}y(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),g=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},b=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},w=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},_=new i.a("settings");!function(t){t[t.NONE=0]="NONE",t[t.LOCAL_STORAGE=1]="LOCAL_STORAGE"}(m||(m={}));var x=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="settings",e.queuedControls=[],e.queuedButtons=[],e.secretWord=[38,38,40,40,37,39,37,39,66,65,72],e.panelID=-1,e.addPanel=function(t,n,r){var i=e.getPanelId(t);return-1===i?e.settingsGUI.addPanel(t,n,r):i},e.getPanelId=function(t){return e.settingsGUI.getPanelId(t)},e}return v(e,t),e.prototype.init=function(t,e){return g(this,void 0,void 0,(function(){var n,r,i,o,a=this;return b(this,(function(s){for(r in this.engine=e,this.settings=new p.a,this.engine.market.register(this,p.a,this.settings),t.useGUI&&(this.settingsGUI=new h((function(t){a.updateSettings(t)})),e.addComponent(this,this.settingsGUI),this.panelID=this.settingsGUI.addPanel("3.1.10.4-0-ga56ce8cdd",this.secretWord)),n=Object(d.s)())"string"==typeof(i=n[r])&&(o=Number.parseFloat(i),isNaN(o)||(i=o)),this.settings.setProperty(r,i),t.useGUI&&this.queuedControls.push({panelId:this.panelID,group:"Engine Config",settingName:r,value:i});return t.useGUI&&this.settingsGUI.loadPromise.then((function(){var t,e,n,r;try{for(var i=w(a.queuedControls),o=i.next();!o.done;o=i.next()){var s=o.value;a.settingsGUI.addControl(s.panelId,s.group,s.settingName,s.value,s.range,s.rangePrecision)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}try{for(var c=w(a.queuedButtons),u=c.next();!u.done;u=c.next()){var l=u.value;a.settingsGUI.addButton(l.panelId,l.group,l.buttonName,l.callback)}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}a.settingsGUI.toggle(a.panelID)})),[2]}))}))},Object.defineProperty(e.prototype,"loadPromise",{get:function(){return this.settingsGUI.loadPromise},enumerable:!0,configurable:!0}),e.prototype.getSettingsGui=function(){return this.settingsGUI},e.prototype.getMainPanelId=function(){return this.panelID},e.prototype.updateSetting=function(t,e,n){void 0===n&&(n=this.panelID),e&&e.clone&&"function"==typeof e.clone?this.settings.setProperty(t,e.clone()):this.settings.setProperty(t,e),this.settingsGUI&&this.settingsGUI.isLoaded&&this.settingsGUI.updateSetting(n,t,e)},e.prototype.updateSettings=function(t){for(var e in t)this.updateSetting(e,t[e])},e.prototype.registerSetting=function(t,e,n,r,i,o,a,s){if(void 0===r&&(r=!0),void 0===i&&(i=m.NONE),void 0===a&&(a=this.panelID),void 0===s&&(s=2),this.settingsGUI&&this.settingsGUI.isRegistered(a,e))_.warn("Duplicate setting "+e+" registered. Is a module being used twice?");else{var c;c=n&&n.clone&&"function"==typeof n.clone?n.clone():n,this.settingsGUI&&r&&(this.settingsGUI.isLoaded?this.settingsGUI.addControl(a,t,e,c,o,s):this.queuedControls.push({panelId:a,group:t,settingName:e,value:n,range:o,rangePrecision:s}));var u=i===m.LOCAL_STORAGE?Object(d.e)(e,n):n;this.updateSetting(e,u)}},e.prototype.registerMenuEntry=function(t){var e=t.header,n=t.setting,r=t.initialValue,i=t.persist,o=t.displayInUi,a=t.range,s=t.panel,c=t.onChange,u=t.rangePrecision,l=r();return this.registerSetting(e,n,l,o,i,a,s,u),c?(c(l),this.settings.onPropertyChanged(n,c)):null},e.prototype.registerMenuButton=function(t){var e=t.header,n=t.buttonName,r=t.panel,i=t.callback;this.registerButton(e,n,i,r)},e.prototype.registerButton=function(t,e,n,r){void 0===r&&(r=this.panelID),this.settingsGUI&&(this.settingsGUI.isLoaded?this.settingsGUI.addButton(r,t,e,n):this.queuedButtons.push({panelId:r,group:t,buttonName:e,callback:n}))},e.prototype.hasProperty=function(t){return this.settings.hasProperty(t)},e.prototype.getProperty=function(t){return this.settings.getProperty(t)},e.prototype.tryGetProperty=function(t,e){return this.settings.tryGetProperty(t,e)},e.prototype.toggleMenu=function(){this.settingsGUI&&this.settingsGUI.toggle(0)},e.prototype.disposeGui=function(){this.settingsGUI.dispose()},e}(f.a);e.default=x},function(t,e,n){"use strict";n.d(e,"i",(function(){return r})),n.d(e,"f",(function(){return i})),n.d(e,"h",(function(){return o})),n.d(e,"d",(function(){return a})),n.d(e,"b",(function(){return s})),n.d(e,"g",(function(){return c})),n.d(e,"c",(function(){return u})),n.d(e,"e",(function(){return l})),n.d(e,"a",(function(){return h}));var r=function(t,e,n,r){return n*t/r+e},i=function(t,e,n,r){return n*(t/=r)*t+e},o=function(t,e,n,r){return-n*(t/=r)*(t-2)+e},a=function(t,e,n,r){return(t/=r/2)<1?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e},s=function(t,e,n,r){return n*(t/=r)*t*t+e},c=function(t,e,n,r){return t/=r,n*(--t*t*t+1)+e},u=function(t,e,n,r){return(t/=r/2)<1?n/2*t*t*t+e:n/2*((t-=2)*t*t+2)+e},l=function(t,e,n,r){return-n/2*(Math.cos(Math.PI*t/r)-1)+e},h=function(t,e,n,r,i){var o=e;if(i>0){var a=(1-Math.max(i,0))*Math.abs(r);o=n<=a?0:t(n-a,0,1,a)}return o}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return o})),n.d(e,"b",(function(){return a}));var r=n(6),i="settings/tiling/preload_quality",o=Object.freeze({overlayStyle:r.A("tileoverlay",0),uploadIntervalDelay:r.A("tileupdelay",50),highResUploadsPerFrame:r.A("maxnbtpf",2),maxHighResUploadsPerFrame:100,uploadsPerFrame:r.A("maxbtpf",6),maxUploadsPerFrame:100,windowHeightHighQualityThreshold:800,windowHeightHighQualityThresholdOverride:r.A("threshold2k",void 0),concurrentDownloads:r.A("tileconc",3),maxConcurrentDownloads:12,navigation:{directionFactor:10,distanceFactor:-1}}),a=function(){function t(){this.reset()}return t.prototype.reset=function(){this.downloadFullPano=!1,this.concurrentDownloads=o.concurrentDownloads,this.uploadsPerFrame=o.uploadsPerFrame,this.highResUploadsPerFrame=o.highResUploadsPerFrame},t}()},function(t,e,n){"use strict";(function(t){var r=n(704),i=n(705),o=n(498);function a(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(t,e){if(a()<e)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=c.prototype:(null===t&&(t=new c(e)),t.length=e),t}function c(t,e,n){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return h(this,t)}return u(this,t,e,n)}function u(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);c.TYPED_ARRAY_SUPPORT?(t=e).__proto__=c.prototype:t=f(t,e);return t}(t,e,n,r):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|d(e,n),i=(t=s(t,r)).write(e,n);i!==r&&(t=t.slice(0,i));return t}(t,e,n):function(t,e){if(c.isBuffer(e)){var n=0|p(e.length);return 0===(t=s(t,n)).length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?s(t,0):f(t,e);if("Buffer"===e.type&&o(e.data))return f(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function l(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function h(t,e){if(l(e),t=s(t,e<0?0:0|p(e)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function f(t,e){var n=e.length<0?0:0|p(e.length);t=s(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function p(t){if(t>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|t}function d(t,e){if(c.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return U(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return z(t).length;default:if(r)return U(t).length;e=(""+e).toLowerCase(),r=!0}}function y(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return A(this,e,n);case"utf8":case"utf-8":return E(this,e,n);case"ascii":return P(this,e,n);case"latin1":case"binary":return O(this,e,n);case"base64":return M(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function m(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function v(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=c.from(e,r)),c.isBuffer(e))return 0===e.length?-1:g(t,e,n,r,i);if("number"==typeof e)return e&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):g(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function g(t,e,n,r,i){var o,a=1,s=t.length,c=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;a=2,s/=2,c/=2,n/=2}function u(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(i){var l=-1;for(o=n;o<s;o++)if(u(t,o)===u(e,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===c)return l*a}else-1!==l&&(o-=o-l),l=-1}else for(n+c>s&&(n=s-c),o=n;o>=0;o--){for(var h=!0,f=0;f<c;f++)if(u(t,o+f)!==u(e,f)){h=!1;break}if(h)return o}return-1}function b(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var a=0;a<r;++a){var s=parseInt(e.substr(2*a,2),16);if(isNaN(s))return a;t[n+a]=s}return a}function w(t,e,n,r){return G(U(e,t.length-n),t,n,r)}function _(t,e,n,r){return G(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function x(t,e,n,r){return _(t,e,n,r)}function S(t,e,n,r){return G(z(e),t,n,r)}function T(t,e,n,r){return G(function(t,e){for(var n,r,i,o=[],a=0;a<t.length&&!((e-=2)<0);++a)n=t.charCodeAt(a),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(e,t.length-n),t,n,r)}function M(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function E(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o,a,s,c,u=t[i],l=null,h=u>239?4:u>223?3:u>191?2:1;if(i+h<=n)switch(h){case 1:u<128&&(l=u);break;case 2:128==(192&(o=t[i+1]))&&(c=(31&u)<<6|63&o)>127&&(l=c);break;case 3:o=t[i+1],a=t[i+2],128==(192&o)&&128==(192&a)&&(c=(15&u)<<12|(63&o)<<6|63&a)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:o=t[i+1],a=t[i+2],s=t[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(c=(15&u)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&c<1114112&&(l=c)}null===l?(l=65533,h=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=h}return function(t){var e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=4096));return n}(r)}e.Buffer=c,e.SlowBuffer=function(t){+t!=t&&(t=0);return c.alloc(+t)},e.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=a(),c.poolSize=8192,c._augment=function(t){return t.__proto__=c.prototype,t},c.from=function(t,e,n){return u(null,t,e,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(t,e,n){return function(t,e,n,r){return l(e),e<=0?s(t,e):void 0!==n?"string"==typeof r?s(t,e).fill(n,r):s(t,e).fill(n):s(t,e)}(null,t,e,n)},c.allocUnsafe=function(t){return h(null,t)},c.allocUnsafeSlow=function(t){return h(null,t)},c.isBuffer=function(t){return!(null==t||!t._isBuffer)},c.compare=function(t,e){if(!c.isBuffer(t)||!c.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},c.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(t,e){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return c.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=c.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var a=t[n];if(!c.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,i),i+=a.length}return r},c.byteLength=d,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)m(this,e,e+1);return this},c.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)m(this,e,e+3),m(this,e+1,e+2);return this},c.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)m(this,e,e+7),m(this,e+1,e+6),m(this,e+2,e+5),m(this,e+3,e+4);return this},c.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?E(this,0,t):y.apply(this,arguments)},c.prototype.equals=function(t){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===c.compare(this,t)},c.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},c.prototype.compare=function(t,e,n,r,i){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(e>>>=0),s=Math.min(o,a),u=this.slice(r,i),l=t.slice(e,n),h=0;h<s;++h)if(u[h]!==l[h]){o=u[h],a=l[h];break}return o<a?-1:a<o?1:0},c.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},c.prototype.indexOf=function(t,e,n){return v(this,t,e,n,!0)},c.prototype.lastIndexOf=function(t,e,n){return v(this,t,e,n,!1)},c.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return b(this,t,e,n);case"utf8":case"utf-8":return w(this,t,e,n);case"ascii":return _(this,t,e,n);case"latin1":case"binary":return x(this,t,e,n);case"base64":return S(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function P(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function O(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function A(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=e;o<n;++o)i+=F(t[o]);return i}function D(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function R(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function C(t,e,n,r,i,o){if(!c.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function I(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-n,2);i<o;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function k(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-n,4);i<o;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function L(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function N(t,e,n,r,o){return o||L(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function j(t,e,n,r,o){return o||L(t,0,n,8),i.write(t,e,n,r,52,8),n+8}c.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=c.prototype;else{var i=e-t;n=new c(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+t]}return n},c.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},c.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},c.prototype.readUInt8=function(t,e){return e||R(t,1,this.length),this[t]},c.prototype.readUInt16LE=function(t,e){return e||R(t,2,this.length),this[t]|this[t+1]<<8},c.prototype.readUInt16BE=function(t,e){return e||R(t,2,this.length),this[t]<<8|this[t+1]},c.prototype.readUInt32LE=function(t,e){return e||R(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},c.prototype.readUInt32BE=function(t,e){return e||R(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},c.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},c.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length);for(var r=e,i=1,o=this[t+--r];r>0&&(i*=256);)o+=this[t+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},c.prototype.readInt8=function(t,e){return e||R(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},c.prototype.readInt16LE=function(t,e){e||R(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(t,e){e||R(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(t,e){return e||R(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},c.prototype.readInt32BE=function(t,e){return e||R(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},c.prototype.readFloatLE=function(t,e){return e||R(t,4,this.length),i.read(this,t,!0,23,4)},c.prototype.readFloatBE=function(t,e){return e||R(t,4,this.length),i.read(this,t,!1,23,4)},c.prototype.readDoubleLE=function(t,e){return e||R(t,8,this.length),i.read(this,t,!0,52,8)},c.prototype.readDoubleBE=function(t,e){return e||R(t,8,this.length),i.read(this,t,!1,52,8)},c.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||C(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},c.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||C(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},c.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,1,255,0),c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},c.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):I(this,t,e,!0),e+2},c.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):I(this,t,e,!1),e+2},c.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):k(this,t,e,!0),e+4},c.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):k(this,t,e,!1),e+4},c.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);C(this,t,e,n,i-1,-i)}var o=0,a=1,s=0;for(this[e]=255&t;++o<n&&(a*=256);)t<0&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+n},c.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);C(this,t,e,n,i-1,-i)}var o=n-1,a=1,s=0;for(this[e+o]=255&t;--o>=0&&(a*=256);)t<0&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+n},c.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,1,127,-128),c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},c.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):I(this,t,e,!0),e+2},c.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):I(this,t,e,!1),e+2},c.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):k(this,t,e,!0),e+4},c.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):k(this,t,e,!1),e+4},c.prototype.writeFloatLE=function(t,e,n){return N(this,t,e,!0,n)},c.prototype.writeFloatBE=function(t,e,n){return N(this,t,e,!1,n)},c.prototype.writeDoubleLE=function(t,e,n){return j(this,t,e,!0,n)},c.prototype.writeDoubleBE=function(t,e,n){return j(this,t,e,!1,n)},c.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,o=r-n;if(this===t&&n<e&&e<r)for(i=o-1;i>=0;--i)t[i+e]=this[i+n];else if(o<1e3||!c.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},c.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{var a=c.isBuffer(t)?t:U(new c(t,r).toString()),s=a.length;for(o=0;o<n-e;++o)this[o+e]=a[o%s]}return this};var B=/[^+\/0-9A-Za-z-_]/g;function F(t){return t<16?"0"+t.toString(16):t.toString(16)}function U(t,e){var n;e=e||1/0;for(var r=t.length,i=null,o=[],a=0;a<r;++a){if((n=t.charCodeAt(a))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function z(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(B,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function G(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}}).call(this,n(144))},function(t,e,n){"use strict";n.r(e);var r,i=n(0),o=n(28),a=n(212),s=n(4),c=n(18),u=n(9),l=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),h=function(t){function e(e,n){var r=t.call(this)||this;return r.from=n,r.to=e,r.timestamp=Date.now(),r}return l(e,t),e}(u.a),f=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e}(h),d=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return d(e,t),e}(h),m=n(24),v=n(57),g=n(132),b=n(26),w=n(100),_=n(7),x=n(63),S=n(10);n.d(e,"baseTransitionSpeedKey",(function(){return D}));var T,M=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),E=function(){return(E=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},P=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},O=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},A=((T={})[S.a.Instant]={blackoutTime:0,transitionTime:0},T[S.a.FadeToBlack]={blackoutTime:g.a.camera.transitionBlackoutTime,transitionTime:2*g.a.camera.transitionBlackoutTime},T[S.a.Interpolate]={blackoutTime:0,transitionTime:g.a.camera.transitionFadeTime},T),D="Transition time",R=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="camera-data",e}return M(e,t),e.prototype.init=function(t,e){return P(this,void 0,void 0,(function(){var n,r=this;return O(this,(function(i){switch(i.label){case 0:return this.engine=e,this.market=e.market,n=this,[4,e.market.waitForData(w.a)];case 1:return n.canvas=i.sent(),this.cameraData=new c.a(this.canvas.width,this.canvas.height),this.market.register(this,c.a,this.cameraData),this.baseTransitionTime=t.baseTransitionTime||g.a.camera.baseTransitionTime,e.market.waitForData(b.a).then((function(t){t.onPropertyChanged(D,(function(t){r.baseTransitionTime=t}))})),this.bindings.push(e.subscribe(a.a,(function(t){return r.cameraData.setCameraDimensions(t.width,t.height)}))),this.transitionSpeed=t.transitionSpeed||g.a.camera.transitionSpeed,[2]}}))}))},e.prototype.getData=function(t){return void 0===t&&(t=!0),t?Object.freeze(this.cameraData.clone()):this.cameraData},e.prototype.onUpdate=function(t){},e.prototype.fromPose=function(){return{position:this.cameraData.pose.position.clone(),rotation:this.cameraData.pose.rotation.clone(),projection:this.cameraData.pose.projection.clone(),focalDistance:this.cameraData.pose.focalDistance}},e.prototype.updateCameraProjection=function(t){t&&(this.cameraData.pose.projection.copy(t),this.cameraData.pose.commit(),this.broadcastCameraMoved({projection:t}))},e.prototype.updateCameraFocus=function(t){this.cameraData.pose.focalDistance=t,this.cameraData.pose.commit()},e.prototype.updateCameraRotation=function(t){t&&(this.cameraData.pose.rotation.copy(t),this.cameraData.pose.commit(),this.broadcastCameraMoved({rotation:t}))},e.prototype.updateCameraPosition=function(t){t&&(this.cameraData.pose.position.copy(t),this.cameraData.pose.commit(),this.broadcastCameraMoved({position:t}))},e.prototype.broadcastCameraMoved=function(t){var e=this.fromPose(),n=E({},e,t);this.engine.broadcast(new h(n,e))},e.prototype.updateCameraPose=function(t){t.position&&(this.cameraData.pose.position.copy(t.position),this.cameraData.pose.commit(),this.broadcastCameraMoved({position:t.position})),t.rotation&&(this.cameraData.pose.rotation.copy(t.rotation),this.cameraData.pose.commit(),this.broadcastCameraMoved({rotation:t.rotation}))},e.prototype.canMove=function(){return this.cameraData.canTransition()},e.prototype.moveTo=function(t){if(!this.canMove())return m.a.reject("Cannot move while the camera is already moving");var e=A[t.transitionType],n=t.pose.rotation,r=t.pose.position,i=t.projection;t.pose.zoom&&(i&&Object(o.o)(i)||this.cameraData.isOrtho())&&(i=this.adjustProjectionZoom(i||this.cameraData.pose.projection.clone(),t.pose.zoom));var a=void 0!==t.blackoutTime?t.blackoutTime:e.blackoutTime,s=t.transitionType,c=s===S.a.Instant?0:t.transitionTime;if(void 0===c)if(t.transitionType===S.a.Interpolate&&r){var u=r.distanceTo(this.cameraData.pose.position);c=this.baseTransitionTime+166*Math.log2(1+u)*this.transitionSpeed}else c=e.transitionTime;var l=this.fromPose();this.beginInternalTransition({transitionType:s,transitionTime:c,blackoutTime:a,pose:{position:r,rotation:n},projection:i,easing:t.easing,rotationDelay:t.rotationDelay||0,rotationDuration:t.rotationDuration||1,matrixDelay:t.matrixDelay||0,matrixDuration:t.matrixDuration||1,focalDistance:t.focalDistance||l.focalDistance});var h={position:t.pose.position?t.pose.position.clone():void 0,rotation:t.pose.rotation?t.pose.rotation.clone():void 0,projection:t.projection?t.projection.clone():void 0,focalDistance:t.focalDistance?t.focalDistance:void 0};this.engine.broadcast(new p(h,l));var f=new m.a,d=this.progressInternalTransition.bind(this),v=this.endInternalTransition.bind(this),g=this;return f.notify(0),this.engine.startGenerator((function(){var e,n;return O(this,(function(r){switch(r.label){case 0:return(e=16)>=g.cameraData.transition.duration?(f.notify(.5),[4,new x.b]):[3,2];case 1:r.sent(),r.label=2;case 2:return e<g.cameraData.transition.duration?(d(e,a),n=Object(_.e)(e/g.cameraData.transition.duration,0,1),f.notify(n),[4,new x.b]):[3,4];case 3:return r.sent(),e=16+Date.now()-g.cameraData.transition.startTime,[3,2];case 4:return v(t.transitionType),g.cameraData.commit(),f.notify(1),f.resolve(),g.engine.broadcast(new y(h,l)),[2]}}))})),f.promise()},e.prototype.cancelTransition=function(){return P(this,void 0,Promise,(function(){var t=this;return O(this,(function(e){return this.cameraData.transition.active?[2,new Promise((function(e){Object(c.b)(t.cameraData.pose,t.cameraData.transition.to,!1);var n=Date.now()-t.cameraData.transition.startTime;t.cameraData.transition.duration=n,t.cameraData.transition.progress.stop(1),t.cameraData.pose.commit(),t.cameraData.transition.commit();var r=t.cameraData.transition.onPropertyChanged("active",(function(t){t||(r&&r.cancel(),e())}))}))]:[2,Promise.resolve()]}))}))},e.prototype.updateTransitionSpeed=function(t){if(this.cameraData.transition.active){var e=Date.now(),n=e-this.cameraData.transition.startTime,r=n/t,i=this.cameraData.transition.progress,o=(i.duration-n)/t+r;this.cameraData.transition.duration=o,this.cameraData.transition.startTime=e-r,i.modifyAnimation(i.value,i.endValue,o,i.easing,r),this.cameraData.transition.commit()}},e.prototype.beginExternalTransition=function(){this.cameraData.transition.activeInternal||(this.cameraData.transition.startTime=Date.now(),this.cameraData.transition.active=!0,this.cameraData.transition.commit())},e.prototype.endExternalTransition=function(){this.cameraData.transition.activeInternal||(this.cameraData.transition.active=!1,this.cameraData.transition.commit())},e.prototype.beginInternalTransition=function(t){var e=t.transitionTime||0;this.cameraData.transition.startTime=Date.now(),this.cameraData.transition.duration=e,this.cameraData.transition.active=!0,this.cameraData.transition.activeInternal=!0,this.cameraData.transition.type=t.transitionType,this.cameraData.transition.progress.modifyAnimation(0,1,e,t.easing||v.d),this.cameraData.transition.rotationDelay=t.rotationDelay||0,this.cameraData.transition.rotationDuration=t.rotationDuration||1,this.cameraData.transition.matrixDelay=t.matrixDelay||0,this.cameraData.transition.matrixDuration=t.matrixDuration||1,t.transitionType===S.a.FadeToBlack&&this.cameraData.transition.blackoutProgress.modifyAnimation(0,1,t.blackoutTime),this.cameraData.transition.from.position=this.cameraData.pose.position.clone(),this.cameraData.transition.from.rotation=this.cameraData.pose.rotation.clone(),this.cameraData.transition.from.projection=this.cameraData.pose.projection.clone(),this.cameraData.transition.from.focalDistance=this.cameraData.pose.focalDistance,this.cameraData.transition.to.position=t.pose.position?t.pose.position.clone():void 0,this.cameraData.transition.to.rotation=t.pose.rotation?t.pose.rotation.clone():void 0,this.cameraData.transition.to.projection=t.projection?t.projection.clone():void 0,this.cameraData.transition.to.focalDistance=t.focalDistance?t.focalDistance:void 0,this.cameraData.transition.commit()},e.prototype.progressInternalTransition=function(t,e){if(this.cameraData.transition.active){if(this.cameraData.transition.progress.updateAbsolute(t),this.cameraData.transition.type===S.a.Interpolate){var n=this.cameraData.transition.from,r=this.cameraData.transition.to;if(r.position&&n.position&&this.cameraData.pose.position.copy(n.position).lerp(r.position,this.cameraData.transition.progress.value),r.focalDistance&&n.focalDistance&&(this.cameraData.pose.focalDistance=i.ib.lerp(n.focalDistance,r.focalDistance,this.cameraData.transition.progress.value)),r.rotation&&n.rotation){var o=Object(v.a)(this.cameraData.transition.progress.easing,this.cameraData.transition.progress.value,this.cameraData.transition.progress.elapsed,this.cameraData.transition.progress.duration*this.cameraData.transition.rotationDuration,this.cameraData.transition.rotationDelay);this.cameraData.pose.rotation.copy(n.rotation).slerp(r.rotation,o)}if(r.projection&&n.projection){o=Object(v.a)(v.g,this.cameraData.transition.progress.value,this.cameraData.transition.progress.elapsed,this.cameraData.transition.progress.duration*this.cameraData.transition.matrixDuration,this.cameraData.transition.matrixDelay);!function(t,e,n,r){for(var i=r.elements,o=t.elements,a=e.elements,s=0;s<16;s++)i[s]=o[s]*(1-n)+a[s]*n}(n.projection,r.projection,o,this.cameraData.pose.projection)}}else if(this.cameraData.transition.type===S.a.FadeToBlack){var a=0,s=this.cameraData.transition.duration;t<=e?a=t:(Object(c.b)(this.cameraData.transition.to,this.cameraData.pose,!1),a=t>=s-e?s-t:e),this.cameraData.transition.blackoutProgress.updateAbsolute(a),this.cameraData.transition.progress.updateAbsolute(t<=e?0:s)}this.cameraData.pose.commit(),this.cameraData.transition.commit()}},e.prototype.endInternalTransition=function(t){Object(c.b)(this.cameraData.transition.to,this.cameraData.pose,!1),this.cameraData.transition.type=null,this.cameraData.transition.active=!1,this.cameraData.transition.activeInternal=!1,this.cameraData.transition.progress.stop(1),t===S.a.FadeToBlack&&this.cameraData.transition.blackoutProgress.stop(0),this.cameraData.pose.commit(),this.cameraData.transition.commit()},e.prototype.adjustProjectionZoom=function(t,e){var n=1/e;return t.elements[0]=n/this.canvas.aspectRatio,t.elements[5]=n,t},e.prototype.setBaseProjection=function(t){this.cameraData.setBaseProjection(t)},e}(s.a);e.default=R},function(t,e,n){"use strict";e.a=Object.freeze({signedUrlDefaultExpireTime:24e4,signedUrlCheckInterval:1e4,signedUrlRefreshBuffer:15e3,visionTilingStartDate:new Date("8/26/2016"),visionTilingStartVersion:"1.1.407.13667",epsilon:1e-5,skyboxMeshGroup:"_group_skybox_",skysphereMeshGroup:"_group_skysphere_"})},function(t,e,n){"use strict";var r,i;n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i})),function(t){t.Desktop="desktop",t.Mobile="mobile",t.VrOrientOnly="xr.orientonly",t.VrWithController="xr.controller",t.VrWithTrackedController="xr.trackedcontroller"}(r||(r={})),function(t){t.None="interaction.none",t.Direct="interaction.direct",t.Key="interaction.key",t.Gui="interaction.gui",t.Mouse="interaction.mouse",t.Touch="interaction.touch",t.Pen="interaction.pen",t.XRController="interaction.xr.controller",t.XRGaze="interaction.xr.gaze",t.XRScreen="interaction.xr.screen"}(i||(i={}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return u})),n.d(e,"c",(function(){return f}));var r,i,o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};!function(t){t[t.None=0]="None",t[t.Duration=1]="Duration",t[t.Phase=2]="Phase",t[t.Promise=3]="Promise"}(i||(i={}));var s,c=function(t){this.type=t},u=function(t){function e(){return t.call(this,i.None)||this}return o(e,t),e}(c),l=function(t){function e(e){var n=t.call(this,i.Duration)||this;return n.duration=e,n.startTime=Date.now(),n}return o(e,t),e}(c),h=function(t){function e(e){var n=t.call(this,i.Phase)||this;return n.phase=e,n}return o(e,t),e}(c);!function(t){t[t.Pending=0]="Pending",t[t.Fulfilled=1]="Fulfilled",t[t.Rejected=2]="Rejected"}(s||(s={}));var f=function(t){function e(e){var n=t.call(this,i.Promise)||this;return n.promise=e,n.promiseState=s.Pending,e.then((function(){n.promiseState=s.Fulfilled})).catch((function(){n.promiseState=s.Rejected})),n}return o(e,t),e}(c),p=function(){function t(t,e){void 0===e&&(e=!0),this.generator=t,e&&this.start()}return t.prototype.start=function(){this.started||(this.iterator=this.generator()),this.started=!0},t.prototype.iterate=function(){var t=this.iterator.next();this.currentResult=t.value,t.done&&(this.started=!1)},t}(),d=function(){function t(){this.generators=[]}return t.prototype.startGenerator=function(t){for(var e=this.generators.length,n=0;n<this.generators.length;n++){this.generators[n].generator===t&&(e=n)}this.generators[e]=new p(t)},t.prototype.stopGenerator=function(t){var e,n;try{for(var r=a(this.generators),i=r.next();!i.done;i=r.next()){var o=i.value;o.generator===t&&(o.started=!1)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.processGenerators=function(t,e){var n,r;try{for(var o=a(this.generators),c=o.next();!c.done;c=o.next()){var p=c.value;if(p.started)switch(t){case i.None:(!p.currentResult||p.currentResult instanceof u)&&p.iterate();break;case i.Phase:if(p.currentResult instanceof h){var d=p.currentResult;void 0!==e&&d.phase===e&&p.iterate()}break;case i.Promise:if(p.currentResult instanceof f)p.currentResult.promiseState===s.Fulfilled&&p.iterate();break;case i.Duration:if(p.currentResult instanceof l){var y=p.currentResult;Date.now()-y.startTime>=y.duration&&p.iterate()}}}}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},t}();e.d=d},function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return c}));var r,i,o=n(5),a=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(){return(s=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};!function(t){t.left="left",t.top="top",t.width="width",t.height="height"}(i||(i={}));var c=function(t){function e(e){var n=t.call(this)||this;return n.name="resize-canvas",n.payload=s({},e),n}return a(e,t),e}(o.a)},function(t,e,n){"use strict";n.d(e,"g",(function(){return u})),n.d(e,"c",(function(){return l})),n.d(e,"f",(function(){return h})),n.d(e,"d",(function(){return p})),n.d(e,"b",(function(){return d})),n.d(e,"e",(function(){return y})),n.d(e,"a",(function(){return m}));var r,i,o,a,s=n(0),c=n(3),u=(r=new s.jb,i=new s.jb,function(t,e,n,o){return n=n||new s.Ic,o=o||new s.Jc,f(t,i),r.getInverse(i),o.copy(e).applyMatrix4(r).applyMatrix4(t.pose.projection.asThreeMatrix4()),m(t.width,t.height,o,n),{screenPosition:n,ndcPosition:o}}),l=(o=new s.Jc,a=new s.Ic,function(t,e,n,r,i,s){return o.copy(h(t,e,n,s)),m(r,i,o,a),a}),h=function(){var t=new s.jb,e=new s.jb,n=new s.Jc;return function(r,i,o,a){return t.compose(i,o,c.b.UNIT),e.getInverse(t),n.copy(r).applyMatrix4(e).applyMatrix4(a),n}}(),f=function(t,e){return(e=e||new s.jb).compose(t.pose.position,t.pose.rotation,c.b.UNIT)},p=function(t,e,n,r,i){return(i=i||new s.Ic).x=t/n*2-1,i.y=-e/r*2+1,i},d=function(t,e,n,r){return void 0===n&&(n=.5),(r=r||new s.Jc).x=e.x,r.y=e.y,r.z=n,y(t,r)},y=function(){var t=new s.jb,e=new s.jb;return function(n,r,i){return(i=i||new s.Jc).copy(r),e.copy(n.pose.projection.asThreeMatrix4()).getInverse(e),f(n,t),i.applyMatrix4(e).applyMatrix4(t)}}(),m=function(t,e,n,r){return(r=r||new s.Ic).set((n.x+1)*t/2,(1-n.y)*e/2),r}},function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.FloorplanOnly=0]="FloorplanOnly",t[t.ThreeD=1]="ThreeD"}(r||(r={}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return x}));var r,i,o,a=n(0),s=n(3),c=function(){return(c=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},u=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};!function(t){t[t.Axes=1]="Axes",t[t.PlanarAxes=2]="PlanarAxes",t[t.EdgesAndPlanarAxes=3]="EdgesAndPlanarAxes",t[t.Edges=4]="Edges",t[t.Free=5]="Free",t[t.Locked=6]="Locked"}(o||(o={}));var l,h,f,p,d,y,m,v,g,b,w=((r={})[s.a.UP]={dir:Object.freeze(s.b.UP.clone())},r[s.a.DOWN]={dir:Object.freeze(s.b.DOWN.clone())},r[s.a.BACK]={dir:Object.freeze(s.b.BACK.clone())},r[s.a.LEFT]={dir:Object.freeze(s.b.LEFT.clone())},r[s.a.RIGHT]={dir:Object.freeze(s.b.RIGHT.clone())},r[s.a.FORWARD]={dir:Object.freeze(s.b.FORWARD.clone())},r),_=((i={})[s.a.HORIZONTAL_PLANE]={dir:Object.freeze(s.b.HORIZONTAL_PLANE.clone())},i),x=(l=0,h=new a.Jc,f=new a.Jc,p=new a.Jc,d=new a.Jc,y=Object.freeze(s.b.ZERO.clone()),m=Object.keys(w).map((function(t){return c({},w[t],{name:t,angleTo:999})})),v=Object.keys(_).map((function(t){return c({},_[t],{name:t,angleTo:999})})),g=function(t){return(t+3)%2},b=m[0],function(t,e,n){var r,i;if(void 0===n&&(n=o.Axes),n===o.Free)return{position:e.clone(),constrainedAxis:y,axisName:s.a.NONE};if(m.forEach((function(t){return t.angleTo=999})),v.forEach((function(t){return t.angleTo=999})),p.copy(e).sub(t),(l=p.length())<.05)return{position:e.clone(),constrainedAxis:y,axisName:s.a.NONE};d.copy(p).normalize();var c=.05*Math.min(l,1);if(n!==o.Locked){try{for(var w=u(m),_=w.next();!_.done;_=w.next()){var x=_.value,S=a.ib.radToDeg(d.angleTo(x.dir));S<b.angleTo&&(b=x),x.angleTo=S}}catch(t){r={error:t}}finally{try{_&&!_.done&&(i=w.return)&&i.call(w)}finally{if(r)throw r.error}}if(b.angleTo>20){var T=Math.abs(p.y);T*T<c&&(b=v[0])}}return h.set(t.x*g(b.dir.x),t.y*g(b.dir.y),t.z*g(b.dir.z)),f.set(e.x*Math.abs(b.dir.x),e.y*Math.abs(b.dir.y),e.z*Math.abs(b.dir.z)).add(h),n===o.Locked||f.distanceToSquared(e)<c?{position:f.clone(),constrainedAxis:b.dir,axisName:b.name}:{position:e.clone(),constrainedAxis:y,axisName:s.a.NONE}})},function(t,e,n){"use strict";var r=n(0),i=function(){function t(e){this.elements=[],e?!function(t){return void 0!==t.elements}(e)?r.jb.prototype.set.apply(this,e):this.elements=e.elements.slice():r.jb.prototype.set.apply(this,t.identity)}return t.prototype.equals=function(t){return r.jb.prototype.equals.call(this,t)},t.prototype.clone=function(){return new t(this)},t.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],t}();n.d(e,"a",(function(){return s}));var o,a=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(t){function e(e){var n=this;return(n=e instanceof Array?t.call(this,e)||this:e?t.call(this,e)||this:t.call(this)||this).threeMatrix=new r.jb,n}return a(e,t),e.prototype.set=function(t,e,n,i,o,a,s,c,u,l,h,f,p,d,y,m){return r.jb.prototype.set.call(this,t,e,n,i,o,a,s,c,u,l,h,f,p,d,y,m),this},e.prototype.makeScale=function(t,e,n){return r.jb.prototype.makeScale.call(this,t,e,n),this},e.prototype.copy=function(t){for(var e=0;e<this.elements.length;e++)this.elements[e]=t.elements[e];return this},e.prototype.clone=function(){return(new e).copy(this)},e.prototype.transpose=function(){return r.jb.prototype.transpose.call(this)},e.prototype.lookAt=function(t,e,n){return r.jb.prototype.lookAt.call(this,t,e,n),this},e.prototype.setPosition=function(t){return r.jb.prototype.setPosition.call(this,t.x,t.y,t.z),this},e.prototype.extractRotation=function(t){return r.jb.prototype.extractRotation.call(this,t),this},e.prototype.makePerspective=function(t,e,n,i,o,a){return r.jb.prototype.makePerspective.call(this,t,e,n,i,o,a),this},e.prototype.makePerspectiveFov=function(t,e,n,i){void 0===n&&(n=.1),void 0===i&&(i=1e3);var o=n*Math.tan(t*(Math.PI/180)/2),a=-o,s=o*e,c=-s;return r.jb.prototype.makePerspective.call(this,c,s,o,a,n,i),this},e.prototype.makeOrthographic=function(t,e,n,i,o,a){return r.jb.prototype.makeOrthographic.call(this,t,e,n,i,o,a),this},e.prototype.identity=function(){return this.set.apply(this,i.identity)},e.prototype.makeRotationFromQuaternion=function(t){return r.jb.prototype.makeRotationFromQuaternion.call(this,t),this},e.prototype.makeRotationFromEuler=function(t){return r.jb.prototype.makeRotationFromEuler.call(this,t),this},e.prototype.getInverse=function(t){return r.jb.prototype.getInverse.call(this,t),this},e.prototype.premultiply=function(t){return r.jb.prototype.premultiply.call(this,t),this},e.prototype.multiplyMatrices=function(t,e){return r.jb.prototype.multiplyMatrices.call(this,t,e),this},e.prototype.scale=function(t){return r.jb.prototype.scale.call(this,t),this},e.prototype.compose=function(t,e,n){return r.jb.prototype.compose.call(this,t,e,n),this},e.prototype.asThreeMatrix4=function(){return this.threeMatrix.set(this.elements[0],this.elements[4],this.elements[8],this.elements[12],this.elements[1],this.elements[5],this.elements[9],this.elements[13],this.elements[2],this.elements[6],this.elements[10],this.elements[14],this.elements[3],this.elements[7],this.elements[11],this.elements[15])},e}(i)},function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var r,i=n(125),o=n(30),a=n(6),s=n(2),c=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),u=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},l=new s.a("ObservableObject"),h=1===Object(a.A)("debug",0),f=function(t){function e(){var e=t.call(this)||this;return e._propertyObservables={},e._valueCache={},e._dirtyKeys=new Set,Object.defineProperties(e,{_propertyObservables:{value:e._propertyObservables,writable:!1,enumerable:!1},_valueCache:{value:e._valueCache,writable:!1,enumerable:!1},_dirtyKeys:{value:e._dirtyKeys,writable:!1,enumerable:!1}}),h&&setTimeout((function(){!function(t){var e={},n=function(n){t.hasOwnProperty(n)&&(e[n]=t[n],t._valueCache[n]=t[n],Object.defineProperty(t,n,{get:function(){return e[n]},set:function(r){var o=t._valueCache[n];(o!==r||i.a.isObservable(o)&&o._dirtyObservable)&&function(t,e){p.has(t)||p.set(t,{});p.get(t)[e]=Error()}(t,n),e[n]=r},enumerable:!0}))};for(var r in t)n(r)}(e)}),1),e}return c(e,t),e.prototype.onPropertyChanged=function(t,e){var n=this;if(this._propertyObservables[t]||(this._propertyObservables[t]=[]),-1!==this._propertyObservables[t].indexOf(e))throw new Error("This observer function is already observing this Observable, and double subscriptions are not supported.");var r=function(){return n._propertyObservables[t].push(e)};return r(),{renew:r,cancel:function(){return n.removeOnPropertyChanged(t,e)}}},e.prototype.removeOnPropertyChanged=function(t,e){var n=this._propertyObservables[t].indexOf(e);this._propertyObservables[t].splice(n,1)},e.prototype.commit=function(t){var e,n;void 0===t&&(t=[]);try{for(var r=u(t),i=r.next();!i.done;i=r.next()){var o=i.value;this._dirtyKeys.add(o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}this.setDirtyUp(),this.notifyUp()},e.prototype.setDirtyUp=function(){for(var e in this)if(this.hasOwnProperty(e)){var n=this._valueCache[e],r=this[e],o=typeof r,a="undefined"===o||"string"===o||"number"===o||"boolean"===o||null===r;if(this._propertyObservables[e]&&!a&&!i.a.isObservable(r))throw new Error("Property "+e+" has property listeners, but has a value that is not observable or a primitive!");n!==r?(this.removeChildObservables(n),this.addChildObservable(r),this._valueCache[e]=r,this._dirtyKeys.add(e)):i.a.isObservable(n)&&n._dirtyObservable&&this._dirtyKeys.add(e)}t.prototype.setDirtyUp.call(this)},e.prototype.notifyObservers=function(){var e,n,r,i;if(this._dirtyObservable&&!this._observerNotifying&&this._activeObservable){this._observerNotifying=!0;try{for(var o=u(this._dirtyKeys),a=o.next();!a.done;a=o.next()){var s=a.value;try{for(var c=u(this._propertyObservables[s]||[]),l=c.next();!l.done;l=c.next()){var f=l.value;this.notifyPropertyObserver(f,s)}}catch(t){r={error:t}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}h&&d(this,s)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}this._observerNotifying=!1,this._dirtyKeys.clear()}t.prototype.notifyObservers.call(this)},e.prototype.notifyPropertyObserver=function(t,e){t(this._valueCache[e])},e.prototype.notifyObserver=function(t){t(this)},e.prototype.deepCopy=function(){var t={};for(var e in this)this.hasOwnProperty(e)&&(t[e]=Object(o.a)(this[e]));return t},e}(i.a),p=new Map;function d(t,e){if(p.has(t)){var n=p.get(t);n[e]&&delete n[e]}}if(h)var y=setInterval((function(){(function(){var t,e;try{for(var n=u(p.values()),r=n.next();!r.done;r=n.next()){var i=r.value;for(var o in i)return l.error('ObservableObject property "'+o+'" was still dirty after one tick! Did you forget a .commit()?'),l.error("See stack trace of the property write below:"),l.error(i[o].stack),!0}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return!1})()&&void 0!==y&&clearInterval(y)}),16)},function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return s}));var r,i=n(9),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e){var n=t.call(this)||this;return n.phase=e,n}return o(e,t),e}(i.a),s=function(t){function e(e){var n=t.call(this)||this;return n.application=e,n}return o(e,t),e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return d})),n.d(e,"d",(function(){return y})),n.d(e,"b",(function(){return m}));var r,i,o=n(194),a=n(20),s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(){return(c=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},u=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},l=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},h=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},f=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},p=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(f(arguments[e]));return t};!function(t){t.POST="POST",t.PATCH="PATCH",t.PUT="PUT"}(i||(i={}));var d=function(t){function e(e){var n=t.call(this)||this;return n.config=e,n}return s(e,t),e.prototype.read=function(){return u(this,void 0,Promise,(function(){var t,e,n,r,i;return l(this,(function(o){switch(o.label){case 0:return t=this.config,e=t.adapter,n=t.deserialize,r=null,this.config.cachedData&&this.config.cachedData.data?(r=this.config.cachedData.data,[3,3]):[3,1];case 1:return[4,this.config.queue.get(this.config.path,this.options)];case 2:r=o.sent(),this.config.cachedData&&(this.config.cachedData.data=r),o.label=3;case 3:return i=e?e.decode(r):r,[2,n(i)]}}))}))},e.prototype.clearCache=function(){this.config.cachedData&&(this.config.cachedData.data=null)},e}(function(){function t(){this._options={responseType:"json"}}return Object.defineProperty(t.prototype,"options",{get:function(){var t=this._options;return t.auth=Object(o.b)(),t},enumerable:!0,configurable:!0}),t}()),y=function(t){function e(e){var n=t.call(this,e)||this;return n.config=e,n}return s(e,t),e.prototype.create=function(t){return u(this,void 0,Promise,(function(){var e,n,r,i,o,a;return l(this,(function(s){return this.clearCache(),e=this.config,n=e.adapter,r=e.serialize,i=r?r(t):t,o=n?n.encode(i):i,a=c({},this.options,{body:o}),[2,this.config.queue.put(this.config.path,a)]}))}))},e.prototype.update=function(t,e){return u(this,void 0,Promise,(function(){var n,r,o,a,s,u;return l(this,(function(l){return this.clearCache(),n=this.config,r=n.adapter,o=n.serialize,a=o?o(t,e):t,s=r?r.encode(a):a,u=c({},this.options,{body:s}),[2,this.config.queue.request(this.config.httpMethod||i.POST,this.config.path,u)]}))}))},e.prototype.delete=function(t){return u(this,void 0,Promise,(function(){var e,n,r,i,o,a;return l(this,(function(s){switch(s.label){case 0:if(this.clearCache(),!(t instanceof Array))return[3,9];s.label=1;case 1:s.trys.push([1,6,7,8]),r=h(t),i=r.next(),s.label=2;case 2:return i.done?[3,5]:(o=i.value,[4,this.config.queue.delete(this.config.path+"/"+o.sid,this.options)]);case 3:s.sent(),s.label=4;case 4:return i=r.next(),[3,2];case 5:return[3,8];case 6:return a=s.sent(),e={error:a},[3,8];case 7:try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}return[7];case 8:return[2];case 9:return[2,this.config.queue.delete(this.config.path,this.options)]}}))}))},Object.defineProperty(e.prototype,"acceptsPartial",{get:function(){return this.config.httpMethod===i.PATCH},enumerable:!0,configurable:!0}),e}(d),m=function(t){function e(e){var n=t.call(this,e)||this;return n.config=e,n.acceptsPartial=!1,n.config.batchUpdate="batchUpdate"in n.config&&n.config.batchUpdate,n}return s(e,t),e.prototype.create=function(t){return u(this,void 0,Promise,(function(){return l(this,(function(t){throw Error("Not implemented")}))}))},e.prototype.updateBatch=function(t,e){var n,r,o=this.config,a=o.adapter,s=o.serialize,u=[],l=p(new Set(p(Object.keys(t),Object.keys(e))));try{for(var f=h(l),d=f.next();!d.done;d=f.next()){var y=d.value;t[y]||e[y]||u.push(this.config.queue.delete(this.config.path+"/"+y,this.options))}}catch(t){n={error:t}}finally{try{d&&!d.done&&(r=f.return)&&r.call(f)}finally{if(n)throw n.error}}var m=s?s(t,e):t,v=a?a.encode(m):m,g=c({},this.options,{body:v});return u.push(this.config.queue.request(this.config.httpMethod||i.POST,this.config.path,g)),Promise.all(u)},e.prototype.updateInternal=function(t,e){var n=this.config,r=n.adapter,o=n.serialize,s=[],u=c({},this.options),l=Object.keys(t),h=Object.keys(e),f=Object(a.p)(l.concat(h));for(var p in f){var d=f[p],y=t[d]||e[d];if(y){var m={};m[d]=y;var v={},g=e[d];g&&(v[d]=g);var b=o?o(m,v):m,w=r?r.encode(b):b;u.body=w,s.push(this.config.queue.request(this.config.httpMethod||i.POST,this.config.path,u))}else s.push(this.config.queue.delete(this.config.path+"/"+d,this.options))}return Promise.all(s)},e.prototype.update=function(t,e){return u(this,void 0,Promise,(function(){return l(this,(function(n){switch(n.label){case 0:return this.clearCache(),[4,this.config.batchUpdate?this.updateBatch(t,e||{}):this.updateInternal(t,e||{})];case 1:return n.sent(),[2]}}))}))},e.prototype.delete=function(t){return u(this,void 0,Promise,(function(){return l(this,(function(t){throw Error("Not implemented")}))}))},e}(d)},function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"d",(function(){return s})),n.d(e,"g",(function(){return c})),n.d(e,"f",(function(){return u})),n.d(e,"e",(function(){return l})),n.d(e,"h",(function(){return h})),n.d(e,"c",(function(){return f})),n.d(e,"b",(function(){return p}));var r,i=n(5),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(i.a),s=function(t){function e(e){var n=t.call(this)||this;return n.sweepId=e,n.payload={sweepId:e},n}return o(e,t),e}(i.a),c=function(t){function e(e,n){var r=t.call(this)||this;return r.sweepId=e,r.visible=n,r.payload={sweepId:e,visible:n},r}return o(e,t),e}(i.a),u=function(t){function e(e,n,r){void 0===r&&(r=500);var i=t.call(this)||this;return i.id="SELECT_SWEEP",i.payload={id:e,selected:n,duration:r},i}return o(e,t),e}(i.a),l=function(t){function e(e,n,r){void 0===r&&(r=500);var i=t.call(this)||this;return i.id="HOVER_SWEEP",i.payload={id:e,hovered:n,duration:r},i}return o(e,t),e}(i.a),h=function(t){function e(e){var n=t.call(this)||this;return n.id="TOGGLE_NON_PANO_CURRENT_PUCK",n.payload={visible:e},n}return o(e,t),e}(i.a),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.id="ENABLE_SWEEP_SELECTION",e}return o(e,t),e}(i.a),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.id="DISABLE_SWEEP_SELECTION",e}return o(e,t),e}(i.a)},function(t,e,n){"use strict";n.d(e,"c",(function(){return r})),n.d(e,"b",(function(){return i})),n.d(e,"d",(function(){return o})),n.d(e,"a",(function(){return a}));var r=function(t){return t.prototype.constructor.name},i=function(t){return t.constructor},o=function(t){var e=t.toString();return e.substring(0,e.indexOf("\n")).split(" ")[1]},a=function(){function t(t){void 0===t&&(t=!1),this.typeLookup=[],this.funcProto=Function.__proto__,this.allowInheritance=t}return t.prototype.addIndexByType=function(t){if(!t)throw Error("Cannot index undefined type");if(-1!==this.typeLookup.indexOf(t))throw Error("Type already registered");return this.typeLookup.push(t)-1},t.prototype.getIndexByType=function(t,e){if(!t)throw Error("Cannot index undefined type");var n=-1;if(this.allowInheritance)for(var r=0;r<this.typeLookup.length;r++){for(var i=this.typeLookup[r];i!==t&&i!==this.funcProto;)i=i.__proto__;if(i===t)return r}else n=this.typeLookup.indexOf(t);return-1===n&&e&&(n=this.typeLookup.push(t)-1),n},t.prototype.getIndicesByType=function(t){if(!t)throw Error("Cannot index undefined type");if(!this.allowInheritance)return[this.getIndexByType(t)];for(var e=[],n=0;n<this.typeLookup.length;n++){for(var r=this.typeLookup[n];r!==t&&r!==this.funcProto;)r=r.__proto__;r===t&&e.push(n)}return e},t.prototype.getIndexByInstance=function(t,e){if(!t)throw Error("Cannot index undefined data");var n=this.typeLookup.indexOf(t.constructor);return-1===n&&e&&(n=this.typeLookup.push(t.constructor)-1),n},t.prototype.getTypeByIndex=function(t){if(!(t in this.typeLookup))throw Error("Index not found");return this.typeLookup[t]},t.prototype.getKnownTypes=function(){return this.typeLookup.concat()},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"c",(function(){return a})),n.d(e,"g",(function(){return s})),n.d(e,"h",(function(){return c})),n.d(e,"f",(function(){return u})),n.d(e,"b",(function(){return l})),n.d(e,"i",(function(){return h})),n.d(e,"d",(function(){return f})),n.d(e,"e",(function(){return p}));var r=n(33),i=n(14),o="TransitionType",a=!0,s=i.x,c=i.A,u=i.q,l=i.h,h=i.D,f=i.p,p=r.b.Auto},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return c}));var r,i,o=n(23),a=n(38),s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});!function(t){t[t.CLOSED=0]="CLOSED",t[t.IDLE=1]="IDLE",t[t.CREATING=2]="CREATING",t[t.PRESSING=3]="PRESSING",t[t.PLACING=4]="PLACING",t[t.PLACED=5]="PLACED",t[t.EDITING=6]="EDITING",t[t.MOVING=7]="MOVING"}(i||(i={}));var c=function(t){function e(e){var n=t.call(this)||this;return n.data=e,n.name="label-view",n.toolStateObservable=Object(a.b)(i.CLOSED),n.creatingNewLabel=!1,n.selectedObservable=new a.a(null),n.progressObservable=new a.a(-1),n.screenPositionObservable=new a.a(null),n.labelPlacementObservable=new a.a(null),n}return s(e,t),e.prototype.initialize=function(t){},e.prototype.dispose=function(){},e.prototype.clearLabelCreation=function(){this.isCreatingNewLabel()&&(this.setScreenPosition(null),this.setLabelPlacement(null),this.setSelected(null),this.setToolState(i.IDLE))},e.prototype.iterate=function(t){this.data.iterate(t)},Object.defineProperty(e.prototype,"screenPosition",{get:function(){return this.screenPositionObservable.value},enumerable:!0,configurable:!0}),e.prototype.setScreenPosition=function(t){this.screenPositionObservable.value=t},e.prototype.onScreenPositionChanged=function(t,e){void 0===e&&(e=!1);var n=this.screenPositionObservable.onChanged(t);return e&&n.renew(),n},e.prototype.setLabelPlacement=function(t){this.labelPlacementObservable.value=t},Object.defineProperty(e.prototype,"labelPlacement",{get:function(){return this.labelPlacementObservable.value},enumerable:!0,configurable:!0}),e.prototype.onLabelPlacementChanged=function(t,e){void 0===e&&(e=!1);var n=this.labelPlacementObservable.onChanged(t);return e&&n.renew(),n},Object.defineProperty(e.prototype,"selected",{get:function(){return this.selectedObservable.value},enumerable:!0,configurable:!0}),e.prototype.setSelected=function(t){this.selectedObservable.value=t},e.prototype.onSelectedChanged=function(t,e){void 0===e&&(e=!1);var n=this.selectedObservable.onChanged(t);return e&&n.renew(),n},e.prototype.setProgress=function(t){this.progressObservable.value=t},Object.defineProperty(e.prototype,"progress",{get:function(){return this.progressObservable.value},enumerable:!0,configurable:!0}),e.prototype.onProgressChanged=function(t){return this.progressObservable.onChanged(t)},e.prototype.setToolState=function(t){switch(t){case i.CREATING:this.creatingNewLabel=!0;break;case i.IDLE:case i.CLOSED:this.creatingNewLabel=!1}this.toolStateObservable.value=t},Object.defineProperty(e.prototype,"toolState",{get:function(){return this.toolStateObservable.value},enumerable:!0,configurable:!0}),e.prototype.isCreatingNewLabel=function(){return this.creatingNewLabel},e.prototype.onToolStateChanged=function(t,e){void 0===e&&(e=!1);var n=this.toolStateObservable.onChanged(t);return e&&n.renew(),n},e}(o.a)},function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return o})),n.d(e,"d",(function(){return a})),n.d(e,"e",(function(){return s})),n.d(e,"c",(function(){return c})),n.d(e,"f",(function(){return u})),n.d(e,"j",(function(){return l})),n.d(e,"i",(function(){return h})),n.d(e,"h",(function(){return f})),n.d(e,"g",(function(){return p})),n.d(e,"l",(function(){return d})),n.d(e,"k",(function(){return y}));var r=n(6),i=1e3/60,o=.05,a=Math.PI/2/1e3,s=.1/60,c=.02,u=25,l=3,h=3,f=.16,p=Object(r.m)()?45:Object(r.q)()?20:35,d=.01,y=2},function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.DOWN=0]="DOWN",t[t.PRESSED=1]="PRESSED",t[t.UP=2]="UP"}(r||(r={}))},,function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return o})),n.d(e,"b",(function(){return a}));var r=n(68),i={fov:75,near:.1,far:1500},o=function(t,e){return e||(e=new r.a),e.makePerspectiveFov(i.fov,t,i.near,i.far)},a=function(t,e,n,o){void 0===n&&(n=1),o||(o=new r.a);var a=t/2,s=e/2,c=o.makeOrthographic(-a,a,s,-s,i.near,i.far);return c.elements[0]*=n,c.elements[5]*=n,c}},function(t,e){t.exports="precision highp float;\nprecision highp int;\n\nuniform mat4 viewMatrix;\nuniform vec3 cameraPosition;\n"},function(t,e){t.exports="precision highp float;\nprecision highp int;\n\nuniform mat4 modelMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\n"},function(t,e,n){"use strict";var r,i=n(0),o=n(79),a=n(43),s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(t){function e(e){var n=t.call(this)||this;return n.anchor=n,n.update=function(t){n.anchor.position.copy(t.position),n.camera.quaternion.copy(t.rotation),n.camera.projectionMatrix.copy(t.projection.asThreeMatrix4()),n.camera.projectionMatrixInverse.getInverse(n.camera.projectionMatrix),n.updateMatrixWorld(!0)},n.camera=new i.Gb(o.a.fov,e,o.a.near,o.a.far),n.add(n.camera),n.camera.layers.mask=a.a.ALL.mask,n.name="CameraRig",n}return s(e,t),e.prototype.dispose=function(){this.remove(this.camera)},e}(i.zb);n.d(e,"a",(function(){return u}));var u,l=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};!function(t){t[t.Root=0]="Root",t[t.CameraRig=1]="CameraRig"}(u||(u={}));var h=function(){function t(t,e,n){this.scene=t,this.threeRenderer=e,this.cameraData=n,this.ids=u,this.rendering=!1,this.cameraRigStale=!0}return t.prototype.add=function(){for(var t,e,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];try{for(var i=l(n),o=i.next();!o.done;o=i.next()){var a=o.value;this.addChild(u.Root,a)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},t.prototype.remove=function(){for(var t,e,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];try{for(var i=l(n),o=i.next();!o.done;o=i.next()){var a=o.value;this.removeChild(u.Root,a)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},t.prototype.addChild=function(t,e){switch(t){case u.Root:this.scene.add(e);break;case u.CameraRig:this.cameraRig.add(e);break;default:return!1}return!0},t.prototype.removeChild=function(t,e){switch(t){case u.Root:this.scene.remove(e);break;case u.CameraRig:this.cameraRig.remove(e);break;default:return!1}return!0},Object.defineProperty(t.prototype,"camera",{get:function(){return this.updateCameraRig(),this.cameraRig.camera},enumerable:!0,configurable:!0}),t.prototype.init=function(){var t=this.cameraData.aspect();this.cameraRig=new c(t)},t.prototype.dispose=function(){this.cameraRig.dispose()},t.prototype.startRender=function(t){this.rendering=t},t.prototype.activate=function(t){var e=this;this.scene.add(this.cameraRig),this.cameraDataCallback=function(){return e.cameraRigStale=!0},this.cameraData.pose.onChanged(this.cameraDataCallback)},t.prototype.deactivate=function(t){this.scene.remove(this.cameraRig),this.cameraData.pose.removeOnChanged(this.cameraDataCallback)},t.prototype.beforeRender=function(){this.updateCameraRig()},t.prototype.updateCameraRig=function(){this.cameraRigStale&&(this.cameraRig.update(this.cameraData.pose),this.cameraRigStale=!1)},t.prototype.render=function(){this.rendering&&this.threeRenderer.render(this.scene,this.cameraRig.camera)},t.prototype.setCameraDirty=function(){this.cameraRigStale=!0,this.cameraRig.camera.updateProjectionMatrix()},t}();e.b=h},function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t.PanoTexture="PANO_TEXTURE",t.PanoTextureTransition="PANO_TEXTURE_TRANSITION",t.MeshTexture="MESH_TEXTURE",t.ColorOverlay="COLOR_OVERLAY",t.MeshPreviewSphere="MESH_PREVIEW_SPHERE",t.Wireframe="WIREFRAME",t.FlatShading="FLAT_SHADING"}(r||(r={}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return l})),n.d(e,"b",(function(){return h}));var r,i=n(125),o=n(30),a=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},c=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};function u(t){return Object(o.d)(t)?""+t:t}var l=function(t){function e(){var e=t.call(this)||this;return e.map={},e._keysSet=new Set,e._keysList=[],e}return a(e,t),Object.defineProperty(e.prototype,"keys",{get:function(){return this._keysList.slice()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"values",{get:function(){var t=this;return this._keysList.map((function(e){return t.get(e)}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._keysList.length},enumerable:!0,configurable:!0}),e.prototype[Symbol.iterator]=function(){var t,e,n,r,i,o;return s(this,(function(a){switch(a.label){case 0:a.trys.push([0,5,6,7]),n=c(this._keysList),r=n.next(),a.label=1;case 1:return r.done?[3,4]:(i=r.value,[4,this.get(i)]);case 2:a.sent(),a.label=3;case 3:return r=n.next(),[3,1];case 4:return[3,7];case 5:return o=a.sent(),t={error:o},[3,7];case 6:try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}return[7];case 7:return[2]}}))},e.prototype.get=function(t){return this.map[t]},e.prototype.has=function(t){return void 0!==this.map[t]},e.prototype.set=function(t,e){t=u(t),this.map[t]!==e&&(this.removeChildObservables(this.map[t]),this.addChildObservable(e),this.map[t]=e,this._keysSet.has(t)||(this._keysList.push(t),this._keysSet.add(t)),this.setDirty())},e.prototype.delete=function(t){t=u(t),this.removeChildObservables(this.map[t]);var e=this.map.hasOwnProperty(t);return delete this.map[t],e&&(this._keysSet.delete(t),this._keysList.splice(this._keysList.indexOf(t),1),this.setDirty()),e},e.prototype.onElementChanged=function(t){var e=this,n=Object.assign({},this.map);return this.onChanged((function(){var r,o;for(var a in n)t.onRemoved&&!e.has(a)&&t.onRemoved(n[a],a);try{for(var s=c(e._keysList),u=s.next();!u.done;u=s.next()){a=u.value;var l=e.get(a);void 0===n[a]?t.onAdded&&t.onAdded(l,a):(i.a.isObservable(l)&&l._dirtyObservable||l!==n[a])&&(t.onUpdated&&null!==l?t.onUpdated(l,a):t.onRemoved&&null===l&&t.onRemoved(n[a],a))}}catch(t){r={error:t}}finally{try{u&&!u.done&&(o=s.return)&&o.call(s)}finally{if(r)throw r.error}}n=Object.assign({},e.map)}))},e.prototype.deepCopy=function(){var t,e,n={};try{for(var r=c(this._keysList),i=r.next();!i.done;i=r.next()){var a=i.value;n[a]=Object(o.a)(this.map[a])}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return n},e}(i.a),h=function(t){void 0===t&&(t={});var e=new l;for(var n in t)e.set(n,t[n]);return e}},function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t.NONE="none",t.DEFAULT="default",t.MOVE="move",t.MOVE_LF="col-resize",t.MOVE_UD="row-resize",t.XHAIR="crosshair",t.PLUS="cell",t.QUESTION="help",t.NOPE="not-allowed",t.FINGER="pointer",t.TEXT="text",t.TEXT_VERT="vertical-text",t.ZOOM_IN="zoom-in",t.ZOOM_OUT="zoom-in",t.GRAB="grab",t.GRABBING="grabbing",t.ARROW_R="e-resize",t.ARROW_L="w-resize",t.ARROW_U="n-resize",t.ARROW_D="s-resize",t.ARROW_UR="ne-resize",t.ARROW_UL="nw-resize",t.ARROW_DR="se-resize",t.ARROW_DL="sw-resize",t.ARROW_LR="ew-resize",t.ARROW_UD="ns-resize",t.ARROW_URDL="nesw-resize",t.ARROW_ULDR="nwse-resize"}(r||(r={}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(44),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e){var n=t.call(this,e||"Store is currently in read-only mode")||this;return n.name="ReadOnly",n}return o(e,t),e}(i.a)},function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t.UnitType="user_preference/unit_type",t.MeasurementSnapping="user_preference/measurement_snapping",t.MeasurementContinuousLines="user_preference/measurement_continuous",t.MeasurementUserNudgeSeen="user_preference/measurement_nudge",t.HighlightReelSettingsTab="user_preference/highlight_reel_settings_tab"}(r||(r={}))},function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.Begin=0]="Begin",t[t.Logic=1]="Logic",t[t.Render=2]="Render",t[t.End=3]="End"}(r||(r={}))},function(t,e,n){"use strict";n.d(e,"e",(function(){return a})),n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return c})),n.d(e,"f",(function(){return u})),n.d(e,"g",(function(){return l})),n.d(e,"c",(function(){return h})),n.d(e,"h",(function(){return f})),n.d(e,"d",(function(){return p}));var r,i=n(9),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e){var n=t.call(this)||this;return n.data=e,n}return o(e,t),e}(i.a),s=function(t){function e(e){var n=t.call(this)||this;return n.data=e,n}return o(e,t),e}(i.a),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(i.a),u=function(t){function e(e,n){var r=t.call(this)||this;return r.sid=e,r.text=n,r}return o(e,t),e}(i.a),l=function(t){function e(e,n,r){var i=t.call(this)||this;return i.sid=e,i.oldText=n,i.newText=r,i}return o(e,t),e}(i.a),h=function(t){function e(e){var n=t.call(this)||this;return n.data=e,n}return o(e,t),e}(i.a),f=function(t){function e(e){var n=t.call(this)||this;return n.data=e,n}return o(e,t),e}(i.a),p=function(t){function e(e,n,r){var i=t.call(this)||this;return i.opened=e,i.viewmode=n,i.count=r,i}return o(e,t),e}(i.a);!function(t){function e(e){var n=t.call(this)||this;return n.snapping=e,n}o(e,t)}(i.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r,i=n(5),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(){return(a=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},s=function(t){function e(e){var n=t.call(this)||this;return n.id="MOVE_TO_SWEEP",n.payload=a({},e),n}return o(e,t),e}(i.a)},function(t,e,n){"use strict";n.r(e);var r,i,o=n(4),a=n(0),s=n(7),c=n(161),u=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=function(t){function e(e,n){var r=this,i=e.max,o=e.min,s=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1];s[0]=i.x,s[1]=i.y,s[2]=i.z,s[3]=o.x,s[4]=i.y,s[5]=i.z,s[6]=o.x,s[7]=o.y,s[8]=i.z,s[9]=i.x,s[10]=o.y,s[11]=i.z,s[12]=i.x,s[13]=i.y,s[14]=o.z,s[15]=o.x,s[16]=i.y,s[17]=o.z,s[18]=o.x,s[19]=o.y,s[20]=o.z,s[21]=i.x,s[22]=o.y,s[23]=o.z;var c=void 0!==n?n:16776960,u=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),l=new a.m;return l.setIndex(new a.l(u,1)),l.setAttribute("position",new a.E(s,3)),l.computeBoundingSphere(),(r=t.call(this,l,new a.V({color:c}))||this).box=e,r}return u(e,t),e.prototype.updateMatrixWorld=function(t){var e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),a.zb.prototype.updateMatrixWorld.call(this,t))},e}(a.X),h=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),f=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},p=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},d=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},y=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(d(arguments[e]));return t},m=new a.jb,v=function(){function t(){this.parent=null,this.raycastDistance=1/0}return t.prototype.updateRaycastDistance=function(t){this.raycastDistance=this.bounds.distanceToPoint(t)},t}(),g=function(t){function e(e,n){var r=t.call(this)||this;return r.mesh=e,r.geometry=r.makeGeometryFromFaces(n),r}return h(e,t),e.prototype.makeGeometryFromFaces=function(t){var e,n,r=new Float32Array(9*t.length),i=0,o={};try{for(var s=p(t),c=s.next();!c.done;c=s.next()){var u=c.value;(f=o[u.materialIndex])||(f=o[u.materialIndex]={start:i/3,count:0,materialIndex:u.materialIndex}),f.count+=3,r[i++]=u.ax,r[i++]=u.ay,r[i++]=u.az,r[i++]=u.bx,r[i++]=u.by,r[i++]=u.bz,r[i++]=u.cx,r[i++]=u.cy,r[i++]=u.cz}}catch(t){e={error:t}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}var l=new a.m;for(var h in l.setAttribute("position",new a.l(r,3)),l.computeBoundingBox(),l.boundingBox&&(l.boundingSphere=l.boundingBox.getBoundingSphere(new a.mc)),o){var f=o[h];l.addGroup(f.start,f.count,f.materialIndex)}return l},Object.defineProperty(e.prototype,"bounds",{get:function(){return Object(c.a)(this.geometry)},enumerable:!0,configurable:!0}),e.prototype.raycast=function(t,e){var n=this.mesh.geometry,r=this.mesh.matrixWorld,i=this.mesh.matrix;this.mesh.geometry=this.geometry,this.mesh.matrix=m,this.mesh.matrixWorld=m,this.mesh.raycast(t,e),this.mesh.geometry=n,this.mesh.matrix=i,this.mesh.matrixWorld=r},e}(v),b=function(t){function e(e){var n=t.call(this)||this;return n.mesh=e,n._bounds=new a.h,n.mesh.geometry.boundingBox||n.mesh.geometry.computeBoundingBox(),n}return h(e,t),Object.defineProperty(e.prototype,"bounds",{get:function(){return this._bounds.copy(Object(c.a)(this.mesh.geometry)).applyMatrix4(this.mesh.matrixWorld)},enumerable:!0,configurable:!0}),e.prototype.raycast=function(t,e){this.mesh.visible&&this.mesh.raycast(t,e)},e}(v),w=function(t,e,n,r,i,o,s,c,u,l){this.materialIndex=t,this.ax=e,this.ay=n,this.az=r,this.bx=i,this.by=o,this.bz=s,this.cx=c,this.cy=u,this.cz=l,this.bounds=new a.h(new a.Jc(Math.min(e,i,c),Math.min(n,o,u),Math.min(r,s,l)),new a.Jc(Math.max(e,i,c),Math.max(n,o,u),Math.max(r,s,l)))},_=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.level=n,o.leafMinSize=r,o.leafMaxFaces=i,o.childNodes=[],o.children=[],o.listeners={},o.bounds=e.clone(),o.size=e.getSize(new a.Jc),o}return h(e,t),Object.defineProperty(e.prototype,"depth",{get:function(){return this.level},enumerable:!0,configurable:!0}),e.prototype.addMeshes=function(t){var e,n,r,i,o,s,c,u,l;return f(this,(function(h){switch(h.label){case 0:t.updateMatrixWorld(!0),r=[],t.traverse((function(t){t instanceof a.lb&&r.push(t)})),h.label=1;case 1:h.trys.push([1,8,9,10]),i=p(r),o=i.next(),h.label=2;case 2:return o.done?[3,7]:(s=o.value,c=new b(s),s.geometry instanceof a.m&&this.bounds.containsBox(c.bounds)?(u=this.geometryToFaces(s.geometry,s.matrixWorld),[4]):[3,5]);case 3:return h.sent(),[5,p(this.addFaces(s,u))];case 4:return h.sent(),[3,6];case 5:this.addMesh(c),h.label=6;case 6:return o=i.next(),[3,2];case 7:return[3,10];case 8:return l=h.sent(),e={error:l},[3,10];case 9:try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}return[7];case 10:return[2]}}))},e.prototype.removeMeshes=function(t){for(var e=!1,n=0;n<this.children.length;n++){var r=this.children[n];(r instanceof b||r instanceof g)&&r.mesh.id===t.id&&(r.parent=null,this.children.splice(n,1),this.emit("removed",this,r),e=!0)}if(!e)throw new Error("Mesh that is being attempted removed does not exist in this node.")},e.prototype.addMesh=function(t){var e,n,r=!1;if(this.size.length()>this.leafMinSize){0===this.childNodes.length&&this.buildChildNodes();try{for(var i=p(this.childNodes),o=i.next();!o.done;o=i.next()){var a=o.value;a.bounds.containsBox(t.bounds)&&(r=!0,a.addMesh(t))}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}}r||this.add(t)},e.prototype.add=function(t){if(t.parent)throw new Error("ColliderNode already has a parent, remove before trying to add in another node");t.parent=this,this.children.push(t),this.emit("added",this,t)},e.prototype.addFaces=function(t,e){var n;return f(this,(function(r){switch(r.label){case 0:return e.length>this.leafMaxFaces&&this.size.length()>this.leafMinSize?(0===this.childNodes.length&&this.buildChildNodes(),[5,p(this.splitFaces(t,e))]):[3,2];case 1:return r.sent(),[3,4];case 2:return e.length>0?((n=new g(t,e)).bounds.intersect(this.bounds),[4,this.addMesh(n)]):[3,4];case 3:r.sent(),r.label=4;case 4:return[4];case 5:return r.sent(),[2]}}))},e.prototype.splitFaces=function(t,e){var n,r,i,o,a,s,c,u,l,h,d,y;return f(this,(function(f){switch(f.label){case 0:f.trys.push([0,5,6,7]),a=p(this.childNodes),s=a.next(),f.label=1;case 1:if(s.done)return[3,4];c=s.value,u=[];try{for(l=p(e),h=l.next();!h.done;h=l.next())d=h.value,c.bounds.intersectsBox(d.bounds)&&u.push(d)}catch(t){i={error:t}}finally{try{h&&!h.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}return[5,p(c.addFaces(t,u))];case 2:f.sent(),f.label=3;case 3:return s=a.next(),[3,1];case 4:return[3,7];case 5:return y=f.sent(),n={error:y},[3,7];case 6:try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}return[7];case 7:return[2]}}))},e.prototype.buildChildNodes=function(){for(var t=this.size.multiplyScalar(.5),n=0;n<2;n++)for(var r=0;r<2;r++)for(var i=0;i<2;i++){var o=this.bounds.min.x+t.x*i,s=o+t.x,c=this.bounds.min.y+t.y*n,u=c+t.y,l=this.bounds.min.z+t.z*r,h=l+t.z,f=new e(new a.h(new a.Jc(o,c,l),new a.Jc(s,u,h)),this.level+1,this.leafMinSize,this.leafMaxFaces);this.childNodes.push(f),this.add(f)}},e.prototype.raycast=function(t,e){var n,r;if(!0===t.ray.intersectsBox(this.bounds))try{for(var i=p(this.children),o=i.next();!o.done;o=i.next()){o.value.raycast(t,e)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},e.prototype.pick=function(t,n,r){var i,o,a,s,c,u;if(!t.ray.intersectsBox(this.bounds))return n;try{for(var l=p(this.children),h=l.next();!h.done;h=l.next()){(y=h.value).updateRaycastDistance(t.ray.origin)}}catch(t){i={error:t}}finally{try{h&&!h.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}this.children.sort((function(t,e){return t.raycastDistance-e.raycastDistance}));try{for(var f=p(this.children),d=f.next();!d.done;d=f.next()){var y=d.value;if(n&&n.distance<y.raycastDistance)break;if(r(y))if(y instanceof e)n=y.pick(t,n,r);else{var m=[];y.raycast(t,m);try{for(var v=p(m),g=v.next();!g.done;g=v.next()){var b=g.value;(!n||n.distance>b.distance)&&(n=b)}}catch(t){c={error:t}}finally{try{g&&!g.done&&(u=v.return)&&u.call(v)}finally{if(c)throw c.error}}}}}catch(t){a={error:t}}finally{try{d&&!d.done&&(s=f.return)&&s.call(f)}finally{if(a)throw a.error}}return n},e.prototype.geometryToFaces=function(t,e){var n,r,i,o,s=t.getAttribute("position");if(s instanceof a.P)throw new Error("InterleavedBufferAttribute not supported");e.equals(m)||(s=s.clone()).applyMatrix4(e);var c,u=s.array;if(t.index){var l=t.index.array;c=new Array(l.length/3);var h=0,f=t.groups.length>0?t.groups:[{start:0,count:l.length,materialIndex:0}];try{for(var d=p(f),y=d.next();!y.done;y=d.next())for(var v=(T=y.value).start;v<T.start+T.count;v+=3){var g=3*l[v],b=3*l[v+1],_=3*l[v+2];c[h++]=new w(T.materialIndex||0,u[g],u[g+1],u[g+2],u[b],u[b+1],u[b+2],u[_],u[_+1],u[_+2])}}catch(t){n={error:t}}finally{try{y&&!y.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}}else{c=new Array(u.length/9);h=0,f=t.groups.length>0?t.groups:[{start:0,count:u.length/3,materialIndex:0}];try{for(var x=p(f),S=x.next();!S.done;S=x.next()){var T;for(v=3*(T=S.value).start;v<3*(T.start+T.count);v+=9)c[h++]=new w(T.materialIndex||0,u[v],u[v+1],u[v+2],u[v+3],u[v+4],u[v+5],u[v+6],u[v+7],u[v+8])}}catch(t){i={error:t}}finally{try{S&&!S.done&&(o=x.return)&&o.call(x)}finally{if(i)throw i.error}}}return c},e.prototype.getAllBounds=function(t,n,r,i){var o,a;void 0===n&&(n=0),void 0===r&&(r=1/0),void 0===i&&(i=!1);try{for(var s=p(this.children),c=s.next();!c.done;c=s.next()){var u=c.value;this.level>=n&&this.level<=r&&(u instanceof g||!i)&&t.push(u.bounds.clone()),u instanceof e&&u.getAllBounds(t,n,r,i)}}catch(t){o={error:t}}finally{try{c&&!c.done&&(a=s.return)&&a.call(s)}finally{if(o)throw o.error}}},e.prototype.emit=function(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];var a=this.listeners[t]||[];try{for(var s=p(a),c=s.next();!c.done;c=s.next()){var u=c.value;u.apply(void 0,y(i))}}catch(t){e={error:t}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}this.parent&&(r=this.parent).emit.apply(r,y([t],i))},e.prototype.on=function(t,e){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e)},e}(v),x=function(){function t(t,e,n){var r=this;this.meshToNodes={},this._depth=0;var i=Object(s.n)(t);this.root=new _(i,0,e,n),this.root.on("added",(function(t,e){t.depth>r._depth&&(r._depth=t.depth),(e instanceof b||e instanceof g)&&(r.meshToNodes[e.mesh.id]||(r.meshToNodes[e.mesh.id]=[]),r.meshToNodes[e.mesh.id].push(e))})),this.root.on("removed",(function(t,e){if(e instanceof b||e instanceof g)for(var n=r.meshToNodes[e.mesh.id],i=0;i<n.length;i++)n[i]===e&&n.splice(i,1)}))}return Object.defineProperty(t.prototype,"depth",{get:function(){return this._depth},enumerable:!0,configurable:!0}),t.prototype.addMeshesAsync=function(t){return f(this,(function(e){switch(e.label){case 0:return[5,p(this.root.addMeshes(t))];case 1:return e.sent(),[2]}}))},t.prototype.addMeshes=function(t){var e,n;try{for(var r=p(this.root.addMeshes(t)),i=r.next();!i.done;i=r.next())i.value}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.removeMeshes=function(t){var e=this;t.traverse((function(t){var n,r,i=e.meshToNodes[t.id]||[];try{for(var o=p(i),a=o.next();!a.done;a=o.next()){var s=a.value;s.parent&&s.parent.removeMeshes(t)}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}))},t.prototype.raycast=function(t){var e=[];return this.root.raycast(t,e),e},t.prototype.getAllBounds=function(t,e,n){void 0===t&&(t=0),void 0===e&&(e=1/0),void 0===n&&(n=!1);var r=[];return this.root.getAllBounds(r,t,e,n),r},t.prototype.pick=function(t,e){return this.root.pick(t,null,(function(t){return!e||!(t instanceof b||t instanceof g)||e(t.mesh)}))},t.prototype.getDebugBoundsMesh=function(t,e,n,r){var i,o;void 0===t&&(t=16777215),void 0===e&&(e=0),void 0===n&&(n=1/0),void 0===r&&(r=!1);var s=this.getAllBounds(e,n,r),u=new a.V({color:t});if(s.length>0){var h=[];try{for(var f=p(s),d=f.next();!d.done;d=f.next()){var y=d.value,m=new l(y);h.push(m.geometry)}}catch(t){i={error:t}}finally{try{d&&!d.done&&(o=f.return)&&o.call(f)}finally{if(i)throw i.error}}var v=Object(c.b)(h);return new a.X(v,u)}return new a.X(new a.m,u)},t}(),S=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),T=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},M=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}S(e,t)}(a.zb),function(){function t(t,e){var n=this;this.camera=t,this.defaultRaycastFilter=e,this.meshes={},this.octreeEnabledMeshes={},this.raycaster=new a.ec,this.prevRay=new a.dc,this._hitCache=[],this.getOctree=function(){return n.octree},this.addTarget=function(t,e){var r=t,i=r.collider?r.collider:t;n.meshes[t.id]=i,n.octreeEnabledMeshes[t.id]=e,n.octree&&e&&n.octree.addMeshes(t)},this.removeTarget=function(t){n.octree&&n.octreeEnabledMeshes[t.id]&&n.octree.removeMeshes(t),delete n.meshes[t.id]}}return t.prototype.init=function(){this.raycaster=new a.ec,this.raycaster.params.Line&&(this.raycaster.params.Line.threshold=.01)},t.prototype.dispose=function(){this._hitCache.length=0,this.meshes={}},t.prototype.cast=function(t,e,n){if(t&&e&&(this.prevRay.copy(this.raycaster.ray),this.raycaster.set(t,e)),this.prevRay.equals(this.raycaster.ray))return this._hitCache;if(this.raycaster.layers.mask=this.camera.layers.mask,this._hitCache.length=0,this.octree){var r=this.getRaycastFilter(i.OctreeMeshes,n),o=this.octree.pick(this.raycaster,r);o&&this._hitCache.push(o)}var a=this.getRaycastFilter(i.DynamicMeshes,n);for(var s in this.meshes){var c=this.meshes[s];if(a(c)){var u=this.raycaster.intersectObject(c,!0);this._hitCache=this._hitCache.concat(u)}}return this._hitCache.sort(this.sortIntersectionsByDistance),this.prevRay.copy(this.raycaster.ray),this._hitCache},t.prototype.pick=function(t,e,n){this.raycaster.set(t,e);var r=this.getRaycastFilter(i.OctreeMeshes,n);return this.octree.pick(this.raycaster,r)},t.prototype.setupOctree=function(t){var e,n;this.octree=new x(t.boundingBox,.5,200);try{for(var r=T(Object.keys(this.meshes)),i=r.next();!i.done;i=r.next()){var o=i.value;if(this.octreeEnabledMeshes[o]){var a=this.meshes[o];this.octree.addMeshes(a)}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return this.octree},t.prototype.getRaycastFilter=function(t,e){var n=this,r=e||this.defaultRaycastFilter;return function(e){return function(e){var r=n.octreeEnabledMeshes[e.id];switch(t){case i.DynamicMeshes:return!r;case i.OctreeMeshes:return r}}(e)&&r(e)}},t.prototype.sortIntersectionsByDistance=function(t,e){return t.distance>e.distance?1:t.distance<e.distance?-1:0},t.prototype.render=function(){},t.prototype.activate=function(){},t.prototype.deactivate=function(){},t}());!function(t){t[t.OctreeMeshes=0]="OctreeMeshes",t[t.DynamicMeshes=1]="DynamicMeshes"}(i||(i={}));var E,P=n(109),O=n(143),A=n(2),D=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),R=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},C=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},I=new A.a("surface-edge-finder"),k=new a.xc,L=["a","b","c"],N=function(t){function e(e,n,r,i){var o=t.call(this,e.a,e.b,e.c,e.normal)||this;return o.va=n,o.vb=r,o.vc=i,o.area=k.set(o.va.vector,o.vb.vector,o.vc.vector).getArea(),o.midpoint=k.getMidpoint(new a.Jc),o.vertices=[o.va,o.vb,o.vc],n.faces.push(o),r.faces.push(o),i.faces.push(o),o}return D(e,t),e}(a.C),j=function(t){this.vector=t,this.faces=[]},B=function(){function t(){this.area=0,this.normal=new a.Jc,this.midpoint=new a.Jc,this.faces=[],this.normalSum=new a.Jc,this.midpointSum=new a.Jc}return t.prototype.add=function(t){t.surface&&t.surface.remove(t),this.faces.push(t),this.area+=t.area,this.midpointSum.add(t.midpoint),this.normalSum.add(t.normal),this.recalcFromSums(),t.surface=this},t.prototype.remove=function(t){t.surface&&(this.faces.splice(this.faces.indexOf(t),1),this.area-=t.area,this.midpointSum.sub(t.midpoint),this.normalSum.sub(t.normal),this.recalcFromSums()),t.surface=null},t.prototype.recalcFromSums=function(){this.normal.copy(this.normalSum).normalize(),this.midpoint.copy(this.midpointSum).divideScalar(this.faces.length)},t.prototype.mergeSurfaces=function(t){var e,n;try{for(var r=C(t.faces),i=r.next();!i.done;i=r.next()){var o=i.value;o.surface=this,this.faces.push(o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}this.area+=t.area,this.normalSum.add(t.normalSum),this.midpointSum.add(t.midpointSum),this.recalcFromSums(),t.faces=[],t.area=0,t.normal.set(0,0,0),t.normalSum.set(0,0,0),t.midpointSum.set(0,0,0),t.midpoint.set(0,0,0)},t.prototype.getEdges=function(){var t,e,n,r,i={},o={};try{for(var a=C(this.faces),s=a.next();!s.done;s=a.next())for(var c=s.value,u=0;u<3;u++){var l=c[L[u]],h=c[L[(u+1)%3]],f=Math.min(l,h)+","+Math.max(l,h);if(void 0===i[f]){var p={edge1:l,edge2:h,isEdge:!0};i[f]=p}else i[f].isEdge=!1}}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}try{for(var d=C(Object.values(i)),y=d.next();!y.done;y=d.next()){var m=y.value;l=m.edge1,h=m.edge2;m.isEdge&&(o[l]||(o[l]=[]),o[l].push(h),o[h]||(o[h]=[]),o[h].push(l))}}catch(t){n={error:t}}finally{try{y&&!y.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}return o},t.prototype.getCircularPaths=function(t){for(var e,n,r,i=this.getEdges(),o=new Set,a=[],s=Object.keys(i).map((function(t){return parseInt(t,10)}));r=s.pop();){for(var c=[];r;){c.push(t[r]);var u=void 0,l=0;try{for(var h=C(i[r]),f=h.next();!f.done;f=h.next()){var p=f.value,d=Math.min(r,p)+","+Math.max(r,p);if(!o.has(d)){var y=t[r].vector.distanceToSquared(this.midpoint);(void 0===u||y>l)&&(u=p,l=y)}}}catch(t){e={error:t}}finally{try{f&&!f.done&&(n=h.return)&&n.call(h)}finally{if(e)throw e.error}}if(!u)break;d=Math.min(r,u)+","+Math.max(r,u);o.add(d),r=u}c.length>2&&a.push(c)}return a},t}(),F=function(){function t(t,e){this.roomIndex=t,this.floorIndex=e,this.surfaces=new Set,this.lines=[],this.points=[]}return t.prototype.run=function(t,e,n,r,i){var o,a,c,u,l,h,f,p,d,y,m,v,g,b,w,_,x,S,T,M,E,P,A,D,k,L,F,U,z,G,H,V,W,q,Y,J,X,K,Q,Z,$,tt,et,nt,rt,it,ot,at;return void 0===e&&(e=[1,5,10]),void 0===n&&(n=.2),void 0===r&&(r=.01),void 0===i&&(i=20),R(this,(function(R){switch(R.label){case 0:g=t.vertices.map((function(t){return new j(t)})),b=[],R.label=1;case 1:R.trys.push([1,6,7,8]),w=C(t.faces),_=w.next(),R.label=2;case 2:return _.done?[3,5]:(D=_.value,b.push(new N(D,g[D.a],g[D.b],g[D.c])),[4]);case 3:R.sent(),R.label=4;case 4:return _=w.next(),[3,2];case 5:return[3,8];case 6:return x=R.sent(),o={error:x},[3,8];case 7:try{_&&!_.done&&(a=w.return)&&a.call(w)}finally{if(o)throw o.error}return[7];case 8:for(tt=0,rt=b.length;tt<rt;tt++)D=b[tt],(z=new B).add(D);R.label=9;case 9:R.trys.push([9,14,15,16]),S=C(e),T=S.next(),R.label=10;case 10:return T.done?[3,13]:(M=T.value,[5,C(this.mergeSurfacesByNormal(b,M))]);case 11:R.sent(),R.label=12;case 12:return T=S.next(),[3,10];case 13:return[3,16];case 14:return E=R.sent(),c={error:E},[3,16];case 15:try{T&&!T.done&&(u=S.return)&&u.call(S)}finally{if(c)throw c.error}return[7];case 16:try{for(P=C(b),A=P.next();!A.done;A=P.next())D=A.value,this.surfaces.add(D.surface)}catch(t){l={error:t}}finally{try{A&&!A.done&&(h=P.return)&&h.call(P)}finally{if(l)throw l.error}}k=0,L=[],R.label=17;case 17:R.trys.push([17,22,23,24]),F=C(this.surfaces),U=F.next(),R.label=18;case 18:if(U.done)return[3,21];if((z=U.value).area<=n)return[3,20];G=z.getCircularPaths(g);try{for(H=C(G),V=H.next();!V.done;V=H.next())$=V.value,this.cullPath($,(function(t,e){if(t.length()<r||e.length()<r)return k++,!1;var n=t.angleTo(e)*s.c;return!(n<i||n>180-i)||(k++,!1)})),$.length>2&&L.push($)}catch(t){d={error:t}}finally{try{V&&!V.done&&(y=H.return)&&y.call(H)}finally{if(d)throw d.error}}return[4];case 19:R.sent(),R.label=20;case 20:return U=F.next(),[3,18];case 21:return[3,24];case 22:return W=R.sent(),f={error:W},[3,24];case 23:try{U&&!U.done&&(p=F.return)&&p.call(F)}finally{if(f)throw f.error}return[7];case 24:I.debug("Culled "+k+" path points"),q=new Set,Y=new Set,J=function(t){return t.x.toFixed(3)+","+t.y.toFixed(3)+","+t.z.toFixed(3)},X=function(t){return J(t.start)+":"+J(t.end)},K=function(t){return J(t.end)+":"+J(t.start)};try{for(Q=C(L),Z=Q.next();!Z.done;Z=Q.next())for($=Z.value,tt=0;tt<$.length;tt++)et=$[tt].vector,nt=$[(tt+1)%$.length].vector,rt=new O.a(et,nt,this.roomIndex,this.floorIndex),it=X(rt),ot=K(rt),at=J(et),Y.has(it)||Y.has(ot)||(Y.add(it),Y.add(ot),this.lines.push(rt)),q.has(at)||(q.add(at),this.points.push(new O.b(et,this.roomIndex,this.floorIndex)))}catch(t){m={error:t}}finally{try{Z&&!Z.done&&(v=Q.return)&&v.call(Q)}finally{if(m)throw m.error}}return[4];case 25:return R.sent(),[2]}}))},t.prototype.cullPath=function(t,e){for(var n=new a.Jc,r=new a.Jc,i=!0;i;){i=!1;for(var o=0;o<t.length&&t.length>2;o++){var s=t[0===o?t.length-1:o-1].vector,c=t[o].vector,u=t[(o+1)%t.length].vector;n.copy(s).sub(c),r.copy(u).sub(c),e(n,r)||(t.splice(o,1),i=!0,o--)}}},t.prototype.mergeSurfacesByNormal=function(t,e,n){var r,i,o,s,c,u,l,h,f,p,d,y,m,v,g,b,w,_,x,S,T;return void 0===n&&(n=5),R(this,(function(M){switch(M.label){case 0:l=-1,h=0,M.label=1;case 1:if(!(0!==l&&h++<n))return[3,11];I.debug("Merging surfaces by normal angle threshold: "+e),f=Math.cos(a.ib.DEG2RAD*e),l=0,p=0,M.label=2;case 2:M.trys.push([2,8,9,10]),d=C(t),y=d.next(),M.label=3;case 3:return y.done?[3,7]:(m=y.value,p++%1e3!=0?[3,5]:[4]);case 4:M.sent(),M.label=5;case 5:try{for(v=C(m.vertices),g=v.next();!g.done;g=v.next()){b=g.value;try{for(w=C(b.faces),_=w.next();!_.done;_=w.next())x=_.value,S=x.surface,m.surface!==S&&m.surface.normal.dot(S.normal)>=f&&(m.surface.faces.length>S.faces.length?m.surface.mergeSurfaces(S):S.mergeSurfaces(m.surface),l++)}catch(t){c={error:t}}finally{try{_&&!_.done&&(u=w.return)&&u.call(w)}finally{if(c)throw c.error}}}}catch(t){o={error:t}}finally{try{g&&!g.done&&(s=v.return)&&s.call(v)}finally{if(o)throw o.error}}M.label=6;case 6:return y=d.next(),[3,3];case 7:return[3,10];case 8:return T=M.sent(),r={error:T},[3,10];case 9:try{y&&!y.done&&(i=d.return)&&i.call(d)}finally{if(r)throw r.error}return[7];case 10:return l&&I.debug("Merged "+l+" surfaces by normal..."),[3,1];case 11:return[2]}}))},t}(),U=n(56),z=n(25),G=n(353),H=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},V=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},W=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},q=new A.a("snapcaster");!function(t){t[t.UNINITIALIZED=0]="UNINITIALIZED",t[t.WORKING=1]="WORKING",t[t.READY=2]="READY"}(E||(E={}));var Y,J=function(){function t(t){var e=this;this.cameraData=t,this.edgeFinders=[],this.raycaster=new a.ec,this.modelRaycaster=new a.ec,this.status=E.UNINITIALIZED,this.cast=function(t,n,r,i){var o;r&&i&&(o=(new a.Hb).setFromNormalAndCoplanarPoint(i,r)),e.raycaster.set(t.origin,t.direction);var s=e.snappingOctree.raycast(e.raycaster,n)||[],c=function(t){var e=(1+t.distance)*Math.pow(1+t.distanceToRay,2);return(t.object instanceof O.b||t.object instanceof a.Jc)&&(e/=10),o&&o.distanceToPoint(t.point)<-.2&&(e+=10),e};return s.sort((function(t,e){return c(t)-c(e)})),s},this.pick=function(t,n,r,i,o){var a,s;r||(r=e.cast(t,n,i,o));var c=null;try{for(var u=W(r),l=u.next();!l.done;l=u.next()){var h=l.value;if(e.modelRaycaster.ray.origin.copy(t.origin),e.modelRaycaster.ray.direction.copy(h.point).sub(t.origin).normalize(),e.modelRaycaster.far=h.distance-.05,!e.modelOctree.pick(e.modelRaycaster,(function(t){return t.visible}))){c=h;break}}}catch(t){a={error:t}}finally{try{l&&!l.done&&(s=u.return)&&s.call(u)}finally{if(a)throw a.error}}return c?{isLineOctreeIntersection:!0,distance:c.distance,distanceToRay:c.distanceToRay,point:c.point,object:c.object}:null},this.add=function(){for(var t,n,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];try{for(var o=W(r),a=o.next();!a.done;a=o.next()){var s=a.value;e.snappingOctree.add(s)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}},this.remove=function(){for(var t,n,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];try{for(var o=W(r),a=o.next();!a.done;a=o.next()){var s=a.value;e.snappingOctree.add(s)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}}}return t.prototype.render=function(){},t.prototype.init=function(){},t.prototype.dispose=function(){},t.prototype.deactivate=function(t){},t.prototype.activate=function(t){return H(this,void 0,void 0,(function(){var e,n,r,i,o=this;return V(this,(function(s){switch(s.label){case 0:return this.engine=t,[4,t.getModule(U.default)];case 1:return e=s.sent(),[4,t.getModule(z.default)];case 2:return n=s.sent().getScene().scene,e.registerButton("Snapping","Visualize Snapping",(function(){if(r)return n.remove(r),void(r=null);r=new a.zb,n.add(r);var t=new a.oc(.02,5,5),e=new a.mb({color:65280});o.snappingOctree.traverse((function(n){if(n instanceof O.a){var i=(new a.I).setFromPoints([n.start,n.end]),o=.2+.8*Math.random(),s=.2+.8*Math.random(),c=.2+.8*Math.random(),u=new a.T(i,new a.V({color:16711680*o+65280*s+255*c}));r.add(u)}else if(n instanceof O.b){(u=new a.lb(t,e)).position.copy(n),r.add(u)}}))})),e.registerButton("Snapping","Visualize Snap Surfaces",(function(){var t,e,r,s,c,u;if(i)return n.remove(i),void(i=null);var l=new a.m,h=[],f=[];try{for(var p=W(o.edgeFinders),d=p.next();!d.done;d=p.next()){var y=d.value;try{for(var m=W(y.surfaces),v=m.next();!v.done;v=m.next()){var g=v.value,b=g.area>.1,w=Math.random(),_=b?0:.2+.8*w,x=b?.2+.8*w:0;try{for(var S=W(g.faces),T=S.next();!T.done;T=S.next()){var M=T.value,E=M.va.vector,P=M.vb.vector,O=M.vc.vector;h.push(E.x,E.y,E.z),h.push(P.x,P.y,P.z),h.push(O.x,O.y,O.z),f.push(_,x,0,_,x,0,_,x,0)}}catch(t){c={error:t}}finally{try{T&&!T.done&&(u=S.return)&&u.call(S)}finally{if(c)throw c.error}}}}catch(t){r={error:t}}finally{try{v&&!v.done&&(s=m.return)&&s.call(m)}finally{if(r)throw r.error}}}}catch(e){t={error:e}}finally{try{d&&!d.done&&(e=p.return)&&e.call(p)}finally{if(t)throw t.error}}l.setAttribute("position",new a.E(h,3)),l.setAttribute("color",new a.E(f,3)),i=new a.lb(l,new a.mb({vertexColors:!0})),n.add(i)})),[2]}}))}))},Object.defineProperty(t.prototype,"snappingOctree",{get:function(){return this.status===E.UNINITIALIZED&&this.preloadMeshSnapping(),this._snappingOctree},enumerable:!0,configurable:!0}),t.prototype.setupOctree=function(t,e){this.modelOctree=e,this.modelMesh=t,this.modelRaycaster.layers.mask=t.layers.mask,this._snappingOctree=new O.c(this.modelMesh.boundingBox)},t.prototype.preloadMeshSnapping=function(){return H(this,void 0,void 0,(function(){var t;return V(this,(function(e){switch(e.label){case 0:return this.status!==E.UNINITIALIZED?[3,3]:(this.status=E.WORKING,t=this,[4,this.engine.commandBinder.issueCommand(new G.a("snapping",this.buildSnappingForModel(),6e4))]);case 1:return t.populateProcess=e.sent(),[4,this.populateProcess.promise];case 2:e.sent(),this.status=E.READY,this.populateProcess=null,e.label=3;case 3:return[2]}}))}))},t.prototype.buildSnappingForModel=function(){var t,e,n,r,i,o,s,c,u,l,h,f,p,d,y=this;return V(this,(function(m){switch(m.label){case 0:i=[];try{for(o=W(this.modelMesh.floorMeshes),s=o.next();!s.done;s=o.next()){c=s.value;try{for(u=W(c.roomMeshes),l=u.next();!l.done;l=u.next())p=l.value,i.push({room:p,distanceToCamera:1/0})}catch(t){n={error:t}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}h=new a.Jc,f=function(){i.forEach((function(t){return t.distanceToCamera=t.room.boundingBox.getCenter(h).distanceTo(y.cameraData.pose.position)})),i.sort((function(t,e){return e.distanceToCamera-t.distanceToCamera}))},m.label=1;case 1:return i.length?(f(),p=i.pop().room,d=(new a.I).fromBufferGeometry(p.geometry),[5,W(this.buildSnappingForGeometry(d,p.roomIndex,p.floorIndex))]):[3,4];case 2:return m.sent(),[4];case 3:return m.sent(),[3,1];case 4:return q.info("Snapping found "+this._snappingOctree.pointCount+" points and "+this._snappingOctree.lineCount+" lines"),[2]}}))},t.prototype.buildSnappingForGeometry=function(t,e,n){var r,i,o,a,s,c,u,l,h,f,p;return V(this,(function(d){switch(d.label){case 0:return t.computeFaceNormals(),[4];case 1:return d.sent(),s=new F(e,n),[5,W(s.run(t))];case 2:d.sent(),q.debug("Room done, added "+s.points.length+" points and "+s.lines.length+" lines");try{for(c=W(s.points),u=c.next();!u.done;u=c.next())l=u.value,this._snappingOctree.add(l)}catch(t){r={error:t}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}try{for(h=W(s.lines),f=h.next();!f.done;f=h.next())p=f.value,this._snappingOctree.add(p)}catch(t){o={error:t}}finally{try{f&&!f.done&&(a=h.return)&&a.call(h)}finally{if(o)throw o.error}}return this.edgeFinders.push(s),[2]}}))},t}(),X=n(65),K=function(){function t(t,e){var n=this;this.raycaster=t,this.cameraData=e,this.lastHits=[],this.lastRay=new a.dc(new a.Jc(1,1,1),new a.Jc(0,1,0)),this.currentRay=new a.dc,this.pointer=new a.Ic(-2,-2),this.origin=new a.Jc,this.direction=new a.Jc,this.cast=function(){var t=n.pointerRay;return n.lastRay.equals(t)?n.lastHits:(n.lastHits=n.raycaster.cast(t.origin,t.direction).slice(),n.lastRay.copy(t),n.lastHits)},this.updatePointer=function(t){n.pointer.distanceToSquared(t)>2e-5&&n.pointer.set(t.x,t.y)}}return Object.defineProperty(t.prototype,"pointerRay",{get:function(){var t=this.updateDirections(),e=t.origin,n=t.direction;return this.currentRay.set(e,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ndcPosition",{get:function(){return this.pointer},enumerable:!0,configurable:!0}),t.prototype.updateDirections=function(){return Object(X.e)(this.cameraData,this.origin.set(this.pointer.x,this.pointer.y,-1),this.origin),Object(X.e)(this.cameraData,this.direction.set(this.pointer.x,this.pointer.y,1),this.direction),this.direction.sub(this.origin).normalize(),{origin:this.origin,direction:this.direction}},t}(),Q=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},Z=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Q(arguments[e]));return t},$=function(){function t(t,e,n){this.raycaster=t,this.data=e,this.cameraData=n,this.cache={normal4:new a.Kc,normal:new a.Jc,rotationMatrix:new a.jb,ndc3:new a.Jc}}return t.prototype.beforeRender=function(){var t;if(!this.raycaster.pointer.pointerRay.equals(this.data.pointerRay)){this.data.pointerRay.copy(this.raycaster.pointer.pointerRay),this.data.pointerOrigin.copy(this.data.pointerRay.origin),this.data.pointerDirection.copy(this.data.pointerRay.direction),this.data.hits.length=0;var e=this.raycaster.pointer.cast();if((t=this.data.hits).push.apply(t,Z(e)),this.data.pointerNdcPosition.copy(this.raycaster.pointer.ndcPosition),this.cache.ndc3.set(this.data.pointerNdcPosition.x,this.data.pointerNdcPosition.y,.5),this.data.pointerScreenPosition.copy(Object(X.a)(this.cameraData.width,this.cameraData.height,this.cache.ndc3)),e.length>0){var n=e[0];if(n&&n.face){var r=n.face.normal;this.cache.normal4.set(r.x,r.y,r.z,0),this.cache.rotationMatrix.extractRotation(n.object.matrixWorld),this.cache.normal4.applyMatrix4(this.cache.rotationMatrix),this.cache.normal.set(this.cache.normal4.x,this.cache.normal4.y,this.cache.normal4.z),this.data.hit=new P.a(n.point.clone(),this.cache.normal.clone(),n.object,n)}}else this.data.hit=null;this.data.commit()}},t.prototype.init=function(){},t.prototype.render=function(){},t.prototype.dispose=function(){},t.prototype.activate=function(){},t.prototype.deactivate=function(){},t}(),tt=n(18),et=n(309),nt=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},rt=new A.a("raycaster-debug"),it=function(t,e,n){Promise.all([t.getModule(U.default)]).then((function(t){var r=nt(t,1)[0],i=[],o=!1,a=function(){i&&i.forEach((function(t){t.geometry.dispose(),t.material.dispose(),n.remove(t)}))},s=function(t,r,o){rt.info("draw",{from:t,to:r,faces:o});var a=e.getOctree().getDebugBoundsMesh(Object(et.a)().getHex(),t,r,o);a.frustumCulled=!1,a.updateMatrixWorld(!0),n.add(a),i.push(a)};r.registerMenuButton({header:"Raycaster",buttonName:"Add Octree Level Buttons",callback:function(){if(!o){for(var t=function(t){r.registerMenuButton({header:"Octree Levels",buttonName:"Anything on Level: "+t,callback:function(){a(),s(t,t,!1)}})},n=0;n<=e.getOctree().depth;n++)t(n);var i=function(t){r.registerMenuButton({header:"Octree Faces",buttonName:"Faces on Level: "+t,callback:function(){a(),s(t,t,!0)}})};for(n=0;n<=e.getOctree().depth;n++)i(n);o=!0}}}),r.registerMenuButton({header:"Raycaster",buttonName:"Visualize Octree - All",callback:function(){a();for(var t=0;t<=e.getOctree().depth;t++)s(t,t,!1)}}),r.registerMenuButton({header:"Raycaster",buttonName:"Visualize Octree - Faces",callback:function(){a();for(var t=0;t<=e.getOctree().depth;t++)s(t,t,!0)}}),r.registerMenuButton({header:"Raycaster",buttonName:"Clear Octree Visuals",callback:a})}))},ot=n(571),at=n(134),st=n(3),ct=new ot.a;!function(t){t.normal="normal",t.hitClass="hitClass",t.hitBounds="hitBounds"}(Y||(Y={}));var ut=function(){function t(t,e){var n=this;this.engine=t,this.showClass=!0,this.showName=!0,this.showNormal=!0,this.showBounds=!1,t.getModule(U.default).then((function(r){ct.addToScene(t);var i=!1,o=e.onChanged((function(){return n.update(e)}));o.cancel();r.registerMenuButton({header:"Raycaster",buttonName:"HIT: Visualize",callback:function(){return i?(o.cancel(),ct.toggleAll(!1)):o.renew(),void(i=!i)}}),r.registerMenuButton({header:"Raycaster",buttonName:"HIT: Class",callback:function(){return n.showClass=!n.showClass}}),r.registerMenuButton({header:"Raycaster",buttonName:"HIT: Name",callback:function(){return n.showName=!n.showName}}),r.registerMenuButton({header:"Raycaster",buttonName:"HIT: Normal",callback:function(){return n.showNormal=!n.showNormal}}),r.registerMenuButton({header:"Raycaster",buttonName:"HIT: Bounds",callback:function(){return n.showBounds=!n.showBounds}})}))}return t.prototype.update=function(t){var e=this.engine.market.tryGetData(tt.a);this.showNormal&&ht(t.hit),this.showBounds&&dt(t.hit),ft(t.hit,e,this.showClass,this.showName)},t}(),lt={v1:new a.Jc,v2:new a.Jc,quat:new a.Pb},ht=function(t){var e=ct.line(Y.normal,"red",4);t&&e.updatePositions(t.point,lt.v1.copy(t.point).addScaledVector(t.normal,.2)),e.toggle(null!==t)},ft=function(t,e,n,r){var i=ct.label(Y.hitClass,"X",lt.v1,1);if(i.visible=!1,t&&e&&(n||r)){var o=e.pose,a=o.position,c=o.rotation,u=t.point,l=t.object,h=n?l.__proto__.constructor.name:"",f=r?""!==l.name?l.name:l.id:"";i.text=h+" - "+f,i.setPosition(u,(function(t){return e.isOrtho()?t.addScaledVector(st.b.UP,10):Object(s.q)(a,t,.5,t)})),i.scaleBillboard(a,c,e.pose.projection,e.height,e.aspect(),e.zoom(),.05),i.setOrientation(c),i.visible=!0}},pt={color:"yellow"},dt=function(t){var e=ct.boxWire(Y.hitBounds,pt).toggle(!1);if(t&&t.object&&!(t.object instanceof at.a)&&t.object instanceof a.lb){var n=Object(c.a)(t.object.geometry),r=n.getCenter(lt.v1).applyMatrix4(t.object.matrixWorld),i=n.getSize(lt.v2).multiply(t.object.scale).multiplyScalar(.5);e.mesh.quaternion.copy(t.object.quaternion),e.toggle(!0).update(r,i)}},yt=n(113),mt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),vt=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},gt=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},bt=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},wt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="raycaster",e.raycasterPointerData=new P.b,e.overridePointer=null,e.setOverridePointer=function(t){e.overridePointer=t},e}return mt(e,t),e.prototype.init=function(t,e){return vt(this,void 0,void 0,(function(){var t,n,r,i,o;return gt(this,(function(a){switch(a.label){case 0:return e.market.register(this,P.b,this.raycasterPointerData),[4,Promise.all([e.getModule(z.default),e.market.waitForData(tt.a)])];case 1:return t=bt.apply(void 0,[a.sent(),2]),n=t[0],r=t[1],i=n.getCamera(),this.raycaster=new M(i,yt.a),e.addComponent(this,this.raycaster),this.defaultPointer=new K(this.raycaster,r),this.snapcaster=new J(r),e.addComponent(this,this.snapcaster),o=new $(this,this.raycasterPointerData,r),e.addComponent(this,o),new it(e,this.raycaster,n.getScene()),new ut(e,this.raycasterPointerData),[2]}}))}))},e.prototype.dispose=function(){},e.prototype.setupOctree=function(t){var e=this.raycaster.setupOctree(t);this.snapcaster.setupOctree(t,e)},Object.defineProperty(e.prototype,"pointer",{get:function(){return null!==this.overridePointer?this.overridePointer:this.defaultPointer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"targets",{get:function(){return this.raycaster},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"picking",{get:function(){return this.raycaster},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"snapping",{get:function(){return this.snapcaster},enumerable:!0,configurable:!0}),e}(o.a);e.default=wt},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i,o;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.LOW=0]="LOW",t[t.MEDIUM=1]="MEDIUM",t[t.HIGH=2]="HIGH",t[t.HIGHEST=3]="HIGHEST"}(i=e.RequestPriority||(e.RequestPriority={})),function(t){t[t.PENDING=0]="PENDING",t[t.SENDING=1]="SENDING",t[t.FAILED=2]="FAILED",t[t.DONE=3]="DONE"}(o=e.RequestStatus||(e.RequestStatus={}));var a=function(){function t(t){var e=void 0===t?{}:t,n=e.retries,r=void 0===n?3:n,i=e.concurrency,o=void 0===i?6:i;this.queue=[],this.retries=r,this.concurrency=o}return t.prototype.get=function(t,e){return this.request("GET",t,e)},t.prototype.head=function(t,e){return this.request("HEAD",t,e)},t.prototype.options=function(t,e){return this.request("OPTIONS",t,e)},t.prototype.post=function(t,e){return this.request("POST",t,e)},t.prototype.put=function(t,e){return this.request("PUT",t,e)},t.prototype.patch=function(t,e){return this.request("PATCH",t,e)},t.prototype.delete=function(t,e){return this.request("DELETE",t,e)},t.prototype.request=function(t,e,n){var r=new s(t,e,n);return this.enqueue(r),r.promise},t.prototype.update=function(){for(var t;t=this.getNextPendingRequest();)this.sendRequest(t);for(;t=this.getNextOverflowingRequest();)t.abort(),t.status=o.PENDING;this.updateTimeout=null},t.prototype.enqueue=function(t){var e=this,n=0;for(n=0;n<this.queue.length;n++){if(this.queue[n].priority<t.priority)break}this.queue.splice(n,0,t),this.updateTimeout||(this.updateTimeout=window.setTimeout((function(){e.update()}),1))},t.prototype.dequeue=function(t){var e=this.queue.indexOf(t);if(-1===e)throw new Error("Can't dequeue request not in queue");this.queue.splice(e,1),this.update()},t.prototype.getNextPendingRequest=function(){for(var t=0;t<this.queue.length&&t<this.concurrency;t++){var e=this.queue[t];if(e.status===o.PENDING)return e}return null},t.prototype.getNextOverflowingRequest=function(){for(var t=this.concurrency;t<this.queue.length;t++){var e=this.queue[t];if(e.status===o.SENDING&&e.priority!==i.HIGHEST)return e}return null},t.prototype.sendRequest=function(t){var e=this;t.status=o.SENDING,t.send().then((function(n){t.status=o.DONE,e.dequeue(t),t.onDone(n)})).catch((function(n){var r=null!==t.maxRetries?t.maxRetries:e.retries;t.sendAttempts<r?(t.status=o.PENDING,e.update(),console.warn("Retried "+t.url),console.warn(n)):(t.status=o.FAILED,e.dequeue(t),console.warn("Failed "+t.url),t.onFail(n))}))},t}();e.RequestQueue=a;var s=function(){function t(t,e,n){void 0===n&&(n={});var r=this;this.sendAttempts=0,this.status=o.PENDING,this.url=e,this.method=t,this.auth=n.auth||null,this.withCredentials=n.withCredentials||!1,this.priority=n.priority||i.MEDIUM,this.responseType=n.responseType||null,this.body=n.body||null,this.headers=n.headers||{},this.maxRetries=n.maxRetries||null,this.onProgress=n.onProgress,this.promise=new Promise((function(t,e){r.onDone=t,r.onFail=e}))}return t.prototype.send=function(){var t=this,e=this.xhr=function(t,e,n){var r;if("undefined"!=typeof XMLHttpRequest)(r=new XMLHttpRequest).withCredentials=n;else{if("undefined"==typeof XDomainRequest)throw new Error("No XMLHTTPRequest or XDomainRequest... are you trying to run me in node? :(");r=new XDomainRequest}return r.open(t,e,!0),r}(this.method,this.url,this.withCredentials);if(this.responseType)if("arraybuffer"===this.responseType||"text"===this.responseType||"json"===this.responseType||"blob"===this.responseType)e.responseType=this.responseType;else{if("image"!==this.responseType)throw new Error('reponseType can only be one of "arraybuffer", "text", "json", "blob", "image"');e.responseType="blob"}for(var n in"json"===this.responseType&&e.setRequestHeader("Accept","application/json"),this.auth&&"string"==typeof this.auth&&e.setRequestHeader("Authorization",this.auth),this.headers)e.setRequestHeader(n,this.headers[n]);return this.body&&"object"===r(this.body)&&(this.body instanceof FormData||(this.body=JSON.stringify(this.body),e.setRequestHeader("Content-Type","application/json"))),this.onProgress&&(e.onprogress=this.onProgress),new Promise((function(n,r){e.onreadystatechange=function(i){if(4===e.readyState){if(200===e.status||201===e.status||204===e.status)return t.parseResponse(t.xhr).then((function(t){n(t)}));0!==e.status&&r({status_code:e.status})}},e.onerror=function(t){r(t)},e.send(t.body),t.sendAttempts++}))},t.prototype.parseResponse=function(t){var e=this;return new Promise((function(n,i){try{var o=t.response;if("json"===e.responseType&&"object"!==r(o))n(JSON.parse(t.responseText));else if("image"===e.responseType){var a=URL.createObjectURL(o);(o=new Image).src=a,o.crossOrigin="Anonymous",o.onload=function(){URL.revokeObjectURL(a),n(o)}}else n(o)}catch(t){i({error:"Payload was not valid JSON"})}}))},t.prototype.abort=function(){if(null===this.xhr)throw new Error("Cannot abort unsent Request");this.xhr.abort()},t}();e.Request=s},function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i})),e.c=Object.freeze({mattertags:{visibility:{alphaTestLevel:.05},disc:{scale:{nearBound:1.5,farBound:4.8,maxSize:80,minSize:40,baseViewportSize:800,responsiveness:100}},pole:{height:.5,width:2,opacity:.5,color:"white"}}});var r="features/mattertags",i="embedlyKey"},function(t,e,n){"use strict";var r;!function(t){t[t.GL_TEXTURE_CUBE_MAP_POSITIVE_X=0]="GL_TEXTURE_CUBE_MAP_POSITIVE_X",t[t.GL_TEXTURE_CUBE_MAP_NEGATIVE_X=1]="GL_TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.GL_TEXTURE_CUBE_MAP_POSITIVE_Y=2]="GL_TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.GL_TEXTURE_CUBE_MAP_NEGATIVE_Y=3]="GL_TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.GL_TEXTURE_CUBE_MAP_POSITIVE_Z=4]="GL_TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.GL_TEXTURE_CUBE_MAP_NEGATIVE_Z=5]="GL_TEXTURE_CUBE_MAP_NEGATIVE_Z"}(r||(r={})),e.a=r},function(t,e,n){(function(t){function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(t,r){"use strict";function i(t,e){if(!t)throw new Error(e||"Assertion failed")}function o(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}function a(t,e,n){if(a.isBN(t))return t;this.negative=0,this.words=null,this.length=0,this.red=null,null!==t&&("le"!==e&&"be"!==e||(n=e,e=10),this._init(t||0,e||10,n||"be"))}var s;"object"===e(t)?t.exports=a:r.BN=a,a.BN=a,a.wordSize=26;try{s=n(744).Buffer}catch(t){}function c(t,e,n){for(var r=0,i=Math.min(t.length,n),o=e;o<i;o++){var a=t.charCodeAt(o)-48;r<<=4,r|=a>=49&&a<=54?a-49+10:a>=17&&a<=22?a-17+10:15&a}return r}function u(t,e,n,r){for(var i=0,o=Math.min(t.length,n),a=e;a<o;a++){var s=t.charCodeAt(a)-48;i*=r,i+=s>=49?s-49+10:s>=17?s-17+10:s}return i}a.isBN=function(t){return t instanceof a||null!==t&&"object"===e(t)&&t.constructor.wordSize===a.wordSize&&Array.isArray(t.words)},a.max=function(t,e){return t.cmp(e)>0?t:e},a.min=function(t,e){return t.cmp(e)<0?t:e},a.prototype._init=function(t,n,r){if("number"==typeof t)return this._initNumber(t,n,r);if("object"===e(t))return this._initArray(t,n,r);"hex"===n&&(n=16),i(n===(0|n)&&n>=2&&n<=36);var o=0;"-"===(t=t.toString().replace(/\s+/g,""))[0]&&o++,16===n?this._parseHex(t,o):this._parseBase(t,n,o),"-"===t[0]&&(this.negative=1),this.strip(),"le"===r&&this._initArray(this.toArray(),n,r)},a.prototype._initNumber=function(t,e,n){t<0&&(this.negative=1,t=-t),t<67108864?(this.words=[67108863&t],this.length=1):t<4503599627370496?(this.words=[67108863&t,t/67108864&67108863],this.length=2):(i(t<9007199254740992),this.words=[67108863&t,t/67108864&67108863,1],this.length=3),"le"===n&&this._initArray(this.toArray(),e,n)},a.prototype._initArray=function(t,e,n){if(i("number"==typeof t.length),t.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(t.length/3),this.words=new Array(this.length);for(var r=0;r<this.length;r++)this.words[r]=0;var o,a,s=0;if("be"===n)for(r=t.length-1,o=0;r>=0;r-=3)a=t[r]|t[r-1]<<8|t[r-2]<<16,this.words[o]|=a<<s&67108863,this.words[o+1]=a>>>26-s&67108863,(s+=24)>=26&&(s-=26,o++);else if("le"===n)for(r=0,o=0;r<t.length;r+=3)a=t[r]|t[r+1]<<8|t[r+2]<<16,this.words[o]|=a<<s&67108863,this.words[o+1]=a>>>26-s&67108863,(s+=24)>=26&&(s-=26,o++);return this.strip()},a.prototype._parseHex=function(t,e){this.length=Math.ceil((t.length-e)/6),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var r,i,o=0;for(n=t.length-6,r=0;n>=e;n-=6)i=c(t,n,n+6),this.words[r]|=i<<o&67108863,this.words[r+1]|=i>>>26-o&4194303,(o+=24)>=26&&(o-=26,r++);n+6!==e&&(i=c(t,e,n+6),this.words[r]|=i<<o&67108863,this.words[r+1]|=i>>>26-o&4194303),this.strip()},a.prototype._parseBase=function(t,e,n){this.words=[0],this.length=1;for(var r=0,i=1;i<=67108863;i*=e)r++;r--,i=i/e|0;for(var o=t.length-n,a=o%r,s=Math.min(o,o-a)+n,c=0,l=n;l<s;l+=r)c=u(t,l,l+r,e),this.imuln(i),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c);if(0!==a){var h=1;for(c=u(t,l,t.length,e),l=0;l<a;l++)h*=e;this.imuln(h),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c)}},a.prototype.copy=function(t){t.words=new Array(this.length);for(var e=0;e<this.length;e++)t.words[e]=this.words[e];t.length=this.length,t.negative=this.negative,t.red=this.red},a.prototype.clone=function(){var t=new a(null);return this.copy(t),t},a.prototype._expand=function(t){for(;this.length<t;)this.words[this.length++]=0;return this},a.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},a.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},a.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var l=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],h=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],f=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function p(t,e,n){n.negative=e.negative^t.negative;var r=t.length+e.length|0;n.length=r,r=r-1|0;var i=0|t.words[0],o=0|e.words[0],a=i*o,s=67108863&a,c=a/67108864|0;n.words[0]=s;for(var u=1;u<r;u++){for(var l=c>>>26,h=67108863&c,f=Math.min(u,e.length-1),p=Math.max(0,u-t.length+1);p<=f;p++){var d=u-p|0;l+=(a=(i=0|t.words[d])*(o=0|e.words[p])+h)/67108864|0,h=67108863&a}n.words[u]=0|h,c=0|l}return 0!==c?n.words[u]=0|c:n.length--,n.strip()}a.prototype.toString=function(t,e){var n;if(e=0|e||1,16===(t=t||10)||"hex"===t){n="";for(var r=0,o=0,a=0;a<this.length;a++){var s=this.words[a],c=(16777215&(s<<r|o)).toString(16);n=0!==(o=s>>>24-r&16777215)||a!==this.length-1?l[6-c.length]+c+n:c+n,(r+=2)>=26&&(r-=26,a--)}for(0!==o&&(n=o.toString(16)+n);n.length%e!=0;)n="0"+n;return 0!==this.negative&&(n="-"+n),n}if(t===(0|t)&&t>=2&&t<=36){var u=h[t],p=f[t];n="";var d=this.clone();for(d.negative=0;!d.isZero();){var y=d.modn(p).toString(t);n=(d=d.idivn(p)).isZero()?y+n:l[u-y.length]+y+n}for(this.isZero()&&(n="0"+n);n.length%e!=0;)n="0"+n;return 0!==this.negative&&(n="-"+n),n}i(!1,"Base should be between 2 and 36")},a.prototype.toNumber=function(){var t=this.words[0];return 2===this.length?t+=67108864*this.words[1]:3===this.length&&1===this.words[2]?t+=4503599627370496+67108864*this.words[1]:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-t:t},a.prototype.toJSON=function(){return this.toString(16)},a.prototype.toBuffer=function(t,e){return i(void 0!==s),this.toArrayLike(s,t,e)},a.prototype.toArray=function(t,e){return this.toArrayLike(Array,t,e)},a.prototype.toArrayLike=function(t,e,n){var r=this.byteLength(),o=n||Math.max(1,r);i(r<=o,"byte array longer than desired length"),i(o>0,"Requested array length <= 0"),this.strip();var a,s,c="le"===e,u=new t(o),l=this.clone();if(c){for(s=0;!l.isZero();s++)a=l.andln(255),l.iushrn(8),u[s]=a;for(;s<o;s++)u[s]=0}else{for(s=0;s<o-r;s++)u[s]=0;for(s=0;!l.isZero();s++)a=l.andln(255),l.iushrn(8),u[o-s-1]=a}return u},Math.clz32?a.prototype._countBits=function(t){return 32-Math.clz32(t)}:a.prototype._countBits=function(t){var e=t,n=0;return e>=4096&&(n+=13,e>>>=13),e>=64&&(n+=7,e>>>=7),e>=8&&(n+=4,e>>>=4),e>=2&&(n+=2,e>>>=2),n+e},a.prototype._zeroBits=function(t){if(0===t)return 26;var e=t,n=0;return 0==(8191&e)&&(n+=13,e>>>=13),0==(127&e)&&(n+=7,e>>>=7),0==(15&e)&&(n+=4,e>>>=4),0==(3&e)&&(n+=2,e>>>=2),0==(1&e)&&n++,n},a.prototype.bitLength=function(){var t=this.words[this.length-1],e=this._countBits(t);return 26*(this.length-1)+e},a.prototype.zeroBits=function(){if(this.isZero())return 0;for(var t=0,e=0;e<this.length;e++){var n=this._zeroBits(this.words[e]);if(t+=n,26!==n)break}return t},a.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},a.prototype.toTwos=function(t){return 0!==this.negative?this.abs().inotn(t).iaddn(1):this.clone()},a.prototype.fromTwos=function(t){return this.testn(t-1)?this.notn(t).iaddn(1).ineg():this.clone()},a.prototype.isNeg=function(){return 0!==this.negative},a.prototype.neg=function(){return this.clone().ineg()},a.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},a.prototype.iuor=function(t){for(;this.length<t.length;)this.words[this.length++]=0;for(var e=0;e<t.length;e++)this.words[e]=this.words[e]|t.words[e];return this.strip()},a.prototype.ior=function(t){return i(0==(this.negative|t.negative)),this.iuor(t)},a.prototype.or=function(t){return this.length>t.length?this.clone().ior(t):t.clone().ior(this)},a.prototype.uor=function(t){return this.length>t.length?this.clone().iuor(t):t.clone().iuor(this)},a.prototype.iuand=function(t){var e;e=this.length>t.length?t:this;for(var n=0;n<e.length;n++)this.words[n]=this.words[n]&t.words[n];return this.length=e.length,this.strip()},a.prototype.iand=function(t){return i(0==(this.negative|t.negative)),this.iuand(t)},a.prototype.and=function(t){return this.length>t.length?this.clone().iand(t):t.clone().iand(this)},a.prototype.uand=function(t){return this.length>t.length?this.clone().iuand(t):t.clone().iuand(this)},a.prototype.iuxor=function(t){var e,n;this.length>t.length?(e=this,n=t):(e=t,n=this);for(var r=0;r<n.length;r++)this.words[r]=e.words[r]^n.words[r];if(this!==e)for(;r<e.length;r++)this.words[r]=e.words[r];return this.length=e.length,this.strip()},a.prototype.ixor=function(t){return i(0==(this.negative|t.negative)),this.iuxor(t)},a.prototype.xor=function(t){return this.length>t.length?this.clone().ixor(t):t.clone().ixor(this)},a.prototype.uxor=function(t){return this.length>t.length?this.clone().iuxor(t):t.clone().iuxor(this)},a.prototype.inotn=function(t){i("number"==typeof t&&t>=0);var e=0|Math.ceil(t/26),n=t%26;this._expand(e),n>0&&e--;for(var r=0;r<e;r++)this.words[r]=67108863&~this.words[r];return n>0&&(this.words[r]=~this.words[r]&67108863>>26-n),this.strip()},a.prototype.notn=function(t){return this.clone().inotn(t)},a.prototype.setn=function(t,e){i("number"==typeof t&&t>=0);var n=t/26|0,r=t%26;return this._expand(n+1),this.words[n]=e?this.words[n]|1<<r:this.words[n]&~(1<<r),this.strip()},a.prototype.iadd=function(t){var e,n,r;if(0!==this.negative&&0===t.negative)return this.negative=0,e=this.isub(t),this.negative^=1,this._normSign();if(0===this.negative&&0!==t.negative)return t.negative=0,e=this.isub(t),t.negative=1,e._normSign();this.length>t.length?(n=this,r=t):(n=t,r=this);for(var i=0,o=0;o<r.length;o++)e=(0|n.words[o])+(0|r.words[o])+i,this.words[o]=67108863&e,i=e>>>26;for(;0!==i&&o<n.length;o++)e=(0|n.words[o])+i,this.words[o]=67108863&e,i=e>>>26;if(this.length=n.length,0!==i)this.words[this.length]=i,this.length++;else if(n!==this)for(;o<n.length;o++)this.words[o]=n.words[o];return this},a.prototype.add=function(t){var e;return 0!==t.negative&&0===this.negative?(t.negative=0,e=this.sub(t),t.negative^=1,e):0===t.negative&&0!==this.negative?(this.negative=0,e=t.sub(this),this.negative=1,e):this.length>t.length?this.clone().iadd(t):t.clone().iadd(this)},a.prototype.isub=function(t){if(0!==t.negative){t.negative=0;var e=this.iadd(t);return t.negative=1,e._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(t),this.negative=1,this._normSign();var n,r,i=this.cmp(t);if(0===i)return this.negative=0,this.length=1,this.words[0]=0,this;i>0?(n=this,r=t):(n=t,r=this);for(var o=0,a=0;a<r.length;a++)o=(e=(0|n.words[a])-(0|r.words[a])+o)>>26,this.words[a]=67108863&e;for(;0!==o&&a<n.length;a++)o=(e=(0|n.words[a])+o)>>26,this.words[a]=67108863&e;if(0===o&&a<n.length&&n!==this)for(;a<n.length;a++)this.words[a]=n.words[a];return this.length=Math.max(this.length,a),n!==this&&(this.negative=1),this.strip()},a.prototype.sub=function(t){return this.clone().isub(t)};var d=function(t,e,n){var r,i,o,a=t.words,s=e.words,c=n.words,u=0,l=0|a[0],h=8191&l,f=l>>>13,p=0|a[1],d=8191&p,y=p>>>13,m=0|a[2],v=8191&m,g=m>>>13,b=0|a[3],w=8191&b,_=b>>>13,x=0|a[4],S=8191&x,T=x>>>13,M=0|a[5],E=8191&M,P=M>>>13,O=0|a[6],A=8191&O,D=O>>>13,R=0|a[7],C=8191&R,I=R>>>13,k=0|a[8],L=8191&k,N=k>>>13,j=0|a[9],B=8191&j,F=j>>>13,U=0|s[0],z=8191&U,G=U>>>13,H=0|s[1],V=8191&H,W=H>>>13,q=0|s[2],Y=8191&q,J=q>>>13,X=0|s[3],K=8191&X,Q=X>>>13,Z=0|s[4],$=8191&Z,tt=Z>>>13,et=0|s[5],nt=8191&et,rt=et>>>13,it=0|s[6],ot=8191&it,at=it>>>13,st=0|s[7],ct=8191&st,ut=st>>>13,lt=0|s[8],ht=8191&lt,ft=lt>>>13,pt=0|s[9],dt=8191&pt,yt=pt>>>13;n.negative=t.negative^e.negative,n.length=19;var mt=(u+(r=Math.imul(h,z))|0)+((8191&(i=(i=Math.imul(h,G))+Math.imul(f,z)|0))<<13)|0;u=((o=Math.imul(f,G))+(i>>>13)|0)+(mt>>>26)|0,mt&=67108863,r=Math.imul(d,z),i=(i=Math.imul(d,G))+Math.imul(y,z)|0,o=Math.imul(y,G);var vt=(u+(r=r+Math.imul(h,V)|0)|0)+((8191&(i=(i=i+Math.imul(h,W)|0)+Math.imul(f,V)|0))<<13)|0;u=((o=o+Math.imul(f,W)|0)+(i>>>13)|0)+(vt>>>26)|0,vt&=67108863,r=Math.imul(v,z),i=(i=Math.imul(v,G))+Math.imul(g,z)|0,o=Math.imul(g,G),r=r+Math.imul(d,V)|0,i=(i=i+Math.imul(d,W)|0)+Math.imul(y,V)|0,o=o+Math.imul(y,W)|0;var gt=(u+(r=r+Math.imul(h,Y)|0)|0)+((8191&(i=(i=i+Math.imul(h,J)|0)+Math.imul(f,Y)|0))<<13)|0;u=((o=o+Math.imul(f,J)|0)+(i>>>13)|0)+(gt>>>26)|0,gt&=67108863,r=Math.imul(w,z),i=(i=Math.imul(w,G))+Math.imul(_,z)|0,o=Math.imul(_,G),r=r+Math.imul(v,V)|0,i=(i=i+Math.imul(v,W)|0)+Math.imul(g,V)|0,o=o+Math.imul(g,W)|0,r=r+Math.imul(d,Y)|0,i=(i=i+Math.imul(d,J)|0)+Math.imul(y,Y)|0,o=o+Math.imul(y,J)|0;var bt=(u+(r=r+Math.imul(h,K)|0)|0)+((8191&(i=(i=i+Math.imul(h,Q)|0)+Math.imul(f,K)|0))<<13)|0;u=((o=o+Math.imul(f,Q)|0)+(i>>>13)|0)+(bt>>>26)|0,bt&=67108863,r=Math.imul(S,z),i=(i=Math.imul(S,G))+Math.imul(T,z)|0,o=Math.imul(T,G),r=r+Math.imul(w,V)|0,i=(i=i+Math.imul(w,W)|0)+Math.imul(_,V)|0,o=o+Math.imul(_,W)|0,r=r+Math.imul(v,Y)|0,i=(i=i+Math.imul(v,J)|0)+Math.imul(g,Y)|0,o=o+Math.imul(g,J)|0,r=r+Math.imul(d,K)|0,i=(i=i+Math.imul(d,Q)|0)+Math.imul(y,K)|0,o=o+Math.imul(y,Q)|0;var wt=(u+(r=r+Math.imul(h,$)|0)|0)+((8191&(i=(i=i+Math.imul(h,tt)|0)+Math.imul(f,$)|0))<<13)|0;u=((o=o+Math.imul(f,tt)|0)+(i>>>13)|0)+(wt>>>26)|0,wt&=67108863,r=Math.imul(E,z),i=(i=Math.imul(E,G))+Math.imul(P,z)|0,o=Math.imul(P,G),r=r+Math.imul(S,V)|0,i=(i=i+Math.imul(S,W)|0)+Math.imul(T,V)|0,o=o+Math.imul(T,W)|0,r=r+Math.imul(w,Y)|0,i=(i=i+Math.imul(w,J)|0)+Math.imul(_,Y)|0,o=o+Math.imul(_,J)|0,r=r+Math.imul(v,K)|0,i=(i=i+Math.imul(v,Q)|0)+Math.imul(g,K)|0,o=o+Math.imul(g,Q)|0,r=r+Math.imul(d,$)|0,i=(i=i+Math.imul(d,tt)|0)+Math.imul(y,$)|0,o=o+Math.imul(y,tt)|0;var _t=(u+(r=r+Math.imul(h,nt)|0)|0)+((8191&(i=(i=i+Math.imul(h,rt)|0)+Math.imul(f,nt)|0))<<13)|0;u=((o=o+Math.imul(f,rt)|0)+(i>>>13)|0)+(_t>>>26)|0,_t&=67108863,r=Math.imul(A,z),i=(i=Math.imul(A,G))+Math.imul(D,z)|0,o=Math.imul(D,G),r=r+Math.imul(E,V)|0,i=(i=i+Math.imul(E,W)|0)+Math.imul(P,V)|0,o=o+Math.imul(P,W)|0,r=r+Math.imul(S,Y)|0,i=(i=i+Math.imul(S,J)|0)+Math.imul(T,Y)|0,o=o+Math.imul(T,J)|0,r=r+Math.imul(w,K)|0,i=(i=i+Math.imul(w,Q)|0)+Math.imul(_,K)|0,o=o+Math.imul(_,Q)|0,r=r+Math.imul(v,$)|0,i=(i=i+Math.imul(v,tt)|0)+Math.imul(g,$)|0,o=o+Math.imul(g,tt)|0,r=r+Math.imul(d,nt)|0,i=(i=i+Math.imul(d,rt)|0)+Math.imul(y,nt)|0,o=o+Math.imul(y,rt)|0;var xt=(u+(r=r+Math.imul(h,ot)|0)|0)+((8191&(i=(i=i+Math.imul(h,at)|0)+Math.imul(f,ot)|0))<<13)|0;u=((o=o+Math.imul(f,at)|0)+(i>>>13)|0)+(xt>>>26)|0,xt&=67108863,r=Math.imul(C,z),i=(i=Math.imul(C,G))+Math.imul(I,z)|0,o=Math.imul(I,G),r=r+Math.imul(A,V)|0,i=(i=i+Math.imul(A,W)|0)+Math.imul(D,V)|0,o=o+Math.imul(D,W)|0,r=r+Math.imul(E,Y)|0,i=(i=i+Math.imul(E,J)|0)+Math.imul(P,Y)|0,o=o+Math.imul(P,J)|0,r=r+Math.imul(S,K)|0,i=(i=i+Math.imul(S,Q)|0)+Math.imul(T,K)|0,o=o+Math.imul(T,Q)|0,r=r+Math.imul(w,$)|0,i=(i=i+Math.imul(w,tt)|0)+Math.imul(_,$)|0,o=o+Math.imul(_,tt)|0,r=r+Math.imul(v,nt)|0,i=(i=i+Math.imul(v,rt)|0)+Math.imul(g,nt)|0,o=o+Math.imul(g,rt)|0,r=r+Math.imul(d,ot)|0,i=(i=i+Math.imul(d,at)|0)+Math.imul(y,ot)|0,o=o+Math.imul(y,at)|0;var St=(u+(r=r+Math.imul(h,ct)|0)|0)+((8191&(i=(i=i+Math.imul(h,ut)|0)+Math.imul(f,ct)|0))<<13)|0;u=((o=o+Math.imul(f,ut)|0)+(i>>>13)|0)+(St>>>26)|0,St&=67108863,r=Math.imul(L,z),i=(i=Math.imul(L,G))+Math.imul(N,z)|0,o=Math.imul(N,G),r=r+Math.imul(C,V)|0,i=(i=i+Math.imul(C,W)|0)+Math.imul(I,V)|0,o=o+Math.imul(I,W)|0,r=r+Math.imul(A,Y)|0,i=(i=i+Math.imul(A,J)|0)+Math.imul(D,Y)|0,o=o+Math.imul(D,J)|0,r=r+Math.imul(E,K)|0,i=(i=i+Math.imul(E,Q)|0)+Math.imul(P,K)|0,o=o+Math.imul(P,Q)|0,r=r+Math.imul(S,$)|0,i=(i=i+Math.imul(S,tt)|0)+Math.imul(T,$)|0,o=o+Math.imul(T,tt)|0,r=r+Math.imul(w,nt)|0,i=(i=i+Math.imul(w,rt)|0)+Math.imul(_,nt)|0,o=o+Math.imul(_,rt)|0,r=r+Math.imul(v,ot)|0,i=(i=i+Math.imul(v,at)|0)+Math.imul(g,ot)|0,o=o+Math.imul(g,at)|0,r=r+Math.imul(d,ct)|0,i=(i=i+Math.imul(d,ut)|0)+Math.imul(y,ct)|0,o=o+Math.imul(y,ut)|0;var Tt=(u+(r=r+Math.imul(h,ht)|0)|0)+((8191&(i=(i=i+Math.imul(h,ft)|0)+Math.imul(f,ht)|0))<<13)|0;u=((o=o+Math.imul(f,ft)|0)+(i>>>13)|0)+(Tt>>>26)|0,Tt&=67108863,r=Math.imul(B,z),i=(i=Math.imul(B,G))+Math.imul(F,z)|0,o=Math.imul(F,G),r=r+Math.imul(L,V)|0,i=(i=i+Math.imul(L,W)|0)+Math.imul(N,V)|0,o=o+Math.imul(N,W)|0,r=r+Math.imul(C,Y)|0,i=(i=i+Math.imul(C,J)|0)+Math.imul(I,Y)|0,o=o+Math.imul(I,J)|0,r=r+Math.imul(A,K)|0,i=(i=i+Math.imul(A,Q)|0)+Math.imul(D,K)|0,o=o+Math.imul(D,Q)|0,r=r+Math.imul(E,$)|0,i=(i=i+Math.imul(E,tt)|0)+Math.imul(P,$)|0,o=o+Math.imul(P,tt)|0,r=r+Math.imul(S,nt)|0,i=(i=i+Math.imul(S,rt)|0)+Math.imul(T,nt)|0,o=o+Math.imul(T,rt)|0,r=r+Math.imul(w,ot)|0,i=(i=i+Math.imul(w,at)|0)+Math.imul(_,ot)|0,o=o+Math.imul(_,at)|0,r=r+Math.imul(v,ct)|0,i=(i=i+Math.imul(v,ut)|0)+Math.imul(g,ct)|0,o=o+Math.imul(g,ut)|0,r=r+Math.imul(d,ht)|0,i=(i=i+Math.imul(d,ft)|0)+Math.imul(y,ht)|0,o=o+Math.imul(y,ft)|0;var Mt=(u+(r=r+Math.imul(h,dt)|0)|0)+((8191&(i=(i=i+Math.imul(h,yt)|0)+Math.imul(f,dt)|0))<<13)|0;u=((o=o+Math.imul(f,yt)|0)+(i>>>13)|0)+(Mt>>>26)|0,Mt&=67108863,r=Math.imul(B,V),i=(i=Math.imul(B,W))+Math.imul(F,V)|0,o=Math.imul(F,W),r=r+Math.imul(L,Y)|0,i=(i=i+Math.imul(L,J)|0)+Math.imul(N,Y)|0,o=o+Math.imul(N,J)|0,r=r+Math.imul(C,K)|0,i=(i=i+Math.imul(C,Q)|0)+Math.imul(I,K)|0,o=o+Math.imul(I,Q)|0,r=r+Math.imul(A,$)|0,i=(i=i+Math.imul(A,tt)|0)+Math.imul(D,$)|0,o=o+Math.imul(D,tt)|0,r=r+Math.imul(E,nt)|0,i=(i=i+Math.imul(E,rt)|0)+Math.imul(P,nt)|0,o=o+Math.imul(P,rt)|0,r=r+Math.imul(S,ot)|0,i=(i=i+Math.imul(S,at)|0)+Math.imul(T,ot)|0,o=o+Math.imul(T,at)|0,r=r+Math.imul(w,ct)|0,i=(i=i+Math.imul(w,ut)|0)+Math.imul(_,ct)|0,o=o+Math.imul(_,ut)|0,r=r+Math.imul(v,ht)|0,i=(i=i+Math.imul(v,ft)|0)+Math.imul(g,ht)|0,o=o+Math.imul(g,ft)|0;var Et=(u+(r=r+Math.imul(d,dt)|0)|0)+((8191&(i=(i=i+Math.imul(d,yt)|0)+Math.imul(y,dt)|0))<<13)|0;u=((o=o+Math.imul(y,yt)|0)+(i>>>13)|0)+(Et>>>26)|0,Et&=67108863,r=Math.imul(B,Y),i=(i=Math.imul(B,J))+Math.imul(F,Y)|0,o=Math.imul(F,J),r=r+Math.imul(L,K)|0,i=(i=i+Math.imul(L,Q)|0)+Math.imul(N,K)|0,o=o+Math.imul(N,Q)|0,r=r+Math.imul(C,$)|0,i=(i=i+Math.imul(C,tt)|0)+Math.imul(I,$)|0,o=o+Math.imul(I,tt)|0,r=r+Math.imul(A,nt)|0,i=(i=i+Math.imul(A,rt)|0)+Math.imul(D,nt)|0,o=o+Math.imul(D,rt)|0,r=r+Math.imul(E,ot)|0,i=(i=i+Math.imul(E,at)|0)+Math.imul(P,ot)|0,o=o+Math.imul(P,at)|0,r=r+Math.imul(S,ct)|0,i=(i=i+Math.imul(S,ut)|0)+Math.imul(T,ct)|0,o=o+Math.imul(T,ut)|0,r=r+Math.imul(w,ht)|0,i=(i=i+Math.imul(w,ft)|0)+Math.imul(_,ht)|0,o=o+Math.imul(_,ft)|0;var Pt=(u+(r=r+Math.imul(v,dt)|0)|0)+((8191&(i=(i=i+Math.imul(v,yt)|0)+Math.imul(g,dt)|0))<<13)|0;u=((o=o+Math.imul(g,yt)|0)+(i>>>13)|0)+(Pt>>>26)|0,Pt&=67108863,r=Math.imul(B,K),i=(i=Math.imul(B,Q))+Math.imul(F,K)|0,o=Math.imul(F,Q),r=r+Math.imul(L,$)|0,i=(i=i+Math.imul(L,tt)|0)+Math.imul(N,$)|0,o=o+Math.imul(N,tt)|0,r=r+Math.imul(C,nt)|0,i=(i=i+Math.imul(C,rt)|0)+Math.imul(I,nt)|0,o=o+Math.imul(I,rt)|0,r=r+Math.imul(A,ot)|0,i=(i=i+Math.imul(A,at)|0)+Math.imul(D,ot)|0,o=o+Math.imul(D,at)|0,r=r+Math.imul(E,ct)|0,i=(i=i+Math.imul(E,ut)|0)+Math.imul(P,ct)|0,o=o+Math.imul(P,ut)|0,r=r+Math.imul(S,ht)|0,i=(i=i+Math.imul(S,ft)|0)+Math.imul(T,ht)|0,o=o+Math.imul(T,ft)|0;var Ot=(u+(r=r+Math.imul(w,dt)|0)|0)+((8191&(i=(i=i+Math.imul(w,yt)|0)+Math.imul(_,dt)|0))<<13)|0;u=((o=o+Math.imul(_,yt)|0)+(i>>>13)|0)+(Ot>>>26)|0,Ot&=67108863,r=Math.imul(B,$),i=(i=Math.imul(B,tt))+Math.imul(F,$)|0,o=Math.imul(F,tt),r=r+Math.imul(L,nt)|0,i=(i=i+Math.imul(L,rt)|0)+Math.imul(N,nt)|0,o=o+Math.imul(N,rt)|0,r=r+Math.imul(C,ot)|0,i=(i=i+Math.imul(C,at)|0)+Math.imul(I,ot)|0,o=o+Math.imul(I,at)|0,r=r+Math.imul(A,ct)|0,i=(i=i+Math.imul(A,ut)|0)+Math.imul(D,ct)|0,o=o+Math.imul(D,ut)|0,r=r+Math.imul(E,ht)|0,i=(i=i+Math.imul(E,ft)|0)+Math.imul(P,ht)|0,o=o+Math.imul(P,ft)|0;var At=(u+(r=r+Math.imul(S,dt)|0)|0)+((8191&(i=(i=i+Math.imul(S,yt)|0)+Math.imul(T,dt)|0))<<13)|0;u=((o=o+Math.imul(T,yt)|0)+(i>>>13)|0)+(At>>>26)|0,At&=67108863,r=Math.imul(B,nt),i=(i=Math.imul(B,rt))+Math.imul(F,nt)|0,o=Math.imul(F,rt),r=r+Math.imul(L,ot)|0,i=(i=i+Math.imul(L,at)|0)+Math.imul(N,ot)|0,o=o+Math.imul(N,at)|0,r=r+Math.imul(C,ct)|0,i=(i=i+Math.imul(C,ut)|0)+Math.imul(I,ct)|0,o=o+Math.imul(I,ut)|0,r=r+Math.imul(A,ht)|0,i=(i=i+Math.imul(A,ft)|0)+Math.imul(D,ht)|0,o=o+Math.imul(D,ft)|0;var Dt=(u+(r=r+Math.imul(E,dt)|0)|0)+((8191&(i=(i=i+Math.imul(E,yt)|0)+Math.imul(P,dt)|0))<<13)|0;u=((o=o+Math.imul(P,yt)|0)+(i>>>13)|0)+(Dt>>>26)|0,Dt&=67108863,r=Math.imul(B,ot),i=(i=Math.imul(B,at))+Math.imul(F,ot)|0,o=Math.imul(F,at),r=r+Math.imul(L,ct)|0,i=(i=i+Math.imul(L,ut)|0)+Math.imul(N,ct)|0,o=o+Math.imul(N,ut)|0,r=r+Math.imul(C,ht)|0,i=(i=i+Math.imul(C,ft)|0)+Math.imul(I,ht)|0,o=o+Math.imul(I,ft)|0;var Rt=(u+(r=r+Math.imul(A,dt)|0)|0)+((8191&(i=(i=i+Math.imul(A,yt)|0)+Math.imul(D,dt)|0))<<13)|0;u=((o=o+Math.imul(D,yt)|0)+(i>>>13)|0)+(Rt>>>26)|0,Rt&=67108863,r=Math.imul(B,ct),i=(i=Math.imul(B,ut))+Math.imul(F,ct)|0,o=Math.imul(F,ut),r=r+Math.imul(L,ht)|0,i=(i=i+Math.imul(L,ft)|0)+Math.imul(N,ht)|0,o=o+Math.imul(N,ft)|0;var Ct=(u+(r=r+Math.imul(C,dt)|0)|0)+((8191&(i=(i=i+Math.imul(C,yt)|0)+Math.imul(I,dt)|0))<<13)|0;u=((o=o+Math.imul(I,yt)|0)+(i>>>13)|0)+(Ct>>>26)|0,Ct&=67108863,r=Math.imul(B,ht),i=(i=Math.imul(B,ft))+Math.imul(F,ht)|0,o=Math.imul(F,ft);var It=(u+(r=r+Math.imul(L,dt)|0)|0)+((8191&(i=(i=i+Math.imul(L,yt)|0)+Math.imul(N,dt)|0))<<13)|0;u=((o=o+Math.imul(N,yt)|0)+(i>>>13)|0)+(It>>>26)|0,It&=67108863;var kt=(u+(r=Math.imul(B,dt))|0)+((8191&(i=(i=Math.imul(B,yt))+Math.imul(F,dt)|0))<<13)|0;return u=((o=Math.imul(F,yt))+(i>>>13)|0)+(kt>>>26)|0,kt&=67108863,c[0]=mt,c[1]=vt,c[2]=gt,c[3]=bt,c[4]=wt,c[5]=_t,c[6]=xt,c[7]=St,c[8]=Tt,c[9]=Mt,c[10]=Et,c[11]=Pt,c[12]=Ot,c[13]=At,c[14]=Dt,c[15]=Rt,c[16]=Ct,c[17]=It,c[18]=kt,0!==u&&(c[19]=u,n.length++),n};function y(t,e,n){return(new m).mulp(t,e,n)}function m(t,e){this.x=t,this.y=e}Math.imul||(d=p),a.prototype.mulTo=function(t,e){var n=this.length+t.length;return 10===this.length&&10===t.length?d(this,t,e):n<63?p(this,t,e):n<1024?function(t,e,n){n.negative=e.negative^t.negative,n.length=t.length+e.length;for(var r=0,i=0,o=0;o<n.length-1;o++){var a=i;i=0;for(var s=67108863&r,c=Math.min(o,e.length-1),u=Math.max(0,o-t.length+1);u<=c;u++){var l=o-u,h=(0|t.words[l])*(0|e.words[u]),f=67108863&h;s=67108863&(f=f+s|0),i+=(a=(a=a+(h/67108864|0)|0)+(f>>>26)|0)>>>26,a&=67108863}n.words[o]=s,r=a,a=i}return 0!==r?n.words[o]=r:n.length--,n.strip()}(this,t,e):y(this,t,e)},m.prototype.makeRBT=function(t){for(var e=new Array(t),n=a.prototype._countBits(t)-1,r=0;r<t;r++)e[r]=this.revBin(r,n,t);return e},m.prototype.revBin=function(t,e,n){if(0===t||t===n-1)return t;for(var r=0,i=0;i<e;i++)r|=(1&t)<<e-i-1,t>>=1;return r},m.prototype.permute=function(t,e,n,r,i,o){for(var a=0;a<o;a++)r[a]=e[t[a]],i[a]=n[t[a]]},m.prototype.transform=function(t,e,n,r,i,o){this.permute(o,t,e,n,r,i);for(var a=1;a<i;a<<=1)for(var s=a<<1,c=Math.cos(2*Math.PI/s),u=Math.sin(2*Math.PI/s),l=0;l<i;l+=s)for(var h=c,f=u,p=0;p<a;p++){var d=n[l+p],y=r[l+p],m=n[l+p+a],v=r[l+p+a],g=h*m-f*v;v=h*v+f*m,m=g,n[l+p]=d+m,r[l+p]=y+v,n[l+p+a]=d-m,r[l+p+a]=y-v,p!==s&&(g=c*h-u*f,f=c*f+u*h,h=g)}},m.prototype.guessLen13b=function(t,e){var n=1|Math.max(e,t),r=1&n,i=0;for(n=n/2|0;n;n>>>=1)i++;return 1<<i+1+r},m.prototype.conjugate=function(t,e,n){if(!(n<=1))for(var r=0;r<n/2;r++){var i=t[r];t[r]=t[n-r-1],t[n-r-1]=i,i=e[r],e[r]=-e[n-r-1],e[n-r-1]=-i}},m.prototype.normalize13b=function(t,e){for(var n=0,r=0;r<e/2;r++){var i=8192*Math.round(t[2*r+1]/e)+Math.round(t[2*r]/e)+n;t[r]=67108863&i,n=i<67108864?0:i/67108864|0}return t},m.prototype.convert13b=function(t,e,n,r){for(var o=0,a=0;a<e;a++)o+=0|t[a],n[2*a]=8191&o,o>>>=13,n[2*a+1]=8191&o,o>>>=13;for(a=2*e;a<r;++a)n[a]=0;i(0===o),i(0==(-8192&o))},m.prototype.stub=function(t){for(var e=new Array(t),n=0;n<t;n++)e[n]=0;return e},m.prototype.mulp=function(t,e,n){var r=2*this.guessLen13b(t.length,e.length),i=this.makeRBT(r),o=this.stub(r),a=new Array(r),s=new Array(r),c=new Array(r),u=new Array(r),l=new Array(r),h=new Array(r),f=n.words;f.length=r,this.convert13b(t.words,t.length,a,r),this.convert13b(e.words,e.length,u,r),this.transform(a,o,s,c,r,i),this.transform(u,o,l,h,r,i);for(var p=0;p<r;p++){var d=s[p]*l[p]-c[p]*h[p];c[p]=s[p]*h[p]+c[p]*l[p],s[p]=d}return this.conjugate(s,c,r),this.transform(s,c,f,o,r,i),this.conjugate(f,o,r),this.normalize13b(f,r),n.negative=t.negative^e.negative,n.length=t.length+e.length,n.strip()},a.prototype.mul=function(t){var e=new a(null);return e.words=new Array(this.length+t.length),this.mulTo(t,e)},a.prototype.mulf=function(t){var e=new a(null);return e.words=new Array(this.length+t.length),y(this,t,e)},a.prototype.imul=function(t){return this.clone().mulTo(t,this)},a.prototype.imuln=function(t){i("number"==typeof t),i(t<67108864);for(var e=0,n=0;n<this.length;n++){var r=(0|this.words[n])*t,o=(67108863&r)+(67108863&e);e>>=26,e+=r/67108864|0,e+=o>>>26,this.words[n]=67108863&o}return 0!==e&&(this.words[n]=e,this.length++),this},a.prototype.muln=function(t){return this.clone().imuln(t)},a.prototype.sqr=function(){return this.mul(this)},a.prototype.isqr=function(){return this.imul(this.clone())},a.prototype.pow=function(t){var e=function(t){for(var e=new Array(t.bitLength()),n=0;n<e.length;n++){var r=n/26|0,i=n%26;e[n]=(t.words[r]&1<<i)>>>i}return e}(t);if(0===e.length)return new a(1);for(var n=this,r=0;r<e.length&&0===e[r];r++,n=n.sqr());if(++r<e.length)for(var i=n.sqr();r<e.length;r++,i=i.sqr())0!==e[r]&&(n=n.mul(i));return n},a.prototype.iushln=function(t){i("number"==typeof t&&t>=0);var e,n=t%26,r=(t-n)/26,o=67108863>>>26-n<<26-n;if(0!==n){var a=0;for(e=0;e<this.length;e++){var s=this.words[e]&o,c=(0|this.words[e])-s<<n;this.words[e]=c|a,a=s>>>26-n}a&&(this.words[e]=a,this.length++)}if(0!==r){for(e=this.length-1;e>=0;e--)this.words[e+r]=this.words[e];for(e=0;e<r;e++)this.words[e]=0;this.length+=r}return this.strip()},a.prototype.ishln=function(t){return i(0===this.negative),this.iushln(t)},a.prototype.iushrn=function(t,e,n){var r;i("number"==typeof t&&t>=0),r=e?(e-e%26)/26:0;var o=t%26,a=Math.min((t-o)/26,this.length),s=67108863^67108863>>>o<<o,c=n;if(r-=a,r=Math.max(0,r),c){for(var u=0;u<a;u++)c.words[u]=this.words[u];c.length=a}if(0===a);else if(this.length>a)for(this.length-=a,u=0;u<this.length;u++)this.words[u]=this.words[u+a];else this.words[0]=0,this.length=1;var l=0;for(u=this.length-1;u>=0&&(0!==l||u>=r);u--){var h=0|this.words[u];this.words[u]=l<<26-o|h>>>o,l=h&s}return c&&0!==l&&(c.words[c.length++]=l),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},a.prototype.ishrn=function(t,e,n){return i(0===this.negative),this.iushrn(t,e,n)},a.prototype.shln=function(t){return this.clone().ishln(t)},a.prototype.ushln=function(t){return this.clone().iushln(t)},a.prototype.shrn=function(t){return this.clone().ishrn(t)},a.prototype.ushrn=function(t){return this.clone().iushrn(t)},a.prototype.testn=function(t){i("number"==typeof t&&t>=0);var e=t%26,n=(t-e)/26,r=1<<e;return!(this.length<=n)&&!!(this.words[n]&r)},a.prototype.imaskn=function(t){i("number"==typeof t&&t>=0);var e=t%26,n=(t-e)/26;if(i(0===this.negative,"imaskn works only with positive numbers"),this.length<=n)return this;if(0!==e&&n++,this.length=Math.min(n,this.length),0!==e){var r=67108863^67108863>>>e<<e;this.words[this.length-1]&=r}return this.strip()},a.prototype.maskn=function(t){return this.clone().imaskn(t)},a.prototype.iaddn=function(t){return i("number"==typeof t),i(t<67108864),t<0?this.isubn(-t):0!==this.negative?1===this.length&&(0|this.words[0])<t?(this.words[0]=t-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(t),this.negative=1,this):this._iaddn(t)},a.prototype._iaddn=function(t){this.words[0]+=t;for(var e=0;e<this.length&&this.words[e]>=67108864;e++)this.words[e]-=67108864,e===this.length-1?this.words[e+1]=1:this.words[e+1]++;return this.length=Math.max(this.length,e+1),this},a.prototype.isubn=function(t){if(i("number"==typeof t),i(t<67108864),t<0)return this.iaddn(-t);if(0!==this.negative)return this.negative=0,this.iaddn(t),this.negative=1,this;if(this.words[0]-=t,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var e=0;e<this.length&&this.words[e]<0;e++)this.words[e]+=67108864,this.words[e+1]-=1;return this.strip()},a.prototype.addn=function(t){return this.clone().iaddn(t)},a.prototype.subn=function(t){return this.clone().isubn(t)},a.prototype.iabs=function(){return this.negative=0,this},a.prototype.abs=function(){return this.clone().iabs()},a.prototype._ishlnsubmul=function(t,e,n){var r,o,a=t.length+n;this._expand(a);var s=0;for(r=0;r<t.length;r++){o=(0|this.words[r+n])+s;var c=(0|t.words[r])*e;s=((o-=67108863&c)>>26)-(c/67108864|0),this.words[r+n]=67108863&o}for(;r<this.length-n;r++)s=(o=(0|this.words[r+n])+s)>>26,this.words[r+n]=67108863&o;if(0===s)return this.strip();for(i(-1===s),s=0,r=0;r<this.length;r++)s=(o=-(0|this.words[r])+s)>>26,this.words[r]=67108863&o;return this.negative=1,this.strip()},a.prototype._wordDiv=function(t,e){var n=(this.length,t.length),r=this.clone(),i=t,o=0|i.words[i.length-1];0!==(n=26-this._countBits(o))&&(i=i.ushln(n),r.iushln(n),o=0|i.words[i.length-1]);var s,c=r.length-i.length;if("mod"!==e){(s=new a(null)).length=c+1,s.words=new Array(s.length);for(var u=0;u<s.length;u++)s.words[u]=0}var l=r.clone()._ishlnsubmul(i,1,c);0===l.negative&&(r=l,s&&(s.words[c]=1));for(var h=c-1;h>=0;h--){var f=67108864*(0|r.words[i.length+h])+(0|r.words[i.length+h-1]);for(f=Math.min(f/o|0,67108863),r._ishlnsubmul(i,f,h);0!==r.negative;)f--,r.negative=0,r._ishlnsubmul(i,1,h),r.isZero()||(r.negative^=1);s&&(s.words[h]=f)}return s&&s.strip(),r.strip(),"div"!==e&&0!==n&&r.iushrn(n),{div:s||null,mod:r}},a.prototype.divmod=function(t,e,n){return i(!t.isZero()),this.isZero()?{div:new a(0),mod:new a(0)}:0!==this.negative&&0===t.negative?(s=this.neg().divmod(t,e),"mod"!==e&&(r=s.div.neg()),"div"!==e&&(o=s.mod.neg(),n&&0!==o.negative&&o.iadd(t)),{div:r,mod:o}):0===this.negative&&0!==t.negative?(s=this.divmod(t.neg(),e),"mod"!==e&&(r=s.div.neg()),{div:r,mod:s.mod}):0!=(this.negative&t.negative)?(s=this.neg().divmod(t.neg(),e),"div"!==e&&(o=s.mod.neg(),n&&0!==o.negative&&o.isub(t)),{div:s.div,mod:o}):t.length>this.length||this.cmp(t)<0?{div:new a(0),mod:this}:1===t.length?"div"===e?{div:this.divn(t.words[0]),mod:null}:"mod"===e?{div:null,mod:new a(this.modn(t.words[0]))}:{div:this.divn(t.words[0]),mod:new a(this.modn(t.words[0]))}:this._wordDiv(t,e);var r,o,s},a.prototype.div=function(t){return this.divmod(t,"div",!1).div},a.prototype.mod=function(t){return this.divmod(t,"mod",!1).mod},a.prototype.umod=function(t){return this.divmod(t,"mod",!0).mod},a.prototype.divRound=function(t){var e=this.divmod(t);if(e.mod.isZero())return e.div;var n=0!==e.div.negative?e.mod.isub(t):e.mod,r=t.ushrn(1),i=t.andln(1),o=n.cmp(r);return o<0||1===i&&0===o?e.div:0!==e.div.negative?e.div.isubn(1):e.div.iaddn(1)},a.prototype.modn=function(t){i(t<=67108863);for(var e=(1<<26)%t,n=0,r=this.length-1;r>=0;r--)n=(e*n+(0|this.words[r]))%t;return n},a.prototype.idivn=function(t){i(t<=67108863);for(var e=0,n=this.length-1;n>=0;n--){var r=(0|this.words[n])+67108864*e;this.words[n]=r/t|0,e=r%t}return this.strip()},a.prototype.divn=function(t){return this.clone().idivn(t)},a.prototype.egcd=function(t){i(0===t.negative),i(!t.isZero());var e=this,n=t.clone();e=0!==e.negative?e.umod(t):e.clone();for(var r=new a(1),o=new a(0),s=new a(0),c=new a(1),u=0;e.isEven()&&n.isEven();)e.iushrn(1),n.iushrn(1),++u;for(var l=n.clone(),h=e.clone();!e.isZero();){for(var f=0,p=1;0==(e.words[0]&p)&&f<26;++f,p<<=1);if(f>0)for(e.iushrn(f);f-- >0;)(r.isOdd()||o.isOdd())&&(r.iadd(l),o.isub(h)),r.iushrn(1),o.iushrn(1);for(var d=0,y=1;0==(n.words[0]&y)&&d<26;++d,y<<=1);if(d>0)for(n.iushrn(d);d-- >0;)(s.isOdd()||c.isOdd())&&(s.iadd(l),c.isub(h)),s.iushrn(1),c.iushrn(1);e.cmp(n)>=0?(e.isub(n),r.isub(s),o.isub(c)):(n.isub(e),s.isub(r),c.isub(o))}return{a:s,b:c,gcd:n.iushln(u)}},a.prototype._invmp=function(t){i(0===t.negative),i(!t.isZero());var e=this,n=t.clone();e=0!==e.negative?e.umod(t):e.clone();for(var r,o=new a(1),s=new a(0),c=n.clone();e.cmpn(1)>0&&n.cmpn(1)>0;){for(var u=0,l=1;0==(e.words[0]&l)&&u<26;++u,l<<=1);if(u>0)for(e.iushrn(u);u-- >0;)o.isOdd()&&o.iadd(c),o.iushrn(1);for(var h=0,f=1;0==(n.words[0]&f)&&h<26;++h,f<<=1);if(h>0)for(n.iushrn(h);h-- >0;)s.isOdd()&&s.iadd(c),s.iushrn(1);e.cmp(n)>=0?(e.isub(n),o.isub(s)):(n.isub(e),s.isub(o))}return(r=0===e.cmpn(1)?o:s).cmpn(0)<0&&r.iadd(t),r},a.prototype.gcd=function(t){if(this.isZero())return t.abs();if(t.isZero())return this.abs();var e=this.clone(),n=t.clone();e.negative=0,n.negative=0;for(var r=0;e.isEven()&&n.isEven();r++)e.iushrn(1),n.iushrn(1);for(;;){for(;e.isEven();)e.iushrn(1);for(;n.isEven();)n.iushrn(1);var i=e.cmp(n);if(i<0){var o=e;e=n,n=o}else if(0===i||0===n.cmpn(1))break;e.isub(n)}return n.iushln(r)},a.prototype.invm=function(t){return this.egcd(t).a.umod(t)},a.prototype.isEven=function(){return 0==(1&this.words[0])},a.prototype.isOdd=function(){return 1==(1&this.words[0])},a.prototype.andln=function(t){return this.words[0]&t},a.prototype.bincn=function(t){i("number"==typeof t);var e=t%26,n=(t-e)/26,r=1<<e;if(this.length<=n)return this._expand(n+1),this.words[n]|=r,this;for(var o=r,a=n;0!==o&&a<this.length;a++){var s=0|this.words[a];o=(s+=o)>>>26,s&=67108863,this.words[a]=s}return 0!==o&&(this.words[a]=o,this.length++),this},a.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},a.prototype.cmpn=function(t){var e,n=t<0;if(0!==this.negative&&!n)return-1;if(0===this.negative&&n)return 1;if(this.strip(),this.length>1)e=1;else{n&&(t=-t),i(t<=67108863,"Number is too big");var r=0|this.words[0];e=r===t?0:r<t?-1:1}return 0!==this.negative?0|-e:e},a.prototype.cmp=function(t){if(0!==this.negative&&0===t.negative)return-1;if(0===this.negative&&0!==t.negative)return 1;var e=this.ucmp(t);return 0!==this.negative?0|-e:e},a.prototype.ucmp=function(t){if(this.length>t.length)return 1;if(this.length<t.length)return-1;for(var e=0,n=this.length-1;n>=0;n--){var r=0|this.words[n],i=0|t.words[n];if(r!==i){r<i?e=-1:r>i&&(e=1);break}}return e},a.prototype.gtn=function(t){return 1===this.cmpn(t)},a.prototype.gt=function(t){return 1===this.cmp(t)},a.prototype.gten=function(t){return this.cmpn(t)>=0},a.prototype.gte=function(t){return this.cmp(t)>=0},a.prototype.ltn=function(t){return-1===this.cmpn(t)},a.prototype.lt=function(t){return-1===this.cmp(t)},a.prototype.lten=function(t){return this.cmpn(t)<=0},a.prototype.lte=function(t){return this.cmp(t)<=0},a.prototype.eqn=function(t){return 0===this.cmpn(t)},a.prototype.eq=function(t){return 0===this.cmp(t)},a.red=function(t){return new S(t)},a.prototype.toRed=function(t){return i(!this.red,"Already a number in reduction context"),i(0===this.negative,"red works only with positives"),t.convertTo(this)._forceRed(t)},a.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},a.prototype._forceRed=function(t){return this.red=t,this},a.prototype.forceRed=function(t){return i(!this.red,"Already a number in reduction context"),this._forceRed(t)},a.prototype.redAdd=function(t){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,t)},a.prototype.redIAdd=function(t){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,t)},a.prototype.redSub=function(t){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,t)},a.prototype.redISub=function(t){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,t)},a.prototype.redShl=function(t){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,t)},a.prototype.redMul=function(t){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.mul(this,t)},a.prototype.redIMul=function(t){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.imul(this,t)},a.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},a.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},a.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},a.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},a.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},a.prototype.redPow=function(t){return i(this.red&&!t.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,t)};var v={k256:null,p224:null,p192:null,p25519:null};function g(t,e){this.name=t,this.p=new a(e,16),this.n=this.p.bitLength(),this.k=new a(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function b(){g.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function w(){g.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function _(){g.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function x(){g.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function S(t){if("string"==typeof t){var e=a._prime(t);this.m=e.p,this.prime=e}else i(t.gtn(1),"modulus must be greater than 1"),this.m=t,this.prime=null}function T(t){S.call(this,t),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new a(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}g.prototype._tmp=function(){var t=new a(null);return t.words=new Array(Math.ceil(this.n/13)),t},g.prototype.ireduce=function(t){var e,n=t;do{this.split(n,this.tmp),e=(n=(n=this.imulK(n)).iadd(this.tmp)).bitLength()}while(e>this.n);var r=e<this.n?-1:n.ucmp(this.p);return 0===r?(n.words[0]=0,n.length=1):r>0?n.isub(this.p):n.strip(),n},g.prototype.split=function(t,e){t.iushrn(this.n,0,e)},g.prototype.imulK=function(t){return t.imul(this.k)},o(b,g),b.prototype.split=function(t,e){for(var n=Math.min(t.length,9),r=0;r<n;r++)e.words[r]=t.words[r];if(e.length=n,t.length<=9)return t.words[0]=0,void(t.length=1);var i=t.words[9];for(e.words[e.length++]=4194303&i,r=10;r<t.length;r++){var o=0|t.words[r];t.words[r-10]=(4194303&o)<<4|i>>>22,i=o}i>>>=22,t.words[r-10]=i,0===i&&t.length>10?t.length-=10:t.length-=9},b.prototype.imulK=function(t){t.words[t.length]=0,t.words[t.length+1]=0,t.length+=2;for(var e=0,n=0;n<t.length;n++){var r=0|t.words[n];e+=977*r,t.words[n]=67108863&e,e=64*r+(e/67108864|0)}return 0===t.words[t.length-1]&&(t.length--,0===t.words[t.length-1]&&t.length--),t},o(w,g),o(_,g),o(x,g),x.prototype.imulK=function(t){for(var e=0,n=0;n<t.length;n++){var r=19*(0|t.words[n])+e,i=67108863&r;r>>>=26,t.words[n]=i,e=r}return 0!==e&&(t.words[t.length++]=e),t},a._prime=function(t){if(v[t])return v[t];var e;if("k256"===t)e=new b;else if("p224"===t)e=new w;else if("p192"===t)e=new _;else{if("p25519"!==t)throw new Error("Unknown prime "+t);e=new x}return v[t]=e,e},S.prototype._verify1=function(t){i(0===t.negative,"red works only with positives"),i(t.red,"red works only with red numbers")},S.prototype._verify2=function(t,e){i(0==(t.negative|e.negative),"red works only with positives"),i(t.red&&t.red===e.red,"red works only with red numbers")},S.prototype.imod=function(t){return this.prime?this.prime.ireduce(t)._forceRed(this):t.umod(this.m)._forceRed(this)},S.prototype.neg=function(t){return t.isZero()?t.clone():this.m.sub(t)._forceRed(this)},S.prototype.add=function(t,e){this._verify2(t,e);var n=t.add(e);return n.cmp(this.m)>=0&&n.isub(this.m),n._forceRed(this)},S.prototype.iadd=function(t,e){this._verify2(t,e);var n=t.iadd(e);return n.cmp(this.m)>=0&&n.isub(this.m),n},S.prototype.sub=function(t,e){this._verify2(t,e);var n=t.sub(e);return n.cmpn(0)<0&&n.iadd(this.m),n._forceRed(this)},S.prototype.isub=function(t,e){this._verify2(t,e);var n=t.isub(e);return n.cmpn(0)<0&&n.iadd(this.m),n},S.prototype.shl=function(t,e){return this._verify1(t),this.imod(t.ushln(e))},S.prototype.imul=function(t,e){return this._verify2(t,e),this.imod(t.imul(e))},S.prototype.mul=function(t,e){return this._verify2(t,e),this.imod(t.mul(e))},S.prototype.isqr=function(t){return this.imul(t,t.clone())},S.prototype.sqr=function(t){return this.mul(t,t)},S.prototype.sqrt=function(t){if(t.isZero())return t.clone();var e=this.m.andln(3);if(i(e%2==1),3===e){var n=this.m.add(new a(1)).iushrn(2);return this.pow(t,n)}for(var r=this.m.subn(1),o=0;!r.isZero()&&0===r.andln(1);)o++,r.iushrn(1);i(!r.isZero());var s=new a(1).toRed(this),c=s.redNeg(),u=this.m.subn(1).iushrn(1),l=this.m.bitLength();for(l=new a(2*l*l).toRed(this);0!==this.pow(l,u).cmp(c);)l.redIAdd(c);for(var h=this.pow(l,r),f=this.pow(t,r.addn(1).iushrn(1)),p=this.pow(t,r),d=o;0!==p.cmp(s);){for(var y=p,m=0;0!==y.cmp(s);m++)y=y.redSqr();i(m<d);var v=this.pow(h,new a(1).iushln(d-m-1));f=f.redMul(v),h=v.redSqr(),p=p.redMul(h),d=m}return f},S.prototype.invm=function(t){var e=t._invmp(this.m);return 0!==e.negative?(e.negative=0,this.imod(e).redNeg()):this.imod(e)},S.prototype.pow=function(t,e){if(e.isZero())return new a(1).toRed(this);if(0===e.cmpn(1))return t.clone();var n=new Array(16);n[0]=new a(1).toRed(this),n[1]=t;for(var r=2;r<n.length;r++)n[r]=this.mul(n[r-1],t);var i=n[0],o=0,s=0,c=e.bitLength()%26;for(0===c&&(c=26),r=e.length-1;r>=0;r--){for(var u=e.words[r],l=c-1;l>=0;l--){var h=u>>l&1;i!==n[0]&&(i=this.sqr(i)),0!==h||0!==o?(o<<=1,o|=h,(4===++s||0===r&&0===l)&&(i=this.mul(i,n[o]),s=0,o=0)):s=0}c=26}return i},S.prototype.convertTo=function(t){var e=t.umod(this.m);return e===t?e.clone():e},S.prototype.convertFrom=function(t){var e=t.clone();return e.red=null,e},a.mont=function(t){return new T(t)},o(T,S),T.prototype.convertTo=function(t){return this.imod(t.ushln(this.shift))},T.prototype.convertFrom=function(t){var e=this.imod(t.mul(this.rinv));return e.red=null,e},T.prototype.imul=function(t,e){if(t.isZero()||e.isZero())return t.words[0]=0,t.length=1,t;var n=t.imul(e),r=n.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=n.isub(r).iushrn(this.shift),o=i;return i.cmp(this.m)>=0?o=i.isub(this.m):i.cmpn(0)<0&&(o=i.iadd(this.m)),o._forceRed(this)},T.prototype.mul=function(t,e){if(t.isZero()||e.isZero())return new a(0)._forceRed(this);var n=t.mul(e),r=n.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=n.isub(r).iushrn(this.shift),o=i;return i.cmp(this.m)>=0?o=i.isub(this.m):i.cmpn(0)<0&&(o=i.iadd(this.m)),o._forceRed(this)},T.prototype.invm=function(t){return this.imod(t._invmp(this.m).mul(this.r2))._forceRed(this)}}(t,this)}).call(this,n(375)(t))},function(t,e,n){"use strict";n.r(e);var r,i=n(146),o=n(562),a=n(4),s=function(t){this.sid=t.sid,this.uuid=t.job.uuid,this.vrSupported=t.is_vr,this.data={sid:t.sid,name:t.name,presentedBy:t.presented_by,summary:t.summary,formattedAddress:c(t.address),contact:{email:t.contact_email,name:t.contact_name,phone:t.contact_phone,formattedPhone:t.formatted_contact_phone},externalUrl:t.external_url},this.playerOptions={address:t.player_options.address,autoplay:t.player_options.autoplay,contactEmail:t.player_options.contact_email,contactName:t.player_options.contact_name,contactPhone:t.player_options.contact_phone,dollhouse:t.player_options.dollhouse,externalUrl:t.player_options.external_url,fastTransitions:t.player_options.fast_transitions,floorplan:t.player_options.floor_plan,highlightReel:t.player_options.highlight_reel,labels:t.player_options.labels,modelName:t.player_options.model_name,modelSummary:t.player_options.model_summary,presentedBy:t.player_options.presented_by,tourButtons:t.player_options.tour_buttons}},c=function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){return""}if(!(t&&(t.address_1||t.address_2||t.city||t.state||t.zip)))return"";var e=[];return t.address_1&&e.push(t.address_1),t.address_2&&e.push(t.address_2),t.city&&(e.length>0&&e.push(", "),e.push(t.city)),t.state&&(e.length>0&&e.push(", "),e.push(t.state)),t.zip&&(e.length>0&&e.push(", "),e.push(t.zip)),e.join("")},u=n(15),l=n(92),h=n(61),f=n(2),p=n(194),d=n(195),y=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},m=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},v=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},g=new f.a("modelurls"),b=function(){function t(){this.version=1,this.cache=null,this.expires=0}return t.prototype.validate=function(t){return"catalog.json"in t&&Object.keys(t).length>0},t.prototype.update=function(t){return this.cache=t,this.expires=Date.now()+h.a.signedUrlDefaultExpireTime,Promise.resolve()},t.prototype.get=function(t){return this.cache[t]},t}(),w=function(){function t(){this.version=2,this.baseUrl="",this.cache=null,this.expires=0}return t.prototype.validate=function(t){return"catalog.json"in t&&"base.url"in t&&Object.keys(t).length>1},t.prototype.update=function(t){return this.baseUrl=t["base.url"],this.cache=t,this.expires=Date.now()+h.a.signedUrlDefaultExpireTime,Promise.resolve()},t.prototype.get=function(t){var e=this.cache[t];if(!e)throw Error("URL path not found: "+t);return this.baseUrl.replace("{{filename}}",t)+e},t}(),_=function(){function t(){this.version=3,this.baseUrl="",this.expires=0}return t.prototype.validate=function(t){return t.templates&&t.catalog_file&&(!t.expires||1e3*t.expires>Date.now())},t.prototype.update=function(t){if(!t.templates)throw new Error("No templates found.");return this.baseUrl=t.templates[0],t.expires?this.expires=1e3*t.expires:this.expires=Date.now()+h.a.signedUrlDefaultExpireTime,Promise.resolve()},t.prototype.get=function(t){return this.baseUrl&&this.baseUrl.replace("{{filename}}",t)},t}(),x=function(){function t(t,e){this.api=t,this.endpoint=e,this.urlContainer=null,this.authorizationHeader=Object(p.b)(),this.previousRefreshPromise=null,this.containerClasses=[_,w,b],this.endpoint=e+"?type=3"}return t.prototype.needsRefresh=function(){var t=this.urlContainer?this.urlContainer.expires:Date.now();return Date.now()+h.a.signedUrlRefreshBuffer>t},t.prototype.refresh=function(){if(!this.needsRefresh())return Promise.resolve();if(!this.previousRefreshPromise){g.debug("Refreshing urls...");var t=this;this.previousRefreshPromise=this._refresh().then((function(){g.debug("Refreshed"),t.previousRefreshPromise=null}),(function(e){g.error("Failed url refresh, urls might go stale soon",e),t.previousRefreshPromise=null}))}return this.previousRefreshPromise},t.prototype._refresh=function(t){return void 0===t&&(t=!0),y(this,void 0,Promise,(function(){var e,n,r,i,o,a,s;return m(this,(function(c){switch(c.label){case 0:return[4,this.api.get(this.endpoint,{responseType:"json",prefetchFrom:t?"files":void 0,auth:this.authorizationHeader,priority:l.RequestPriority.HIGHEST})];case 1:if(r=c.sent(),this.urlContainer&&this.urlContainer.validate(r))return[2,this.urlContainer.update(r)];try{for(i=v(this.containerClasses),o=i.next();!o.done;o=i.next())if(a=o.value,(s=new a).validate(r))return g.info("Using urls version "+s.version),this.urlContainer=s,[2,this.urlContainer.update(r)]}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}if(t)return[2,this._refresh(!1)];throw new Error("missing-urls")}}))}))},t.prototype.getSignedUrl=function(t){return y(this,void 0,Promise,(function(){var e;return m(this,(function(n){switch(n.label){case 0:return[4,this.refresh()];case 1:if(n.sent(),!this.urlContainer)throw new Error("Tried to use ModelUrls.get before urlContainer is established.");if(!(e=this.urlContainer.get(t)))throw new Error("Could not get signed URL for path "+t);return[2,e]}}))}))},t.prototype.getFile=function(t,e,n){return y(this,void 0,Promise,(function(){var r,i;return m(this,(function(o){switch(o.label){case 0:return i=d.c,[4,this.getSignedUrl(t)];case 1:return r=i.apply(void 0,[o.sent(),n]),[2,this.api.get(r,e)]}}))}))},t.prototype.getImage=function(t,e,n){return y(this,void 0,Promise,(function(){var r,i;return m(this,(function(o){switch(o.label){case 0:return i=d.c,[4,this.getSignedUrl(t)];case 1:return r=i.apply(void 0,[o.sent(),n]),[2,this.api.getImage(r,e)]}}))}))},t.prototype.getImageBitmap=function(t,e,n,r,i){return y(this,void 0,Promise,(function(){var o,a;return m(this,(function(s){switch(s.label){case 0:return a=d.c,[4,this.getSignedUrl(t)];case 1:return o=a.apply(void 0,[s.sent(),i]),[2,this.api.getImageBitmap(o,e,n,r)]}}))}))},t}(),S=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),T=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},M=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},E=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="model-data",e}return S(e,t),e.prototype.init=function(t,e){return T(this,void 0,void 0,(function(){var n,r,a,c;return M(this,(function(l){switch(l.label){case 0:return[4,e.getModule(i.default)];case 1:return n=l.sent(),r=n.getApi(),[4,t.modelDetailsStore.read()];case 2:if(!(a=l.sent()))throw Error("Could not fetch model data");return this.model=new s(a),this.signedUrls=new x(r,r.baseUrl+"/api/player/models/"+t.sid+"/files"),[4,e.market.waitForData(u.a)];case 3:return c=l.sent(),e.broadcast(new o.a(this.signedUrls,this.model.sid,this.model.vrSupported,c.getSweepList())),[2]}}))}))},e.prototype.getModel=function(){return this.model},e.prototype.getSignedUrls=function(){return this.signedUrls},e}(a.a);e.default=E},function(t,e,n){"use strict";n.r(e);var r,i=n(1),o=n(10),a=n(0),s=n(3),c=n(79),u=n(4),l=n(50),h=n(17),f=n(60),p=n(18),d=n(156),y=n(15),m=n(98),v=n(112),g=n(214),b=n(311),w=n(28),_=n(100),x=n(68),S=n(57),T={rotationDuration:1,rotationDelay:0,matrixDelay:0,matrixDuration:.5},M=((r={})[i.a.Dollhouse]={matrixDelay:.5,matrixDuration:1},r[i.a.Panorama]={rotationDuration:.5},r),E=n(2),P=n(174);n.d(e,"DEFAULT_TRANSITION_TIME",(function(){return N}));var O,A,D=(O=function(t,e){return(O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}O(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),R=function(){return(R=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},C=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},I=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},k=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},L=new E.a("viewmodes-data"),N=1e3,j=Math.PI/2+Number.EPSILON,B=Math.PI-Number.EPSILON,F=((A={})[i.a.Panorama]=N,A[i.a.Dollhouse]=N,A[i.a.Floorplan]=N,A),U=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.viewmodeData=new h.a,e.name="viewmode",e.minDollhouseDistance=15,e.maxDollhouseDistance=50,e.getFlyinStartPose=function(t,n){var r=n||e.cameraData.pose.position,i=t.position.y-r.y,o=Object(w.l)(t.position,r,e.meshData.center),a=s.b.FORWARD.clone().applyQuaternion(o);return{position:Object(w.i)(t.position,r,Math.sign(a.y)*Math.PI/4,!0).setY(1.5*i)}},e.getFlyinEndPose=function(t){var n=t.position||e.sweepData.getSweep(t.sweepID).position,r=t.rotation||new a.Pb,i=Math.PI/180*c.a.fov;return Object(w.f)(n,r,-Math.PI/6,e.meshData.bounds,i,e.canvas.aspectRatio)},e}return D(e,t),e.prototype.init=function(t,e){return C(this,void 0,void 0,(function(){var n,r,i,o,a,s,c=this;return I(this,(function(u){switch(u.label){case 0:return this.engine=e,this.market=e.market,null!==t.startingMode&&(this.viewmodeData.currentMode=t.startingMode),this.market.register(this,h.a,this.viewmodeData),e.market.waitForData(P.a).then((function(t){c.meshData=t,c.setDollhouseBounds()})),[4,Promise.all([e.getModule(f.default),e.getModule(d.default),e.market.waitForData(y.a),e.market.waitForData(_.a),e.market.waitForData(p.a)])];case 1:return n=k.apply(void 0,[u.sent(),5]),r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],this.cameraModule=r,this.sweepModule=i,this.sweepData=o,this.canvas=a,this.cameraData=s,[2]}}))}))},Object.defineProperty(e.prototype,"currentMode",{get:function(){return this.viewmodeData.currentMode},enumerable:!0,configurable:!0}),e.prototype.switchToMode=function(t,n,r,a){return void 0===n&&(n=o.a.FadeToBlack),C(this,void 0,Promise,(function(){var s,c,u,h,f,p=this;return I(this,(function(d){switch(d.label){case 0:return L.info("switchToMode mode:"+t+" type:"+n),this.meshData||t!==i.a.Floorplan&&t!==i.a.Dollhouse?[3,2]:[4,this.engine.getModule(l.default)];case 1:d.sent(),d.label=2;case 2:if(n===o.a.Instant&&(a=0),a=void 0!==a?a:F[t],!this.viewmodeData.canStartTransition()||!this.cameraData.canTransition())throw new b.a;return s=this.isAlreadyInMode(this.viewmodeData,t),c=r&&!e.willPoseChange(this.cameraData,r),s&&c?[2,Promise.resolve()]:(this.sweepData.currentSweep&&this.sweepData.isSweepUnaligned(this.sweepData.currentSweep)&&this.viewmodeData.currentMode===i.a.Panorama&&(n=o.a.FadeToBlack),u=null!==this.viewmodeData.currentMode?this.viewmodeData.currentMode:void 0,this.viewmodeData.activateTransition(this.viewmodeData.currentMode,t,a),this.viewmodeData.currentMode=i.a.Transition,this.viewmodeData.commit(),this.engine.broadcast(new v.a(t,u)),h=this.moveCameraToViewmode(t,u,n,a,r),f=!1,h.progress((function(e){p.viewmodeData.transition.progress=e,p.viewmodeData.commit(),e>=.5&&!f&&(f=!0,p.engine.broadcast(new g.a(t,u)))})),h.then((function(){p.viewmodeData.transition.progress=1,p.viewmodeData.currentMode=t,p.viewmodeData.deactivateTransition(),p.viewmodeData.commit(),p.engine.broadcast(new m.a(t,u))})),[2,h.nativePromise()])}}))}))},e.prototype.isAlreadyInMode=function(t,e){var n=t.transition.from===t.transition.to,r=t.currentMode===e;return t.transition.active&&n||r},e.willPoseChange=function(t,e){return void 0!==e.position&&!t.pose.position.equals(e.position)||void 0!==e.rotation&&!t.pose.rotation.equals(e.rotation)||void 0!==e.zoom&&t.zoom()!==e.zoom},e.prototype.moveCameraToViewmode=function(t,e,n,r,o){switch(t){case i.a.Panorama:return this.moveCameraToPanorama(n,r,o);case i.a.Dollhouse:return this.moveCameraToDollhouse(e,n,r,o);case i.a.Floorplan:return this.moveCameraToFloorplan(e,n,r,o);default:throw Error("moveCameraToViewmode(): Invalid view-mode to go to: "+t)}},e.prototype.moveCameraToPanorama=function(t,e,n){if(this.sweepData.canTransition()||this.cameraData.canTransition()){var r=void 0;if(n&&n.sweepID)r=n.sweepID;else{var c=this.sweepData.getFirstSweep();!(r=this.sweepData.currentSweep)&&c&&(r=c.id)}if(!r)throw new Error("moveCameraToPanorama(): Invalid target sweep!");this.sweepData.isSweepUnaligned(r)&&(t=o.a.FadeToBlack);var u=n&&n.rotation?n.rotation:void 0;if(!u){var l=(this.viewmodeData.transition.from===i.a.Floorplan?s.b.UP:s.b.FORWARD).clone().applyQuaternion(this.cameraData.pose.rotation).setY(0).normalize();u=(new a.Pb).setFromUnitVectors(s.b.FORWARD,l)}return this.sweepModule.moveToSweep({transitionType:t,sweepId:r,rotation:u,transitionTime:e,rotationDelay:.5})}throw new Error("Could not move to panorama mode because another transition was active")},e.prototype.moveCameraToDollhouse=function(t,e,n,r){var o,u,l,h,f,p,d,y=this.meshData.bounds,m={};if(r&&(r.position||r.rotation)){if(r.position&&r.rotation){m.position=r.position,m.rotation=r.rotation;var v=new a.Hb(s.b.UP.clone(),this.meshData.center.y),g=Object(w.h)(m.position,m.rotation,v);g||(g=new a.Jc).copy(this.meshData.center),y.containsPoint(g)&&(l=m.position.distanceTo(g))}else if(r.position)m.position=r.position,m.rotation=Object(w.j)(r.position,this.meshData.center);else{m.rotation=r.rotation;var b=y.min.distanceTo(y.max);m.position=Object(w.k)(m.rotation,this.meshData.center,b)}l||(l=this.meshData.center.clone().distanceTo(m.position))}else{var _=void 0,x=void 0,S=this.sweepData.isSweepUnaligned(this.sweepData.currentSweep),T=S||this.viewmodeData.transition.from===i.a.Floorplan?this.meshData.center:this.cameraData.pose.position;if(S)x=new a.Jc(0,0,0),_=new a.Jc(15,10,15);else if(this.viewmodeData.transition.from!==i.a.Floorplan){var M=Object(w.f)(this.cameraData.pose.position,this.cameraData.pose.rotation,-Math.PI/6,this.meshData.bounds,1.5*this.cameraData.fovY(),this.cameraData.pose.aspect()),E=(h=T,f=this.cameraData.pose.rotation,p=h.clone().add(new a.Jc(0,6,0)),(d=s.b.FORWARD.clone().applyQuaternion(f)).y>=.01&&(d.y=.01),{position:p.clone().add(d.clone().multiplyScalar(-10)),direction:d});_=(o=k([M.position,E.direction],2))[0],x=o[1]}else{E=function(t,e){var n=t.clone(),r=s.b.DOWN.clone().applyQuaternion(e).multiplyScalar(6),i=n.clone().add(r).setY(6),o=s.b.UP.clone().applyQuaternion(e);return o.setY(-.5).normalize(),{position:i,direction:o}}(T,this.cameraData.pose.rotation);_=(u=k([E.position,E.direction],2))[0],x=u[1]}var P=T.clone().add(x).setY(this.meshData.center.y);m.position=Object(w.c)(_,P,this.minDollhouseDistance,this.maxDollhouseDistance),m.position=Object(w.d)(m.position,P,j,B),m.rotation=Object(w.j)(m.position,P),l=P.distanceTo(m.position)}return this.cameraModule.moveTo({transitionType:e,pose:m,transitionTime:n,projection:Object(c.c)(this.cameraData.aspect()),focalDistance:l,rotationDuration:.5})},e.prototype.setDollhouseBounds=function(){var t=this.meshData.bounds,e=t.min.distanceTo(t.max);this.minDollhouseDistance=Math.min(e/2,this.minDollhouseDistance),this.maxDollhouseDistance=Math.max(e,this.maxDollhouseDistance)},e.prototype.moveCameraToFloorplan=function(t,e,n,r){var i={},o=this.meshData.center,u=this.meshData.size,l=Math.max(u.x,u.z),h=Math.min(u.x,u.z),f=this.canvas.aspectRatio,p=Math.max(l,h/f),d=Math.max(h,l/f),y=f<1?p:d,m=this.canvas.height/(1.2*y),v=r&&r.zoom?this.canvas.height/(2*r.zoom):m,g=Object(c.b)(this.canvas.width,this.canvas.height,v),b=Object(c.b)(this.canvas.width,this.canvas.height,m);if(this.cameraModule.setBaseProjection(b),r&&r.position)i.position=r.position;else{var w=s.b.UP.clone().multiplyScalar(l);i.position=o.clone().add(w)}if(r&&r.rotation)i.rotation=r.rotation;else{var _=(new x.a).setPosition(i.position);if(_.lookAt(i.position,o,s.b.FORWARD),i.rotation=(new a.Pb).setFromRotationMatrix(_.asThreeMatrix4()),f<1!==u.x/u.z<1){var E=(new a.Pb).setFromUnitVectors(s.b.UP,s.b.LEFT);i.rotation.multiply(E)}}var P=R({},T,{easing:S.h,transitionType:e,pose:i,transitionTime:n,projection:g});return t&&t in M&&(P=R({},M[t],P)),this.cameraModule.moveTo(P)},e}(u.a);e.default=U},function(t,e,n){"use strict";var r,i=n(214),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(i.a);e.a=a},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(5),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e){void 0===e&&(e=null);var n=t.call(this)||this;return n.id="SET_MOUSE_CURSOR",n.payload={cursor:e},n}return o(e,t),e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(23),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n){var r=t.call(this)||this;r.name="canvas",r.x=0,r.y=0,r.width=e||0,r.height=n||0;var i=r.width/r.height;return r.aspectRatio=isFinite(i)?i:1,r}return o(e,t),e.prototype.copy=function(t){this.width=t.width,this.height=t.height,this.aspectRatio=t.width/t.height,this.x=t.x,this.y=t.y},e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(155),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return a}));var r,i,o=n(182);!function(t){t[t.ADDED=0]="ADDED",t[t.REMOVED=1]="REMOVED",t[t.UPDATED=2]="UPDATED",t[t.COUNT=3]="COUNT"}(r||(r={})),function(t){t[t.ADDED=1]="ADDED",t[t.REMOVED=2]="REMOVED",t[t.UPDATED=4]="UPDATED",t[t.ALL=7]="ALL"}(i||(i={}));var a=function(t,e){var n,r=e&i.ADDED,a=e&i.REMOVED,s=e&i.UPDATED,c={};return new o.a((function(){return t}),(function(e){return n=t.onElementChanged(function(t){return c.onAdded=r?t:void 0,c.onRemoved=a?t:void 0,c.onUpdated=s?t:void 0,c}(e))}),(function(t){n&&n.cancel()}))}},function(t,e,n){"use strict";n.d(e,"c",(function(){return i})),n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return a}));var r=n(20);function i(t){return{x:t.x,y:t.y,z:t.z}}function o(t){return{x:t.x||t._x,y:t.y||t._y,z:t.z||t._z,w:t.w||t._w}}function a(t){return"#"+Object(r.k)(255*t.r,2,"0",16)+Object(r.k)(255*t.g,2,"0",16)+Object(r.k)(255*t.b,2,"0",16)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r,i,o=n(71),a=n(2),s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(){return(c=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},u=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},l=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},h=new a.a("session");!function(t){t.WS3_Config="WS3_Config",t.WS3_Sweeps="WS3_Sweeps",t.WS3_Measurements="WS3_Measurements",t.Model="Model",t.FloorNames="FloorNames",t.Sweeps="Sweeps",t.Highlights="Highlights",t.Labels="Labels",t.Mattertags="Mattertags"}(i||(i={}));var f=function(t){function e(e,n){var r=t.call(this,e)||this;return r.config=e,r.sessionKey=n,r}return s(e,t),e.prototype.create=function(t){return u(this,void 0,Promise,(function(){return l(this,(function(t){throw Error("Not implemented")}))}))},e.prototype.update=function(t,e){return u(this,void 0,Promise,(function(){var n,r,i,a,s,u;return l(this,(function(l){return n=this.config,r=n.serialize,i=n.adapter,a=r?r(t,e):t,(s=i?i.encode(a):a)?(this.config.cachedData||(this.config.cachedData={data:{}}),this.config.cachedData.data||(this.config.cachedData.data={}),this.config.cachedData.data[this.sessionKey]||(this.config.cachedData.data[this.sessionKey]={}),this.config.cachedData.data[this.sessionKey]=s,u=c({},this.options,{body:this.config.cachedData.data[this.sessionKey]}),[2,this.config.queue.request(this.config.httpMethod||o.a.POST,this.config.path+"/"+this.sessionKey,u)]):(h.info("not updating",{data:t,diff:e,newData:s}),[2])}))}))},e.prototype.delete=function(t){return u(this,void 0,Promise,(function(){var t;return l(this,(function(e){return this.config.cachedData&&this.config.cachedData.data&&(this.config.cachedData.data[this.sessionKey]={}),t=c({},this.options,{responseType:""}),[2,this.config.queue.delete(this.config.path+"/"+this.sessionKey,t)]}))}))},e}(o.d);e.b=f},function(t,e,n){var r;function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(){"use strict";var o={}.hasOwnProperty;function a(){for(var t=[],e=0;e<arguments.length;e++){var n=arguments[e];if(n){var r=i(n);if("string"===r||"number"===r)t.push(n);else if(Array.isArray(n))t.push(a.apply(null,n));else if("object"===r)for(var s in n)o.call(n,s)&&n[s]&&t.push(s)}}return t.join(" ")}t.exports?t.exports=a:"object"===i(n(341))&&n(341)?void 0===(r=function(){return a}.apply(e,[]))||(t.exports=r):window.classNames=a}()},,function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r,i=n(23),o=n(84),a=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},c=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},u=function(t){function e(e){var n,r,i=t.call(this)||this;if(i.name="tag",i.mattertags=Object(o.b)(),e)try{for(var a=c(e),s=a.next();!s.done;s=a.next()){var u=s.value;i.mattertags.set(u.sid,u)}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return i.commit(),i}return a(e,t),e.prototype.clear=function(){var t,e;try{for(var n=c(this.mattertags),r=n.next();!r.done;r=n.next()){var i=r.value;this.removeTag(i.sid)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},e.prototype.clone=function(){return(new e).copy(this)},e.prototype.copy=function(t){return e.copyTagCollection(this,t),this},e.copyTagCollection=function(t,e){var n,r,i,o,a=t.mattertags,s=e.mattertags;try{for(var u=c(a.keys),l=u.next();!l.done;l=u.next()){var h=l.value;s.has(h)||t.removeTag(h)}}catch(t){n={error:t}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}try{for(var f=c(s),p=f.next();!p.done;p=f.next()){var d=p.value;t.addTag(d)}}catch(t){i={error:t}}finally{try{p&&!p.done&&(o=f.return)&&o.call(f)}finally{if(i)throw i.error}}},Object.defineProperty(e.prototype,"collection",{get:function(){return this.mattertags},enumerable:!0,configurable:!0}),e.prototype.addTag=function(t){this.mattertags.has(t.sid)?this.mattertags.get(t.sid).copy(t):this.mattertags.set(t.sid,t.clone())},e.prototype.removeTag=function(t){return this.mattertags.delete(t)},e.prototype.getTag=function(t){return this.mattertags.get(t)},e.prototype.getTagList=function(){return this.mattertags.keys},e.prototype.getTagCount=function(){return this.mattertags.length},e.prototype.iterate=function(t){var e,n;try{for(var r=c(this.mattertags),i=r.next();!i.done;i=r.next()){t(i.value)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},e.prototype[Symbol.iterator]=function(){var t,e,n,r,i;return s(this,(function(o){switch(o.label){case 0:o.trys.push([0,5,6,7]),n=c(this.mattertags),r=n.next(),o.label=1;case 1:return r.done?[3,4]:[4,r.value];case 2:o.sent(),o.label=3;case 3:return r=n.next(),[3,1];case 4:return[3,7];case 5:return i=o.sent(),t={error:i},[3,7];case 6:try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}return[7];case 7:return[2]}}))},e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(0),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.raycastEnabled=!0,e}return o(e,t),e}(i.lb)},function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return c}));var r,i=n(0),o=n(23),a=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="pointer",e.hit=null,e.hits=[],e.pointerNdcPosition=new i.Ic,e.pointerScreenPosition=new i.Ic,e.pointerOrigin=new i.Jc,e.pointerDirection=new i.Jc,e.pointerRay=new i.dc,e}return a(e,t),e}(o.a),c=function(t,e,n,r){this.point=t,this.normal=e,this.object=n,this.intersection=r,this.face={normal:e}}},function(t,e,n){"use strict";var r,i=n(0),o=n(80),a=n(81),s=n(83);e.a={cube:{uniforms:{map:{type:"t",value:null},opacity:{type:"f",value:1}},vertexShader:a+n(844),fragmentShader:o+n(845)},modelChunk:{uniforms:(r={},r[s.a.MeshTexture]={map:{type:"t",value:null},meshOpacity:{type:"f",value:0},opacity:{type:"f",value:1},transparentDiscardDist:{type:"f",value:0}},r[s.a.PanoTexture]={pano0Map:{type:"t",value:null},pano0Position:{type:"v3",value:new i.Jc},pano0Matrix:{type:"m4",value:new i.jb},panoOpacity:{type:"f",value:1}},r[s.a.PanoTextureTransition]={progress:{type:"f",value:0},pano1Map:{type:"t",value:null},pano1Position:{type:"v3",value:new i.Jc},pano1Matrix:{type:"m4",value:new i.jb}},r[s.a.ColorOverlay]={colorOverlay:{type:"v4",value:null}},r[s.a.MeshPreviewSphere]={meshPreviewCenter:{type:"v3",value:null},meshPreviewSize:{type:"f",value:.3}},r[s.a.Wireframe]={time:{type:"f",value:0},fill:{type:"c",value:new i.s(16711680)},stroke:{type:"c",value:new i.s(16777215)},dualStroke:{type:"b",value:!1},fillEnabled:{type:"b",value:!1},insideAltColor:{type:"b",value:!1},thickness:{type:"f",value:.1},secondThickness:{type:"f",value:.1},dashEnabled:{type:"b",value:!1},dashRepeats:{type:"f",value:10},dashOverlap:{type:"b",value:!1},dashLength:{type:"f",value:.1,range:[0,1]},dashAnimate:{type:"b",value:!1},squeeze:{type:"b",value:!1},squeezeMin:{type:"f",value:.1},squeezeMax:{type:"f",value:1},wireframeOpacity:{type:"f",value:1,range:[0,1]}},r),vertexShader:a+n(846),fragmentShader:o+n(847)},modelOutside:{uniforms:{map:{type:"t",value:null},opacity:{type:"f",value:1},colorOverlay:{type:"v4",value:new i.Kc(0,0,0,0)}},vertexShader:a+n(848),fragmentShader:o+n(849)},depth:{uniforms:{opacity:{type:"f",value:1},maxDistance:{type:"f",value:20}},vertexShader:a+n(850),fragmentShader:o+n(851)}}},function(t,e,n){"use strict";n.d(e,"c",(function(){return a})),n.d(e,"d",(function(){return s})),n.d(e,"f",(function(){return c})),n.d(e,"a",(function(){return u})),n.d(e,"e",(function(){return l})),n.d(e,"b",(function(){return h}));var r,i=n(9),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(i.a),s=function(t){function e(e){var n=t.call(this)||this;return n.index=e,n}return o(e,t),e}(i.a),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(i.a),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(i.a),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(i.a),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(i.a)},function(t,e,n){"use strict";var r,i=n(214),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(i.a);e.a=a},function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return s}));var r=n(108),i=function(t){return t instanceof r.a},o=function(t){return i(t)},a=function(t){return i(t)&&t.raycastEnabled&&t.visible},s=function(t){return!o(t)&&t.visible||a(t)}},function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return y}));var r,i,o=n(23),a=n(124),s=n(38),c=n(22),u=n(40),l=n(84),h=n(69),f=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),p=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.visible=!0,e.animation=new a.a(0),e}return f(e,t),e}(h.a);!function(t){t[t.CLOSED=0]="CLOSED",t[t.IDLE=1]="IDLE",t[t.PRESSING=2]="PRESSING",t[t.PLACING=3]="PLACING",t[t.MOVING=4]="MOVING",t[t.ROTATING=5]="ROTATING",t[t.ROTATED=6]="ROTATED"}(i||(i={}));var y=function(t){function e(e){var n=t.call(this)||this;n.data=e,n.name="sweeps-view",n.states=new l.a,n.toolStateObservable=Object(s.b)(i.CLOSED),n.selectCurrentSweep=function(){n.setSelectedSweep(n.data.currentSweep||null)},n.derivedData={},n.selectedSweepObservable=new s.a(null);var r=[i.MOVING,i.PLACING,i.PRESSING,i.ROTATING];return e.makeSweepChangeSubscription((function(){r.includes(n.toolState)||n.selectCurrentSweep()})),e.iterate((function(t){var e=new d;n.states.set(t.id,e),e.commit()})),n.updateViewData(),n}return f(e,t),e.prototype.updateViewData=function(){var t=this;this.data.iterate((function(e,n){t.derivedData[e.id]=t.makeViewDataForSweep(e,n)})),this.commit()},Object.defineProperty(e.prototype,"selectedSweep",{get:function(){return this.selectedSweepObservable.value},enumerable:!0,configurable:!0}),e.prototype.setSelectedSweep=function(t){this.selectedSweepObservable.value=t},e.prototype.onSelectedSweepChanged=function(t,e){void 0===e&&(e=!1);var n=this.selectedSweepObservable.onChanged(t);return e&&n.renew(),n},e.prototype.setToolState=function(t){t===i.PLACING&&this.selectedSweep&&this.setSelectedSweep(null),this.toolStateObservable.value=t},Object.defineProperty(e.prototype,"toolState",{get:function(){return this.toolStateObservable.value},enumerable:!0,configurable:!0}),e.prototype.onToolStateChanged=function(t,e){void 0===e&&(e=!1);var n=this.toolStateObservable.onChanged(t);return e&&n.renew(),n},e.prototype.getSweep=function(t){return this.data.getSweep(t)},e.prototype.makeViewDataForSweep=function(t,e){var n=this.derivedData[t.id];return n?(n.floor=t.floor,n.position=t.position,n.alignmentType=t.alignmentType,n.placed=t.placementType===c.b.MANUAL,n.enabled=t.enabled,n.name=t.name,n):{id:t.id,floor:t.floor,position:t.position,index:t.index,alignmentType:t.alignmentType,dataIndex:e,placed:t.placementType===c.b.MANUAL,enabled:t.enabled,name:t.name}},e.prototype.getViewData=function(t){var e=this.data.getSweep(t),n=this.derivedData[t];return e&&!n&&(this.derivedData[t]=this.makeViewDataForSweep(e,e.index)),this.derivedData[t]},e.prototype.isSweepAligned=function(t){return this.data.isSweepAligned(t)},e.prototype.iterate=function(t){this.data.iterate(t)},e.prototype.getState=function(t){return this.states.get(t)},e.prototype.isVisible=function(t){return this.states.get(t).visible},e.prototype.setVisible=function(t,e){var n=this.getState(t);n.visible!==e&&(n.visible=e,n.commit())},e.prototype.updateAnimations=function(t){var e,n;try{for(var r=p(this.states),i=r.next();!i.done;i=r.next()){i.value.animation.tick(t)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},e.prototype.modifySelectAnimation=function(t,e,n){var r=this.getState(t).animation,i=1===r.endValue;e!==i&&(i?r.modifyAnimation(r.value,0,n):r.modifyAnimation(0,1,n))},e.prototype.getIndexByAlignment=function(t,e){return this.getAlignedSweeps(t).findIndex((function(t){return t.id===e}))},e.prototype.getAlignedSweeps=function(t){var e=Object.values(this.derivedData);return t?e.filter(Object(u.b)()):e.filter(Object(u.h)())},e}(o.a)},function(t,e,n){"use strict";n.d(e,"d",(function(){return a})),n.d(e,"b",(function(){return s})),n.d(e,"e",(function(){return c})),n.d(e,"c",(function(){return u})),n.d(e,"a",(function(){return l}));var r,i=n(5),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.id="RequestRenderTargetCommand",e}return o(e,t),e}(i.a),s=function(t){function e(e,n){var r=t.call(this)||this;return r.payload={renderTarget:e,context:n},r}return o(e,t),e}(i.a),c=function(t){function e(e,n,r){var i=t.call(this)||this;return i.payload={renderTarget:e,sceneObject:n,camera:r},i}return o(e,t),e}(i.a),u=function(t){function e(e,n,r){void 0===r&&(r=0);var i=t.call(this)||this;return i.payload={renderTarget:e,texture:n,heading:r},i}return o(e,t),e}(i.a),l=function(t){function e(e,n){var r=t.call(this)||this;return r.payload={target1:e,target2:n},r}return o(e,t),e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(5),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n,r,i){void 0===n&&(n=!1);var o=t.call(this)||this;return o.id="MOVETO_FLOOR",o.payload={floor:e,suppressCameraMovement:n,transitionTime:r,focusPoint:i},o}return o(e,t),e}(i.a)},function(t,e,n){"use strict";n.d(e,"c",(function(){return r})),n.d(e,"b",(function(){return i})),n.d(e,"d",(function(){return o})),n.d(e,"a",(function(){return a}));var r="features/measurements",i="features/measurements-saved",o="tools/measurements",a="features/measurements-nudge"},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(26),a=n(2),s=n(581),c=(n(49),n(6)),u=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},h=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},f=new a.a("Locale"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="locale",e._languageCode="en-US",e}return u(e,t),e.prototype.init=function(t,n){return l(this,void 0,void 0,(function(){var r,i,a,u,l,p;return h(this,(function(h){switch(h.label){case 0:return[4,n.market.waitForData(o.a)];case 1:return r=h.sent(),i=r.tryGetProperty("lang",Object(c.f)()),e.languageCodeMap.hasOwnProperty(i)&&(this._languageCode=e.languageCodeMap[i]),a=this._languageCode.substr(0,2),this.polyglot=new s({locale:a,interpolation:{prefix:"%{",suffix:"}"},onMissingKey:function(t){return f.warn("Missing phrase key:"+t),e.missingPrefix+t}}),u="./locale/strings-"+this._languageCode+".json",[4,t.queue.get(u)];case 2:return l=h.sent(),p=JSON.parse(l),this.polyglot.extend(p),f.info("Loaded phrases - "+u+" for "+a),[2]}}))}))},e.prototype.t=function(t,e){return this.polyglot.t(t,e)},Object.defineProperty(e.prototype,"languageCode",{get:function(){return this._languageCode},enumerable:!0,configurable:!0}),e.languageCodeMap={en:"en-US",es:"es-MX",fr:"fr-FR",de:"de-DE",ru:"ru-RU",ja:"ja-JP",zh:"zh-CN",ko:"ko-KR",nl:"nl-NL",it:"it-IT",pt:"pt-BR",cn:"zh-CN",jp:"ja-JP"},e.missingPrefix="FIX-",e}(i.a);e.default=p},function(t,e,n){"use strict";n.d(e,"d",(function(){return s})),n.d(e,"c",(function(){return c})),n.d(e,"b",(function(){return u})),n.d(e,"e",(function(){return l})),n.d(e,"a",(function(){return h}));var r=n(0),i=-1,o=10,a=5,s=function(t,e){return void 0===e&&(e=i),function(n){return t.distanceToSquared(n.position)*e}},c=function(t,e){return void 0===e&&(e=i),function(n){return t.distanceTo(n.position)*e}},u=function(t,e,n){void 0===n&&(n=o);var i=new r.Jc;return function(r){return i.copy(r.position).sub(t).normalize().dot(e)*n}},l=function(t,e){return void 0===e&&(e=i),function(n){return t.distanceToSquared(n.floorPosition)*e}},h=function(t,e){return void 0===e&&(e=a),function(e){return t===e.floor?a:0}}},function(t,e,n){"use strict";var r,i=n(0),o=n(110),a=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},c=function(t){function e(e,n,r){var i,a,c=this,u={};try{for(var l=s(n),h=l.next();!h.done;h=l.next()){u[h.value]=!0}}catch(t){i={error:t}}finally{try{h&&!h.done&&(a=l.return)&&a.call(l)}finally{if(i)throw i.error}}return(c=t.call(this,{extensions:{derivatives:!0},fragmentShader:o.a.modelChunk.fragmentShader,vertexShader:o.a.modelChunk.vertexShader,uniforms:r,name:e,defines:u})||this).capabilities=n,c}return a(e,t),e}(i.cc),u=n(83),l=n(358),h=n(20);n.d(e,"b",(function(){return f})),n.d(e,"a",(function(){return m}));var f,p=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},d=1,y=[{key:u.a.PanoTextureTransition,enabled:function(t){return t.progress.value>0&&t.progress.value<1&&t.pano0Map.value!==t.pano1Map.value},dependsOn:[u.a.PanoTexture]},{key:u.a.PanoTexture,enabled:function(t){return t.panoOpacity.value>0},dependsOn:[]},{key:u.a.ColorOverlay,enabled:function(t){return null!==t.colorOverlay.value},dependsOn:[]},{key:u.a.MeshPreviewSphere,enabled:function(t){return null!==t.meshPreviewCenter.value},dependsOn:[u.a.MeshTexture]},{key:u.a.MeshTexture,enabled:function(t){return t.meshOpacity.value>0&&t.map.value},dependsOn:[]},{key:u.a.Wireframe,enabled:function(t){return!1},dependsOn:[]},{key:u.a.FlatShading,enabled:function(t){return!1},dependsOn:[]}];!function(t){t[t.Standard=0]="Standard",t[t.Depth=1]="Depth",t[t.Transparent=2]="Transparent",t[t.Wireframe=3]="Wireframe"}(f||(f={}));var m=function(){function t(t,e,n,r){void 0===r&&(r="");var a,s,c=this;this.floorIndex=t,this.roomIndex=e,this.geometry=n,this.textureName=r,this.id=d++,this.renderingMode=f.Standard,this.chunkMaterials={},this.modeMaterials={},this.capabilityOverrides={},this.uniformCache=this.getUniformDefaults(),this.setProjectedPano=(a=new i.jb,s=new i.Pb,function(t,e,n,r){if(r){var i=1===t?"pano1Map":"pano0Map";c.setMaterialsUniform(i,r)}e&&(i=1===t?"pano1Position":"pano0Position",c.setMaterialsUniform(i,e)),n&&e&&(i=1===t?"pano1Matrix":"pano0Matrix",a.makeRotationFromQuaternion(s.copy(n).inverse()),c.setMaterialsUniform(i,a))}),this.modeMaterials[f.Standard]=this.getChunkMaterial(this.getCapabilities()),this._material=this.modeMaterials[f.Standard];var u=i.Bc.clone(o.a.depth.uniforms);this.modeMaterials[f.Depth]=new i.cc({fragmentShader:o.a.depth.fragmentShader,vertexShader:o.a.depth.vertexShader,uniforms:u,side:i.G,name:"materialDepth"});var l=i.Bc.clone(o.a.modelOutside.uniforms);l.opacity.value=.2,this.modeMaterials[f.Transparent]=new i.cc({fragmentShader:o.a.modelOutside.fragmentShader,vertexShader:o.a.modelOutside.vertexShader,uniforms:l,side:i.G,transparent:!0,name:"materialTransparent"});var h=i.Bc.clone(o.a.modelOutside.uniforms);h.opacity.value=.5,h.colorOverlay.value.set(1,1,1,1),this.modeMaterials[f.Wireframe]=new i.cc({fragmentShader:o.a.modelOutside.fragmentShader,vertexShader:o.a.modelOutside.vertexShader,uniforms:h,side:i.G,transparent:!0,wireframe:!0,name:"materialWireframe"})}return t.prototype.getUniformDefaults=function(){var t={};for(var e in o.a.modelChunk.uniforms){var n=i.Bc.clone(o.a.modelChunk.uniforms[e]);for(var r in n)t[r]=n[r]}return t},Object.defineProperty(t.prototype,"material",{get:function(){return this._material},set:function(t){this._material!==t&&this.onMaterialUpdate&&this.onMaterialUpdate(t),this._material=t},enumerable:!0,configurable:!0}),t.prototype.setMeshTexture=function(t){this.setMaterialsUniform("map",t)},t.prototype.setColorOverlay=function(t){this.setMaterialsUniform("colorOverlay",t)},t.prototype.setMeshTextureOpacity=function(t){this.setMaterialsUniform("meshOpacity",t),this.setMaterialsUniform("panoOpacity",1-t)},t.prototype.setProgress=function(t){this.setMaterialsUniform("progress",t)},t.prototype.setOpacity=function(t){this.setMaterialsUniform("opacity",t)},t.prototype.setTime=function(t){this.renderingMode===f.Wireframe&&this.setMaterialsUniform("time",t)},t.prototype.setTransparentDiscard=function(t){this.setMaterialsUniform("transparentDiscardDist",t)},t.prototype.setMeshPreviewSphere=function(t,e){void 0===e&&(e=.3),this.setMaterialsUniform("meshPreviewCenter",t),this.setMaterialsUniform("meshPreviewSize",e)},t.prototype.setWireframe=function(t){t&&(this.geometry.getIndex()&&this.geometry.copy(this.geometry.toNonIndexed()),Object(l.a)(this.geometry)),this.overrideCapability(u.a.Wireframe,t)},t.prototype.setFlatShading=function(t){t&&this.geometry.computeVertexNormals(),this.overrideCapability(u.a.FlatShading,t)},t.prototype.getCapabilities=function(){var t,e,n,r,i=new Set;for(var o in this.capabilityOverrides)this.capabilityOverrides[o]&&i.add(o);try{for(var a=p(y),s=a.next();!s.done;s=a.next()){var c=s.value;if(!i.has(c.key)&&c.enabled(this.uniformCache)){i.add(c.key);try{for(var u=p(c.dependsOn),l=u.next();!l.done;l=u.next()){var h=l.value;i.add(h)}}catch(t){n={error:t}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}return i},t.prototype.overrideCapability=function(t,e){this.capabilityOverrides[t]=e,this.updateMaterialCapabilities()},t.prototype.updateMaterialCapabilities=function(){var t=this.getCapabilities(),e=this.modeMaterials[f.Standard];if(!Object(h.f)(e.capabilities,t)){var n=this.getChunkMaterial(t);n.side=e.side,n.transparent=e.transparent,n.depthWrite=e.depthWrite,this.modeMaterials[f.Standard]=n,this.renderingMode===f.Standard&&(this.material=n)}},t.prototype.getChunkMaterial=function(t){var e,n,r="chunkMaterial_";try{for(var i=p(y),o=i.next();!o.done;o=i.next()){var a=o.value;r+=t.has(a.key)?"1":"0"}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return this.chunkMaterials[r]||(this.chunkMaterials[r]=new c(r,t,this.getUniformsForCapabilities(t))),this.chunkMaterials[r]},t.prototype.getUniformsForCapabilities=function(t){var e,n,r={};try{for(var i=p(t),a=i.next();!a.done;a=i.next()){var s=a.value,c=o.a.modelChunk.uniforms[s];for(var u in c)r[u]=this.uniformCache[u]}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r},t.prototype.setMaterialsUniform=function(t,e){var n=this.uniformCache[t];n.value!==e&&(e&&(e.isVector3||e.isVector4||e.isMatrix3||e.isMatrix4||e.isColor)?null===n.value?n.value=e.clone():n.value.copy(e):n.value=e,this.updateMaterialCapabilities())},t.prototype.setRenderingMode=function(t){this.renderingMode=t,this.material=this.modeMaterials[t]},t.prototype.setSide=function(t){for(var e in this.chunkMaterials)this.chunkMaterials[e].side=t},t.prototype.forEachMaterial=function(t){for(var e in this.chunkMaterials)t(this.chunkMaterials[e])},t}()},function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"e",(function(){return o})),n.d(e,"d",(function(){return a})),n.d(e,"a",(function(){return s})),n.d(e,"c",(function(){return c}));var r=n(0),i=1e3/60,o=r.ib.degToRad(70),a=-o,s=.05,c=.1/60},function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.Immediate=0]="Immediate",t[t.NextFrame=1]="NextFrame",t[t.Duration=2]="Duration",t[t.Manual=3]="Manual"}(r||(r={}))},function(t,e,n){"use strict";var r=n(0),i=n(43),o=n(161),a=n(108),s=n(42),c=function(){function t(t){this.maxEdgeLength=t}return t.prototype.modify=function(t){for(var e,n=[],i=[],o=this.maxEdgeLength*this.maxEdgeLength,a=0,s=t.faceVertexUvs.length;a<s;a++)i[a]=[];for(a=0,s=t.faces.length;a<s;a++){var c=t.faces[a];if(c instanceof r.C){var u=c.a,l=c.b,h=c.c,f=t.vertices[u],p=t.vertices[l],d=t.vertices[h],y=f.distanceToSquared(p),m=p.distanceToSquared(d),v=f.distanceToSquared(d);if(y>o||m>o||v>o){var g=void 0,b=t.vertices.length,w=c.clone(),_=c.clone();if(y>=m&&y>=v){if((g=f.clone()).lerp(p,.5),w.a=u,w.b=b,w.c=h,_.a=b,_.b=l,_.c=h,3===c.vertexNormals.length)(x=c.vertexNormals[0].clone()).lerp(c.vertexNormals[1],.5),w.vertexNormals[1].copy(x),_.vertexNormals[0].copy(x);if(3===c.vertexColors.length)(S=c.vertexColors[0].clone()).lerp(c.vertexColors[1],.5),w.vertexColors[1].copy(S),_.vertexColors[0].copy(S);e=0}else if(m>=y&&m>=v){if((g=p.clone()).lerp(d,.5),w.a=u,w.b=l,w.c=b,_.a=b,_.b=h,_.c=u,3===c.vertexNormals.length)(x=c.vertexNormals[1].clone()).lerp(c.vertexNormals[2],.5),w.vertexNormals[2].copy(x),_.vertexNormals[0].copy(x),_.vertexNormals[1].copy(c.vertexNormals[2]),_.vertexNormals[2].copy(c.vertexNormals[0]);if(3===c.vertexColors.length)(S=c.vertexColors[1].clone()).lerp(c.vertexColors[2],.5),w.vertexColors[2].copy(S),_.vertexColors[0].copy(S),_.vertexColors[1].copy(c.vertexColors[2]),_.vertexColors[2].copy(c.vertexColors[0]);e=1}else{var x,S;if((g=f.clone()).lerp(d,.5),w.a=u,w.b=l,w.c=b,_.a=b,_.b=l,_.c=h,3===c.vertexNormals.length)(x=c.vertexNormals[0].clone()).lerp(c.vertexNormals[2],.5),w.vertexNormals[2].copy(x),_.vertexNormals[0].copy(x);if(3===c.vertexColors.length)(S=c.vertexColors[0].clone()).lerp(c.vertexColors[2],.5),w.vertexColors[2].copy(S),_.vertexColors[0].copy(S);e=2}n.push(w,_),t.vertices.push(g);for(var T=0,M=t.faceVertexUvs.length;T<M;T++)if(t.faceVertexUvs[T].length){var E=t.faceVertexUvs[T][a],P=E[0],O=E[1],A=E[2],D=void 0,R=void 0;if(0===e)(C=P.clone()).lerp(O,.5),D=[P.clone(),C.clone(),A.clone()],R=[C.clone(),O.clone(),A.clone()];else if(1===e){(C=O.clone()).lerp(A,.5),D=[P.clone(),O.clone(),C.clone()],R=[C.clone(),A.clone(),P.clone()]}else{var C;(C=P.clone()).lerp(A,.5),D=[P.clone(),O.clone(),C.clone()],R=[C.clone(),O.clone(),A.clone()]}i[T].push(D,R)}}else{n.push(c);for(T=0,M=t.faceVertexUvs.length;T<M;T++)i[T].push(t.faceVertexUvs[T][a])}}}t.faces=n,t.faceVertexUvs=i},t}(),u=n(46);n.d(e,"a",(function(){return p}));var l,h=(l=function(t,e){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),f=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},p=function(t){function e(e,n,r){void 0===r&&(r=i.a.ALL);var o=t.call(this)||this;return o.floorIndex=e,o.roomIndex=n,o._opacity=1,o._chunks=[],o.built=!1,o._fadeDist=0,o.layers.mask=r.mask,o.name="RoomMesh:"+e+"-"+n,o.renderOrder=s.a.default,o}return h(e,t),e.prototype.addChunk=function(t){-1===this._chunks.indexOf(t)&&this._chunks.push(t)},e.prototype.getChunk=function(t){return this._chunks[t]},e.prototype.build=function(){var t=this;if(this.built)throw new Error("build() should only be called once");var e=Object(o.b)(this._chunks.map((function(t){return t.geometry})));e.clearGroups();var n=0;this._chunks.forEach((function(r,i){r.geometry&&r.geometry.index&&(e.addGroup(n,r.geometry.index.count,i),n+=r.geometry.index.count,r.geometry.dispose(),r.geometry=e,r.onMaterialUpdate=function(e){t.material[i]=e})})),this.geometry=e,this.material=this._chunks.map((function(t){return t.material})),this.size=this.boundingBox.getSize(new r.Jc),this.center=this.boundingBox.getCenter(new r.Jc),this.built=!0},e.prototype.tessellate=function(t){for(var e=new c(t),n=(new r.I).fromBufferGeometry(this.geometry),i=0;n.faces.length!==i;)i=n.faces.length,e.modify(n);this.geometry=(new r.m).fromGeometry(n)},Object.defineProperty(e.prototype,"boundingBox",{get:function(){return Object(o.a)(this.geometry)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"opacity",{get:function(){return this._opacity},set:function(t){var e,n;if(t!==this.opacity){this._opacity=t,this.raycastEnabled=t>u.a.FADE_CLICKABLE_THRESHOLD,this.renderOrder=t<u.a.FADE_OPAQUE?s.a.ghostFloor:s.a.default;try{for(var r=f(this.chunks),i=r.next();!i.done;i=r.next()){var o=i.value;o.material.transparent=t<u.a.FADE_OPAQUE,o.material.depthWrite=t>u.a.FADE_IN_VALUE+u.a.FADE_IN_HOVER_BOOST_VALUE,o.setOpacity(t)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"transparentFadeDist",{get:function(){return this._fadeDist},set:function(t){var e,n;if(t!==this.transparentFadeDist){this._fadeDist=t;try{for(var r=f(this.chunks),i=r.next();!i.done;i=r.next()){i.value.setTransparentDiscard(t)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"chunks",{get:function(){return this._chunks},enumerable:!0,configurable:!0}),e}(a.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r,i=n(57),o=n(69),a=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(t){function e(e,n,r,o,a){void 0===o&&(o=i.i),void 0===a&&(a=0);var s=t.call(this)||this;return s._easing=i.i,void 0===n&&(n=e),void 0===r&&(s._active=!1,r=0,s._elapsed=0,s._duration=0),s.modifyAnimation(e,n,r,o,0,a),s}return a(e,t),Object.defineProperty(e.prototype,"active",{get:function(){return this._active},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this._duration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endValue",{get:function(){return this._endValue},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"easing",{get:function(){return this._easing},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"elapsed",{get:function(){return this._elapsed},enumerable:!0,configurable:!0}),e.prototype.tick=function(t){if(!this._active)return this.endValue;if(this._delay>0)return this._delay-=t,this.startValue;var e=(this._elapsed+t)/Math.max(this._duration,1e-5);return this.updateProgress(e),this.value},e.prototype.updateProgress=function(t){if(isNaN(t)||t<0)throw Error("Invalid progress value: "+t);var e=this.active,n=this.value;if(t>=1)return this.activate(!1),this.value=this.endValue,this._elapsed=this.duration,void this.commit();this.activate(!0),this.value=this._easing(t,this.startValue,this._endValue-this.startValue,1),this._elapsed=t*this.duration,n===this.value&&e===this.active||this.commit()},e.prototype.updateAbsolute=function(t){var e=t/Math.max(this._duration,1e-5);this.updateProgress(e)},e.prototype.modifyAnimation=function(t,e,n,r,o,a){void 0===r&&(r=i.i),void 0===o&&(o=0),void 0===a&&(a=0),this._easing=r,this._endValue=e,this._duration=n,this.activate(this._duration>=0&&t!==e),this._elapsed=o,this._delay=a,this.startValue=t,this.value=t,this.commit()},e.prototype.activate=function(t){this._active=t},e.prototype.copy=function(t){this._endValue=t.endValue,this._duration=t.duration,this._active=t.active,this._easing=t.easing,this._elapsed=t.elapsed,this.startValue=t.startValue,this.value=t.value,this.commit()},e.prototype.clone=function(){var t=new e(0);return t.copy(this),t},e.prototype.stop=function(t){this._active=!1,this._elapsed=this._duration,this.value=t,this._endValue=t,this.commit()},e.prototype.equals=function(t){return this._active===t._active&&this.duration===t.duration&&this.easing===t.easing&&this.elapsed===t.elapsed&&this.endValue===t.endValue&&this.startValue===t.startValue&&this.value===t.value},e}(o.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},i=function(){function t(){this.isObservable=!0,this._dirtyObservable=!1,this._activeObservable=!0,this._observerNotifying=!1,this._changeObservers=new Set,this._parentObservables=new Set,this._childObservables=new Set,Object.defineProperties(this,{isObservable:{value:this.isObservable,writable:!1,enumerable:!1},_dirtyObservable:{value:this._dirtyObservable,enumerable:!1},_activeObservable:{value:this._activeObservable,enumerable:!1},_observerNotifying:{value:this._observerNotifying,enumerable:!1},_changeObservers:{value:this._changeObservers,writable:!1,enumerable:!1},_childObservables:{value:this._childObservables,writable:!1,enumerable:!1},_parentObservables:{value:this._parentObservables,writable:!1,enumerable:!1}})}return t.prototype.onChanged=function(t){var e=this;if(this._changeObservers.has(t))throw new Error("This observer function is already observing this Observable, and double subscriptions are not supported.");var n=function(){return e._changeObservers.add(t)};return n(),{renew:n,cancel:function(){return e.removeOnChanged(t)}}},t.prototype.removeOnChanged=function(t){this._changeObservers.delete(t)},t.prototype.notifyObservers=function(){var t,e;if(this._dirtyObservable&&!this._observerNotifying&&this._activeObservable){this._observerNotifying=!0;try{for(var n=r(this._changeObservers),i=n.next();!i.done;i=n.next()){var o=i.value;this.notifyObserver(o)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this._dirtyObservable=!1,this._observerNotifying=!1}},t.prototype.notifyObserver=function(t){t(void 0)},t.prototype.notifyDown=function(){var t,e;try{for(var n=r(this._childObservables),i=n.next();!i.done;i=n.next()){i.value.notifyDown()}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.notifyObservers()},t.prototype.notifyUp=function(){var t,e;try{for(var n=r(this._parentObservables),i=n.next();!i.done;i=n.next()){i.value.notifyUp()}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.notifyObservers()},t.prototype.setDirty=function(t){void 0===t&&(t=!0),this.setDirtyUp(),t&&this.notifyUp()},t.prototype.setDirtyUp=function(){var t,e;if(!this._dirtyObservable){this._dirtyObservable=!0;try{for(var n=r(this._parentObservables),i=n.next();!i.done;i=n.next()){i.value.setDirtyUp()}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}}},t.prototype.addChildObservable=function(e){t.isObservable(e)&&(this._childObservables.add(e),e._parentObservables.add(this))},t.prototype.removeChildObservables=function(e){t.isObservable(e)&&(this._childObservables.delete(e),e._parentObservables.delete(this))},t.prototype.atomic=function(t){if(!this._activeObservable)return t();try{this.setActive(!1),t()}finally{this.setActive(!0)}},t.prototype.setActive=function(t){var e,n,i=this._activeObservable;this._activeObservable=t,!i&&t&&this.notifyObservers();try{for(var o=r(this._childObservables),a=o.next();!a.done;a=o.next()){a.value.setActive(t)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}},t.prototype.deepCopy=function(){throw Error("deepCopy is only implemented in subclasses of Observable")},t.isObservable=function(t){return t&&t.isObservable},t}()},function(t,e,n){"use strict";var r,i,o=n(0),a=n(157),s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(t){function e(e,n){var r,i,s=t.call(this)||this;return s.type="Line",s.part=a.a.line,s.computeLineDistances=(r=new o.Jc,i=new o.Jc,function(){for(var t=s.geometry,e=t.attributes.instanceStart,n=t.attributes.instanceEnd,a=new Float32Array(2*e.data.count),c=0,u=0,l=e.data.count;c<l;c++,u+=2)r.fromBufferAttribute(e,c),i.fromBufferAttribute(n,c),a[u]=0===u?0:a[u-1],a[u+1]=a[u]+r.distanceTo(i);return s.instanceDistanceBuffer?(s.instanceDistanceBuffer.set(a,0),s.instanceDistanceBuffer.needsUpdate=!0):(s.instanceDistanceBuffer=new o.M(a,2,1),t.setAttribute("instanceDistanceStart",new o.P(s.instanceDistanceBuffer,1,0,!1)),t.setAttribute("instanceDistanceEnd",new o.P(s.instanceDistanceBuffer,1,1,!1))),s}),s.geometry=e,s.material=n,s}return s(e,t),e.prototype.copy=function(t){throw Error("not implemented")},e}(o.lb),u=n(28),l=n(54),h=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),f=function(t){function e(e,n,r,i){void 0===r&&(r=l.d.endpointSelected),void 0===i&&(i=l.d.endpointDefault);var o=t.call(this,e,n)||this;return o.selectedSize=r,o.defaultSize=i,o.currentSize=l.d.endpointDefault,o.currentSize=o.defaultSize,o.scale.set(l.b,l.b,l.b),o}return h(e,t),e.prototype.dispose=function(){this.material.dispose(),this.geometry.dispose()},e.prototype.billboardScale=function(t,e,n){var r=Object(u.a)(e,t,this.position,n,.5),i=Math.max(Math.min(1/r*this.currentSize,l.a),l.b);this.scale.set(i,i,i)},e.prototype.updateSelected=function(t){this.currentSize=t?this.selectedSize:this.defaultSize},e}(o.lb),p=n(80),d=n(81),y={endpoint:{uniforms:{opacity:{type:"f",value:1},color:{type:"c",value:new o.s},bg:{type:"t",value:null}},vertexShader:d+n(402),fragmentShader:p+n(819)},line:{uniforms:o.Bc.merge([o.Ac.common,o.Ac.fog,{linewidth:{value:4},resolution:{value:new o.Ic(window.innerWidth,window.innerHeight)},dashScale:{value:1},dashSize:{value:.025},gapSize:{value:.05},mask:{value:null}}]),vertexShader:n(820),fragmentShader:n(821)}},m=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),v=function(t){function e(e,n,r){var i=this,a=o.Bc.clone(y.endpoint.uniforms);return(i=t.call(this,{fragmentShader:y.endpoint.fragmentShader,vertexShader:y.endpoint.vertexShader,uniforms:a,name:"LineEndpointMaterial",transparent:!0,depthWrite:!1,depthTest:!0})||this).color=e,i.defaultTex=n,i.hoverTex=r,i.uniforms.bg.value=n,i.uniforms.color.value.copy(i.color),i}return m(e,t),e.prototype.clone=function(){return new e(this.color,this.defaultTex,this.hoverTex).copy(this)},Object.defineProperty(e.prototype,"opacity",{get:function(){return this.uniforms.opacity.value},set:function(t){this.uniforms&&t!==this.uniforms.opacity.value&&(this.uniforms.opacity.value=t)},enumerable:!0,configurable:!0}),e.prototype.updateHovered=function(t){var e=t?this.hoverTex:this.defaultTex;this.uniforms.bg.value!==e&&(this.uniforms.bg.value=e)},e}(o.cc),g=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),b=function(t){function e(e,n,r,i){void 0===i&&(i=l.d.lineSelected);var a=t.call(this)||this;return a.parameters=e,a.hoverTexture=n,a.defaultTexture=r,a.selectedWidth=i,a.type="LineMaterial",a.isLineMaterial=!0,a.defaultWidth=l.d.lineDefault,a.setValues({uniforms:o.Bc.clone(y.line.uniforms),vertexShader:y.line.vertexShader,fragmentShader:y.line.fragmentShader,transparent:!0,depthWrite:!1,depthTest:!0,opacity:1}),a.setValues(e),r&&(a.mask=r),a.defaultWidth=e&&e.linewidth?e.linewidth:l.d.lineDefault,a}return g(e,t),e.prototype.updateSelected=function(t){var e=t?this.hoverTexture:this.defaultTexture;e&&this.mask!==e&&(this.mask=e,this.linewidth=t?this.selectedWidth:this.defaultWidth)},Object.defineProperty(e.prototype,"linewidth",{get:function(){return this.uniforms.linewidth.value},set:function(t){this.uniforms.linewidth||(this.uniforms=o.Bc.clone(y.line.uniforms)),this.linewidth!==t&&(this.uniforms.linewidth.value=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this.uniforms.diffuse.value},set:function(t){this.uniforms.diffuse.value=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"opacity",{get:function(){return this.uniforms.opacity.value},set:function(t){this.uniforms||(this.uniforms=o.Bc.clone(y.line.uniforms)),this.opacity!==t&&(this.uniforms.opacity.value=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dashScale",{get:function(){return this.uniforms.dashScale.value},set:function(t){this.uniforms.dashScale.value=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dashed",{get:function(){return"USE_DASH"in this.defines},set:function(t){t?this.defines.USE_DASH="":delete this.defines.USE_DASH,this.needsUpdate=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dashSize",{get:function(){return this.uniforms.dashSize.value},set:function(t){this.uniforms.dashSize.value=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gapSize",{get:function(){return this.uniforms.gapSize.value},set:function(t){this.uniforms.gapSize.value=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"resolution",{get:function(){return this.uniforms.resolution.value},set:function(t){this.uniforms.resolution.value=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mask",{get:function(){return this.uniforms.mask.value},set:function(t){this.uniforms.mask.value!==t&&(t?this.defines.USE_MASK="":delete this.defines.USE_MASK,this.uniforms.mask.value=t,this.needsUpdate=!0)},enumerable:!0,configurable:!0}),e.prototype.copy=function(t){return o.ic.prototype.copy.call(this,t),this.parameters=t.parameters,this.color.copy(t.color),this.defaultWidth=t.defaultWidth,this.linewidth=t.linewidth,this.resolution.copy(t.resolution),this.defaultTexture=t.defaultTexture,this.hoverTexture=t.hoverTexture,this.mask=t.mask,this.opacity=t.opacity,this.dashed=t.dashed,this.dashScale=t.dashScale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this},e}(o.ic),w=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),_=function(t){function e(){var e=t.call(this)||this;e.type="LineSegmentsGeometry";return e.setIndex([0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5]),e.setAttribute("position",new o.E([-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],3)),e.setAttribute("uv",new o.E([0,1,.5,1,0,.5,.5,.5,0,0,.5,0,0,1,.5,1],2)),e}return w(e,t),e.prototype.applyMatrix=function(t){var e=this.attributes.instanceStart,n=this.attributes.instanceEnd;return void 0!==e&&(e.applyMatrix4(t),n.applyMatrix4(t),this.positionBuffer.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},e.prototype.setPositions=function(t){var e;return t instanceof Float32Array?e=t:Array.isArray(t)&&(e=new Float32Array(t)),e&&(this.positionBuffer?(this.positionBuffer.set(e,0),this.positionBuffer.needsUpdate=!0):(this.positionBuffer=new o.M(e,6,1),this.setAttribute("instanceStart",new o.P(this.positionBuffer,3,0,!1)),this.setAttribute("instanceEnd",new o.P(this.positionBuffer,3,3,!1))),this.computeBoundingBox(),this.computeBoundingSphere()),this},e.prototype.setColors=function(t){var e;return t instanceof Float32Array?e=t:Array.isArray(t)&&(e=new Float32Array(t)),e&&(this.colorBuffer?(this.colorBuffer.set(e,0),this.colorBuffer.needsUpdate=!0):(this.colorBuffer=new o.M(e,6,1),this.setAttribute("instanceColorStart",new o.P(this.colorBuffer,3,0,!1)),this.setAttribute("instanceColorEnd",new o.P(this.colorBuffer,3,3,!1)))),this},e.prototype.fromWireframeGeometry=function(t){return this.setPositions(t.attributes.position.array),this},e.prototype.fromEdgesGeometry=function(t){return this.setPositions(t.attributes.position.array),this},e.prototype.fromMesh=function(t){return this.fromWireframeGeometry(new o.Pc(t.geometry)),this},e.prototype.fromLineSegements=function(t){var e=t.geometry;return e instanceof o.I?this.setPositions(e.vertices):e instanceof o.m&&this.setPositions(e.position.array),this},e.prototype.computeBoundingBox=function(){this.boundingBox||(this.boundingBox=new o.h),this.box||(this.box=new o.h);var t=this.attributes.instanceStart,e=this.attributes.instanceEnd;void 0!==t&&void 0!==e&&(this.boundingBox.setFromBufferAttribute(t),this.box.setFromBufferAttribute(e),this.boundingBox.union(this.box))},e.prototype.computeBoundingSphere=function(){this.tempVector||(this.tempVector=new o.Jc),this.boundingSphere||(this.boundingSphere=new o.mc),this.boundingBox||this.computeBoundingBox();var t=this.attributes.instanceStart,e=this.attributes.instanceEnd;if(void 0!==t&&void 0!==e){var n=this.boundingSphere.center;this.boundingBox.getCenter(n);for(var r=0,i=0,a=t.count;i<a;i++)this.tempVector.fromBufferAttribute(t,i),r=Math.max(r,n.distanceToSquared(this.tempVector)),this.tempVector.fromBufferAttribute(e,i),r=Math.max(r,n.distanceToSquared(this.tempVector));this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error("computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}},e}(o.L),x=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),S=function(t){function e(){var e=t.call(this)||this;return e.type="LineGeometry",e.isLineGeometry=!0,e}return x(e,t),e.prototype.setPositions=function(t){for(var e=t.length-3,n=new Float32Array(2*e),r=0;r<e;r+=3)n[2*r]=t[r],n[2*r+1]=t[r+1],n[2*r+2]=t[r+2],n[2*r+3]=t[r+3],n[2*r+4]=t[r+4],n[2*r+5]=t[r+5];return _.prototype.setPositions.call(this,n),this},e.prototype.setColors=function(t){for(var e=t.length-3,n=new Float32Array(2*e),r=0;r<e;r+=3)n[2*r]=t[r],n[2*r+1]=t[r+1],n[2*r+2]=t[r+2],n[2*r+3]=t[r+3],n[2*r+4]=t[r+4],n[2*r+5]=t[r+5];return _.prototype.setColors.call(this,n),this},e.prototype.fromLine=function(t){throw new Error("LineGeometry.fromLine not converted to TS yet")},e.prototype.copy=function(t){return this},e}(_),T=n(48),M=n(576),E=n.n(M),P=n(577),O=n.n(P),A=n(578),D=n.n(A),R=n(579),C=n.n(R);!function(t){t[t.LINE_DEFAULT=0]="LINE_DEFAULT",t[t.LINE_HOVER=1]="LINE_HOVER",t[t.END_DEFAULT=2]="END_DEFAULT",t[t.END_HOVER=3]="END_HOVER"}(i||(i={}));var I=function(){function t(){var t,e=Object(T.a)(E.a),n=Object(T.a)(O.a),r=Object(T.a)(D.a),a=Object(T.a)(C.a);this.textures=((t={})[i.LINE_DEFAULT]=r,t[i.LINE_HOVER]=a,t[i.END_DEFAULT]=e,t[i.END_HOVER]=n,t),r.minFilter=o.Y,a.minFilter=o.Y,e.minFilter=o.Y,n.minFilter=o.Y}return t.prototype.get=function(t){return this.textures[t]},t.prototype.dispose=function(){for(var t in this.textures){var e=Number(t);this.get(e).dispose()}},t}();n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return f})),n.d(e,"c",(function(){return v})),n.d(e,"e",(function(){return b})),n.d(e,"d",(function(){return S})),n.d(e,"g",(function(){return I})),n.d(e,"f",(function(){return i}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r={zoomStep:.1,minZoom:.7,maxZoom:2,maxHighResZoom:3,highResThreshold:1.1}},function(t,e,n){"use strict";var r=e;r.version=n(750).version,r.utils=n(751),r.rand=n(522),r.curve=n(339),r.curves=n(756),r.ec=n(764),r.eddsa=n(768)},function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t.text="text",t.link="link",t.photo="photo",t.video="video",t.rich="rich",t.none="none",t.error="error"}(r||(r={})),function(t){t.parse=function(e){return null!==e&&e in t?t[e]:t.none}}(r||(r={}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(155),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n,r){var i=t.call(this)||this;return i.key=e,i.state=n,i.modifiers=r,i}return o(e,t),e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return c}));var r,i=n(1),o=n(23),a=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(t){function e(e,n,r){var i=t.call(this)||this;return i.name="cam-start",i.icon=e,i.thumb=n,i.modified=new Date(0),i.pose=new c,r&&i.pose.copy(r),i}return a(e,t),e.prototype.copy=function(t){return this.icon=t.icon,this.thumb=t.thumb,this.modified=t.modified||new Date,this.pose.copy(t.pose),this},Object.defineProperty(e.prototype,"hasCameraPose",{get:function(){return this.pose&&this.pose.camera&&void 0!==this.pose.camera.position},enumerable:!0,configurable:!0}),e}(o.a),c=function(){function t(t,e,n,r,o,a){void 0===t&&(t=i.a.Panorama),this.mode=t,this.camera={position:e||void 0,rotation:n||void 0,zoom:r||void 0},this.pano=o||{uuid:void 0},this.floorVisibility=a||void 0}return t.prototype.copy=function(t){return this.camera.position=u(t.camera.position,this.camera.position),this.camera.rotation=u(t.camera.rotation,this.camera.rotation),this.camera.zoom=t.camera.zoom,this.pano.uuid=t.pano.uuid?t.pano.uuid.slice():void 0,this.mode=t.mode,this.floorVisibility=t.floorVisibility?t.floorVisibility.slice():void 0,this},t}(),u=function(t,e){return t&&e?e.copy(t):t&&!e?t.clone():void 0}},function(t,e,n){"use strict";n.d(e,"b",(function(){return s}));var r,i=n(62),o=n(10),a=n(6);e.a=Object.freeze({camera:{transitionBlackoutTime:300,transitionFadeTime:800,baseTransitionTime:a.A("btt",200),transitionSpeed:a.A("tsp",3)}});var s=((r={})[i.b.Desktop]=o.a.Interpolate,r[i.b.Mobile]=o.a.Interpolate,r[i.b.VrOrientOnly]=o.a.FadeToBlack,r[i.b.VrWithController]=o.a.FadeToBlack,r[i.b.VrWithTrackedController]=o.a.FadeToBlack,r)},function(t,e,n){"use strict";var r;!function(t){t[t.Center=0]="Center",t[t.UpperLeft=1]="UpperLeft",t[t.UpperRight=2]="UpperRight",t[t.LowerRight=3]="LowerRight",t[t.LowerLeft=4]="LowerLeft"}(r||(r={})),e.a=r},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(0),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(i.lb)},function(t,e,n){"use strict";n.r(e);var r,i,o,a,s=n(4),c=n(25),u=n(159),l=n(31),h=n(91),f=n(82),p=n(138),d=n(85),y=n(99),m=n(316),v=n(50),g=n(18),b=n(35),w=n(17),_=n(362),x=n(26),S=n(21),T=n(87),M=n(15),E=n(173),P=n(12),O=n(162),A=n(359),D=n(0),R=n(3),C=n(123),I=n(108),k=n(19),L=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),N=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},j=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return L(e,t),e}(I.a),B=function(){function t(t,e,n,r,i,o,a){var s=this;this.floors=t,this.isHidden=e,this.modelMesh=n,this.viewmode=r,this.getPhase=i,this.input=o,this.debug=a,this.container=new D.zb,this.colliders={},this.toggleColliders=function(t){var e,n;try{for(var r=N(s.floors),i=r.next();!i.done;i=r.next()){var o=i.value,a=s.colliders[o.floorIndex],c=t&&!s.isHidden(o.floorIndex);c!==a.visible&&(c?(s.input.registerMesh(a,!1),a.visible=!0,a.raycastEnabled=!0):(s.input.unregisterMesh(a),a.visible=!1,a.raycastEnabled=!1))}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}}return t.prototype.init=function(){var t,e;try{for(var n=N(this.floors),r=n.next();!r.done;r=n.next()){var i=r.value,o=new D.k(this.modelMesh.size.x+100,.1,this.modelMesh.size.z+100),a=new D.s(16777215*Math.random()),s=new D.mb({transparent:!0,opacity:.3,depthWrite:!1,color:a}),c=new j(o,s);c.floorIndex=i.floorIndex,c.visible=!1,c.position.set(this.modelMesh.center.x,i.center.y+i.size.y/2-.1,this.modelMesh.center.z),this.colliders[i.floorIndex]=c,this.container.add(c)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.container.updateMatrixWorld(!0)},t.prototype.dispose=function(){var t,e;this.toggleColliders(!1);try{for(var n=N(this.floors),r=n.next();!r.done;r=n.next()){var i=r.value;this.colliders[i.floorIndex].geometry.dispose()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},t.prototype.activate=function(){},t.prototype.deactivate=function(){},t.prototype.beforeRender=function(){var t=this.viewmode.isFloorplan()||!0===this.debug&&this.viewmode.isDollhouse();this.toggleColliders(this.getPhase()!==k.a.CLOSED&&t)},t.prototype.render=function(){},t}(),F=n(143),U=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();!function(t){t[t.SnapPoint=1]="SnapPoint",t[t.SnapLine=2]="SnapLine",t[t.AxisAny=3]="AxisAny",t[t.AxisX=4]="AxisX",t[t.AxisY=5]="AxisY",t[t.AxisZ=6]="AxisZ",t[t.Mesh=7]="Mesh",t[t.RoomMesh=8]="RoomMesh",t[t.LinePoint=9]="LinePoint",t[t.LineSegment=10]="LineSegment"}(a||(a={}));var z,G=function(t){function e(e,n,r,i,o){var a=t.call(this,e,n,r,i)||this;return a.roomIndex=r,a.floorIndex=i,a.featureType=o,a}return U(e,t),e}(F.a),H=function(t){function e(e,n,r,i,o){var a=t.call(this,e,n,r,i)||this;return a.roomIndex=r,a.floorIndex=i,a.featureType=o,a}return U(e,t),e}(F.a),V=((i={})[R.a.UP]=a.AxisY,i[R.a.DOWN]=a.AxisY,i[R.a.FORWARD]=a.AxisZ,i[R.a.BACK]=a.AxisZ,i[R.a.LEFT]=a.AxisX,i[R.a.RIGHT]=a.AxisX,i[R.a.HORIZONTAL_PLANE]=a.AxisY,i.NONE=void 0,i);!function(t){t[t.UserAxis=1]="UserAxis",t[t.UserPoint=2]="UserPoint",t[t.UserLine=3]="UserLine",t[t.ModelFeature=4]="ModelFeature"}(z||(z={}));var W,q=((o={})[a.LinePoint]=z.UserPoint,o[a.LineSegment]=z.UserLine,o[a.AxisAny]=z.UserAxis,o[a.AxisX]=z.UserAxis,o[a.AxisY]=z.UserAxis,o[a.AxisZ]=z.UserAxis,o[a.Mesh]=z.ModelFeature,o[a.RoomMesh]=z.ModelFeature,o[a.SnapLine]=z.ModelFeature,o[a.SnapPoint]=z.ModelFeature,o),Y=n(67),J=n(28);!function(t){t[t.x=16711680]="x",t[t.y=32768]="y",t[t.z=255]="z",t[t.free=16777215]="free",t[t.xz=16711935]="xz",t[t.laser=16724312]="laser",t[t.yellow=16776960]="yellow",t[t.white=16777215]="white"}(W||(W={}));var X=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),K=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},Q=function(){function t(t,e,n,r,i){var o=this;this.pointer=t,this.mobile=e,this.getPhase=n,this.scene=r,this.getLayer=i,this.subscriptions=[],this.editing=!1,this.axisLines=[],this.axisAlignmentHelper=new D.zb,this.updateSnapping=function(t){if(o.axisLines.length>0&&(o.pointer.removeSnapFeatures(o,a.AxisAny),o.axisLines.length=0),t){o.axisAlignmentHelper.position.copy(t.point);var e=Object(J.p)(o.axisAlignmentHelper,t.point,t.normal);o.axisAlignmentHelper.updateMatrixWorld(!0);var n=o.axisAlignmentHelper.matrixWorld,r=function(t,e,n,r,i,o){var a=new G(t.clone().multiplyScalar(100),e.clone().multiplyScalar(100),r,i,o);return a.applyMatrix4(n),a},i=(new D.jb).copyPosition(n);o.axisLines.push(r(R.b.UP,R.b.DOWN,i,t.room,t.floor,a.AxisY)),e||o.axisLines.push(r(R.b.FORWARD,R.b.BACK,n,t.room,t.floor,a.AxisY),r(R.b.UP,R.b.DOWN,n,t.room,t.floor,a.AxisX),r(R.b.LEFT,R.b.RIGHT,n,t.room,t.floor,a.AxisZ)),o.axisLines.length>0&&o.pointer.addSnapFeatures(o,a.AxisAny,o.axisLines)}}}return t.prototype.init=function(){},t.prototype.dispose=function(){},t.prototype.activate=function(){this.subscriptions.push(this.pointer.onOriginChanged(this.updateSnapping,!0)),this.axisLineRenderer=new Z(this.scene,this.getLayer("cursor-mesh"))},t.prototype.deactivate=function(){this.subscriptions.forEach((function(t){return t.cancel()})),this.subscriptions.length=0,this.pointer.removeSnapFeatures(this,a.AxisAny),this.axisLineRenderer.dispose(),this.axisLineRenderer=null},t.prototype.beforeRender=function(){var t=this.getPhase(),e=this.mobile?!!k.b.mobile[t]:!!k.b.desktop[t];e!==this.editing&&(this.editing=e,this.axisLineRenderer.clearLines())},t.prototype.render=function(){this.editing&&this.axisLineRenderer.render(this.pointer.lastIntersection,this.axisLines)},t}(),Z=function(){function t(t,e){var n,r,i=this;this.scene=t,this.layer=e,this.offsetFromMesh=.0075,this.featureColors=((n={})[a.AxisX]=W.x,n[a.AxisZ]=W.z,n[a.AxisY]=W.y,n),this.axesVisibleInConstraints=((r={})[Y.a.EdgesAndPlanarAxes]=!0,r[Y.a.Axes]=!0,r[Y.a.PlanarAxes]=!0,r),this.linesActive=[],this.linesFree=[],this.axesVisible=[],this.axisMat=new D.V({color:4095,linewidth:1,opacity:.75,transparent:!0,depthWrite:!1,depthTest:!0}),this.render=function(t,e){var n,r;if(t&&i.axesVisibleInConstraints[t.constraint]&&e.length>0){if(e.length!==i.axesVisible.length)i.clearLines();else i.axesVisible.every((function(t,n){return t.equals(e[n])}))||i.clearLines();if(i.container.parent!==i.scene.scene){try{for(var o=K(e),a=o.next();!a.done;a=o.next()){var s=a.value,c=i.getMesh(s);c.material.color.setHex(i.featureColors[s.featureType]),i.container.add(c),i.linesActive.push(c)}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}i.axesVisible=e.map((function(t){return t})),i.scene.addChild(f.a.Root,i.container),i.container.position.copy(t.normal).multiplyScalar(i.offsetFromMesh),i.container.updateMatrixWorld(!0)}}else i.clearLines()},this.clearLines=function(){if(0!==i.linesActive.length){for(;i.linesActive.length>0;){var t=i.linesActive.pop();t&&(i.container.remove(t),i.linesFree.push(t))}i.scene.removeChild(f.a.Root,i.container)}},this.container=new D.zb}return t.prototype.getMesh=function(t){var e=this.linesFree.pop();return e?(e.geometry.setFromPoints([t.start,t.end]),e.geometry.verticesNeedUpdate=!0):(e=new $(t,this.axisMat.clone())).layers.mask=this.layer.mask,e},t.prototype.dispose=function(){for(this.clearLines();this.linesFree.length>0;){var t=this.linesFree.pop();t&&(this.container.remove(t),t.geometry.dispose(),t.material.dispose())}this.linesActive=[],this.linesFree=[],this.container=null},t}(),$=function(t){function e(e,n){var r=t.call(this,void 0,n)||this;return r.material=n,r.geometry=(new D.I).setFromPoints([e.start,e.end]),r}return X(e,t),e}(D.T),tt=n(102),et=n(567),nt=function(){function t(t,e,n,r){var i=this;this.points=t,this.createPointSubscription=e,this.pointer=n,this.mobileCreateHackJob=r,this.subscriptions=[],this.lineSegments=[],this.updateSnapping=function(t){i.lineSegments.length>0&&(i.pointer.removeSnapFeatures(i,a.LineSegment),i.lineSegments.length=0);for(var e=0;e<i.points.length;e++)if(e!==t&&e!==t-1&&e!==t+1&&!i.points.isStartIndex(e)){var n=i.points.get(e),r=i.points.get(e-1),o=i.points.getGroup(i.points.groupFromPointIndex(e));i.lineSegments.push(new H(r,n,o.info.room,o.info.floor,a.LineSegment))}i.lineSegments.length>0&&i.pointer.addSnapFeatures(i,a.LineSegment,i.lineSegments)}}return t.prototype.init=function(){},t.prototype.dispose=function(){},t.prototype.activate=function(){var t=this,e=-1,n=-1,r=Object(et.a)((function(){return t.updateSnapping(t.points.length)}),16);this.subscriptions.push(this.createPointSubscription(tt.a.ADDED,r,!0),this.createPointSubscription(tt.a.REMOVED,r,!0),this.createPointSubscription(tt.a.UPDATED,(function(r,i){i===e||t.mobileCreateHackJob()&&i===n||(t.updateSnapping(i),n=e,e=i)}),!0))},t.prototype.deactivate=function(){this.subscriptions.forEach((function(t){return t.cancel()})),this.subscriptions.length=0,this.pointer.removeSnapFeatures(this,a.LinePoint),this.pointer.removeSnapFeatures(this,a.LineSegment)},t.prototype.beforeRender=function(){},t.prototype.render=function(){},t}(),rt=n(2),it=n(167),ot=function(){function t(t,e,n){this.constraint=e,this.point=new D.Jc,this.normal=new D.Jc,at(t)?this.updateFromIntersection(t,e):st(t)&&n&&this.updateFromSnapIntersection(t,e,n),this.source=t}return t.prototype.updatePoint=function(t){return this.point.copy(t),this.source.point.copy(t),this},t.prototype.updateFromIntersection=function(t,e){return this.source=t,this.updateContents(e,t.point,t.face.normal,t.distance,t.object),this},t.prototype.updateFromSnapIntersection=function(t,e,n){return this.source=t,this.updateContents(e,t.point,n,t.distance,t.object),this},t.prototype.copy=function(t){var e=t.constraint,n=t.point,r=t.normal,i=t.distance,o=t.object;this.updateContents(e,n,r,i,o)},t.prototype.clone=function(){return new t(this.source,this.constraint)},t.prototype.updateContents=function(t,e,n,r,i){this.constraint=t,this.point.copy(e),this.normal.copy(n),this.distance=r,this.object=i,it.a.hasRoomIndex(i)?(this.room=i.roomIndex,this.floor=i.floorIndex):it.a.hasFloorIndex(i)&&(this.floor=i.floorIndex),this.featureType=function(t){if(t)return"featureType"in t&&void 0!==t.featureType?t.featureType:t instanceof D.Jc||t instanceof F.b?a.SnapPoint:t instanceof C.a?a.RoomMesh:t instanceof I.a?a.Mesh:t instanceof j?a.Mesh:t instanceof D.U||t instanceof F.a?a.SnapLine:void 0}(i)},t}(),at=function(t){return t&&"face"in t&&void 0!==t.face&&it.a.hasFloorIndex(t.object)},st=function(t){return t&&"isLineOctreeIntersection"in t&&it.a.hasFloorIndex(t.object)},ct=n(262),ut=n(36),lt=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},ht=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},ft=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(ht(arguments[e]));return t},pt=new rt.a("snapping"),dt=function(){function t(t,e,n,r,i){var o,s=this;this.raycaster=t,this.targetGroups=e,this.getConstraintStyle=n,this.isFloorHidden=i,this.origin=null,this.planeNormal=new D.Jc,this.plane=new D.Hb,this.ray=new D.dc,this.originChangedListeners=[],this.registeredSnapFeatures=((o={})[z.UserAxis]=[],o[z.UserLine]=[],o[z.UserPoint]=[],o[z.ModelFeature]=[],o),this.clearOrigin=function(){s.origin=null,s.originChangedListeners.forEach((function(t){return t(null)}))},this.setOrigin=function(t,e){void 0===e&&(e=!1),s.origin&&!e||(s.origin=t,s.plane.setFromNormalAndCoplanarPoint(s.origin.normal,s.origin.point),s.originChangedListeners.forEach((function(t){return t(s.origin)})),pt.debug("Updating origin",s.origin,{forceUpdate:e}))},this.setOriginFromPointer=function(t){if(!s.origin){var e=s.getMeshIntersection();if(e){var n=new ot(e,s.getConstraintStyle());t&&n.updatePoint(t),s.setOrigin(n,!0)}}},this.snapFeatures=function(t){return s.registeredSnapFeatures[t].reduce((function(t,e){return t.concat(e.features)}),[])},this.addSnapFeatures=function(t,e,n){var r=q[e];s.registeredSnapFeatures[r].push({owner:t,features:n}),pt.debug("Adding "+n.length+" snap feature groups",a[e],e)},this.removeSnapFeatures=function(t,e){var n=q[e],r=s.registeredSnapFeatures[n].findIndex((function(e){return e.owner===t}));if(-1!==r){var i=s.registeredSnapFeatures[n].splice(r,1);pt.debug("Removing "+i.length+" snap feature groups",a[e],e)}else pt.debug("removeTemporarySnapFeature: "+e+" "+a[e]+" not found from",t,s.registeredSnapFeatures)},this.filters={nop:function(t){return!0},userPoints:function(t){var e,n,r;if(void 0===t.object)return!1;if((r=t.object)&&r instanceof D.Jc)try{for(var i=lt(s.snapFeatures(z.UserPoint)),o=i.next();!o.done;o=i.next()){if(o.value.equals(t.object))return!0}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return!1},userLines:function(t){var e,n,r,i,o;if(void 0===t.object)return!1;if((o=t.object)&&"isSnapAxisLine3"in o||"isSnapUserLine3"in o||"isSnapLine3"in o||"start"in o&&"end"in o&&"closestPointToPoint"in o){try{for(var a=lt(s.snapFeatures(z.UserLine)),c=a.next();!c.done;c=a.next()){if(c.value.equals(t.object))return!0}}catch(t){e={error:t}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}try{for(var u=lt(s.snapFeatures(z.UserAxis)),l=u.next();!l.done;l=u.next()){if(l.value.equals(t.object))return!0}}catch(t){r={error:t}}finally{try{l&&!l.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}}return!1},userFeatures:function(t){return s.filters.userPoints(t)||s.filters.userLines(t)},onVisibleFloor:function(t){return t.object&&void 0!==t.object.floorIndex&&!s.isFloorHidden(t.object.floorIndex)},targetGroup:function(t){var e,n;try{for(var r=lt(s.targetGroups()),i=r.next();!i.done;i=r.next()){var o=i.value;if(t.object&&t.object instanceof o)return!0}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return!1}},this.meshSnapRadius=r?ut.g.mobile:ut.g.desktop}return t.prototype.preload=function(){this.raycaster.snapping.preloadMeshSnapping()},t.prototype.getMeshIntersection=function(t){var e=this,n=(t&&t.origin&&t.normal?this.raycaster.picking.cast(t.origin,t.normal):this.raycaster.pointer.cast()).filter((function(t){return e.filters.targetGroup(t)&&e.filters.onVisibleFloor(t)}))[0];return at(n)?n:null},t.prototype.getIntersection=function(t){var e=this.getMeshIntersection(t);if(!e)return null;this.cachedHit||(this.cachedHit=new ot(e,this.getConstraintStyle()));var n=this.cachedHit.updateFromIntersection(e,this.getConstraintStyle()),r=this.raycaster.pointer.pointerRay;switch(this.ray.set(r.origin,r.direction),this.planeNormal.copy(n.normal),this.getConstraintStyle()){case Y.a.Free:return n;case Y.a.Axes:return this.lockToWorldAxes(n);case Y.a.PlanarAxes:var i=ft(this.snapFeatures(z.UserAxis),this.snapFeatures(z.UserLine),this.snapFeatures(z.UserPoint));return this.softSnapToEdges(n,i,this.filters.userFeatures);case Y.a.Edges:var o=ft(this.snapFeatures(z.UserLine),this.snapFeatures(z.UserPoint));return this.softSnapToEdges(n,o,this.filters.onVisibleFloor);case Y.a.EdgesAndPlanarAxes:var a=ft(this.snapFeatures(z.UserAxis),this.snapFeatures(z.UserLine),this.snapFeatures(z.UserPoint));return this.softSnapToEdges(n,a,this.filters.onVisibleFloor)}return n},Object.defineProperty(t.prototype,"lastIntersection",{get:function(){return this.cachedHit},enumerable:!0,configurable:!0}),t.prototype.onOriginChanged=function(t,e){var n=this;void 0===e&&(e=!1);var r={renew:function(){n.originChangedListeners.push(t)},cancel:function(){Object(ct.a)(n.originChangedListeners,t)}};return e&&r.renew(),r},t.prototype.lockToWorldAxes=function(t){if(this.origin){var e=Object(Y.b)(this.origin.point,t.point,Y.a.Axes);return this.cachedHit.copy(t),this.cachedHit.point.copy(e.position),this.cachedHit.constraint="NONE"!==e.axisName?Y.a.Axes:Y.a.Free,this.cachedHit.featureType=V[e.axisName],this.cachedHit}return t},t.prototype.softSnapToEdges=function(t,e,n){var r,i,o=this.origin?this.origin.point:t.point,a=this.origin?this.origin.normal:t.normal;(r=this.raycaster.snapping).add.apply(r,ft(e));var s=this.raycaster.snapping.cast(this.ray,this.meshSnapRadius,o,a).filter(n),c=this.raycaster.snapping.pick(this.ray,this.meshSnapRadius,s);return(i=this.raycaster.snapping).remove.apply(i,ft(e)),c?(this.cachedHit.updateFromSnapIntersection(c,this.getConstraintStyle(),a),this.cachedHit):t},t}(),yt=n(43),mt=n(593),vt=n.n(mt),gt=n(48),bt=n(46),wt=n(192),_t=n(109),xt=n(360),St=n(594),Tt=n.n(St),Mt=n(595),Et=n.n(Mt),Pt=function(){return(Pt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},Ot=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},At=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Dt=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},Rt=function(){function t(t,e){void 0===e&&(e=yt.a.ALL);var n=this;this.scene=t,this.layer=e,this.supportsMobile=!0,this.style=xt.a.GridPlane,this.alignToNormal=!0,this.xzTex=Object(gt.a)(Tt.a),this.zyTex=Object(gt.a)(Et.a),this.bindings=[],this.onOpacityUpdate=function(t){n.container.children.forEach((function(e){e.isMesh&&(e.material.opacity=Math.max(0,t.opacity.value))}))},this.onPositionUpdate=function(t,e){n.container.position.copy(t).addScaledVector(e,.005),n.alignToNormal&&Object(J.p)(n.container,t,e)},this.scale=function(t){n.container.scale.set(t,t,t)},this.onRaycasterUpdate=function(t){t.hit&&t.hit.face&&n.onPositionUpdate(t.hit.point.clone(),t.hit.face.normal)},this.container=new D.J;var r=new D.Jb(.4,.4),i={color:16777215,side:D.w,transparent:!0,depthTest:!0,depthWrite:!1};this.xzTex.generateMipmaps=!1,this.xzTex.minFilter=D.Y,this.xzMaterial=new D.mb(Pt({},i,{color:65280,map:this.xzTex})),this.xzMaterial.premultipliedAlpha=!1;var o=new D.lb(r,this.xzMaterial);o.rotateOnAxis(R.b.LEFT,Math.PI/2),this.zyTex.generateMipmaps=!1,this.zyTex.minFilter=D.rb,this.zyMaterial=new D.mb(Pt({},i,{map:this.zyTex})),this.zyMaterial.premultipliedAlpha=!1;var a=new D.lb(r,this.zyMaterial);this.container.add(o,a),this.container.children.forEach((function(t){return t.layers.mask=n.layer.mask}))}return t.prototype.init=function(){},t.prototype.render=function(){},t.prototype.dispose=function(){this.container.children.forEach((function(t){if(t.isMesh){t.geometry.dispose();var e=t.material;e.dispose(),e.map&&e.map.dispose()}}))},t.prototype.activate=function(t){return Ot(this,void 0,void 0,(function(){var e,n;return At(this,(function(r){switch(r.label){case 0:return[4,t.market.waitForData(wt.a)];case 1:return e=r.sent(),[4,t.market.waitForData(_t.b)];case 2:return n=r.sent(),this.bindings.push(e.onChanged(this.onOpacityUpdate),n.onChanged(this.onRaycasterUpdate)),this.scene.add(this.container),[2]}}))}))},t.prototype.deactivate=function(t){var e,n;try{for(var r=Dt(this.bindings),i=r.next();!i.done;i=r.next()){i.value.cancel()}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}this.bindings.length=0,this.scene.remove(this.container)},t.prototype.setVisible=function(t){this.container.visible=t},t}(),Ct=n(65),It=n(7),kt=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},Lt=function(){function t(t,e,n,r,i,o,a,s){var c=this;this.mobile=t,this.getPhase=e,this.pointer=n,this.sceneInfo=r,this.renderToTexture=i,this.getLayer=o,this.getChunks=a,this.editing=!1,this.editingStateChange=!1,this.setOverlay=function(t){var e,n;try{for(var r=kt(c.getChunks()),i=r.next();!i.done;i=r.next()){i.value.setColorOverlay(t?bt.d:null)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},this.setupCursorRenderCamera=function(){var t,e,n=new D.Gb(ut.a.perspective.fov,1,.1,100);n.name="Cursor Peek Camera";var r=yt.a.ALL;try{for(var i=kt(["measurement-mode","measurement3d"]),o=i.next();!o.done;o=i.next()){var a=o.value;r.removeLayers(c.getLayer(a))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}n.layers.mask=r.mask,n.updateProjectionMatrix();return{camera:n,update:function(t,e,r){n.fov=t,n.near=e,n.far=r,n.updateProjectionMatrix()}}};var u=Object(gt.a)(vt.a),l=new D.Ic;this.cursorMesh=new Rt(this.sceneInfo.scene,this.getLayer("cursor-mesh")),this.cursorMesh.setVisible(!1);var h,f,p=new D.Jc,d=new D.Pb,y=new D.Ic,m=s(),v=ut.a.perspective;this.renderIntersection=function(t,e,n){h||(f=c.setupCursorRenderCamera(),h=f.camera,f.update(ut.a.perspective.fov,.1,100)),m!==s()&&(v=s()?ut.a.ortho:ut.a.perspective,c.cursorMesh.scale(v.scale),f.update(v.fov,.1,100),m=s());var o=c.editingStateChange?1:ut.a.smoothness;if(e){if(r.playerCamera.getWorldPosition(p),r.playerCamera.getWorldQuaternion(d),s()){var a=r.cameraData.zoom(),g=Object(It.g)(a,v.thresholdClose,v.thresholdFar,v.offsetClose,v.offsetFar);h.position.copy(e.point).addScaledVector(R.b.UP,g),h.quaternion.copy(d)}else{g=Object(It.g)(e.distance,v.thresholdClose,v.thresholdFar,v.offsetClose,v.offsetFar);var b=p.sub(e.point).setLength(g).add(e.point);h.position.lerp(b,o),h.lookAt(e.point)}h.updateMatrixWorld(),ut.b&&c.setOverlay(!1),i.render(t,r.scene.scene,h),ut.b&&c.setOverlay(!0),y.lerp(function(t){var e=c.rttView.height,n=c.rttView.width,r=c.sceneInfo.cameraData,i=e/2,o=-n/2;i=t.y<e/2+i?e+i:-i;var a=t.x+o,s=r.height-t.y-i;return l.set(a,s)}(n),o),i.renderToScreen(t,y,u)}c.editingStateChange=!1}}return t.prototype.init=function(){},t.prototype.dispose=function(){},t.prototype.activate=function(){this.sceneInfo.scene.addChild(f.a.Root,this.cursorMesh.container);var t=this.mobile?ut.f.mobileSize:this.sceneInfo.cameraData.height>ut.f.highResThreshold?ut.f.desktopSizeHighRes:ut.f.desktopSize;this.rttView=this.renderToTexture.createRenderTarget2D(t,t,{format:D.Xb},!1)},t.prototype.deactivate=function(){this.sceneInfo.scene.removeChild(f.a.Root,this.cursorMesh.container),this.renderToTexture.disposeRenderTarget2D(this.rttView),this.editing=!1},t.prototype.beforeRender=function(){var t=this.getPhase(),e=this.mobile?!!k.b.mobile[t]:!!k.b.desktop[t];e!==this.editing&&(this.editingStateChange=!0,this.editing=e,this.cursorMesh.setVisible(this.editing))},t.prototype.render=function(){if(this.editing&&(this.hit=this.mobile?this.pointer.lastIntersection:this.pointer.getIntersection(),this.hit)){this.cursorMesh.onPositionUpdate(this.hit.point,this.hit.normal);var t=Object(Ct.g)(this.sceneInfo.cameraData,this.hit.point).screenPosition;this.renderIntersection(this.rttView,this.hit,t)}},t}(),Nt=(n(552),n(66)),jt=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},Bt=function(){function t(e,n,r,i,o,a,s,c){var u=this;this.points=e,this.setSelected=n,this.pointer=r,this.changePhase=i,this.getPhase=o,this.isFloorplan=a,this.currentFloor=s,this.toggleMeasuringAnalytics=c,this.id=t,this.previousPhase=k.a.IDLE,this.currentLinePoints=0,this.previousPoint=new D.Jc,this.inputSubscriptions=[],this.log=new rt.a("measurement-creator"),this.createNewLine=function(t){u.toggleMeasuringAnalytics(!0);var e={visible:!0,room:void 0!==t.room?t.room:-1,floor:void 0!==t.floor?t.floor:u.currentFloor(),type:u.isFloorplan()?Nt.a.FloorplanOnly:Nt.a.ThreeD,text:""},n=u.points.startGroup(e);u.currentGroup=n,u.points.push(t.point),u.currentLinePoints=1,u.setSelected(n),u.pointer.setOrigin(t,!0)},this.addPointToLine=function(t){u.previousPoint.copy(t.point),u.points.push(t.point),++u.currentLinePoints,u.pointer.setOrigin(t,!0)},this.updateLastPoint=function(t){u.points.update(u.points.length-1,t.point)},this.getIntersection=function(t){return u.pointer.getIntersection(t)},this.setPhase=function(t){var e=u.getPhase();t!==e&&(u.previousPhase=e,u.changePhase(t))},this.restorePreviousPhase=function(){u.setPhase(u.previousPhase)}}return t.prototype.start=function(){var t,e;if(this.getPhase()===k.a.IDLE){this.previousPoint.set(1e3,1e3,1e3),this.setPhase(k.a.CREATING),this.setSelected(-1);try{for(var n=jt(this.inputSubscriptions),r=n.next();!r.done;r=n.next()){r.value.renew()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}}},t.prototype.cancelSubs=function(){var t,e;try{for(var n=jt(this.inputSubscriptions),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},t.prototype.stop=function(){this.cancelSubs(),this.currentLinePoints=0,this.setSelected(-1),this.setPhase(k.a.IDLE),this.pointer.clearOrigin(),this.toggleMeasuringAnalytics(!1)},t}(),Ft=n(27),Ut=n(8),zt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Gt=function(t){function e(n,r,i,o,a,s,c,u,l,h,f,p,d){var y=t.call(this,n,r,o,a,l,f,p,d)||this;return y.setCreatePointProgress=s,y.updateCreatePointHit=c,y.toggleCameraMovement=u,y.continuous=h,y.onLongPressSuccess=function(t){y.log.debug("onLongPressSuccess while in phase:",k.a[y.getPhase()]),y.getPhase()===k.a.CREATING?(y.createNewLine(t),y.addPointToLine(t)):y.getPhase()===k.a.CREATING_NEXT_POINT&&(y.continuous()?(y.updateLastPoint(t),y.addPointToLine(t)):y.updateLastPoint(t)),y.setPhase(k.a.POINT_PLACED)},y.onLongPressStart=function(t){if(t.buttons===Ft.b.PRIMARY&&(y.getPhase()===k.a.CREATING||y.getPhase()===k.a.CREATING_NEXT_POINT)){var n=y.getIntersection();n&&(y.previousPoint.equals(n.point)||(y.setPhase(k.a.CONFIRMING_POINT),y.toggleCameraMovement(!1),y.setCreatePointProgress(Date.now(),e.longPressCreateThreshold),y.updateCreatePointHit(n),y.previousPhase===k.a.CREATING_NEXT_POINT&&(y.updateLastPoint(n),y.toggleLastPointDraggable(!1)),y.creatingPointTimeout=window.setTimeout((function(){y.restorePreviousPhase(),y.onLongPressSuccess(n),y.toggleLastPointDraggable(!0)}),e.longPressCreateThreshold)))}},y.onLongPressEnd=function(){y.getPhase()===k.a.CONFIRMING_POINT&&(y.log.debug("onLongPressEnd, cancelling confirmation"),y.setCreatePointProgress(0,e.longPressCreateThreshold),window.clearTimeout(y.creatingPointTimeout),y.toggleCameraMovement(!0),y.restorePreviousPhase()),y.getPhase()===k.a.CREATING_NEXT_POINT&&y.points.update(y.points.length-1,y.points.get(y.points.length-2)),y.setPlacedtoCreatePhase()},y.onDrag=function(){var t=y.getIntersection();t&&(y.setPlacedtoCreatePhase(),y.setPhase(k.a.EDITING),y.previousPhase===k.a.CREATING_NEXT_POINT?y.updateLastTwoPoints(t):y.previousPhase===k.a.CREATING&&y.updateLastPoint(t))},y.onDragEnd=function(){y.getPhase()===k.a.EDITING&&y.restorePreviousPhase(),y.getPhase()!==k.a.CREATING&&y.getPhase()!==k.a.CREATING_NEXT_POINT||(y.toggleLastPointDraggable(!1),y.toggleCameraMovement(!0))},y.toggleLastPointDraggable=function(t){t?(y.dragSub.renew(),y.dragEndSub.renew()):(y.dragSub.cancel(),y.dragEndSub.cancel())},y.updateLastTwoPoints=function(t){y.points.update(y.points.length-1,t.point),y.points.update(y.points.length-2,t.point)},y.dragSub=i(Ut.d,y.onDrag),y.dragEndSub=i(Ut.c,y.onDragEnd),y.inputSubscriptions.push(i(Ut.h,y.onLongPressStart),i(Ut.g,y.onLongPressEnd)),y.dragSub.cancel(),y.dragEndSub.cancel(),y.cancelSubs(),y}return zt(e,t),e.prototype.start=function(){t.prototype.start.call(this)},e.prototype.stop=function(){if(this.getPhase()===k.a.CREATING_NEXT_POINT)if(this.continuous())this.points.pop();else{var e=this.points.getGroup(this.currentGroup);this.points.removeFromIdx(e.startIndex)}t.prototype.stop.call(this)},e.prototype.setPlacedtoCreatePhase=function(){this.getPhase()===k.a.POINT_PLACED&&(this.continuous()?this.previousPhase===k.a.CREATING?this.setPhase(k.a.CREATING_NEXT_POINT):this.previousPhase===k.a.CREATING_NEXT_POINT&&this.setPhase(k.a.CREATING_NEXT_POINT):this.previousPhase===k.a.CREATING?this.setPhase(k.a.CREATING_NEXT_POINT):this.previousPhase===k.a.CREATING_NEXT_POINT&&this.setPhase(k.a.CREATING))},e.longPressCreateThreshold=500,e}(Bt),Ht=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Vt=function(t){function e(e,n,r,i,o,a,s,c,u,l){var h=t.call(this,e,n,i,o,a,c,u,l)||this;return h.continuous=s,h.onCreate=function(t){var e=h.previousPoint.distanceTo(t.point)>ut.e;if(e||2!==h.currentLinePoints){if(h.getPhase()===k.a.CREATING)return h.createNewLine(t),h.addPointToLine(t),void h.setPhase(k.a.CREATING_NEXT_POINT);e&&h.getPhase()===k.a.CREATING_NEXT_POINT&&(h.continuous()?(h.updateLastPoint(t),h.addPointToLine(t)):h.finishLine(t))}else{var n={origin:t.point.addScaledVector(t.normal,.05),normal:t.normal},r=h.pointer.getMeshIntersection(n);if(r)if(h.continuous()){h.points.pop();var i=new ot(r,Y.a.Free);h.addPointToLine(i),h.addPointToLine(i),h.setPhase(k.a.CREATING_NEXT_POINT)}else h.finishLine(new ot(r,Y.a.Free))}},h.onMouseMove=function(){if(h.getPhase()===k.a.CREATING_NEXT_POINT){var t=h.getIntersection();t&&h.updateLastPoint(t)}},h.onMouseClick=function(t){if(t.button===Ft.a.PRIMARY&&h.getPhase()!==k.a.IDLE){var e=h.getIntersection();e&&h.onCreate(e)}},h.inputSubscriptions.push(r(Ut.n,h.onMouseMove),r(Ut.a,h.onMouseClick)),h.cancelSubs(),h}return Ht(e,t),e.prototype.start=function(){t.prototype.start.call(this)},e.prototype.stop=function(){this.getPhase()===k.a.CREATING_NEXT_POINT&&(this.points.pop(),this.currentLinePoints<3&&this.points.pop()),t.prototype.stop.call(this)},e.prototype.finishLine=function(t){this.points.pop(),this.addPointToLine(t),this.setPhase(k.a.CREATING),this.toggleMeasuringAnalytics(!1)},e}(Bt),Wt=function(t){return t instanceof Ut.a?t.button===Ft.a.PRIMARY:t.buttons===Ft.b.PRIMARY},qt=n(29),Yt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Jt=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},Xt=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Jt(arguments[e]));return t},Kt=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},Qt=function(){function t(t,e,n,r,i,o,a,s,c){var u,l,h=this;this.points=t,this.input=e,this.mobile=n,this.getPhase=r,this.changePhase=i,this.restorePreviousPhase=o,this.setSelectedLine=a,this.changeCursor=s,this.onDragEnd=c,this.colliderGeometry=new D.j(.125,.125,.125),this.colliderMaterial=new D.mb({color:65280,transparent:!0,opacity:.25,depthWrite:!1}),this.colliderPool=[],this.colliders=new Zt,this.inputSubscriptions=[],this.registerCommonInput=function(){return[h.input.registerMeshHandler(Ut.d,qt.a.isType($t),(function(t,e){Wt(t)&&k.c[h.getPhase()]&&h.validJoint(e)&&(h.setSelectedLine(e.groupIndex),h.changePhase(k.a.EDITING),h.mobile||h.changeCursor(d.a.GRABBING))})),h.input.registerMeshHandler(Ut.c,qt.a.isType($t),(function(t,e){h.getPhase()===k.a.EDITING&&h.validJoint(e)&&(h.update(),h.restorePreviousPhase(),h.onDragEnd(),h.mobile||h.changeCursor(d.a.DEFAULT))}))]},(u=this.inputSubscriptions).push.apply(u,Xt(this.registerCommonInput())),this.mobile||(l=this.inputSubscriptions).push.apply(l,Xt(this.registerHoverInput())),this.deactivate()}return t.prototype.activate=function(){var t,e;try{for(var n=Kt(this.inputSubscriptions),r=n.next();!r.done;r=n.next()){r.value.renew()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.update()},t.prototype.deactivate=function(){var t,e;this.removeAllColliders();try{for(var n=Kt(this.inputSubscriptions),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},t.prototype.dispose=function(){this.deactivate(),this.colliderMaterial.dispose(),this.colliderGeometry.dispose()},t.prototype.validJoint=function(t){return-1!==this.container.children.indexOf(t)},Object.defineProperty(t.prototype,"container",{get:function(){return this.colliders},enumerable:!0,configurable:!0}),t.prototype.update=function(){var t,e;this.removeAllColliders();var n=0;try{for(var r=Kt(this.points),i=r.next();!i.done;i=r.next()){var o=i.value,a=this.getCollider(n);a.position.copy(o),this.colliders.add(a),this.input.registerMesh(a,!1),++n,a.updateMatrixWorld(!0)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},t.prototype.getCollider=function(t){var e=this.colliderPool[t]||new $t(this.colliderGeometry,this.colliderMaterial);return this.colliderPool[t]=e,e.index=t,e.groupIndex=this.points.groupFromPointIndex(t),e},t.prototype.removeAllColliders=function(){for(var t;t=this.colliders.children[0];)this.input.unregisterMesh(t),this.colliders.remove(t)},t.prototype.registerHoverInput=function(){var t=this;return[this.input.registerMeshHandler(Ut.e,qt.a.isType($t),(function(){k.d[t.getPhase()]&&t.changeCursor(d.a.GRAB)})),this.input.registerMeshHandler(Ut.r,qt.a.isType($t),(function(){k.d[t.getPhase()]&&t.changeCursor(d.a.DEFAULT)}))]},t}(),Zt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yt(e,t),e}(D.zb),$t=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yt(e,t),e}(D.lb),te=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},ee=function(){function t(t,e,n,r,i){var o=this;this.points=t,this.pointer=n,this.getPhase=r,this.toggleMeasuringAnalytics=i,this.inputSubscriptions=[],this.onDragBegin=function(t,e){if(k.d[o.getPhase()]){o.toggleMeasuringAnalytics(!0);var n=o.points.isStartIndex(e.index)?e.index+1:e.index-1,r=o.points.get(n);o.pointer.clearOrigin(),o.pointer.setOriginFromPointer(r)}},this.onDragEnd=function(){k.d[o.getPhase()]&&(o.toggleMeasuringAnalytics(!1),o.pointer.clearOrigin())},this.onDrag=function(t,e){if(t.buttons===Ft.b.PRIMARY&&k.d[o.getPhase()]){var n=o.pointer.getIntersection();n&&o.points.update(e.index,n.point)}},this.inputSubscriptions.push(e.registerMeshHandler(Ut.b,qt.a.isType($t),this.onDragBegin),e.registerMeshHandler(Ut.d,qt.a.isType($t),this.onDrag),e.registerMeshHandler(Ut.c,qt.a.isType($t),this.onDragEnd)),this.deactivate()}return t.prototype.activate=function(){var t,e;try{for(var n=te(this.inputSubscriptions),r=n.next();!r.done;r=n.next()){r.value.renew()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},t.prototype.deactivate=function(){var t,e;try{for(var n=te(this.inputSubscriptions),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},t}(),ne=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),re=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},ie=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(re(arguments[e]));return t},oe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ne(e,t),e}(D.zb),ae=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ne(e,t),e}(D.lb),se=function(){function t(t,e,n,r,i,o,a){var s;this.pointGroups=t,this.input=e,this.changeCursor=r,this.getPhase=i,this.setSelectedLine=o,this.getSelected=a,this.colliderGeometry=new D.k(1,.125,.125),this.colliderMaterial=new D.mb({color:16753920,transparent:!0,opacity:.25,depthWrite:!1}),this.colliderPool=[],this.colliders=new oe,this.directionCache=new D.Jc,this.inputSubscriptions=[],this.inputSubscriptions.push(this.registerClickInput()),n||(s=this.inputSubscriptions).push.apply(s,ie(this.registerHoverInput())),this.deactivate()}return t.prototype.activate=function(){this.inputSubscriptions.forEach((function(t){return t.renew()})),this.update()},t.prototype.deactivate=function(){this.removeAllColliders(),this.inputSubscriptions.forEach((function(t){return t.cancel()}))},t.prototype.dispose=function(){this.deactivate(),this.colliderMaterial.dispose(),this.colliderGeometry.dispose()},t.prototype.update=function(){this.removeAllColliders();for(var t=0,e=0;e<this.pointGroups.groupCount;++e)for(var n=this.pointGroups.getGroup(e),r=0;r<n.count-1;++r){var i=this.getCollider(t,e);++t;var o=n.get(r),a=n.get(r+1);o&&a&&(this.updateCollider(i,o,a),this.colliders.add(i),this.input.registerMesh(i,!1))}},t.prototype.updateCollider=function(t,e,n){t.position.copy(e).add(n).multiplyScalar(.5),this.directionCache.copy(n).sub(e).normalize(),t.quaternion.setFromUnitVectors(R.b.RIGHT,this.directionCache),t.scale.x=Math.max(e.distanceTo(n),.01),t.updateMatrixWorld(!0)},t.prototype.validLine=function(t){return-1!==this.container.children.indexOf(t)},Object.defineProperty(t.prototype,"container",{get:function(){return this.colliders},enumerable:!0,configurable:!0}),t.prototype.getCollider=function(t,e){var n=this.colliderPool[t]||new ae(this.colliderGeometry,this.colliderMaterial);return this.colliderPool[t]=n,n.groupIndex=e,n.visible=!0,n},t.prototype.removeAllColliders=function(){for(;this.colliders.children.length>0;){var t=this.colliders.children[0];this.colliders.remove(t),this.input.unregisterMesh(t)}},t.prototype.registerHoverInput=function(){var t=this;return[this.input.registerMeshHandler(Ut.e,qt.a.isType(ae),(function(e,n){t.validLine(n)&&t.getPhase()===k.a.IDLE&&t.changeCursor(d.a.FINGER)})),this.input.registerMeshHandler(Ut.r,qt.a.isType(ae),(function(e,n){t.validLine(n)&&t.getPhase()===k.a.IDLE&&t.changeCursor(d.a.DEFAULT)}))]},t.prototype.registerClickInput=function(){var t=this;return this.input.registerMeshHandler(Ut.a,qt.a.isType(ae),(function(e,n){if(t.validLine(n)&&Wt(e)&&t.getPhase()===k.a.IDLE){var r=t.getSelected()===n.groupIndex?-1:n.groupIndex;t.setSelectedLine(r)}}))},t}(),ce=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},ue=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},le=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(ue(arguments[e]));return t},he=function(){function t(t,e,n,r,i,o,a){var s,c=this;this.lines=t,this.getLinesForPoint=e,this.editingMaterial=n,this.createPointSubscription=r,this.getPhase=o,this.getSelected=a,this.bindings=[],this.onDragEnd=function(t){var e,n;try{for(var r=ce(c.lines),i=r.next();!i.done;i=r.next()){i.value.restoreLineMaterial()}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},this.onClick=function(t,e){var n,r;if(c.getPhase()===k.a.IDLE){try{for(var i=ce(c.lines),o=i.next();!o.done;o=i.next()){o.value.restoreLineMaterial()}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}if(t.down){var a=e.index;void 0!==a&&c.styleLines(a)}}},this.styleLines=function(t){var e,n,r=c.getLinesForPoint(t);try{for(var i=ce(r),o=i.next();!o.done;o=i.next()){var a=o.value;a.group===c.getSelected()&&a.line.overrideLineMaterial(c.editingMaterial)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}},(s=this.bindings).push.apply(s,le([i.registerMeshHandler(Ut.m,qt.a.isType($t),this.onClick),i.registerUnfilteredHandler(Ut.c,this.onDragEnd)],this.setupLineStyler(this.createPointSubscription))),this.deactivate()}return t.prototype.activate=function(){var t,e;try{for(var n=ce(this.bindings),r=n.next();!r.done;r=n.next()){r.value.renew()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},t.prototype.deactivate=function(){var t,e;try{for(var n=ce(this.bindings),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},t.prototype.setupLineStyler=function(t){var e=this;return[t(tt.a.ADDED,(function(){var t=e.lines[e.lines.length-1];t&&t.restoreLineMaterial()}),!1),t(tt.a.UPDATED,(function(t,n){e.styleLines(n)}),!1)]},t}(),fe=(n(553),n(234)),pe=n(139),de=n(77),ye=n(16),me=n(6),ve=n(42),ge=n(89),be=n(117),we=n(217),_e=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),xe=function(){return(xe=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},Se=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},Te=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Me=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},Ee=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Me(arguments[e]));return t},Pe=new rt.a("measurement-mode"),Oe=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="measurement-mode",e.longPressStart=Date.now(),e.threshold=800,e.lineSidToPointMap={},e.mobile=!1,e.cameraAndDragBlocked=!1,e.blockNavigation=function(){return!1},e.onToggleMeasurementMode=function(t,n){return Se(e,void 0,void 0,(function(){return Te(this,(function(e){switch(e.label){case 0:return this.toggleMeasuringMode(t),[4,this.engine.commandBinder.issueCommand(new A.a(t&&n))];case 1:return e.sent(),[2]}}))}))},e.onViewmodeChange=function(){e.getPhase()!==k.a.CLOSED&&e.stopMeasuring()},e.onSweepChange=function(){var t=e.getPhase();t!==k.a.CREATING&&t!==k.a.CREATING_NEXT_POINT&&e.setSelected(-1)},e.appChanged=function(){e.textRenderer.activate(),e.pointGroups.reset(),e.textRenderer.deactivate(),e.toggleMeasuringMode(!1)},e.getPhase=function(){return e.data.phase},e.toggleCameraMovement=function(t){t||e.cameraAndDragBlocked?t&&e.cameraAndDragBlocked&&(e.dragInterceptor.cancel(),e.navigation.removeNavigationRule(e.blockNavigation),e.cameraAndDragBlocked=!1):(e.dragInterceptor.renew(),e.navigation.addNavigationRule(e.blockNavigation),e.cameraAndDragBlocked=!0)},e.getConstraint=function(){return e.settings.tryGetProperty(T.a.MeasurementSnapping,!1)?e.viewmodeData.isFloorplan()?ut.h.floorplan:e.constraint:ut.h.disabled},e.getSelected=function(){return e.data.selectedGroupIndex},e.setSelected=function(t){e.data.selectedGroupIndex!==t&&e.data.setSelectedGroupIndex(t)},e.deleteSelectedMeasurement=function(){-1!==e.data.selectedGroupIndex&&(e.deleteMeasurement(e.data.selectedGroupIndex),e.setSelected(-1),e.changePhase(k.a.IDLE),e.mobile||(e.navigation.removeNavigationRule(e.blockNavigation),e.engine.commandBinder.issueCommand(new y.a(d.a.DEFAULT))),e.lineColliders.update(),e.jointColliders.update())},e.deleteMeasurement=function(t){var n=e.buildAnalyticsMessage(t);n&&(e.settings.tryGetProperty(T.a.MeasurementContinuousLines,!1)&&e.getPhase()===k.a.CREATING_NEXT_POINT&&e.engine.broadcast(new ge.a(xe({},n))),e.engine.broadcast(new ge.c(xe({},n,{count:e.pointGroups.groupCount-1}))));e.pointGroups.removeGroup(t)},e.onToggleContinuous=function(){e.mobile||e.deleteSelectedMeasurement(),e.stopMeasuring()},e.changePhase=function(t){e.getPhase()!==t&&(Pe.debug("Phase Change: "+k.a[e.getPhase()]+" -> "+k.a[t]),e.previousPhase=e.getPhase(),e.data.setPhase(t))},e.restorePreviousPhase=function(){e.changePhase(e.previousPhase)},e.buildAnalyticsMessage=function(t){var n=e.data.getGroupInfo(t);return n&&n.hasLength()?xe({sid:n.info&&n.info.sid?n.info.sid:n.describe(),totalLength:n?n.length:0,segments:n?n.count:0,temporary:!n.info||n.info.sid===n.describe(),viewmode:e.viewmodeData.currentMode,floor:n.info&&void 0!==n.info.floor?n.info.floor:e.floorsViewData.getHighestVisibleFloor(),continuous:e.settings.tryGetProperty(T.a.MeasurementContinuousLines,!1)},e.getAnalyticsForConstraints(),{type:Nt.a[n.info.type]}):null},e.getAnalyticsForConstraints=function(){var t=e.pointer.lastIntersection;if(t){var n=t.featureType,r=t.constraint;return{featureType:void 0!==n?a[n]:"None",constraint:Y.a[r]}}return null},e.toggleMeasuringAnalytics=function(t){t?e.analyticsSubs.forEach((function(t){return t.renew()})):e.analyticsSubs.forEach((function(t){return t.cancel()}))},e.toggleMeasuringMode=function(t){Pe.debug("toggleMeasuringMode",t),t!==(e.getPhase()!==k.a.CLOSED)&&(t?(e.engine.toggleRendering(e,!0),e.changePhase(k.a.IDLE),e.editor.activate(),e.lineStyler.activate(),e.jointColliders.activate(),e.lineColliders.activate(),e.renderer.activate(),e.textRenderer.activate(),e.scene.addChild(f.a.Root,e.textRenderer.container),e.engine.broadcast(new ge.d(!0,e.viewmodeData.currentMode,e.pointGroups.groupCount)),e.pointer.preload()):(e.engine.toggleRendering(e,!1),e.stopMeasuring(),e.changePhase(k.a.CLOSED),e.toggleCameraMovement(!0),e.editor.deactivate(),e.lineStyler.deactivate(),e.jointColliders.deactivate(),e.lineColliders.deactivate(),e.renderer.deactivate(),e.textRenderer.deactivate(),e.scene.removeChild(f.a.Root,e.textRenderer.container),e.engine.broadcast(new ge.d(!1,e.viewmodeData.currentMode,e.pointGroups.groupCount))))},e.startMeasuring=function(){e.mobile||(e.navigation.addNavigationRule(e.blockNavigation),e.engine.commandBinder.issueCommand(new y.a(d.a.XHAIR))),e.creator.start()},e.stopMeasuring=function(){var t=e.settings.tryGetProperty(T.a.MeasurementContinuousLines,!1),n=e.data.getGroupInfo(e.data.selectedGroupIndex);if(t&&n&&n.count>2){var r=e.buildAnalyticsMessage(e.data.selectedGroupIndex);r&&e.engine.broadcast(new ge.a(xe({},r,{type:e.viewmodeData.isFloorplan()?Nt.a[Nt.a.FloorplanOnly]:Nt.a[Nt.a.ThreeD]})))}e.creator.stop(),e.lineColliders.update(),e.jointColliders.update(),e.mobile||(e.navigation.removeNavigationRule(e.blockNavigation),e.engine.commandBinder.issueCommand(new y.a(d.a.DEFAULT)))},e.setupIntersectionVisuals=function(t,n,r,i,o,a,s,c,u){n.addVisibilityRule((function(){var t=e.getPhase();return!(!s&&t===k.a.CREATING||t===k.a.CONFIRMING_POINT||t===k.a.CREATING_NEXT_POINT||t===k.a.EDITING)}));var l={cameraData:o,playerCamera:i.camera,scene:i};return new Lt(s,e.getPhase,a,l,t,c,(function(){return r.chunks}),u.isFloorplan)},e}return _e(e,t),e.prototype.init=function(t,e){return Se(this,void 0,void 0,(function(){var n,r,i,o,a,s,d,A,D,R,L,N,F,U,z,G,H,V,W,q,Y,J,X,K,Z,$,et,rt,it,ot,at,st,ct,lt,ht=this;return Te(this,(function(ft){switch(ft.label){case 0:return this.mobile=Object(me.n)(),this.engine=e,[4,Promise.all([e.getModule(c.default),e.getModule(u.default),e.getModule(l.default),e.getModule(p.default),e.getModule(h.default),e.market.waitForData(b.b),e.market.waitForData(g.a),e.market.waitForData(w.a),e.market.waitForData(M.a)])];case 1:return r=Me.apply(void 0,[ft.sent(),9]),i=r[0],o=r[1],a=r[2],s=r[3],d=r[4],A=r[5],D=r[6],R=r[7],L=r[8],N=this,[4,e.market.waitForData(x.a)];case 2:return N.settings=ft.sent(),this.scene=i.getScene(),this.viewmodeData=R,this.floorsViewData=A,this.input=a,F=this,[4,e.getModule(we.default)];case 3:return F.navigation=ft.sent(),this.lineDerivedDataFactory=new _.a(D,R,A,(function(){return Object(E.a)(L)}),(function(){return ht.settings.tryGetProperty(T.a.UnitType,S.c.USFractional)}),(function(){return!0})),U=function(){return ht.viewmodeData.isFloorplan()?[j]:[C.a]},z=e.claimRenderLayer(this.name),this.data=new ke,e.market.register(this,ke,this.data),G=Object(pe.b)([]),this.pointGroups=new Ke(G),H=function(t,e,n){return void 0===n&&(n=!1),Object(tt.b)(G,t).createSubscription(e,n)},this.dataSubscription=H(tt.a.ALL,(function(){ht.data.repopulate(ht.pointGroups.groups()),ht.data.commit()}),!0),this.constraint=this.mobile?ut.h.mobile:ut.h.desktop,this.pointer=new dt(d,U,this.getConstraint,this.mobile,this.floorsViewData.isHidden),V=function(){var t=ht.settings.tryGetProperty(T.a.MeasurementContinuousLines,!1),e=ht.getPhase()===k.a.CREATING||ht.getPhase()===k.a.CREATING_NEXT_POINT||ht.previousPhase===k.a.CREATING_NEXT_POINT&&ht.getPhase()===k.a.EDITING;return t&&ht.mobile&&e},W=new nt(this.pointGroups,H,this.pointer,V),e.addComponent(this,W),q=new Q(this.pointer,this.mobile,this.getPhase,this.scene,e.getRenderLayer),e.addComponent(this,q),Y=function(t,e){return a.registerUnfilteredHandler(t,e)},this.mobile?(J=function(t,e){ht.longPressStart=t,ht.threshold=e},X=function(t){var e=Object(Ct.g)(D,t.point);ht.data.setPointPosition(e.screenPosition)},this.creator=new Gt(this.pointGroups,this.setSelected,Y,this.pointer,this.changePhase,J,X,this.toggleCameraMovement,this.getPhase,(function(){return ht.settings.tryGetProperty(T.a.MeasurementContinuousLines,!1)}),this.viewmodeData.isFloorplan,this.floorsViewData.getHighestVisibleFloor,this.toggleMeasuringAnalytics)):this.creator=new Vt(this.pointGroups,this.setSelected,Y,this.pointer,this.changePhase,this.getPhase,(function(){return ht.settings.tryGetProperty(T.a.MeasurementContinuousLines,!1)}),this.viewmodeData.isFloorplan,this.floorsViewData.getHighestVisibleFloor,this.toggleMeasuringAnalytics),K=function(t,e,n){var r=ht.pointGroups.getGroup(t),i=r.describe(n);ht.lineSidToPointMap[i]=n;var o=ht.lineDerivedDataFactory.get(i);return ht.lineDerivedDataFactory.make(i,(function(){return{start_position:ht.pointGroups.get(e),end_position:ht.pointGroups.get(n),visible:r.info.visible,floor:r.info.floor,room:r.info.room,type:r.info.type,text:ht.pointGroups.isStartIndex(e)?r.info.text:""}}),o)},Z=function(){return ht.viewmodeData.isFloorplan()},this.renderer=new Ge(this.pointGroups,H,D,s,z,e.claimRenderLayer("measure-lines"),this.getSelected,Z,K),[4,e.addComponent(this,this.renderer)];case 4:return ft.sent(),$=new fe.a({color:"black",background:!0,backgroundColor:"#ffffff"}),this.textRenderer=new Fe(this.pointGroups,H,D,z,ve.a.labels,$,K,Z),[4,e.addComponent(this,this.textRenderer)];case 5:return ft.sent(),this.textRenderer.deactivate(),this.editor=new ee(this.pointGroups,a,this.pointer,this.getPhase,this.toggleMeasuringAnalytics),et=function(t){ht.engine.commandBinder.issueCommand(new y.a(t))},this.lineColliders=new se(this.pointGroups,this.input,this.mobile,et,this.getPhase,this.setSelected,this.getSelected),rt=function(){ht.lineColliders.update();var t=ht.buildAnalyticsMessage(ht.data.selectedGroupIndex);t&&ht.engine.broadcast(new ge.h(t))},this.jointColliders=new Qt(this.pointGroups,this.input,this.mobile,this.getPhase,this.changePhase,this.restorePreviousPhase,this.setSelected,et,rt),this.lineStyler=new he(this.renderer.lines,this.renderer.getLinesForPoint,this.renderer.dottedMaterial,H,this.input,this.getPhase,this.getSelected),[4,Promise.all([e.getModule(m.default),e.getModule(v.default)])];case 6:return it=Me.apply(void 0,[ft.sent(),2]),ot=it[0],at=it[1],st=this.setupIntersectionVisuals(o,ot,at.mesh,this.scene,D,this.pointer,this.mobile,e.getRenderLayer,this.viewmodeData),e.addComponent(this,st),ct=new B(A.floors.getCollection(),(function(t){return A.isHidden(t)}),at.mesh,this.viewmodeData,this.getPhase,a,t.floorplanDebug),e.addComponent(this,ct),t.floorplanDebug&&this.scene.addChild(f.a.Root,ct.container),t.inputDebug&&(this.scene.addChild(f.a.Root,this.jointColliders.container),this.scene.addChild(f.a.Root,this.lineColliders.container)),this.dragInterceptor=this.input.registerPriorityHandler(Ut.d,I.a,(function(){return!0})),this.dragInterceptor.cancel(),this.analyticsSubs=this.analytics(H,(function(t){return e.broadcast(t)})),lt=this,[4,e.market.waitForData(P.c)];case 7:return lt.applicationData=ft.sent(),this.mobile||(n=this.bindings).push.apply(n,Ee(this.hotkeys())),this.bindings.push(this.applicationData.onPropertyChanged("application",this.appChanged),R.makeModeChangeSubscription(this.onViewmodeChange),L.makeSweepChangeSubscription(this.onSweepChange),e.commandBinder.addBinding(O.f,(function(t){return Se(ht,void 0,void 0,(function(){return Te(this,(function(e){return[2,this.onToggleMeasurementMode(t.on,t.dimWhileActive)]}))}))})),e.commandBinder.addBinding(O.g,(function(){return Se(ht,void 0,void 0,(function(){return Te(this,(function(t){return[2,this.startMeasuring()]}))}))})),e.commandBinder.addBinding(O.h,(function(t){return Se(ht,void 0,void 0,(function(){return Te(this,(function(e){return[2,this.setSelected(t.index)]}))}))})),e.commandBinder.addBinding(O.i,(function(){return Se(ht,void 0,void 0,(function(){return Te(this,(function(t){return[2,this.stopMeasuring()]}))}))})),e.commandBinder.addBinding(O.c,(function(){return Se(ht,void 0,void 0,(function(){return Te(this,(function(t){return[2,this.deleteSelectedMeasurement()]}))}))})),e.commandBinder.addBinding(O.b,(function(t){return Se(ht,void 0,void 0,(function(){return Te(this,(function(e){return[2,this.deleteMeasurement(t.index)]}))}))})),e.commandBinder.addBinding(O.a,(function(t){return Se(ht,void 0,void 0,(function(){return Te(this,(function(e){return this.lineDerivedDataFactory.clear(),this.pointGroups.copy(t.points.groups()),this.lineColliders.update(),this.jointColliders.update(),[2]}))}))})),this.dataSubscription,this.settings.onPropertyChanged(T.a.MeasurementContinuousLines,(function(){return ht.onToggleContinuous()})),this.settings.onPropertyChanged(be.c,(function(t){t||ht.toggleMeasuringMode(!1)}))),e.toggleRendering(this,!1),[2]}}))}))},e.prototype.setConstraintStyle=function(t){Pe.debug("setConstraintStyle:",Y.a[t]),this.constraint=t},e.prototype.analytics=function(t,e){var n=this;return[t(tt.a.UPDATED,(function(){var t=n.settings.tryGetProperty(T.a.MeasurementContinuousLines,!1);if(n.mobile&&n.getPhase()===k.a.CREATING_NEXT_POINT&&!t){var e=n.buildAnalyticsMessage(n.data.selectedGroupIndex);e&&n.engine.broadcast(new ge.a(xe({},e,{type:n.viewmodeData.isFloorplan()?Nt.a[Nt.a.FloorplanOnly]:Nt.a[Nt.a.ThreeD]})))}})),t(tt.a.ADDED,(function(){var t=n.buildAnalyticsMessage(n.data.selectedGroupIndex);if(n.getPhase()===k.a.CREATING_NEXT_POINT&&t){var e=n.settings.tryGetProperty(T.a.MeasurementContinuousLines,!1);if(t&&e){var r=n.pointGroups.getGroup(n.data.selectedGroupIndex);n.engine.broadcast(new ge.e(xe({},t,{startPosition:n.pointGroups.get(r.startIndex),endPosition:n.pointGroups.get(r.endIndex)})))}else n.engine.broadcast(new ge.a(xe({},t,{type:n.viewmodeData.isFloorplan()?Nt.a[Nt.a.FloorplanOnly]:Nt.a[Nt.a.ThreeD]})))}})),t(tt.a.REMOVED,(function(){var t=n.data.getGroupInfo(n.pointGroups.groupCount-1);t&&t.count}))]},e.prototype.hotkeys=function(){var t=this;return[this.input.registerHandler(Ut.f,(function(e){if(e.state===de.a.PRESSED)switch(e.key){case ye.a.ESCAPE:t.getPhase()===k.a.CONFIRMING_POINT?(t.creator.stop(),t.creator.start(),t.changePhase(k.a.CREATING)):t.getPhase()===k.a.CREATING||t.getPhase()===k.a.CREATING_NEXT_POINT?t.stopMeasuring():t.applicationData.application!==P.b.WORKSHOP&&t.getPhase()!==k.a.CLOSED&&t.toggleMeasuringMode(!1);break;case ye.a.BACKSPACE:case ye.a.DELETE:t.getPhase()!==k.a.CLOSED&&t.getPhase()!==k.a.EDITING&&t.deleteSelectedMeasurement();break;case ye.a.RETURN:var n=t.data.getGroupInfo(t.pointGroups.groupCount-1);if(n)(t.settings.tryGetProperty(T.a.MeasurementContinuousLines,!1)?n.count>2&&t.getPhase()===k.a.CREATING_NEXT_POINT:n.count>=2&&t.getPhase()===k.a.CREATING)&&t.stopMeasuring()}})),this.input.registerHandler(Ut.f,(function(e){if(e.key===ye.a.SHIFT||e.key===ye.a.ALT){var n=e.modifiers,r=n.altKey,i=n.shiftKey,o=i&&r?ut.h.shiftAlt:r?ut.h.alt:i?ut.h.shift:ut.h.desktop;t.setConstraintStyle(o)}}))]},e.prototype.onUpdate=function(t){if(this.getPhase()!==k.a.CLOSED){var e=this.data.selectedGroupIndex,n=this.mobile?k.e.mobile[this.getPhase()]:k.e.desktop[this.getPhase()];for(var r in this.lineSidToPointMap){var i=this.lineDerivedDataFactory.get(r);if(i){i.opacity.tick(t);var o=this.lineSidToPointMap[r],a=this.pointGroups.groupFromPointIndex(o)===e?1:i.opacity.value,s=n&&!i.labelVisible?0:a;this.textRenderer.setTextOpacityByPoint(o,s),this.renderer.setLineOpacityByPoint(o,a)}}if(this.mobile)if(this.getPhase()===k.a.CONFIRMING_POINT)(c=(Date.now()-this.longPressStart)/this.threshold)<=1&&this.data.setPressProgress(c);else if(this.getPhase()===k.a.CREATING&&0!==this.data.pressProgress){var c=0;this.data.setPressProgress(c)}}},e.prototype.dispose=function(e){this.stopMeasuring(),this.toggleMeasuringMode(!1),this.lineColliders.dispose(),this.jointColliders.dispose(),this.textRenderer.dispose(),this.renderer.dispose(),e.disposeRenderLayer(this.name),t.prototype.dispose.call(this,e)},e}(s.a),Ae=n(23),De=n(38),Re=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ce=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Ie=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},ke=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="measure-mode",e._groups=[],e._groupMap={},e.phaseObservable=Object(De.b)(k.a.CLOSED),e.selectedGroupIndexObservable=new De.a(-1),e.pressProgressObservable=new De.a(-1),e.pointPositionObservable=new De.a(null),e}return Re(e,t),e.prototype.modeActive=function(){return this.phase!==k.a.CLOSED},e.prototype.groups=function(){var t,e,n,r,i;return Ce(this,(function(o){switch(o.label){case 0:o.trys.push([0,5,6,7]),n=Ie(this._groups),r=n.next(),o.label=1;case 1:return r.done?[3,4]:[4,r.value];case 2:o.sent(),o.label=3;case 3:return r=n.next(),[3,1];case 4:return[3,7];case 5:return i=o.sent(),t={error:i},[3,7];case 6:try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}return[7];case 7:return[2]}}))},Object.defineProperty(e.prototype,"selectedGroupSid",{get:function(){var t=this.selectedGroupInfo;return t&&t.info.sid?t.info.sid:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedGroupInfo",{get:function(){return-1===this.selectedGroupIndex?null:this.getGroupInfo(this.selectedGroupIndex)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"phase",{get:function(){return this.phaseObservable.value},enumerable:!0,configurable:!0}),e.prototype.setPhase=function(t){this.phase!==t&&(this.phaseObservable.value=t)},e.prototype.onPhaseChanged=function(t){return this.phaseObservable.onChanged(t)},Object.defineProperty(e.prototype,"groupCount",{get:function(){return this._groups.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedGroupIndex",{get:function(){return this.selectedGroupIndexObservable.value},enumerable:!0,configurable:!0}),e.prototype.setSelectedGroupIndex=function(t){this.selectedGroupIndexObservable.value=t},e.prototype.onSelectedGroupIndexChanged=function(t){return this.selectedGroupIndexObservable.onChanged(t)},Object.defineProperty(e.prototype,"pointPosition",{get:function(){return this.pointPositionObservable.value},enumerable:!0,configurable:!0}),e.prototype.setPointPosition=function(t){this.pointPositionObservable.value=t},e.prototype.onPointPositionChanged=function(t){return this.pointPositionObservable.onChanged(t)},e.prototype.setPressProgress=function(t){this.pressProgressObservable.value=t},Object.defineProperty(e.prototype,"pressProgress",{get:function(){return this.pressProgressObservable.value},enumerable:!0,configurable:!0}),e.prototype.onPressProgressChanged=function(t){return this.pressProgressObservable.onChanged(t)},e.prototype.getGroupInfo=function(t){return t<0||t>=this._groups.length?null:this._groups[t]},e.prototype.getGroupInfoBySid=function(t){return this._groupMap[t]},e.prototype.repopulate=function(t){var e,n;this.clear();try{for(var r=Ie(t),i=r.next();!i.done;i=r.next()){var o=i.value,a=o.clone();this._groups.push(a),this._groupMap[o.info.sid]=a}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},e.prototype.clear=function(){this._groups=[],this._groupMap={}},e.prototype.clone=function(){return(new e).copy(this)},e.prototype.copy=function(t){return this.repopulate(t._groups),this.setSelectedGroupIndex(t.selectedGroupIndex),this.setPressProgress(t.pressProgress),this.setPointPosition(t.pointPosition),this.setPhase(t.phase),this.commit(),this},e}(Ae.a),Le=n(554),Ne=n(68),je=n(54),Be=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},Fe=function(){function t(t,e,n,r,i,o,a,s){var c=this;this.points=t,this.createPointSubscription=e,this.cameraData=n,this.renderLayer=r,this.renderOrder=i,this.textRenderer=o,this.getLineDetails=a,this.isOrthographic=s,this.lengthCache=[],this.meshPool=[],this.groupsToMeshes={},this.textContainer=new D.zb,this.textGeometry=new D.Ib(1,1),this.tmpCamPos=new D.Jc,this.tmpMidpoint=new D.Jc,this.cameraRotation=new D.Pb,this.cameraProjection=new Ne.a,this.cameraPosition=new D.Jc,this.dataSubs=[this.createPointSubscription(tt.a.REMOVED,(function(t,e){var n=c.meshPool[e];n&&(c.textContainer.remove(n),c.meshPool[e]=null);for(var r=c.points.length-1;r<c.lengthCache.length-1;++r)c.lengthCache[r]=-1}))]}return t.prototype.reset=function(){var t,e;try{for(var n=Be(this.meshPool),r=n.next();!r.done;r=n.next()){var i=r.value;i&&this.textContainer.remove(i)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.meshPool=[],this.lengthCache=[]},t.prototype.init=function(){},t.prototype.dispose=function(){this.textGeometry.dispose()},t.prototype.activate=function(){var t,e;try{for(var n=Be(this.dataSubs),r=n.next();!r.done;r=n.next()){r.value.renew()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},t.prototype.deactivate=function(){var t,e;try{for(var n=Be(this.dataSubs),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.reset()},Object.defineProperty(t.prototype,"container",{get:function(){return this.textContainer},enumerable:!0,configurable:!0}),t.prototype.beforeRender=function(){var t=this.cameraData.pose;this.cameraRotation.copy(t.rotation),this.cameraPosition.copy(t.position),this.cameraProjection.copy(t.projection);for(var e=this.cameraData.height,n=this.cameraData.zoom(),r=this.cameraData.aspect(),i=1;i<this.points.length;++i){var o=i-1,a=this.points.groupFromPointIndex(i);if(a===this.points.groupFromPointIndex(o)){var s=this.points.get(o),c=this.points.get(i),u=this.getLineDetails(a,o,i);if(u){var l=this.setMeshVisible(i,u.labelVisible);if(l){l.text!==u.labelContents&&(l.text=u.labelContents);var h=this.cameraPosition.distanceTo(l.position);if(this.updateMeshPose(l,s,c,this.cameraRotation,this.cameraPosition,h,u.rotation),this.isOrthographic())l.scaleFactor=ut.c.SCALE_DISTANCE*n;else{var f=Object(Ct.f)(l.position,this.cameraPosition,this.cameraRotation,this.cameraProjection.asThreeMatrix4()),p=Math.abs(f.x);if(p<1){var d=Object(J.a)(this.cameraProjection,this.cameraPosition,l.position,e,ut.c.SCALE),y=(Object(It.e)(r,1,2.5)+n)*ut.c.SCALE_ASPECT,m=1+ut.c.SCALE_NDC-p*ut.c.SCALE_NDC-y;l.scaleFactor=Math.max(Math.min(1/d*m,3),.001)}else l.scaleFactor=.001}}}}}},t.prototype.setTextOpacityByGroup=function(t,e){var n,r,i=this.groupsToMeshes[t];if(i)try{for(var o=Be(i),a=o.next();!a.done;a=o.next()){a.value.opacity=e}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},t.prototype.setTextOpacityByPoint=function(t,e){var n=this.meshPool[t];n&&(n.opacity=e)},t.prototype.updateMeshPose=function(t,e,n,r,i,o,a){var s=this;this.tmpMidpoint.copy(e).add(n).multiplyScalar(.5);var c=this.isOrthographic()?void 0:function(t){return s.tmpCamPos.copy(i).sub(t).setLength(.15*o).add(t)};t.setPosition(this.tmpMidpoint,c),t.setOrientation(r,a)},t.prototype.render=function(){},t.prototype.setMeshVisible=function(t,e){var n=this.meshPool[t];if(!n&&e){(n=this.textRenderer.createLabel()).setRenderLayer(this.renderLayer),n.renderOrder=this.renderOrder,n.opacity=0,n.visible=!1;var r=this.points.groupFromPointIndex(t);n.userData.groupIndex=r,this.groupsToMeshes[r]||(this.groupsToMeshes[r]=[]),this.groupsToMeshes[r].push(n),this.textContainer.add(n)}if(n){var i=e?.001:je.c.LABEL_HIDDEN_OPACITY;if(n.visible=n.opacity>i,!n.visible)return null}return this.meshPool[t]=n,n},t}(),Ue=n(157),ze=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},Ge=function(){function t(t,e,n,r,i,o,a,s,c,u){void 0===a&&(a=function(){return-1}),void 0===u&&(u=16777215);var l=this;this.points=t,this.createPointSubscription=e,this.cameraData=n,this.lineModule=r,this.mainLayer=i,this.lineLayer=o,this.selectedGroup=a,this.isOrthographic=s,this.getLineDetails=c,this.lineColor=u,this.endpointGeometry=new D.Ib(1,1),this.linePool=[],this.groupToLines={},this.pointToLines={},this.activeLines=[],this.cameraQuaternion=new D.Pb,this.cameraPosition=new D.Jc,this.cameraProjection=new Ne.a,this.getLinesForPoint=function(t){var e,n,r=[];if(l.pointToLines[t])try{for(var i=ze(l.pointToLines[t]),o=i.next();!o.done;o=i.next()){var a=o.value,s=a.getMesh(Ue.a.line).userData,c=s.startIndex,u=s.endIndex,h=s.group;r.push({endIndex:u,startIndex:c,line:a,group:h})}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r},this.updateMaterialColors(this.lineColor),this.dataSubs=[this.createPointSubscription(tt.a.REMOVED,(function(t,e){l.resetLines()}))]}return t.prototype.updateMaterialColors=function(t){var e=je.d.lineDefault;this.lineMaterial=this.lineModule.makeLineMaterial(t,!0,{linewidth:e}),this.endpointMaterial=this.lineModule.makeEndpointMaterial(t);var n={dashed:!0,dashSize:.025,gapSize:.05,linewidth:je.d.dottedLineDefault};this.dottedLineMaterial=this.lineModule.makeLineMaterial(t,!1,n),this.xLineMaterial=this.lineModule.makeLineMaterial(W.x,!1,n),this.yLineMaterial=this.lineModule.makeLineMaterial(W.y,!1,n),this.zLineMaterial=this.lineModule.makeLineMaterial(W.z,!1,n),this.xzLineMaterial=this.lineModule.makeLineMaterial(W.xz,!1,n)},t.prototype.setLineOpacityByGroup=function(t,e){var n,r,i=this.groupToLines[t];if(i)try{for(var o=ze(i),a=o.next();!a.done;a=o.next()){a.value.opacity(e)}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},t.prototype.setLineOpacityByPoint=function(t,e){var n,r,i=this.getLinesForPoint(t);if(i)try{for(var o=ze(i),a=o.next();!a.done;a=o.next()){a.value.line.opacity(e)}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},t.prototype.resetLines=function(){var t,e;try{for(var n=ze(this.lines),r=n.next();!r.done;r=n.next()){var i=r.value;i.opacity(0),i.hide()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.groupToLines={},this.pointToLines={},this.lines.length=0},t.prototype.updateAllLines=function(){var t,e;if(!(this.points.length<1)){for(var n=0;n<this.points.length;n++)this.updateLine(n);for(var r in this.groupToLines){var i=Number(r),o=this.groupToLines[i];try{for(var a=ze(o),s=a.next();!s.done;s=a.next()){s.value.updateSelected(this.selectedGroup()===i)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}}}},t.prototype.init=function(){},t.prototype.dispose=function(){var t,e;this.deactivate();try{for(var n=ze(this.linePool),r=n.next();!r.done;r=n.next()){r.value.dispose()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.endpointGeometry.dispose(),this.dottedLineMaterial.dispose(),this.lineMaterial.dispose(),this.endpointMaterial.dispose(),this.xLineMaterial.dispose(),this.yLineMaterial.dispose(),this.zLineMaterial.dispose()},t.prototype.activate=function(){var t,e;try{for(var n=ze(this.dataSubs),r=n.next();!r.done;r=n.next()){r.value.renew()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},t.prototype.deactivate=function(){var t,e;try{for(var n=ze(this.dataSubs),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.resetLines()},Object.defineProperty(t.prototype,"lines",{get:function(){return this.activeLines},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dottedMaterial",{get:function(){return this.dottedLineMaterial},enumerable:!0,configurable:!0}),t.prototype.beforeRender=function(){this.cameraQuaternion.copy(this.cameraData.pose.rotation),this.cameraPosition.copy(this.cameraData.pose.position),this.cameraProjection.copy(this.cameraData.pose.projection),this.updateAllLines()},Object.defineProperty(t.prototype,"xMaterial",{get:function(){return this.xLineMaterial},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"yMaterial",{get:function(){return this.yLineMaterial},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"zMaterial",{get:function(){return this.zLineMaterial},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xzMaterial",{get:function(){return this.xzLineMaterial},enumerable:!0,configurable:!0}),t.prototype.render=function(){},t.prototype.updateLine=function(t){var e=this.points.get(t),n=this.points.get(t+1),r=this.points.groupFromPointIndex(t)===this.points.groupFromPointIndex(t+1);e&&n&&r&&this.setLinePosition(t,e,n)},t.prototype.setLinePosition=function(t,e,n){var r=this,i=this.linePool[t];if(!i){var o=this.points.groupFromPointIndex(t);if(!this.getLineDetails(o,t,t+1).visible)return;var a=je.d.endpointDefault>.01?this.endpointMaterial.clone():void 0;i=this.lineModule.makeLine(e,n,this.lineMaterial.clone(),a,(function(){return!r.isOrthographic()})),this.setupLine(i,t),i.setRenderLayer(this.mainLayer)}i.visible||this.setupLine(i,t),this.linePool[t]=i,i.updateResolution(this.cameraData.width,this.cameraData.height),i.updatePositions(e,n),i.updateBillboard({rotation:this.cameraQuaternion,position:this.cameraPosition,projection:this.cameraProjection})},t.prototype.setupLine=function(t,e){var n=this,r=this.points.groupFromPointIndex(e);t.children.forEach((function(t){t.userData.startIndex=e,t.userData.endIndex=e+1,t.userData.group=r,t.layers.mask=n.mainLayer.mask})),t.getMesh(Ue.a.line).layers.mask=this.lineLayer.mask,this.activeLines.push(t),this.addLineToGroup(r,t),this.addLineToPoint(e,t),this.addLineToPoint(e+1,t),t.show(),t.opacity(0)},t.prototype.addLineToGroup=function(t,e){this.groupToLines[t]||(this.groupToLines[t]=[]),this.groupToLines[t].push(e)},t.prototype.addLineToPoint=function(t,e){this.pointToLines[t]||(this.pointToLines[t]=[]),this.pointToLines[t].push(e)},t}(),He=n(30),Ve=n(312),We=function(){return(We=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},qe=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Ye=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},Je=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},Xe=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Je(arguments[e]));return t},Ke=function(){function t(t){this.contents=t,this.groupInfo=[],this.groupIndices=[],this.groupInfoMap={},this.groupIndicesMap={}}return t.prototype.startGroup=function(t){var e=0===this.groupCount,n=this.contents.length!==this.groupIndices[this.groupCount-1];if(e||n){var r=t.sid;if(!r)for(r=Object(Ve.a)();this.groupInfoMap.hasOwnProperty(r);)r=Object(Ve.a)();var i=We({},t,{sid:r});this.groupInfo.push(i),this.groupInfoMap[r]=i,this.groupIndices.push(this.contents.length),this.groupIndicesMap[this.contents.length]=!0}return this.groupIndices.length-1},t.prototype.reset=function(){var t=this;this.contents.atomic((function(){for(var e=t.contents.length-1;e>=0;--e)t.removeFromIdx(e);t.groupIndices=[],t.groupInfo=[],t.groupIndicesMap={}}))},t.prototype.isStartIndex=function(t){return!!this.groupIndicesMap[t]},t.prototype.groups=function(){var t;return qe(this,(function(e){switch(e.label){case 0:t=0,e.label=1;case 1:return t<this.groupCount?[4,this.getGroup(t)]:[3,4];case 2:e.sent(),e.label=3;case 3:return++t,[3,1];case 4:return[2]}}))},t.prototype[Symbol.iterator]=function(){var t,e,n,r,i;return qe(this,(function(o){switch(o.label){case 0:o.trys.push([0,5,6,7]),n=Ye(this.contents),r=n.next(),o.label=1;case 1:return r.done?[3,4]:[4,r.value];case 2:o.sent(),o.label=3;case 3:return r=n.next(),[3,1];case 4:return[3,7];case 5:return i=o.sent(),t={error:i},[3,7];case 6:try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}return[7];case 7:return[2]}}))},t.prototype.getGroupStartIndex=function(t){return this.groupIndices[t]},t.prototype.getGroup=function(t){var e=this.groupIndices[t],n=isNaN(this.groupIndices[t+1]-1)?this.contents.length-1:this.groupIndices[t+1]-1;return new Qe(t,this.contents,e,n,Object.assign({},this.groupInfo[t]))},Object.defineProperty(t.prototype,"groupCount",{get:function(){return this.groupIndices.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return this.contents.length},enumerable:!0,configurable:!0}),t.prototype.get=function(t){return this.contents.get(t)},t.prototype.push=function(t){if(0===this.groupCount)throw Error("Grouper: Error pushing points when we have no groups!");return this.contents.push(t.clone()),this.contents.length},t.prototype.pop=function(){return this.removeFromIdx(this.contents.length-1)},t.prototype.removeFromIdx=function(t){if(t<this.contents.length&&t>=0&&this.contents.length>=0){var e=this.contents.get(t);return this.contents.remove(t),this.removeEmptyGroups(),e}},t.prototype.removeEmptyGroups=function(){this.contents.length<=this.groupIndices[this.groupCount-1]&&this.removeGroup(this.groupCount-1)},t.prototype.groupFromPointIndex=function(t){if(0>t||t>=this.length)return-1;for(var e=this.groupCount-1;t<this.groupIndices[e];)--e;return e},t.prototype.removeGroup=function(t){if(!(t>this.groupCount||t<0)){var e=this.getGroup(t);if(0!==e.count){this.groupIndices.splice(t,1),this.groupInfo.splice(t,1),this.groupIndicesMap[t]=!1;for(var n=t;n<this.groupCount;++n)this.groupIndices[n]-=e.count,this.groupIndicesMap[n]=!0;this.contents.splice(e.startIndex,e.count)}}},t.prototype.update=function(t,e){this.contents.update(t,e.clone())},t.prototype.copy=function(t){var e=this;return this.contents.atomic((function(){var n,r,i,o;e.reset();try{for(var a=Ye(t),s=a.next();!s.done;s=a.next()){var c=s.value;e.startGroup(c.info);try{for(var u=Ye(c),l=u.next();!l.done;l=u.next()){var h=l.value;e.push(h)}}catch(t){i={error:t}}finally{try{l&&!l.done&&(o=u.return)&&o.call(u)}finally{if(i)throw i.error}}}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}})),this},t.prototype.toString=function(){return"Grouper: { groupCount: "+this.groupCount+", length: "+this.length+", groups: ["+Xe(this.groups()).map((function(t){return""+t}))+"]}"},t}(),Qe=function(){function t(t,e,n,r,i){this.index=t,this.grouper=e,this.startIndex=n,this.endIndex=r,this.data=i}return t.prototype[Symbol.iterator]=function(){var t;return qe(this,(function(e){switch(e.label){case 0:t=0,e.label=1;case 1:return t<this.count?[4,this.get(t)]:[3,4];case 2:e.sent(),e.label=3;case 3:return++t,[3,1];case 4:return[2]}}))},t.prototype.get=function(t){if(!this.has(t))throw RangeError("Out of range error "+t+" / "+(this.count-1));return this.grouper.get(this.startIndex+t)},t.prototype.has=function(t){return t>=0&&this.startIndex+t<=this.endIndex},Object.defineProperty(t.prototype,"count",{get:function(){return this.endIndex-this.startIndex+1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"info",{get:function(){return this.data},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isClosed",{get:function(){var t=this.grouper.get(this.startIndex),e=this.grouper.get(this.endIndex);return this.count>2&&t.distanceTo(e)<=ut.d},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){for(var t=0,e=null,n=0;n<this.count;n++)e&&(t+=this.get(n).distanceTo(e)),e=this.get(n);return t},enumerable:!0,configurable:!0}),t.prototype.hasLength=function(){var t=this.grouper.get(this.startIndex),e=this.grouper.get(this.endIndex);return this.isClosed||t.distanceTo(e)>ut.d},t.prototype.clone=function(){for(var e=[],n={get:function(t){return e[t]},contents:e},r=0;r<this.count;r++)n.contents.push(this.get(r));return new t(this.index,n,0,n.contents.length-1,Object.assign({},this.data))},t.prototype.describe=function(t){return void 0===t&&(t=this.endIndex),"GroupSegment"+this.index+"/"+this.startIndex+"/"+t+"}"},t.prototype.equals=function(t){if(this.count!==t.count||this.index!==t.index)return!1;if(Object(He.b)(this.info,t.info))return!1;for(var e=0;e<this.count;++e)if(!this.get(e).equals(t.get(e)))return!1;return!0},t}(),Ze=n(461);n.d(e,"MeasurementModeData",(function(){return ke})),n.d(e,"MeasuringPhase",(function(){return k.a})),n.d(e,"labelVisible",(function(){return k.e})),n.d(e,"MeasurementGroupData",(function(){return Le.MeasurementGroupData})),n.d(e,"MeasurementLabelRenderer",(function(){return Fe})),n.d(e,"MeasurementLineRenderer",(function(){return Ge})),n.d(e,"Grouper",(function(){return Ke})),n.d(e,"Group",(function(){return Qe})),n.d(e,"formatDistance",(function(){return Ze.a}));e.default=Oe},function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return s}));var r,i=n(155),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="hover",e}return o(e,t),e}(i.a),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="unhover",e}return o(e,t),e}(i.a)},function(t,e,n){"use strict";n.d(e,"c",(function(){return a})),n.d(e,"e",(function(){return s})),n.d(e,"a",(function(){return c})),n.d(e,"d",(function(){return u})),n.d(e,"g",(function(){return l})),n.d(e,"b",(function(){return h})),n.d(e,"f",(function(){return f}));var r,i=n(9),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n){var r=t.call(this)||this;return r.sid=e,r.hovering=n,r}return o(e,t),e}(i.a),s=function(t){function e(e){var n=t.call(this)||this;return n.sid=e,n}return o(e,t),e}(i.a),c=function(t){function e(e){var n=t.call(this)||this;return n.sid=e,n}return o(e,t),e}(i.a),u=function(t){function e(e,n){var r=t.call(this)||this;return r.url=e,r.embed=n,r}return o(e,t),e}(i.a),l=function(t){function e(e,n){var r=t.call(this)||this;return r.sid=e,r.view=n,r}return o(e,t),e}(i.a),h=function(t){function e(e){var n=t.call(this)||this;return n.fullSized=e,n}return o(e,t),e}(i.a),f=function(t){function e(e){var n=t.call(this)||this;return n.expanded=e,n}return o(e,t),e}(i.a)},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(0),a=n(157),s=n(126),c=n(18),u=n(25),l=n(82),h=n(100),f=n(54),p=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),d=function(){return(d=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},y=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},m=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},v=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},g=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.name="lines",n.makeLineMaterial=function(t,n,r,i,o){return void 0===r&&(r={}),e.makeLineMaterial(t,n,r,i,o)},n.makeEndpointMaterial=function(t,n,r){return e.makeEndpointMaterial(t,n,r)},n.onCanvasChange=function(t){var e,r;try{for(var i=v(n.segments),o=i.next();!o.done;o=i.next()){o.value.updateResolution(t.width,t.height)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}},n}return p(e,t),e.prototype.init=function(t,e){return y(this,void 0,void 0,(function(){var t,n,r;return m(this,(function(i){switch(i.label){case 0:return[4,e.getModule(u.default)];case 1:return t=i.sent(),this.scene=t.getScene(),n=this,[4,e.market.waitForData(h.a)];case 2:return n.canvas=i.sent(),r=this,[4,e.market.waitForData(c.a)];case 3:return r.cameraData=i.sent(),this.bindings.push(this.canvas.onChanged(this.onCanvasChange)),this.cameraPosition=new o.Jc,this.segments=[],[2]}}))}))},e.prototype.onUpdate=function(){this.cameraPosition.copy(this.cameraData.pose.position)},e.prototype.dispose=function(e){t.prototype.dispose.call(this,e),this.segments.forEach((function(t){return t.dispose()}))},e.prototype.makeLine=function(t,e,n,r,i){var o=this;void 0===i&&(i=function(){return!1});var s=i()?f.c.OFFSET_TOWARDS_CAMERA:0,c=i()?function(t){return o.cameraPosition.clone().sub(t).setLength(s).add(t)}:function(t){return t},u=new a.b(t,e,n,{beforeUpdatePositions:c,onShow:function(){return u.children.forEach((function(t){return o.scene.addChild(l.a.Root,t)}))},onHide:function(){return u.children.forEach((function(t){return o.scene.removeChild(l.a.Root,t)}))}},r);return u.updateResolution(this.canvas.width,this.canvas.height),u.opacity(1),u.show(),u.updatePositions(t,e),this.segments.push(u),u},e.textures=new s.g,e.makeLineMaterial=function(t,n,r,i,a){void 0===r&&(r={});var c=a||e.textures.get(s.f.LINE_HOVER),u=i||e.textures.get(s.f.LINE_DEFAULT);return n?new s.e(d({color:new o.s(t)},r),c,u):new s.e(d({color:new o.s(t)},r))},e.makeEndpointMaterial=function(t,n,r){var i=r||e.textures.get(s.f.END_HOVER),a=n||e.textures.get(s.f.END_DEFAULT);return new s.c(new o.s(t),a,i)},e}(i.a);e.default=g},function(t,e,n){"use strict";n.d(e,"a",(function(){return h})),n.d(e,"b",(function(){return f}));var r,i=n(125),o=n(30),a=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},c=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},u=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},l=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(u(arguments[e]));return t},h=function(t){function e(){var e=t.call(this)||this;return e.isObservableArray=!0,e.elements=[],e}return a(e,t),e.prototype.push=function(t){return this.elements.push(t),this.addChildObservable(t),this.setDirty(),this.length},e.prototype.concat=function(t){var e=this.elements.length;this.elements=this.elements.concat(t);for(var n=e;n<this.elements.length;n++)this.addChildObservable(this.elements[n]);return this.setDirty(),this.length},e.prototype.replace=function(t){var e,n;try{for(var r=c(this.elements),i=r.next();!i.done;i=r.next()){var o=i.value;this.removeChildObservables(o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return this.elements=[],this.concat(t)},e.prototype.remove=function(t){if(t<0||t>=this.length)throw new Error("Index "+t+" not in range of ObservableArray");var e=u(this.elements.splice(t,1),1)[0];this.removeChildObservables(e),this.setDirty()},e.prototype.update=function(t,e){var n=this.elements[t];n!==e&&(this.elements[t]=e,this.removeChildObservables(n),this.addChildObservable(e),this.setDirty())},Object.defineProperty(e.prototype,"length",{get:function(){return this.elements.length},set:function(t){if(t<this.elements.length){for(var e=this.elements.length-1;e>=t;e--){var n=this.elements[e];this.removeChildObservables(n)}this.elements.length=t,this.setDirty()}},enumerable:!0,configurable:!0}),e.prototype.values=function(){return l(this.elements)},e.prototype.filter=function(t){return this.elements.filter(t)},e.prototype[Symbol.iterator]=function(){var t,e,n,r,i;return s(this,(function(o){switch(o.label){case 0:o.trys.push([0,5,6,7]),n=c(this.elements),r=n.next(),o.label=1;case 1:return r.done?[3,4]:[4,r.value];case 2:o.sent(),o.label=3;case 3:return r=n.next(),[3,1];case 4:return[3,7];case 5:return i=o.sent(),t={error:i},[3,7];case 6:try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}return[7];case 7:return[2]}}))},e.prototype.map=function(t){return this.elements.map(t)},e.prototype.forEach=function(t){this.elements.forEach(t)},e.prototype.get=function(t){return this.elements[t]},e.prototype.findIndex=function(t){return this.elements.findIndex(t)},e.prototype.indexOf=function(t){return this.elements.indexOf(t)},e.prototype.splice=function(t,e){for(var n,r,i,o,a,s,u=[],h=2;h<arguments.length;h++)u[h-2]=arguments[h];if(u.length){s=(n=this.elements).splice.apply(n,l([t,e],u));try{for(var f=c(u),p=f.next();!p.done;p=f.next()){var d=p.value;this.addChildObservable(d)}}catch(t){r={error:t}}finally{try{p&&!p.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}}else s=this.elements.splice(t,e);try{for(var y=c(s),m=y.next();!m.done;m=y.next()){d=m.value;this.removeChildObservables(d)}}catch(t){o={error:t}}finally{try{m&&!m.done&&(a=y.return)&&a.call(y)}finally{if(o)throw o.error}}return this.setDirty(),s},e.prototype.insert=function(t,e){if(t>this.elements.length)throw new Error("Tried to insert at index "+t+" in an array that's only "+this.elements.length+" long");t!==this.elements.length?(this.elements.splice(t,0,e),this.addChildObservable(e),this.setDirty()):this.push(e)},e.prototype.shift=function(){var t=this.elements.shift();return t&&(this.removeChildObservables(t),this.setDirty()),t},e.prototype.move=function(t,e){if(e>this.elements.length-1)throw Error("Index to move to is out of bounds");var n=this.elements[t];this.elements.splice(t,1),this.elements.splice(e,0,n),this.setDirty()},e.prototype.onElementChanged=function(t){var e=this,n=this.elements.slice();return this.onChanged((function(){for(var r in n){var o=parseInt(r,10);t.onRemoved&&void 0===e.get(o)&&t.onRemoved(n[o],o)}for(var r in e.elements){o=parseInt(r,10);var a=e.get(o);void 0===n[o]?t.onAdded&&t.onAdded(a,o):(i.a.isObservable(a)&&a._dirtyObservable||a!==n[o])&&(t.onUpdated?t.onUpdated(a,o):t.onRemoved&&null===a&&t.onRemoved(n[o],o))}n=e.elements.slice()}))},e.prototype.deepCopy=function(){return this.map((function(t){return Object(o.a)(t)}))},e}(i.a),f=function(t){var e=new h;return t&&e.concat(t),e}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"c",(function(){return h})),n.d(e,"b",(function(){return f}));var r,i=n(0),o=n(7),a=n(1),s=n(2),c=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},u=new s.a("snapshot-serializer");!function(t){t.user="user",t.panorama="panorama",t.unaligned="unaligned",t.auto="auto",t.tour="tour"}(r||(r={}));var l=function(){function t(t,e,n,i,o,a,s,c,u,l,h,f){this.sid=t||"",this.metadata=e||{},this.thumbnailUrl=n||"",this.imageUrl=i||"",this.name=o||"",this.is360=!!a,this.category=s||r.user,this.height=c||0,this.width=u||0,this.modified=l||new Date,this.visionLabel=h||"",this.visionName=f||""}return t.prototype.clone=function(){return(new t).copy(this)},t.prototype.copy=function(t){return this.sid=t.sid,this.thumbnailUrl=t.thumbnailUrl,this.imageUrl=t.imageUrl,this.name=t.name,this.is360=t.is360,this.category=t.category,this.height=t.height,this.width=t.width,this.modified=t.modified,this.visionLabel=t.visionLabel,this.visionName=t.visionName,this.metadata={camera_mode:t.metadata.camera_mode,camera_position:t.metadata.camera_position.clone(),camera_quaternion:t.metadata.camera_quaternion.clone(),scan_id:t.metadata.scan_id,ortho_zoom:t.metadata.ortho_zoom,floor:t.metadata.floor,ss_zoom:t.metadata.ss_zoom,floorVisibility:t.metadata.floorVisibility},this},t.prototype.isInsidePano=function(){return this.metadata.camera_mode===a.a.Panorama&&""!==this.metadata.scan_id},t}(),h=function(t){var e,n,r={};if(!t||!t.images||t.images.length<1)return r;var i=t.images,o=t.icon;try{for(var a=c(Object.keys(i)),s=a.next();!s.done;s=a.next()){var u=s.value,l=f(i[u]);l&&(l.icon=l.sid===o,r[l.sid]=l)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return r},f=function(t){var e=null;if(!t)return e;if(!t.metadata||0===Object.keys(t.metadata).length)return u.warn("Image has no metadata: "+t.sid),e;var n=t.metadata;if("string"==typeof t.metadata)try{n=JSON.parse(t.metadata)}catch(e){return u.warn("Image metadata parse failed: "+t.sid),null}var r,s=-1;if("object"==typeof n.floor_visibility)for(var c=0;c<n.floor_visibility.length;c++)!0===n.floor_visibility[c]&&(s=c);"number"==typeof n.highest_floor&&(s=n.highest_floor);try{var h=Object(a.c)(3===n.camera_mode?0:n.camera_mode),f=Object(o.i)(n.camera_position?n.camera_position:new i.Jc),p=Object(o.h)(n.camera_quaternion||new i.Pb);h!==a.a.Floorplan&&(p=Object(o.m)(p)),r={camera_mode:h,camera_position:f,camera_quaternion:p,scan_id:n.scan_id,ortho_zoom:n.ortho_zoom,floor:s,ss_zoom:n.ss_zoom||1,floorVisibility:n.floorVisibility}}catch(e){return u.debug("Image metadata parse failed: ",t.sid,e),null}var d=t.name&&(!t.name.match(/^[0-9.]+_[0-9.]+$/)||"")&&t.name||"";return e=new l(t.sid,r,t.thumbnail_signed_src,t.signed_src,d,"unaligned"===t.category,t.category,t.height,t.width,new Date(Date.parse(t.modified)),t.vision_generated_label,t.vision_generated_name)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r,i=n(13),o=n(58),a=n(213),s=n(39),c=n(24),u=new(n(2).a)("panoqualitymanager");!function(t){t[t.Untested=0]="Untested",t[t.Testing=1]="Testing",t[t.Success=2]="Success",t[t.Fail=3]="Fail"}(r||(r={}));var l=function(){function t(t,e,n,r){this.urls=t,this.maxCubemapSize=e,this.maxNavPanoSize=n,this.maxZoomPanoSize=r,this.overrideWindow=!1,this.devicePixelRatio=window.devicePixelRatio||1,this.navPanoSize=-1,this.zoomPanoSize=-1,this.windowHeight=window.innerHeight*this.devicePixelRatio,this.highQualityThreshold=o.c.windowHeightHighQualityThresholdOverride||o.c.windowHeightHighQualityThreshold,this.persistentStorage=new a.a,this.downloadTestResults={},this.updateMaximums()}return t.prototype.setWindowSize=function(t,e){this.windowHeight=e*this.devicePixelRatio,this.updateMaximums()},t.prototype.overrideWindowMaximums=function(t){this.overrideWindow=t,this.updateMaximums()},t.prototype.updateNavPanoSize=function(t){this.maxNavPanoSize=t,this.updateMaximums()},t.prototype.getTestResults=function(t,e){var n=this.downloadTestResults[t];if(n){var i=n[e];if(i)return i}return r.Untested},t.prototype.ultraHighQualityModeEnabled=function(t){var e=i.b[this.getZoomPanoSize()],n=this.downloadTestResults[t];return!(!n||!n[e])&&n[e]===r.Success},t.prototype.updateMaximums=function(){this.windowHeight<this.highQualityThreshold&&!this.overrideWindow?(this.navPanoSize=Math.min(t.getPanoSize(i.d.STANDARD),this.maxNavPanoSize),this.zoomPanoSize=Math.min(t.getPanoSize(i.d.HIGH),this.maxZoomPanoSize)):(this.navPanoSize=this.maxNavPanoSize,this.zoomPanoSize=this.maxZoomPanoSize),this.zoomPanoSize<this.navPanoSize&&(this.navPanoSize=this.zoomPanoSize),this.zoomPanoSize=Math.min(this.maxCubemapSize,this.zoomPanoSize),this.navPanoSize=Math.min(this.maxCubemapSize,this.navPanoSize)},t.getPanoSize=function(t){if(t in i.a)return i.a[t];throw new Error("Not a panoSizeClass: "+t)},t.getPanoSizeClass=function(t){if(t in i.b)return i.b[t];throw new Error("Not a valid pano resolution: "+t)},t.prototype.getMaxPossiblePanoSize=function(){return t.getPanoSize(i.d.ULTRAHIGH)},t.prototype.getNavPanoSize=function(){return this.navPanoSize},t.prototype.getZoomPanoSize=function(){return this.zoomPanoSize},t.prototype.availableResolution=function(t,e){var n=this,i=new c.a;switch(e<1&&i.reject(0),this.getTestResults(t,e)){case r.Success:i.resolve(e);break;case r.Fail:return this.availableResolution(t,e-1);case r.Untested:this.testDownload(t,e,s.b).then((function(r){r?i.resolve(e):n.availableResolution(t,e-1).then((function(t){return i.resolve(t)}))}));break;case r.Testing:u.warn("resolution is already testing, do we need to handle this?")}return i},t.prototype.testDownload=function(e,n,i){var o=this;if(!this.urls)throw new Error("Can't call testDownload without signed urls");var a=t.getPanoSize(n),s=new c.a;this.downloadTestResults[e]||(this.downloadTestResults[e]={});var u=this.downloadTestResults[e]&&this.downloadTestResults[e][n];if(u)u===r.Success?s.resolve(!0):u===r.Fail&&s.resolve(!1);else{this.downloadTestResults[e][n]=r.Testing;var l=this.getTileUrl(e,a,i,0);this.urls.getImage(l,{maxRetries:0}).then((function(t){o.downloadTestResults[e][n]=r.Success,s.resolve(!0)}),(function(){o.downloadTestResults[e][n]=r.Fail,s.resolve(!1)}))}return s},t.prototype.getTileUrl=function(t,e,n,r){var i=this.persistentStorage.get("getTileUrl:sizeMap",(function(){return{256:"256",512:"512",1024:"1k",2048:"2k",4096:"4k"}})),o=this.persistentStorage.get("getTileUrl:sizeMap",(function(){return{face:-1,faceTileIndex:-1,tileX:-1,tileY:-1}}));s.f(e,r,o);var a=Math.floor(e/n),c=a*a,u=Math.floor(r/c);return"tiles/"+t+"/"+i[e]+"_face"+u+"_"+o.tileX+"_"+o.tileY+".jpg"},t}();e.b=l},function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return r}));var r,i={bgPrimary:"#0F1011",bgSecondary:"#1e2023",gridPrimary:"#2d3035",gridSecondary:"#171a1c"},o={black:i,grey:{bgPrimary:"#c9cbcc",bgSecondary:"#9d9d9e",gridPrimary:"#c9cbcc",gridSecondary:"#b0b1b1"},white:{bgPrimary:"#fcfdff",bgSecondary:"#ced0d3",gridPrimary:"#fcfdff",gridSecondary:"#e2e3e5"},default:i};!function(t){t.black="black",t.grey="grey",t.white="white",t.default="black"}(r||(r={}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return l}));var r,i=n(0),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},s=function(){function t(e,n){var r,o,s=this;this.raycast=(r=new i.Jc,o=new i.h,function(e,n,i){var c,h,f=o.copy(s.bounds).expandByScalar(n);if(e.ray.intersectsBox(f))try{for(var p=a(s.children),d=p.next();!d.done;d=p.next()){var y=d.value;if(y instanceof t)y.raycast(e,n,i);else if(y instanceof u){var m=r,v=e.ray.distanceSqToSegment(y.start,y.end,void 0,r);(g=Math.sqrt(v))<n&&i.push({distance:e.ray.origin.distanceTo(m),object:y,distanceToRay:g,point:m.clone(),isLineOctreeIntersection:!0})}else if(y instanceof l){var g;(g=e.ray.distanceToPoint(y))<n&&i.push({distance:e.ray.origin.distanceTo(y),object:y,distanceToRay:g,point:y.clone(),isLineOctreeIntersection:!0})}}}catch(t){c={error:t}}finally{try{d&&!d.done&&(h=p.return)&&h.call(p)}finally{if(c)throw c.error}}}),this.level=n,this.bounds=e.clone(),this.childNodes=[],this.children=[]}return t.prototype.add=function(t){var e,n,r=!1,o=t instanceof i.U?[t.start,t.end]:[t];if(this.level<4){0===this.childNodes.length&&this.buildChildNodes();var s=function(e){o.every((function(t){return e.bounds.containsPoint(t)}))&&(r=!0,e.add(t))};try{for(var c=a(this.childNodes),u=c.next();!u.done;u=c.next()){s(u.value)}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(e)throw e.error}}}r||this.children.push(t)},t.prototype.remove=function(e){for(var n=e instanceof i.U?[e.start,e.end]:[e],r=function(r){var i=o.children[r];if(i instanceof t){if(n.every((function(t){return i.bounds.containsPoint(t)}))&&i.remove(e))return{value:!0}}else if(i===e)return o.children.splice(r,1),{value:!0}},o=this,a=0;a<this.children.length;a++){var s=r(a);if("object"==typeof s)return s.value}return!1},t.prototype.buildChildNodes=function(){for(var e=this.bounds.max.clone().sub(this.bounds.min).clone().multiplyScalar(.5),n=0;n<2;n++)for(var r=0;r<2;r++)for(var o=0;o<2;o++){var a=this.bounds.min.x+e.x*o,s=a+e.x,c=this.bounds.min.y+e.y*n,u=c+e.y,l=this.bounds.min.z+e.z*r,h=l+e.z,f=new t(new i.h(new i.Jc(a,c,l),new i.Jc(s,u,h)),this.level+1);this.childNodes.push(f),this.children.push(f)}},t.prototype.spherecast=function(e,n){var r,o;if(e.intersectsBox(this.bounds))try{for(var s=a(this.children),c=s.next();!c.done;c=s.next()){var h=c.value;if(h instanceof t)h.spherecast(e,n);else if(h instanceof u){var f=h.closestPointToPoint(e.center,!0,new i.Jc);f.distanceTo(e.center)<e.radius&&n.push(new l(f,h.roomIndex,h.floorIndex))}else h instanceof i.Jc&&h.distanceTo(e.center)<e.radius&&n.push(h)}}catch(t){r={error:t}}finally{try{c&&!c.done&&(o=s.return)&&o.call(s)}finally{if(r)throw r.error}}},t.prototype.traverse=function(e){var n,r;try{for(var i=a(this.children),o=i.next();!o.done;o=i.next()){var s=o.value;s instanceof t?s.traverse(e):e(s)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t}(),c=function(){function t(t){this.pointCount=0,this.lineCount=0,this.root=new s(t,0)}return t.prototype.add=function(t){t instanceof i.U?this.lineCount++:t instanceof i.Jc&&this.pointCount++,this.root.add(t)},t.prototype.remove=function(t){t instanceof u?this.lineCount--:t instanceof l&&this.pointCount--,this.root.remove(t)},t.prototype.traverse=function(t){this.root.traverse(t)},t.prototype.raycast=function(t,e){var n=[];return this.root.raycast(t,e,n),n},t}();e.c=c;var u=function(t){function e(e,n,r,i){var o=t.call(this,e,n)||this;return o.start=e,o.end=n,o.roomIndex=r,o.floorIndex=i,o.isSnapLine3=!0,o}return o(e,t),e.prototype.copy=function(t){return this.start.copy(t.start),this.end.copy(t.end),this.roomIndex=t.roomIndex,this.floorIndex=t.floorIndex,this},e.prototype.clone=function(){return new e(this.start,this.end,this.roomIndex,this.floorIndex)},e}(i.U),l=function(t){function e(e,n,r){var i=t.call(this)||this;return i.point=e,i.roomIndex=n,i.floorIndex=r,i.isSnapVector3=!0,t.prototype.copy.call(i,e),i}return o(e,t),e.prototype.copy=function(t){return this.point.copy(t.point),this.roomIndex=t.roomIndex,this.floorIndex=t.floorIndex,this},e.prototype.clone=function(){return new e(this.point,this.roomIndex,this.floorIndex)},e}(i.Jc)},function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"===("undefined"==typeof window?"undefined":n(window))&&(r=window)}t.exports=r},function(t,e){function n(t,e){if(!t)throw new Error(e||"Assertion failed")}t.exports=n,n.equal=function(t,e,n){if(t!=e)throw new Error(n||"Assertion failed: "+t+" != "+e)}},function(t,e,n){"use strict";n.r(e);var r,i=n(2),o=n(6),a=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},s=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},c=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},u=new i.a("api"),l=function(){function t(t,e){this.api=t,this.baseUrl=e,this.loggedIn=!1}return t.prototype.load=function(){return a(this,void 0,Promise,(function(){var t,e,n,r,i,a,l,h,f,p,d,y,m,v;return s(this,(function(s){switch(s.label){case 0:i=this.baseUrl+"/api/v1/user/",s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.api.get(i,{responseType:"json"})];case 2:return a=s.sent(),[3,4];case 3:throw l=s.sent(),u.error("Failed to get User data"),l;case 4:if(this.sid=a.user_sid,this.firstName=a.first_name,this.lastName=a.last_name,this.email=a.email,this.loggedIn=!!a.user_sid,this.flags=new Set(a.flags),a.memberships){h=Object(o.A)("organization","");try{for(f=c(a.memberships),p=f.next();!p.done;p=f.next())if(d=p.value,""===h||d.organization_sid===h)try{for(y=c(d.flags),m=y.next();!m.done;m=y.next())v=m.value,this.flags.add(v)}catch(t){n={error:t}}finally{try{m&&!m.done&&(r=y.return)&&r.call(y)}finally{if(n)throw n.error}}}catch(e){t={error:e}}finally{try{p&&!p.done&&(e=f.return)&&e.call(f)}finally{if(t)throw t.error}}}return[2]}}))}))},t.prototype.getFlags=function(t){void 0===t&&(t="");var e=new Set;return this.flags.forEach((function(n){if(0===n.indexOf(t)){var r=n.replace(t,"");e.add(r)}})),e},t}(),h=n(92),f=n(24),p=n(194),d=n(242),y=n(306),m=function(){return(m=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},v=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},g=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},b=new i.a("api"),w=Object.freeze({cacheClearTimeout:6e4,retryTimeout:1e3}),_=function(){function t(t,e,n){void 0===e&&(e={}),void 0===n&&(n=window.location.origin);var r=this;this.prefetchedData=e,this.baseUrl=n,this._configCache={},t||(t=new h.RequestQueue({retries:0})),this.queue=t,setTimeout((function(){r.prefetchedData={}}),w.cacheClearTimeout),this.needAuth={}}return t.prototype.init=function(t){return v(this,void 0,void 0,(function(){var e;return g(this,(function(n){switch(n.label){case 0:return this.user=new l(this,this.baseUrl),e=[this.user.load()],t&&e.push(this.getConfigs(t)),[4,Promise.all(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.get=function(t,e){var n=this;if(e&&e.prefetchFrom&&this.prefetchedData[e.prefetchFrom])return Promise.resolve(this.prefetchedData[e.prefetchFrom]);var r=m({},e);this.needAuth[t]&&(r=this.addAuthToOptions(e));var i=this.queue.get(t,r).then((function(t){if(null===t)throw Error("Data from get was null, possibly unparsable JSON");return t})).catch((function(e){return!n.needAuth[t]&&e.status_code>=400&&e.status_code<500?(r=n.addAuthToOptions(r),n.queue.get(t,r).then((function(e){return n.needAuth[t]=!0,e}))):i}));return i},t.prototype.addAuthToOptions=function(t){return this.authToken||(this.authToken=Object(p.b)()),m({},t,{auth:this.authToken})},t.prototype.getImage=function(t,e){return this.get(t,m({},e,{responseType:"image"}))},t.prototype.getImageBitmap=function(t,e,n,r){return void 0===r&&(r={}),v(this,void 0,Promise,(function(){var i,o,a;return g(this,(function(s){switch(s.label){case 0:return"createImageBitmap"in window?(i=-1!==t.indexOf("?"),o=t+(i?"&":"?")+"imgopt=1",[4,this.get(o,m({},r,{responseType:"blob"}))]):[3,2];case 1:return a=s.sent(),[2,createImageBitmap(a,0,0,e,n,{imageOrientation:r.flipY?"flipY":"none"})];case 2:return[2,this.getImage(t,r)]}}))}))},t.prototype.getImageViaBrowser=function(t,e){void 0===e&&(e=3);var n=new f.a,r=new Image,i=this,o=function(){i.getImageViaBrowser(t,e-1).then(n.resolve.bind(n)).progress(n.notify.bind(n)).catch(n.reject.bind(n))};return r.onerror=function(){e>0?setTimeout(o,1e3):n.reject()},r.onload=function(){n.resolve(r)},r.crossOrigin="anonymous",r.src=t,n.promise()},t.prototype.getConfigs=function(t,e){return v(this,void 0,Promise,(function(){var n,r,i;return g(this,(function(o){switch(o.label){case 0:if(t=t.toLowerCase(),!e&&this._configCache[t])return[2,this._configCache[t]];n=e?{responseType:"json"}:{responseType:"json",prefetchFrom:"config"},r={},i=this.baseUrl+"/api/v1/config/"+t,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.get(i,n)];case 2:return r=o.sent(),[3,4];case 3:return o.sent(),b.warn("Failed to load config from "+i+", ignoring"),[3,4];case 4:return e||(this._configCache[t]=r),[2,r||{}]}}))}))},t.prototype.getAppKey=function(t,e,n){return v(this,void 0,Promise,(function(){var r;return g(this,(function(i){switch(i.label){case 0:return""===t||""===e?[2,null]:[4,this.getConfigs(t,n)];case 1:return(r=i.sent()).hasOwnProperty(e)?[2,r[e]]:[2,null]}}))}))},t.prototype.getGeoIpLocation=function(){return v(this,void 0,Promise,(function(){return g(this,(function(t){return[2,this.queue.get("https://static.matterport.com/geoip/",{responseType:"json",priority:h.RequestPriority.LOW})]}))}))},t.prototype.modelExists=function(t,e){return void 0===e&&(e={ignorePrefetch:!1}),v(this,void 0,Promise,(function(){var n,r,i,o,a=this;return g(this,(function(s){if(!e.ignorePrefetch&&this.prefetchedData&&this.prefetchedData.model){if(!(n=this.prefetchedData.model).sid&&n.has_public_access_password)throw new d.c("Model requires a password");return[2,n.sid===t]}return r=this.baseUrl+"/api/v2/models/"+t+"/",i={"Content-Type":"application/json"},(o=Object(p.b)())&&(i.Authorization=o),[2,fetch(r,{method:"GET",headers:i}).then((function(t){return v(a,void 0,void 0,(function(){var e;return g(this,(function(n){switch(n.label){case 0:return t.ok?[2,!0]:[4,t.json().catch((function(t){return{}}))];case 1:if((e=n.sent())&&e.code===y.a.ACCESS_TOKEN_REQUIRED)throw new d.c("Access token required (401)");if(403===t.status)throw new d.a("Access denied (403)");throw new d.b("Model not found (404)")}}))}))}))]}))}))},t.prototype.getQueue=function(){return this.queue},t}(),x=n(4),S=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),T=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},M=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},E=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="api-client",e}return S(e,t),e.prototype.init=function(t,e){return T(this,void 0,void 0,(function(){return M(this,(function(e){switch(e.label){case 0:return this.api=new _(t.queue,t.prefetchedData,t.baseUrl),[4,this.api.init(t.preloadConfig)];case 1:return e.sent(),[2]}}))}))},e.prototype.getApi=function(){return this.api},e}(x.a);e.default=E},function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return o}));var r=n(6),i="features/roomnav",o={longerTransitionMaxDist:10,debugMenu:!!Object(r.A)("debug","").includes("nav"),TRANSITION_TIME_DH:650}},function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t.MDS="mds",t.JSONSTORE="jsonstore"}(r||(r={}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"c",(function(){return c})),n.d(e,"b",(function(){return u})),n.d(e,"d",(function(){return l}));var r=n(20),i=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},o=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},a=null,s=function(t,e){return i(void 0,void 0,Promise,(function(){var r,i,s,c;return o(this,(function(o){switch(o.label){case 0:return a?[3,2]:[4,n.e(3).then(n.bind(null,931))];case 1:r=o.sent(),a=r.createJpegEncodeWorker(),o.label=2;case 2:return i=new Uint8Array(t.width*t.height*4),t.readRenderTargetData(i),s=i.buffer,[4,a.exec({data:s,width:t.width,height:t.height,options:{exif:e,quality:85,flipY:!0}},[s])];case 3:return c=o.sent(),[2,new Uint8Array(c.data)]}}))}))},c=function(t){return new Blob([t],{type:"image/jpeg"})},u=function(t){return"data:image/jpg;base64,"+Object(r.o)(t)},l=function(t,e,n,r){return'http://ns.adobe.com/xap/1.0/\0<?xpacket begin="" id="W5M0MpCehiHzreSzNTczkc9d"?><x:xmpmeta xmlns:x="adobe:ns:meta/"><rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:GPano="http://ns.google.com/photos/1.0/panorama/"><GPano:CroppedAreaImageHeightPixels>'+e+"</GPano:CroppedAreaImageHeightPixels><GPano:CroppedAreaImageWidthPixels>"+t+"</GPano:CroppedAreaImageWidthPixels><GPano:CroppedAreaLeftPixels>0</GPano:CroppedAreaLeftPixels><GPano:CroppedAreaTopPixels>0</GPano:CroppedAreaTopPixels><GPano:FullPanoHeightPixels>"+e+"</GPano:FullPanoHeightPixels><GPano:FullPanoWidthPixels>"+t+"</GPano:FullPanoWidthPixels><GPano:ProjectionType>equirectangular</GPano:ProjectionType><GPano:UsePanoramaViewer>True</GPano:UsePanoramaViewer><GPano:InitialViewHeadingDegrees>"+n+"</GPano:InitialViewHeadingDegrees><GPano:InitialViewPitchDegrees>"+r+'</GPano:InitialViewPitchDegrees><GPano:CaptureSoftware>Matterport Camera</GPano:CaptureSoftware><GPano:StitchingSoftware>Matterport Cloud</GPano:StitchingSoftware></rdf:Description></rdf:RDF></x:xmpmeta><?xpacket end="w"?>'}},,function(t,e,n){"use strict";n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o}));n(0);var r=function(t,e,n){void 0===n&&(n=0);var r=[0,0,0,n];return e.toArray(r),t.fromArray(r),t},i=function(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z},o=function(t){return!t||!Object.values(t).filter((function(t){return 0!==t})).length}},function(t,e,n){"use strict";var r,i=n(0),o=n(608),a=n.n(o),s=n(609),c=n.n(s),u=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=function(t){function e(n,r){var o=i.Bc.clone(e.uniforms);return o.tMask.value=n,o.tPinHole.value=r,t.call(this,{vertexShader:a.a,fragmentShader:c.a,uniforms:o,name:"PinMaterial",transparent:!0})||this}return u(e,t),e.uniforms={tMask:{type:"t",value:null},tPinHole:{type:"t",value:null},pinColor:{type:"c",value:new i.s},opacity:{type:"f",value:1}},e}(i.cc),h=n(48),f=n(7),p=n(42),d=n(166),y=n(163),m=n(610),v=n.n(m);n.d(e,"a",(function(){return b})),n.d(e,"b",(function(){return w}));var g=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),b=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return g(e,t),e}(i.lb),w=function(t){function e(n,r,i){var o=this,a=new l(e.pinTexture,r);return(o=t.call(this,e.geometry,a)||this).name="PinMesh",o.cameraData=i,o._collider=new b(e.colliderGeometry,e.colliderMaterial),o._collider.material.visible=!1,o.add(o._collider),o.opacityProgress=0,o.shouldHide=!0,o.uniforms=a.uniforms,o.unhover(),o.selected=0,o.visible=!1,o.position.copy(n),o.renderOrder=p.a.pins,o}return g(e,t),e.prototype.updatePosition=function(t){this.position.copy(t)},Object.defineProperty(e.prototype,"collider",{get:function(){return this._collider},enumerable:!0,configurable:!0}),e.prototype.render=function(t){this.quaternion.copy(this.cameraData.pose.rotation),null===this.uniforms.tPinHole.value?this.opacityProgress=0:!this.shouldHide&&this.opacityProgress<1?this.opacityProgress+=t/e.FADE_DURATION:this.shouldHide&&this.opacityProgress>0&&(this.opacityProgress-=t/e.FADE_DURATION),this.opacityProgress=Object(f.e)(this.opacityProgress,0,1),this.uniforms.opacity.value=this.opacityProgress,this.visible=0!==this.opacityProgress},e.prototype.activate=function(){this.shouldHide=!1},e.prototype.deactivate=function(){this.shouldHide=!0},e.prototype.dispose=function(){this.collider.geometry.dispose(),this.collider.material.dispose()},e.prototype.setPinHover=function(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=!0);var r=Math.min(Math.max(t,0),1);this.selected!==r&&(n&&this.uniforms.pinColor.value.copy(d.a.WHITE).lerp(d.a.MP_BRAND,r),e&&r>0&&r<=1&&(this.material.depthTest=!1),0===r&&(this.material.depthTest=!0),this.selected=r)},e.prototype.unhover=function(){this.uniforms.pinColor.value.copy(d.a.WHITE)},e.FADE_DURATION=500,e.geometry=new i.Ib(1.5,1.5),e.pinTexture=Object(h.a)(v.a),e.colliderGeometry=new i.nc(1.5*.65),e.colliderMaterial=new i.mb({transparent:!0,opacity:.5,depthWrite:!1,color:16724312}),e}(y.a)},function(t,e,n){(function(e){var n="object",r=function(t){return t&&t.Math==Math&&t};t.exports=r(typeof globalThis==n&&globalThis)||r(typeof window==n&&window)||r(typeof self==n&&self)||r(typeof e==n&&e)||Function("return this")()}).call(this,n(144))},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(17),a=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},c=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="common-controls",e}return a(e,t),e.prototype.init=function(t,e){return s(this,void 0,void 0,(function(){var t=this;return c(this,(function(n){return this.modeControls={},e.market.waitForData(o.a).then((function(e){return t.viewmodeData=e})),[2]}))}))},e.prototype.startRotateTransition=function(t,e,n){return void 0===n&&(n=!0),this.checkControlsForAction((function(r){return r.startRotateTransition(t,e,n)}))},e.prototype.startZoomTransition=function(t,e,n){return void 0===n&&(n=!0),this.checkControlsForAction((function(r){return r.startZoomTransition(t,e,n)}))},e.prototype.startTranslateTransition=function(t,e,n){return void 0===n&&(n=!0),this.checkControlsForAction((function(r){return r.startTranslateTransition(t,e,n)}))},e.prototype.stop=function(){return this.checkControlsForAction((function(t){return t.stop(),Promise.resolve()}))},e.prototype.checkControlsForAction=function(t){if(this.viewmodeData&&(null!==this.viewmodeData.currentMode&&this.modeControls[this.viewmodeData.currentMode]))return t(this.modeControls[this.viewmodeData.currentMode].controls);return Promise.reject("checkControlsForAction() -> Current view mode is null")},e.prototype.addControls=function(t,e,n){void 0===n&&(n=!1),this.modeControls[t]&&!n||(this.modeControls[t]={mode:t,controls:e})},e}(i.a);e.default=u},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=function(){this.eventType="input"}},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(15),a=n(10),s=n(60),c=n(79),u=n(207),l=n(209),h=n(24),f=n(57),p=n(176),d=n(18),y=n(2),m=n(158),v=n(84),g=n(72),b=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),w=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},_=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},x=new y.a("sweep-module"),S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.internalProgress=!1,e.name="sweep-data",e.defaultEasing=f.c,e.moveToSweep=function(t){var n=new h.a;return t.prevSweepId=t.prevSweepId||e.sweepData.currentSweep,e.activateSweep(t).then((function(){return e.beginSweepTransition(t),e.defaultSweepCameraMove(n,t)})).then((function(){e.endSweepTransition(t),n.resolve()})).catch((function(e){x.info("Failure moving to sweep "+t.sweepId,e),n.reject(e)})),n.promise()},e.activateSweep=function(t){return w(e,void 0,void 0,(function(){return _(this,(function(e){if(!this.sweepData.canTransition()||!this.cameraData.canTransition())throw new Error("Tried to start sweep transition while another transition was active!");if(!this.sweepData.containsSweep(t.sweepId))throw new Error("invalid sweep");return[2,this.activateSweepUnsafe(t)]}))}))},e.activateSweepUnsafe=function(t){return w(e,void 0,void 0,(function(){var e,n,r=this;return _(this,(function(i){switch(i.label){case 0:return this.sweepPanoModule?[3,2]:(e=this,[4,this.engine.getModuleByParent(p.a)]);case 1:e.sweepPanoModule=i.sent(),i.label=2;case 2:return n=this.sweepPanoModule.getRenderer(),this.sweepData.setTransitionPending(!0),[2,n.activateSweep(t.sweepId).then((function(){return r.sweepData.setTransitionPending(!1)}))]}}))}))},e.instantSweepTransition=function(t){var n=e.sweepData.currentSweep;e.beginSweepTransition({sweepId:t,transitionTime:0,internalProgress:!0,prevSweepId:n}),e.sweepData.currentSweep=t,e.sweepData.commit(),e.engine.broadcast(new m.a(t,n)),e.endSweepTransition({sweepId:t,prevSweepId:n})},e.beginSweepTransition=function(t){e.sweepData.activateTransition(t.sweepId,t.prevSweepId||e.sweepData.currentSweep),e.internalProgress=t.internalProgress||!1,e.sweepData.transition.progress.modifyAnimation(0,1,t.transitionTime||0,t.easing||e.defaultEasing),e.sweepData.commit(),e.engine.broadcast(new l.a(t.sweepId,t.prevSweepId))},e.endSweepTransition=function(t){e.sweepData.setTransitionPending(!1);var n=e.sweepData.getSweep(t.sweepId);e.sweepData.deactivateTransition(),e.sweepData.currentSweep=t.sweepId,e.sweepData.transition.progress.stop(1),e.internalProgress=!1,e.sweepData.commit(),e.engine.broadcast(new u.a(t.sweepId,n.alignmentType,n.placementType,t.prevSweepId))},e.defaultSweepCameraMove=function(t,n){return w(e,void 0,Promise,(function(){var e,r,i,o,s,u=this;return _(this,(function(l){return e={position:this.sweepData.getSweep(n.sweepId).position,rotation:n.rotation},r=Object(c.c)(this.cameraData.aspect()),i=a.a.Interpolate,void 0!==n.transitionType&&a.a[n.transitionType]&&(i=n.transitionType),o=this.cameraModule.moveTo({transitionType:i,pose:e,transitionTime:n.transitionTime,projection:r,easing:n.easing,rotationDelay:n.rotationDelay}),s=!1,o.progress((function(e){u.sweepData.transition.progress.updateProgress(e),t.notify(e),e>=.5&&!s&&(s=!0,u.sweepData.currentSweep=n.sweepId,u.sweepData.commit(),u.engine.broadcast(new m.a(n.sweepId,n.prevSweepId)))})),[2,o.nativePromise()]}))}))},e}return b(e,t),e.prototype.init=function(t,e){return w(this,void 0,void 0,(function(){var n,r,i,a,c=this;return _(this,(function(u){switch(u.label){case 0:return this.engine=e,this.market=this.engine.market,[4,t.sweepSync.load()];case 1:return n=u.sent()||{},r=function(t){var e=Object(v.b)();for(var n in t){var r=t[n];e.set(r.id,r)}return e}(n),this.sweepData=new o.a(r),this.market.register(this,o.a,this.sweepData),t.createSyncMonitor&&t.sweepSync.addMonitor(t.createSyncMonitor(r)),i=this,[4,this.engine.getModule(s.default)];case 2:return i.cameraModule=u.sent(),a=this,[4,e.market.waitForData(d.a)];case 3:return a.cameraData=u.sent(),this.bindings.push(e.commandBinder.addBinding(g.a,(function(){return w(c,void 0,void 0,(function(){return _(this,(function(t){return this.sweepData.currentSweep=void 0,this.sweepData.commit(),[2]}))}))})),e.commandBinder.addBinding(g.d,(function(t){return w(c,void 0,void 0,(function(){var e,n,r;return _(this,(function(i){switch(i.label){case 0:if(!t.sweepId)return[3,5];i.label=1;case 1:return i.trys.push([1,3,,4]),e=t.sweepId,[4,this.activateSweepUnsafe({sweepId:e})];case 2:return i.sent(),n=this.sweepData.currentSweep,this.beginSweepTransition({sweepId:e,transitionTime:0,internalProgress:!0,prevSweepId:n}),this.sweepData.currentSweep=e,this.endSweepTransition({sweepId:e,prevSweepId:n}),this.sweepData.commit(),[3,4];case 3:return r=i.sent(),x.error(r),[3,4];case 4:return[3,6];case 5:this.sweepData.currentSweep=void 0,this.sweepData.commit(),i.label=6;case 6:return[2]}}))}))}))),[2]}}))}))},e.prototype.onUpdate=function(t){this.internalProgress&&this.sweepData.transition.active&&this.sweepData.transition.progress.tick(t)},e}(i.a);e.default=S},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return s}));var r,i=n(0),o=n(126),a=n(42);!function(t){t.line="line",t.start="start",t.end="end"}(r||(r={}));var s=function(){function t(t,e,n,s,c){var u=this;this.startPosition=t,this.endPosition=e,this.lineMaterial=n,this.options=s,this.endpointMaterial=c,this.endpoints=!1,this.isVisible=!0,this.meshToLinePartMap={},this.opacity=function(t){return u.endpointMaterial&&(u.endpointMaterial.opacity=t),u.lineMesh.material.opacity=t,u},this.updatePositions=function(t,e){return u.startPosition.copy(t),u.endPosition.copy(e),u.options.beforeUpdatePositions&&(t=u.options.beforeUpdatePositions(t),e=u.options.beforeUpdatePositions(e)),u.lineMesh.geometry.setPositions([t.x,t.y,t.z,e.x,e.y,e.z]),u.endpoints&&(u.endMesh.position.copy(e),u.startMesh.position.copy(t),u.lastBillboardOptions&&u.updateBillboard(u.lastBillboardOptions)),u.lineMesh.material.dashed&&u.lineMesh.computeLineDistances(),u},this.updateBillboard=function(t){if(u.endpoints&&(t.rotation&&(u.endMesh.quaternion.copy(t.rotation),u.startMesh.quaternion.copy(t.rotation)),t.position&&t.projection)){var e=u.lineMesh.material.uniforms.resolution.y;u.endMesh.billboardScale(t.position,t.projection,e),u.startMesh.billboardScale(t.position,t.projection,e)}return u.lastBillboardOptions=t,u},this.updateSelected=function(t){return u.lineMesh.material.updateSelected(t),u.endpoints&&(u.endMesh.material.updateHovered(t),u.endMesh.updateSelected(t),u.startMesh.updateSelected(t)),u},this.setRenderLayer=function(t){u.children.forEach((function(e){return e.layers.mask=t.mask}))},this.updateResolution=function(t,e){return u.lineMesh.material.uniforms.resolution.x=t,u.lineMesh.material.uniforms.resolution.y=e,u},this.hide=function(){u.options.onHide&&u.options.onHide(),u.isVisible=!1},this.show=function(){u.options.onShow&&u.options.onShow(),u.isVisible=!0},this.toggle=function(t){return t?u.show():u.hide(),u},this.dispose=function(){u.options.onHide&&u.options.onHide(),u.lineMesh.geometry.dispose(),u.lineMesh.material.dispose(),u.endMesh&&u.endMesh.dispose(),u.startMesh&&u.startMesh.dispose(),u.meshToLinePartMap={}},this.overrideLineMaterial=function(t){u.lineMesh.material=t},this.restoreLineMaterial=function(){u.lineMesh.material=u.lineMaterial},this.lineMesh=new o.a(new o.d,n),this.lineMesh.matrixAutoUpdate=!1,this.lineMesh.part=r.line,this.lineMesh.renderOrder=a.a.lines,this.meshToLinePartMap[r.line]=this.lineMesh,c&&(this.endpoints=!0,this.endMesh=new o.b(new i.Ib(1,1),c),this.endMesh.part=r.end,this.endMesh.renderOrder=a.a.endpoints,this.meshToLinePartMap[r.end]=this.endMesh,this.startMesh=new o.b(new i.Ib(1,1),c),this.startMesh.part=r.start,this.startMesh.renderOrder=a.a.endpoints,this.meshToLinePartMap[r.start]=this.startMesh),this.updatePositions(t,e),this.updateSelected(!1)}return Object.defineProperty(t.prototype,"currentOpacity",{get:function(){return this.lineMesh.material.opacity},enumerable:!0,configurable:!0}),t.prototype.getMesh=function(t){return this.meshToLinePartMap[t]},Object.defineProperty(t.prototype,"children",{get:function(){var t=this;return Object.keys(this.meshToLinePartMap).map((function(e){return t.meshToLinePartMap[e]}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visible",{get:function(){return this.isVisible},enumerable:!0,configurable:!0}),t}()},function(t,e,n){"use strict";var r,i=n(9),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n){var r=t.call(this)||this;return r.fromSweep=n,r.toSweep=e,r.timestamp=Date.now(),r}return o(e,t),e}(i.a);e.a=a},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(25),a=n(43),s=n(0),c=n(80),u=n(81),l={circle_projection:new s.cc({uniforms:{textureSampleScale:{value:5},panoTexture:{value:null},borderSize:{value:0},borderColor:{value:new s.Kc(1,1,1,1)}},depthWrite:!1,depthTest:!0,side:s.w,vertexShader:u+n(853),fragmentShader:c+n(854)}),equirectangular:new s.cc({uniforms:{cubemap:{value:null},yaw:{value:0}},depthWrite:!1,depthTest:!1,vertexShader:u+n(855),fragmentShader:c+n(856)}),compose:new s.cc({uniforms:{mask:{value:null},bg:{value:null}},transparent:!0,vertexShader:u+n(857),fragmentShader:c+n(858)}),copyOpaque:new s.cc({uniforms:{texture:{value:null}},vertexShader:u+n(859),fragmentShader:c+n(860)})},h=n(163),f=n(115),p=function(){function t(t,e){this._renderer=t,this._renderTarget=e}return Object.defineProperty(t.prototype,"target",{get:function(){return this._renderTarget},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._renderTarget.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._renderTarget.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bpp",{get:function(){return 4},enumerable:!0,configurable:!0}),t.prototype.readRenderTargetData=function(t){var e=this._renderTarget.width,n=this._renderTarget.height;return t=t||new Uint8Array(e*n*4),this._renderer.readRenderTargetPixels(this._renderTarget,0,0,e,n,t),t},t.prototype.setSize=function(t,e){this._renderTarget.setSize(t,e)},t.prototype.dispose=function(){this._renderTarget.dispose()},t}(),d=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),y=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},m=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="render-to-texture",e.circleProjectionPlane=new h.a(new s.Ib(1,1),l.circle_projection),e.equirectProjectionPlane=new h.a(new s.Ib(1,1),l.equirectangular),e.composePlane=new h.a(new s.Ib(1,1),l.compose),e.copyPlane=new h.a(new s.Ib(1,1),l.copyOpaque),e.cachedSize=new s.Ic,e.cachedViewport=new s.Kc,e.solidWhiteTexture=new s.u(new Uint8Array([255,255,255,255]),1,1),e.debugRenderOffset=0,e}return d(e,t),e.prototype.init=function(t,e){return y(this,void 0,void 0,(function(){var t,n=this;return m(this,(function(r){switch(r.label){case 0:return[4,e.getModule(o.default)];case 1:return t=r.sent(),this.renderer=t.cwfRenderer.renderer,this.camera=new s.o,this.orthoCamera=new s.Fb(-.5,.5,.5,-.5,0,1),this.camera.layers.mask=a.a.ALL.mask,this.scene=new s.hc,this.scene.name="rtt",this.scene.autoUpdate=!1,this.bindings.push(e.commandBinder.addBinding(f.d,(function(t){return y(n,void 0,void 0,(function(){return m(this,(function(t){return[2,new p(this.renderer,this.createRenderTarget2D(0))]}))}))}))),this.bindings.push(e.commandBinder.addBinding(f.b,(function(t){return y(n,void 0,void 0,(function(){return m(this,(function(e){return this.renderContext(t.renderTarget.target,t.context),[2]}))}))}))),this.bindings.push(e.commandBinder.addBinding(f.e,(function(t){return y(n,void 0,void 0,(function(){return m(this,(function(e){return this.render(t.renderTarget.target,t.sceneObject,t.camera),[2]}))}))}))),this.bindings.push(e.commandBinder.addBinding(f.c,(function(t){return y(n,void 0,void 0,(function(){return m(this,(function(e){return this.renderEquirectangular(t.texture,t.renderTarget.target,t.heading),[2]}))}))}))),this.bindings.push(e.commandBinder.addBinding(f.a,(function(t){return y(n,void 0,void 0,(function(){return m(this,(function(e){return this.compose(t.target1.target,t.target2.target,t.target2.target),[2]}))}))}))),[2]}}))}))},e.prototype.getRenderSize=function(){var t=this.renderer.getPixelRatio(),e=this.renderer.getSize(this.cachedSize);return e.width*=t,e.height*=t,e},e.prototype.onUpdate=function(){this.debugRenderOffset=0},e.prototype.createRenderTarget2D=function(t,e,n,r){void 0===e&&(e=t),void 0===r&&(r=!0);var i=new s.Nc(t,e,n);return i.texture.generateMipmaps=r,i},e.prototype.clearRenderTarget2D=function(t){this.renderer.setRenderTarget(t),this.renderer.clear(),this.renderer.setRenderTarget(null)},e.prototype.disposeRenderTarget2D=function(t){t.texture.dispose(),t.depthTexture&&t.depthTexture.dispose(),t.dispose()},e.prototype.getRenderTargetData=function(t,e){var n=t.width,r=t.height;return e=e||new Uint8Array(n*r*4),this.renderer.readRenderTargetPixels(t,0,0,n,r,e),e},e.prototype.compose=function(t,e,n){void 0===n&&(n=this.solidWhiteTexture),this.composePlane.material.uniforms.bg.value=this.isRenderTarget(e)?e.texture:e,this.composePlane.material.uniforms.mask.value=this.isRenderTarget(n)?n.texture:n,this.scene.add(this.composePlane),this.renderer.setRenderTarget(t),this.renderer.render(this.scene,this.orthoCamera),this.renderer.setRenderTarget(null),this.scene.remove(this.composePlane)},e.prototype.copyTextureOpaque=function(t,e){this.copyPlane.material.uniforms.texture.value=e&&this.isRenderTarget(e)?e.texture:e,this.scene.add(this.copyPlane),this.renderer.setRenderTarget(t),this.renderer.render(this.scene,this.orthoCamera),this.renderer.setRenderTarget(null),this.scene.remove(this.copyPlane)},e.prototype.copyTexture=function(t,e){return e.format===s.Xb?this.copyTextureOpaque(t,e):this.compose(t,e)},e.prototype.resizeTexture=function(t,e){var n=new s.Nc(e,e);return n.texture.format=t.format,n.texture.addEventListener("dispose",n.dispose.bind(n)),this.copyTexture(n,t),n.texture},e.prototype.renderToScreen=function(t,e,n){var r=this.isRenderTarget(t)?t.width:t.image.width,i=this.isRenderTarget(t)?t.height:t.image.height,o=e?e.x:this.debugRenderOffset,a=e?e.y:0;this.renderer.getViewport(this.cachedViewport),this.renderer.setViewport(o,a,r,i),this.compose(null,t,n),this.renderer.setViewport(this.cachedViewport),e||(this.debugRenderOffset+=r)},e.prototype.isRenderTarget=function(t){return t.hasOwnProperty("texture")},e.prototype.renderContext=function(t,e){t.texture.image=e.canvas,t.texture.needsUpdate=!0},e.prototype.render=function(t,e,n,r){var i=e.parent;i&&this.scene.applyMatrix4(i.matrixWorld),this.scene.add(e),n.getWorldPosition(this.camera.position),n.getWorldQuaternion(this.camera.quaternion),this.camera.projectionMatrix.copy(n.projectionMatrix),this.camera.layers.mask=r?r.mask:n.layers.mask;var o=this.renderer.getSize(this.cachedSize),a=o.width/o.height,s=t.width/t.height,c=this.camera.projectionMatrix;return a>s?c.elements[0]=c.elements[5]/s:c.elements[5]=c.elements[0]*s,this.renderer.setRenderTarget(t),this.renderer.clear(),this.renderer.render(this.scene,this.camera),this.renderer.setRenderTarget(null),i&&(i.add(e),this.scene.matrixWorld.identity()),this.scene.remove(e),t},e.prototype.setScissors=function(t,e){if(t){if(!e)throw Error("Rect to restrict rendering to required when enabling scissors.");this.renderer.setScissorTest(!0),this.renderer.setScissor(e.x,e.y,e.width,e.height)}else{var n=this.renderer.getSize(this.cachedSize);this.renderer.setScissor(0,0,n.width,n.height),this.renderer.setScissorTest(!1)}},e.prototype.renderSphericalProjection=function(t,e,n,r,i){var o=l.circle_projection;o.uniforms.borderColor.value.copy(i||new s.Kc(1,1,1,1)),o.uniforms.borderSize.value=r||0,o.uniforms.textureSampleScale.value=n||5,o.uniforms.panoTexture.value=t,this.scene.add(this.circleProjectionPlane),this.circleProjectionPlane.position.z=0,this.renderer.setRenderTarget(e),this.renderer.render(this.scene,this.orthoCamera),this.renderer.setRenderTarget(null),this.scene.remove(this.circleProjectionPlane)},e.prototype.renderEquirectangular=function(t,e,n){void 0===n&&(n=0);var r=this.equirectProjectionPlane.material;r.uniforms.cubemap.value=t,r.uniforms.yaw.value=n,this.scene.add(this.equirectProjectionPlane),this.equirectProjectionPlane.position.z=0,this.renderer.setRenderTarget(e),this.renderer.render(this.scene,this.orthoCamera),this.renderer.setRenderTarget(null),this.scene.remove(this.equirectProjectionPlane),r.uniforms.cubemap.value=null,r.uniforms.yaw.value=0},e}(i.a);e.default=v},function(t,e,n){"use strict";var r=n(462);n.d(e,"a",(function(){return r.a}));n(555);var i=n(182);n.d(e,"b",(function(){return i.d}))},function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return u}));var r=n(0),i=n(3),o=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};function a(t){var e,n;if(0===t.length)throw Error("Can't merge empty list of geometries");if(1===t.length)return t[0];var i=0,a=0,c=0,l=0,h=new r.h;try{for(var f=o(t),p=f.next();!p.done;p=f.next()){var d=p.value;d.index&&(i+=d.index.count,a+=d.getAttribute("position").count,d.getAttribute("uv")&&(c+=d.getAttribute("uv").count),d.boundingBox&&(h.union(d.boundingBox),l++))}}catch(t){e={error:t}}finally{try{p&&!p.done&&(n=f.return)&&n.call(f)}finally{if(e)throw e.error}}var y=new r.m;l!==t.length||h.isEmpty()?y.computeBoundingBox():y.boundingBox=h,h.copy(u(y)),y.boundingSphere=h.getBoundingSphere(new r.mc);var m=s(new Float32Array(3*a),"position",t);y.setAttribute("position",new r.l(m,3));var v=function(t,e){var n,r,i=0,a=0;try{for(var s=o(e),c=s.next();!c.done;c=s.next()){for(var u=c.value,l=u.index,h=0;h<l.array.length;h++)t[i+h]=l.array[h]+a;i+=l.array.length,a+=u.getAttribute("position").count}}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return t}(new Uint32Array(i),t);if(y.setIndex(new r.l(v,1)),c){var g=s(new Float32Array(2*c),"uv",t);y.setAttribute("uv",new r.l(g,2))}return y}function s(t,e,n){var r,i,a=0;try{for(var s=o(n),c=s.next();!c.done;c=s.next()){var u=c.value.getAttribute(e);t.set(u.array,a),a+=u.array.length}}catch(t){r={error:t}}finally{try{c&&!c.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return t}var c=new r.h(i.b.ZERO,i.b.UNIT);function u(t){return t.boundingBox||t.computeBoundingBox(),t.boundingBox||c}},function(t,e,n){"use strict";var r,i=n(5),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}o(e,t)}(i.a),function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),s=function(t){function e(e){var n=t.call(this)||this;return n.payload=e,n}return a(e,t),e}(i.a),c=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),e}(i.a),l=function(t){function e(e){var n=t.call(this)||this;return n.payload={index:e},n}return c(e,t),e}(i.a),h=function(t){function e(e){var n=t.call(this)||this;return n.payload={sid:e},n}return c(e,t),e}(i.a),f=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),p=function(t){function e(e,n){var r=t.call(this)||this;return r.payload={on:e,dimWhileActive:void 0!==n?n:e},r}return f(e,t),e}(i.a),d=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return d(e,t),e}(i.a),m=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),v=function(t){function e(e){var n=t.call(this)||this;return n.payload=e,n}return m(e,t),e}(i.a),g=function(t){function e(e){var n=t.call(this)||this;return n.payload={sid:e},n}return m(e,t),e}(i.a),b=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),w=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return b(e,t),e}(i.a);n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return l})),n.d(e,"c",(function(){return u})),n.d(e,"d",(function(){return h})),n.d(e,"f",(function(){return p})),n.d(e,"g",(function(){return y})),n.d(e,"h",(function(){return v})),n.d(e,"e",(function(){return g})),n.d(e,"i",(function(){return w}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(0),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n){return t.call(this,e,n)||this}return o(e,t),e}(i.lb)},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(9),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n){var r=t.call(this)||this;return r.floorIndex=e,r.floorName=n,r}return o(e,t),e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"c",(function(){return l})),n.d(e,"e",(function(){return h})),n.d(e,"d",(function(){return f})),n.d(e,"b",(function(){return p}));var r,i=n(140),o=n(5),a=n(13),s=n(297),c=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),u=function(t){function e(e){var n=t.call(this)||this;return n.id="CAPTURE_SNAPSHOT",n.payload={maxSize:e.maxSize||a.d.ULTRAHIGH,aspect:e.aspect||s.b,category:e.category||i.a.user,setAsStartLocation:e.setAsStartLocation||!1,onProgress:e.onProgress,getOverlay:e.getOverlay,waitForUpload:void 0===e.waitForUpload||e.waitForUpload},n}return c(e,t),e}(o.a),l=function(t){function e(e){var n=t.call(this)||this;return n.id="EQUIRECTANGULAR_SNAPSHOT",n.payload={onProgress:e.onProgress,setAsStartLocation:e.setAsStartLocation||!1,waitForUpload:void 0===e.waitForUpload||e.waitForUpload},n}return c(e,t),e}(o.a),h=function(t){function e(e,n){var r=t.call(this)||this;return r.id="RENAME_SNAPSHOT",r.payload={sid:e,name:n},r}return c(e,t),e}(o.a),f=function(t){function e(e){var n=t.call(this)||this;return n.id="DELETE_SNAPSHOT",n.payload={sid:e},n}return c(e,t),e}(o.a),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.id="DELETE_UNUSED_TOUR_SNAPSHOTS",e}return c(e,t),e}(o.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0),i=function(){function t(){}return t.MP_BRAND=new r.s("rgb(255, 49, 88)"),t.MATTERTAG_BLUE=new r.s("rgb(3, 104, 125)"),t.WHITE=new r.s("rgb(255, 255, 255)"),t.BLACK=new r.s("rgb(0, 0, 0)"),t}()},function(t,e,n){"use strict";n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return a}));var r=n(123),i=(n(540),n(108));n.d(e,"b",(function(){return i.a}));var o=function(t){return t&&"floorIndex"in t},a={hasFloorIndex:o,hasRoomIndex:function(t){return t&&"roomIndex"in t&&"floorIndex"in t},isRoomMesh:function(t){return t&&t instanceof r.a}}},,function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var c,u=[],l=!1,h=-1;function f(){l&&c&&(l=!1,c.length?u=c.concat(u):h=-1,u.length&&p())}function p(){if(!l){var t=s(f);l=!0;for(var e=u.length;e;){for(c=u,u=[];++h<e;)c&&c[h].run();h=-1,e=u.length}c=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function y(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new d(t,e)),1!==u.length||l||s(p)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=y,i.addListener=y,i.once=y,i.off=y,i.removeListener=y,i.removeAllListeners=y,i.emit=y,i.prependListener=y,i.prependOnceListener=y,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){t.exports=n(59)},function(t,e,n){"use strict";var r=n(145),i=n(37);function o(t){return(t>>>24|t>>>8&65280|t<<8&16711680|(255&t)<<24)>>>0}function a(t){return 1===t.length?"0"+t:t}function s(t){return 7===t.length?"0"+t:6===t.length?"00"+t:5===t.length?"000"+t:4===t.length?"0000"+t:3===t.length?"00000"+t:2===t.length?"000000"+t:1===t.length?"0000000"+t:t}e.inherits=i,e.toArray=function(t,e){if(Array.isArray(t))return t.slice();if(!t)return[];var n=[];if("string"==typeof t)if(e){if("hex"===e)for((t=t.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(t="0"+t),r=0;r<t.length;r+=2)n.push(parseInt(t[r]+t[r+1],16))}else for(var r=0;r<t.length;r++){var i=t.charCodeAt(r),o=i>>8,a=255&i;o?n.push(o,a):n.push(a)}else for(r=0;r<t.length;r++)n[r]=0|t[r];return n},e.toHex=function(t){for(var e="",n=0;n<t.length;n++)e+=a(t[n].toString(16));return e},e.htonl=o,e.toHex32=function(t,e){for(var n="",r=0;r<t.length;r++){var i=t[r];"little"===e&&(i=o(i)),n+=s(i.toString(16))}return n},e.zero2=a,e.zero8=s,e.join32=function(t,e,n,i){var o=n-e;r(o%4==0);for(var a=new Array(o/4),s=0,c=e;s<a.length;s++,c+=4){var u;u="big"===i?t[c]<<24|t[c+1]<<16|t[c+2]<<8|t[c+3]:t[c+3]<<24|t[c+2]<<16|t[c+1]<<8|t[c],a[s]=u>>>0}return a},e.split32=function(t,e){for(var n=new Array(4*t.length),r=0,i=0;r<t.length;r++,i+=4){var o=t[r];"big"===e?(n[i]=o>>>24,n[i+1]=o>>>16&255,n[i+2]=o>>>8&255,n[i+3]=255&o):(n[i+3]=o>>>24,n[i+2]=o>>>16&255,n[i+1]=o>>>8&255,n[i]=255&o)}return n},e.rotr32=function(t,e){return t>>>e|t<<32-e},e.rotl32=function(t,e){return t<<e|t>>>32-e},e.sum32=function(t,e){return t+e>>>0},e.sum32_3=function(t,e,n){return t+e+n>>>0},e.sum32_4=function(t,e,n,r){return t+e+n+r>>>0},e.sum32_5=function(t,e,n,r,i){return t+e+n+r+i>>>0},e.sum64=function(t,e,n,r){var i=t[e],o=r+t[e+1]>>>0,a=(o<r?1:0)+n+i;t[e]=a>>>0,t[e+1]=o},e.sum64_hi=function(t,e,n,r){return(e+r>>>0<e?1:0)+t+n>>>0},e.sum64_lo=function(t,e,n,r){return e+r>>>0},e.sum64_4_hi=function(t,e,n,r,i,o,a,s){var c=0,u=e;return c+=(u=u+r>>>0)<e?1:0,c+=(u=u+o>>>0)<o?1:0,t+n+i+a+(c+=(u=u+s>>>0)<s?1:0)>>>0},e.sum64_4_lo=function(t,e,n,r,i,o,a,s){return e+r+o+s>>>0},e.sum64_5_hi=function(t,e,n,r,i,o,a,s,c,u){var l=0,h=e;return l+=(h=h+r>>>0)<e?1:0,l+=(h=h+o>>>0)<o?1:0,l+=(h=h+s>>>0)<s?1:0,t+n+i+a+c+(l+=(h=h+u>>>0)<u?1:0)>>>0},e.sum64_5_lo=function(t,e,n,r,i,o,a,s,c,u){return e+r+o+s+u>>>0},e.rotr64_hi=function(t,e,n){return(e<<32-n|t>>>n)>>>0},e.rotr64_lo=function(t,e,n){return(t<<32-n|e>>>n)>>>0},e.shr64_hi=function(t,e,n){return t>>>n},e.shr64_lo=function(t,e,n){return(t<<32-n|e>>>n)>>>0}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return o}));var r=function(t){return.3048*t},i=function(t){return t/.3048},o=function(t){var e=t/.3048,n=Math.floor(e),r=12*e%12;return 12===Math.round(r)?(n+=1,r=0):r=Math.round(r),{feet:n,inches:r}}},function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return o})),n.d(e,"c",(function(){return a}));var r=n(22),i=function(t,e){if(!t||!e)return!1;var n=e&&t.getSweep(e);return!!n&&n.alignmentType===r.a.ALIGNED},o=function(t){return i(t,t.currentSweep)},a=function(t,e){switch(t){case r.a.ALIGNED:return 1;case r.a.UNALIGNED:return 2}switch(e){case r.b.MANUAL:return 3}return 0}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r,i=n(23),o=n(0),a=n(124),s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(t){function e(e,n){var r=t.call(this)||this;return r.name="mesh-data",r.bounds=new o.h,r.center=new o.Jc,r.size=new o.Jc,r.opacity=new a.a(e),r.bounds.copy(n),r.bounds.getCenter(r.center),r.bounds.getSize(r.size),r}return s(e,t),e.prototype.copy=function(t){this.opacity.copy(t.opacity),this.bounds.copy(t.bounds),this.bounds.getCenter(this.center),this.bounds.getSize(this.size)},e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(23),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e){var n=t.call(this)||this;for(var r in n.name="snapshots",n.snapshots={},e)n.snapshots[r]=e[r].clone();return n}return o(e,t),e.prototype.get=function(t){return this.snapshots[t]},Object.defineProperty(e.prototype,"collection",{get:function(){return this.snapshots},enumerable:!0,configurable:!0}),e.prototype.add=function(t){this.snapshots[t.sid]=t},e.prototype.clone=function(){return new e(this.snapshots)},e}(i.a)},function(t,e,n){"use strict";var r,i=n(4),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="sweep-pano-base",e}return o(e,t),e.prototype.getRenderer=function(){return this.panoRenderer},e}(i.a);e.a=a},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r,i=n(5),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},s=function(t){function e(e,n,r){var i=t.call(this)||this;i.id="SCHEDULE_TASK_COMMAND";var o=function(){return a(this,(function(t){return[2,n()]}))}();return i.payload={type:e,func:o,maxDelay:r,steps:1},i}return o(e,t),e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(5),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e){var n=t.call(this)||this;return n.id="SET_MESH_OPACITY",n.payload={value:e},n}return o(e,t),e}(i.a)},,function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(5),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e){var n=t.call(this)||this;return n.id="SET_CHUNK_RENDER_MODE",n.payload={mode:e},n}return o(e,t),e}(i.a)},function(t,e,n){"use strict";n.r(e);var r=n(4),i=n(118),o=n(49),a=n(6),s=n(596),c=n.n(s),u=n(597),l=n.n(u),h=n(598),f=n.n(h),p=n(599),d=n.n(p),y=function(t){return{problem:"",solution:t.t(o.a.ERROR_BROWSER_SOLUTION),explanation:t.t(o.a.ERROR_BROWSER_EXPLANATION),actions:Object(a.n)()?"":["<div id='browser-tiles'>","<a href='https://www.google.com/chrome/browser/' target='_blank'>","<div class='tile'>","<img src="+c.a+">","</div>","</a>","<a href='https://www.mozilla.org/en-US/firefox/new/' target='_blank'>","<div class='tile'>","<img src="+l.a+">","</div>","</a>","<a href='http://windows.microsoft.com/en-us/internet-explorer/download-ie' target='_blank'>","<div class='tile'>","<img src="+f.a+">","</div>","</a>","<a href='https://support.apple.com/en-us/HT204416' target='_blank'>","<div class='tile'>","<img src="+d.a+">","</div>","</a>","</div>"].join("")}},m=function(){return(m=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},v=function(t){return m({},y(t),{problem:""+t.t(o.a.ERROR_WEBGL_UNSUPPORTED_PROBLEM)})},g="https://support.matterport.com/hc/articles/208220058",b=function(t){return{problem:t.t(o.a.ERROR_GENERIC_PROBLEM),solution:t.t(o.a.ERROR_GENERIC_SOLUTION),explanation:"",actions:[""+t.t(o.a.ERROR_GENERIC_ACTIONS_1)].concat(Object(a.n)()?[]:["<a id='install-browser' href='#'>"+t.t(o.a.ERROR_GENERIC_ACTIONS_2)+"</a>",""+t.t(o.a.ERROR_GENERIC_ACTIONS_3)]).concat(["<a href="+g+" target='_blank'>"+t.t(o.a.ERROR_GENERIC_ACTIONS_4)+"</a>"]).join("")}},w=function(t){return{problem:t.t(o.a.ERROR_LOADING_FAILED_PROBLEM),solution:"",explanation:"",actions:[""+t.t(o.a.ERROR_LOADING_FAILED_ACTIONS_1),"<a href="+g+" target='_blank'>"+t.t(o.a.ERROR_LOADING_FAILED_ACTIONS_2)+"</a>"].join("")}};n(872);n.d(e,"ErrorType",(function(){return x}));var _,x,S=(_=function(t,e){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}_(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),T=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},M=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};!function(t){t[t.UNSUPPORTED=1]="UNSUPPORTED",t[t.WEBGL=2]="WEBGL",t[t.GENERIC=3]="GENERIC"}(x||(x={}));var E=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="error-gui",e}return S(e,t),e.prototype.init=function(t,e){return T(this,void 0,void 0,(function(){var t;return M(this,(function(n){switch(n.label){case 0:return this.container=document.querySelector("#error-container"),this.problem=document.querySelector("#error-problem"),this.solution=document.querySelector("#error-solution"),this.explanation=document.querySelector("#error-explanation"),this.actions=document.querySelector("#error-actions"),t=this,[4,e.getModule(i.default)];case 1:return t.localeModule=n.sent(),[2]}}))}))},e.prototype.showError=function(t){var e=this;switch(t){case x.UNSUPPORTED:this.populateErrorScreen(v);break;case x.WEBGL:this.populateErrorScreen(b);var n=this.actions.querySelector("#install-browser");n&&n.addEventListener("click",(function(){return e.populateErrorScreen(y)}));break;case x.GENERIC:default:this.populateErrorScreen(w)}},e.prototype.populateErrorScreen=function(t){var e=t(this.localeModule);this.container.classList.remove("hidden"),this.problem.innerText=e.problem,this.solution.innerText=e.solution,this.explanation.innerText=e.explanation,this.actions.innerHTML=e.actions},e}(r.a);e.default=E},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return o})),n.d(e,"b",(function(){return a})),n.d(e,"d",(function(){return c}));var r=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},i=function(){function t(t,e,n){this.watchedData=t,this.registerSubscription=e,this.unregisterSubscription=n}return t.prototype.createSubscription=function(t,e){var n=this;return new s((function(){return n.registerSubscription(t)}),(function(){return n.unregisterSubscription(t)}),e)},t.prototype.getData=function(){return this.watchedData()},t}(),o=function(){function t(t,e,n){this.watchedData=t,this.registerSubscription=e,this.unregisterSubscription=n}return t.prototype.createSubscription=function(t,e){var n=this,r=function(){return t(n.watchedData())};return new s((function(){return n.registerSubscription(r)}),(function(){return n.unregisterSubscription(r)}),e)},t.prototype.getData=function(){return this.watchedData()},t}(),a=function(){function t(t,e,n,r){this.collection=t,this.itemProperty=e,this.subscribeFcn=n,this.unsubcribeFcn=r}return t.prototype.createSubscription=function(t,e){var n=this,i=[],o=new s((function(){var e,o,a=function(e){var r=function(){return t(e,n.itemProperty)};i.push(r),n.subscribeFcn(e,r)};try{for(var s=r(n.collection),c=s.next();!c.done;c=s.next()){a(c.value)}}catch(t){e={error:t}}finally{try{c&&!c.done&&(o=s.return)&&o.call(s)}finally{if(e)throw e.error}}}),(function(){var t,e,o=0;try{for(var a=r(n.collection),s=a.next();!s.done;s=a.next()){var c=s.value;n.unsubcribeFcn(c,i[o]),o++}}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}}),e);return this.collection.hasOwnProperty("isObservable")?(this.collection.onElementChanged({onAdded:function(e){i.push((function(){return t(e,n.itemProperty)})),o.active&&n.subscribeFcn(e,i[i.length-1])},onRemoved:function(t){var e,o,a=0;try{for(var s=r(n.collection),c=s.next();!c.done;c=s.next()){if(c.value===t)break;a++}}catch(t){e={error:t}}finally{try{c&&!c.done&&(o=s.return)&&o.call(s)}finally{if(e)throw e.error}}n.unsubcribeFcn(t,i[a]),i.splice(a,1)}}),o):o},t.prototype.getData=function(){return this.collection},t}(),s=function(){function t(t,e,n){void 0===n&&(n=!1),this.startSubscription=t,this.endSubscription=e,this.isSubbed=!1,n&&this.renew()}return t.prototype.renew=function(){this.isSubbed||(this.startSubscription(),this.isSubbed=!0)},t.prototype.cancel=function(){this.isSubbed&&(this.endSubscription(),this.isSubbed=!1)},Object.defineProperty(t.prototype,"active",{get:function(){return this.isSubbed},enumerable:!0,configurable:!0}),t}();function c(t,e){return new s(t,e,!0)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return s}));var r,i=n(5),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(){var e=t.call(this)||this;return e.id="LOCK_NAVIGATION",e}return o(e,t),e}(i.a),s=function(t){function e(){var e=t.call(this)||this;return e.id="UNLOCK_NAVIGATION",e}return o(e,t),e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o})),n.d(e,"d",(function(){return a})),n.d(e,"c",(function(){return s}));var r=n(235),i="analytics/name",o="analytics/config_key",a="analytics_provider",s=r.a.Logging},function(t,e,n){"use strict";var r=n(251);t.exports=function(t){if(!r(t))throw new TypeError("Cannot use null or undefined");return t}},function(t,e,n){"use strict";t.exports=function(t){if("function"!=typeof t)throw new TypeError(t+" is not a function");return t}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"c",(function(){return s})),n.d(e,"b",(function(){return c}));var r,i=n(101),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n){var r=t.call(this)||this;return r.position=e,r.buttons=n,r}return o(e,t),e}(i.a),s=function(t){function e(e,n,r){var i=t.call(this)||this;return i.position=e,i.delta=n,i.buttons=r,i}return o(e,t),e}(i.a),c=function(t){function e(e,n,r,i,o){var a=t.call(this,e,n,r)||this;return a.timeSinceLastMove=i,a.fullDelta=o,a}return o(e,t),e}(s)},function(t,e,n){"use strict";n.r(e);var r,i=n(175),o=n(131),a=n(4),s=n(254),c=n(1),u=n(410),l=n(2),h=n(15),f=n(7),p=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),d=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},y=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},m=new l.a("camera-start"),v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="camera-start",e}return p(e,t),e.prototype.init=function(t,e){return d(this,void 0,void 0,(function(){var n,r,a,c,u,l,f,p;return y(this,(function(d){switch(d.label){case 0:return this.engine=e,n=this,[4,e.market.waitForData(h.a)];case 1:return n.sweepData=d.sent(),[4,t.cameraStartSync.load()];case 2:return r=d.sent(),a=this,[4,e.market.waitForData(i.a)];case 3:return a.snapshotsData=d.sent(),(c=s.a.deserialize())&&(u=this.parseNavigationPose(c),this.validStartPano(u)?(this.startingPose=new o.b,this.startingPose.copy(u),m.debug("Starting Camera Pose",this.startingPose)):m.error("Invalid start pose",u)),l=r&&r.icon||void 0,f=this.getIconThumbnail(l)||void 0,p=this.getIconStartPose(l)||this.getStartFallback(),this.data=new o.a(l,f,p),e.market.register(this,o.a,this.data),t.createSyncMonitor&&t.cameraStartSync.addMonitor(t.createSyncMonitor()),[2]}}))}))},e.prototype.getStartingPose=function(){return this.startingPose||this.data.pose},e.prototype.parseNavigationPose=function(t){var e=t.mode,n=t.quaternion,r=t.position,i=t.floorVisibility,o=t.sweepIndex,a=t.zoom,s=t.panoId;if(!s&&void 0!==o){var c=this.sweepData.getSweepByIndex(o);c?s=c.id:m.debug("Failed to load sweep index "+o)}return{mode:e,camera:{position:r,rotation:n,zoom:a},pano:{uuid:s},floorVisibility:i}},e.prototype.updateStartLocationFromSnapshot=function(t){var e=this.buildCameraStart(t),n=new o.a(t.sid,t.thumbnailUrl,e);this.engine.broadcast(new u.a(t.is360)),this.data.copy(n),this.data.commit()},e.prototype.buildCameraStart=function(t){var e={mode:t.metadata.camera_mode,camera:{position:t.metadata.camera_position,rotation:t.metadata.camera_quaternion,zoom:t.metadata.ortho_zoom},pano:{}};return e.mode===c.a.Panorama&&(e.pano={uuid:t.metadata.scan_id}),e.floorVisibility=t.metadata.floorVisibility,e},e.prototype.defaultCameraStart=function(t){return{mode:c.a.Panorama,camera:{position:t.position,rotation:Object(f.m)(t.rotation),zoom:0},pano:{uuid:t.id}}},e.prototype.validStartPano=function(t){return!!t&&(t.mode!==c.a.Panorama||!!t.pano.uuid&&this.sweepData.containsSweep(t.pano.uuid))},e.prototype.getStartFallback=function(){var t=this.sweepData.getFirstAlignedSweep();return this.defaultCameraStart(t||this.sweepData.getFirstSweep())},e.prototype.getIconStartPose=function(t){var e=null;return t&&t in this.snapshotsData.collection&&(e=(new o.b).copy(this.buildCameraStart(this.snapshotsData.get(t)))),this.validStartPano(e)||(e=null),e},e.prototype.getIconThumbnail=function(t){if(t&&t in this.snapshotsData.collection)return this.snapshotsData.get(t).thumbnailUrl},e}(a.a);e.default=v},function(t,e,n){"use strict";var r,i,o=n(0),a=n(2),s=n(13),c=n(20),u=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},l=new a.a("api"),h=((r={})[s.d.BASE]="low",r[s.d.STANDARD]="high",r[s.d.HIGH]="2k",r[s.d.ULTRAHIGH]="4k",r),f=((i={})[s.d.BASE]=256,i[s.d.STANDARD]=1024,i[s.d.HIGH]=2048,i[s.d.ULTRAHIGH]=4096,i),p=function(){function t(t){this.urls=t,this.sweepCubeTextures={}}return t.prototype.useTexture=function(t){var e=this.getTexture(t);if(!e)throw Error("Texture for sweep "+t+" not loaded before using");return e},t.prototype.loadFace=function(t,e,n,r){return this.loadFaceImage(t,e,n,r).then((function(t){var e=new o.vc(t);return e.needsUpdate=!0,e}))},t.prototype.load=function(t,e){var n=this;void 0===e&&(e=s.d.STANDARD);var r=this.sweepCubeTextures[t];if(r)return l.debug("Skipping load of pano, already loaded"),new Promise((function(t,e){t(r)}));var i=[2,4,0,5,1,3].map((function(r){return n.loadFaceImage(t,e,r)})),a=Promise.all(i).then((function(e){var r=new o.t(e);return r.flipY=!1,r.needsUpdate=!0,n.sweepCubeTextures[t]=r,r}));return a.catch((function(){l.error("Downloading cubemap for pano",t,"failed")})),a},t.prototype.unload=function(t){var e=this.sweepCubeTextures[t];if(!e)throw Error("Texture for sweep "+t+" not loaded before unloading");e.dispose(),this.sweepCubeTextures[t]=null},t.prototype.unloadAll=function(t){var e,n,r=Object(c.b)(t);try{for(var i=u(Object.keys(this.sweepCubeTextures)),o=i.next();!o.done;o=i.next()){var a=o.value;this.sweepCubeTextures[a]&&!r[a]&&this.unload(a)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}},t.prototype.loadFaceImage=function(t,e,n,r){var i=h[e],o=f[e],a="pan/"+i+"/"+t+"_skybox"+n+".jpg";return this.urls.getImageBitmap(a,o,o,r)},t.prototype.getTexture=function(t){return this.sweepCubeTextures[t]},t}();e.a=p},function(t,e,n){"use strict";n.r(e);var r,i=n(279),o=n(4),a=n(20),s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},u=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},l=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="analytics",e.endpoints=[],e.loaded=!1,e.bufferedData=[],e.track=function(t,n){return e.loaded?Object(a.d)(0).then((function(){e.endpoints.forEach((function(e){e.track(t,n)}))})):(e.bufferedData.push({event:t,data:n}),Promise.resolve())},e.trackAsync=function(t,n){e.loaded?e.endpoints.forEach((function(e){e.trackAsync(t,n)})):e.bufferedData.push({event:t,data:n})},e}return s(e,t),e.prototype.load=function(t,e,n,r,o){return c(this,void 0,void 0,(function(){var a,s,c,h,f,p,d,y,m,v,g;return u(this,(function(u){switch(u.label){case 0:this.loaded=!1,u.label=1;case 1:u.trys.push([1,6,7,8]),c=l(t),h=c.next(),u.label=2;case 2:return h.done?[3,5]:(f=h.value,p=f.provider,d=f.token,y=f.url,void 0===i.b[p]?[3,4]:(m=i.b[p].class,[4,(v=new m(d,y,e)).init(n,r)]));case 3:u.sent(),o&&o.loggedIn&&v.identify(o),this.endpoints.push(v),this.loaded=!0,u.label=4;case 4:return h=c.next(),[3,2];case 5:return[3,8];case 6:return g=u.sent(),a={error:g},[3,8];case 7:try{h&&!h.done&&(s=c.return)&&s.call(c)}finally{if(a)throw a.error}return[7];case 8:return this.loaded&&this.flushBufferedData(),[2,this.loaded]}}))}))},e.prototype.flushBufferedData=function(){var t,e,n=function(t){r.endpoints.forEach((function(e){e.track(t.event,t.data)}))},r=this;try{for(var i=l(this.bufferedData),o=i.next();!o.done;o=i.next()){n(o.value)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}this.bufferedData.length=0},e}(o.a);n.d(e,"Analytics",(function(){return h}));e.default=h},function(t,e,n){"use strict";var r=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},i=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},o=function(t){return""+t},a=function(){function t(t){void 0===t&&(t=o),this.mappingFunction=t,this.list=[],this.map={}}return t.prototype.add=function(t){var e=this.mappingFunction(t);return!this.map[e]&&(this.list.push(t),this.map[e]=t,!0)},t.prototype.set=function(t){var e=this.mappingFunction(t);return this.map[e]?(this.map[e]=t,!0):(this.add(t),!0)},t.prototype.count=function(){return this.list.length},t.prototype[Symbol.iterator]=function(){var t,e,n,o,a;return r(this,(function(r){switch(r.label){case 0:r.trys.push([0,5,6,7]),n=i(this.list),o=n.next(),r.label=1;case 1:return o.done?[3,4]:[4,o.value];case 2:r.sent(),r.label=3;case 3:return o=n.next(),[3,1];case 4:return[3,7];case 5:return a=r.sent(),t={error:a},[3,7];case 6:try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}return[7];case 7:return[2]}}))},t.prototype.getByIndex=function(t){return this.list[t]},t.prototype.get=function(t){return this.map[t]},t.prototype.copyToList=function(t){return t.push.apply(t,this.list),t},t.prototype.clear=function(){this.list=[],this.map={}},t.prototype.mapElements=function(t){return this.list.map(t)},t}();e.a=a},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r,i=n(124),o=n(23),a=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(t){function e(){var e=t.call(this)||this;return e.name="cursor",e.opacity=new i.a(0),e}return a(e,t),e}(o.a)},function(t,e,n){"use strict";var r,i=n(23),o=n(0),a=function(){function t(){this.list=[]}return t.prototype.insort=function(t){var e=this.binarySearch(t),n=e.index;if(!e.success)for(;this.compare(t,this.list[n])>=0&&n<this.list.length;)n++;for(var r=this.list.length;r>n;r--)this.list[r]=this.list[r-1];this.list[n]=t},t.prototype.removeIndex=function(t){if(t>this.list.length)throw Error("OrderList.removeIndex() -> Invalid index: "+t);this.list.splice(t,1)},t.prototype.getElement=function(t){if(t>=0&&t<this.list.length)return this.list[t];throw new Error("OrderList.getElement() -> Invalid index: "+t)},Object.defineProperty(t.prototype,"length",{get:function(){return this.list.length},enumerable:!0,configurable:!0}),t.prototype.find=function(t){var e=this.binarySearch(t);return e.success?e.index:-1},t.prototype.compare=function(t,e){return void 0===e?1:"number"==typeof t?t===e?0:t<e?-1:1:t.compare(e)},t.prototype.binarySearch=function(t){for(var e=0,n=this.list.length-1,r=-1,i=null,o=0;e<=n;){if(r=Math.floor((e+n)/2),i=this.list[r],0===(o=this.compare(t,i)))return{success:!0,index:r};o<0?n=r-1:e=r+1}return{success:!1,index:r}},t}(),s=n(30),c=n(69),u=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=function(t){function e(e,n){var r=t.call(this)||this;return r.floorIndex=e,r.name=n,r.center=new o.Jc,r.boundingBox=new o.h,r.size=new o.Jc,r.sweepHeights=new a,r.sweepFloorHeights=new a,r.medianSweepHeight=function(){return r.sweepHeights.length>0?r.sweepHeights.getElement(Math.floor(r.sweepHeights.length/2)):r.center.y},r.minSweepFloorHeight=function(){return r.sweepFloorHeights.length>0?r.sweepFloorHeights.getElement(0):r.boundingBox.min.y},r.name=n,r}return u(e,t),e.prototype.setBounds=function(t){this.boundingBox.copy(t),this.boundingBox.getSize(this.size),this.boundingBox.getCenter(this.center)},e.prototype.addSweep=function(t){this.sweepHeights.insort(t.position.y),this.sweepFloorHeights.insort(t.floorPosition.y)},Object.defineProperty(e.prototype,"bottom",{get:function(){return this.minSweepFloorHeight()},enumerable:!0,configurable:!0}),e.prototype.deepCopy=function(){return Object(s.a)({name:this.name,center:this.center,boundingBox:this.boundingBox,size:this.size,medianSweepHeight:this.medianSweepHeight(),bottom:this.bottom})},e}(c.a),h=n(84),f=n(2),p=n(44),d=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),y=function(t){function e(e){void 0===e&&(e="Invalid Floor");var n=t.call(this,e)||this;return n.name="InvalidFloorException",n}return d(e,t),e}(p.a);n.d(e,"b",(function(){return b})),n.d(e,"a",(function(){return _}));var m=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),v=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},g=new f.a("floor-data"),b=function(t){var e=Object(h.b)();for(var n in t){var r=w(t[n].floorIndex,t[n].name);e.set(n,r)}return new _(e)},w=function(t,e){return void 0===e&&(e=""),new l(t,e)},_=function(t){function e(e){var n,r,i=t.call(this)||this;if(i.name="floors",i.floors=Object(h.b)(),e)try{for(var o=v(e),a=o.next();!a.done;a=o.next()){var s=a.value;i.floors.set(s.floorIndex,s)}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i}return m(e,t),e.prototype.getFloor=function(t){if(this.floors.has(t))return this.floors.get(t);g.debug("Could not find floor based on index")},e.prototype.buildFloorBounds=function(t,e){var n;return this.floors.has(t)?((n=this.floors.get(t)).setBounds(e),n):((n=w(t)).setBounds(e),this.floors.set(t,n),n)},e.prototype.getFloorCount=function(){return this.floors.length},e.prototype.getCollection=function(){return this.floors},e.prototype.iterate=function(t){var e,n,r=this.floors.values;r.sort((function(t,e){return t.floorIndex-e.floorIndex}));try{for(var i=v(r),o=i.next();!o.done;o=i.next()){t(o.value)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}},e.prototype.getTopFloor=function(){var t,e,n=null;try{for(var r=v(this.floors),i=r.next();!i.done;i=r.next()){var o=i.value;(!n||o.floorIndex>n)&&(n=o.floorIndex)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return null!==n?this.floors.get(n):null},e.prototype.getFloorContainingPoint=function(t,e){var n,r;void 0===e&&(e=!1);var i=e?this.floors.keys.reverse():this.floors.keys;try{for(var o=v(i),a=o.next();!a.done;a=o.next()){var s=a.value,c=this.floors.get(s);if(c.boundingBox.containsPoint(t))return c}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return null},e.prototype.getFloorAtHeight=function(t,e){var n,r;void 0===e&&(e=!1);var i=this.floors.keys.sort(),o=e?i.reverse():i;try{for(var a=v(o),s=a.next();!s.done;s=a.next()){var c=s.value,u=this.floors.get(c),l=u.boundingBox;if(l.min.y<=t&&t<=l.max.y)return u}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}if(t<this.floors.get(0).boundingBox.min.y)return this.floors.get(0);var h=this.getTopFloor();if(h)return h;throw new y("getFloorAtHeight - couldn't find a valid floor")},e.prototype.getClosestFloorAtHeight=function(t){var e,n,r,i=1/0;try{for(var o=v(this.floors),a=o.next();!a.done;a=o.next()){var s=a.value,c=Math.abs(s.medianSweepHeight()-t);i>c&&(i=c,r=s)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return r},e.prototype.rename=function(t,e){if(this.floors.has(t)){var n=this.floors.get(t);n.name=e,n.commit()}},e}(i.a)},function(t,e,n){"use strict";var r=n(2),i=n(221),o=n(306),a=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},s=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},c=new r.a("mp-password-authentication"),u=function(){function t(t){void 0===t&&(t=window.location.origin),this.baseUrl=t,this.errorType=i.a.UNKNOWN}return t.prototype.authenticate=function(e,n){return a(this,void 0,void 0,(function(){var r,i=this;return s(this,(function(o){return e.match(/[a-zA-Z0-9]+/)?(r=this.baseUrl+"/api/v2/models/"+e+"/public-access/",[2,this.fetchToken(r,n).then((function(e){return a(i,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:return n={},e?[4,e.json()]:[3,2];case 1:if(n=r.sent(),e.ok&&n.token)return this.login(n.token),[2,!0];r.label=2;case 2:return this.errorType=t.getErrorType(n.code),this.logout(),[2,!1]}}))}))}))]):(c.error("Invalid Model ID "+e),[2,!1])}))}))},t.prototype.isAuthenticated=function(){return void 0!==t.token},t.prototype.login=function(e){t.token=e},t.prototype.logout=function(){t.token=void 0},t.prototype.getAuthorizationHeader=function(){return t.token?"Matterport-Object-Access "+t.token:""},t.prototype.fetchToken=function(t,e){return a(this,void 0,void 0,(function(){var n;return s(this,(function(r){return n=JSON.stringify({password:e}),[2,fetch(t,{method:"POST",cache:"no-cache",headers:{"Content-Type":"application/json"},body:n})]}))}))},t.getErrorType=function(t){switch(t){case o.a.TOO_MANY_ATTEMPTS:return i.a.TOO_MANY_ATTEMPTS;case o.a.INVALID_PASSWORD:return i.a.INVALID_CREDENTIALS}return i.a.UNKNOWN},t}(),l=n(6),h=[new(function(){function t(){var t=Object(l.A)("auth","");this.authenticate(t)}return t.prototype.isAuthenticated=function(){return!!t.token},t.prototype.authenticate=function(e){return!(!e||"string"!=typeof e)&&(t.token=e.replace(","," "),!0)},t.prototype.getAuthorizationHeader=function(){return t.token?t.token:""},t}()),new u];n.d(e,"b",(function(){return f})),n.d(e,"a",(function(){return u}));var f=function(t){return void 0===t&&(t=h),t.map((function(t){return t.getAuthorizationHeader()})).find(Boolean)||""}},function(t,e,n){"use strict";n.d(e,"d",(function(){return o})),n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return c}));var r=n(419),i=n(6),o=function(t,e){var n,i,o;if(void 0===t&&(t=""),t.match(/^https?/)){n=(a=Object(r.parse)(t)).protocol+"//"+a.host,i=t,o=t.match(/[^/]*$/)[0]}else{var a;if(e.match(/^https?/))n=(a=Object(r.parse)(e)).protocol+"//"+a.host;else n=window.location.protocol+"//"+e;i=n+"/api/player/models/"+t,o=t}return{sid:o,urlBase:n,urlModel:i,urlFiles:i+(i.match(/\/$/)?"files":"/files"),urlThumb:i+(i.match(/\/$/)?"thumb":"/thumb")}},a=function(){return Object(i.A)("model")||Object(i.A)("m")},s=function(t,e){for(var n in void 0===e&&(e={}),e){var r=e[n];t+=(-1===t.indexOf("?")?"?":"&")+n+"="+r}return t},c=function(t){return t.replace(/^https?:\/\/(?:www.)?/i,"").replace(/\/(.*)/,"")}},function(t,e,n){"use strict";n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return c}));var r,i=n(44),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e){return t.call(this,e)||this}return o(e,t),e}(i.a),s=function(t){function e(e){return t.call(this,e)||this}return o(e,t),e}(i.a),c=function(t){function e(e){return t.call(this,e)||this}return o(e,t),e}(i.a)},function(t,e,n){"use strict";n.d(e,"d",(function(){return a})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return u}));var r=n(0),i=n(7),o=n(14),a=function(t){var e=o.f;if(!isNaN(t)){var n=Math.min(Math.max(o.H,t),o.G);e=Object(i.r)(n,o.H,o.G,o.b,o.I)}return e},s=function(t){return Object(i.r)(t,o.b,o.a,o.H,o.G)},c=function(t){return Math.min(Math.max(o.b,t),o.a)},u=function(t){return r.ib.degToRad(t)/1e3}},function(t,e,n){"use strict";n.r(e);var r,i=n(58),o=n(212),a=n(0),s=n(351),c=n(3),u=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};!function(t){t[t.PreOrder=0]="PreOrder",t[t.PostOrder=1]="PostOrder"}(r||(r={}));var l,h=function(){function t(e,n){this.tree=e,this.parent=n,this.children=[],this.id=++t._id,this.extra={},this.level=-1}return t._id=0,t}(),f=function(){function t(t,e){this.levels=e,this.tileSize=t,this.root=null,this.allNodes=[],y(this)}return t.prototype.getSizeForLevel=function(t,e){return Math.pow(2,e)*t},t.prototype.getSubNode=function(t,e,n){(!e||t<this.tileSize)&&(e=0),(!n||t<this.tileSize)&&(n=0),t<this.tileSize&&(t=this.tileSize);var r=p(this.tileSize,t);return v(this.root,0,r,e,n)},t.prototype.deleteAllNodes=function(){this.depthFirst(function(t,e,n,r,i){for(var o=0;o<t.children.length;o++){var a=t.children[o];a&&(a.parent=null,a.tree=null),t.children[o]=null}t.children.length=0}.bind(this),null,r.PostOrder);for(var t=0;t<this.allNodes.length;t++){var e=this.allNodes[t];e&&(e.parent=null,e.tree=null),this.allNodes[t]=null}this.allNodes.length=0,this.root=null},t.prototype.breadthFirst=function(t){var e,n,r=!!(t=t||{}).nullLevelEnd,i=t.maxLevel,o=t.minLevel,a=t.callback,s=t.saveVisited,c=[],l=new h(this,null),f=0;if(this.root)for(c.push(this.root),c.push(l);c.length>0&&!(i&&f>i);){var p=c.shift();if(p)if(p===l)(!o||f>=o)&&(a&&r&&a(),s&&r&&s.push(null)),c.length>0&&c.push(l),f++;else{if(p.children)try{for(var d=u(p.children),y=d.next();!y.done;y=d.next()){var m=y.value;m&&c.push(m)}}catch(t){e={error:t}}finally{try{y&&!y.done&&(n=d.return)&&n.call(d)}finally{if(e)throw e.error}}var v=this.getFaceIndexFromNode(p);(!o||f>=o)&&(a&&a(p,f,v),s&&s.push(p))}}},t.prototype.getFaceIndexFromNode=function(t){if(!t)return-1;for(var e=1,n=t,r=0,i=0;;){var o=n.parent;if(!o)break;for(var a=-1,s=0;s<o.children.length;s++)o.children[s]===n&&(a=s);r=a%2*e+r,i=Math.floor(a/2)*e+i,e*=2,n=o}return i*e+r},t.prototype.depthFirst=function(t,e,n){d(this.root,0,0,0,t,e,n,this.tileSize)},t}(),p=function(t,e){var n=0;for(e<t&&(e=t);!((e/=2)<t);)n++;return n},d=function(t,e,n,i,o,a,s,c){if(t){var u=2*i+n;if((s=s||r.PreOrder)===r.PreOrder&&(o&&o(t,e,u,n,i),a&&a.push(t)),t.children&&0!==t.children.length){for(var l=2*i,h=2*n,f=0;f<2;f++)for(var p=0;p<2;p++)d(t.children[2*p+f],e+1,h+f,l+p,o,a,s,c);s===r.PostOrder&&(o&&o(t,e,u,n,i),a&&a.push(t))}}},y=function(t){t.root=m(t,null,0)},m=function(t,e,n){if(n>t.levels)return null;var r=new h(t,e);r.level=n,t.allNodes.push(r);for(var i=0;i<4;i++){var o=m(t,r,n+1);o&&(r.children[i]=o)}return r},v=function(t,e,n,r,i){if(!t)return null;if(0===n)return t;if(!t.children||0===t.children.length)return null;var o=Math.pow(2,n)/2,a=r%o,s=i%o,c=2*Math.floor(i/o)+Math.floor(r/o),u=t.children[c];return v(u,e+1,n-1,a,s)},g=n(39),b=n(352),w=n(141),_=n(236),x=n(13),S=n(213);!function(t){t[t.None=0]="None",t[t.Queued=1]="Queued",t[t.ForceQueued=2]="ForceQueued",t[t.Downloading=3]="Downloading",t[t.Downloaded=4]="Downloaded",t[t.DownloadFailed=5]="DownloadFailed"}(l||(l={}));var T,M=l,E=n(7),P=n(20),O=n(40),A=n(119),D=n(38),R=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};!function(t){t[t.None=0]="None",t[t.DirectionalFOV=1]="DirectionalFOV"}(T||(T={}));var C=function(t,e,n,r,i){this.sweep=t,this.cameraPosition=(new a.Jc).copy(e),this.cameraDir=(new a.Jc).copy(n),this.panoSpaceDir=(new a.Jc).copy(r),this.upcomingSweeps=i,this.zoomingActive=!1},I=function(t,e,n){var r,i;void 0===n&&(n=!1);var o=0;if(t&&e)try{for(var a=R(e),s=a.next();!s.done;s=a.next()){var c=s.value;n&&-1!==t.indexOf(c)||(t.push(c),o++)}}catch(t){r={error:t}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return o},k=function(){function t(t,e){this.panoQualityManager=t,this.tilingSettings=e,this.persistentStorage=new S.a,this.maxResolution=t.getNavPanoSize(),this.currViewQueue=B(),this.fullPanoQueue=B(),this.priorityCriteria=new C(null,new a.Jc(0,0,0),new a.Jc(0,0,-1),new a.Jc(0,0,-1))}return t.prototype.getQualityQueueSize=function(t,e){return t===vt.CurrentView?this.currViewQueue[e].value:this.fullPanoQueue[e].value},t.prototype.makeQueueSubscription=function(t,e,n){return(t===vt.CurrentView?this.currViewQueue[e]:this.fullPanoQueue[e]).onChanged(n)},t.prototype.updateCriteria=function(t,e,n){this.priorityCriteria.sweep=t,this.priorityCriteria.cameraPosition.copy(e),this.priorityCriteria.cameraDir.copy(n)},t.prototype.setUpcomingSweeps=function(t){this.priorityCriteria.upcomingSweeps=t},t.prototype.clearUpcomingSweeps=function(){this.priorityCriteria.upcomingSweeps=void 0},t.prototype.filterAndPrioritize=function(e,n,r){var i,o;if(this.priorityCriteria.sweep){var a=void 0!==this.priorityCriteria.upcomingSweeps&&null!==this.priorityCriteria.upcomingSweeps,s=this.persistentStorage.getArray("filterAndPrioritize:tempQueue"),c=[];a||(c=this.persistentStorage.getArray("filterAndPrioritize:scoredSweeps"),this.populateScoredSweeps(this.priorityCriteria.sweep,n,c,this.priorityCriteria.cameraDir,6));var u=this.priorityCriteria.sweep.id;s.length=0,this.queueTilesForPano(s,r,this.priorityCriteria.sweep,x.c.BASE);var l=I(e,s,!0);if(this.currViewQueue[x.d.BASE].value=l,this.fullPanoQueue[x.d.BASE].value=l,this.priorityCriteria.upcomingSweeps){var h=0;try{for(var f=R(this.priorityCriteria.upcomingSweeps),p=f.next();!p.done;p=f.next()){var d=p.value;if((h+=this.queueTilesForPano(e,r,d,x.c.BASE))>=3)break}}catch(t){i={error:t}}finally{try{p&&!p.done&&(o=f.return)&&o.call(f)}finally{if(i)throw i.error}}}if(this.canDownloadSize(u,x.d.STANDARD)){s.length=0;var y=this.queueTilesInDirectionForPano(s,r,this.priorityCriteria.sweep,x.c.STANDARD,this.priorityCriteria.cameraPosition,this.priorityCriteria.cameraDir,120);t.sortTiles(s,this.priorityCriteria.sweep,this.priorityCriteria.cameraDir),I(e,s,!0),this.currViewQueue[x.d.STANDARD].value=y,this.fullPanoQueue[x.d.STANDARD].value=y}if(!a&&this.maxResolution<=2048&&this.queueTilesForPanos(e,c,r,x.c.BASE,2),s.length=0,this.canDownloadSize(u,x.d.HIGH)){y=this.queueTilesInDirectionForPano(s,r,this.priorityCriteria.sweep,x.c.HIGH,this.priorityCriteria.cameraPosition,this.priorityCriteria.cameraDir,120);this.currViewQueue[x.d.HIGH].value=y}if(this.canDownloadSize(u,x.d.ULTRAHIGH)){y=this.queueTilesInDirectionForPano(s,r,this.priorityCriteria.sweep,x.c.ULTRAHIGH,this.priorityCriteria.cameraPosition,this.priorityCriteria.cameraDir,120);this.currViewQueue[x.d.ULTRAHIGH].value=y}if(t.sortTiles(s,this.priorityCriteria.sweep,this.priorityCriteria.cameraDir),I(e,s,!0),s.length=0,this.canDownloadSize(u,x.d.STANDARD)&&this.queueTilesInDirectionForPano(s,r,this.priorityCriteria.sweep,x.c.STANDARD,this.priorityCriteria.cameraPosition,this.priorityCriteria.cameraDir,180),this.canDownloadSize(u,x.d.HIGH)&&this.queueTilesInDirectionForPano(s,r,this.priorityCriteria.sweep,x.c.HIGH,this.priorityCriteria.cameraPosition,this.priorityCriteria.cameraDir,180),this.canDownloadSize(u,x.d.ULTRAHIGH)&&this.queueTilesInDirectionForPano(s,r,this.priorityCriteria.sweep,x.c.ULTRAHIGH,this.priorityCriteria.cameraPosition,this.priorityCriteria.cameraDir,180),t.sortTiles(s,this.priorityCriteria.sweep,this.priorityCriteria.cameraDir),I(e,s,!0),this.tilingSettings.downloadFullPano){if(s.length=0,this.maxResolution<=x.c.HIGH){if(this.canDownloadSize(u,x.d.HIGH)){y=this.queueTilesForPano(s,r,this.priorityCriteria.sweep,x.c.HIGH);this.fullPanoQueue[x.d.HIGH].value=y}}else if(this.canDownloadSize(u,x.d.ULTRAHIGH)){y=this.queueTilesForPano(s,r,this.priorityCriteria.sweep,x.c.ULTRAHIGH);this.fullPanoQueue[x.d.ULTRAHIGH].value=y}t.sortTiles(s,this.priorityCriteria.sweep,this.priorityCriteria.cameraDir),I(e,s,!0)}if(!a){var m=this.persistentStorage.getArray("filterAndPrioritize:neighbors");this.populateNeighborSweeps(this.priorityCriteria.sweep,n,m),this.queueTilesForPanos(e,m,r,x.c.BASE)}}},t.prototype.canDownloadSize=function(t,e){var n=x.a[e],r=this.panoQualityManager.getNavPanoSize()>=n||this.maxResolution>=n&&this.panoQualityManager.getZoomPanoSize()>=n,i=this.panoQualityManager.getTestResults(t,e);return r&&i===w.a.Untested&&this.panoQualityManager.testDownload(t,e,g.b),i===w.a.Success&&r},t.prototype.populateNeighborSweeps=function(t,e,n){for(var r in(n=n||[]).length=0,t.neighbours){var i=t.neighbours[r],o=e.get(i);n.push(o)}},t.prototype.populateScoredSweeps=function(t,e,n,r,o){(n=n||[]).length=0;for(var s=(new a.Jc).copy(t.position),c=[O.a(s,r,.75),O.i(t)],u=[A.d(s,i.c.navigation.distanceFactor),A.b(s,r,i.c.navigation.directionFactor)],l=j(c,u,e),h=0;h<l.length&&h<o;h++){var f=l[h].sweep;n.push(f)}},t.prototype.queueTilesForPanos=function(t,e,n,r,i){var o,a,s=0;try{for(var c=R(e),u=c.next();!u.done;u=c.next()){var l=u.value;if(s+=this.queueTilesForPano(t,n,l,r)>0?1:0,i&&s>=i)break}}catch(t){o={error:t}}finally{try{u&&!u.done&&(a=c.return)&&a.call(c)}finally{if(o)throw o.error}}return s},t.prototype.queueTilesForPano=function(t,e,n,r){var i=this.persistentStorage.get("queueTilesForSweep:filterCriteria",(function(){return{filter:T.None}}));return this.filterAndQueueTileDownloadDescriptors(t,e,n,r,i)},t.prototype.queueTilesInDirectionForPano=function(t,e,n,r,i,o,s){var c=this.persistentStorage.get("queueTilesInDirectionForSweep:panoSpaceDir",(function(){return new a.Jc})),u=this.persistentStorage.get("queueTilesInDirectionForSweep:filterCriteria",(function(){return{filter:T.DirectionalFOV,direction:new a.Jc,fov:60}}));return c.copy(o),g.d(n.rotation,c),u.direction.copy(c),u.fov=s,this.filterAndQueueTileDownloadDescriptors(t,e,n,r,u)},t.prototype.filterAndQueueTileDownloadDescriptors=function(t,e,n,r,i){var o,a,s=this.persistentStorage.getArray("filterAndQueueTileDownloadDescriptors:descriptors"),c=e.getTileDownloadDescriptors(n,r);s.length=0,this.filterTileDownloadDescriptors(c,s,i);var u=0;try{for(var l=R(s),h=l.next();!h.done;h=l.next()){var f=h.value;f&&(t.push(f),u++)}}catch(t){o={error:t}}finally{try{h&&!h.done&&(a=l.return)&&a.call(l)}finally{if(o)throw o.error}}return u},t.prototype.filterTileDownloadDescriptors=function(t,e,n){var r,i;switch(n.filter){case T.DirectionalFOV:for(r=0;r<t.length;r++)(i=t[r])&&g.h(i.panoSize,i.tileSize,i.face,i.tileX,i.tileY,n.direction,n.fov)&&e.push(i);break;default:for(r=0;r<t.length;r++)i=t[r],e.push(i)}for(r=0;r<e.length;r++)(i=e[r])&&!this.canIncludeDescriptor(i)&&(e[r]=null)},t.prototype.canIncludeDescriptor=function(t){return t.status!==M.Downloading&&t.status!==M.Downloaded},t.sortTiles=function(t,e,n){L.panoSpaceDir.copy(n),g.d(e.rotation,L.panoSpaceDir),L.fovThresholdNarrow=E.l(120),L.fovThreshold=E.l(180),t.sort(N)},t.insertSortedPanoTile=function(t,e,n,r){L.panoSpaceDir.copy(r),g.d(n.rotation,L.panoSpaceDir),L.fovThresholdNarrow=E.l(120),L.fovThreshold=E.l(180);for(var i=-1,o=0;o<t.length;o++){if(N(e,t[o])<=0){i=o;break}}if(-1===i)t[t.length]=e;else{for(var a=t.length;a>i;a--)t[a]=t[a-1];t[i]=e}},t}(),L={panoSpaceDir:new a.Jc,fovThreshold:-1,fovThresholdNarrow:-1},N=function(t,e){var n=L.panoSpaceDir,r=L.fovThreshold,i=L.fovThresholdNarrow,o=Math.max(Math.min(n.dot(t.direction),1),-1),a=Math.max(Math.min(n.dot(e.direction),1),-1);return o>=r&&a<r?-1:o<r&&a>=r?1:o>=i&&a<i?-1:o<i&&a>=i?1:t.panoSize>e.panoSize?1:e.panoSize>t.panoSize?-1:-(o-a)},j=function(t,e,n){var r,i,o=[],a=function(n){if(!P.h(n,t))return"continue";o.push({sweep:n,score:e.reduce((function(t,e){return t+e(n)}),0)})};try{for(var s=R(n),c=s.next();!c.done;c=s.next()){a(c.value)}}catch(t){r={error:t}}finally{try{c&&!c.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return o.sort((function(t,e){return e.score-t.score})),o};function B(){var t;return(t={})[x.d.BASE]=Object(D.b)(0),t[x.d.STANDARD]=Object(D.b)(0),t[x.d.HIGH]=Object(D.b)(0),t[x.d.ULTRAHIGH]=Object(D.b)(0),t}var F,U=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};!function(t){t[t.Base=0]="Base",t[t.Remaining=1]="Remaining"}(F||(F={}));var z,G=function(){function t(){this.forceQueue=[],this.uploadQueues={},this.panoLODDescriptors={}}return t.prototype.addToForceQueue=function(t){this.forceQueue.push(t)},t.prototype.addToPanoQueue=function(t,e){this.getUploadQueueForPano(t).push(e)},t.prototype.insertSortedIntoPanoQueue=function(t,e,n){var r=this.getUploadQueueForPano(e.id);k.insertSortedPanoTile(r,t,e,n)},t.prototype.sortQueue=function(t,e){var n=this.getUploadQueueForPano(t.id);k.sortTiles(n,t,e)},t.prototype.getUploadQueueForPano=function(t){var e=this.uploadQueues[t];return e||(e=[],this.uploadQueues[t]=e),e},t.prototype.hasQueuedTiles=function(){if(this.forceQueue.length>0)return!0;for(var t in this.uploadQueues){var e=this.getUploadQueueForSweep(t);if(e&&e.length>0)return!0}return!1},t.prototype.getUploadQueueForSweep=function(t){var e=this.uploadQueues[t];return e||(e=[],this.uploadQueues[t]=e),e},t.prototype.getTopUploadQueue=function(t){for(var e,n,r=null,i=F.Base;i<=F.Remaining;i++)try{for(var o=U(t),a=o.next();!a.done;a=o.next()){var s=a.value;if((r=this.getUploadQueueForSweep(s.id)).length>0)switch(i){case F.Base:if(0===r[0].level)return r;break;case F.Remaining:return r}}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return null},t.prototype.processNextQueueItem=function(t){var e=t.shift();return e?(e.uploadQueued=!1,e):null},t.prototype.getNextFromUploadQueue=function(t){if(this.forceQueue.length>0)return this.processNextQueueItem(this.forceQueue);var e=this.getTopUploadQueue(t);return e&&e.length>0?this.processNextQueueItem(e):null},t.prototype.peekNextFromUploadQueue=function(t){if(this.forceQueue.length>0)return this.forceQueue[0];var e=this.getTopUploadQueue(t);return e&&e.length>0?e[0]:null},t.prototype.clearAllQueuedUploads=function(){this.clearAllUploadQueues(null,0)},t.prototype.clearAllUploadQueues=function(t,e){if(void 0===e&&(e=0),t)this.clearUploadQueue(this.getUploadQueueForSweep(t),e),this.clearUploadQueue(this.forceQueue,e,t);else{for(var n in this.uploadQueues)this.clearUploadQueue(this.getUploadQueueForSweep(n),e);this.clearUploadQueue(this.forceQueue,e)}},t.prototype.clearUploadQueue=function(t,e,n){void 0===e&&(e=0);for(var r=0;r<t.length;){var i=t[r];(!n||n&&n===i.sweepId)&&i.level>=e?(i.uploadQueued=!1,t.splice(r,1)):r++}},t.prototype.resetPanoLODDescriptors=function(t){var e=this.getPanoLODDescriptors(t);for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];r.uploadCount=0,r.uploadAttempts=0}},t.prototype.getPanoLODDescriptor=function(t,e){var n=this.getPanoLODDescriptors(t),r=n[e];return r||(r={uploadCount:0,uploadAttempts:0},n[e]=r),r},t.prototype.getPanoLODDescriptors=function(t){var e=this.panoLODDescriptors[t];return e||(e={},this.panoLODDescriptors[t]=e),e},t}(),H=n(308),V=n(177),W=(z=function(t,e){return(z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}z(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),q=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},Y=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},J=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},X=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},K=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(X(arguments[e]));return t},Q=i.c.uploadIntervalDelay,Z=function(t){function e(e,n,r,i,o,c,u,l){var h=t.call(this,e,o.getSweepList())||this;return h.cwfRenderer=n,h.panoQualityManager=r,h.tileDownloader=i,h.sweepData=o,h.cameraData=c,h.tilingSettings=u,h.broadcast=l,h.persistentStorage=new S.a,h.activeSweeps=[],h.sweepLoadHistory=[],h.activeRenderTargetDescriptors={},h.panoLoadPromises={},h.panoLoadResolvers={},h.tileTrees={},h.tileDirectory={},h.zoomSweepRenderingDisabled=!1,h.zoomingActive=!1,h.zoomSweepId=null,h.usingTileOverlay=!1,h.overlayTilesLoaded=!1,h.overlayTileBase=null,h.overlayTilesBasic={},h.overlayTilesEnhanced={},h.tileUploadQueue=new G,h.currentState={direction:new a.Jc,position:new a.Jc,rotation:new a.Pb},h.renderTargetPool=new s.a(h.rtCompare),h.tileDownloader.setModel(h.sweepListMap),h.tileDownloader.setLoadCallbacks(h.onTileDownLoaded.bind(h)),h}return W(e,t),e.prototype.activate=function(t){this.engine=t},e.prototype.rtCompare=function(t,e){return t.object.height===e.size&&t.object.width===e.size},e.prototype.getActivePanos=function(){var t,e,n=[];try{for(var r=J(Object.keys(this.activeRenderTargetDescriptors)),i=r.next();!i.done;i=r.next()){var o=i.value;this.activeRenderTargetDescriptors[o]&&n.push(o)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return n},e.prototype.init=function(){t.prototype.init.call(this),this.loadOverlayTiles()},e.prototype.highResRenderTarget=function(t,e){if(t){if(!e)throw new Error("Cannot activate zooming without sweepId!");this.zoomingActive=!0,this.zoomSweepId=e,this.copyTargetToZoom(e)}else this.zoomingActive=!1,this.zoomSweepId=null;if(e){var n=this.getRenderTargetDescriptorForSweep(e);if(!n)throw new Error("Zooming at a null render target!");var r=this.zoomingActive?this.zoomRenderTarget:n.object,i=r.width;this.broadcast(new H.a(i,e,r))}},e.prototype.getCurrentPanoResolution=function(){var t=this.zoomingActive?this.panoQualityManager.getZoomPanoSize():this.panoQualityManager.getNavPanoSize();return w.b.getPanoSizeClass(t)},e.prototype.beforeRender=function(){var t=this.sweepData.currentSweep,e=this.sweepData.transition.to;this.updateState(this.cameraData.pose.position,this.cameraData.pose.rotation,t,e),this.updateUploadQueueProcessing()},e.prototype.activateSweep=function(e){var n=this,r=this.sweepListMap.get(e);if(!r)throw new Error("Invalid sweepId passed to TiledPanORenderer.activate(): "+e);var i=this.panoLoadPromises[e];return i||(i=new Promise((function(t,i){n.panoLoadResolvers[e]=t,n.updateSweepState(e),n.activatePano(r),n.queueUploadForAllTiles(e,!0),n.tileDownloader.forceQueueTiles(r,w.b.getPanoSize(x.d.BASE),n.currentState.direction,!0)})),this.panoLoadPromises[e]=i),t.prototype.activateSweep.call(this,e),i},e.prototype.useTexture=function(e){var n=this.getRenderTargetDescriptorForSweep(e);if(!n)throw Error("Texture for sweep "+e+" not loaded before using");var r=n.object.texture;return t.prototype.useTexture.call(this,e),this.zoomingActive?this.zoomRenderTarget.texture:r},e.prototype.freeTexture=function(e,n){void 0===n&&(n=!1),t.prototype.freeTexture.call(this,e,n),0===this.textureUsageCounter[e]&&(this.panoLoadPromises[e]=null,this.deactivatePano(e))},e.prototype.freeAllTextures=function(t){var e,n;void 0===t&&(t=[]);var r=Object(P.b)(t),i=this.getActivePanos();try{for(var o=J(i),a=o.next();!a.done;a=o.next()){var s=a.value;r[s]||this.freeTexture(s,!0)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}},e.prototype.enableUltraHighQualityMode=function(t){this.setupZoomRenderTarget(),this.zoomSweepId&&this.broadcast(new H.a(this.zoomRenderTarget.width,this.zoomSweepId,this.zoomRenderTarget))},e.prototype.resetRenderStatus=function(t,e,n,r){var i;r&&(i=p(g.b,r)+1);for(var o=function(t,r,i,o){n&&(r.extra.tile.zoomUploaded=!1),e&&(r.extra.tile.uploaded=!1)},a=0;a<g.a;a++){this.getTileTree(t,a).breadthFirst({callback:o.bind(this,a),minLevel:i})}},e.prototype.copyBaseRenderStatusToZoomed=function(t){for(var e=p(g.b,this.panoQualityManager.getNavPanoSize()),n=function(t,e,n,r){e.extra.tile.zoomUploaded=e.extra.tile.uploaded,e.extra.zoomCovered=e.extra.covered},r=0;r<g.a;r++){this.getTileTree(t,r).breadthFirst({callback:n.bind(this,r),maxLevel:e})}},e.prototype.renderPanoTiles=function(t,e,n,r){var i=[];this.zoomRenderTarget&&this.zoomRenderTarget.width===this.panoQualityManager.getZoomPanoSize()||this.zoomSweepRenderingDisabled||this.setupZoomRenderTarget(),e=e||this.currentState.direction||c.b.FORWARD;var o=this.getRenderTargetDescriptorForSweep(t);if(!this.isRenderTargetDescriptorValid(o))throw new Error("PanoRenderer.renderPanoTiles() -> Cannot render to a pano that is not activated.");for(var a=0;a<g.a;a++){var s=this.getTileTree(t,a);i.length=0,s.breadthFirst({saveVisited:i});for(var u=0;u<i.length;u++){var l=i[u];this.queueUploadForTile(l.extra.tile,!1,r||0===u&&n)}}},e.prototype.clearAllQueuedUploads=function(){this.tileUploadQueue.clearAllUploadQueues(null,0)},e.prototype.clearAllQueuedUploadsForPano=function(t){this.tileUploadQueue.clearAllUploadQueues(t,0)},e.prototype.updateState=function(t,e,n,r){var i=r||n||this.currentState.sweepId,o=i?this.sweepListMap.get(i):null;this.updatePositionState(t),this.updateRotationState(e),i&&this.updateSweepState(i),o&&this.tileDownloader.tilePrioritizer&&this.tileDownloader.tilePrioritizer.updateCriteria(o,t,this.currentState.direction)},e.prototype.updatePositionState=function(t){this.currentState.position.copy(t)},e.prototype.updateRotationState=function(t){var e,n;if(this.currentState.rotation.copy(t),this.currentState.direction.copy(c.b.FORWARD).applyQuaternion(t),this.tileUploadQueue.hasQueuedTiles())try{for(var r=J(this.activeSweeps),i=r.next();!i.done;i=r.next()){var o=i.value;this.tileUploadQueue.sortQueue(o,this.currentState.direction)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},e.prototype.updateSweepState=function(t){this.currentState.sweepId=t},e.prototype.activatePano=function(t){this.tileUploadQueue.clearAllQueuedUploads();for(var e=this.panoQualityManager.getMaxPossiblePanoSize(),n=0;n<g.a;n++)this.initTileTree(t.id,n,e);this.linkAllTilesAndNodes(t);var r=this.getRenderTargetDescriptorForSweep(t.id);if(!r){var i=this.panoQualityManager.getNavPanoSize();if(!(r=this.renderTargetPool.get({size:i}))){var o=this.cwfRenderer.initRenderTargetCube(i);(r=this.renderTargetPool.add(o)).extra={},r.extra.size=o.width}r.extra.sweep=t,r.extra.sweepindex=t.index,this.setRenderTargetDescriptorForSweep(t.id,r),this.tileUploadQueue.resetPanoLODDescriptors(t.id),this.resetUploadState(t.id,!0,!0)}return this.updateActiveSweeps(t),r.object},e.prototype.deactivatePano=function(t){var e=this.getRenderTargetDescriptorForSweep(t);e&&this.isRenderTargetDescriptorValid(e)&&(this.renderTargetPool.free(e.object),this.setRenderTargetDescriptorForSweep(t,null),this.updateActiveSweeps(),this.tileUploadQueue.clearAllUploadQueues(t),this.tileUploadQueue.resetPanoLODDescriptors(t),this.clearCachedTileData())},e.prototype.clearCachedTileData=function(){for(var t,e,n=this.sweepLoadHistory.length-1;n>=0;n--){var r=!1,i=this.sweepLoadHistory[n];if(i){try{for(var o=J(this.activeSweeps),a=o.next();!a.done;a=o.next()){if(i===a.value.id){r=!0;break}}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}!r&&this.checkTileTreeInitialized(i)&&(this.clearTileState(i,!0,!0),this.deleteTileTrees(i),this.deleteTileDirectoryEntries(i),this.tileDownloader.deleteAllTileDownloadDescriptors(i),this.sweepLoadHistory[n]=null)}}this.updateSweepLoadHistory()},e.prototype.updateActiveSweeps=function(t){var e,n,r,i=this.persistentStorage.getArray("updateActiveSweeps:tempSweeps");i.length=0;try{for(var o=J(this.activeSweeps),a=o.next();!a.done;a=o.next()){var s=a.value,c=this.getRenderTargetDescriptorForSweep(s.id);t&&s.id===t.id||!this.isRenderTargetDescriptorValid(c)||i.push(s)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}t&&i.unshift(t),this.activeSweeps.length=0,(r=this.activeSweeps).push.apply(r,K(i))},e.prototype.queueUploadForAllTiles=function(t,e){var n,r;void 0===e&&(e=!0),this.zoomRenderTarget&&this.zoomRenderTarget.width===this.panoQualityManager.getZoomPanoSize()||this.zoomSweepRenderingDisabled||this.setupZoomRenderTarget();var i=this.getRenderTargetDescriptorForSweep(t);if(!this.isRenderTargetDescriptorValid(i))throw new Error("queueUploadForAllTiles() -> Cannot render to a pano that is not activated.");for(var o=this.persistentStorage.getArray("queueUploadForAllTiles:nodeList"),a=0;a<g.a;a++){var s=this.getTileTree(t,a);o.length=0,s.breadthFirst({saveVisited:o});try{for(var c=J(o),u=c.next();!u.done;u=c.next()){var l=u.value;this.queueUploadForTile(l.extra.tile,!1,0===l.level&&e)}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}}},e.prototype.onTileDownLoaded=function(t){if(t.sweep){var e=p(g.b,t.panoSize),n=this.getTileDirectoryEntry(t.sweep.id,t.face,e,t.faceTileIndex);this.updateUploadDescriptorFromDownloadDescriptor(n,t),this.updateSweepLoadHistory(n.sweepId);var r=this.getRenderTargetDescriptorForSweep(n.sweepId);if(this.isRenderTargetDescriptorValid(r)){var i=this.getTileTree(n.sweepId,n.face).getSubNode(n.panoSize,n.tileX,n.tileY);i&&(this.linkTileAndNode(n,i),this.queueUploadForTile(n,!0))}}},e.prototype.updateUploadDescriptorFromDownloadDescriptor=function(t,e){t.downloaded=!0,t.image=e.image,t.panoSize=e.panoSize,t.tileX=e.tileX,t.tileY=e.tileY,t.totalTiles=e.totalTiles,t.tileIndex=e.tileIndex,t.faceTileIndex=e.faceTileIndex,t.face=e.face,t.cubeFace=_.a(e.face),e.sweep&&(t.sweepId=e.sweep.id),t.tileSize=e.tileSize,t.direction.copy(e.direction),t.node=null,t.level=p(g.b,t.panoSize)},e.prototype.updateSweepLoadHistory=function(t){var e,n,r,i=this.persistentStorage.getArray("updateSweepLoadHistory:tempHistory");i.length=0;try{for(var o=J(this.sweepLoadHistory),a=o.next();!a.done;a=o.next()){var s=a.value;s&&(!t||t&&t!==s)&&i.push(s)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}this.sweepLoadHistory.length=0,t&&this.sweepLoadHistory.push(t),(r=this.sweepLoadHistory).push.apply(r,K(i))},e.prototype.onPanoRendered=function(t,e,n,r){var i=this.panoLoadResolvers[t],o=this.activeRenderTargetDescriptors[t];o&&o.object&&i(o.object.texture)},e.prototype.getRenderTargetDescriptorForSweep=function(t){return this.activeRenderTargetDescriptors[t]},e.prototype.setRenderTargetDescriptorForSweep=function(t,e){this.activeRenderTargetDescriptors[t]=e},e.prototype.isRenderTargetDescriptorValid=function(t){return!!t&&!!t.object},e.prototype.isSweepZoomed=function(t){return this.zoomingActive&&this.zoomSweepId===t},e.prototype.initTileTree=function(t,e,n){var r=this.tileTrees[t];r||(r=[],this.tileTrees[t]=r);var i=r[e];if(!i){var o=p(g.b,n);i=new f(g.b,o),r[e]=i}},e.prototype.getTileTrees=function(t){var e=this.tileTrees[t];if(!e)throw new Error("TiledPanoRenderer.getTileTrees() -> Tree array not yet initialized!");return e},e.prototype.checkTileTreeInitialized=function(t){return!!this.tileTrees[t]},e.prototype.getTileTree=function(t,e){var n=this.getTileTrees(t)[e];if(!n)throw new Error("TiledPanoRenderer.getTileTree() -> Tree not yet initialized!");return n},e.prototype.deleteTileTrees=function(t){for(var e=this.getTileTrees(t),n=0;n<g.a;n++){var r=e[n];r&&r.deleteAllNodes()}this.tileTrees[t]=null,delete this.tileTrees[t]},e.prototype.clearTileState=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=!1);for(var r=function(t,r,i,o){n&&(r.extra.tile.image=null),e&&(r.extra.tile.uploaded=!1,r.extra.tile.downloaded=!1,r.extra.tile.zoomUploaded=!1,r.extra.tile.uploadAttempted=!1)},i=0;i<g.a;i++){var o=this.getTileTree(t,i);o&&o.breadthFirst({callback:r.bind(this,i),maxLevel:p(g.b,this.panoQualityManager.getZoomPanoSize())})}},e.prototype.resetUploadState=function(t,e,n){for(var r=function(t,r,i,o){r.extra.tile.zoomUploaded=!n&&r.extra.tile.zoomUploaded,r.extra.tile.uploaded=!e&&r.extra.tile.uploaded},i=0;i<g.a;i++){this.getTileTree(t,i).breadthFirst({callback:r.bind(this,i),minLevel:0})}},e.prototype.anyUploaded=function(t){var e,n;if(!t)return!1;if(t.extra.tile&&this.isTileUploaded(t.extra.tile))return!0;if(t.children)try{for(var r=J(t.children),i=r.next();!i.done;i=r.next()){var o=i.value;if(this.anyUploaded(o))return!0}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return!1},e.prototype.linkTileAndNode=function(t,e){e.extra.tile=t,t.node=e},e.prototype.linkAllTilesAndNodes=function(t){for(var e=this,n=function(n,r,i,o,a){var s=e.getTileDirectoryEntry(t.id,r,o,a);e.linkTileAndNode(s,i)},r=0;r<g.a;r++){var i=this.getTileTree(t.id,r);i.breadthFirst({callback:n.bind(this,i,r)})}},e.prototype.getTileDirectoryEntry=function(t,e,n,r){var i=this.tileDirectory[t];i||(i={},this.tileDirectory[t]=i);var o=16384*e+1024*n+r,s=i[o];return s||(s={downloaded:!1,uploaded:!1,uploadAttempted:!1,zoomUploaded:!1,uploadQueued:!1,image:null,panoSize:-1,tileX:-1,tileY:-1,totalTiles:-1,tileIndex:r,faceTileIndex:-1,face:e,cubeFace:-1,sweepId:t,tileSize:-1,direction:new a.Jc,node:null,level:n},i[o]=s),s._tileKey=o,s},e.prototype.deleteTileDirectoryEntries=function(t){this.tileDirectory[t]=null,delete this.tileDirectory[t]},e.prototype.isTileUploaded=function(t){return this.isSweepZoomed(t.sweepId)?t.zoomUploaded:t.uploaded},e.prototype.setUploaded=function(t,e){this.isSweepZoomed(t.sweepId)?t.zoomUploaded=e:t.uploaded=e},e.prototype.queueUploadForTile=function(t,e,n){var r=!t.downloaded||t.uploadQueued&&!n||this.isTileUploaded(t)||t.panoSize>this.panoQualityManager.getNavPanoSize()&&!this.zoomingActive,i=this.getRenderTargetDescriptorForSweep(t.sweepId);!r&&i&&this.isRenderTargetDescriptorValid(i)&&(n?this.uploadTile(t):(0===p(g.b,t.panoSize)?this.tileUploadQueue.addToForceQueue(t):e&&this.currentState.direction?this.tileUploadQueue.insertSortedIntoPanoQueue(t,i.extra.sweep,this.currentState.direction):this.tileUploadQueue.addToPanoQueue(t.sweepId,t),t.uploadQueued=!0))},e.prototype.uploadTile=function(t){var e=this.persistentStorage.get("uploadTile:tempTileTexture",(function(){return{}})),n=this.tileUploadQueue.getPanoLODDescriptor(t.sweepId,t.panoSize),r=this.getRenderTargetDescriptorForSweep(t.sweepId);if(r&&t.image&&this.isRenderTargetDescriptorValid(r)){var o=r.object,s=r.extra.size;if(this.isSweepZoomed(t.sweepId)&&(o=this.zoomRenderTarget,s=this.panoQualityManager.getZoomPanoSize()),this.isTileUploaded(t)||this.anyUploaded(t.node))this.setUploaded(t,!1);else{var c=t.tileX*t.tileSize,u=t.tileY*t.tileSize,l=t.tileSize/t.panoSize*s,h=c/t.panoSize*s,f=u/t.panoSize*s,p=e[t.tileSize];if(e[t.tileSize]||((p=new a.vc).generateMipmaps=!1,p.minFilter=a.Y,p.flipY=!1,this.cwfRenderer.initSizedTexture2D(t.tileSize,p),e[t.tileSize]=p),this.cwfRenderer.uploadTexture2D(t.image,p,0,0),this.cwfRenderer.renderToCubeMap(p,o,t.tileSize,t.tileSize,0,0,t.tileSize,t.tileSize,h,f,l,l,t.cubeFace),i.c.overlayStyle>0){var d=1===i.c.overlayStyle?this.overlayTilesBasic:this.overlayTilesEnhanced;this.cwfRenderer.renderToCubeMap(d[t.panoSize],o,t.tileSize,t.tileSize,0,0,t.tileSize,t.tileSize,h,f,l,l,t.cubeFace,a.xb,!0,.5)}n.uploadCount++,this.setUploaded(t,!0)}t.uploadAttempted||n.uploadAttempts++,t.uploadAttempted=!0,n.uploadAttempts===t.totalTiles&&this.onPanoRendered(t.sweepId,t.panoSize,t.totalTiles)}},e.prototype.updateUploadQueueProcessing=function(){var t=this;if(!this.currentUploadPromise&&(this.overlayTilesLoaded||!this.usingTileOverlay)){var e=new V.a("pano/tiling/upload",(function(){t.processUploadQueue(t.tilingSettings.highResUploadsPerFrame,t.tilingSettings.uploadsPerFrame)}),Q);this.currentUploadPromise=this.engine.commandBinder.issueCommand(e).then((function(e){return q(t,void 0,void 0,(function(){return Y(this,(function(t){switch(t.label){case 0:return[4,e.promise];case 1:return t.sent(),this.currentUploadPromise=null,[2]}}))}))}))}},e.prototype.processUploadQueue=function(t,e){void 0===t&&(t=1);for(var n=0,r=0,i=null;i=this.tileUploadQueue.getNextFromUploadQueue(this.activeSweeps);){var o=this.getRenderTargetDescriptorForSweep(i.sweepId);if(!(i.panoSize>this.panoQualityManager.getNavPanoSize()&&!this.zoomingActive||!this.isRenderTargetDescriptorValid(o))&&(this.uploadTile(i),n+=0!==i.level?1:0,(r+=0===i.level?1:0)>=e||n>=t))break}},e.prototype.loadOverlayTiles=function(){var t=this;if(0!==i.c.overlayStyle){var e=0,r=[],o=function(n,i,o){var s=new a.vc;s.generateMipmaps=!1,s.minFilter=a.Y,s.flipY=!1,i?s=n[i]=t.cwfRenderer.initSizedTexture2D(g.b,s):(t.overlayTileBase=t.cwfRenderer.initSizedTexture2D(g.b,s),s=t.overlayTileBase),t.cwfRenderer.uploadTexture2D(o,s,0,0),++e>=r.length&&(t.overlayTilesLoaded=!0)};switch(i.c.overlayStyle){case 1:r.push([n(536),this.overlayTilesBasic,256]),r.push([n(536),this.overlayTilesBasic,512]),r.push([n(800),this.overlayTilesBasic,1024]),r.push([n(801),this.overlayTilesBasic,2048]),r.push([n(802),this.overlayTilesBasic,4096]);break;case 2:r.push([n(537),this.overlayTilesEnhanced,256]),r.push([n(537),this.overlayTilesEnhanced,512]),r.push([n(803),this.overlayTilesEnhanced,1024]),r.push([n(804),this.overlayTilesEnhanced,2048]),r.push([n(805),this.overlayTilesEnhanced,4096])}r.forEach((function(e){var n=document.createElement("img");n.crossOrigin="anonymous",n.src=e[0],n.onload=function(){o.call(t,e[1],e[2],n)}})),this.usingTileOverlay=!0}else this.usingTileOverlay=!1},e.prototype.copyTargetToZoom=function(t){if(this.zoomingActive){var e=this.getRenderTargetDescriptorForSweep(t);if(!e)throw new Error("Error in copying a null render target to a zoomed target");var n=e.object,r=n.width,i=this.zoomRenderTarget.width;this.cwfRenderer.copyCubeMap(n.texture,this.zoomRenderTarget,r,r,i,i),this.copyBaseRenderStatusToZoomed(t)}},e.prototype.setupZoomRenderTarget=function(){if(this.panoQualityManager.getZoomPanoSize()>=this.panoQualityManager.getNavPanoSize()){if(this.zoomRenderTarget&&this.zoomRenderTarget.width===this.panoQualityManager.getZoomPanoSize())return;var t=this.zoomRenderTarget;if(this.zoomRenderTarget=this.cwfRenderer.initRenderTargetCube(this.panoQualityManager.getZoomPanoSize()),t){var e=t.width,n=this.zoomRenderTarget.width;this.cwfRenderer.copyCubeMap(t.texture,this.zoomRenderTarget,e,e,n,n),t.texture.dispose(),t.texture.version=0,this.cwfRenderer.deallocateCubeTexture(t.texture),t.texture=null}this.zoomSweepRenderingDisabled=!1}else this.zoomSweepRenderingDisabled=!0},e}(b.a),$=n(133),tt=n(2),et=n(92),nt=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},rt=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},it=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},ot=new tt.a("tile-downloader"),at=function(){function t(t,e,n,r){this.urls=t,this.panoQualityManager=e,this.tilePrioritizer=n,this.settings=r,this.persistentStorage=new S.a,this.downloadDescriptors={},this.priorityQueue=[],this.forceQueue=[],this.activeDownloads=[],this.lastPrioritizedTime=Date.now(),this.processPriorityQueue=!0}return t.prototype.init=function(){},t.prototype.render=function(){this.update()},t.prototype.update=function(){var t=this;this.processQueue(this.forceQueue,!1),this.processPriorityQueue&&(!this.processQueuePromise&&this.sweepListMap&&this.activeDownloads.length<this.settings.concurrentDownloads&&Date.now()-this.lastPrioritizedTime>200&&(this.processQueuePromise=this.engine.commandBinder.issueCommand(new V.a("pano/tiling/queue-download",(function(){t.queuePrioritizedTiles(t.sweepListMap),t.lastPrioritizedTime=Date.now()}),100)).then((function(e){return nt(t,void 0,void 0,(function(){return rt(this,(function(t){switch(t.label){case 0:return[4,e.promise];case 1:return t.sent(),this.processQueuePromise=null,[2]}}))}))}))),this.processQueue(this.priorityQueue,!1))},t.prototype.dispose=function(){},t.prototype.activate=function(t){this.engine=t},t.prototype.deactivate=function(t){},t.prototype.setModel=function(t){this.setSweeps(t)},t.prototype.setRestrictedSweeps=function(t){var e,n;if(this.sweepListMap&&this.tilePrioritizer){var r=[];try{for(var i=it(t),o=i.next();!o.done;o=i.next()){var a=o.value;r.push(this.sweepListMap.get(a))}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}this.tilePrioritizer.setUpcomingSweeps(r),this.clearFromAllQueuesBySweep(t)}},t.prototype.clearRestrictedSweeps=function(){this.tilePrioritizer&&this.tilePrioritizer.clearUpcomingSweeps()},t.prototype.setLoadCallbacks=function(t,e){this.onTileDownloaded=t,this.onPanoDownloaded=e},t.prototype.setSweeps=function(t){this.sweepListMap=t},t.prototype.getNonDownloadedTiles=function(t,e,n){var r,i;n.length=0;var o=this.getTileDownloadDescriptors(t,e);try{for(var a=it(o),s=a.next();!s.done;s=a.next()){var c=s.value;!c||c.status!==M.None&&c.status!==M.Queued||n.push(c)}}catch(t){r={error:t}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}},t.prototype.forceQueueTiles=function(t,e,n,r,i,o){var a,s,c,u,l=this.persistentStorage.getArray("forceQueueTiles:remaining"),h=this.persistentStorage.getArray("forceQueueTiles:matching"),f=this.persistentStorage.getArray("forceQueueTiles:toDownload");if(this.getNonDownloadedTiles(t,e,l),f.length=0,l.length>0){k.sortTiles(l,t,n),h.length=0,g.i(t,e,n,h,!0);try{for(var p=it(l),d=p.next();!d.done;d=p.next()){var y=d.value;try{for(var m=it(h),v=m.next();!v.done;v=m.next()){var b=v.value;y.face===b.face&&y.faceTileIndex===b.faceTileIndex&&f.push(y)}}catch(t){c={error:t}}finally{try{v&&!v.done&&(u=m.return)&&u.call(m)}finally{if(c)throw c.error}}}}catch(t){a={error:t}}finally{try{d&&!d.done&&(s=p.return)&&s.call(p)}finally{if(a)throw a.error}}this.forceQueue.push.apply(this.forceQueue,f),this.setStatusForAllDescriptors(this.forceQueue,M.ForceQueued),this.clearFromQueue(this.priorityQueue,M.ForceQueued,!1),r&&this.processQueue(this.forceQueue,!0)}},t.prototype.clearForceQueue=function(){this.clearQueue(this.forceQueue)},t.prototype.queuePrioritizedTiles=function(t){this.tilePrioritizer&&(this.clearQueue(this.priorityQueue),this.tilePrioritizer.filterAndPrioritize(this.priorityQueue,t,this),this.invalidateDuplicateEntries(this.priorityQueue),this.clearFromQueue(this.priorityQueue,M.None,!0),this.setStatusForAllDescriptors(this.priorityQueue,M.Queued),this.lastPrioritizedTime=Date.now())},t.prototype.clearQueue=function(t){this.setStatusForAllDescriptors(t,M.None),t.length=0},t.prototype.clearFromQueue=function(t,e,n){for(var r=0;r<t.length;r++){var i=t[r];i&&(e===i.status&&!n||e!==i.status&&n)&&(t[r]=null)}},t.prototype.clearFromAllQueuesBySweep=function(t){this.clearFromQueueBySweep(this.forceQueue,t),this.clearFromQueueBySweep(this.priorityQueue,t)},t.prototype.clearFromQueueBySweep=function(t,e){for(var n=Object(P.b)(e),r=0;r<t.length;r++){var i=t[r];i&&i.sweep&&(n[i.sweep.id]||(t[r]=null))}},t.prototype.setStatusForAllDescriptors=function(t,e){var n,r;try{for(var i=it(t),o=i.next();!o.done;o=i.next()){var a=o.value;a&&(a.status=e)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype.invalidateDuplicateEntries=function(t){var e,n;try{for(var r=it(t),i=r.next();!i.done;i=r.next()){(a=i.value)&&(a.queuedCount=0)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}for(var o=0;o<t.length;o++){var a;(a=t[o])&&(a.queuedCount++,a.queuedCount>1&&(t[o]=null))}},t.prototype.getTileDownloadDescriptors=function(t,e){var n=this.getAllTileDownloadDescriptors(t.id),r=n[e];return r||(r=this.buildDownloadDescriptorArray(e),n[e]=r,this.initTileDownloadDescriptors(r,t,e)),r},t.prototype.getAllTileDownloadDescriptors=function(t){var e=this.downloadDescriptors[t];return e||(e={},this.downloadDescriptors[t]=e),e},t.prototype.deleteAllTileDownloadDescriptors=function(t){this.downloadDescriptors[t]=null,delete this.downloadDescriptors[t]},t.prototype.processQueue=function(t,e){if(this.cleanupActiveDownloads(),this.activeDownloads.length<this.settings.concurrentDownloads||e)for(var n=e?t.length:this.settings.concurrentDownloads-this.activeDownloads.length,r=0,i=0;r<n&&t.length>0;i++){var o=t.shift();o&&(this.startDownload(o),r++)}},t.prototype.startDownload=function(t){if(!this.urls)throw new Error("Can't call startDownload without signed urls");if(t.sweep){var e=t.status===M.ForceQueued?et.RequestPriority.HIGHEST:et.RequestPriority.MEDIUM;t.status=M.Downloading,this.checkRestrictedSweep(t.sweep.id)||ot.error("Tried to download tile that is not in restricted list!!!!!");var n=this.getTileUrl(t.sweep.id,t.panoSize,t.tileSize,t.tileIndex);this.activeDownloads.push(t),this.urls.getImageBitmap(n,t.tileSize,t.tileSize,{maxRetries:4,priority:e}).then(this.downloadComplete.bind(this,t),this.downloadFailed.bind(this,t))}},t.prototype.checkRestrictedSweep=function(t){var e,n;if(this.tilePrioritizer){var r=this.tilePrioritizer.priorityCriteria.upcomingSweeps;if(r){var i=!1;try{for(var o=it(r),a=o.next();!a.done;a=o.next()){var s=a.value;s&&s.id===t&&(i=!0)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return i}return!0}return!0},t.prototype.downloadFailed=function(t,e){t.status=M.DownloadFailed},t.prototype.downloadComplete=function(t,e){if(t.sweep&&(t.status=M.Downloaded,t.image=e,this.onTileDownloaded&&this.onTileDownloaded(t),this.isPanoDownloaded(t.sweep,t.panoSize))){var n={sweep:t.sweep,tileSize:t.tileSize,panoSize:t.panoSize};this.onPanoDownloaded&&this.onPanoDownloaded(n)}},t.prototype.cleanupActiveDownloads=function(){var t,e,n=this.persistentStorage.getArray("cleanupActiveDownloads:temp");n.length=0;try{for(var r=it(this.activeDownloads),i=r.next();!i.done;i=r.next()){var o=i.value;o.status!==M.Downloaded&&o.status!==M.DownloadFailed&&n.push(o)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}this.activeDownloads.length=0,this.activeDownloads.push.apply(this.activeDownloads,n)},t.prototype.isPanoDownloaded=function(t,e){var n,r,i=this.getTileDownloadDescriptors(t,e);if(!i||i.length<=0)return!1;try{for(var o=it(i),a=o.next();!a.done;a=o.next()){var s=a.value;if(s&&s.status!==M.Downloaded)return!1}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return!0},t.prototype.buildDownloadDescriptorArray=function(t){for(var e=g.e(t),n=[],r=0;r<e;r++){var i=this.buildDownloadDescriptor();n.push(i)}return n},t.prototype.buildDownloadDescriptor=function(){return{sweep:null,panoSize:-1,tileSize:-1,tileIndex:-1,totalTiles:-1,faceTileIndex:-1,status:M.None,url:null,image:null,direction:new a.Jc,face:-1,cubeFace:-1,tileX:-1,tileY:-1,queuedCount:-1}},t.prototype.initTileDownloadDescriptors=function(t,e,n){for(var r=0;r<t.length;r++){var i=t[r];i&&this.initTileDownloadDescriptor(i,e,n,r)}},t.prototype.initTileDownloadDescriptor=function(t,e,n,r){var i=n>=g.b?g.b:n;t.face=g.c(n,r),t.cubeFace=_.a(t.face),t.sweep=e,t.panoSize=n,t.tileSize=i,t.tileIndex=r,t.totalTiles=g.e(n),t.status=M.None,t.image=null,g.f(t.panoSize,t.tileIndex,t),g.g(t.panoSize,t.tileSize,t.cubeFace,t.tileX,t.tileY,$.a.Center,0,t.direction)},t.prototype.getTileUrl=function(t,e,n,r){return this.panoQualityManager.getTileUrl(t,e,n,r)},t}(),st=n(265),ct=n(266),ut=n(96),lt=n(15),ht=n(25),ft=n(176),pt=n(18),dt=n(24),yt=n(26),mt=n(222);n.d(e,"DownloadQueueStyle",(function(){return vt}));var vt,gt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),bt=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},wt=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},_t=new tt.a("sweep-pano-tiling");!function(t){t[t.CurrentView=0]="CurrentView",t[t.FullPanorama=1]="FullPanorama"}(vt||(vt={}));var xt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="sweep-pano-tiling",e.preloadQuality=null,e.preloadResolution=null,e}return gt(e,t),e.prototype.init=function(t,e){return bt(this,void 0,void 0,(function(){var n,r,a,s,c,u,l,h,f=this;return wt(this,(function(p){switch(p.label){case 0:return[4,e.getModule(ut.default)];case 1:return n=p.sent(),[4,e.getModule(ht.default)];case 2:return r=p.sent(),[4,e.market.waitForData(lt.a)];case 3:return a=p.sent(),[4,e.market.waitForData(pt.a)];case 4:return s=p.sent(),c=this,[4,e.market.waitForData(yt.a)];case 5:return c.settingsData=p.sent(),u=r.cwfRenderer,l=r.maxCubemapSize,h=n.getSignedUrls(),this.settings=new i.b,this.qualityManager=new w.b(h,l,t.navPanoSize,t.zoomPanoSize),this.tilePrioritizer=new k(this.qualityManager,this.settings),this.tileDownloader=new at(h,this.qualityManager,this.tilePrioritizer,this.settings),this.panoRenderer=new Z(h,u,this.qualityManager,this.tileDownloader,a,s,this.settings,(function(t){return e.broadcast(t)})),e.addComponent(this,this.tileDownloader),e.addComponent(this,this.panoRenderer),this.bindings.push(e.subscribe(o.a,(function(t){f.panoRenderer.panoQualityManager.setWindowSize(t.width,t.height)})),e.subscribe(st.a,(function(t){f.tileDownloader.setRestrictedSweeps(t.sweepIds)})),e.subscribe(ct.a,(function(t){f.tileDownloader.clearRestrictedSweeps()})),a.onPropertyChanged("transitionActive",(function(){a.transition.to&&f.handlePreloadQualityChange(a.transition.to)})),this.settingsData.onPropertyChanged(i.a,(function(){f.preloadQuality=f.settingsData.tryGetProperty(i.a,null),f.qualityManager.overrideWindowMaximums(null!==f.preloadQuality),a.currentSweep&&f.handlePreloadQualityChange(a.currentSweep)})),e.commandBinder.addBinding(mt.a,(function(t){return bt(f,void 0,void 0,(function(){return wt(this,(function(e){return this.qualityManager.overrideWindowMaximums(t.ignoreWindowSize),[2]}))}))})),e.commandBinder.addBinding(mt.b,(function(t){return bt(f,void 0,void 0,(function(){return wt(this,(function(e){return this.qualityManager.updateNavPanoSize(t.navSize),[2]}))}))}))),[2]}}))}))},e.prototype.getRenderer=function(){return this.panoRenderer},e.prototype.handlePreloadQualityChange=function(t){return bt(this,void 0,void 0,(function(){var e;return wt(this,(function(n){switch(n.label){case 0:return null===this.preloadQuality?[3,2]:[4,this.availableResolution(t,this.preloadQuality)];case 1:return e=n.sent(),this.preloadResolution=w.b.getPanoSize(e),[3,3];case 2:this.preloadResolution=null,n.label=3;case 3:return this.enableHighRes(!1),[2]}}))}))},e.prototype.enableHighRes=function(t,e){void 0===t&&(t=!0);var n=null!==this.preloadResolution?this.preloadResolution:t?this.qualityManager.getZoomPanoSize():this.qualityManager.getNavPanoSize();this.tilePrioritizer.maxResolution!==n&&_t.debug("Setting max resolution: "+n),this.tilePrioritizer.maxResolution=n,this.panoRenderer.highResRenderTarget(t,e)},e.prototype.enableZooming=function(t,e){return bt(this,void 0,Promise,(function(){var n;return wt(this,(function(r){switch(r.label){case 0:return t?(n=w.b.getPanoSizeClass(this.qualityManager.getZoomPanoSize()),[4,this.requestResolution(e,n)]):[3,2];case 1:return[2,r.sent()>=n];case 2:return this.enableHighRes(!1,e),this.resetPano(e),[2,Promise.resolve(!1)]}}))}))},e.prototype.requestResolution=function(t,e,n,r){return void 0===n&&(n=vt.CurrentView),void 0===r&&(r=!1),bt(this,void 0,Promise,(function(){var o;return wt(this,(function(a){switch(a.label){case 0:return this.settings.highResUploadsPerFrame=r?i.c.maxHighResUploadsPerFrame:i.c.highResUploadsPerFrame,this.settings.concurrentDownloads=r?i.c.maxConcurrentDownloads:i.c.concurrentDownloads,this.settings.downloadFullPano=n===vt.FullPanorama,[4,this.availableResolution(t,e)];case 1:return(o=a.sent())>x.d.HIGH&&(this.qualityManager.overrideWindowMaximums(!0),this.panoRenderer.enableUltraHighQualityMode(t)),(this.currentResolution()<o||w.b.getPanoSize(o)>this.qualityManager.getNavPanoSize())&&(this.enableHighRes(!0,t),this.resetPano(t)),[2,o]}}))}))},e.prototype.waitForQueue=function(t,e,n){void 0===n&&(n=1e3);var r=new dt.a,i=function(){s.cancel(),r.notify(1),r.resolve()},o=this.tilePrioritizer.getQualityQueueSize(t,e),a=window.setTimeout((function(){_t.debug("Download queue "+t+" timed out from inactivity after "+n+"ms"),i()}),n),s=this.tilePrioritizer.makeQueueSubscription(t,e,(function(t){if(a&&(window.clearTimeout(a),a=0,o=t),t>0){var e=(o-t)/Math.max(o,1);r.notify(e)}else i()}));return r},e.prototype.revertTilingSettings=function(t){this.enableHighRes(!1,t),this.resetPano(t),this.settings.reset()},e.prototype.availableResolution=function(t,e){return this.qualityManager.availableResolution(t,e)},e.prototype.currentResolution=function(){return this.panoRenderer.getCurrentPanoResolution()},e.prototype.resetPano=function(t){this.panoRenderer.resetRenderStatus(t,!1,!0,this.panoRenderer.panoQualityManager.getNavPanoSize()),this.panoRenderer.clearAllQueuedUploadsForPano(t),this.panoRenderer.renderPanoTiles(t,null,!1,!1)},e}(ft.a);e.default=xt},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(56),a=n(70),s=n(12),c=n(24),u=n(118),l=n(276),h=function(){function t(t){this.lastProgress=0,this.currentProgress=0,this.webpackChunks=[],this.meshAlloc={alloc:2e6,loaded:0},this.showingProgress=!1,this.progressElm=document.getElementById("bar"),window.addEventListener("WebpackChunkProgress",this.onWebpackChunkProgress.bind(this)),this.engine=t,this.meshProgressBinding=this.onMeshLoadProgress.bind(this),this.engine.subscribe(l.a,this.meshProgressBinding)}return t.prototype.showProgress=function(){this.showingProgress=!0,this.setProgress(this.currentProgress)},t.prototype.setDone=function(){this.currentProgress=100,this.setProgress(this.currentProgress),this.engine.unsubscribe(l.a,this.meshProgressBinding)},t.prototype.setProgress=function(t){if(this.progressElm&&!isNaN(t)){this.lastProgress=Math.max(this.lastProgress,t),t=this.lastProgress;var e=Number.parseFloat(this.progressElm.getAttribute("r")||"0"),n=Math.PI*(2*e),r=(100-(t=Math.max(Math.min(t,100),0)))/100*n;this.progressElm.style.strokeDashoffset=r.toString(10)}},t.prototype.calcProgress=function(){var t=0,e=0;this.webpackChunks.forEach((function(n){t+=n.loaded,e+=n.total})),t+=this.meshAlloc.loaded,e+=this.meshAlloc.alloc,this.currentProgress=75*Math.min(t/e,1),this.showingProgress&&this.setProgress(this.currentProgress)},t.prototype.onWebpackChunkProgress=function(t){this.webpackChunks[t.chunkID]?this.webpackChunks[t.chunkID].loaded=t.loaded:this.webpackChunks[t.chunkID]={loaded:t.loaded,total:t.total},this.calcProgress()},t.prototype.onMeshLoadProgress=function(t){this.meshAlloc.loaded=t.loaded/t.total*this.meshAlloc.alloc,this.calcProgress()},t}(),f=n(6),p=n(49),d=n(20),y=n(277),m=n(2),v=n(357),g=n.n(v),b=(n(861),n(372)),w=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),_=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},x=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},S=new m.a("loading-gui"),T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="loading-ui",e.playPromise=new c.a,e.resolvePlayPromise=function(t,n){return _(e,void 0,void 0,(function(){var e,r,i;return x(this,(function(o){if(!this.config.allowPlayInIframe&&this.config.startNewTab)return window.open(self.location.href,"_blank"),[2];if(Object(f.g)())if(n&&(this.config.allowPlayInIframe||1===Object(f.A)("expand",0)))this.engine.commandBinder.issueCommand(new y.a);else if(!this.config.allowPlayInIframe){e=Object(f.s)(),n&&(e.edit="1"),e.back="1",r=Object.keys(e).map((function(t){return t+"="+e[t]})).join("&"),i=""+window.location.origin+window.location.pathname+"?"+r;try{return window.top.location.href=i,[2]}catch(t){S.debug("Couldn't set top window location; was Showcase sandboxed?"),S.debug(t)}}return n&&this.settings.updateSetting("quickstart",!0),t===s.a.WAITING&&(this.playIcon.classList.add("hidden"),this.progressUI.showProgress(),this.playPromise.resolve()),[2]}))}))},e.hideUI=function(t){return _(e,void 0,Promise,(function(){return x(this,(function(e){return t.phase!==s.a.STARTING&&t.phase!==s.a.PLAYING&&t.phase!==s.a.ERROR||(this.progressUI.setDone(),this.config.quickstart?this.showQuickstartUI():this.uiRoot.classList.add("faded-out"),this.engine.unsubscribe(a.a,this.hideUI)),[2]}))}))},e}return w(e,t),e.prototype.init=function(t,e){return _(this,void 0,void 0,(function(){var n,r,i,s=this;return x(this,(function(c){switch(c.label){case 0:return this.engine=e,n=this,[4,e.getModule(u.default)];case 1:return n.locale=c.sent(),r=this,[4,e.getModule(o.default)];case 2:return r.settings=c.sent(),[4,t.modelDetailsStore.read()];case 3:return i=c.sent(),this.config={inWorkshop:!!t.inWorkshop,quickstart:!!t.quickstart,autoplay:!!t.autoplay,allowPlayInIframe:!!t.allowPlayInIframe,startNewTab:!!t.startNewTab,hideTitle:!!t.hideTitle,hideBranding:!!t.hideBranding,sid:t.sid,baseUrl:t.baseUrl},this.progressUI=new h(e),e.subscribe(a.a,this.hideUI),this.bindings.push(e.commandBinder.addBinding(b.a,(function(t){return _(s,void 0,void 0,(function(){return x(this,(function(e){return this.resolvePlayPromise(t.appPhase,!0),[2]}))}))}))),this.renderSplashScreen(i),[2]}}))}))},Object.defineProperty(e.prototype,"waitForPlaying",{get:function(){return this.playPromise.nativePromise()},enumerable:!0,configurable:!0}),e.prototype.getLoadingElements=function(){if(this.uiRoot=document.getElementById("loading-gui"),!this.uiRoot)throw Error("Loading GUI root not found");this.uiRoot.classList.remove("hidden"),this.config.quickstart&&(this.uiRoot.style.pointerEvents="none"),this.presentedBy=document.getElementById("loading-presented-by"),this.poweredBy=document.getElementById("loading-powered-by"),this.mpLogo=document.getElementById("loading-mp-logo"),this.mpLogo.src=g.a,this.nameHeader=document.getElementById("loading-header"),this.background=document.getElementById("loading-background"),this.tint=document.getElementById("tint"),this.playIcon=document.getElementById("showcase-play")},e.prototype.addCobrand=function(t){if(t&&t.presented_by){var e=this.presentedBy.querySelector(".loading-label");e&&(e.textContent=this.locale.t(p.a.PRESENTED_BY_CAPS));var n=this.presentedBy.querySelector(".subheader");n&&(n.textContent=t.presented_by),this.presentedBy.classList.remove("hidden")}},e.prototype.hidePlayButtonUI=function(){this.background.style.backgroundImage="",this.presentedBy.style.transition="none",this.presentedBy.classList.remove("faded-in"),this.poweredBy.style.transition="none",this.poweredBy.classList.remove("faded-in"),this.nameHeader.classList.add("hidden"),this.tint.classList.add("hidden"),document.getElementById("circleLoader").classList.add("hidden"),this.uiRoot.classList.add("quickstart")},e.prototype.showQuickstartUI=function(){return _(this,void 0,Promise,(function(){return x(this,(function(t){switch(t.label){case 0:return this.background.classList.add("faded-out"),[4,Object(d.d)(500)];case 1:return t.sent(),this.presentedBy.style.transition="",this.presentedBy.classList.add("faded-in"),this.poweredBy.style.transition="",this.poweredBy.classList.add("faded-in"),[4,Object(d.d)(2500)];case 2:return t.sent(),this.presentedBy.classList.remove("faded-in"),this.poweredBy.classList.remove("faded-in"),this.uiRoot.classList.add("faded-out"),[2]}}))}))},e.prototype.showLoadingUI=function(t){var e=document.createAttribute("data-status");e.value=this.locale.t(p.a.LOADING);var n=document.getElementById("loader-cont");n.attributes.setNamedItem(e),n.classList.add(this.locale.languageCode),n.classList.add("loading"),t.classList.add("faded-out"),this.presentedBy.classList.add("faded-in")},e.prototype.renderSplashScreen=function(t){var e=this;this.getLoadingElements();var n=document.getElementById("play-prompt");this.config.hideTitle&&this.nameHeader.classList.add("hidden"),this.config.hideBranding||this.addCobrand(t),this.nameHeader.textContent=t.name,this.poweredBy.classList.add("faded-in"),this.tint.classList.add("faded-in"),this.playPromise.then((function(){e.config.quickstart?e.hidePlayButtonUI():e.showLoadingUI(n)})),this.config.autoplay?(this.progressUI.showProgress(),this.playPromise.resolve()):(n.classList.remove("hidden"),n.innerText=this.locale.t(p.a.EXPLORE_3D_SPACE),this.playIcon.classList.remove("hidden"),this.uiRoot.addEventListener("click",(function(){return e.resolvePlayPromise(s.a.WAITING,!1)})));var r=window.devicePixelRatio||1,i=Math.max(window.innerWidth,400);this.background.style.backgroundImage="url("+this.config.baseUrl+"/api/v1/player/models/"+this.config.sid+"/thumb?width="+i+"&dpr="+r+"&disable=upscale)",this.config.allowPlayInIframe||window.scrollTo(0,0)},e}(i.a);e.default=T},function(t,e,n){"use strict";var r,i,o=n(9),a=n(0),s=n(602),c=n.n(s),u=n(603),l=n.n(u),h=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),f=function(t){function e(n,r){var i=a.Bc.clone(e.uniforms);return i.tNoHover.value=n,i.tHover.value=r,i.tPortal.value=null,t.call(this,{vertexShader:c.a,fragmentShader:l.a,uniforms:i,name:"PortalMaterial",transparent:!0})||this}return h(e,t),e.uniforms={tNoHover:{type:"t",value:null},tHover:{type:"t",value:null},tPortal:{type:"t",vlaue:null},progress:{type:"f",value:1},opacity:{type:"f",value:1}},e}(a.cc),p=n(224),d=n(7),y=n(42),m=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();!function(t){t[t.HIDE=0]="HIDE",t[t.SHOW=1]="SHOW",t[t.ONTOP=2]="ONTOP"}(i||(i={}));var v=function(t){function e(n){var r=this,o=new f(p.d,p.c);return(r=t.call(this,e.geometry,o)||this).uniforms=o.uniforms,r.renderOrder=y.a.portals,r.setState(i.HIDE),r.update(n),r}return m(e,t),e.prototype.update=function(t){var e=t.lookDirection.clone().add(t.position);this.position.copy(t.position),this.lookAt(e),this.hoverProgress=0,this.hovered=!1,t.toExterior?(this.uniforms.tNoHover.value=p.b,this.uniforms.tHover.value=p.a):(this.uniforms.tNoHover.value=p.d,this.uniforms.tHover.value=p.c)},e.prototype.resetMesh=function(t,e,n){void 0===t&&(t=0),void 0===e&&(e=!1),void 0===n&&(n=!1),this.uniforms.opacity.value=t,this.material.depthTest=e,this.material.depthWrite=n},e.prototype.setHover=function(t){this.hovered=t},e.prototype.setState=function(t){switch(t){case i.HIDE:this.resetMesh(0,!0,!0);break;case i.SHOW:this.resetMesh(1,!0,!0);break;case i.ONTOP:this.resetMesh(1)}},e.prototype.render=function(t){this.hovered&&this.hoverProgress<1?this.hoverProgress+=t/300:!this.hovered&&this.hoverProgress>0&&(this.hoverProgress-=t/300),this.hoverProgress=Object(d.e)(this.hoverProgress,0,1),this.uniforms.progress.value=this.hoverProgress},e.prototype.updatePortalTexture=function(t){this.uniforms.tPortal.value=t},e.geometry=new a.Jb(.3,.3),e}(a.lb),g=n(351),b=n(8),w=n(29);n.d(e,"a",(function(){return S})),n.d(e,"b",(function(){return T})),n.d(e,"c",(function(){return i}));var _=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),x=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},S=function(t){function e(e){var n=t.call(this)||this;return n.toSweep=e.toSweep,n.toExterior=e.toExterior,n.fromInterior=e.fromInterior,n.meshPosition=e.position,n}return _(e,t),e}(o.a),T=function(){function t(t,e,n){this.container=new a.zb,this.bindings=[],this.visibilityFilter=function(t){return i.HIDE},this.scene=t,this.input=e,this.viewportLoader=n,this.meshes=[],this.activeMeshes={},this.meshToDataMap={},this.dataToMeshMap={},this.activeTexturePromises={},this.meshPool=new g.a}return t.prototype.addPortal=function(t){var e,n=this.meshPool.get();n?(e=n.object).update(t):e=this.meshPool.add(new v(t)).object,this.meshes.push(e),this.container.add(e),this.meshToDataMap[e.id]=t,this.dataToMeshMap[t.index]=e,this.activateMesh(e,this.visibilityFilter(t))},t.prototype.removePortal=function(t){var e=this.dataToMeshMap[t.index];if(e){this.meshPool.free(e);var n=this.meshes.findIndex((function(t){return t.id===e.id}));this.meshes.splice(n,1),this.container.remove(e),this.deactivateMesh(e),delete this.meshToDataMap[e.id],delete this.dataToMeshMap[t.index]}},t.prototype.init=function(){},t.prototype.activate=function(t){var e=this;this.broadcast=t.broadcast.bind(t),this.bindings.push(this.input.registerMeshHandler(b.e,w.a.isType(v),(function(t,n){e.onPuckSelect(n)}))),this.bindings.push(this.input.registerMeshHandler(b.r,w.a.isType(v),(function(t,n){e.onPuckDeselect(n)}))),this.bindings.push(this.input.registerMeshHandler(b.a,w.a.isType(v),(function(t,n){e.onPuckClick(n)}))),this.scene.add(this.container)},t.prototype.dispose=function(){var t,e;try{for(var n=x(Object.keys(this.meshToDataMap)),r=n.next();!r.done;r=n.next()){var i=r.value,o=this.meshToDataMap[i],a=this.dataToMeshMap[o.index];this.removePortal(o),a.material.dispose(),a.geometry.dispose()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},t.prototype.deactivate=function(t){var e,n;try{for(var r=x(this.bindings),i=r.next();!i.done;i=r.next()){i.value.cancel()}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}this.bindings.length=0,this.scene.remove(this.container)},t.prototype.render=function(t){var e,n;try{for(var r=x(this.meshes),i=r.next();!i.done;i=r.next()){i.value.render(t)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.filter=function(t){var e,n;this.visibilityFilter=t;try{for(var r=x(this.meshes),o=r.next();!o.done;o=r.next()){var a=o.value,s=t(this.meshToDataMap[a.id]);s===i.HIDE?this.deactivateMesh(a):this.activateMesh(a,s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.mapSweepToMesh=function(t){for(var e in this.meshToDataMap){var n=this.meshToDataMap[e];if(n.toSweep.id===t&&n.toExterior&&n.fromInterior)return this.dataToMeshMap[n.index]}return null},t.prototype.activateMesh=function(t,e){void 0===e&&(e=0),this.activeMeshes[t.id]||(this.input.registerMesh(t,!1),this.activeMeshes[t.id]=!0),t.setState(e)},t.prototype.deactivateMesh=function(t){this.input.unregisterMesh(t),this.activeMeshes[t.id]=!1,this.onPuckDeselect(t),t.setState(i.HIDE)},t.prototype.onPuckClick=function(t){this.broadcast(new S(this.meshToDataMap[t.id]))},t.prototype.onPuckSelect=function(t){var e=this,n=this.meshToDataMap[t.id].toSweep,r=this.viewportLoader.getPortalTexture(n.id,n.rotation,t.position);this.activeTexturePromises[t.id]=r,r.then((function(n){e.activeTexturePromises.hasOwnProperty(t.id)&&r===e.activeTexturePromises[t.id]&&(t.updatePortalTexture(n),t.setHover(!0))}))},t.prototype.onPuckDeselect=function(t){t.setHover(!1),this.viewportLoader.releasePortalTexture(this.meshToDataMap[t.id].toSweep.id),delete this.activeTexturePromises[t.id]},t}()},function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i})),n.d(e,"d",(function(){return l})),n.d(e,"c",(function(){return p}));var r,i,o=n(182);!function(t){t[t.RESIZE=1]="RESIZE",t[t.ORIENTATION_CHANGED=2]="ORIENTATION_CHANGED"}(r||(r={})),function(t){t[t.PORTRAIT=1]="PORTRAIT",t[t.LANDSCAPE=2]="LANDSCAPE"}(i||(i={}));var a=[],s=[],c={w:window.innerWidth,h:window.innerHeight},u=new o.c((function(){return c}),(function(t){return a.push(t)}),(function(t){a=a.filter((function(e){return e!==t}))})),l=function(){return window.innerWidth>window.innerHeight?i.LANDSCAPE:i.PORTRAIT},h=l(),f=new o.c((function(){return h}),(function(t){return s.push(t)}),(function(t){s=s.filter((function(e){return e!==t}))}));function p(t,e){switch(t){case r.RESIZE:return u.createSubscription(e);case r.ORIENTATION_CHANGED:return f.createSubscription(e)}}var d,y,m=function(){var t=function(){window.clearInterval(d),window.clearTimeout(y)};t();var e=function(){c.w===window.innerWidth&&c.h===window.innerHeight||(c.w=window.innerWidth,c.h=window.innerHeight,function(){if(a.length>0&&a.forEach((function(t){return t(c)})),s.length>0){var t=l();t!==h&&(h=t,s.forEach((function(e){return e(t)})))}}())};d=window.setInterval(e,100),y=window.setTimeout(t,1e3),e()};window.addEventListener("resize",m)},function(t,e,n){"use strict";var r=n(23),i=n(313),o=n(84),a=n(20),s=n(151),c=n(135),u=n(2),l=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},h=new u.a("measure->group"),f=function(t,e,n,r){if(n){var i={floor:t.floor,room:t.room,text:t.text,type:t.type,sid:t.sid,visible:t.visible};e.startGroup(i),e.push(t.start_position),r.groupCount++}var o=e.groupCount-1;e.push(t.end_position),r.idToGroup[t.sid]=o,r.groupToIds[o]||(r.groupToIds[o]=[]),r.groupToIds[o].push(t.sid)},p=n(139);n.d(e,"d",(function(){return v})),n.d(e,"c",(function(){return g})),n.d(e,"b",(function(){return b})),n.d(e,"a",(function(){return w}));var d,y=(d=function(t,e){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}d(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),m=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},v=function(){var t=Object(p.b)([]);return new c.Grouper(t)},g=function(t,e){var n,r;if(e)try{for(var i=m(e),a=i.next();!a.done;a=i.next()){(0,a.value)(t)}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}var s=Object(o.b)();for(var c in t){var u=b(t[c]);s.set(c,u)}return new w(s)},b=function(t){return t?(new i.a).copy(t):new i.a},w=function(t){function e(e){var n,r,i=t.call(this)||this;if(i.name="measure",i.map=Object(o.b)(),i.measurePointGroups={pointGroups:v(),lookup:{idToGroup:{},groupToIds:{},groupCount:0}},e){try{for(var a=m(e),s=a.next();!s.done;s=a.next()){var c=s.value;i.map.set(c.sid,c)}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}i.rebuildGroups()}return i}return y(e,t),e.prototype.rebuildGroups=function(){!function(t,e){var n,r;if(e?(e.pointGroups.reset(),e.lookup.idToGroup={},e.lookup.groupToIds={},e.lookup.groupCount=0):e={pointGroups:v(),lookup:{idToGroup:{},groupToIds:{},groupCount:0}},t.length>0){t.sort((function(t,e){return 100*(t.group+1)+t.groupOrder-(100*(e.group+1)+e.groupOrder)}));try{for(var i=l(t),o=i.next();!o.done;o=i.next()){var a=o.value,s=0===e.pointGroups.groupCount||a.group>=e.pointGroups.groupCount;f(a,e.pointGroups,s,e.lookup)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}u.a.level>=4&&(h.verbose("sorce",t.slice().map((function(t){return t.sid+","+t.group+","+t.groupOrder}))),h.verbose(e.pointGroups.toString()))}}(this.map.values,this.measurePointGroups)},Object.defineProperty(e.prototype,"grouper",{get:function(){return this.measurePointGroups},enumerable:!0,configurable:!0}),e.prototype.get=function(t){return this.map.get(t)},e.prototype.add=function(t){return t.sid=this.validateSid(t.sid),this.map.set(t.sid,t),t},e.prototype.validateSid=function(t){for(var e=t;!e||this.map.has(e);)e=Object(a.m)(11);return e},e.prototype.removeGroup=function(t){var e=this;return this.map.has(t)&&this.map.atomic((function(){var n=e.grouper.lookup.groupToIds[e.grouper.lookup.idToGroup[t]];return n&&n.forEach((function(t){return e.remove(t)})),!0})),!1},e.prototype.remove=function(t){return!!this.map.has(t)&&this.map.delete(t)},e.prototype.clear=function(){var t=this;this.map.atomic((function(){var e,n;try{for(var r=m(t.map.keys),i=r.next();!i.done;i=r.next()){var o=i.value;t.map.delete(o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}))},Object.defineProperty(e.prototype,"length",{get:function(){return this.map.length},enumerable:!0,configurable:!0}),e.prototype.getCollection=function(){return this.map},e.prototype.setVisibility=function(t,e){return!!this.map.has(t)&&(this.map.get(t).visible=e,!0)},e.prototype.rename=function(t,e){return!!this.map.has(t)&&(this.map.get(t).text=e,!0)},e.prototype.iterate=function(t){var e,n;try{for(var r=m(this.map.keys),i=r.next();!i.done;i=r.next()){var o=i.value;t(this.map.get(o),o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},e.prototype.iterateGroups=function(t){var e,n;try{for(var r=m(this.measurePointGroups.pointGroups.groups()),i=r.next();!i.done;i=r.next()){t(i.value)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},e.prototype.isEqual=function(t){var e,n;if(this.map.length!==t.map.length)return!1;try{for(var r=m(this.map),i=r.next();!i.done;i=r.next()){var o=i.value,a=t.map.get(o.sid);if(!a||!this.measurementsAreEqual(o,a))return!1}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return!0},e.prototype.measurementsAreEqual=function(t,e,n){void 0===n&&(n=!1);var r=Object(s.a)(t.end_normal,e.end_normal),i=Object(s.a)(t.start_normal,e.start_normal),o=Object(s.a)(t.start_position,e.start_position),a=Object(s.a)(t.end_position,e.end_position);if(n){if(t.created.toUTCString()!==e.created.toUTCString())return!1;if(t.modified.toUTCString()!==e.modified.toUTCString())return!1}return t.type===e.type&&r&&i&&o&&a&&t.sid===e.sid&&t.text===e.text&&t.visible===e.visible&&t.floor===e.floor&&t.room===e.room&&t.group===e.group&&t.groupOrder===e.groupOrder},e.prototype.copy=function(t){var e,n;this.clear();try{for(var r=m(t.map),i=r.next();!i.done;i=r.next()){var o=i.value,a=b(o);this.map.set(a.sid,a)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return this.rebuildGroups(),this},e.prototype.clone=function(){return(new e).copy(this)},e}(r.a)},function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return s})),n.d(e,"e",(function(){return c})),n.d(e,"d",(function(){return u})),n.d(e,"c",(function(){return l}));var r,i=n(9),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e){var n=t.call(this)||this;return n.sweep=e,n}return o(e,t),e}(i.a),s=function(t){function e(e){var n=t.call(this)||this;return n.sweep=e,n}return o(e,t),e}(i.a),c=function(t){function e(e){var n=t.call(this)||this;return n.sweepId=e,n}return o(e,t),e}(i.a),u=function(t){function e(e,n,r){var i=t.call(this)||this;return i.sweepId=e,i.orientation=n,i.deltaAngle=r,i}return o(e,t),e}(i.a),l=function(t){function e(e){var n=t.call(this)||this;return n.sweepId=e,n}return o(e,t),e}(i.a)},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){"use strict";t.exports=n(486)()?Symbol:n(488)},function(t,e,n){var r=n(722).Buffer,i=n(391).Transform,o=n(394).StringDecoder;function a(t){i.call(this),this.hashMode="string"==typeof t,this.hashMode?this[t]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}n(37)(a,i),a.prototype.update=function(t,e,n){"string"==typeof t&&(t=r.from(t,e));var i=this._update(t);return this.hashMode?this:(n&&(i=this._toString(i,n)),i)},a.prototype.setAutoPadding=function(){},a.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},a.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},a.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},a.prototype._transform=function(t,e,n){var r;try{this.hashMode?this._update(t):this.push(this._update(t))}catch(t){r=t}finally{n(r)}},a.prototype._flush=function(t){var e;try{this.push(this.__final())}catch(t){e=t}t(e)},a.prototype._finalOrDigest=function(t){var e=this.__final()||r.alloc(0);return t&&(e=this._toString(e,t,!0)),e},a.prototype._toString=function(t,e,n){if(this._decoder||(this._decoder=new o(e),this._encoding=e),this._encoding!==e)throw new Error("can't switch encodings");var r=this._decoder.write(t);return n&&(r+=this._decoder.end()),r},t.exports=a},function(t,e,n){"use strict";var r,i=n(158),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n,r,i){var o=t.call(this,e,i)||this;return o.alignmentType=n,o.placementType=r,o}return o(e,t),e}(i.a);e.a=a},function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return s}));var r,i=n(101),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n){var r=t.call(this)||this;return r.position=e,r.buttons=n,r}return o(e,t),e}(i.a),s=function(t){function e(e,n){var r=t.call(this)||this;return r.position=e,r.button=n,r}return o(e,t),e}(i.a)},function(t,e,n){"use strict";var r,i=n(158),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(i.a);e.a=a},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(12),a=n(70),s=n(2),c=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),u=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},l=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},h=new s.a("app-phase"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="app-phase",e}return c(e,t),e.prototype.init=function(t,e){return u(this,void 0,void 0,(function(){return l(this,(function(n){return this.market=e.market,this.broadcast=e.broadcast.bind(e),this.tasks=t.tasks,this.appState=Object(o.d)(),this.appState.phase=o.a.UNINITIALIZED,this.appState.phaseTimes[o.a.UNINITIALIZED]=Date.now(),this.appState.application=o.b.SHOWCASE,this.market.register(this,o.c,this.appState),this.watchTasks(this.appState.phase),this.watchErrors(),[2]}))}))},e.prototype.watchTasks=function(t){return u(this,void 0,void 0,(function(){var e,n;return l(this,(function(r){switch(r.label){case 0:if(t>=o.a.PLAYING)return[2];e=t+1,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Promise.all(this.tasks[e])];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),this.error(n),[3,4];case 4:return this.appState.phase!==o.a.ERROR&&t!==o.a.ERROR&&(this.updateCurrentPhase(e),this.watchTasks(e)),[2]}}))}))},e.prototype.watchErrors=function(){return u(this,void 0,void 0,(function(){var t;return l(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,Promise.all(this.tasks[o.a.ERROR])];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),this.error(t),[3,3];case 3:return[2]}}))}))},e.prototype.updateCurrentPhase=function(t){this.appState.phase=t,this.appState.phaseTimes[t]=Date.now(),h.info(""+JSON.stringify(this.appState)),this.appState.commit(),this.broadcast(new a.a(t))},e.prototype.error=function(t){this.appState.error=t,this.updateCurrentPhase(o.a.ERROR)},e.prototype.updateActiveApp=function(t){this.appState.application=t,this.appState.commit(),this.broadcast(new a.b(t))},e.prototype.getData=function(){return this.appState},e}(i.a);e.default=f},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(100),a=n(212),s=n(559),c=n(64),u=n(24),l=n(560),h=n(20),f=n(561),p=n(201),d=n(44),y=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),m=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},v=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},g=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},b=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return y(e,t),e}(d.a),w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="canvas",e.getNewX=function(){return 0},e.getNewY=function(){return 0},e.getNewWidth=function(t){return t.width},e.getNewHeight=function(t){return t.height},e.activeTransitions=[],e.activeTransitionMap={left:null,top:null,width:null,height:null},e.onResize=function(t){t.propertyName in c.b&&(e.resolveActiveTransition(t.propertyName),e._canvas.style.transitionDuration=e.stringifyTransitionDurations())},e.onWindowResize=function(){e.transitionDurations.left=e.transitionDurations.top=e.transitionDurations.width=e.transitionDurations.height="0s",e._canvas.style.transitionDuration=e.stringifyTransitionDurations(),e.applySize(),e.applyPosition(),e.activeTransitions.forEach(e.resolveActiveTransition.bind(e)),e._canvas.style.transitionDuration=e.stringifyTransitionDurations()},e.resizeCanvas=function(t){return m(e,void 0,void 0,(function(){var e,n=this;return v(this,(function(r){return t.resizeDimensions?(this.activeTransitions.forEach(this.resolveActiveTransition.bind(this)),e=t.resizeDimensions.map((function(t){var e=t.property,r=t.setDimension,i=t.duration;switch(e){case c.b.height:n.setHeight(r,i);break;case c.b.width:n.setWidth(r,i);break;case c.b.top:n.setY(r,i);break;case c.b.left:n.setX(r,i)}var o=new u.a;return n.activeTransitionMap[e]=o,n.activeTransitions.push(e),o})),this.resolveNoopTransitions(),this.hasActiveTransitions()||(this.canvasBounds=this._canvas.getBoundingClientRect()),[2,Promise.all(e)]):[2]}))}))},e}return y(e,t),e.prototype.init=function(t,e){return m(this,void 0,void 0,(function(){var n,r,i,a,s=this;return v(this,(function(u){if(this.engine=e,!t.container)throw new b;this.container=t.container,this.container.appendChild(t.canvas),this.containerBounds=this.container.getBoundingClientRect(),this._canvas=t.canvas,this._canvas.setAttribute("tabindex","-1"),this._canvas.style.position="absolute",this._canvas.style.left="0",this._canvas.style.top="0",this.transitionDurations={left:"0s",top:"0s",width:"0s",height:"0s",filter:"0.4s"},this._canvas.style.transitionProperty=Object.keys(this.transitionDurations).join(","),this._canvas.style.transitionDuration=this.stringifyTransitionDurations(),this.updateTransitions(),this.bindings.push(Object(p.c)(p.b.RESIZE,this.onWindowResize),e.commandBinder.addBinding(c.a,this.resizeCanvas),this.makeTransitionEndSubscription(),e.commandBinder.addBinding(l.a,(function(t){return m(s,void 0,void 0,(function(){return v(this,(function(e){return[2,this.screenToCanvasPoint(t.x,t.y)]}))}))})),e.commandBinder.addBinding(f.a,this.blur.bind(this)));try{for(i=g(this.bindings),a=i.next();!a.done;a=i.next())a.value.renew()}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return this.canvasBounds=this._canvas.getBoundingClientRect(),this.containerBounds=this.container.getBoundingClientRect(),this.data=new o.a(this.canvasBounds.width,this.canvasBounds.height),e.market.register(this,o.a,this.data),[2]}))}))},e.prototype.resolveNoopTransitions=function(){var t=this.containerBounds;this.getNewHeight(t)!==this.data.height&&parseInt(this.transitionDurations[c.b.height],10)||this.resolveActiveTransition(c.b.height),this.getNewWidth(t)!==this.data.width&&parseInt(this.transitionDurations[c.b.width],10)||this.resolveActiveTransition(c.b.width),this.getNewY(t)!==this.data.y&&parseInt(this.transitionDurations[c.b.top],10)||this.resolveActiveTransition(c.b.top),this.getNewX(t)!==this.data.x&&parseInt(this.transitionDurations[c.b.left],10)||this.resolveActiveTransition(c.b.left),this._canvas.style.transitionDuration=this.stringifyTransitionDurations()},e.prototype.makeTransitionEndSubscription=function(){var t=this,e=!1;return{renew:function(){e||(t.element.addEventListener("transitionend",t.onResize),e=!0)},cancel:function(){e&&(t.element.removeEventListener("transitionend",t.onResize),e=!1)}}},e.prototype.dispose=function(e){t.prototype.dispose.call(this,e)},Object.defineProperty(e.prototype,"element",{get:function(){return this._canvas},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.canvasBounds.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.canvasBounds.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this.canvasBounds.left},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.canvasBounds.top},enumerable:!0,configurable:!0}),e.prototype.onUpdate=function(){var t=this.container.getBoundingClientRect(),e=this.containerHasChanged(t);e&&(this.containerBounds=t,this.updateTransitions()),(e||this.hasActiveTransitions())&&(this.canvasBounds=this._canvas.getBoundingClientRect());var n=this.data.width!==this.width||this.data.height!==this.height,r=this.data.x!==this.x||this.data.y!==this.y;n&&(this.data.width=this.width,this.data.height=this.height,this.data.commit(),this.engine.broadcast(new a.a(this.width,this.height))),r&&(this.data.x=this.x,this.data.y=this.y,this.data.commit(),this.engine.broadcast(new s.a(this.x-this.containerBounds.left,this.y-this.containerBounds.top)))},e.prototype.containerHasChanged=function(t){return t.left!==this.containerBounds.left||t.top!==this.containerBounds.top||t.width!==this.containerBounds.width||t.height!==this.containerBounds.height},e.prototype.setX=function(t,e){void 0===e&&(e=0),this.getNewX="number"==typeof t?function(){return t}:t,this.transitionDurations.left=e+"ms",this.updateTransitions()},e.prototype.setY=function(t,e){void 0===e&&(e=0),this.getNewY="number"==typeof t?function(){return t}:t,this.transitionDurations.top=e+"ms",this.updateTransitions()},e.prototype.setWidth=function(t,e){void 0===e&&(e=0),this.getNewWidth="number"==typeof t?function(){return t}:t,this.transitionDurations.width=e+"ms",this.updateTransitions()},e.prototype.setHeight=function(t,e){void 0===e&&(e=0),this.getNewHeight="number"==typeof t?function(){return t}:t,this.transitionDurations.height=e+"ms",this.updateTransitions()},e.prototype.screenToCanvasPoint=function(t,e){return{x:t-this.x,y:e-this.y}},e.prototype.blur=function(t){return m(this,void 0,void 0,(function(){return v(this,(function(e){switch(e.label){case 0:return this.transitionDurations.filter=t.duration+"ms",this._canvas.style.transitionDuration=this.stringifyTransitionDurations(),this._canvas.style.filter="blur("+t.pixelBlur+"px)",[4,Object(h.d)(t.duration)];case 1:return e.sent(),0===t.pixelBlur&&(this._canvas.style.filter=null),[2]}}))}))},e.prototype.updateTransitions=function(){this._canvas.style.transitionDuration=this.stringifyTransitionDurations(),this.applySize(),this.applyPosition()},e.prototype.applySize=function(){this._canvas.style.width=this.getNewWidth(this.containerBounds)+"px",this._canvas.style.height=this.getNewHeight(this.containerBounds)+"px"},e.prototype.applyPosition=function(){this._canvas.style.left=this.getNewX(this.containerBounds)+"px",this._canvas.style.top=this.getNewY(this.containerBounds)+"px"},e.prototype.stringifyTransitionDurations=function(){var t=this;return Object.keys(this.transitionDurations).map((function(e){return t.transitionDurations[e]})).join(",")},e.prototype.resolveActiveTransition=function(t){var e=this.activeTransitions.indexOf(t);-1!==e&&this.activeTransitions.splice(e,1);var n=this.activeTransitionMap[t];n&&n.resolve(),this.activeTransitionMap[t]=null,this.transitionDurations[t]="0s"},e.prototype.hasActiveTransitions=function(){return this.activeTransitions.length>0},e}(i.a);e.default=w},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(9),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n){var r=t.call(this)||this;return r.width=e,r.height=n,r}return o(e,t),e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=function(){function t(t){this._value=t}return t.prototype.value=function(){return this._value},t.prototype.set=function(t){this._value=t},t}(),i=function(){function t(){this.storage={}}return t.prototype.get=function(t,e){var n=this.storage[t];return n||(n=e(),this.storage[t]=n),n},t.prototype.getNumber=function(t){return this.get(t,(function(){return new r(0)}))},t.prototype.getString=function(t){return this.get(t,(function(){return new r("")}))},t.prototype.getArray=function(t){return this.get(t,(function(){return[]}))},t.prototype.getNumberMap=function(t){return this.get(t,(function(){return{}}))},t.prototype.getStringMap=function(t){return this.get(t,(function(){return{}}))},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(9),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n){var r=t.call(this)||this;return r.fromMode=n,r.toMode=e,r.timestamp=Date.now(),r}return o(e,t),e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r="features/360_views"},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(146),a=n(190),s=n(195),c=n(6),u=n(20),l=n(580),h=function(){return(h=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},f=function(t,e){var n,r,i,o;void 0===e&&(e={}),this.context=t,this.options={model_id:Object(s.b)(),start_source:c.A("play",!1)?"autoplay":c.g()?"click":"fullpage",autoplay:c.A("play",!1)||!c.g(),quickstart:1===c.A("qust",0)||1===c.A("qs",0),language_tag:c.A("lang",null),is_mobile:c.n(),iframe:c.g(),aspect_ratio:c.B(),session_id:Object(u.q)(),window:{height:window.innerHeight,width:window.innerWidth},platform:(n=(new l.UAParser).getResult(),r=n.os.name,i=n.browser.name,o=h({},n.device),Object(c.r)()&&(r="iPadOS",o.vendor="Apple",o.model="iPad",o.type="tablet","Safari"===i&&(i="Mobile Safari")),{browser:{name:i,major:n.browser.major,version:n.browser.version,language:navigator.language||"",languages:navigator.languages?navigator.languages.join(", "):""},os:{name:r,version:n.os.version},device:{vendor:o.vendor,model:o.model,type:o.type}})},this.options=Object.assign(this.options,e)},p=n(279),d=n(237),y=n(51),m=function(){this.handlers=[{msgType:d.a,func:function(t,e,n){var r=n.tryGetData(y.a);r&&t.track("interaction_mode_changed",{interaction_mode_prev:e.fromMode,interaction_mode:e.mode,interaction_source:r.source})}}]},v=n(173),g=n(209),b=n(207),w=n(53);!function(t){t.USER="self-guided",t.TOUR="tour"}(r||(r={}));var _,x,S=function(){function t(){var t=this;this.startLoadTime=Date.now(),this.endLoadTime=Date.now(),this.panosViewed=0,this.handlers=[{msgType:g.a,func:function(e,n,r){t.onMoveToSweepBegin(n.timestamp)}},{msgType:b.a,func:function(e,n,i){var o=i.tryGetData(y.a),a=i.tryGetData(w.a);t.endLoadTime=Date.now();var s=t.endLoadTime-t.startLoadTime;e.track("pano_viewed",{pano_id:n.toSweep,pano_view_count:++t.panosViewed,alignment_type:Object(v.c)(n.alignmentType,n.placementType),navigation_source:a&&a.tourPlaying?r.TOUR:r.USER,interaction_source:o?o.source:y.a.defaultSource,interaction_mode:o?o.mode:y.a.defaultMode,load_time:s/1e3})}}]}return t.prototype.onMoveToSweepBegin=function(t){this.startLoadTime=t},t}(),T=n(98),M=function(){this.handlers=[{msgType:T.a,func:function(t,e,n){var r=n.tryGetData(y.a),i={view_mode:e.toMode};r&&(i.interaction_source=r.source,i.interaction_mode=r.mode),t.track("mode_changed",i)}}]},E=n(300),P=n(164),O=n(354),A=function(){this.handlers=[{msgType:P.a,func:function(t,e,n){var r=n.tryGetData(y.a);t.track("floor_changed",{floor_id:e.floorName,interaction_source:r?r.source:y.a.defaultSource,interaction_mode:r?r.mode:y.a.defaultMode})}},{msgType:O.a,func:function(t,e,n){var r=n.tryGetData(y.a);t.track("sweep_floor_fixup",{sweep_index:e.index,sweep_floor_from:e.from,sweep_floor_to:e.to,interaction_source:r?r.source:y.a.defaultSource,interaction_mode:r?r.mode:y.a.defaultMode})}}]},D=n(355),R=n(15),C=function(){function t(){var t=this;this.firstZoom=!0,this.fromZoom=1,this.toZoom=1,this.handlers=[{msgType:D.a,func:function(e,n,r){t.analytics||(t.analytics=e);var i=r.tryGetData(R.a);i&&i.currentSweep!==t.currentPano&&(t.firstZoom=!0,t.currentPano=i.currentSweep,t.fromZoom=1),t.toZoom=n.zoomLevel,clearTimeout(t.sendTimeout),t.sendTimeout=window.setTimeout(t.trackZoomEvent.bind(t),150)}}]}return t.prototype.trackZoomEvent=function(){var t=this.firstZoom?"initial":"followup";this.analytics.track("zoom_"+t,{from:this.fromZoom,to:this.toZoom,pano:this.currentPano}),this.firstZoom=!1,this.fromZoom=this.toZoom},t}(),I=n(70),k=n(12),L=n(23),N=(_=function(t,e){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}_(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),j=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="timing",e.modelLoadingStartTime=0,e.waitingStartTime=0,e.appPlayingTime=0,e.appStartedTime=0,e}return N(e,t),e.prototype.copy=function(t){this.modelLoadingStartTime=t.modelLoadingStartTime,this.waitingStartTime=t.waitingStartTime,this.appPlayingTime=t.appPlayingTime,this.appStartedTime=t.appStartedTime},Object.defineProperty(e.prototype,"totalTimeToAppStarting",{get:function(){var t=this.appStartedTime-performance.timing.navigationStart;return this.modelLoadingStartTime&&this.waitingStartTime&&(t-=this.modelLoadingStartTime-this.waitingStartTime),t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalTimeToAppPlaying",{get:function(){var t=this.appPlayingTime-performance.timing.navigationStart;return this.modelLoadingStartTime&&this.waitingStartTime&&(t-=this.modelLoadingStartTime-this.waitingStartTime),t},enumerable:!0,configurable:!0}),e}(L.a),B=n(2),F=n(96),U=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},z=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},G=new B.a("showcase-session"),H=new j,V=function(){function t(t,e){var n=this;this.analytics=t,this.engine=e,this.handlers=[{msgType:I.a,func:function(t,e,r){return U(n,void 0,void 0,(function(){var n,i,o,a,s,u,l;return z(this,(function(h){switch(h.label){case 0:switch(e.phase){case k.a.WAITING:return[3,1];case k.a.LOADING:return[3,2];case k.a.STARTING:return[3,3];case k.a.PLAYING:return[3,5];case k.a.ERROR:return[3,6]}return[3,8];case 1:return H.waitingStartTime=Date.now(),H.commit(),t.track("impression",{url_params:c.a(),visible:!0}),[3,8];case 2:return H.modelLoadingStartTime=Date.now(),H.commit(),[3,8];case 3:return H.appStartedTime=Date.now(),H.commit(),G.info("First render, model loaded "+H.totalTimeToAppStarting/1e3),[4,this.engine.getModule(F.default)];case 4:return n=h.sent(),t.track("model_loaded",{has_hlr:(f=n.getModel(),f.data&&f.playerOptions&&f.playerOptions.highlightReel),duration:Date.now()-H.modelLoadingStartTime,duration_from_navigation_start:Date.now()-performance.timing.navigationStart}),[3,8];case 5:return H.appPlayingTime=Date.now(),H.commit(),G.info("Playing, session started "+H.totalTimeToAppPlaying/1e3),t.track("session_started"),window.addEventListener("unload",this.sessionEnded),t.track("load_times",{time_to_app_start:H.totalTimeToAppStarting,time_to_app_playing:H.totalTimeToAppPlaying}),[3,8];case 6:return[4,r.waitForData(k.c)];case 7:return i=h.sent(),o=i.error,a=o&&o.name?o.name:o&&o.constructor?o.constructor.name:null,s=o?o.message:null,u=o&&o.stack?o.stack.split("\n"):[],l=u.length>=2?u[1].match(/\s+at\s+([^\s]+)/):null,t.track("error_displayed",{exception:{message:a+": "+s,function:l?l[1]:null,stack:u.slice(1,5).join("\n")},duration:Date.now()-H.modelLoadingStartTime,duration_from_navigation_start:Date.now()-performance.timing.navigationStart}),[3,8];case 8:return[2]}var f}))}))}}],this.sessionEnded=function(){n.analytics.trackAsync("session_ended",{duration:Date.now()-H.appPlayingTime})}}return t.prototype.dispose=function(){window.removeEventListener("unload",this.sessionEnded)},t}(),W=n(421),q=n(26),Y=n(184),J=n(89),X=function(){this.handlers=[{msgType:J.e,func:function(t,e){var n={measure_sid:e.data.sid,start_position:e.data.startPosition,end_position:e.data.endPosition,length:e.data.totalLength,segments:e.data.segments,temporary:e.data.temporary,viewmode:e.data.viewmode,floor:e.data.floor,feature_type:e.data.featureType,constraint_style:e.data.constraint,continuous:e.data.continuous};t.track("measure_segment_add",n)}},{msgType:J.a,func:function(t,e){var n={measure_sid:e.data.sid,length:e.data.totalLength,segments:e.data.segments,temporary:e.data.temporary,viewmode:e.data.viewmode,floor:e.data.floor,feature_type:e.data.featureType,measure_type:e.data.type,constraint_style:e.data.constraint,continuous:e.data.continuous};t.track("measure_add",n)}},{msgType:J.f,func:function(t,e){var n={measure_sid:e.sid,measure_text:e.text};t.track("measure_add_title",n)}},{msgType:J.g,func:function(t,e){var n={measure_sid:e.sid,measure_old_text:e.oldText,measure_new_text:e.newText};t.track("measure_update_title",n)}},{msgType:J.c,func:function(t,e){var n={measure_sid:e.data.sid,length:e.data.totalLength,segments:e.data.segments,temporary:e.data.temporary,viewmode:e.data.viewmode,floor:e.data.floor,measure_count:e.data.count,continuous:e.data.continuous};t.track("measure_remove",n)}},{msgType:J.h,func:function(t,e){var n={measure_sid:e.data.sid,length:e.data.totalLength,segments:e.data.segments,temporary:e.data.temporary,viewmode:e.data.viewmode,floor:e.data.floor,feature_type:e.data.featureType,constraint_style:e.data.constraint,continuous:e.data.continuous};t.track("measure_update",n)}},{msgType:J.d,func:function(t,e){var n=e.opened?"measure_mode_enter":"measure_mode_exit",r={viewmode:e.viewmode,measure_count:e.count};t.track(n,r)}},{msgType:J.b,func:function(t,e){t.track("measure_cancelled",{})}}]},K=n(118),Q=n(9),Z=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),$=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.durationDollhouse=e,o.durationFloorplan=n,o.durationInside=r,o.mainMode=i,o}return Z(e,t),e}(Q.a),tt=function(){this.handlers=[{msgType:$,func:function(t,e){var n={duration_dollhouse:e.durationDollhouse,duration_floorplan:e.durationFloorplan,duration_inside:e.durationInside,duration:e.durationDollhouse+e.durationFloorplan+e.durationInside,main_mode:e.mainMode};t.track("activity_ping",n)}}]},et=n(1),nt=n(31),rt=n(8),it=n(17),ot=n(32),at=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},st=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},ct=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},ut=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(ct(arguments[e]));return t};!function(t){t.UNINITIALIZED="uninitialized",t.INACTIVE="inactive",t.ACTIVE="active"}(x||(x={}));var lt,ht=function(){function t(){this.name="activity-analytics",this._state=x.UNINITIALIZED,this.activeModeMap=new Map}return t.prototype.init=function(t,e){return at(this,void 0,void 0,(function(){var n,r,i,o,a,s,c,u,l=this;return st(this,(function(h){switch(h.label){case 0:return this.engine=t,i=(r=Promise).all,[4,t.getModule(nt.default)];case 1:return o=[h.sent()],[4,t.market.waitForData(it.a)];case 2:return o=o.concat([h.sent()]),[4,t.market.waitForData(k.c)];case 3:return[4,i.apply(r,[o.concat([h.sent()])])];case 4:return n=ct.apply(void 0,[h.sent(),3]),this.input=n[0],this.viewmodeData=n[1],this.applicationData=n[2],a=[],s=[rt.a,rt.d,rt.f,rt.m,rt.l],c=function(){return l.active=!0},u=function(){var t=[];return s.forEach((function(e){t.push(l.input.registerUnfilteredHandler(e,c))})),t},this.applicationData.phase===k.a.PLAYING?this._state=x.INACTIVE:a.push(t.subscribe(I.a,(function(){l.applicationData.phase===k.a.PLAYING&&(l._state=x.INACTIVE)}))),a.push.apply(a,ut(u())),a.push(t.subscribe(T.a,(function(t){var e=t.fromMode,n=t.toMode;e&&e!==et.a.Transition&&l.applicationData.phase===k.a.PLAYING&&l.handleModeChange(e,n)}))),e(a),[2]}}))}))},Object.defineProperty(t.prototype,"active",{get:function(){return this._state===x.ACTIVE},set:function(t){this._state!==x.UNINITIALIZED&&(t&&this._state===x.INACTIVE&&this.startActivityTimeout(),this._state=t?x.ACTIVE:x.INACTIVE)},enumerable:!0,configurable:!0}),t.prototype.handleModeChange=function(t,e){this.activeModeMap.has(e)?this.updateActivityTimeForMode(e,!0):this.activeModeMap.set(e,{previousTime:Date.now(),totalTimeinMS:0}),this.updateActivityTimeForMode(t)},t.prototype.updateActivityTimeForMode=function(t,e){var n=this.activeModeMap.get(t);if(void 0!==n){var r=n.previousTime,i=n.totalTimeinMS;e?this.activeModeMap.set(t,{previousTime:Date.now(),totalTimeinMS:i}):this.activeModeMap.set(t,{previousTime:Date.now(),totalTimeinMS:i+(Date.now()-r)})}},t.prototype.startActivityTimeout=function(){this.activeModeMap.set(et.a.Dollhouse,{previousTime:Date.now(),totalTimeinMS:0}),this.activeModeMap.set(et.a.Floorplan,{previousTime:Date.now(),totalTimeinMS:0}),this.activeModeMap.set(et.a.Panorama,{previousTime:Date.now(),totalTimeinMS:0}),window.setTimeout(this.notifyActivityAnalytic.bind(this),t.ACTIVITY_INTERVAL)},t.prototype.notifyActivityAnalytic=function(){if(this.viewmodeData.currentMode&&this.viewmodeData.currentMode!==et.a.Transition&&this.updateActivityTimeForMode(this.viewmodeData.currentMode),this.active){var t=0,e=et.a.Panorama;this.activeModeMap.forEach((function(n,r){n.totalTimeinMS>t&&(e=r,t=n.totalTimeinMS)})),this.active=!1;var n=ct([this.activeModeMap.get(et.a.Dollhouse),this.activeModeMap.get(et.a.Floorplan),this.activeModeMap.get(et.a.Panorama)].map((function(t){return t?t.totalTimeinMS:0})),3),r=n[0],i=n[1],o=n[2];this.engine.broadcast(new $(r,i,o,ot.d[e]))}},t.ACTIVITY_INTERVAL=15e3,t}(),ft=n(356);!function(t){t.USER="self-guided",t.TOUR="tour"}(lt||(lt={}));var pt=function(){this.handlers=[{msgType:ft.a,func:function(t,e,n){var r=n.tryGetData(y.a),i=n.tryGetData(w.a),o={room_id:e.roomId,room_index:e.roomIndex,room_type:e.roomType,viewmode:e.viewmode?ot.d[e.viewmode]:e.viewmode,room_visit_count:e.visitCount,room_count:e.roomCount,navigation_source:i&&i.tourPlaying?lt.TOUR:lt.USER,interaction_source:r?r.source:y.a.defaultSource,interaction_mode:r?r.mode:y.a.defaultMode};t.track("room_visited",o)}}]},dt=n(92),yt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),mt=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},vt=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},gt=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},bt=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(gt(arguments[e]));return t},wt=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},_t=new B.a("showcase-analytics"),xt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="showcase-analytics",e.loaded=!1,e.handlers=[],e.track=function(t,n){e.analytics.track(t,n)},e}return yt(e,t),e.prototype.init=function(t,e){return mt(this,void 0,void 0,(function(){var n,r,i,s,c,u,l,h,d,y,v,g,b,w,_,x,T,P,O,D,R,I,k,L,N,j,B=this;return vt(this,(function(F){switch(F.label){case 0:return i=this,[4,e.getModule(a.default)];case 1:return i.analytics=F.sent(),[4,e.getModule(o.default)];case 2:return s=F.sent().getApi(),[4,e.market.waitForData(q.a)];case 3:return c=F.sent(),[4,e.getModule(K.default)];case 4:u=F.sent(),l="";try{l=Intl.DateTimeFormat().resolvedOptions().timeZone}catch(t){}return h={app:{name:c.getProperty(Y.a),version:"3.1.10.4-0-ga56ce8cdd"},screen:{width:window.screen.width,height:window.screen.height,density:window.devicePixelRatio},locale:u.languageCode,timezone:l||"",location:{city:null,country:null}},s.getGeoIpLocation().then((function(t){h.location={city:t.city,country:t.country_name}})),this.context=new f(h,t.additionalValues||{}),this.addMessageHandler(new V(this.analytics,e),e),this.addMessageHandler(new M,e),this.addMessageHandler(new S,e),this.addMessageHandler(new m,e),this.addMessageHandler(new A,e),this.addMessageHandler(new E.a,e),this.addMessageHandler(new C,e),this.addMessageHandler(new X,e),this.addMessageHandler(new W.a,e),this.addMessageHandler(new tt,e),this.addMessageHandler(new pt,e),d=function(t){var e;(e=B.bindings).push.apply(e,bt(t))},this.activityTracking=new ht,this.activityTracking.init(e,d),y=c.getProperty(Y.b),void 0===t.provider?[3,5]:(g=t.provider,[3,7]);case 5:return[4,s.getAppKey(y,Y.d)];case 6:g=F.sent(),F.label=7;case 7:if(b=[],w=[],!(v=g))return[3,21];_=v.split(","),F.label=8;case 8:F.trys.push([8,18,19,20]),x=wt(_),T=x.next(),F.label=9;case 9:return T.done?[3,17]:(P=T.value,Object.values(p.a).includes(P)?null===(O=p.b[P]).key?[3,11]:[4,s.getAppKey(y,O.key)]:[3,16]);case 10:return R=F.sent(),[3,12];case 11:R=null,F.label=12;case 12:return D=R,null===O.url?[3,14]:[4,s.getAppKey(y,O.url)];case 13:return k=F.sent(),[3,15];case 14:k=null,F.label=15;case 15:I=k,null===O.key||null!==D&&null===O.url||null!==I?(b.push({provider:P,token:D,url:I}),w.push(D)):_t.warn("Failed to set up "+P+", token/url required but not found in config"),F.label=16;case 16:return T=x.next(),[3,9];case 17:return[3,20];case 18:return L=F.sent(),n={error:L},[3,20];case 19:try{T&&!T.done&&(r=x.return)&&r.call(x)}finally{if(n)throw n.error}return[7];case 20:b.length<1&&b.push({provider:Y.c,token:null,url:null}),F.label=21;case 21:return N=new dt.RequestQueue({retries:0,concurrency:1}),j=s.user,this.analytics.load(b,N,this.context.options,this.context.context,j).then((function(){B.loaded=!0})),[2]}}))}))},e.prototype.addMessageHandler=function(t,e){var n=this;this.handlers.push(t),t.handlers.forEach((function(t,r){n.bindings.push(e.subscribe(t.msgType,(function(r){t.func(n.analytics,r,e.market)})))}))},e.prototype.onUpdate=function(t){this.loaded&&Object(W.b)(this.analytics,t)},e.prototype.dispose=function(e){var n,r;t.prototype.dispose.call(this,e);try{for(var i=wt(this.handlers),o=i.next();!o.done;o=i.next()){var a=o.value;a.dispose&&a.dispose()}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}this.handlers=[]},e.prototype.getSessionId=function(){return this.context.options.session_id},e}(i.a);e.default=xt},function(t,e,n){"use strict";n.r(e);var r,i,o=n(4),a=n(31),s=n(18),c=n(51),u=n(15),l=n(17),h=n(1),f=n(132),p=n(32),d=n(90),y=n(233),m=n(147),v=n(44),g=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),b=function(t){function e(e){var n=t.call(this,e)||this;return n.name="NavigationException",n}return g(e,t),e}(v.a),w="Cannot navigate between panos when not in Panorama mode",_="Not at a valid sweep",x="Cannot move while in a transition",S="Cannot move in that direction",T=n(0),M=n(3),E=n(16),P=n(8),O=n(77),A=n(167),D=n(29),R=n(27),C=n(134),I=n(2),k=n(113),L=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},N=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(L(arguments[e]));return t},j=new I.a("nav-input"),B=function(){function t(e,n,r){var i,o,a,s=this;this.navigation=e,this.inputIni=n,this.insideNav=[],this.insideVrNav=[],this.toggleInput=function(t){s.insideNav.forEach((function(e){return t?e.renew():e.cancel()}))},this.toggleVrInput=function(t){s.insideVrNav.forEach((function(e){return t?e.renew():e.cancel()}))},this.registerInsideClickHandlers=function(t){return[t.registerMeshHandler(P.a,D.a.is(k.c),(function(t,e,n){return s.tryExecuteAction((function(t,e){return z(t)&&F(e)}),(function(t,e){return F(e)&&s.navigation.navigateTowardsIntersection(e)}),t,n)})),t.registerMeshHandler(P.a,D.a.isType(C.a),(function(t,e,n){return s.tryExecuteAction((function(t,e){return z(t)&&F(e)}),(function(t,e){return F(e)&&s.navigation.navigateTowardsIntersection(e)}),t,n)}))]},this.registerVrClickHandlers=function(t){return[t.registerMeshHandler(P.a,D.a.isInstanceOf(A.b),(function(t,e,n){return s.tryExecuteAction((function(t,e){return z(t)&&F(e)}),(function(t,e){return F(e)&&s.navigation.navigateToPanoNearIntersection(e)}),t,n)}))]},this.registerWheelInput=function(t){return[t.registerHandler(P.q,(function(t){return s.tryExecuteAction((function(t){return!0}),(function(t){if(t instanceof P.q){var e=new T.Jc(0,0,Math.sign(t.delta.y));return!!s.navigation.navigateInLocalDirection(e)}return!1}),t)}))]},this.hotkeys=function(e){return[e.registerHandler(P.f,(function(e){return s.tryExecuteAction((function(e){return U(e)&&e.key in t.hotkeyDirections}),(function(e){if(U(e)){var n=t.hotkeyDirections[e.key];return!!s.navigation.navigateInLocalDirection(n)}return!1}),e)}))]},this.tryExecuteAction=function(t,e,n,r){var i=!1;try{s.navigation.isNavigationInputAllowed()&&t(n,r)&&(i=e(n,r))}catch(t){if(!(t instanceof b))throw j.warn(t),t;j.verbose(t)}return i},(i=this.insideVrNav).push.apply(i,N(this.registerVrClickHandlers(this.inputIni))),(o=this.insideNav).push.apply(o,N(this.registerInsideClickHandlers(this.inputIni),this.hotkeys(this.inputIni))),r&&(a=this.insideNav).push.apply(a,N(this.registerWheelInput(this.inputIni)))}return Object.defineProperty(t.prototype,"bindings",{get:function(){return N(this.insideNav,this.insideVrNav)},enumerable:!0,configurable:!0}),t.hotkeyDirections=((i={})[E.a.W]=M.b.FORWARD,i[E.a.A]=M.b.LEFT,i[E.a.S]=M.b.BACK,i[E.a.D]=M.b.RIGHT,i[E.a.UPARROW]=M.b.FORWARD,i[E.a.DOWNARROW]=M.b.BACK,i),t}();function F(t){return void 0!==t&&void 0!==t.point}function U(t){return t instanceof P.f&&t.state===O.a.PRESSED}function z(t){return t instanceof P.a&&t.button===R.a.PRIMARY}var G=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},H=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(G(arguments[e]));return t},V=new I.a("nav-input"),W=function(){function t(t,e,n){var r,i=this;this.navigation=t,this.input=e,this.bindings=[],this.toggleInput=function(t){V.debug("toggling dollhouse input",t),i.bindings.forEach((function(e){return t?e.renew():e.cancel()}))},n||(r=this.bindings).push.apply(r,H(this.registerEnterPanoHandler()))}return t.prototype.registerEnterPanoHandler=function(){var t=this;return[this.input.registerMeshHandler(P.a,D.a.isInstanceOf(A.b),(function(e,n,r){return!!t.navigation.isNavigationInputAllowed()&&(e.button===R.a.PRIMARY&&void 0!==r&&t.navigation.navigateToPanoNearIntersection(r))}))]},t}(),q=n(116),Y=n(72),J=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},X=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},K=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},Q=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(K(arguments[e]));return t},Z=function(){function t(t,e,n,r,i,o,a){var s,c=this;this.canStartTransition=t,this.commandBinder=e,this.input=n,this.floors=r,this.navigation=i,this.navigationDollhouse=o,this.sweepData=a,this.bindings=[],this.lastSelection={floorIndex:-1,point:new T.Jc,time:Date.now()},this.toggleInput=function(t){c.bindings.forEach((function(e){return t?e.renew():e.cancel()}))},(s=this.bindings).push.apply(s,Q(this.registerClickHandlers()))}return t.prototype.setFocusSweep=function(t){return J(this,void 0,void 0,(function(){var e;return X(this,(function(n){switch(n.label){case 0:return(e=Object(y.b)(this.sweepData,!1,t)).length>0&&e[0].sweep?[4,this.commandBinder.issueCommand(new Y.d(e[0].sweep.id))]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},t.prototype.setFocusFloor=function(t,e){return J(this,void 0,void 0,(function(){return X(this,(function(n){switch(n.label){case 0:return[4,this.commandBinder.issueCommand(new q.a(t,!1,void 0,e.point))];case 1:return n.sent(),[2]}}))}))},t.prototype.setFocusPoint=function(t){return J(this,void 0,void 0,(function(){return X(this,(function(e){switch(e.label){case 0:return[4,this.setFocusSweep(t)];case 1:return e.sent(),[4,this.navigationDollhouse.navigateToPoint(t.point)];case 2:return e.sent(),[2]}}))}))},t.prototype.registerClickHandlers=function(){var t,e=this;return[this.input.registerMeshHandler(P.a,D.a.is(k.c),(function(n,r,i){e.canStartTransition()&&e.navigation.isNavigationInputAllowed()&&i&&i.point&&(1!==e.floors.floors.getFloorCount()&&e.lastSelection.floorIndex!==r.floorIndex?(window.clearTimeout(t),e.setFocusFloor(r.floorIndex,i)):Date.now()-e.lastSelection.time<250?(window.clearTimeout(t),e.navigation.navigateToPanoNearIntersection(i)):t=window.setTimeout((function(){e.setFocusPoint(i)}),250),e.lastSelection.point.copy(i.point),e.lastSelection.floorIndex=r.floorIndex,e.lastSelection.time=Date.now())})),this.input.registerMeshHandler(P.a,D.a.isType(C.a),(function(){return J(e,void 0,void 0,(function(){return X(this,(function(t){switch(t.label){case 0:return this.canStartTransition()&&this.navigation.isNavigationInputAllowed()?[4,this.commandBinder.issueCommand(new q.a(-1,!1))]:[2];case 1:return t.sent(),this.setFocusSweep({point:this.lastSelection.point}),[2]}}))}))}))]},t}(),$=n(183),tt=n(7),et=n(28),nt=n(10),rt=function(t,e,n){var r=this;this.canStartTransition=t,this.pose=e,this.cameraModule=n,this.navigateToPoint=function(t){if(r.canStartTransition()){var e=r.pose.focalDistance,n=Object(et.k)(r.pose.rotation,t,e);return r.cameraModule.moveTo({pose:{position:n},transitionType:nt.a.Interpolate,focalDistance:e,transitionTime:m.a.TRANSITION_TIME_DH})}},this.navigateToBox=function(t){if(r.canStartTransition()){var e=r.getPoseForBox(t),n=e.position,i=e.rotation,o=e.focalDistance;return r.cameraModule.moveTo({pose:{position:n,rotation:i},transitionType:nt.a.Interpolate,focalDistance:o,transitionTime:m.a.TRANSITION_TIME_DH})}},this.getPoseForBox=function(t){var e=t.getCenter(new T.Jc),n=t.getSize(new T.Jc),i=n.z>n.x,o=r.pose.rotation;o=i?o.angleTo(it.LANDSCAPE_LEFT)>o.angleTo(it.LANDSCAPE_RIGHT)?it.LANDSCAPE_LEFT:it.LANDSCAPE_RIGHT:o.angleTo(it.PORTRAIT_RIGHT)>o.angleTo(it.PORTRAIT_LEFT)?it.PORTRAIT_LEFT:it.PORTRAIT_RIGHT;var a=-85*tt.b,s=2*Math.atan(1/r.pose.projection.elements[5]),c=Object(et.f)(e,o,a,t,1.2*s,r.pose.aspect()),u=e.distanceTo(c.position);return{position:c.position,rotation:c.rotation,focalDistance:u}}},it={LANDSCAPE_LEFT:(new T.Pb).setFromAxisAngle(M.b.UP,45*tt.b),LANDSCAPE_RIGHT:(new T.Pb).setFromAxisAngle(M.b.UP,-45*tt.b),PORTRAIT_LEFT:(new T.Pb).setFromAxisAngle(M.b.UP,25*tt.b),PORTRAIT_RIGHT:(new T.Pb).setFromAxisAngle(M.b.UP,-25*tt.b)},ot=n(60),at=n(35),st=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ct=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},ut=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},lt=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},ht=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(lt(arguments[e]));return t},ft=new I.a("navigation"),pt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="navigation",e.navigationEnabled=!0,e.inputOutside=[],e.navigationRules=[function(){return!0}],e.addNavigationRule=function(t){-1===e.navigationRules.indexOf(t)&&e.navigationRules.push(t)},e.removeNavigationRule=function(t){var n=e.navigationRules.indexOf(t);-1!==n&&e.navigationRules.splice(n,1)},e.isNavigationInputAllowed=function(){var t=e.navigationRules.reduce((function(t,e){return t&&e()}),!0);return!(!e.navigationEnabled||!t)||(ft.debug("Cannot move while navigation is locked",{blockedByRules:!t,blockedByCommand:!e.navigationEnabled}),!1)},e}return st(e,t),e.prototype.init=function(t,e){return ct(this,void 0,void 0,(function(){var r,i,o,f,p,d,y,v,g,b,w=this;return ut(this,(function(_){switch(_.label){case 0:return this.commandBinder=e.commandBinder,this.bindings.push(this.commandBinder.addBinding($.a,(function(){return ct(w,void 0,void 0,(function(){return ut(this,(function(t){return[2,this.lockNavigation()]}))}))})),this.commandBinder.addBinding($.b,(function(){return ct(w,void 0,void 0,(function(){return ut(this,(function(t){return[2,this.unlockNavigation()]}))}))}))),i=this,[4,e.market.waitForData(u.a)];case 1:return i.sweepData=_.sent(),o=this,[4,e.market.waitForData(l.a)];case 2:return o.viewmodeData=_.sent(),f=this,[4,e.market.waitForData(s.a)];case 3:return f.cameraData=_.sent(),p=this,[4,e.market.waitForData(c.a)];case 4:return p.interactionmodeData=_.sent(),[4,e.getModule(a.default)];case 5:return d=_.sent(),this.inputOutside.push(new W(this,d,!!t.focusBasedNav)),t.focusBasedNav?[4,e.market.waitForData(at.b)]:[3,8];case 6:return y=_.sent(),[4,e.getModule(ot.default)];case 7:v=_.sent(),b=new rt(g=function(){return w.viewmodeData.isDollhouse()&&w.cameraData.canTransition()&&w.viewmodeData.canStartTransition()},this.cameraData.pose,v),this.inputOutside.push(new Z(g,e.commandBinder,d,y,this,b,this.sweepData)),_.label=8;case 8:return this.inputInside=new B(this,d,!!t.enableWheel),this.inputOutside.forEach((function(t){var e;return(e=w.bindings).push.apply(e,ht(t.bindings))})),(r=this.bindings).push.apply(r,ht(this.inputInside.bindings)),this.updateInputBindings(),this.bindings.push(this.viewmodeData.makeModeChangeSubscription((function(){w.viewmodeData.currentMode!==h.a.Transition&&w.updateInputBindings()}))),m.a.debugMenu&&n.e(4).then(n.bind(null,1523)).then((function(t){new t.NavigationVisuals(e)})),[2]}}))}))},e.prototype.updateInputBindings=function(){var t=this.interactionmodeData.isVR(),e=this.viewmodeData.isPano();this.inputInside.toggleInput(e&&!t),this.inputInside.toggleVrInput(e&&t),this.inputOutside.forEach((function(t){return t.toggleInput(!e)}))},e.prototype.navigateInLocalDirection=function(t){var e=this.cameraData.pose.rotation;return this.navigateInDirection(t.clone().applyQuaternion(e))},e.prototype.navigateTowardsIntersection=function(t){return!!this.navigateInDirection(t.point.clone().sub(this.cameraData.pose.position))},e.prototype.navigateToPanoNearIntersection=function(t){if(!this.cameraData.canTransition())return!1;var e=Object(y.b)(this.sweepData,this.viewmodeData.isPano(),t),n=e.length>0?e[0].sweep:this.sweepData.getClosestSweep(t.point,!0),r=f.b[this.interactionmodeData.mode];if(this.viewmodeData.isPano()&&n)return this.commandBinder.issueCommand(new d.a({transition:r,sweep:n.id})),!0;if(this.viewmodeData.canSwitchViewMode(h.a.Panorama)){var i=n?n.id:void 0;return this.commandBinder.issueCommand(new p.a(p.b.INSIDE,r,{sweepID:i})),!0}return!1},e.prototype.navigateInDirection=function(t){if(!this.viewmodeData.isPano())throw new b(w);if(!this.sweepData.currentSweep)throw new b(_);if(!this.sweepData.canTransition()||!this.cameraData.canTransition())throw new b(x);var e=f.b[this.interactionmodeData.mode],n=Object(y.a)(this.sweepData,t);if(n.length>0&&n[0].sweep)return this.commandBinder.issueCommand(new d.a({transition:e,sweep:n[0].sweep.id}));throw new b(S)},e.prototype.lockNavigation=function(){this.navigationEnabled=!1,ft.debug("Navigation input locked")},e.prototype.unlockNavigation=function(){this.navigationEnabled=!0,ft.debug("Navigation input unlocked")},e}(o.a);e.default=pt},function(t,e,n){"use strict";n.r(e);var r,i,o=n(4),a=n(231);!function(t){t.POSTMESSAGE="postmesesage",t.DIRECT="direct"}(r||(r={})),function(t){t.ACTION="postmessage.action",t.EVENT_SUB="postmessage.subscribe",t.EVENT_UNSUB="postmessage.unsubscribe",t.OBSERVABLE_SUB="postmessage.observe",t.OBSERVABLE_UNSUB="postmessage.unobserve",t.COLLECTION_SUB="collection.sub",t.COLLECTION_UNSUB="collection.unsub",t.CUSTOM="message.custom"}(i||(i={}));var s,c,u=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=function(){return(l=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};!function(t){t.CONNECT="postmessage.connect",t.HANDSHAKE="postmessage.handshake",t.ACCEPT="postmessage.accept",t.REJECT="postmessage.reject",t.ACTION="postmessage.action",t.RESPONSE="postmessage.response",t.EVENT="postmessage.event",t.EVENT_SUB="postmessage.subscribe",t.EVENT_UNSUB="postmessage.unsubscribe",t.OBSERVABLE_SUB="postmessage.observe",t.OBSERVABLE_UNSUB="postmessage.unobserve",t.OBSERVABLE_UPDATE="postmessage.observation"}(c||(c={}));var h,f=function(t){function e(e,n,r){var i=t.call(this)||this;return i.id=n,i.clientId=r,i.clientWindow=null,i.clientOrigin=null,i.hostWindow=e,i.messageHandler=function(t){i.onPostmessageReceived(t)},i.bindEvents(),i}return u(e,t),e.prototype.send=function(t){this.clientWindow&&this.clientOrigin&&this.clientWindow.postMessage(l({payload:t},t,{fromId:this.id}),this.clientOrigin)},e.prototype.setTarget=function(t,e){this.clientWindow=t,this.clientOrigin=e},e.prototype.clearTarget=function(){this.clientWindow=null,this.clientOrigin=null},e.prototype.bindEvents=function(){this.hostWindow.addEventListener("message",this.messageHandler)},e.prototype.dispose=function(){this.hostWindow.removeEventListener("message",this.messageHandler)},e.prototype.onPostmessageReceived=function(t){var e=t.origin,n=t.source;if(n){switch(t.data.type){case c.CONNECT:break;case c.ACTION:case c.EVENT_SUB:case c.EVENT_UNSUB:case c.OBSERVABLE_SUB:case c.OBSERVABLE_UNSUB:case i.COLLECTION_SUB:case i.COLLECTION_UNSUB:case i.CUSTOM:if(!this.validateMessageOrigin(t.data.fromId,e,n))return;break;default:return}if(t.data.payload)this.emit(t.data.type,l({},t.data.payload,{type:t.data.type,fromId:t.data.fromId,source:n,origin:e,method:r.POSTMESSAGE}));else{var o=l({},t.data,{source:n,origin:e,timestamp:Date.now(),method:r.POSTMESSAGE});this.emit(t.data.type,o)}}},e.prototype.validateMessageOrigin=function(t,e,n){return-1===this.clientId&&"*"===this.clientOrigin||this.clientId===t&&this.clientWindow===n&&this.clientOrigin===e},e}(a.EventEmitter);!function(t){t.CONNECTION="sdk.connection",t.MESSAGED="sdk.messaged",t.SUBSCRIBED="sdk.subscribed",t.UNSUBSCRIBED="sdk.unsubscribed",t.OBSERVABLE_SUB="sdk.obs.subscribe",t.OBSERVABLE_UNSUB="sdk.obs.unsubscribe",t.COLLECTION_SUB="sdk.coll.subscribe",t.COLLECTION_UNSUB="sdk.coll.unsubscribe",t.CUSTOM_MSG="sdk.custom.message"}(h||(h={}));var p,d,y=n(2);!function(t){t.EVENT="postmessage.event",t.RESPONSE="postmessage.response",t.OBSERVATION="postmessage.observation",t.COLLECTION_UPDATE="collection.updated",t.CUSTOM_RES="custom.respose"}(p||(p={})),function(t){t.ADD="collection.add",t.REMOVE="collection.remove",t.UPDATE="collection.update"}(d||(d={}));var m=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),v=function(){return(v=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},g=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},b=new y.a("SdkHost"),w=function(t){function e(e){var n=t.call(this)||this;return n.hostWindow=e,n.id=Math.floor(1e5*Math.random()),n.clients={},n.connectionHandler=new f(e,n.id,-1),n.bindEvents(e),n}return m(e,t),e.prototype.broadcastEventToClient=function(t,e,n){var r=this.clients[t];if(r){var i={type:c.EVENT,eventType:e,eventData:n,toId:t};r.messenger.send(i)}},e.prototype.broadcastObservationToClient=function(t,e,n){var r=this.clients[t];if(r){var i={type:c.OBSERVABLE_UPDATE,observableKey:e,observableData:n,toId:t};r.messenger.send(i)}},e.prototype.broadcastCollectionItemAdded=function(t,e,n,r){var i=this.clients[t];if(i){var o={type:p.COLLECTION_UPDATE,operation:d.ADD,collectionKey:e,collectionIndex:n,item:r,toId:t};i.messenger.send(o)}},e.prototype.broadcastCollectionItemRemoved=function(t,e,n){var r=this.clients[t];if(r){var i={type:p.COLLECTION_UPDATE,operation:d.REMOVE,collectionKey:e,collectionIndex:n,toId:t};r.messenger.send(i)}},e.prototype.broadcastCollectionItemUpdated=function(t,e,n,r){var i=this.clients[t];if(i){var o={type:p.COLLECTION_UPDATE,operation:d.UPDATE,collectionKey:e,collectionIndex:n,item:r,toId:t};i.messenger.send(o)}},e.prototype.broadcastEvent=function(t,e,n){var r,i;void 0===n&&(n=!0);try{for(var o=g(Object.keys(this.clients)),a=o.next();!a.done;a=o.next()){var s=a.value;(n||this.clients[parseInt(s,10)].subscriptions[t])&&this.broadcastEventToClient(parseInt(s,10),t,e)}}catch(t){r={error:t}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}},e.prototype.bindEvents=function(t){var e=this;this.connectionHandler.on(c.CONNECT,(function(n){var r=new f(t,e.id,n.fromId);e.onConnectionReceived(r,n)}))},e.prototype.onConnectionReceived=function(t,e){var n=this,o=v({},e,{handshake:function(){var r=n.clients[o.fromId];if(r&&r.connected)b.info("client already connected: "+o.fromId);else{n.clients[o.fromId]={key:e.applicationKey,origin:e.origin,messenger:t,subscriptions:{},connected:!1};var i={type:c.HANDSHAKE,toId:o.fromId};b.info("handshake "+o.fromId),t.send(i)}},accept:function(e,r,a){var s=n.clients[o.fromId];if(s&&s.connected)b.info("client already connected: "+o.fromId);else{var u={type:c.ACCEPT,toId:o.fromId,targetId:n.id,targetOrigin:n.hostWindow.location.protocol+"//"+n.hostWindow.location.host,warning:a,scriptUrl:e,interface:r};b.info("accept "+o.fromId),t.send(u),s.connected=!0,t.on(c.ACTION,(function(t){return n.onMessageReceived(s,t)})),t.on(c.EVENT_SUB,(function(t){return n.onEventSubscribe(s,t)})),t.on(c.EVENT_UNSUB,(function(t){return n.onEventUnsubscribe(s,t)})),t.on(c.OBSERVABLE_SUB,(function(t){return n.onObservableSubscribe(s,t)})),t.on(c.OBSERVABLE_UNSUB,(function(t){return n.onObservableUnsubscribe(s,t)})),t.on(i.COLLECTION_SUB,(function(t){return n.onCollectionSubscribe(s,t)})),t.on(i.COLLECTION_UNSUB,(function(t){return n.onCollectionUnsubscribe(s,t)})),t.on(i.CUSTOM,(function(t){return n.onCustomMessageReceived(s,t)}))}},reject:function(e){var r={type:c.REJECT,toId:o.fromId,reason:e};t.send(r),t.clearTarget(),t.dispose(),delete n.clients[o.fromId]},requestedVersion:e.requestedVersion,method:r.POSTMESSAGE});t.setTarget(o.source,o.origin),this.emit(h.CONNECTION,o)},e.prototype.onMessageReceived=function(t,e){var n={toId:e.fromId,uid:e.uid,message:null,success:!0,type:c.RESPONSE,timestamp:Date.now()};function r(e){n.message=e,t.messenger.send(n)}var i=v({},e,{applicationKey:t.key,origin:t.origin,onSuccess:function(t){r(t)},onFail:function(t){n.success=!1,n.error=t,r(t)}});this.emit(h.MESSAGED,i)},e.prototype.onEventSubscribe=function(t,e){t.subscriptions[e.subscription]=!0,this.emitSdkEvent(h.SUBSCRIBED,t,e)},e.prototype.onEventUnsubscribe=function(t,e){t.subscriptions[e.subscription]=!1,this.emitSdkEvent(h.UNSUBSCRIBED,t,e)},e.prototype.onObservableSubscribe=function(t,e){this.emitSdkEvent(h.OBSERVABLE_SUB,t,e)},e.prototype.onObservableUnsubscribe=function(t,e){this.emitSdkEvent(h.OBSERVABLE_UNSUB,t,e)},e.prototype.onCollectionSubscribe=function(t,e){this.emitSdkEvent(h.COLLECTION_SUB,t,e)},e.prototype.onCollectionUnsubscribe=function(t,e){this.emitSdkEvent(h.COLLECTION_UNSUB,t,e)},e.prototype.onCustomMessageReceived=function(t,e){var n={toId:e.fromId,uid:e.uid,type:p.CUSTOM_RES,success:!0,responseData:""};function r(e){n.responseData=e,t.messenger.send(n)}var i=v({},e,{applicationKey:t.key,onSuccess:function(t){r(t)},onFail:function(t){n.success=!1,r(t)}});this.emit(h.CUSTOM_MSG,i)},e.prototype.emitSdkEvent=function(t,e,n){this.emit(t,v({},n,{applicationKey:e.key,origin:e.origin}))},e}(a.EventEmitter),_=function(){function t(t){this.messageReceiver=t}return t.prototype.notify=function(t){this.messageReceiver.onMessageReceived(t)},t}(),x=n(273),S=function(){return(S=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},T=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},M=function(){function t(t,e,n){this.sourceId=t,this.targetId=e,this.messageBridge=n,this.observers=new x.a}return t.prototype.init=function(){var t=new(function(){function t(t){this.messenger=t}return t.prototype.onMessageReceived=function(t){this.messenger.onMessageReceived(t)},t}())(this),e=new _(t);this.messageBridge.listen(e)},t.prototype.dispose=function(){this.messageBridge.stopListening()},t.prototype.addObserver=function(t){this.observers.add(t.messageType,t)},t.prototype.removeObserver=function(t){this.observers.remove(t.messageType,t)},t.prototype.send=function(t){var e=this.sourceId,n=this.targetId;this.messageBridge.send(S({},t,{fromId:e,toId:n,timestamp:Date.now()}))},t.prototype.onMessageReceived=function(t){var e,n;if(this.filterMessageId(t)){var r=t.type,i=this.observers.getValuesAtKey(r);if(i)try{for(var o=T(i),a=o.next();!a.done;a=o.next()){a.value.notify(t.payload,t.timestamp)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}}},t.prototype.filterMessageId=function(t){var e=t.toId,n=t.fromId;return e instanceof Array?e.indexOf(this.sourceId)>-1:e===this.sourceId&&n===this.targetId},t}(),E=n(558),P=function(){return(P=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},O=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},A=function(){function t(){this.observers=[]}return t.prototype.addObserver=function(t){this.observers.push(t)},t.prototype.removeObserver=function(t){var e=this.observers.indexOf(t);e>-1&&this.observers.splice(e,1)},t.prototype.post=function(t){var e,n;try{for(var r=O(this.observers),i=r.next();!i.done;i=r.next()){i.value.notify(t)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t}(),D=function(){function t(t,e){this.source=t,this.target=e,this.messageObserver=null}return t.prototype.listen=function(t){this.messageObserver||(this.messageObserver=t,this.source.addObserver(t))},t.prototype.stopListening=function(){this.messageObserver&&this.source.removeObserver(this.messageObserver)},t.prototype.send=function(t){var e=this.target;e&&e.post(P({},t))},t}(),R=function(){function t(t,e,n){this.hostId=t,this.host=e,this.onCreationObserver=n}return t.prototype.createMessenger=function(){var t=Object(E.a)(),e=new A,n=new M(t,this.hostId,new D(e,this.host));return this.onCreationObserver.notify(t,e,n),n},t}(),C=function(){function t(t,e,n){this.observer=t,this.applicationKey=e,this.origin=n}return t.prototype.notify=function(t,e,n){this.observer.onConnectionReceived(this.applicationKey,this.origin,{id:t,node:e,messenger:n})},t}(),I=function(){function t(t,e){this.receiver=t,this.clientId=e,this.messageType=i.ACTION}return t.prototype.notify=function(t){this.receiver.receiveAction(t,this.clientId)},t}(),k=function(){function t(t,e){this.observer=t,this.clientId=e,this.messageType=i.CUSTOM}return t.prototype.notify=function(t){this.observer.receiveCustomMessage(t,this.clientId)},t}(),L=function(){function t(t,e){this.observer=t,this.clientId=e,this.messageType=i.EVENT_SUB}return t.prototype.notify=function(t){this.observer.receiveEventSub(t,this.clientId)},t}(),N=function(){function t(t,e){this.observer=t,this.clientId=e,this.messageType=i.EVENT_UNSUB}return t.prototype.notify=function(t){this.observer.receiveEventUnsub(t,this.clientId)},t}(),j=function(){function t(t,e){this.observer=t,this.clientId=e,this.messageType=i.OBSERVABLE_SUB}return t.prototype.notify=function(t){this.observer.receiveObservableSub(t,this.clientId)},t}(),B=function(){function t(t,e){this.observer=t,this.clientId=e,this.messageType=i.OBSERVABLE_UNSUB}return t.prototype.notify=function(t){this.observer.receiveObservableUnsub(t,this.clientId)},t}(),F=function(){function t(t,e){this.observer=t,this.clientId=e,this.messageType=i.COLLECTION_SUB}return t.prototype.notify=function(t){this.observer.receiveCollectionSub(t,this.clientId)},t}(),U=function(){function t(t,e){this.observer=t,this.clientId=e,this.messageType=i.COLLECTION_UNSUB}return t.prototype.notify=function(t){this.observer.receiveCollectionUnsub(t,this.clientId)},t}(),z=function(t,e,n,r){this.type=p.RESPONSE,this.payload={uid:t,message:e,success:n,error:r}},G=function(t,e){this.type=p.EVENT,this.payload={eventType:t,eventData:e}},H=function(t,e){this.type=p.OBSERVATION,this.payload={observableKey:t,observableData:e}},V=function(t,e,n,r){this.type=p.COLLECTION_UPDATE,this.payload={operation:t,collectionKey:e,collectionIndex:n,item:r}},W=function(t,e,n){this.type=p.CUSTOM_RES,this.payload={uid:t,success:e,responseData:n}},q=function(){return(q=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},Y=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},J=function(){function t(){this.hostId=Math.floor(1e6*Math.random()),this.host=new A,this.clientConnections={},this.clientEventSubscriptions=new x.a,this.clientObservableSubscriptions=new x.a,this.clientCollectionSubscriptions=new x.a,this.facade=new t.DirectMessageHostFacade(this)}return t.prototype.createFactory=function(t,e){var n=new C(this.facade,t,e);return new R(this.hostId,this.host,n)},t.prototype.broadcastEvent=function(t,e,n){var r,i;void 0===n&&(n=!0);var o=this.clientEventSubscriptions.getValuesAtKey(t);if(o||n)try{for(var a=Y(o),s=a.next();!s.done;s=a.next()){var c=s.value;this.clientConnections[c].hostToClient.send(new G(t,e||[]))}}catch(t){r={error:t}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}},t.prototype.broadcastObservationToClient=function(t,e){var n,r,i=this.clientObservableSubscriptions.getValuesAtKey(t);if(i)try{for(var o=Y(i),a=o.next();!a.done;a=o.next()){var s=a.value;this.clientConnections[s].hostToClient.send(new H(t,e))}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},t.prototype.broadcastCollectionItemAdded=function(t,e,n){var r,i,o=this.clientCollectionSubscriptions.getValuesAtKey(t);if(o)try{for(var a=Y(o),s=a.next();!s.done;s=a.next()){var c=s.value;this.clientConnections[c].hostToClient.send(new V(d.ADD,t,e,n))}}catch(t){r={error:t}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}},t.prototype.broadcastCollectionItemRemoved=function(t,e){var n,r,i=this.clientCollectionSubscriptions.getValuesAtKey(t);if(i)try{for(var o=Y(i),a=o.next();!a.done;a=o.next()){var s=a.value;this.clientConnections[s].hostToClient.send(new V(d.REMOVE,t,e))}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},t.prototype.broadcastCollectionItemUpdated=function(t,e,n){var r,i,o=this.clientCollectionSubscriptions.getValuesAtKey(t);if(o)try{for(var a=Y(o),s=a.next();!s.done;s=a.next()){var c=s.value;this.clientConnections[c].hostToClient.send(new V(d.UPDATE,t,e,n))}}catch(t){r={error:t}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}},t.prototype.onCallReceived=function(t){this.functionCallcallback=t},t.prototype.onCustomMessageReceived=function(t){this.customMessageCallback=t},t.prototype.onSubscribeReceived=function(t){this.eventSubCallback=t},t.prototype.onUnsubscribeReceived=function(t){this.eventUnsubCallback=t},t.prototype.onObservableSubReceived=function(t){this.observableSubCallback=t},t.prototype.onObservableUnsubReceived=function(t){this.observableUnsubCallback=t},t.prototype.onCollectionSubReceived=function(t){this.collectionSubCallback=t},t.prototype.onCollectionUnsubReceived=function(t){this.collectionUnsubCallback=t},t.prototype.createHostToClientConnection=function(e,n){var r=new M(this.hostId,e,new D(this.host,n)),i=new t.DirectMessageHostFacade(this);return r.addObserver(new I(i,e)),r.addObserver(new k(i,e)),r.addObserver(new L(i,e)),r.addObserver(new N(i,e)),r.addObserver(new j(i,e)),r.addObserver(new B(i,e)),r.addObserver(new F(i,e)),r.addObserver(new U(i,e)),r.init(),r},t.prototype.onConnectionReceived=function(t,e,n){var r=n.id,i=this.createHostToClientConnection(r,n.node);this.clientConnections[r]={id:r,clientToHost:n.messenger,hostToClient:i,applicationKey:t,origin:e}},t.prototype.receiveAction=function(t,e){var n=this.clientConnections[e];if(n){this.functionCallcallback&&this.functionCallcallback(q({},t,{type:c.ACTION,onSuccess:function(e){n.hostToClient.send(new z(t.uid,e,!0,""))},onFail:function(e){n.hostToClient.send(new z(t.uid,{},!1,e))},fromId:e,applicationKey:n.applicationKey,origin:n.origin,method:r.DIRECT,source:void 0}))}},t.prototype.receiveCustomMessage=function(t,e){var n=this.clientConnections[e];if(n&&this.customMessageCallback){this.customMessageCallback(q({},t,{type:i.CUSTOM,onSuccess:function(e){n.hostToClient.send(new W(t.uid,!0,e))},onFail:function(e){n.hostToClient.send(new W(t.uid,!1,e))},fromId:e,applicationKey:n.applicationKey,origin:n.origin,method:r.DIRECT,source:void 0}))}},t.prototype.receiveEventSub=function(t,e){var n=this.clientConnections[e];n&&this.eventSubCallback&&(this.clientEventSubscriptions.add(t.subscription,e),this.eventSubCallback(this.createBridgedMessage(c.EVENT_SUB,t,n)))},t.prototype.receiveEventUnsub=function(t,e){var n=this.clientConnections[e];n&&this.eventUnsubCallback&&(this.clientEventSubscriptions.remove(t.subscription,e),this.eventUnsubCallback(this.createBridgedMessage(c.EVENT_UNSUB,t,n)))},t.prototype.receiveObservableSub=function(t,e){var n=this.clientConnections[e];n&&this.observableSubCallback&&(this.clientObservableSubscriptions.add(t.observableKey,e),this.observableSubCallback(this.createBridgedMessage(c.OBSERVABLE_SUB,t,n)))},t.prototype.receiveObservableUnsub=function(t,e){var n=this.clientConnections[e];n&&this.observableUnsubCallback&&(this.clientObservableSubscriptions.remove(t.observableKey,e),this.observableUnsubCallback(this.createBridgedMessage(c.OBSERVABLE_UNSUB,t,n)))},t.prototype.receiveCollectionSub=function(t,e){var n=this.clientConnections[e];n&&this.collectionSubCallback&&(this.clientCollectionSubscriptions.add(t.collectionKey,e),this.collectionSubCallback(this.createBridgedMessage(i.COLLECTION_SUB,t,n)))},t.prototype.receiveCollectionUnsub=function(t,e){var n=this.clientConnections[e];n&&this.collectionUnsubCallback&&(this.clientCollectionSubscriptions.remove(t.collectionKey,e),this.collectionUnsubCallback(this.createBridgedMessage(i.COLLECTION_UNSUB,t,n)))},t.prototype.createBridgedMessage=function(t,e,n){return q({},e,{fromId:n.id,uid:-1,type:t,applicationKey:n.applicationKey,origin:n.origin,method:r.DIRECT,source:void 0})},t.DirectMessageHostFacade=function(){function t(t){this.directMessageHost=t}return t.prototype.onConnectionReceived=function(t,e,n){this.directMessageHost.onConnectionReceived(t,e,n)},t.prototype.receiveAction=function(t,e){this.directMessageHost.receiveAction(t,e)},t.prototype.receiveCustomMessage=function(t,e){this.directMessageHost.receiveCustomMessage(t,e)},t.prototype.receiveEventSub=function(t,e){this.directMessageHost.receiveEventSub(t,e)},t.prototype.receiveEventUnsub=function(t,e){this.directMessageHost.receiveEventUnsub(t,e)},t.prototype.receiveObservableSub=function(t,e){this.directMessageHost.receiveObservableSub(t,e)},t.prototype.receiveObservableUnsub=function(t,e){this.directMessageHost.receiveObservableUnsub(t,e)},t.prototype.receiveCollectionSub=function(t,e){this.directMessageHost.receiveCollectionSub(t,e)},t.prototype.receiveCollectionUnsub=function(t,e){this.directMessageHost.receiveCollectionUnsub(t,e)},t}(),t}(),X=n(418),K=n(24),Q=n(190),Z=n(457),$=n(23),tt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),et=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="sdk",e.applicationKey=null,e.requestedVersion=null,e}return tt(e,t),e.prototype.copy=function(t){this.applicationKey=t.applicationKey,this.requestedVersion=t.requestedVersion},e}($.a);n.d(e,"setupSdk",(function(){return ht}));var nt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),rt=function(){return(rt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},it=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},ot=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},at=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},st=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},ct=new y.a("sdk"),ut=function(){function t(t){this.analytics=t,this.trackedEvents={}}return t.prototype.track=function(t,e,n){this.trackedEvents[t]&&this.trackedEvents[t][e]||(this.trackedEvents[t]=this.trackedEvents[t]||{},this.trackedEvents[t][e]=!0,this.analytics.track(t,n))},t}(),lt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="sdk",e.clientInterface={functions:{},commands:{},enums:{},observables:{},collections:{},custom:{}},e.valueToClientInterface={},e.commands={},e.commandCreators={},e.registeredEventUsers={},e.observables={},e.registeredObservers={},e.collections={},e.customRoutines={},e.registeredCollectionObservers={},e.observerMap=new Map,e}return nt(e,t),e.prototype.init=function(t,e){return it(this,void 0,void 0,(function(){var n,r;return ot(this,(function(i){switch(i.label){case 0:return this.validationUrl=t.validationUrl,this.postMessageHost=new w(window),this.directMessageHost=new J,n=this,r=ut.bind,[4,e.getModule(Q.default)];case 1:return n.analytics=new(r.apply(ut,[void 0,i.sent()])),this.clientFilter=t.clientFilter||function(){return!0},this.issueCommand=e.commandBinder.issueCommand.bind(e.commandBinder),this.interfacePromise=new K.a,this.clientScriptUrl=t.clientScriptUrl,this.requestQueue=t.queue,this.data=new et,e.market.register(this,et,this.data),[2]}}))}))},e.prototype.connect=function(t,e,n){return it(this,void 0,Promise,(function(){var i=this;return ot(this,(function(o){return[2,new Promise((function(o,a){i.onConnectionReceived({accept:function(r,a,s){o({scriptUrl:r,serializedInterface:a,messengerFactory:i.directMessageHost.createFactory(t,n),warning:s}),i.data.atomic((function(){i.data.applicationKey=t,i.data.requestedVersion=e}))},reject:function(t){return a(t)},handshake:function(){},applicationKey:t,origin:n,requestedVersion:e,method:r.DIRECT})}))]}))}))},e.prototype.enableHandshaking=function(){var t=this;this.postMessageHost.on(h.CONNECTION,(function(e){return t.onConnectionReceived(e)}))},e.prototype.acceptConnections=function(){var t=this;this.postMessageHost.on(h.MESSAGED,(function(e){return t.onActionReceived(e)})),this.postMessageHost.on(h.CUSTOM_MSG,(function(e){return t.executeRoutine(e)})),this.postMessageHost.on(h.SUBSCRIBED,(function(e){return t.onSubscribeReceived(e)})),this.postMessageHost.on(h.UNSUBSCRIBED,(function(e){return t.onUnsubscribeReceived(e)})),this.postMessageHost.on(h.OBSERVABLE_SUB,(function(e){return t.onObservableSubReceived(e)})),this.postMessageHost.on(h.OBSERVABLE_UNSUB,(function(e){return t.onObservableUnsubReceived(e)})),this.postMessageHost.on(h.COLLECTION_SUB,(function(e){return t.onCollectionSubReceived(e)})),this.postMessageHost.on(h.COLLECTION_UNSUB,(function(e){return t.onCollectionUnsubReceived(e)})),this.directMessageHost.onCallReceived((function(e){return t.onActionReceived(e)})),this.directMessageHost.onCustomMessageReceived((function(e){return t.executeRoutine(e)})),this.directMessageHost.onSubscribeReceived((function(e){return t.onSubscribeReceived(e)})),this.directMessageHost.onUnsubscribeReceived((function(e){return t.onUnsubscribeReceived(e)})),this.directMessageHost.onObservableSubReceived((function(e){return t.onObservableSubReceived(e)})),this.directMessageHost.onObservableUnsubReceived((function(e){return t.onObservableUnsubReceived(e)})),this.directMessageHost.onCollectionSubReceived((function(e){return t.onCollectionSubReceived(e)})),this.directMessageHost.onCollectionUnsubReceived((function(e){return t.onCollectionUnsubReceived(e)})),this.interfacePromise.resolve()},e.prototype.clearInterface=function(){this.clientInterface.functions={},this.clientInterface.commands={},this.clientInterface.enums={},this.clientInterface.observables={},this.clientInterface.collections={},this.commandCreators={}},e.prototype.onUpdate=function(){var t,e;if(this.observerMap.size)try{for(var n=at(this.observerMap),r=n.next();!r.done;r=n.next()){var i=st(r.value,2),o=i[0],a=st(i[1],3),s=a[0],c=a[1],u=a[2];o.dirty&&(this.notifyObservableUpdate(s,c,u.getData()),o.dirty=!1)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},e.prototype.addCommand=function(t,e){return it(this,void 0,void 0,(function(){var n,r,i;return ot(this,(function(o){switch(o.label){case 0:return n=this.getInterfaceIndex(t),this.clientInterface.commands.hasOwnProperty(n)&&ct.debug("Overwriting",n,"comamnd in sdk interface"),this.clientInterface.commands[n]=t,r=this.commands,i=n,[4,e];case 1:return r[i]=o.sent(),[2]}}))}))},e.prototype.addCustomRoutine=function(t,e,n){return it(this,void 0,void 0,(function(){var r,i;return ot(this,(function(o){switch(o.label){case 0:return this.clientInterface.custom.hasOwnProperty(t)&&ct.debug("Overwriting",t,"routine in sdk interface"),this.clientInterface.custom[t]=e,r=this.customRoutines,i=t,[4,n];case 1:return r[i]=o.sent(),[2]}}))}))},e.prototype.addCommandToInterface=function(t,e){var n=this.getInterfaceIndex(t);this.clientInterface.functions.hasOwnProperty(n)&&ct.debug("Overwriting "+n+" function in sdk interface"),this.clientInterface.functions[n]=t,this.commandCreators[n]=e,t.namespace||(this.clientInterface.functions[t.name]=t,this.commandCreators[t.name]=e)},e.prototype.addEnumToInterface=function(t){var e=this.getInterfaceIndex(t);if(this.clientInterface.functions.hasOwnProperty(e)&&ct.debug("Overwriting "+e+" enum in sdk interface"),this.clientInterface.enums[e]=rt({},t,{values:rt({},t.values)}),"Event"===t.name){var n=Object.keys(t.values);for(var r in n){this.valueToClientInterface;var i=t.values[n[r]];this.valueToClientInterface.hasOwnProperty(i)?ct.warn("Duplicate event detected for "+JSON.stringify(t)):this.valueToClientInterface[i]=t}}},e.prototype.addObservableToInterface=function(t,e){var n=this.getInterfaceIndex(t);this.clientInterface.observables.hasOwnProperty(n)&&ct.debug("Overwriting "+n+" observable in sdk interface"),this.clientInterface.observables[n]=rt({},t),this.observables[n]=e},e.prototype.addCollectionToInterface=function(t,e){var n=this.getInterfaceIndex(t);this.clientInterface.collections.hasOwnProperty(n)&&ct.debug("Overwriting "+n+" collection in sdk interface"),this.clientInterface.collections[n]=rt({},t),this.collections[n]=e},e.prototype.getInterfaceIndex=function(t){var e=t.name+"."+t.version;return t.namespace&&(e=t.namespace+"."+e),e},e.prototype.broadcast=function(t,e,n,r){void 0===r&&(r=!0);var i=this.registeredEventUsers[t]>0;if(r||i)if(e)if(void 0!==n){var o=e(n);this.postMessageHost.broadcastEvent(t,o,r),this.directMessageHost.broadcastEvent(t,o,r)}else{o=e();this.postMessageHost.broadcastEvent(t,o,r),this.directMessageHost.broadcastEvent(t,o,r)}else this.postMessageHost.broadcastEvent(t,void 0,r),this.directMessageHost.broadcastEvent(t,void 0,r)},e.prototype.notifyObservableUpdate=function(t,e,n){this.postMessageHost.broadcastObservationToClient(t,e,n),this.directMessageHost.broadcastObservationToClient(e,n)},e.prototype.makeVersionedInterface=function(t){X.valid(t)||(t+=".0");var e=function(e){var n,r,i={};try{for(var o=at(Object.keys(e)),a=o.next();!a.done;a=o.next()){var s=a.value,c=e[s];X.satisfies(t,"^"+c.version)&&(i[s]=c)}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i};return{enums:e(this.clientInterface.enums),functions:rt({},e(this.clientInterface.functions),e(this.clientInterface.commands)),observables:e(this.clientInterface.observables),collections:e(this.clientInterface.collections),custom:e(this.clientInterface.custom)}},e.prototype.onConnectionReceived=function(t){return it(this,void 0,void 0,(function(){var e,n,r=this;return ot(this,(function(i){switch(i.label){case 0:if(!this.clientFilter(t))return[2,t.reject("Connection refused")];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.verifyConnection(t)];case 2:return i.sent(),[3,4];case 3:return i.sent(),[2,t.reject("key/referrer mismatch")];case 4:return e=t.requestedVersion,n=function(n){var i=r.makeVersionedInterface(e);if(0===Object.keys(i.enums).length&&0===Object.keys(i.functions).length)return t.reject("unsupported version: "+e);r.trackSdkConnect(t),t.accept(r.clientScriptUrl,i,n)},t.handshake(),this.interfacePromise.then((function(){return n()})),[2]}}))}))},e.prototype.verifyConnection=function(t){var e={cache:!1,headers:{"X-Matterport-Application-Key":t.applicationKey,"X-Matterport-Referrer":t.origin}};return this.requestQueue.get(this.validationUrl,e)},e.prototype.onActionReceived=function(t){if(!this.tryActionThroughCommand(t)){var e=this.commandCreators[t.targetFunction];if(!e)return t.onFail(t.targetFunction+" is not a valid command");this.trackSdkCall(t);try{this.issueCommand(e(t.params)).then(t.onSuccess,(function(e){return t.onFail(e.message)}))}catch(e){ct.debug(e),t.onFail(e.message)}}},e.prototype.tryActionThroughCommand=function(t){var e=this.commands[t.targetFunction];if(!e)return!!this.clientInterface.commands.hasOwnProperty(t.targetFunction)&&(t.onFail(t.targetFunction+" is not ready to be called"),!0);this.trackSdkCall(t);try{e.exec(t.params,new ft(t))}catch(e){ct.debug(e),t.onFail(e.message)}return!0},e.prototype.executeRoutine=function(t){var e=this.customRoutines[t.messageSubType];if(e){this.trackCustomCall(t);try{e.exec(t.messageData,new ft(t))}catch(e){ct.debug(e),t.onFail(e.message)}}else this.clientInterface.custom.hasOwnProperty(t.messageSubType)&&t.onFail(t.messageSubType+" is not ready to be called")},e.prototype.onSubscribeReceived=function(t){this.registeredEventUsers.hasOwnProperty(t.subscription)||(this.registeredEventUsers[t.subscription]=0),this.registeredEventUsers[t.subscription]++,this.trackSdkEvent(h.SUBSCRIBED,t)},e.prototype.onUnsubscribeReceived=function(t){this.registeredEventUsers.hasOwnProperty(t.subscription)&&(this.trackSdkEvent(h.UNSUBSCRIBED,t),this.registeredEventUsers[t.subscription]--)},e.prototype.onObservableSubReceived=function(t){return it(this,void 0,void 0,(function(){var e,n,r,i,o;return ot(this,(function(a){switch(a.label){case 0:return e=t.fromId,n=t.observableKey,(r=this.observables[n])?[4,r]:[3,2];case 1:return i=a.sent(),this.registeredObservers[e]=this.registeredObservers[e]||{},void 0===this.registeredObservers[e][n]&&(o=new Z.b,this.registeredObservers[e][n]=i.subscribe(o),this.observerMap.set(o,[e,n,i]),this.trackClientSubscribe(h.OBSERVABLE_SUB,t)),[3,3];case 2:ct.error(n,"is not a valid, registered observable"),a.label=3;case 3:return[2]}}))}))},e.prototype.onObservableUnsubReceived=function(t){var e=t.fromId,n=t.observableKey;this.registeredObservers[e]&&this.registeredObservers[e][n]&&(this.registeredObservers[e][n].cancel(),delete this.registeredObservers[e][n],this.trackClientSubscribe(h.OBSERVABLE_UNSUB,t))},e.prototype.onCollectionSubReceived=function(t){return it(this,void 0,void 0,(function(){var e,n,r,i,o=this;return ot(this,(function(a){switch(a.label){case 0:return e=t.fromId,n=t.collectionKey,(r=this.collections[n])?[4,r]:[3,2];case 1:return i=a.sent(),this.registeredCollectionObservers[e]=this.registeredCollectionObservers[e]||{},void 0===this.registeredCollectionObservers[e][n]&&(this.registeredCollectionObservers[e][n]=i.observe({onAdded:function(t,r){o.postMessageHost.broadcastCollectionItemAdded(e,n,t,r),o.directMessageHost.broadcastCollectionItemAdded(n,t,r)},onRemoved:function(t){o.postMessageHost.broadcastCollectionItemRemoved(e,n,t),o.directMessageHost.broadcastCollectionItemRemoved(n,t)},onUpdated:function(t,r){o.postMessageHost.broadcastCollectionItemUpdated(e,n,t,r),o.directMessageHost.broadcastCollectionItemUpdated(n,t,r)}}),this.trackClientSubCollection(h.COLLECTION_SUB,t)),[3,3];case 2:ct.error(n,"is not a valid, registered collection"),a.label=3;case 3:return[2]}}))}))},e.prototype.onCollectionUnsubReceived=function(t){var e=t.fromId,n=t.collectionKey;this.registeredCollectionObservers[e]&&this.registeredCollectionObservers[e][n]&&(this.registeredCollectionObservers[e][n].cancel(),delete this.registeredCollectionObservers[e][n],this.trackClientSubCollection(h.COLLECTION_UNSUB,t))},e.prototype.trackSdkEvent=function(t,e){if(this.analytics){var n=t===h.SUBSCRIBED?"on":"off",r=this.valueToClientInterface[e.subscription];if(r){var i=Object.keys(r.values),o=i.find((function(t,n){var o=i[n];return r.values[o]===e.subscription}));if(o){var a={origin:e.origin,applicationKey:e.applicationKey,version:r.version,name:n,namespace:r.namespace,eventType:o,count:this.registeredEventUsers[e.subscription],method:e.method};this.analytics.track("sdk_event",e.subscription,a)}}}},e.prototype.trackSdkConnect=function(t){if(this.analytics){var e={origin:t.origin,applicationKey:t.applicationKey,version:t.requestedVersion,method:t.method};this.analytics.track("sdk_connect","connect",e)}},e.prototype.trackCustomCall=function(t){if(this.analytics){var e=this.clientInterface.custom[t.messageSubType],n=e.namespace+"."+e.name+"."+e.version,r=rt({origin:t.origin,applicationKey:t.applicationKey},e,{method:t.method});this.analytics.track("sdk_call",n,r)}},e.prototype.trackSdkCall=function(t){if(this.analytics){var e=this.clientInterface.functions[t.targetFunction]||this.clientInterface.commands[t.targetFunction],n=rt({origin:t.origin,applicationKey:t.applicationKey},e,{method:t.method});this.analytics.track("sdk_call",t.targetFunction,n)}},e.prototype.trackClientSubscribe=function(t,e){var n=t===h.OBSERVABLE_SUB,r=this.clientInterface.observables[e.observableKey],i=rt({origin:e.origin,applicationKey:e.applicationKey},r,{is_collection:!1,action:n?"subscribe":"cancel",method:e.method});this.analytics.track("sdk_subscribe",e.observableKey,i)},e.prototype.trackClientSubCollection=function(t,e){var n=t===h.COLLECTION_SUB,r=this.clientInterface.collections[e.collectionKey],i=rt({origin:e.origin,applicationKey:e.applicationKey},r,{is_collection:!0,action:n?"subscribe":"cancel",method:e.method});this.analytics.track("sdk_subscribe",e.collectionKey,i)},e}(o.a),ht=(e.default=lt,function(t,e){return it(void 0,void 0,void 0,(function(){var n,r=this;return ot(this,(function(i){switch(i.label){case 0:return[4,t.getModule(lt)];case 1:return(n=i.sent()).enableHandshaking(),[4,Promise.all(e.map((function(e){return it(r,void 0,void 0,(function(){return ot(this,(function(r){switch(r.label){case 0:return[4,e(t,n)];case 1:return r.sent(),[2]}}))}))})))];case 2:return i.sent(),n.acceptConnections(),[2]}}))}))}),ft=function(){function t(t){this.action=t}return t.prototype.onComplete=function(t){this.action.onSuccess(t)},t}()},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(0),a=n(152),s=n(283),c=n(245),u=n(22),l=n(13),h=n(40),f=n(8),p=n(2),d=n(72),y=n(29),m=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},v=new p.a("pin-mesh"),g=function(){function t(t,e,n,r,i){var a=this;this.sweepViewData=t,this.scene=e,this.sweepTextureLoader=n,this.input=r,this.container=new o.zb,this.bindings=[],this.visibilityFilter=function(){return!0},this.updatePlacementType=function(t,e){a.dataToMeshMap[t.id]||t.placementType!==u.b.MANUAL?a.dataToMeshMap[t.id]&&t.placementType!==u.b.MANUAL&&(a.removePinMesh(t),a.engine.broadcast(new s.a(t.id,e,!1))):(a.createPinMesh(t,a.cameraData),a.engine.broadcast(new s.a(t.id,e,!0)))},this.onSweepPlacedMessage=function(t){a.highlightPin(t.sweepId,!0)},this.hoverSweep=function(t,e){a.issueCommand(new d.e(t,e,0));var n=a.sweepViewData.selectedSweep===t;a.highlightPin(t,e||n)},this.meshes=[],this.meshToDataMap={},this.dataToMeshMap={},this.cameraData=i,t.iterate((function(e){e.alignmentType!==u.a.ALIGNED&&(e.placementType===u.b.MANUAL&&a.createPinMesh(e,i),a.bindings.push(e.onChanged((function(){var n=t.getIndexByAlignment(!1,e.id);a.updatePlacementType(e,n),h.k(e)&&a.updatePinMeshPosition(e.id,e.position)}))))}))}return t.prototype.updatePinMeshPosition=function(t,e){this.mapSweepToMesh(t).updatePosition(e)},t.prototype.mapSweepToMesh=function(t){return this.dataToMeshMap[t]},t.prototype.mapColliderToSweep=function(t){var e=t.hasOwnProperty("collider")?t:t.parent;if(e){var n=this.meshToDataMap[e.id];if(n)return n.sweep}return null},t.prototype.filter=function(t){var e,n;this.visibilityFilter=t;try{for(var r=m(this.meshes),i=r.next();!i.done;i=r.next()){var o=i.value;this.filterMesh(o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.init=function(){},t.prototype.dispose=function(){for(var t in this.meshToDataMap){var e=this.meshToDataMap[t];this.removePinMesh(e.sweep)}},t.prototype.render=function(t){var e,n;try{for(var r=m(this.meshes),i=r.next();!i.done;i=r.next()){i.value.render(t)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.activate=function(t){var e=this;this.engine=t,this.issueCommand=t.commandBinder.issueCommand.bind(t.commandBinder),this.bindings.push(this.input.registerMeshHandler(f.e,y.a.isType(a.a),(function(t,n){return e.onHoverEvent(n,!0)}))),this.bindings.push(this.input.registerMeshHandler(f.r,y.a.isType(a.a),(function(t,n){return e.onHoverEvent(n,!1)}))),this.bindings.push(t.subscribe(c.a,this.onSweepPlacedMessage)),this.scene.add(this.container)},t.prototype.deactivate=function(t){var e,n;try{for(var r=m(this.bindings),i=r.next();!i.done;i=r.next()){i.value.cancel()}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}this.bindings.length=0,this.scene.remove(this.container)},t.prototype.getMeshes=function(){return this.meshToDataMap},t.prototype.highlightPin=function(t,e){this.dataToMeshMap[t]&&this.dataToMeshMap[t].setPinHover(e?1:0,!1)},t.prototype.lockSelection=function(t,e){return e&&(this.engine.broadcast(new s.b(t.id,!0)),this.hoverSweep(t.id,!0)),!0},t.prototype.createPinMesh=function(t,e){var n=new a.b(t.position,null,e);this.meshes.push(n),this.dataToMeshMap[t.id]=n,this.meshToDataMap[n.id]={id:n.id,sweep:t},this.container.add(n),this.filterMesh(n),this.sweepTextureLoader.loadFace(t.id,l.d.BASE,1,{flipY:!0}).then((function(t){n.material.uniforms.tPinHole.value=t})).catch((function(e){v.error(t.id+" failed to load texture: "+e)}))},t.prototype.removePinMesh=function(t){var e=this.dataToMeshMap[t.id],n=this.meshes.findIndex((function(t){return t.id===e.id}));this.meshes.splice(n,1),this.container.remove(e),this.deactivateMesh(e),delete this.meshToDataMap[e.id],delete this.dataToMeshMap[t.id],e.dispose()},t.prototype.filterMesh=function(t){var e=this.meshToDataMap[t.id];if(e){var n=e.sweep;this.visibilityFilter(n)?this.activateMesh(t):this.deactivateMesh(t)}},t.prototype.onHoverEvent=function(t,e){var n=this.mapColliderToSweep(t);n&&this.hoverSweep(n.id,e)},t.prototype.activateMesh=function(t){this.input.registerMesh(t.collider,!1),t.activate()},t.prototype.deactivateMesh=function(t){this.input.unregisterMesh(t.collider);var e=this.meshToDataMap[t.id];e&&(this.hoverSweep(e.sweep.id,!1),t.deactivate())},t.MENU_CLEAR_DEBOUNCE=100,t}(),b=n(25),w=n(31),_=n(189),x=n(406),S=n(203),T=n(96),M=n(18),E=n(17),P=n(26),O=n(1),A=n(35),D=n(114),R=n(215),C=n(164),I=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),k=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},L=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},N=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},j=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="sweep-pin-mesh",e.onChange=function(){var t=e.sweepViewData,n=t.selectedSweep,r=t.toolState===D.b.ROTATING||t.toolState===D.b.ROTATED;e.pinRenderer.filter((function(t){if(!e.settingsData.tryGetProperty(R.a,!0))return!1;if(r&&n===t.id)return!1;if(e.viewmodeData.transition.active&&e.viewmodeData.transition.to===O.a.Panorama)return!1;var i=Object(A.c)(t.floor),o=e.viewmodeData.closestMode===O.a.Dollhouse||e.viewmodeData.closestMode===O.a.Floorplan;return i&&o}))},e.onSelectedPinChange=function(){var t=e.sweepViewData.selectedSweep;t&&(e.engine.commandBinder.issueCommand(new d.f(t,!0,0)),e.pinRenderer.highlightPin(t,!0))},e}return I(e,t),e.prototype.init=function(t,e){return k(this,void 0,void 0,(function(){var t,n,r,i=this;return L(this,(function(o){switch(o.label){case 0:return[4,Promise.all([e.getModule(T.default),e.getModule(b.default),e.getModule(w.default),e.market.waitForData(D.a),e.market.waitForData(M.a),e.market.waitForData(P.a),e.market.waitForData(E.a)])];case 1:return t=N.apply(void 0,[o.sent(),7]),this.model=t[0],this.webglRenderer=t[1],this.input=t[2],this.sweepViewData=t[3],this.cameraData=t[4],this.settingsData=t[5],this.viewmodeData=t[6],n=this.webglRenderer.getScene().scene,this.engine=e,r=new _.a(this.model.getSignedUrls()),this.pinRenderer=new g(this.sweepViewData,n,r,this.input,this.cameraData),e.addComponent(this,this.pinRenderer),this.settingsData.onPropertyChanged(R.a,this.onChange),this.bindings.push(this.viewmodeData.onChanged(this.onChange),this.sweepViewData.onSelectedSweepChanged(this.onSelectedPinChange,!0),e.subscribe(C.a,this.onChange),e.subscribe(S.e,this.onChange),e.subscribe(S.c,this.onChange),e.commandBinder.addBinding(x.b,(function(t){return k(i,void 0,void 0,(function(){return L(this,(function(e){return this.pinRenderer.highlightPin(t.id,!1),[2]}))}))}))),this.onChange(),[2]}}))}))},e.prototype.mapColliderToSweep=function(t){return this.pinRenderer.mapColliderToSweep(t)},e.prototype.selectPinMesh=function(t,e){return this.pinRenderer.lockSelection(t,e)},e.prototype.highlightPinMesh=function(t,e){this.pinRenderer.highlightPin(t,e)},e.prototype.mapSweepToMesh=function(t){return this.pinRenderer.mapSweepToMesh(t)},e.prototype.updatePosition=function(t,e){this.pinRenderer.updatePinMeshPosition(t,e)},e}(i.a);e.default=j},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r,i,o=n(312),a=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};!function(t){t.sessionObjectExtract=function(t,e){return function(n){return e(n?n[t]:null)}},t.sessionObjectMap=function(t,e,n){return function(r){var i;return n(r?((i={})[e]=r[t],i):null)}},t.sessionCollectionMap=function(t,e){return function(n){var r,i;if(n){var s={},c=n[t];if(!(c&&c instanceof Array))return e(null);var u=function(t){if(!t.sid){var e;do{e=Object(o.a)(11)}while(c.find((function(t){return t.sid===e})));t.sid=e}s[t.sid]=t};try{for(var l=a(c),h=l.next();!h.done;h=l.next()){u(h.value)}}catch(t){r={error:t}}finally{try{h&&!h.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}return e(s)}return e(null)}}}(r||(r={})),function(t){t.sessionObjectMap=function(t,e,n){return function(r,i){var o,a=n(r,i);return a?((o={})[e]=a[t],o):null}}}(i||(i={}))},function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t.INVALID_CREDENTIALS="invalidcredentials",t.TOO_MANY_ATTEMPTS="toomanyattempts",t.UNKNOWN="unknown"}(r||(r={}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return s}));var r,i=n(5),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e){var n=t.call(this)||this;return n.id="ALLOW_HIGH_RES",n.payload={ignoreWindowSize:e},n}return o(e,t),e}(i.a),s=function(t){function e(e){var n=t.call(this)||this;return n.id="SET_NAV_PANO_SIZE",n.payload={navSize:e},n}return o(e,t),e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return c})),n.d(e,"c",(function(){return u}));var r,i=n(262),o=n(122),a=n(88),s=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};!function(t){t.added="added",t.removed="removed",t.updated="updated"}(r||(r={}));var c=function(t,e,n){this.index=t,this.action=e,this.diff=n},u=function(){function t(t,e){if(this.changedHandlers=[],this.awaitingInvoke=!1,this.diffRecord=[],this.targetMonitors={},this.triggerChangeHandlers=this.invokeChangeHandlers.bind(this),this.config=t,this.updatePhaseSync=e,this.config.aggregationType===o.a.NextFrame){if(!e)throw Error("UpdatePhaseSync required for NextFrame aggregation")}else if(this.config.aggregationType===o.a.Duration)throw Error("Aggregation Type not implemented")}return t.prototype.hasDiffRecord=function(){return this.diffRecord.length>0},t.prototype.clearDiffRecord=function(){for(var t in this.diffRecord=[],this.targetMonitors){var e=this.targetMonitors[t];e.hasDiffRecord()&&e.clearDiffRecord()}},t.prototype.onChanged=function(t){this.changedHandlers.push(t)},t.prototype.removeOnChanged=function(t){Object(i.a)(this.changedHandlers,t)},t.prototype.invokeCallbacks=function(t){var e,n;if(this.changedHandlers.length>0)try{for(var r=s(this.changedHandlers),i=r.next();!i.done;i=r.next()){(0,i.value)(t)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.invokeChangeHandlers=function(t){var e=this;switch(this.config.aggregationType){case o.a.Immediate:this.invokeCallbacks(t);break;case o.a.NextFrame:this.awaitingInvoke||(this.awaitingInvoke=!0,this.updatePhaseSync.after(a.a.End).then((function(){e.awaitingInvoke=!1,e.invokeCallbacks(t)})));break;case o.a.Manual:}},t}()},function(t,e,n){"use strict";n.d(e,"b",(function(){return f})),n.d(e,"a",(function(){return p})),n.d(e,"d",(function(){return d})),n.d(e,"c",(function(){return y}));var r=n(48),i=n(604),o=n.n(i),a=n(605),s=n.n(a),c=n(606),u=n.n(c),l=n(607),h=n.n(l),f=Object(r.a)(o.a),p=Object(r.a)(s.a),d=Object(r.a)(u.a),y=Object(r.a)(h.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r,i=n(0),o=n(93),a=n(61),s=n(42),c=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),u=function(t){function e(e,n,r,o){var a=t.call(this,n,r)||this;return a.discScale=1,a.defaultColor=new i.s,a.hoverColor=new i.s,a.hsl={h:0,s:0,l:0},a.userData.sid=e,a.discWorldPosition=new i.Jc,a.cameraPosition=new i.Jc,a.changeColor(r.uniforms.color.value),a.layers.mask=o.mask,a.renderOrder=s.a.tags,a.scale.set(.01,.01,.01),a}return c(e,t),e.prototype.dispose=function(){this.material.dispose(),this.geometry.dispose()},e.prototype.changeColor=function(t){this.defaultColor.set(t),this.defaultColor.getHSL(this.hsl),this.hoverColor.setHSL(this.hsl.h,this.hsl.s,.8*this.hsl.l)},e.prototype.update=function(t,e,n,r,s){var c=e?this.hoverColor:this.defaultColor;this.material.uniforms.color.value.copy(c);var u=o.c.mattertags.disc.scale;this.getWorldPosition(this.discWorldPosition);var l=n.getWorldPosition(this.cameraPosition).distanceTo(this.discWorldPosition);this.quaternion.copy(n.quaternion);var h=u.maxSize-(u.maxSize-u.minSize)*i.ib.smoothstep(l,u.nearBound,u.farBound),f=this.discWorldPosition.clone().project(n),p=new i.Jc(s.width/2,s.height/2,1).multiply(f),d=new i.Jc(h/2,0,0).add(p),y=new i.Jc(2/s.width,2/s.height,1).multiply(d).clone().unproject(n).clone().distanceTo(this.discWorldPosition),m=1+o.c.mattertags.disc.scale.responsiveness/100*(r-1);this.discScale=y*m;var v=i.ib.clamp(this.discScale,a.a.epsilon,this.discScale);this.scale.set(v,v,v)},e}(i.lb)},function(t,e,n){var r=n(247);t.exports=!r((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(t,e,n){"use strict";var r=n(387),i=n(490),o=n(668),a=n(388);(t.exports=function(t,e){var n,o,s,c,u;return arguments.length<2||"string"!=typeof t?(c=e,e=t,t=null):c=arguments[2],null==t?(n=s=!0,o=!1):(n=a.call(t,"c"),o=a.call(t,"e"),s=a.call(t,"w")),u={value:e,configurable:n,enumerable:o,writable:s},c?r(i(c),u):u}).gs=function(t,e,n){var s,c,u,l;return"string"!=typeof t?(u=n,n=e,e=t,t=null):u=arguments[3],null==e?e=void 0:o(e)?null==n?n=void 0:o(n)||(u=n,n=void 0):(u=e,e=n=void 0),null==t?(s=!0,c=!1):(s=a.call(t,"c"),c=a.call(t,"e")),l={get:e,set:n,configurable:s,enumerable:c},u?r(i(u),l):l}},function(t,e,n){var r=n(59),i=r.Buffer;function o(t,e){for(var n in t)e[n]=t[n]}function a(t,e,n){return i(t,e,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=r:(o(r,e),e.Buffer=a),o(i,a),a.from=function(t,e,n){if("number"==typeof t)throw new TypeError("Argument must not be a number");return i(t,e,n)},a.alloc=function(t,e,n){if("number"!=typeof t)throw new TypeError("Argument must be a number");var r=i(t);return void 0!==e?"string"==typeof n?r.fill(e,n):r.fill(e):r.fill(0),r},a.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return i(t)},a.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return r.SlowBuffer(t)}},function(t,e,n){"use strict";var r=n(336),i=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e};t.exports=h;var o=n(290);o.inherits=n(37);var a=n(500),s=n(393);o.inherits(h,a);for(var c=i(s.prototype),u=0;u<c.length;u++){var l=c[u];h.prototype[l]||(h.prototype[l]=s.prototype[l])}function h(t){if(!(this instanceof h))return new h(t);a.call(this,t),s.call(this,t),t&&!1===t.readable&&(this.readable=!1),t&&!1===t.writable&&(this.writable=!1),this.allowHalfOpen=!0,t&&!1===t.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",f)}function f(){this.allowHalfOpen||this._writableState.ended||r.nextTick(p,this)}function p(t){t.end()}Object.defineProperty(h.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(h.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(t){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}}),h.prototype._destroy=function(t,e){this.push(null),this.end(),r.nextTick(e,t)}},function(t,e,n){t.exports=n(59)},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i,o="object"===("undefined"==typeof Reflect?"undefined":r(Reflect))?Reflect:null,a=o&&"function"==typeof o.apply?o.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};i=o&&"function"==typeof o.ownKeys?o.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var s=Number.isNaN||function(t){return t!=t};function c(){c.init.call(this)}t.exports=c,c.EventEmitter=c,c.prototype._events=void 0,c.prototype._eventsCount=0,c.prototype._maxListeners=void 0;var u=10;function l(t){return void 0===t._maxListeners?c.defaultMaxListeners:t._maxListeners}function h(t,e,n,i){var o,a,s,c;if("function"!=typeof n)throw new TypeError('The "listener" argument must be of type Function. Received type '+r(n));if(void 0===(a=t._events)?(a=t._events=Object.create(null),t._eventsCount=0):(void 0!==a.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),a=t._events),s=a[e]),void 0===s)s=a[e]=n,++t._eventsCount;else if("function"==typeof s?s=a[e]=i?[n,s]:[s,n]:i?s.unshift(n):s.push(n),(o=l(t))>0&&s.length>o&&!s.warned){s.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=t,u.type=e,u.count=s.length,c=u,console&&console.warn&&console.warn(c)}return t}function f(){for(var t=[],e=0;e<arguments.length;e++)t.push(arguments[e]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,a(this.listener,this.target,t))}function p(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=f.bind(r);return i.listener=n,r.wrapFn=i,i}function d(t,e,n){var r=t._events;if(void 0===r)return[];var i=r[e];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(i):m(i,i.length)}function y(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function m(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}Object.defineProperty(c,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(t){if("number"!=typeof t||t<0||s(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");u=t}}),c.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},c.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||s(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},c.prototype.getMaxListeners=function(){return l(this)},c.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var r="error"===t,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var o;if(e.length>0&&(o=e[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var c=i[t];if(void 0===c)return!1;if("function"==typeof c)a(c,this,e);else{var u=c.length,l=m(c,u);for(n=0;n<u;++n)a(l[n],this,e)}return!0},c.prototype.addListener=function(t,e){return h(this,t,e,!1)},c.prototype.on=c.prototype.addListener,c.prototype.prependListener=function(t,e){return h(this,t,e,!0)},c.prototype.once=function(t,e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+r(e));return this.on(t,p(this,t,e)),this},c.prototype.prependOnceListener=function(t,e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+r(e));return this.prependListener(t,p(this,t,e)),this},c.prototype.removeListener=function(t,e){var n,i,o,a,s;if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+r(e));if(void 0===(i=this._events))return this;if(void 0===(n=i[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(o=-1,a=n.length-1;a>=0;a--)if(n[a]===e||n[a].listener===e){s=n[a].listener,o=a;break}if(o<0)return this;0===o?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,o),1===n.length&&(i[t]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",t,s||e)}return this},c.prototype.off=c.prototype.removeListener,c.prototype.removeAllListeners=function(t){var e,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(r=e.length-1;r>=0;r--)this.removeListener(t,e[r]);return this},c.prototype.listeners=function(t){return d(this,t,!0)},c.prototype.rawListeners=function(t){return d(this,t,!1)},c.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):y.call(t,e)},c.prototype.listenerCount=y,c.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]}},function(t,e,n){"use strict";function r(t){return t&&"floorIndex"in t}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return c}));var r=n(232),i=n(40),o=n(119),a=n(147),s=function(t,e){if(!t.currentSweepObject)return[];var n=t.currentSweepObject,r=[i.i(n),i.c(),i.e(n),i.a(n.position,e)],a=[o.b(n.position,e),o.c(n.position)];return t.sortByScore(r,a)},c=function(t,e,n){var s=[i.c(),i.b()],c=[o.d(n.point)],u=t.currentSweepObject;e&&u&&s.push(i.i(u),i.l(u.position,a.a.longerTransitionMaxDist),i.e(u)),n.face&&s.push(i.f(n.point,n.face.normal)),Object(r.a)(n.object)&&c.push(o.a(n.object.floorIndex));var l=t.sortByScore(s,c);if(0===l.length){var h=t.getClosestSweep(n.point,!0);l.push({sweep:h,score:0})}return l}},function(t,e,n){"use strict";var r=n(0),i=function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};window.THREE=i({},window.THREE,{BufferGeometry:r.m,Sphere:r.mc,Box3:r.h,Texture:r.vc,Color:r.s,BufferAttribute:r.l}),r.l.prototype.setArray&&delete r.l.prototype.setArray;var o,a=n(572),s=n(573),c=n(3),u=n(54),l=n(7),h=n(65),f=n(28),p=n(36),d=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),y=function(t){function e(e){var n=t.call(this)||this;n.config=e,n.update=function(){n.textGeometry.update(n.config),n.textGeometry.computeBoundingBox(),n.labelTextMesh.position.x=.5*-n.textGeometry.layout.width,n.labelTextMesh.position.y=-(.5*n.textGeometry.layout.height+n.config.backgroundBorderHeight),n.labelTextMesh.position.z=.25,n.unscaledWidth=n.textGeometry.layout.width+n.config.backgroundBorderWidth,n.unscaledHeight=n.textGeometry.layout.height+n.config.backgroundBorderHeight,n.config.background&&n.labelBackgroundMesh.scale.set(n.unscaledWidth,n.unscaledHeight,.01),n.aspect=n.unscaledWidth/Math.max(n.unscaledHeight,.001),n.updateScale()};var i=void 0!==n.config.opacity?n.config.opacity:1;if(e.background){n.config.backgroundOpacity=void 0!==n.config.backgroundOpacity?n.config.backgroundOpacity:1;var o=new r.k(1,1,.01),u=new r.mb({color:e.backgroundColor,transparent:!0,depthTest:i>0,depthWrite:i>0,opacity:n.config.backgroundOpacity});n.labelBackgroundMesh=new r.lb(o,u),n.labelBackgroundMesh.position.z=-.25,n.labelBackgroundMesh.name="Label Background",n.add(n.labelBackgroundMesh)}var l=s({map:e.texture,color:e.color,negate:!!e.negate}),h=new r.cc({uniforms:l.uniforms,fragmentShader:l.fragmentShader,vertexShader:l.vertexShader,side:r.w,transparent:!0,depthTest:i>0,depthWrite:i>0,opacity:i});n.textGeometry=a(e),n.labelTextMesh=new r.lb(n.textGeometry,h),n.labelTextMesh.name="Label Text",n.labelTextMesh.renderOrder=10;var f=(new r.Pb).setFromAxisAngle(c.b.FORWARD,r.ib.degToRad(180)),p=(new r.Pb).setFromAxisAngle(c.b.UP,r.ib.degToRad(180));return n.labelTextMesh.quaternion.multiply(f).multiply(p),n.add(n.labelTextMesh),n.name="Label Container",n.fontHeightToMeters=1/e.font.info.size,n.scaleFactor=e.scale||n.fontHeightToMeters,n}return d(e,t),e.prototype.updateScale=function(){this.height=this.textGeometry.layout.height*this.config.scale,this.width=this.textGeometry.layout.width*this.config.scale;var t=this.config.scale*this.fontHeightToMeters;this.scale.set(t,t,t)},Object.defineProperty(e.prototype,"text",{get:function(){return this.config.text},set:function(t){t!==this.name&&(this.config.text=t,this.name=t,this.update())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleFactor",{get:function(){return this.config.scale},set:function(t){this.scaleFactor!==t&&(this.config.scale=t,this.updateScale())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"opacity",{get:function(){return this.config.opacity?this.config.opacity:1},set:function(t){if(t!==this.config.opacity){if(this.config.opacity=t,this.config.background){var e=this.labelBackgroundMesh.material;e.opacity=Math.min(this.config.backgroundOpacity||1,t),e.depthWrite=t>u.c.DEPTH_WRITE_THRESHOD,e.depthTest=t>0}var n=this.labelTextMesh.material;n.uniforms.opacity.value=t,n.depthWrite=t>u.c.DEPTH_WRITE_THRESHOD,n.depthTest=t>0}},enumerable:!0,configurable:!0}),e.prototype.setRenderLayer=function(t){this.labelTextMesh.layers.mask=t.mask,this.labelBackgroundMesh.layers.mask=t.mask},e.prototype.setPosition=function(t,e){void 0===e&&(e=function(t){return t}),this.position.copy(e(t))},e.prototype.setOrientation=function(t,e){void 0===e&&(e=0),this.quaternion.copy(t),0!==e&&this.rotateZ(-e*l.b)},e.prototype.scaleBillboard=function(t,e,n,r,i,o,a){void 0===a&&(a=p.c.SCALE);var s=Object(h.f)(this.position,t,e,n.asThreeMatrix4()),c=Math.abs(s.x);if(c<1){var u=Object(f.a)(n,t,this.position,r,a),d=(Object(l.e)(i,1,2.5)+o)*p.c.SCALE_ASPECT,y=1+p.c.SCALE_NDC-c*p.c.SCALE_NDC-d;this.scaleFactor=Math.max(Math.min(1/u*y,3),.001)}else this.scaleFactor=.001},e}(r.zb),m=n(48),v=n(574),g=n.n(v),b=n(575),w=function(){return(w=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},_=Object(m.a)(g.a),x=function(){function t(t){this.defaultTextConfig={text:"",color:"black",backgroundColor:"white",backgroundBorderWidth:50,backgroundBorderHeight:30,background:!0,texture:_,font:b,scale:1,negate:!0},this.currentTextConfig=this.defaultTextConfig,t?this.updateTextStyle(t):this.updateTextStyle(this.defaultTextConfig)}return t.prototype.updateTextStyle=function(t){this.currentTextConfig=w({},this.currentTextConfig,t)},t.prototype.createLabel=function(t){return void 0===t&&(t={text:""}),new y(w({},this.currentTextConfig,t))},t}();n.d(e,"a",(function(){return x}))},function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t.Segment="segment",t.Logging="logging",t.Matterport="mp"}(r||(r={}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(94),i=n(348),o={0:r.a.GL_TEXTURE_CUBE_MAP_POSITIVE_Y,1:r.a.GL_TEXTURE_CUBE_MAP_POSITIVE_Z,2:r.a.GL_TEXTURE_CUBE_MAP_POSITIVE_X,3:r.a.GL_TEXTURE_CUBE_MAP_NEGATIVE_Z,4:r.a.GL_TEXTURE_CUBE_MAP_NEGATIVE_X,5:r.a.GL_TEXTURE_CUBE_MAP_NEGATIVE_Y},a=function(t){if(t<0||t>5)throw new i.a("mapFaceToCubemapFace() -> face must be in the range [0, 5]");return o[t]}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return s}));var r,i=n(9),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n){var r=t.call(this)||this;return r.mode=e,r.fromMode=n,r}return o(e,t),e}(i.a),s=function(t){function e(e){var n=t.call(this)||this;return n.source=e,n}return o(e,t),e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r,i=n(69),o=n(0),a=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.position=new o.Jc,e.floor=0,e.sid="",e.text="",e.visible=!1,e.roomId="",e.created=new Date,e.modified=new Date,e.version="3.1",e}return a(e,t),e.prototype.copy=function(t){return this.floor=t.floor,this.sid=t.sid,this.text=t.text,this.visible=t.visible,this.roomId=t.roomId,this.created=t.created,this.modified=t.modified,this.position.copy(t.position),this.version=t.version,this.commit(),this},e}(i.a)},function(t,e,n){"use strict";var r=n(80),i=n(81),o=n(0);e.a={basicTextured:{uniforms:{tDiffuse:{type:"t",value:null},alpha:{type:"f",value:1}},vertexShader:i+n(402),fragmentShader:r+n(797)},screenSpaceColored:{uniforms:{color:{type:"v3",value:new o.Jc(0,0,0)},opacity:{type:"f",value:1}},vertexShader:i+n(798),fragmentShader:r+n(799)}}},function(t,e,n){"use strict";n.r(e);var r,i=n(11),o=n(4),a=n(216),s=n(118),c=n(26),u=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},h=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="gui",e.workshopApp=!1,e.mainDiv=document.querySelector("main")||document.body,e.onAppReadyChanged=function(t,n){e.workshopApp&&(e.enableAppSwitching(t),n&&t?e.mainDiv.classList.add("edit-mode"):e.mainDiv.classList.remove("edit-mode"))},e}return u(e,t),e.prototype.init=function(t,e){return l(this,void 0,void 0,(function(){var n,r,i,o;return h(this,(function(u){switch(u.label){case 0:return this.config=t,this.engine=e,this.messageBus=e,this.market=e.market,this.commandBinder=e.commandBinder,n=e.getModule(s.default),r=e.getModule(a.default),i=e.market.waitForData(c.a),o=this,[4,Promise.all([n,r,i])];case 1:return o.mainArgs=u.sent(),this.preactRenderer=new p,e.addComponent(this,this.preactRenderer),[2]}}))}))},e.prototype.unloadUi=function(t,e){return l(this,void 0,void 0,(function(){var n=this;return h(this,(function(r){return this.workshopApp&&this.enableAppSwitching(!1),e?[2,new Promise((function(r){window.setTimeout((function(){Object(i.render)(null,n.mainDiv,t),r()}),e)}))]:[2,Object(i.render)(null,this.mainDiv,t)]}))}))},Object.defineProperty(e.prototype,"unloadListeners",{get:function(){return this.unloadListenersPromise},enumerable:!0,configurable:!0}),e.prototype.loadUi=function(t){return l(this,void 0,Promise,(function(){var e;return h(this,(function(n){switch(n.label){case 0:return e=[],[4,this.unloadListeners];case 1:return n.sent(),e=(e=e.concat(this.mainArgs)).concat([this.mainDiv,this.engine,this.messageBus,this.market,this.commandBinder,this.onAppReadyChanged]),[2,t.apply(this,e)]}}))}))},e.prototype.setWorkshopApp=function(){this.workshopApp=!0},e.prototype.enableAppSwitching=function(t){var e=this.config.container;t?e.classList.add("view-edit"):e.classList.remove("view-edit")},e.prototype.dispose=function(t){t.removeComponent(this,this.preactRenderer)},e}(o.a);e.default=f;var p=function(){function t(){}return t.prototype.render=function(){Object(i.rerender)()},t.prototype.init=function(){},t.prototype.dispose=function(){},t.prototype.activate=function(t){},t.prototype.deactivate=function(t){},t}()},function(t,e,n){"use strict";n.r(e);var r=n(63),i=n(14),o=n(4),a=n(1),s=n(53),c=n(17),u=n(10),l=n(31),h=n(111),f=n(8),p=n(130),d=n(77),y=n(12),m=n(70),v=n(26),g=n(18),b=n(0),w=n(7),_=n(74),x=n(21),S=n(6),T=n(197),M=n(33),E=n(20),P=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},O=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},A=function(){function t(t){this.settingsData=t,this.type=M.c.Delay,this.toIndex=-1,this.currentTransitionPromise=null,this.cancelDelay=function(){return null}}return Object.defineProperty(t.prototype,"active",{get:function(){return null!==this.currentTransitionPromise},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"promise",{get:function(){return this.currentTransitionPromise?this.currentTransitionPromise:Promise.resolve()},enumerable:!0,configurable:!0}),t.prototype.stop=function(){return P(this,void 0,Promise,(function(){return O(this,(function(t){return this.currentTransitionPromise&&(this.cancelDelay(),this.currentTransitionPromise=null),[2]}))}))},t.prototype.start=function(){var t=this;if(this.active)throw Error("Transition already active");var e=Object(E.c)(_t.getDelayDuration(this.settingsData));return this.cancelDelay=function(){e.cancel()},this.currentTransitionPromise=e.promise.then((function(){return t.stop()})),this},t}(),D=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},R=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},C=function(){function t(t,e,n){this.settingsData=t,this.zoom=e,this.stopZooming=n,this.type=M.c.Zoom,this.toIndex=-1,this.currentTransitionPromise=null,this.onStopRequested=function(){return Promise.resolve()}}return Object.defineProperty(t.prototype,"active",{get:function(){return null!==this.currentTransitionPromise},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"promise",{get:function(){return this.currentTransitionPromise?this.currentTransitionPromise:Promise.resolve()},enumerable:!0,configurable:!0}),t.prototype.stop=function(){return D(this,void 0,Promise,(function(){return R(this,(function(t){switch(t.label){case 0:return this.currentTransitionPromise?[4,this.onStopRequested()]:[3,3];case 1:return t.sent(),[4,this.promise];case 2:t.sent(),this.currentTransitionPromise=null,t.label=3;case 3:return[2]}}))}))},t.prototype.start=function(){var t=this;if(this.active)throw Error("Transition already active");var e=_t.getZoomDuration(this.settingsData);return this.currentTransitionPromise=this.zoom(e,-5e-4).then((function(){t.currentTransitionPromise=null})),this.onStopRequested=function(){return D(t,void 0,void 0,(function(){return R(this,(function(t){switch(t.label){case 0:return[4,this.stopZooming()];case 1:return t.sent(),[2]}}))}))},this},t}(),I=n(3),k=n(61),L=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},N=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},j=function(){function t(t,e,n){this.settingsData=t,this.rotate=e,this.stopRotating=n,this.type=M.c.Burns,this.toIndex=-1,this.currentTransitionPromise=null,this.onStopRequested=function(){return Promise.resolve()},this.getPanDirection=function(t,e){var n=M.b.Right;if(t&&t.metadata.scan_id&&t.metadata.camera_quaternion&&t.metadata.camera_position&&e&&e.metadata.scan_id&&e.metadata.camera_position&&e.metadata.camera_quaternion){var r=I.b.FORWARD.clone().applyQuaternion(t.metadata.camera_quaternion),i=e.metadata.camera_position,o=t.metadata.camera_position,a=i.clone().sub(o).normalize();a.lengthSq()<k.a.epsilon&&(a=I.b.FORWARD.clone().applyQuaternion(e.metadata.camera_quaternion)),r.cross(a).y>0&&(n=M.b.Left)}return n}}return Object.defineProperty(t.prototype,"active",{get:function(){return null!==this.currentTransitionPromise},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"promise",{get:function(){return this.currentTransitionPromise?this.currentTransitionPromise:Promise.resolve()},enumerable:!0,configurable:!0}),t.prototype.stop=function(){return L(this,void 0,Promise,(function(){return N(this,(function(t){switch(t.label){case 0:return this.currentTransitionPromise?[4,this.onStopRequested()]:[3,3];case 1:return t.sent(),[4,this.promise];case 2:t.sent(),this.currentTransitionPromise=null,t.label=3;case 3:return[2]}}))}))},t.prototype.start=function(t){var e=this;if(this.active)throw Error("Transition already active");if(!t)throw Error("Tour pan requires two snapshots");if(!t.snapshot||!t.nextSnapshot)return this.currentTransitionPromise=Promise.resolve(),this;var n=this.build(t.snapshot,t.nextSnapshot,t.panOverrides).deferred;return this.currentTransitionPromise=n.then((function(){e.currentTransitionPromise=null})),this},t.prototype.build=function(t,e,n){var r=this,i=n.panDirection,o=n.panAngle,a=_t.getPanValues(this.settingsData,!1,i,o),s=a.direction;return void 0!==s&&s!==M.b.Auto||(s=this.getPanDirection(t,e)),this.onStopRequested=function(){return L(r,void 0,void 0,(function(){return N(this,(function(t){switch(t.label){case 0:return[4,this.stopRotating()];case 1:return t.sent(),[2]}}))}))},{deferred:this.rotate(a.ms,new b.Ic(s*a.radiansPerMs,0))}},t}(),B=n(57),F=n(24),U=function(t,e,n,r){var i=Math.min(t.distanceTo(e),5),o=i*(1/r)*1e3,a=o,s=n/o;s>.001&&(a+=a*((s-.001)/.001));var c=Math.abs(t.clone().setX(0).setZ(0).distanceTo(e.clone().setX(0).setZ(0))/Math.max(i,1));c>.1&&(a*=.9+.75*c);return a},z=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},G=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},H=function(){function t(t,e,n,r,i,o){this.settingsData=t,this.cameraPose=e,this.moveToSweep=n,this.updateTransitionSpeed=r,this.setRestrictedSweeps=i,this.generators=o,this.toIndex=-1,this.currentGenerator=null,this.currentTransitionPromise=null,this.type=M.c.Move}return Object.defineProperty(t.prototype,"active",{get:function(){return null!==this.currentTransitionPromise||null!==this.currentGenerator},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"promise",{get:function(){return this.currentTransitionPromise?this.currentTransitionPromise:Promise.resolve()},enumerable:!0,configurable:!0}),t.prototype.stop=function(){return z(this,void 0,Promise,(function(){return G(this,(function(t){switch(t.label){case 0:return this.currentTransitionPromise?[4,this.onStopRequested()]:[3,3];case 1:return t.sent(),[4,this.promise];case 2:t.sent(),this.currentTransitionPromise=null,t.label=3;case 3:return this.currentGenerator&&(this.generators.stopGenerator(this.currentGenerator),this.currentGenerator=null),[2]}}))}))},t.prototype.start=function(t){if(this.active)throw Error("Transition already active");var e=this.build(t.path,t.orientations),n=e.generator,r=e.deferred;return this.generators.startGenerator(n),this.currentGenerator=n,this.currentTransitionPromise=r.nativePromise(),this},t.prototype.build=function(t,e){var n=this,i=new F.a,o=this,a=!1;return this.onStopRequested=function(){return z(n,void 0,void 0,(function(){return G(this,(function(t){switch(t.label){case 0:return a=!0,[4,this.updateTransitionSpeed(Pt)];case 1:return t.sent(),[2]}}))}))},{generator:function(){var n,s,c,l,h,f,p,d,y,m,v;return G(this,(function(g){switch(g.label){case 0:n=1,g.label=1;case 1:return n<t.length&&!a?(s=n-1,c=t[n],l=c.position,h=t[s],f=e[n],p=Object(w.d)(o.cameraPose.rotation,f),d=_t.getTransitionSpeed(o.settingsData),y=U(h.position,l,p,d),m={transitionType:u.a.Interpolate,sweepId:c.id,rotation:f,transitionTime:y,easing:B.i},o.setRestrictedSweeps(t,s),v=o.moveToSweep(m),[4,new r.c(v.nativePromise())]):[3,3];case 2:return g.sent(),n++,[3,1];case 3:return o.setRestrictedSweeps(null),i.resolve(),o.currentTransitionPromise=null,o.stop(),[2]}}))},deferred:i}},t}(),V=n(35),W=n(2),q=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},Y=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},J=new W.a("tours"),X=function(){function t(t,e,n,i,o,a,s,c,l){var h=this;this.settingsData=t,this.cameraPose=e,this.cameraTransition=n,this.sweepTransition=i,this.sweepControl=o,this.cameraControl=a,this.generators=s,this.setRestrictedSweeps=c,this.getCurve=l,this.type=M.c.Path,this.toIndex=-1,this.currentTransitionGenerator=null,this.currentTransitionPromise=null,this.canceling=!1,this.buildTransition=function(t,e){if(t.length<=2)throw J.debug("invalid path: "+t),new Error("smooth path requires more than 2 stops");var n=h,i=new F.a;n.setRestrictedSweeps(t);var o=t.map((function(t){return t.position})),a=n.getCurve(o),s=B.i,c=B.e,l=B.d,f=_t.getTransitionSpeed(n.settingsData),p=function(t,e,n){for(var r=0,i=0;i<t.length-1;i++){var o=Object(w.d)(e[i],e[i+1]);r+=U(t[i].position,t[i+1].position,o,n)}return r}(t,e,f);J.debug("path duration: "+p.toFixed(0)+"ms, at speed: "+f+"m/s"),n.cameraControl.beginExternalTransition();return{generator:function(){var o,h,d,y,m,v,g,_,x,S,T,M,E,P,O,A,D,R;return Y(this,(function(C){switch(C.label){case 0:return i.notify(0),o=new b.Jc,h=new b.Pb,d=0,y=0,m=0,g=t[v=1].id,[4,new r.c(n.sweepControl.activateSweepUnsafe({sweepId:g}))];case 1:C.sent(),n.sweepControl.beginSweepTransition({sweepId:g,transitionTime:p,internalProgress:!1}),t.length>2&&n.sweepControl.activateSweepUnsafe({sweepId:t[2].id}),_=n.cameraPose.rotation.clone(),C.label=2;case 2:return d<p&&!n.canceling?(x=d/p,m>0&&(_=e[m].clone()),S=e[v],T=a.normalSourceDistances[m],M=a.normalSourceDistances[v],E=t[v],(y=Object(w.r)(x,T,M,0,1))<=1&&(P=l(y,0,1,1),n.sweepTransition.progress.modifyAnimation(P,1,0),O=c(y,0,1,1),h.copy(_).slerp(S,O)),x<1&&o.copy(a.curve.getPointAt(s(x,0,1,1))),n.cameraControl.updateCameraPosition(o),n.cameraControl.updateCameraRotation(h),x>=M?(n.sweepControl.endSweepTransition({sweepId:E.id}),m++,v++,g=t[m+1].id,[4,new r.c(n.sweepControl.activateSweepUnsafe({sweepId:g}))]):[3,4]):[3,6];case 3:C.sent(),n.sweepControl.beginSweepTransition({sweepId:g,transitionTime:p,internalProgress:!1}),t.length>m+2&&n.sweepControl.activateSweepUnsafe({sweepId:t[m+2].id}),C.label=4;case 4:return i.notify(x),d=Date.now()-n.cameraTransition.startTime,[4,new r.b];case 5:return C.sent(),[3,2];case 6:return n.cameraControl.endExternalTransition(),n.canceling?(n.canceling=!1,A=t[v].position,D=U(n.cameraPose.position,A,0,f),(R=n.cameraControl.moveTo({transitionTime:D/Pt,transitionType:u.a.Interpolate,pose:{position:A}})).progress((function(t){var e=Object(w.r)(t,0,1,y,1);n.sweepTransition.progress.modifyAnimation(e,1,0)})),[4,new r.c(R.nativePromise())]):[3,8];case 7:C.sent(),C.label=8;case 8:return n.sweepControl.endSweepTransition({sweepId:g}),n.setRestrictedSweeps(null),i.notify(1),i.resolve(),[2]}}))},deferred:i}}}return Object.defineProperty(t.prototype,"active",{get:function(){return null!==this.currentTransitionPromise||null!==this.currentTransitionGenerator},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"promise",{get:function(){return this.currentTransitionPromise?this.currentTransitionPromise:Promise.resolve()},enumerable:!0,configurable:!0}),t.prototype.stop=function(){return q(this,void 0,Promise,(function(){return Y(this,(function(t){switch(t.label){case 0:return this.canceling=!0,this.currentTransitionPromise?[4,this.promise]:[3,2];case 1:t.sent(),this.currentTransitionPromise=null,t.label=2;case 2:return this.currentTransitionGenerator&&(this.generators.stopGenerator(this.currentTransitionGenerator),this.currentTransitionGenerator=null),[2]}}))}))},t.prototype.start=function(t){var e=this;if(J.debug("starting smooth transition with "+(t.path.length-1)+" stops"),this.active)throw Error("Transition already active");this.canceling=!1;var n=this.buildTransition(t.path,t.orientations),r=n.generator,i=n.deferred;return this.generators.startGenerator(r),this.currentTransitionGenerator=r,this.currentTransitionPromise=i.nativePromise().then((function(){e.currentTransitionPromise=null,e.currentTransitionGenerator=null})),this},t}(),K=n(156),Q=n(15),Z=n(60),$=n(305),tt=n(154),et=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},nt=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},rt=function(){function t(t,e,n,r,i,o,a,s){this.settingsData=t,this.cameraPose=e,this.viewmodeData=n,this.cameraControl=r,this.sweepControl=i,this.switchToMode=o,this.setRestrictedSweeps=a,this.generators=s,this.toIndex=-1,this.type=M.c.Move,this.currentTransitionPromise=null,this.onStopRequested=function(){return Promise.resolve()}}return Object.defineProperty(t.prototype,"active",{get:function(){return null!==this.currentTransitionPromise},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"promise",{get:function(){return this.currentTransitionPromise?this.currentTransitionPromise:Promise.resolve()},enumerable:!0,configurable:!0}),t.prototype.stop=function(){return et(this,void 0,Promise,(function(){return nt(this,(function(t){switch(t.label){case 0:return this.currentTransitionPromise?[4,this.onStopRequested()]:[3,3];case 1:return t.sent(),[4,this.promise];case 2:t.sent(),this.currentTransitionPromise=null,t.label=3;case 3:return[2]}}))}))},t.prototype.start=function(t){var e=this;if(this.active)throw Error("Transition already active");if(!t.snapshot)return this.currentTransitionPromise=Promise.resolve(),this;var n=this.build(t.snapshot,t.currentSweep,t.transitionType).deferred;return this.currentTransitionPromise=n.then((function(){e.currentTransitionPromise=null})),this},t.prototype.build=function(t,e,n){var r=Promise.resolve(),i=t.metadata.camera_mode,o=t.metadata.camera_quaternion,a=t.metadata.scan_id,s=this.cameraPose.rotation,c=Object(w.d)(s,o),u=t.metadata.camera_position,l=!t.is360,h={position:u,rotation:o,sweepID:a,zoom:t.metadata.ortho_zoom};if(i!==this.viewmodeData.currentMode){var f=_t.getOtherModeTransitionTime(this.settingsData,c,n);r=this.switchToMode(i,n,h,f)}else{if(!!a&&this.viewmodeData.isPano())if(!e||a!==e){var p=_t.getTransitionTime(this.settingsData);r=this.standardTransitionSweepMovePromise(h,a,l,p)}else{var d=_t.getSamePanoTransitionTime(this.settingsData,c);r=this.standardTransitionSameSweepRotationPromise(h,c,d)}else r=this.cameraControl.moveTo({transitionType:n,pose:h,transitionTime:_t.getOtherModeTransitionTime(this.settingsData,c,n)}).nativePromise()}return{deferred:r}},t.prototype.standardTransitionSameSweepRotationPromise=function(t,e,n){if(!t.rotation)throw Error("Rotation transition requires a rotation");return e<.01?Promise.resolve():(this.setRestrictedSweeps(null),this.cameraControl.moveTo({transitionType:u.a.Interpolate,pose:{rotation:t.rotation},transitionTime:n}).nativePromise())},t.prototype.standardTransitionSweepMovePromise=function(t,e,n,i){if(!t.position)throw Error("Push transition requires a position");var o=t.position.clone().sub(this.cameraPose.position).normalize(),a=this.cameraPose.position.clone().add(o.multiplyScalar(.15)),s=new F.a;this.setRestrictedSweeps(null);var c=this;return this.generators.startGenerator((function(){var o,l,h,f,p,d,y,m;return nt(this,(function(v){switch(v.label){case 0:return[4,new r.c(c.sweepControl.activateSweepUnsafe({sweepId:e}))];case 1:v.sent(),o=new b.Jc,l=c.cameraPose.position.clone(),h=Date.now(),f=0,p=!1,d=!1,v.label=2;case 2:return f<i?(m=Object(B.f)(f,0,f/i,i),n&&c.cameraControl.updateCameraPosition(o.copy(l).lerp(a,m)),m>=.3&&!d&&(y=c.cameraControl.moveTo({transitionType:u.a.FadeToBlack,pose:t,transitionTime:i,blackoutTime:.5*i}).progress((function(t){t>=.5&&!p&&(c.sweepControl.instantSweepTransition(e),p=!0)})),d=!0),[4,new r.b]):[3,4];case 3:return v.sent(),f=Date.now()-h,[3,2];case 4:return y?[4,new r.c(y.nativePromise())]:[3,6];case 5:v.sent(),v.label=6;case 6:return s.resolve(),[2]}}))})),s.nativePromise()},t}(),it=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},ot=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},at=function(){function t(t,e,n,r){this.moveToSweep=t,this.viewmodeData=e,this.cameraControl=n,this.switchToMode=r,this.toIndex=-1,this.type=M.c.Move,this.currentTransitionPromise=null,this.onStopRequested=function(){return Promise.resolve()}}return Object.defineProperty(t.prototype,"active",{get:function(){return null!==this.currentTransitionPromise},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"promise",{get:function(){return this.currentTransitionPromise?this.currentTransitionPromise:Promise.resolve()},enumerable:!0,configurable:!0}),t.prototype.stop=function(){return it(this,void 0,Promise,(function(){return ot(this,(function(t){switch(t.label){case 0:return this.currentTransitionPromise?[4,this.onStopRequested()]:[3,3];case 1:return t.sent(),[4,this.promise];case 2:t.sent(),this.currentTransitionPromise=null,t.label=3;case 3:return[2]}}))}))},t.prototype.start=function(t){var e=this;if(this.active)throw Error("Transition already active");if(!t.snapshot)return this.currentTransitionPromise=Promise.resolve(),this;var n=this.build(t.snapshot,t.currentSweep).deferred;return this.currentTransitionPromise=n.then((function(){e.currentTransitionPromise=null})),this},t.prototype.build=function(t,e){var n=Promise.resolve(),r=t.metadata.camera_mode,i=t.metadata.camera_quaternion,o=t.metadata.scan_id,a={position:t.metadata.camera_position,rotation:i,sweepID:o,zoom:t.metadata.ortho_zoom},s=r!==this.viewmodeData.currentMode,c=!!o&&this.viewmodeData.isPano();if(s)n=this.switchToMode(r,u.a.Instant,a);else if(c){var l={transitionType:u.a.Instant,sweepId:o,rotation:i};n=this.moveToSweep(l).nativePromise()}else n=this.cameraControl.moveTo({transitionType:u.a.Instant,pose:a}).nativePromise();return{deferred:n}},t}(),st=n(97),ct=n(116),ut=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},lt=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},ht=function(){function t(t,e){this.issueCommand=t,this.currentFloor=e,this.type=M.c.FloorChange,this.toIndex=-1,this.currentTransitionPromise=null,this.onStopRequested=function(){return Promise.resolve()}}return Object.defineProperty(t.prototype,"active",{get:function(){return null!==this.currentTransitionPromise},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"promise",{get:function(){return this.currentTransitionPromise?this.currentTransitionPromise:Promise.resolve()},enumerable:!0,configurable:!0}),t.prototype.stop=function(){return ut(this,void 0,Promise,(function(){return lt(this,(function(t){switch(t.label){case 0:return this.currentTransitionPromise?[4,this.onStopRequested()]:[3,3];case 1:return t.sent(),[4,this.promise];case 2:t.sent(),this.currentTransitionPromise=null,t.label=3;case 3:return[2]}}))}))},t.prototype.start=function(t){var e=this;if(this.active)throw Error("Transition already active");var n=Promise.resolve(),r=t.targetSnapshot.metadata.floor,i=r!==this.currentFloor(),o=t.targetSnapshot.metadata.camera_mode;return o!==a.a.Panorama&&o!==a.a.Outdoor&&i&&(n=this.issueCommand(new ct.a(r,!0))),this.currentTransitionPromise=n.then((function(){e.currentTransitionPromise=null})),this},t}(),ft=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},pt=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},dt=function(){function t(t,e,n){this.settingsData=t,this.rotate=e,this.stopRotating=n,this.type=M.c.Burns,this.toIndex=-1,this.currentTransitionPromise=null,this.onStopRequested=function(){return Promise.resolve()}}return Object.defineProperty(t.prototype,"active",{get:function(){return null!==this.currentTransitionPromise},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"promise",{get:function(){return this.currentTransitionPromise?this.currentTransitionPromise:Promise.resolve()},enumerable:!0,configurable:!0}),t.prototype.stop=function(){return ft(this,void 0,Promise,(function(){return pt(this,(function(t){switch(t.label){case 0:return this.currentTransitionPromise?[4,this.onStopRequested()]:[3,3];case 1:return t.sent(),[4,this.promise];case 2:t.sent(),this.currentTransitionPromise=null,t.label=3;case 3:return[2]}}))}))},t.prototype.start=function(t){var e=this;if(this.active)throw Error("Transition already active");if(!t.snapshot||!t.nextSnapshot)return this.currentTransitionPromise=Promise.resolve(),this;var n=this.build(t.snapshot,t.nextSnapshot,t.panOverrides).deferred;return this.currentTransitionPromise=n.then((function(){e.currentTransitionPromise=null})),this},t.prototype.build=function(t,e,n){var r=this,i=n.panDirection,o=n.panAngle,a=_t.getPanValues(this.settingsData,!0,i,o),s=-1*a.radiansPerMs,c=a.direction;if(void 0!==c&&c!==M.b.Auto)s*=c;else if(t&&t.metadata.camera_quaternion&&e&&e.metadata.camera_quaternion){var u=I.b.FORWARD.clone().applyQuaternion(t.metadata.camera_quaternion),l=I.b.FORWARD.clone().applyQuaternion(e.metadata.camera_quaternion),h=Math.sign(u.cross(l).y);s=0!==h?s*h:s}return this.onStopRequested=function(){return ft(r,void 0,void 0,(function(){return pt(this,(function(t){switch(t.label){case 0:return[4,this.stopRotating()];case 1:return t.sent(),[2]}}))}))},{deferred:this.rotate(a.ms,new b.Ic(s,0))}},t}(),yt=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},mt=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},vt=function(){function t(t,e,n,r,i){this.settingsData=t,this.cameraPose=e,this.rotate=n,this.stopRotating=r,this.getCurve=i,this.type=M.c.Burns,this.toIndex=-1,this.currentTransitionPromise=null,this.onStopRequested=function(){return Promise.resolve()}}return Object.defineProperty(t.prototype,"active",{get:function(){return null!==this.currentTransitionPromise},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"promise",{get:function(){return this.currentTransitionPromise?this.currentTransitionPromise:Promise.resolve()},enumerable:!0,configurable:!0}),t.prototype.stop=function(){return yt(this,void 0,Promise,(function(){return mt(this,(function(t){switch(t.label){case 0:return this.currentTransitionPromise?[4,this.onStopRequested()]:[3,3];case 1:return t.sent(),[4,this.promise];case 2:t.sent(),this.currentTransitionPromise=null,t.label=3;case 3:return[2]}}))}))},t.prototype.start=function(t){var e=this;if(this.active)throw Error("Transition already active");var n=this.build(t.path,t.snapshot,t.nextSnapshot,t.panOverrides).deferred;return this.currentTransitionPromise=n.then((function(){e.currentTransitionPromise=null})),this},t.prototype.build=function(t,e,n,r){var i=this;this.onStopRequested=function(){return yt(i,void 0,void 0,(function(){return mt(this,(function(t){switch(t.label){case 0:return[4,this.stopRotating()];case 1:return t.sent(),[2]}}))}))};var o=r.panDirection,s=r.panAngle,c=_t.getPanValues(this.settingsData,!1,o,s),u=c.direction,l=c.radiansPerMs;if(void 0!==u&&u!==M.b.Auto)l*=u;else if(t){var h=this.cameraPose.position.clone().setY(0),f=t.map((function(t){return t.position})),p=this.getCurve(f).curve.getPointAt(.1).setY(0).clone().sub(h).normalize(),d=I.b.FORWARD.clone().applyQuaternion(this.cameraPose.rotation);l=0!==(y=Math.sign(d.cross(p).y))?l*y:l}else if(n&&e){if(e.metadata.camera_mode!==a.a.Panorama&&(l=-l),e.metadata.scan_id===n.metadata.scan_id){var y;d=I.b.FORWARD.clone().applyQuaternion(this.cameraPose.rotation),p=I.b.FORWARD.clone().applyQuaternion(n.metadata.camera_quaternion);l=0!==(y=Math.sign(d.cross(p).y))?l*y:l}}return{deferred:this.rotate(c.ms,new b.Ic(l,0))}},t}(),gt=n(563),bt=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},wt=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},_t=function(){function t(t,e,n,r,o){var s=this;this.engine=t,this.tourData=e,this.cameraData=n,this.settingsData=r,this.viewmodeData=o,this.useLegacyPan=function(){return!1},this.init=function(){return bt(s,void 0,void 0,(function(){var t,e,n,r,o,a,s,c=this;return wt(this,(function(u){switch(u.label){case 0:return t=this,[4,this.engine.getModule(K.default)];case 1:return t.sweepModule=u.sent(),e=this,[4,this.engine.market.waitForData(Q.a)];case 2:return e.sweepData=u.sent(),n=this,[4,this.engine.getModule(Z.default)];case 3:return n.cameraModule=u.sent(),r=this,[4,this.engine.getModule($.default)];case 4:return r.pathModule=u.sent(),o=this,[4,this.engine.market.waitForData(V.b)];case 5:return o.floorsViewData=u.sent(),a=this,[4,this.engine.getModule(tt.default)];case 6:return a.commonControlsModule=u.sent(),s=this,[4,this.engine.getModule(st.default)];case 7:return s.viewmodeModule=u.sent(),this.smoothWalkingTransition=new X(this.settingsData,this.cameraData.pose,this.cameraData.transition,this.sweepData.transition,this.sweepModule,this.cameraModule,this.engine,this.pathModule.setRestrictedSweeps.bind(this.pathModule),this.pathModule.getCurveForPath.bind(this.pathModule)),this.directWalkingTransition=new H(this.settingsData,this.cameraData.pose,this.sweepModule.moveToSweep.bind(this.sweepModule),this.cameraModule.updateTransitionSpeed.bind(this.cameraModule),this.pathModule.setRestrictedSweeps.bind(this.pathModule),this.engine),this.instantTransition=new at(this.sweepModule.moveToSweep.bind(this.sweepModule),this.viewmodeData,this.cameraModule,this.viewmodeModule.switchToMode.bind(this.viewmodeModule)),this.panTransition=new j(this.settingsData,this.commonControlsModule.startRotateTransition.bind(this.commonControlsModule),this.commonControlsModule.stop.bind(this.commonControlsModule)),this.panLegacyTransition=new vt(this.settingsData,this.cameraData.pose,this.commonControlsModule.startRotateTransition.bind(this.commonControlsModule),this.commonControlsModule.stop.bind(this.commonControlsModule),this.pathModule.getCurveForPath.bind(this.pathModule)),this.panDollhouseTransition=new dt(this.settingsData,this.commonControlsModule.startRotateTransition.bind(this.commonControlsModule),this.commonControlsModule.stop.bind(this.commonControlsModule)),this.defaultTransition=new rt(this.settingsData,this.cameraData.pose,this.viewmodeData,this.cameraModule,this.sweepModule,this.viewmodeModule.switchToMode.bind(this.viewmodeModule),this.pathModule.setRestrictedSweeps.bind(this.pathModule),this.engine),this.zoomTransition=new C(this.settingsData,this.commonControlsModule.startZoomTransition.bind(this.commonControlsModule),this.commonControlsModule.stop.bind(this.commonControlsModule)),this.floorChangeTransition=new ht(this.engine.commandBinder.issueCommand.bind(this.engine.commandBinder),(function(){return c.floorsViewData.currentFloor})),this.delayTransition=new A(this.settingsData),this.useLegacyPan=function(){return c.settingsData.tryGetProperty(i.c,!1)},this.nopTransition={active:!1,type:M.c.Nop,promise:Promise.resolve(),stop:function(){return Promise.resolve()},toIndex:-1},this.pathOrientHelper=new gt.a,[2]}}))}))},this.getValidWalkingPath=function(t){var e=t.metadata.scan_id,n=s.sweepData.currentSweep,r=s.tourData.getTourCurrentSnapshotIndex(),o=null;if(r>=0){var c=s.tourData.getTourSnapshotSid(r);o=s.tourData.getSnapshot(c)}if(s.viewmodeData.currentMode!==a.a.Panorama||!n||!e||e===n||t.is360||!o||o.is360)return null;var u=s.pathModule.findShortestPath(n,e,i.J.walkingTourIncludeExtraPanosDistance,i.J.walkingStageMinimumDistance,i.J.maxWalkingSweepsBetweenSnapshots)||[];return 0===u.length?null:u}}return t.getPanDegrees=function(t,e){var n;return n=i.J.panAtSnapshot?-1!==Object(S.A)("sspa",-1)?i.J.snapshotPanAngle:void 0!==e?e:t.tryGetProperty(x.a.PanAngle,i.p):0,Math.max(n,0)},t.getPanRadiansPerMs=function(t,e,n){if(-1!==Object(S.A)("st",-1))return i.J.snapshotPanZoomDuration>0?n/i.J.snapshotPanZoomDuration:0;var r=e?t.tryGetProperty(x.a.DollhousePanSpeed,i.h):t.tryGetProperty(x.a.PanSpeed,i.q);return Object(T.b)(r)},t.prototype.getFloorTransition=function(t){var e=this.tourData.getTourSnapshotSid(t),n=this.tourData.getSnapshot(e);return n?this.floorChangeTransition.start({targetSnapshot:n}):this.nopTransition},t.prototype.getMainTransition=function(t,e){var n=this.tourData.getTourSnapshotSid(t),r=this.tourData.getSnapshot(n);if(!r)return this.nopTransition;var o=null;if(e===u.a.Interpolate){var a=r.metadata.camera_quaternion,s=this.getValidWalkingPath(r);if(s){var c=s.map((function(t){return t.position})),l=this.pathOrientHelper.getOrientationsForPath(c,Object(w.m)(a));o=s.length>2&&this.settingsData.tryGetProperty(i.d,!1)?this.smoothWalkingTransition.start({path:s,orientations:l}):this.directWalkingTransition.start({path:s,orientations:l})}}else if(e===u.a.Instant){var h=this.sweepData.currentSweep;o=this.instantTransition.start({snapshot:r,currentSweep:h})}if(!o){h=this.sweepData.currentSweep;o=this.defaultTransition.start({snapshot:r,currentSweep:h,transitionType:e})}return o},t.prototype.getBurnsTransition=function(t,e){var n=this.tourData.getTourSnapshotSid(t),r=(t+1)%this.tourData.getSnapshotCount(),i=this.tourData.getTourSnapshotSid(r),o=this.tourData.getHighlightDescription(n),a={};o.reelEntry&&o.reelEntry.overrides&&(a.panDirection=o.reelEntry.overrides.panDirection,a.panAngle=o.reelEntry.overrides.panAngle);var s=this.tourData.getSnapshot(i),c=this.nopTransition;switch(e){case M.a.Pan:if(this.useLegacyPan()&&s){var u=this.getValidWalkingPath(s);c=this.panLegacyTransition.start({path:u,snapshot:o.snapshot,nextSnapshot:s,panOverrides:a})}c===this.nopTransition&&(c=this.panTransition.start({snapshot:o.snapshot,nextSnapshot:s,panOverrides:a}));break;case M.a.PanDollhouse:c=this.panDollhouseTransition.start({snapshot:o.snapshot,nextSnapshot:s,panOverrides:a});break;case M.a.Zoom:c=this.zoomTransition.start();break;case M.a.Delay:c=this.delayTransition.start();break;case M.a.None:c=this.nopTransition;break;default:throw Error("unhandled TourBurnsStyle")}return c},t.useDelayTransition=function(e,n,r){return!i.J.panAtSnapshot||n!==M.a.Zoom&&0===t.getPanDegrees(e,r)},t.getPanDirection=function(t,e){return void 0!==e?e:t.tryGetProperty(x.a.PanDirection,_.e)},t.getDelayDuration=function(t){return-1!==Object(S.A)("st",-1)||0===Object(S.A)("kb",-1)?i.J.snapshotPanZoomDuration:i.k},t.getZoomDuration=function(t){return-1!==Object(S.A)("st",-1)?i.J.snapshotPanZoomDuration:t.tryGetProperty(x.a.ZoomDuration,i.D)},t.getPanValues=function(e,n,r,o){var a=t.getPanDirection(e,r),s=t.getPanDegrees(e,o),c=b.ib.degToRad(s),u=t.getPanRadiansPerMs(e,n,c),l=u>0?c/u:0;return n&&void 0===o&&(l=i.J.snapshotPanZoomDuration),{degrees:s,radiansPerMs:u,ms:l,direction:a}},t.getTransitionSpeed=function(t){if(-1!==Object(S.A)("wts",-1))return t.tryGetProperty(i.e,i.f);var e=t.tryGetProperty(x.a.TransitionSpeed,i.x);return Object(T.a)(e/1e3)},t.getTransitionTime=function(t){var e=t.tryGetProperty(x.a.TransitionTime,i.A);return Math.min(Math.max(i.C,e),i.B)},t.getOtherModeTransitionTime=function(e,n,r){if(r===u.a.FadeToBlack)return t.getTransitionTime(e)+i.o;var o=i.m,a=i.n;if(-1===Object(S.A)("wts",-1)){var s=1e3*t.getTransitionSpeed(e);o=Math.sqrt(2*(s-i.z))+45,s!==i.x&&(a=i.l)}var c=1e3*n/(b.ib.DEG2RAD*o);return Math.max(c,a)},t.getSamePanoTransitionTime=function(t,e){var n=t.tryGetProperty(x.a.PanSpeed,i.q);if(n===i.q)return Math.max(1e3*e/(b.ib.DEG2RAD*i.t),i.v);var r=Object(w.g)(n,i.s,i.r,i.w,i.u),o=Object(T.b)(r);return o>0?e/o:0},t}(),xt=n(58);n.d(e,"FAST_FORWARD_FACTOR",(function(){return Pt}));var St,Tt=(St=function(t,e){return(St=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}St(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),Mt=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},Et=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Pt=5,Ot=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="tours-controls",e.getBurnsStyleForSnapshot=function(t,n,r){var i=t.getTourSnapshotSid(n),o=t.getHighlightDescription(i),s=t.getSnapshotCount();if(!o||!o.snapshot)return M.a.None;var c=o.snapshot.metadata.camera_mode,u=n===s-1,l=o.reelEntry&&o.reelEntry.overrides&&o.reelEntry.overrides.panDirection,h=c===a.a.Dollhouse?M.a.PanDollhouse:c===a.a.Floorplan?M.a.Zoom:M.a.Pan;return _t.useDelayTransition(e.settingsData,h,r)?M.a.Delay:u&&void 0!==l?h:u?M.a.None:h},e.canChangeTourLocation=function(){var t=e.data.getTourState(),n=e.data.isTourTransitionActive(),r=e.cameraData.canTransition();return t===s.b.Inactive&&!n&&!(e.viewmodeData.transition&&e.viewmodeData.transition.active)&&r},e}return Tt(e,t),e.prototype.init=function(t,e){return Mt(this,void 0,void 0,(function(){var t,n,r,i,o=this;return Et(this,(function(a){switch(a.label){case 0:return this.engine=e,t=this,[4,e.market.waitForData(g.a)];case 1:return t.cameraData=a.sent(),n=this,[4,e.market.waitForData(c.a)];case 2:return n.viewmodeData=a.sent(),r=this,[4,e.market.waitForData(v.a)];case 3:return r.settingsData=a.sent(),i=this,[4,e.market.waitForData(s.a)];case 4:return i.data=a.sent(),e.getModule(l.default).then((function(t){t.registerHandler(f.m,(function(){o.handleTourInputInterrupt()})),t.registerHandler(f.q,(function(){o.handleTourInputInterrupt()})),t.registerHandler(p.a,(function(t){t.state===d.a.DOWN&&o.handleTourInputInterrupt()}))})),this.transitionFactory=new _t(e,this.data,this.cameraData,this.settingsData,this.viewmodeData),[4,this.transitionFactory.init()];case 5:return a.sent(),this.setupAutoPlay(e),this.bindings.push(e.subscribe(h.d,(function(){o.data.setTourTransitionToIndex(-1)})),e.subscribe(h.f,(function(){o.data.setTourTransitionToIndex(-1)}))),[2]}}))}))},e.prototype.handleTourInputInterrupt=function(){this.data.getTourState()!==s.b.Inactive&&this.stopTour()},e.prototype.canTourProceed=function(t,e,n){var r=this.data.getSnapshotCount();if(0===r||0===n||this.data.getTourState()!==s.b.Inactive)return!1;if(void 0!==e){if(e<-1)return!1;if(!0!==t&&e>r-1)return!1}return!0},e.prototype.shouldTourContinue=function(t,e,n,r){return void 0!==r?n<r:e<t-1},e.prototype.startTour=function(t,e,n){var i=void 0!==n?n:this.data.isLooping();if(this.canTourProceed(i,t,e)){var o,a=this.data.getSnapshotCount(),c=this.data.getTourCurrentSnapshotIndex(),u=0;o=void 0!==t?t-1:c>=a-1?-1:c;var l=this.settingsData.tryGetProperty(xt.a,null);this.settingsData.setProperty(xt.a,null);var f=this;this.tourGenerator=function(){var t,n;return Et(this,(function(s){switch(s.label){case 0:return f.shouldTourContinue(a,o,u,e)?(t=o+1,n=f.composeTourTransition(t),[4,new r.c(n)]):[3,2];case 1:return s.sent(),(o=t)===a-1&&i&&(o=-1),u++,[3,0];case 2:return f.stopTour(),f.settingsData.setProperty(xt.a,l),[2]}}))},this.engine.startGenerator(this.tourGenerator),this.data.setTourState(s.b.Active),this.data.tourEnded=!1,this.data.tourPlaying=!0,this.engine.broadcast(new h.c)}},e.prototype.composeTourTransition=function(t,e,n){return Mt(this,void 0,void 0,(function(){var r,i,o,c,l,f,p,d,y,m,v,g,b,w;return Et(this,(function(x){switch(x.label){case 0:if(r=this.data.getTourSnapshotSid(t),!(i=this.data.getHighlightDescription(r)).snapshot)throw Error("Highlight not found for reel index "+t);return o=this.settingsData.tryGetProperty(_.a,u.a.Interpolate),c=i.snapshot.metadata.camera_mode,l=c===a.a.Dollhouse||c===a.a.Floorplan,f=!this.viewmodeData.isPano()&&c===a.a.Panorama,p=this.viewmodeData.isPano()&&l,d=!this.viewmodeData.isPano()&&l,y=this.viewmodeData.isPano()&&c===a.a.Panorama,m=null,(f||p||d)&&(o=u.a.Interpolate),y&&0===t&&(o=u.a.FadeToBlack),i.reelEntry&&i.reelEntry.overrides&&(void 0!==i.reelEntry.overrides.transitionType&&(o=i.reelEntry.overrides.transitionType),void 0!==i.reelEntry.overrides.panAngle&&(m=i.reelEntry.overrides.panAngle)),void 0!==n&&(o=n),this.data.setTourTransitionToIndex(t),this.engine.broadcast(new h.b),v=this.transitionFactory.getFloorTransition(t),this.data.useTransition(v),[4,v.promise];case 1:return x.sent(),this.data.getTourState()===s.b.StopScheduled?[2]:(g=this.transitionFactory.getMainTransition(t,o),this.data.useTransition(g),[4,g.promise]);case 2:return x.sent(),this.data.setTourCurrentSnapshotByIndex(t),this.engine.broadcast(new h.d(t)),this.data.getTourState()===s.b.StopScheduled?[2]:(b=e||this.getBurnsStyleForSnapshot(this.data,t,null!==m?m:void 0),w=this.transitionFactory.getBurnsTransition(t,b),this.data.useTransition(w),[4,w.promise]);case 3:return x.sent(),[2]}}))}))},e.prototype.stopTour=function(){return Mt(this,void 0,Promise,(function(){return Et(this,(function(t){switch(t.label){case 0:return this.data.getTourState()!==s.b.Active?[3,2]:(this.data.setTourState(s.b.StopScheduled),this.data.tourPlaying=!1,[4,this.data.stopTourTransition()]);case 1:t.sent(),this.tourGenerator&&this.engine.stopGenerator(this.tourGenerator),this.engine.broadcast(new h.f),this.data.getTourCurrentSnapshotIndex()!==this.data.getSnapshotCount()-1||this.data.isLooping()||(this.data.tourEnded=!0,this.engine.broadcast(new h.a)),this.data.setTourState(s.b.Inactive),t.label=2;case 2:return[2]}}))}))},e.prototype.tourGoNext=function(t){return Mt(this,void 0,Promise,(function(){var e,n;return Et(this,(function(r){return(e=this.data.getTourCurrentSnapshotIndex()+1)>=this.data.getSnapshotCount()&&(e=0),n=t?u.a.Instant:void 0,[2,this.tourGoTo(e,n)]}))}))},e.prototype.tourGoPrevious=function(t){return Mt(this,void 0,Promise,(function(){var e,n,r;return Et(this,(function(i){return(e=this.data.getTourCurrentSnapshotIndex())<0&&(e=0),(n=e-1)<0&&(n=this.data.getSnapshotCount()-1),r=t?u.a.Instant:void 0,[2,this.tourGoTo(n,r)]}))}))},e.prototype.tourGoTo=function(t,e){return void 0===e&&(e=u.a.FadeToBlack),Mt(this,void 0,Promise,(function(){var n;return Et(this,(function(r){switch(r.label){case 0:if(this.viewmodeData.transition&&this.viewmodeData.transition.active)return[2,Promise.reject("Cannot go to tour location during viewmode transition")];if(this.data.getTourState()!==s.b.Inactive)return[2,Promise.reject("tourGoTo() -> Cannot jump to tour location while tour is active.")];r.label=1;case 1:return r.trys.push([1,3,4,5]),this.data.setTourState(s.b.Active),[4,this.composeTourTransition(t,M.a.None,e)];case 2:return r.sent(),[3,5];case 3:return n=r.sent(),this.log.error(n),[3,5];case 4:return this.data.setTourState(s.b.Inactive),[7];case 5:return[2]}}))}))},e.prototype.setupAutoPlay=function(t){var e=this,n=1e3*i.J.autoStartDelay,r=function(){var t=!0,r=e.cameraData.pose.onChanged((function(){t=!1,r.cancel()}));setTimeout((function(){t&&e.startTour(),r.cancel()}),n)};if(n>=0){var o=t.market.tryGetData(y.c);if(o&&o.phase===y.a.PLAYING)r();else{var a=function(e){e.phase===y.a.PLAYING&&(r(),t.unsubscribe(m.a,a))};t.subscribe(m.a,a)}}},e}(o.a);e.default=Ot},function(t,e,n){"use strict";n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return u}));var r,i=n(44),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e){void 0===e&&(e="Api Exception");var n=t.call(this,e)||this;return n.name="ApiException",n}return o(e,t),e}(i.a),s=function(t){function e(e){void 0===e&&(e="Unauthorized");var n=t.call(this,e)||this;return n.name="Unauthorized",n}return o(e,t),e}(a),c=function(t){function e(e){void 0===e&&(e="Forbidden");var n=t.call(this,e)||this;return n.name="Forbidden",n}return o(e,t),e}(a),u=function(t){function e(e){void 0===e&&(e="Not Found");var n=t.call(this,e)||this;return n.name="NotFound",n}return o(e,t),e}(a);!function(t){function e(e){void 0===e&&(e="Not Found");var n=t.call(this,e)||this;return n.name="BadRequest",n}o(e,t)}(a)},function(t,e,n){"use strict";n.d(e,"b",(function(){return E})),n.d(e,"d",(function(){return P})),n.d(e,"c",(function(){return O})),n.d(e,"a",(function(){return A}));var r,i=n(5),o=n(241),a=n(10),s=n(32),c=n(343),u=n(53),l=n(2),h=n(460),f=n(454),p=n(455),d=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),y=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},m=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},v=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},g=new l.a("tours"),b=function(){function t(){}return t.prototype.validateInput=function(t){return void 0!==t.index&&isNaN(t.index)&&(g.warn(t.index,"is not a valid number"),t.index=void 0),void 0!==t.steps&&isNaN(t.steps)&&(g.warn(t.steps,"is not a valid number"),t.steps=void 0),t},t.prototype.exec=function(t,e,n,r){if(0===r.getSnapshotCount())throw Error("No tour data found");if(!n.canChangeTourLocation())throw Error("TourStart ignored, cannot change location at this time, another transition is active");try{n.startTour(t.index,t.steps,t.loop)}catch(t){throw g.warn(t),Error("Error occurred while starting tour - "+t)}e.onComplete()},t}(),w=function(t,e){e.addBinding(M,(function(){return y(void 0,void 0,void 0,(function(){return m(this,(function(e){return[2,Promise.all([t.market.waitForData(u.a)]).then((function(t){var e=v(t,1)[0],n=[];if(e.iterateSnapshots((function(t){n.push(T(t))})),0===n.length)throw Error("No tour data found");return n}))]}))}))}))},_=function(t,e){t.addBinding(P,(function(){return y(void 0,void 0,void 0,(function(){var t;return m(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e.stopTour()];case 1:return n.sent(),[3,3];case 2:throw t=n.sent(),g.warn(t),Error("Error occurred while stopping tour - "+t);case 3:return[2]}}))}))}))},x=function(t,e){t.addBinding(O,(function(t){return y(void 0,void 0,void 0,(function(){var n;return m(this,(function(r){try{if(e.canChangeTourLocation())return n=t.instant?a.a.Instant:void 0,[2,e.tourGoTo(t.index,n)];g.warn("TourStep ignored, cannot change location at this time, another transition is active")}catch(t){throw g.warn(t),Error("Error occurred while jumping to new tour location - "+t)}return[2]}))}))}))},S=function(t,e){t.addBinding(A,(function(t){return y(void 0,void 0,void 0,(function(){var n;return m(this,(function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),e.canChangeTourLocation()?[4,t.forward?e.tourGoNext(t.instant):e.tourGoPrevious(t.instant)]:[3,2];case 1:return r.sent(),[3,3];case 2:g.warn("TourNext ignored, cannot change location at this time, another transition is active"),r.label=3;case 3:return[3,5];case 4:throw n=r.sent(),g.warn(n),Error("Error while trying to travel to the next tour snapshot - "+n);case 5:return[2]}}))}))}))},T=function(t){var e=s.d[t.metadata.camera_mode];if(!e||e===s.b.TRANSITIONING)throw Error("Failed to convert snapshot, invalid viewmode");return e===s.b.INSIDE&&t.is360&&(e=s.b.OUTSIDE),{sid:t.sid,thumbnailUrl:t.thumbnailUrl,imageUrl:t.imageUrl,is360:t.is360,name:t.name,mode:e,zoom:t.metadata.ss_zoom,position:t.metadata.camera_position,rotation:Object(c.b)(t.metadata.camera_quaternion)}},M=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.id="GET_TOUR_DATA",e}return d(e,t),e}(i.a),E=function(t){function e(e,n,r){var i=t.call(this)||this;return i.id="TOUR_START",i.payload={index:e,loop:n,steps:r},i}return d(e,t),e}(i.a),P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.id="TOUR_STOP",e}return d(e,t),e}(i.a),O=function(t){function e(e,n){void 0===n&&(n=!1);var r=t.call(this)||this;return r.id="TOUR_STEP",r.payload={index:e,instant:n},r}return d(e,t),e}(i.a),A=function(t){function e(e,n){void 0===n&&(n=!1);var r=t.call(this)||this;return r.id="TOUR_STEP",r.payload={forward:e,instant:n},r}return d(e,t),e}(i.a);e.e=function(t,e,n){Promise.all([t.getModule(o.default)]).then((function(t){var n=v(t,1)[0];_(e,n),x(e,n),S(e,n)})),w(t,e),n.addCommandToInterface({version:"3.x",namespace:"Tour",name:"stop",args:[]},(function(){return new P})),n.addCommandToInterface({version:"3.x",namespace:"Tour",name:"step",args:["index"]},(function(t){return new O(t.index)})),n.addCommandToInterface({version:"3.x",namespace:"Tour",name:"getData",args:[]},(function(){return new M})),n.addCommandToInterface({version:"3.x",namespace:"Tour",name:"next",args:[]},(function(){return new A(!0)})),n.addCommandToInterface({version:"3.x",namespace:"Tour",name:"prev",args:[]},(function(){return new A(!1)}));var r=h.a.create(new f.a(t.getModule(o.default),t.market.waitForData(u.a)),new p.a(b));n.addCommand({namespace:"Tour",name:"start",args:["index"],version:"3.0"},r),e.addBinding(E,(function(t){return y(void 0,void 0,void 0,(function(){var e=this;return m(this,(function(n){return[2,new Promise((function(n,i){return y(e,void 0,void 0,(function(){return m(this,(function(e){switch(e.label){case 0:return[4,r];case 1:return e.sent().exec(t,{onComplete:function(){n()}}),[2]}}))}))}))]}))}))}))}},function(t,e,n){"use strict";n.d(e,"b",(function(){return l})),n.d(e,"a",(function(){return h}));var r,i=n(23),o=n(238),a=n(84),s=n(20),c=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),u=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},l=function(t){return t?(new o.a).copy(t):new o.a},h=function(t){function e(e){var n,r,i=t.call(this)||this;if(i.name="label",i.getLabel=function(t){return i.map.get(t)},i.map=Object(a.b)(),e)try{for(var o=u(e),s=o.next();!s.done;s=o.next()){var c=s.value;i.map.set(c.sid,c)}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i}return c(e,t),e.prototype.add=function(t){for(var e=t.sid;!e||this.map.has(e);)e=Object(s.m)(11);t.sid=e,this.map.set(e,t)},e.prototype.remove=function(t){return!!this.map.has(t)&&(this.map.delete(t),!0)},e.prototype.clear=function(){var t,e;try{for(var n=u(this.map.keys),r=n.next();!r.done;r=n.next()){var i=r.value;this.map.delete(i)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},e.prototype.getCollection=function(){return this.map},e.prototype.iterate=function(t){var e,n;try{for(var r=u(this.map.keys),i=r.next();!i.done;i=r.next()){var o=i.value;t(this.map.get(o),o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},e.prototype.isEqual=function(t){var n,r;if(this.map.length!==t.map.length)return!1;try{for(var i=u(this.map),o=i.next();!o.done;o=i.next()){var a=o.value,s=t.map.get(a.sid);if(!s||!e.labelsAreEqual(a,s))return!1}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return!0},e.labelsAreEqual=function(t,e){return t.floor===e.floor&&t.position.x===e.position.x&&t.position.y===e.position.y&&t.position.z===e.position.z&&t.sid===e.sid&&t.text===e.text&&t.visible===e.visible},e.prototype.copy=function(t){var e,n;this.map=Object(a.b)();try{for(var r=u(t.map),i=r.next();!i.done;i=r.next()){var o=i.value,s=l(o);this.map.set(s.sid,s)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return this},e.prototype.clone=function(){return(new e).copy(this)},e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return s})),n.d(e,"c",(function(){return c}));var r,i=n(9),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n){var r=t.call(this)||this;return r.sweepId=e,r.position=n,r}return o(e,t),e}(i.a),s=function(t){function e(e){var n=t.call(this)||this;return n.sweepId=e,n}return o(e,t),e}(i.a),c=function(t){function e(e,n,r){var i=t.call(this)||this;return i.sweepId=e,i.numSweeps=n,i.numDisabledSweeps=r,i}return o(e,t),e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return f})),n.d(e,"b",(function(){return p})),n.d(e,"c",(function(){return d}));var r,i=n(41),o=n(2),a=n(139),s=n(30),c=n(69),u=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=function(){return(l=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},h=new o.a("active-reel"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.reel=Object(a.b)([]),e.modified=new Date(0),e}return u(e,t),e}(c.a),p=function(t){if(!t)return null;var e=new f;return t.active_reel&&t.active_reel.modified&&(e.modified=Object(i.b)(t.active_reel.modified)),t.active_reel&&t.active_reel.reel&&t.active_reel.reel instanceof Array?(h.info("Reel has "+t.active_reel.reel.length+" items"),e.reel.replace(t.active_reel.reel)):h.info("No reel found"),e.commit(),e},d=function(t,e){var n=t.modified;e&&e.modified&&(n=e.modified);var r=Object(s.a)(t&&t.reel?t.reel:[]),o=e&&e.reel?e.reel:new a.a;Object(s.e)(r,Object(s.a)(o));var c=[];for(var u in r){var h=r[u];if(h){var f=void 0,p={};h.overrides&&(void 0!==h.overrides.panDirection&&(p=l({},p,{panDirection:h.overrides.panDirection})),void 0!==h.overrides.panAngle&&(p=l({},p,{panAngle:h.overrides.panAngle})),void 0!==h.overrides.transitionType&&(p=l({},p,{transitionType:h.overrides.transitionType}))),f=Object.keys(p).length>0?{sid:h.sid,overrides:p}:{sid:h.sid},c.push(f)}}return{active_reel:{reel:c,modified:Object(i.a)(n)}}}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){var r=n(468),i=n(470);t.exports=function(t){return r(i(t))}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,n){var r=n(226),i=n(471),o=n(287),a=n(380),s=Object.defineProperty;e.f=r?s:function(t,e,n){if(o(t),e=a(e,!0),o(n),i)try{return s(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){"use strict";var r=n(489)();t.exports=function(t){return t!==r&&null!==t}},function(t,e,n){"use strict";(function(e,r){var i=n(228).Buffer,o=e.crypto||e.msCrypto;o&&o.getRandomValues?t.exports=function(t,n){if(t>65536)throw new Error("requested too many random bytes");var a=new e.Uint8Array(t);t>0&&o.getRandomValues(a);var s=i.from(a.buffer);if("function"==typeof n)return r.nextTick((function(){n(null,s)}));return s}:t.exports=function(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}}).call(this,n(144),n(169))},function(t,e,n){var r=n(230).Buffer;function i(t,e){this._block=r.alloc(t),this._finalSize=e,this._blockSize=t,this._len=0}i.prototype.update=function(t,e){"string"==typeof t&&(e=e||"utf8",t=r.from(t,e));for(var n=this._block,i=this._blockSize,o=t.length,a=this._len,s=0;s<o;){for(var c=a%i,u=Math.min(o-s,i-c),l=0;l<u;l++)n[c+l]=t[s+l];s+=u,(a+=u)%i==0&&this._update(n)}return this._len+=o,this},i.prototype.digest=function(t){var e=this._len%this._blockSize;this._block[e]=128,this._block.fill(0,e+1),e>=this._finalSize&&(this._update(this._block),this._block.fill(0));var n=8*this._len;if(n<=4294967295)this._block.writeUInt32BE(n,this._blockSize-4);else{var r=(4294967295&n)>>>0,i=(n-r)/4294967296;this._block.writeUInt32BE(i,this._blockSize-8),this._block.writeUInt32BE(r,this._blockSize-4)}this._update(this._block);var o=this._hash();return t?o.toString(t):o},i.prototype._update=function(){throw new Error("_update must be implemented by subclass")},t.exports=i},function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var r=n(0),i=n(1),o=n(6),a=n(2),s=n(7),c=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},u=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(c(arguments[e]));return t},l=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},h=new a.a("navurl"),f=function(){function t(){}return t.encodeVector3=function(e,n){void 0===n&&(n=2);var r=e.x,i=e.y,o=e.z;return t.packFloats([r,i,o],n)},t.decodeVector3=function(e){var n=t.unpackFloats(e,3);return n?new(r.Jc.bind.apply(r.Jc,u([void 0],n))):null},t.encodeQuaternion=function(e,n){return void 0===n&&(n=2),t.packFloats([e.x,e.y,e.z,e.w],n)},t.decodeQuaternion=function(e){var n=t.unpackFloats(e,4);return n?new(r.Pb.bind.apply(r.Pb,u([void 0],n))):null},t.encodeEuler=function(e,n){return void 0===n&&(n=2),t.packFloats([e.x,e.y,e.z],n)},t.decodeEuler=function(e){var n=t.unpackFloats(e,3);return n?new r.A(n[0],n[1],n[2],"XYZ"):void 0},t.packFloats=function(t,e){void 0===e&&(e=2);var n=t.map((function(t){var n=parseFloat(t.toFixed(e)).toString().replace(/^(\-)?0+.(\d+)/,"$1.$2");return"0"===n?"":n})).join(",");return n=n.replace(/,+$/,"")},t.unpackFloats=function(t,e){void 0===e&&(e=0);var n=t.split(",").map((function(t){return""===t?0:parseFloat(t)}));if(!n||n.includes(NaN))return[];for(;n.length<e;)n.push(0);return n},t.getQueryString=function(e,n){void 0===n&&(n=!0);var r=t.serialize(e,n);return Object.keys(r).map((function(t){return t+"="+r[t]})).join("&")},t.serialize=function(e,n){void 0===n&&(n=!0);var r=t.removeNavigationKeys(o.s());if(n)Object.assign(r,t.getShortPose(e));else{var i=t.getStartPose(e);Object.assign(r,{start:encodeURIComponent(JSON.stringify(i))})}return r},t.deserialize=function(e){var n=o.s(e);return"start"in n?t.parseStartObject(n.start):t.parseShortUrl(n)},t.removeNavigationKeys=function(t){var e,n,r=Object.assign({},t);try{for(var i=l(["start","sm","sp","sq","sr","ss","sf","sz"]),o=i.next();!o.done;o=i.next()){delete r[o.value]}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r},t.parseShortUrl=function(e){var n=e.sm,o=e.sp,a=e.sq,c=e.sr,u=e.ss,l=e.sf,f=e.sz,p=n?parseInt(n,10):i.a.Panorama,d=t.decodeEuler(c||"")||new r.A(0,0,0),y=t.decodeQuaternion(a||"")||new r.Pb(0,0,0,1),m=o?t.decodeVector3(o):void 0,v=u?parseInt(u,10)-1:void 0,g=l?t.unpackFloats(l,4):void 0,b=f?parseFloat(f):void 0;if(p===i.a.Panorama&&void 0===v)return null;if(p!==i.a.Panorama&&!m)return null;var w=a?y:(new r.Pb).setFromEuler(d);p===i.a.Panorama&&(w=Object(s.m)(w));var _={mode:p,quaternion:w,position:m||void 0,sweepIndex:v,floorVisibility:g,zoom:b};return h.debug("Parsed short URL pose data:",_),_},t.parseStartObject=function(t){var e;try{e=JSON.parse(decodeURIComponent(t))}catch(e){return h.debug("Failed to parse &start param: "+t),null}try{if(!e.camera_quaternion)throw Error("Start override is missing camera_quaternion");if(!e.camera_position)throw Error("Start override is missing camera_position");if(!e.camera_mode)throw Error("Start override is missing camera_mode");var n=(new r.Pb).copy(e.camera_quaternion),i={mode:e.camera_mode,panoId:e.scan_id,position:(new r.Jc).copy(e.camera_position),quaternion:n,zoom:e.ortho_zoom,floorVisibility:e.floor_visibility};return h.debug("Parsed &start URL pose data:",i),i}catch(t){h.debug(t)}return null},t.getShortPose=function(e){var n=e.cameraData,o=e.viewmodeData,a=e.floorsViewData,s=e.sweepData,c=(new r.A).setFromQuaternion(n.pose.rotation,"XYZ"),u=s.currentSweepIndex,l={};if(o.currentMode===i.a.Panorama)c.z=0,l.sr=t.encodeEuler(c),void 0!==u&&(l.ss=u+1);else{l.sm=o.currentMode||void 0,l.sr=t.encodeEuler(c),l.sp=t.encodeVector3(n.pose.position);var f=a.getFloorsVisibility();f.length&&a.totalFloors>1&&(l.sf=f)}return o.currentMode===i.a.Floorplan&&(l.sz=parseFloat(n.zoom().toFixed(2))),l.sq=t.encodeQuaternion(n.pose.rotation),h.debug("Short URL params for current location "+JSON.stringify(l)),delete l.sq,l},t.getStartPose=function(t){var e=t.cameraData,n=t.viewmodeData,r=t.floorsViewData,o=t.sweepData,a={x:0,y:0,z:0,w:1};a.x=e.pose.rotation.x,a.y=e.pose.rotation.y,a.z=e.pose.rotation.z,a.w=e.pose.rotation.w;var s={x:0,y:0,z:0};s.x=e.pose.position.x,s.y=e.pose.position.y,s.z=e.pose.position.z;var c={camera_mode:n.currentMode,camera_position:s,camera_quaternion:a};return n.currentMode===i.a.Panorama?c.scan_id=o.currentSweep:c.floor_visibility=r.getFloorsVisibility(),n.currentMode===i.a.Floorplan&&(c.ortho_zoom=e.zoom()),c},t}()},function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return s}));var r,i=n(101),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e){var n=t.call(this)||this;return n.pinchDelta=e,n}return o(e,t),e}(i.a),s=function(t){function e(e,n){var r=t.call(this,e)||this;return r.timeSinceLastMove=n,r}return o(e,t),e}(a)},function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return s}));var r,i=n(101),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e){var n=t.call(this)||this;return n.rotateDelta=e,n}return o(e,t),e}(i.a),s=function(t){function e(e,n){var r=t.call(this,e)||this;return r.timeSinceLastMove=n,r}return o(e,t),e}(a)},function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return c}));var r,i=n(101),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(){return(a=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},s=function(t){function e(e,n,r){var i=t.call(this)||this;return i.pointerCount=e,i.position=a({},n),i.delta=a({},r),i}return o(e,t),e}(i.a),c=function(t){function e(e,n,r,i){var o=t.call(this,e,n,r)||this;return o.timeSinceLastMove=i,o}return o(e,t),e}(s)},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r,i=n(23),o=n(0),a=n(38),s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},u=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},l=function(t){function e(e){var n,r,i=t.call(this)||this;if(i.name="rooms",i.selected=new a.a(null),i.floorToRoomsMap=new Map,i._bbox=new o.h,i.addRoomToMaps=function(t,e){e._rooms[t.id]=t;var n=e.floorToRoomsMap.get(t.floorId);n?n.push(t):e.floorToRoomsMap.set(t.floorId,[t])},i.rooms=function(){var t=i._rooms,e=Object.keys(i._rooms);return function(){var n,r,i,o,a,s;return c(this,(function(c){switch(c.label){case 0:c.trys.push([0,5,6,7]),i=u(e),o=i.next(),c.label=1;case 1:return o.done?[3,4]:(a=o.value,[4,t[a]]);case 2:c.sent(),c.label=3;case 3:return o=i.next(),[3,1];case 4:return[3,7];case 5:return s=c.sent(),n={error:s},[3,7];case 6:try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}return[7];case 7:return[2]}}))}()},i.get=function(t){return i._rooms["room-"+t]},i.roomIdsFromPoint=function(t){var e,n,r=[];try{for(var o=u(i.rooms()),a=o.next();!a.done;a=o.next()){var s=a.value;i._bbox.min.set(s.min.x,s.min.y,s.min.z),i._bbox.max.set(s.max.x,s.max.y,s.max.z),i._bbox.containsPoint(t)&&r.push(s.index)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return r},i._rooms={},e)try{for(var s=u(Object.keys(e)),l=s.next();!l.done;l=s.next()){var h=l.value;i.addRoomToMaps(e[h],i)}}catch(t){n={error:t}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return i}return s(e,t),e.prototype.copy=function(t){var e,n;this._rooms={},this.floorToRoomsMap.clear();try{for(var r=u(t.rooms()),i=r.next();!i.done;i=r.next()){var o=i.value,a={id:o.id,floorId:o.floorId,min:o.min,max:o.max,mesh:o.mesh,index:o.index};this.addRoomToMaps(a,this),this._rooms[o.id]=a}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return this},Object.defineProperty(e.prototype,"roomCount",{get:function(){return Object.keys(this._rooms).length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"floorCount",{get:function(){return this.floorToRoomsMap.size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"collection",{get:function(){return this._rooms},enumerable:!0,configurable:!0}),e.prototype.roomsByFloor=function(t){return this.floorToRoomsMap.get(t)||[]},e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r="features/sweep_pucks"},function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"c",(function(){return c})),n.d(e,"b",(function(){return u}));var r,i=n(5),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(){return(a=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},s=function(t){function e(e,n,r){var i=t.call(this)||this;return i.id="ADD_MATTERTAG",i.payload=a({},e,n,r),i}return o(e,t),e}(i.a),c=function(t){function e(e){var n=t.call(this)||this;return n.id="DELETE_MATTERTAG",n.payload={sid:e},n}return o(e,t),e}(i.a),u=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.payload={sid:e,options:a({},n,r,i)},o}return o(e,t),e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(367),i=n(254),o=n(129),a=function(){function t(t){this.modelSID=t.model,this.capabilites={links:{enable:t.supportLinks,keepLabels:t.keepLinkLabels}}}return t.prototype.parse=function(t){var e=this,n=[];return t?(t.split("[").map((function(t,e){return 0===e?t:"["+t})).forEach((function(t){var r=e.findLink(t);r?-1===r.url.indexOf("javascript:")&&(e.addLinkChunk(n,r),e.addTextChunk(n,t.slice(r.markdown.length))):e.addTextChunk(n,t)})),n):[]},t.prototype.findLink=function(t){var e=t.match(/\[([^\]]*)\]\((.*)\)/);if(!e)return null;for(var n=e[2],r=1,i=0;i<n.length&&("("===n[i]?r++:")"===n[i]&&r--,0!==r);)i++;var o=n.length-i;return{markdown:e[0].substring(0,e[0].length-o),label:e[1],url:this.conditionallyEncode(e[2].substring(0,i))}},t.prototype.conditionallyEncode=function(t){return this.needsEncoding(t)?encodeURI(t):t},t.prototype.needsEncoding=function(t){return!!t.match(/([#\s\{\}\"\']|[^\x00-\x7F]|%[^0-9a-fA-F]{2})+/g)||(decodeURI(t),!1)},t.prototype.addTextChunk=function(t,e){0!==e.length&&t.push({type:o.a.text,text:e})},t.prototype.addLinkChunk=function(t,e){if(this.capabilites.links.enable){var n={label:e.label,url:e.url,type:r.a.EXT_LINK};-1===n.url.indexOf("://")&&(n.url="http://"+n.url);var a=-1!==n.url.indexOf("matterport.com/show"),s=-1!==n.url.indexOf(window.location.host+"/show");if(a||s){var c=-1!==n.url.indexOf(this.modelSID),u=i.a.deserialize(n.url);c&&u?(n.type=r.a.NAVIGATION,n.navigationData=u):(n.type=r.a.MODEL,n.url+="&play=1")}t.push({type:o.a.link,link:n})}else this.capabilites.links.keepLabels&&this.addTextChunk(t,e.label)},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=function(t,e){if(0!==t.length)for(var n=0;n<t.length;n++){t[n]===e&&t.splice(n,1)}}},function(t,e,n){"use strict";n.r(e);var r,i=n(137),o=n(93),a=n(8),s=n(225),c=n(0),u=n(80),l=n(81),h={tags:{uniforms:{opacity:{type:"f",value:1},color:{type:"c",value:new c.s},bg:{type:"t",value:null},mask:{type:"t",value:null}},vertexShader:l+n(402),fragmentShader:u+n(871)}},f=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),p=function(t){function e(e,n,r,i){var o=c.Bc.clone(h.tags.uniforms);return o.bg.value=n,o.mask.value=r,o.color.value.copy(e),o.opacity.value=i,t.call(this,{fragmentShader:h.tags.fragmentShader,vertexShader:h.tags.vertexShader,uniforms:o,name:"DiscMaterial",transparent:!0,depthWrite:!1})||this}return f(e,t),e}(c.cc),d=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),y=new c.V({linewidth:o.c.mattertags.pole.width,color:o.c.mattertags.pole.color,opacity:o.c.mattertags.pole.opacity,transparent:!0,alphaTest:o.c.mattertags.pole.opacity*o.c.mattertags.visibility.alphaTestLevel}),m=function(t){function e(e,n){var r=this,i=new c.m,o=new Float32Array(6);return o[0]=o[1]=o[2]=0,o[3]=e.x,o[4]=e.y,o[5]=e.z,i.setAttribute("position",new c.l(o,3)),(r=t.call(this,i,y)||this).geometry=i,r.layers.mask=n.mask,r}return d(e,t),e.prototype.dispose=function(){this.geometry.dispose()},e}(c.T),v=n(7),g=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),b=function(t){function e(e,n,r,i,o){var a=t.call(this)||this;a.position.copy(e.anchorPosition);var c=new p(e.color,n,r,1);return a.disc=new s.a(e.sid,i,c,o),a.disc.position.copy(e.stemVector),a.pole=new m(e.stemVector,o),a.add(a.disc),a.add(a.pole),a}return g(e,t),e.prototype.dispose=function(){this.remove(this.disc),this.remove(this.pole),this.disc.material.dispose(),this.disc.dispose(),this.pole.dispose()},e.prototype.changeDiscPosition=function(t){var e=this.pole.geometry.getAttribute("position");e.setXYZ(1,t.x,t.y,t.z),e.needsUpdate=!0,this.disc.position.copy(t)},e.prototype.changeColor=function(t){this.disc.changeColor(t)},e.prototype.setDimmed=function(t){t=Object(v.e)(t,0,1),this.disc.material.uniforms.opacity.value=t,this.pole.material.opacity=t},e.prototype.setVisibility=function(t){this.disc.visible=t,this.visible=t},e.prototype.changePosition=function(t){this.position.copy(t)},e.prototype.setStemVisibility=function(t){this.pole.visible=t},e.prototype.update=function(t,e,n,r,i){this.disc.update(t,e,n,r,i)},e}(c.zb),w=n(48),_=n(43),x=n(29),S=n(591),T=n.n(S),M=n(592),E=n.n(M),P=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},O=function(){function t(t,e,n,r,i,o,a){void 0===r&&(r=_.a.ALL);var s=this;this.scene=t,this.input=e,this.camera=n,this.layer=r,this.mattertagData=i,this.mattertagsViewData=o,this.canvas=a,this.tagToMesh={},this.meshToTag={},this.textures={mask:Object(w.a)(T.a),background:Object(w.a)(E.a)},this.geometry=new c.Ib(1,1),this.bindings=[],this.disposeTag=function(t){var e=s.tagToMesh[t];e&&(s.input.unregisterMesh(e.disc),delete s.tagToMesh[t],delete s.meshToTag[e.id],e.dispose())},this.createTagMesh=function(t){var e=new b(t,s.textures.background,s.textures.mask,s.geometry,s.layer);return s.tagToMesh[t.sid]=e,s.meshToTag[e.id]=t.sid,e},this.addNewTagMesh=function(t){var e=s.createTagMesh(t);e.visible=!0,s.addTagToScene(e)},this.removeTagMesh=function(t){s.disposeTag(t)},this.updateTagMesh=function(t,e){var n=s.mattertagData.getTag(t);if(n){var r=s.tagToMesh[t];r&&(r.changePosition(n.anchorPosition),r.changeColor(n.color),r.setVisibility(n.enabled&&e),r.changeDiscPosition(n.stemVector),r.setStemVisibility(n.stemVisible))}}}return t.prototype.init=function(){var t=this;this.mattertagData.iterate((function(e){var n=t.createTagMesh(e);e.enabled||n.setVisibility(!1),n.setStemVisibility(e.stemVisible)}))},t.prototype.dispose=function(){var t,e;for(var n in this.tagToMesh)this.disposeTag(n);try{for(var r=P(this.bindings),i=r.next();!i.done;i=r.next()){i.value.cancel()}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}this.bindings.length=0,this.textures.background.dispose(),this.textures.mask.dispose(),this.geometry.dispose()},t.prototype.activate=function(t){for(var e in this.bindings.push(this.input.registerMeshHandler(a.e,x.a.isType(s.a),(function(e,n){return t.broadcast(new i.c(n.userData.sid,!0))}))),this.bindings.push(this.input.registerMeshHandler(a.r,x.a.isType(s.a),(function(e,n){return t.broadcast(new i.c(n.userData.sid,!1))}))),this.bindings.push(this.input.registerMeshHandler(a.a,x.a.isType(s.a),(function(e,n){return t.broadcast(new i.a(n.userData.sid))}))),this.tagToMesh){var n=this.tagToMesh[e];n.visible=!0,this.addTagToScene(n)}},t.prototype.addTagToScene=function(t){this.scene.add(t),this.input.registerMesh(t.disc,!1)},t.prototype.deactivate=function(t){var e,n;try{for(var r=P(this.bindings),i=r.next();!i.done;i=r.next()){i.value.cancel()}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}for(var o in this.bindings.length=0,this.tagToMesh){var a=this.tagToMesh[o];this.scene.remove(a),this.input.unregisterMesh(a.disc),a.visible=!1}},t.prototype.filterTagVisibility=function(t){var e,n;try{for(var r=P(Object.keys(this.tagToMesh)),i=r.next();!i.done;i=r.next()){var o=i.value,a=this.tagToMesh[o],s=this.mattertagData.getTag(o);a.setVisibility(s.enabled&&t(o,a.visible))}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.setTagVisibility=function(t){var e,n;try{for(var r=P(Object.keys(this.tagToMesh)),i=r.next();!i.done;i=r.next()){var o=i.value,a=this.tagToMesh[o],s=this.mattertagData.getTag(o);a.setVisibility(s.enabled&&t)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.changeOpacityOfDiscs=function(t,e){for(var n in this.tagToMesh)void 0!==e&&n===e||this.changeDiscOpacity(n,t)},t.prototype.changeDiscOpacity=function(t,e){this.tagToMesh[t].setDimmed(e)},t.prototype.getMeshByTagId=function(t){return this.tagToMesh[t]||null},t.prototype.getTagIdByMesh=function(t){return this.meshToTag[t.id]||null},t.prototype.render=function(){var t=this.getViewportScale(this.canvas);for(var e in this.tagToMesh){var n=this.mattertagData.getTag(e),r=this.mattertagsViewData.openTag===e;this.tagToMesh[e].update(n,r,this.camera,t,this.canvas)}},t.prototype.getViewportScale=function(t){return Math.sqrt(Math.min(t.width,t.height)/o.c.mattertags.disc.scale.baseViewportSize)},t}(),A=n(4),D=n(25),R=n(31),C=n(107),I=n(34),k=n(100),L=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),N=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},j=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="mattertag-mesh",e.tagsVisible=!0,e.addNewTagMesh=function(t,n){e.renderer.addNewTagMesh(t)},e.removeTagMesh=function(t,n){e.renderer.removeTagMesh(n)},e.updateTagMesh=function(t,n){e.renderer.updateTagMesh(n,e.tagsVisible)},e}return L(e,t),e.prototype.init=function(t,e){return N(this,void 0,void 0,(function(){var t,n,r,i,o,a;return j(this,(function(s){switch(s.label){case 0:return[4,e.getModule(D.default)];case 1:return t=s.sent().getScene(),[4,e.getModule(R.default)];case 2:return n=s.sent(),[4,e.market.waitForData(C.a)];case 3:return r=s.sent(),[4,e.market.waitForData(I.c)];case 4:return i=s.sent(),[4,e.market.waitForData(k.a)];case 5:return o=s.sent(),a=e.claimRenderLayer(this.name),this.renderer=new O(t.scene,n,t.camera,a,r,i,o),e.addComponent(this,this.renderer),this.bindings.push(r.collection.onElementChanged({onAdded:this.addNewTagMesh,onRemoved:this.removeTagMesh,onUpdated:this.updateTagMesh})),[2]}}))}))},e.prototype.dispose=function(e){t.prototype.dispose.call(this,e)},e.prototype.getTagIdByMesh=function(t){return this.renderer.getTagIdByMesh(t)},e.prototype.getMeshByTagId=function(t){return this.renderer.getMeshByTagId(t)},e.prototype.changeOpacityOfDiscs=function(t,e){this.renderer.changeOpacityOfDiscs(t,e)},e.prototype.changeDiscOpacity=function(t,e){this.renderer.changeDiscOpacity(t,e)},e.prototype.setTagVisibility=function(t){this.renderer.setTagVisibility(t),this.tagsVisible=t},e.prototype.filterTagVisibility=function(t){this.renderer.filterTagVisibility(t)},e}(A.a);e.default=B},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(175),a=n(15),s=n(173),c=n(1),u=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},h=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="snapshots",e}return u(e,t),e.prototype.init=function(t,e){return l(this,void 0,void 0,(function(){var n,r,i;return h(this,(function(s){switch(s.label){case 0:return[4,t.snapshotsStore.read()];case 1:return n=s.sent()||{},r=this,[4,e.market.waitForData(a.a)];case 2:for(i in r.sweepData=s.sent(),n)this.processSnapshot(n[i]);return this.snapshotsData=new o.a(n),e.market.register(this,o.a,this.snapshotsData),[2]}}))}))},e.prototype.processSnapshot=function(t){var e=t.metadata.camera_mode===c.a.Panorama,n=!Object(s.b)(this.sweepData,t.metadata.scan_id);if(t.is360=e&&n,e){var r=this.sweepData.getSweep(t.metadata.scan_id);r&&t.metadata.camera_position.copy(r.position)}},e.prototype.addSnapshot=function(t){this.processSnapshot(t),this.snapshotsData.add(t),this.snapshotsData.commit()},e}(i.a);e.default=f},function(t,e,n){"use strict";var r,i=n(9),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e){var n=t.call(this)||this;return n.sweepIds=e,n}return o(e,t),e}(i.a);e.a=a},function(t,e,n){"use strict";var r,i=n(9),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(){return t.call(this)||this}return o(e,t),e}(i.a);e.a=a},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},i=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},o=function(){function t(t){this.size=t,this.index=0,this.buffer=[]}return t.prototype.push=function(t){this.index>=this.size&&(this.index=0),this.buffer[this.index]=t,this.index++},t.prototype.peek=function(){return this.buffer[this.index<=this.buffer.length?this.index-1:0]||null},t.prototype.getList=function(){return this.buffer},t.prototype[Symbol.iterator]=function(){return r(this,(function(t){switch(t.label){case 0:return[5,i(this.buffer)];case 1:return t.sent(),[2]}}))},t.prototype.clear=function(){this.buffer=[],this.index=0},t}()},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(0),a=n(22),s=n(15),c=n(354),u=n(50),l=n(193),h=n(2),f=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),p=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},d=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},y=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},m=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},v=new h.a("floors-data"),g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="floors",e}return f(e,t),e.prototype.init=function(t,e){return p(this,void 0,void 0,(function(){var n,r,i,o,a,c,h,f,p,v;return d(this,(function(d){switch(d.label){case 0:return this.engine=e,[4,Promise.all([t.floorsSync.load(),e.getModule(u.default),e.market.waitForData(s.a)])];case 1:i=y.apply(void 0,[d.sent(),3]),o=i[0],a=i[1],c=i[2],h=c.getSweepList(),this.data=Object(l.b)(o||{});try{for(f=m(a.mesh.floorMeshes),p=f.next();!p.done;p=f.next())v=p.value,this.data.buildFloorBounds(v.floorIndex,v.boundingBox)}catch(t){n={error:t}}finally{try{p&&!p.done&&(r=f.return)&&r.call(f)}finally{if(n)throw n.error}}return this.mapSweepsToFloors(h),e.market.register(this,l.a,this.data),this.fixupManuallyPlacedSweepsWithoutFloorData(h),[2]}}))}))},e.prototype.onUpdate=function(){},e.prototype.mapSweepsToFloors=function(t){var e=this;t.forEach((function(t){if(t.alignmentType===a.a.ALIGNED){var n=null;t.floor>=0&&(n=e.data.getFloor(t.floor)||null),n||(n=e.data.getClosestFloorAtHeight(t.position.y)),n&&n.addSweep(t)}}))},e.prototype.fixupManuallyPlacedSweepsWithoutFloorData=function(t){var e,n,r=new o.Jc;try{for(var i=m(t),s=i.next();!s.done;s=i.next()){var u=s.value;if(u.placementType===a.b.MANUAL&&-1===u.floor){r.setY(u.position.y);var l=this.data.getFloorAtHeight(u.position.y),h=l?l.floorIndex:0;h!==u.floor&&(v.debug("Setting sweep "+u.id+" from floor "+u.floor+" to "+h),this.engine.broadcast(new c.a(u.index,u.floor,h))),u.floor=h}}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}},e.prototype.getFloorMins=function(){var t=[];return this.data.iterate((function(e){t.push(e.bottom)})),t},e}(i.a);e.default=g},function(t,e,n){"use strict";var r=function(){};e.a=r},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(23),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e){var n=t.call(this)||this;return n.data=e,n.name="measure-view",n.derivedData={},n}return o(e,t),e.prototype.setViewDataFactory=function(t){this.makeViewData=t},e.prototype.getViewData=function(t){var e=this.data.get(t);return e&&!this.derivedData[t]&&this.makeViewData&&(this.derivedData[t]=this.makeViewData(e)),this.derivedData[t]},e.prototype.iterate=function(t){this.data.iterate(t)},e.prototype.iterateDerived=function(t){for(var e in this.derivedData)t(this.derivedData[e])},e.prototype.initialize=function(t){},e.prototype.dispose=function(){},e}(i.a)},function(t,e,n){"use strict";var r,i=n(588),o=n(92),a=n(47),s=n(2),c=n(44),u=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=function(t){function e(e){void 0===e&&(e="MDS Exception");var n=t.call(this,e)||this;return n.name="MdsException",n}return u(e,t),e}(c.a);n.d(e,"a",(function(){return d}));var h=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},f=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},p=new s.a("model-api-client"),d=function(){function t(t){void 0===t&&(t={});var e=t.url||"/api/mp/models/graph";this.queue=t.queue||new o.RequestQueue({retries:0});var n=(""+window.location.origin).replace("-app.","-api.");this.graphUrl=""+n+e,p.debug("Initialized Model API client for "+this.graphUrl)}return t.prototype.model=function(t,e){return h(this,void 0,void 0,(function(){var n,r;return f(this,(function(o){return n={id:{value:e.id,required:!0,type:"ID"}},r=i.query({operation:"model",fields:t,variables:n}),[2,this.query(r).then((function(t){if(!t||!t.data)throw p.error(t),new l;return t}))]}))}))},t.prototype.models=function(t,e,n,r,i){throw new a.a},t.prototype.patchModel=function(t,e,n){throw new a.a},t.prototype.updateModelAddress=function(t,e,n,r,i,o,s,c,u){throw new a.a},t.prototype.updateModelState=function(t,e,n){throw new a.a},t.prototype.updateModelVisibility=function(t,e,n){throw new a.a},t.prototype.addLabel=function(t,e,n){throw new a.a},t.prototype.patchLabel=function(t,e,n,r){throw new a.a},t.prototype.deleteLabel=function(t,e,n){throw new a.a},t.prototype.addMattertag=function(t,e,n){throw new a.a},t.prototype.patchMattertag=function(t,e,n,r){throw new a.a},t.prototype.updateMattertagMediaUrl=function(t,e,n,r,i){throw new a.a},t.prototype.removeMattertagMedia=function(t,e,n){throw new a.a},t.prototype.query=function(t){return h(this,void 0,Promise,(function(){var e;return f(this,(function(n){return e={responseType:"json",withCredentials:!0,body:t},[2,this.queue.post(this.graphUrl,e)]}))}))},t.version="2020.05.28",t}()},function(t,e,n){"use strict";var r=n(6),i=n(2),o=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},a=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},s=new i.a("vr-platform-select"),c=function(){var t="xr"in navigator&&"isSessionSupported"in navigator.xr&&"requestSession"in navigator.xr;return window.isSecureContext&&t},u={isSessionSupported:function(t){return void 0===t&&(t="immersive-vr"),o(void 0,void 0,Promise,(function(){var e,n;return a(this,(function(r){switch(r.label){case 0:if(e=!1,!c())return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,navigator.xr.isSessionSupported(t)];case 2:return e=r.sent(),[3,4];case 3:return n=r.sent(),s.info("WebXR disabled",n),[3,4];case 4:return s.debug("WebXR session type: "+t+" supported: "+e),[2,e]}}))}))},likelySupportsControllers:function(){return window.isSecureContext&&(Object(r.o)()||!Object(r.n)())},apiExists:c},l=n(347);n.d(e,"d",(function(){return y})),n.d(e,"c",(function(){return m})),n.d(e,"b",(function(){return h})),n.d(e,"a",(function(){return f})),n.d(e,"e",(function(){return u}));var h,f,p=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},d=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};!function(t){t.cardboardNativeiOS="googlevrios",t.webvr="webvr",t.webxr="webxr",t.unsupported="unsupported"}(h||(h={})),function(t){t.oculusNativeGear="gearvr",t.cardboardNativeAndroid="googlevr"}(f||(f={}));var y=function(t){var e=t.tryGetProperty("is_vr",!1),n=t.tryGetProperty("mls",0),i=t.tryGetProperty("vr",1);return e&&!(!i||2===i&&!Object(r.h)())&&0===n},m=function(){return p(void 0,void 0,void 0,(function(){var t;return d(this,(function(e){switch(e.label){case 0:return Object(r.k)()?[2,h.cardboardNativeiOS]:[3,1];case 1:return[4,u.isSessionSupported("immersive-vr")];case 2:return t=e.sent(),u.likelySupportsControllers()&&t?[2,h.webxr]:[3,3];case 3:return[4,l.a()];case 4:if(e.sent())return[2,h.webvr];e.label=5;case 5:return[2,h.unsupported]}}))}))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=function(){function t(){this.values={}}return t.prototype.add=function(t,e){this.getValuesAtKey(t).push(e)},t.prototype.remove=function(t,e){var n=this.values[t];if(n){var r=n.indexOf(e);r>-1&&n.splice(r,1)}},t.prototype.getValuesAtKey=function(t){var e=this.values[t]||[];return this.values[t]=e,e},t.prototype.valuesPerKey=function(t){return this.getValuesAtKey(t).length},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"d",(function(){return o})),n.d(e,"b",(function(){return a}));var r=function(t,e,n){return Math.abs(t-e)<=n},i=function(t,e,n){return r(t.x,e.x,n)&&r(t.y,e.y,n)},o=function(t,e,n){return i(t,e,n)&&r(t.z,e.z,n)},a=function(t,e,n){return void 0!==t.find((function(t,i){return r(t,e[i],n)}))}},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(21),a=n(74),s=n(56),c=n(10),u=n(26),l=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),h=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},f=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},p=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},d=["enable_social_sharing","account_social_sharing_default","is_public","is_vr"],y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="showcase-settings",e.updateTransitionType=function(t,e,n){var r=t.options.fast_transitions?c.a.FadeToBlack:c.a.Interpolate;e.hasProperty(a.a)?e.setProperty(a.a,r):n.registerSetting("player_options",a.a,r)},e}return l(e,t),e.prototype.init=function(t,e){return h(this,void 0,void 0,(function(){var n,r,i,a,c,l,h,y,m,v,g,b,w=this;return f(this,(function(f){switch(f.label){case 0:return[4,t.optionsSync.load()];case 1:return(i=f.sent())||(i=new o.b),e.market.register(this,o.b,i),[4,e.getModule(s.default)];case 2:return a=f.sent(),[4,e.market.waitForData(u.a)];case 3:return c=f.sent(),[4,t.modelDetailsStore.read()];case 4:for(h in l=f.sent(),o.a)b=o.a[h],y=i.options[b],a.hasProperty(b)?(m=a.getProperty(b),a.updateSetting(b,y&&m)):a.registerSetting("player_options",b,y);try{for(v=p(d),g=v.next();!g.done;g=v.next())b=g.value,a.registerSetting("ModelData",b,!!l[b])}catch(t){n={error:t}}finally{try{g&&!g.done&&(r=v.return)&&r.call(v)}finally{if(n)throw n.error}}return this.updateTransitionType(i,c,a),this.bindings.push(c.onPropertyChanged(o.a.InstantTransitions,(function(){return w.updateTransitionType(i,c,a)}))),[2]}}))}))},e}(i.a);e.default=y},function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return s}));var r,i=n(9),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e){var n=t.call(this)||this;return n.modelMesh=e,n}return o(e,t),e}(i.a),s=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}o(e,t)}(function(t){function e(e){var n=t.call(this)||this;return n.hitPoint=e,n}return o(e,t),e}(i.a)),function(t){function e(e,n){var r=t.call(this)||this;return r.loaded=e,r.total=n,r}return o(e,t),e}(i.a))},function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return c})),n.d(e,"c",(function(){return u}));var r,i=n(5),o=n(9),a=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.id="SHOWCASE_START",e}(i.a),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.id="SHOWCASE_STOP",e}(i.a),u=function(t){function e(e){var n=t.call(this)||this;return n.enabled=e,n}return a(e,t),e}(o.a)},function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return s})),n.d(e,"d",(function(){return c})),n.d(e,"a",(function(){return u})),n.d(e,"e",(function(){return l}));var r,i=n(5),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e){var n=t.call(this)||this;return n.payload={step:e},n}return o(e,t),e.id="ZOOM_IN",e}(i.a),s=function(t){function e(e){var n=t.call(this)||this;return n.payload={step:e},n}return o(e,t),e.id="ZOOM_OUT",e}(i.a),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.id="ZOOM_RESET",e}(i.a),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.id="ZOOM_MAX_VALUE",e}(i.a),l=function(t){function e(e){var n=t.call(this)||this;return n.payload={value:e},n}return o(e,t),e.id="ZOOM_SET",e}(i.a)},function(t,e,n){"use strict";var r,i=n(2),o=function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},a=new i.a("segment"),s=function(){function t(t){this.token=t,this.endpointType=g.a.Segment}return t.prototype.init=function(t,e){return this.options=t,this.context=e,this.token?(window.analytics&&window.analytics.initialize&&(window.analytics=null),window.analytics||function(){var t=window.analytics=window.analytics||[];if(!t.initialize)if(t.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{t.invoked=!0,t.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on"],t.factory=function(e){return function(){var n=Array.prototype.slice.call(arguments);return n.unshift(e),t.push(n),t}};for(var e=0;e<t.methods.length;e++){var n=t.methods[e];t[n]=t.factory(n)}t.load=function(e,n){var r=document.createElement("script");r.type="text/javascript",r.async=!0,r.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+e+"/analytics.min.js";var i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(r,i),t._loadOptions=n},t.SNIPPET_VERSION="4.1.0"}}(),window.analytics.load(this.token),new Promise((function(t,e){window.analytics.ready(t)}))):Promise.resolve()},t.prototype.identify=function(t){window.analytics.identify(t.sid,{first_name:t.firstName,last_name:t.lastName,email:t.email})},t.prototype.track=function(t,e){i.a.level>=3&&a.debug(t,e?JSON.stringify(e).replace('\\"','"'):e),e=Object.assign(e||{},this.options);try{window.analytics.track(t,e,this.context)}catch(e){a.error("Failed to send data to segment for "+t)}},t.prototype.trackAsync=function(t,e){if(e=e||{},navigator.sendBeacon)try{navigator.sendBeacon("https://api.segment.io/v1/t",JSON.stringify({event:t,anonymousId:window.analytics.user().anonymousId(),properties:o({data:e},this.options),writeKey:this.token,sentAt:Date.now(),type:"track",context:this.context}))}catch(t){a.error("Failed to send async segment request")}},t}(),c=new i.a("log-analytics"),u=function(){function t(){}return t.prototype.init=function(t,e){return c.debug("logging analytics to console",{options:t,context:e}),Promise.resolve()},t.prototype.identify=function(t){c.debug("identify as",t)},t.prototype.track=function(t,e){c.debug({eventName:t,data:e})},t.prototype.trackAsync=function(t,e){c.debug({eventName:t,data:e})},t}(),l=n(20),h=n(41),f=n(6),p=function(){return(p=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},d=new i.a("mp-analytics"),y="ajs_anonymous_id",m="sc_anonymous_id",v=function(){function t(t,e,n){var r=this;this.token=t,this.url=e,this.queue=n,this.segmentStylePayload=function(t,e,n){return{timestamp:Object(h.a)(new Date),integrations:{},context:r.segmentStyleContext(n),properties:e,event:t,messageId:Object(l.q)(),anonymousId:r.anonymousId,type:"track",userId:r.user?r.user.sid:null,sentAt:Object(h.a)(new Date)}},this.segmentStyleContext=function(t){var e={page:{path:window.location.pathname,referrer:window.document.referrer,search:window.location.search,title:window.document.title,url:window.location.href},userAgent:navigator.userAgent,library:{name:"showcase",version:"1"},campaign:{}};return p({},t,e)};var i=Object(f.e)(m);if(i)this.anonymousId=i;else{var o=Object(f.z)(y);this.anonymousId=o?o.replace(/%22/g,""):Object(l.q)(),Object(f.w)(m,this.anonymousId)}this.headers={"X-API-Key":this.token,"Content-Type":"application/json",Accept:"application/json"}}return t.prototype.init=function(t,e){return this.options=t,this.context=e,d.debug("init",{options:this.options,context:this.segmentStyleContext(this.context)}),Promise.resolve()},t.prototype.identify=function(t){d.debug("identify as",t),this.user=t},t.prototype.track=function(t,e){i.a.level>=3&&d.debug(t,e?JSON.stringify(e).replace('\\"','"'):e),e=Object.assign(e||{},this.options);var n=this.segmentStylePayload(t,e,this.context);this.queue.post(this.url,{body:n,headers:this.headers})},t.prototype.trackAsync=function(t,e){if(e=Object.assign(e||{},this.options),navigator.sendBeacon)try{var n=this.segmentStylePayload(t,e,this.context);navigator.sendBeacon(this.url+"?api_key="+this.token,JSON.stringify(n))}catch(t){d.error("Failed to sendBeacon analytics request")}},t}(),g=n(235);n(535);n.d(e,"b",(function(){return b})),n.d(e,"a",(function(){return g.a}));var b=((r={})[g.a.Segment]={class:s,key:"segment_key",url:null},r[g.a.Logging]={class:u,key:null,url:null},r[g.a.Matterport]={class:v,key:"analytics_mp_key",url:"analytics_mp_url"},r)},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(0),a=n(31),s=n(3),c=n(121),u=n(61),l=n(7),h=n(269),f=n(24),p=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),d=function(t){function e(e){var n=t.call(this)||this;return n.lookVelocity=new o.Ic,n.lookAccel=new o.Ic,n.tempAxis=new o.Jc,n.tempOrientation=new o.Pb,n.currentOrientation=new o.Pb,n.tempEuler=new o.A,n.cameraModule=e,n.transition={active:!1,startTime:0,elapsed:0,duration:0,velocity:new o.Ic,easeOut:!1},n}return p(e,t),e.prototype.setLookAcceleration=function(t,e){void 0===e&&(e=!1),this.transition.active||(e&&(t.x&&this.lookVelocity.x&&Math.sign(t.x)!==Math.sign(this.lookVelocity.x)&&(this.lookVelocity.x=0),t.y&&this.lookVelocity.y&&Math.sign(t.y)!==Math.sign(this.lookVelocity.y)&&(this.lookVelocity.y=0)),this.lookAccel.x=void 0!==t.x?t.x:this.lookAccel.x,this.lookAccel.y=void 0!==t.y?t.y:this.lookAccel.y)},e.prototype.startTransition=function(t,e,n){var r=new f.a;return this.transition.active=!0,this.transition.duration=t,this.transition.elapsed=0,this.transition.startTime=Date.now(),this.transition.deferred=r,this.transition.velocity.copy(e),this.transition.easeOut=n,this.lookAccel.set(0,0),this.lookVelocity.copy(e),this.cameraModule.beginExternalTransition(),r.promise()},e.prototype.stopTransition=function(){this.transition.active&&(this.cameraModule.endExternalTransition(),this.transition.active=!1),this.transition.deferred&&(this.transition.deferred.resolve(),this.transition.deferred=void 0)},e.prototype.updateTransition=function(t){var e=t/c.b;if(this.lookVelocity.copy(this.transition.velocity),this.transition.elapsed+=t,this.transition.elapsed>=this.transition.duration){var n=this.transition.duration-(this.transition.elapsed-t);this.lookVelocity.multiplyScalar(n/t)}else this.lookVelocity.multiplyScalar(e)},e.prototype.updateCameraParameters=function(){var t=this.cameraModule.getData(!1);this.tempEuler.setFromQuaternion(t.pose.rotation,"YXZ");var e=this.tempEuler.x,n=Object(l.e)(this.lookVelocity.y,c.d-e,c.e-e);this.tempAxis.copy(s.b.RIGHT),this.tempOrientation.setFromAxisAngle(this.tempAxis.applyQuaternion(t.pose.rotation),n),this.currentOrientation.copy(t.pose.rotation).premultiply(this.tempOrientation),this.tempOrientation.setFromAxisAngle(s.b.UP,this.lookVelocity.x),this.currentOrientation.premultiply(this.tempOrientation),t.pose.rotation.equals(this.currentOrientation)||(this.tempOrientation.copy(this.currentOrientation).normalize(),this.cameraModule.updateCameraRotation(this.tempOrientation))},e.prototype.update=function(t){var e=this.cameraModule.getData(!1),n=t/c.b;e.pose.rotation.equals(this.currentOrientation)||this.currentOrientation.copy(e.pose.rotation),this.transition.active?(this.updateTransition(t),this.updateCameraParameters(),this.transition.elapsed>=this.transition.duration&&(this.stop(this.transition.easeOut),this.transition.active=!1)):(this.lookAccel.length()>u.a.epsilon||this.lookVelocity.length()>u.a.epsilon)&&(this.lookVelocity.addScaledVector(this.lookAccel,n),this.updateCameraParameters(),this.lookVelocity.multiplyScalar(Math.pow(1-c.a,n)))},e.prototype.stop=function(t){void 0===t&&(t=!1),this.stopTransition(),this.lookAccel.set(0,0),t||this.lookVelocity.set(0,0)},e.prototype.startRotateTransition=function(t,e,n){var r=this.cameraModule.getData(!1);return r.transition&&r.transition.activeInternal&&r.transition.to.rotation&&(r.transition.to.rotation=void 0),this.startTransition(t,e.clone().multiplyScalar(c.b),n).nativePromise()},e.prototype.startTranslateTransition=function(t,e,n){throw void 0===n&&(n=!0),new Error("Panning isn't supported in Panorama Controls")},e.prototype.startZoomTransition=function(t,e,n){throw new Error("Zooming isn't supported in Panorama Controls")},e}(h.a),y=n(60),m=n(17),v=n(51),g=n(1),b=n(27),w=n(16),_=n(77),x=n(112),S=n(8),T=n(154),M=n(26);n.d(e,"lookAccelerationKey",(function(){return A}));var E=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),P=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},O=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},A="Rotation speed",D=function(t){function e(){var e,n,r,i=null!==t&&t.apply(this,arguments)||this;return i.name="panorama-controls",i.controlsEngaged=!1,i.lookAccelerationSpeed=c.c,i.calcRotationAngle=(e=new o.jb,n=new o.Jc,r=new o.Jc,function(t,i,a){var s=t.getData(!1);e.getInverse(s.pose.projection.asThreeMatrix4()),n.set(i.x-a.x,i.y-a.y,-1).applyMatrix4(e),r.set(i.x,i.y,-1).applyMatrix4(e);var c=Math.sqrt(n.x*n.x+n.z*n.z),u=Math.sqrt(r.x*r.x+r.z*r.z),l=Math.atan2(n.y,c),h=Math.atan2(r.y,u)-l;n.y=0,r.y=0,n.normalize(),r.normalize();var f=Math.acos(n.dot(r)),p=0;return isNaN(f)||(p=f,a.x>0&&(p*=-1)),new o.Ic(-p,-h)}),i}return E(e,t),e.prototype.init=function(t,e){return P(this,void 0,void 0,(function(){var t,n=this;return O(this,(function(r){switch(r.label){case 0:return[4,e.getModule(y.default)];case 1:return t=r.sent(),this.controls=new d(t),[4,e.getModule(T.default)];case 2:return r.sent().addControls(g.a.Panorama,this.controls),this.market=e.market,this.bindings.push(e.subscribe(x.a,(function(t){n.controls.stop()}))),e.getModule(a.default).then((function(e){e.registerHandler(S.b,(function(t){n.validateViewmode()&&n.controls.stop()})),e.registerHandler(S.d,(function(e){n.validateViewmode()&&e.buttons&b.b.PRIMARY&&(n.controlsEngaged=!0,n.onDrag(t,e.position,e.delta),n.controls.update(c.b),n.controls.stop())})),e.registerHandler(S.c,(function(e){n.validateViewmode()&&n.controlsEngaged&&(e.timeSinceLastMove<100&&!(e.buttons&b.b.PRIMARY)&&(n.onDrag(t,e.position,e.delta),n.controls.update(c.b),n.controls.setLookAcceleration({x:0,y:0})),n.controlsEngaged=!1)})),e.registerHandler(S.f,(function(t){n.validateViewmode()&&n.onKey(t.key,t.state)}))})),[2]}}))}))},e.prototype.onUpdate=function(t){this.validateViewmode()&&this.controls.update(t)},e.prototype.onDrag=function(t,e,n){this.controls.setLookAcceleration(this.calcRotationAngle(t,e,n))},e.prototype.onKey=function(t,e){var n=null,r=this.market.tryGetData(M.a);r&&(n=r.tryGetProperty(A,null)),this.lookAccelerationSpeed=n?n*(Math.PI/180)/60:this.lookAccelerationSpeed;var i=e===_.a.DOWN;switch(t){case w.a.LEFTARROW:case w.a.J:this.controls.setLookAcceleration({x:i?this.lookAccelerationSpeed:0},!0);break;case w.a.RIGHTARROW:case w.a.L:this.controls.setLookAcceleration({x:i?-this.lookAccelerationSpeed:0},!0);break;case w.a.K:this.controls.setLookAcceleration({y:i?-this.lookAccelerationSpeed:0},!0);break;case w.a.I:this.controls.setLookAcceleration({y:i?this.lookAccelerationSpeed:0},!0)}},e.prototype.validateViewmode=function(){var t=this.market.tryGetData(m.a),e=this.market.tryGetData(v.a);return!t||!e||t.isPano()&&!e.isVR()},e}(i.a);e.default=D},function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return o}));var r,i=n(10);!function(t){t.INSTANT="transition.instant",t.FLY="transition.fly",t.FADEOUT="transition.fade"}(r||(r={}));var o=function(t){switch(t){case r.FADEOUT:return i.a.FadeToBlack;case r.INSTANT:return i.a.Instant;case r.FLY:return i.a.Interpolate}}},,function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return s}));var r,i=n(9),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n){var r=t.call(this)||this;return r.sweepId=e,r.selected=n,r}return o(e,t),e}(i.a),s=function(t){function e(e,n,r){var i=t.call(this)||this;return i.sweepId=e,i.pinIndex=n,i.placed=r,i}return o(e,t),e}(i.a)},,,function(t,e,n){var r=n(226),i=n(250),o=n(379);t.exports=r?function(t,e,n){return i.f(t,e,o(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var r=n(249);t.exports=function(t){if(!r(t))throw TypeError(String(t)+" is not an object");return t}},function(t,e,n){var r=n(153),i=n(381),o=n(474),a=r["__core-js_shared__"]||i("__core-js_shared__",{});(t.exports=function(t,e){return a[t]||(a[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.2.1",mode:o?"pure":"global",copyright:" 2019 Denis Pushkarev (zloirock.ru)"})},function(t,e,n){"use strict";var r=n(37),i=n(390),o=n(395),a=n(396),s=n(206);function c(t){s.call(this,"digest"),this._hash=t}r(c,s),c.prototype._update=function(t){this._hash.update(t)},c.prototype._final=function(){return this._hash.digest()},t.exports=function(t){return"md5"===(t=t.toLowerCase())?new i:"rmd160"===t||"ripemd160"===t?new o:new c(a(t))}},function(t,e,n){(function(t){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t){return Object.prototype.toString.call(t)}e.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===r(t)},e.isBoolean=function(t){return"boolean"==typeof t},e.isNull=function(t){return null===t},e.isNullOrUndefined=function(t){return null==t},e.isNumber=function(t){return"number"==typeof t},e.isString=function(t){return"string"==typeof t},e.isSymbol=function(t){return"symbol"===n(t)},e.isUndefined=function(t){return void 0===t},e.isRegExp=function(t){return"[object RegExp]"===r(t)},e.isObject=function(t){return"object"===n(t)&&null!==t},e.isDate=function(t){return"[object Date]"===r(t)},e.isError=function(t){return"[object Error]"===r(t)||t instanceof Error},e.isFunction=function(t){return"function"==typeof t},e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"===n(t)||void 0===t},e.isBuffer=t.isBuffer}).call(this,n(59).Buffer)},function(t,e,n){(function(e){t.exports=function(t,n){for(var r=Math.min(t.length,n.length),i=new e(r),o=0;o<r;++o)i[o]=t[o]^n[o];return i}}).call(this,n(59).Buffer)},function(t,e,n){"use strict";var r=n(171),i=n(145);function o(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}e.BlockHash=o,o.prototype.update=function(t,e){if(t=r.toArray(t,e),this.pending?this.pending=this.pending.concat(t):this.pending=t,this.pendingTotal+=t.length,this.pending.length>=this._delta8){var n=(t=this.pending).length%this._delta8;this.pending=t.slice(t.length-n,t.length),0===this.pending.length&&(this.pending=null),t=r.join32(t,0,t.length-n,this.endian);for(var i=0;i<t.length;i+=this._delta32)this._update(t,i,i+this._delta32)}return this},o.prototype.digest=function(t){return this.update(this._pad()),i(null===this.pending),this._digest(t)},o.prototype._pad=function(){var t=this.pendingTotal,e=this._delta8,n=e-(t+this.padLength)%e,r=new Array(n+this.padLength);r[0]=128;for(var i=1;i<n;i++)r[i]=0;if(t<<=3,"big"===this.endian){for(var o=8;o<this.padLength;o++)r[i++]=0;r[i++]=0,r[i++]=0,r[i++]=0,r[i++]=0,r[i++]=t>>>24&255,r[i++]=t>>>16&255,r[i++]=t>>>8&255,r[i++]=255&t}else for(r[i++]=255&t,r[i++]=t>>>8&255,r[i++]=t>>>16&255,r[i++]=t>>>24&255,r[i++]=0,r[i++]=0,r[i++]=0,r[i++]=0,o=8;o<this.padLength;o++)r[i++]=0;return r}},function(t,e,n){var r=e;r.bignum=n(95),r.define=n(772).define,r.base=n(294),r.constants=n(528),r.decoders=n(777),r.encoders=n(779)},function(t,e,n){var r=e;r.Reporter=n(774).Reporter,r.DecoderBuffer=n(527).DecoderBuffer,r.EncoderBuffer=n(527).EncoderBuffer,r.Node=n(775)},function(t,e,n){"use strict";var r;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.Mutation="mutation",t.Query="query",t.Subscription="subscription"}(r||(r={})),e.default=r},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(){}return t.resolveVariables=function(t){for(var e={},n=0,r=t;n<r.length;n++){var o=r[n].variables;e=i(i({},e),o)}return e},t.queryFieldsMap=function(t){var e=this;return t?t.map((function(t){return"object"===r(t)?Object.keys(t)[0]+" { "+e.queryFieldsMap(Object.values(t)[0])+" }":""+t})).join(", "):""},t.queryVariablesMap=function(t){var e={};return t&&Object.keys(t).map((function(n){e[n]="object"===r(t[n])?t[n].value:t[n]})),e},t.queryDataType=function(t){var e="String",n="object"===r(t)?t.value:t;if(void 0!==t.type)e=t.type;else{var i=Array.isArray(n)?n[0]:n;switch(r(i)){case"object":e="Object";break;case"boolean":e="Boolean";break;case"number":e=i%1==0?"Int":"Float"}}return"object"===r(t)&&(!0===t.list?e="["+e+"]":Array.isArray(t.list)&&(e="["+e+(t.list[0]?"!":"")+"]"),t.required&&(e+="!")),e},t}();e.default=o},function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return o}));var r=16/9,i=1/r,o=function(t,e){return Math.min(Math.max(e/t,i),1)*t}},function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return a}));var r,i=n(73),o=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};!function(t){t[t.PERMANENT=0]="PERMANENT",t[t.ONCE=1]="ONCE"}(r||(r={}));var a=function(){function t(){this.typeLookup=new i.a,this.callbacks=[],this.messageQueue=[],this.messageCount=0}return t.prototype.subscribe=function(t,e,n){var i=this;void 0===n&&(n=r.PERMANENT);var o=this.typeLookup.getIndexByType(t,!0);return this.callbacks[o]||(this.callbacks[o]=[]),this.callbacks[o].push({type:n,callback:e}),{renew:function(){return null},cancel:function(){return i.unsubscribe(t,e)},active:!0}},t.prototype.unsubscribe=function(t,e){var n=this.typeLookup.getIndexByType(t);if(-1===n)throw Error("Message callback not bound for Type: "+t.name);this.unsubscribeByIndex(n,e)},t.prototype.unsubscribeByIndex=function(t,e){var n=this.callbacks[t].findIndex((function(t){return t.callback===e}));if(-1===n)throw Error("Message callback not bound for TypeIndex: "+t);this.callbacks[t].splice(n,1)},t.prototype.broadcast=function(t){var e,n,i,a;if(t.setID(this.messageCount++),this.messageQueue.push(t),1===this.messageQueue.length){try{for(var s=o(this.messageQueue),c=s.next();!c.done;c=s.next()){var u=c.value,l=this.typeLookup.getIndexByInstance(u);if(-1!==l){var h=this.callbacks[l].slice();try{for(var f=o(h),p=f.next();!p.done;p=f.next()){var d=p.value;d.callback(u),d.type===r.ONCE&&this.unsubscribeByIndex(l,d.callback)}}catch(t){i={error:t}}finally{try{p&&!p.done&&(a=f.return)&&a.call(f)}finally{if(i)throw i.error}}}}}catch(t){e={error:t}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}this.messageQueue=[]}},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return s}));var r,i=n(9),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n,r,i,o,a){var s=t.call(this)||this;return s.sid=e,s.is360=n,s.category=r,s.height=i,s.isMeshMode=o,s.url=a,s}return o(e,t),e}(i.a),s=function(t){function e(e){return t.call(this)||this}return o(e,t),e}(i.a)},function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return c}));var r,i=n(107),o=n(34),a=n(137),s=n(129);!function(t){t.OVERLAY="overlay",t.HOVER="hover",t.OPEN="open"}(r||(r={}));var c=function(){this.handlers=[{msgType:a.e,func:function(t,e,n){var r=n.tryGetData(i.a),a=n.tryGetData(o.c);if(r&&a){var c=r.getTagCount(),u=a.getVisitedTags().length,l=a.getViewedTagCount(),h=r.getTag(e.sid);h&&t.track("tag_opened",{tag_count:c,tag_id:e.sid,tags_visited:u,tag_view_count:l,has_media:h.mediaType!==s.a.none})}}},{msgType:a.g,func:function(t,e,n){var r=n.tryGetData(i.a),a=n.tryGetData(o.c);if(r&&a){var s=r.getTagCount(),c=a.getVisitedTags().length,u=a.getViewedTagCount(),l=r.getTag(e.sid);if(l){var h={mattertag_sid:e.sid,mattertag_view:e.view,mattertag_media:l.mediaType,mattertags_count:s,mattertags_total_views:u,mattertags_visited:c};t.track("mattertag_view",h)}}}}]}},function(t,e,n){"use strict";n.d(e,"a",(function(){return m})),n.d(e,"b",(function(){return v}));var r,i=n(0),o=n(72),a=n(8),s=n(361),c=n(43),u=n(42),l=n(22),h=n(259),f=n(29),p=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),d=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e}(i.lb),m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e}(i.lb),v=function(){function t(t,e,n,r,o,a,s,u,l,h,f,p,d,y){void 0===u&&(u=new i.s(16724312)),void 0===l&&(l=new i.s(16724312)),void 0===h&&(h=.8),void 0===f&&(f=.8),void 0===p&&(p=300),void 0===d&&(d=.4),void 0===y&&(y=c.a.ALL);var m=this;this.scene=t,this.input=e,this.settingsData=n,this.sweepViewData=r,this.puckImagery=o,this.onFloor=a,this.checkRenderModes=s,this.idleColor=u,this.selectionColor=l,this.idleOpacity=h,this.editingOpacity=f,this.selectionDuration=p,this.puckSize=d,this.layer=y,this.sweepToMesh={},this.colliderToSweep={},this.editingEnabled=!1,this.puckOffset=new i.Jc(0,.05,0),this.bindings=[],this.wasDrawing=!1,this.renderPuckHighlight=function(t,e){if(m.sweepViewData.isSweepAligned(t)){var n=m.sweepToMesh[t].material.color;e?n.copy(m.selectionColor):n.copy(m.idleColor)}},this.updateLookAt=function(t){m.sweepViewData.iterate((function(e){var n=m.sweepToMesh[e.id];n&&n.visible&&n.lookAt(t)}))}}return Object.defineProperty(t.prototype,"displayDisabled",{get:function(){return void 0!==this.puckImagery.disabled},enumerable:!0,configurable:!0}),t.prototype.init=function(){var t=this,e=new i.Ib(this.puckSize,this.puckSize),n=new i.nc(.5*this.puckSize,10,10);if(this.onFloor){var r=new i.jb;r.makeRotationFromEuler(new i.A(-Math.PI/2,0,0,"XYZ")),e.applyMatrix4(r)}var o={color:this.idleColor.getHex(),opacity:this.idleOpacity,transparent:!0,depthWrite:!1,map:this.puckImagery.enabled},a=new i.mb;this.sweepViewData.iterate((function(r){if(r.alignmentType===l.a.ALIGNED){var s=new i.mb(o);t.puckImagery.disabled&&!r.enabled&&s.setValues({map:t.puckImagery.disabled});var c,h=new y(e,s);t.onFloor?(h.position.copy(r.floorPosition).add(t.puckOffset),c=new m(e,a)):(h.position.copy(r.position),h.rotation.setFromQuaternion(r.rotation),c=new m(n,a)),c.userData.sid=r.id,h.name=r.id,h.updateMatrixWorld(!1);var f=t.sweepViewData.getState(r.id);h.visible=f.visible,f.onPropertyChanged("visible",(function(t){h.visible=t})),t.bindings.push(r.onPropertyChanged("enabled",(function(){s.setValues({map:r.enabled?t.puckImagery.enabled:t.puckImagery.disabled})})));var p=0;t.bindings.push(f.onPropertyChanged("animation",(function(e){var n=e.value,i=r.enabled?t.puckImagery.enabled:t.puckImagery.disabled,o=r.enabled?t.puckImagery.enabledHover:t.puckImagery.disabledHover,a=n>p&&t.editingEnabled,c=r.id===t.sweepViewData.selectedSweep,u=t.editingEnabled&&c?t.selectionColor:t.idleColor,l=t.editingEnabled?t.editingOpacity:t.idleOpacity;s.setValues({map:a?o:i}),s.color.copy(u),s.opacity=l*(1-n)+1*n,p=n}))),h.renderOrder=u.a.panoMarker,c.position.copy(h.position),c.rotation.copy(h.rotation),c.name=r.id,c.updateMatrixWorld(!1),h.collider=c,h.layers.mask=t.layer.mask,t.sweepToMesh[r.id]=h,t.colliderToSweep[c.id]=r.id}}))},t.prototype.toggleEditingEnabled=function(t){for(var e in this.editingEnabled=t,this.sweepToMesh){this.sweepToMesh[e].material.opacity=t?this.editingOpacity:this.idleOpacity}},t.prototype.getSweepId=function(t){return this.colliderToSweep[t]},t.prototype.updatePuckImagery=function(t){var e,n=this;this.displayDisabled||void 0===t.disabled?this.displayDisabled&&void 0===t.disabled&&(e=!1):e=!0,this.puckImagery=t,this.sweepViewData.iterate((function(t){if(t.alignmentType===l.a.ALIGNED){var r=n.sweepToMesh[t.id],i=n.sweepViewData.getState(t.id);r.visible=i.visible;var o=n.puckImagery.enabled;if(!t.enabled&&n.puckImagery.disabled&&(o=n.puckImagery.disabled),n.sweepToMesh[t.id].material.setValues({map:o}),void 0!==e){if(t.enabled)return;e?n.addSweepToScene(t.id):n.removeSweepFromScene(t.id)}}}))},t.prototype.updateCheckRenderModes=function(t){this.checkRenderModes=t},t.prototype.removeSweepFromScene=function(t){var e=this.sweepToMesh[t];this.scene.remove(e),this.input.unregisterMesh(e.collider)},t.prototype.addSweepToScene=function(t){if(this.sweepViewData.getSweep(t).enabled||this.displayDisabled){var e=this.sweepToMesh[t];this.scene.add(e),this.input.registerMesh(e.collider,!0)}},t.prototype.render=function(){var t=this.checkRenderModes(),e=this.settingsData.tryGetProperty(h.a,!0);if(t&&e){if(!this.wasDrawing){for(var n in this.sweepToMesh)this.addSweepToScene(n);this.wasDrawing=!0}}else if(this.wasDrawing){for(var n in this.sweepToMesh)this.removeSweepFromScene(n);this.wasDrawing=!1}},t.prototype.dispose=function(){for(var t in this.sweepToMesh){var e=this.sweepToMesh[t];e.material.dispose(),e.geometry.dispose()}},t.prototype.activate=function(t){var e=this;this.wasDrawing=!1,this.bindings.push(this.input.registerMeshHandler(a.e,f.a.isType(m),(function(n,r){return t.commandBinder.issueCommand(new o.e(e.getSweepId(r.id),!0,e.selectionDuration))}))),this.bindings.push(this.input.registerMeshHandler(a.r,f.a.isType(m),(function(n,r){return t.commandBinder.issueCommand(new o.e(e.getSweepId(r.id),!1,e.selectionDuration))}))),this.bindings.push(this.input.registerMeshHandler(a.a,f.a.isType(m),(function(n,r){var i=e.sweepViewData.getSweep(e.colliderToSweep[r.id]).index,o=e.sweepViewData.getAlignedSweeps(!0).length;t.broadcast(new s.a(e.colliderToSweep[r.id],i,o))})))},t.prototype.deactivate=function(t){var e,n;for(var r in this.sweepToMesh)this.removeSweepFromScene(r);try{for(var i=d(this.bindings),o=i.next();!o.done;o=i.next()){o.value.cancel()}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}this.bindings.length=0},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r,i=n(5),o=n(10),a=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(t){function e(e){var n=e.tagId,r=e.transition,i=e.onSweepChosen,a=e.tagDirection,s=t.call(this)||this;return s.id="MOVE_TO_MATTERTAG",s.payload={tagId:n,transition:r||o.a.Interpolate,onSweepChosen:i,tagDirection:a},s}return a(e,t),e}(i.a)},function(t,e,n){"use strict";n.r(e);var r,i,o=n(4),a=n(0),s=n(166),c=n(129),u=n(172),l=n(69),h=n(465),f=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),p=function(){return(p=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},d=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sid="",e.created=new Date,e.modified=new Date,e.enabled=!0,e.label="",e.description="",e.parsedDescription=[],e.anchorPosition=new a.Jc,e.anchorNormal=new a.Jc(0,1,0),e.floorIndex=0,e.stemVector=new a.Jc(0,0,Object(u.a)(1)),e.stemHeight=Object(u.a)(1),e.stemVisible=!0,e.color=s.a.MATTERTAG_BLUE.clone(),e.mediaType=c.a.none,e.mediaSrc="",e.widgetFrame=null,e}return f(e,t),e.prototype.copy=function(t){var e,n;this.anchorNormal.copy(t.anchorNormal),this.anchorPosition.copy(t.anchorPosition),this.color.copy(t.color),this.created.setTime(t.created.getTime()),this.description=t.description,this.enabled=t.enabled,this.floorIndex=t.floorIndex,this.label=t.label,this.mediaType=t.mediaType,this.mediaSrc=t.mediaSrc,this.modified.setTime(t.modified.getTime()),this.sid=t.sid,this.stemVector.copy(t.stemVector),this.stemHeight=t.stemHeight,this.stemVisible=t.stemVisible,this.parsedDescription=[];try{for(var r=d(t.parsedDescription),i=r.next();!i.done;i=r.next()){var o=i.value;this.parsedDescription.push({link:o.link&&{label:o.link.label.slice(),url:o.link.url.slice(),type:o.link.type,navigationData:o.link.navigationData&&{floorVisibility:o.link.navigationData.floorVisibility,mode:o.link.navigationData.mode,sweepIndex:o.link.navigationData.sweepIndex,panoId:o.link.navigationData.panoId,position:o.link.navigationData.position&&o.link.navigationData.position.clone(),quaternion:o.link.navigationData.quaternion.clone(),zoom:o.link.navigationData.zoom}},text:o.text,type:o.type})}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return this.copyWidgetFrame(t.widgetFrame),this.commit(),this},e.prototype.clone=function(){return(new e).copy(this)},e.prototype.copyWidgetFrame=function(t){t?this.widgetFrame?(Object(h.a)(this.widgetFrame.size,t.size,"width","height"),this.widgetFrame.frame=t.frame):this.widgetFrame=p({},t):this.widgetFrame=null},e}(l.a),m=n(20),v=n(148),g=n(2),b=n(260),w=n(107),_=n(261),x=n(271),S=n(47),T=n(86),M=n(103),E=n(7),P=function(){function t(){}return t.prototype.decode=function(t){var e=t.anchorPosition?Object(E.i)(E.a.fromVisionVector(t.anchorPosition)):void 0,n=t.stemNormal?Object(E.i)(E.a.fromVisionVector(t.stemNormal)):void 0,r={sid:t.id,label:t.label||"",description:t.description||"",enabled:t.enabled,color:t.color,created:t.created,modified:t.modified};if(e&&(r.position=Object(M.c)(e)),(t.media||t.mediaType)&&(r.media={src:t.media||"",type:t.mediaType||""}),n){r.normal=Object(M.c)(n);var i=n.clone().setLength(t.stemLength||0);r.stem={direction:Object(M.c)(i),enabled:!!t.stemEnabled}}else r.stem={direction:{x:0,y:0,z:0},enabled:!!t.stemEnabled};if(t.floor){var o=parseInt(t.floor.id,10);isNaN(o)||(r.floor=o)}if(t.room){var a=parseInt(t.room.id,10);isNaN(a)||(r.room_index=a)}return r},t.prototype.encode=function(t){throw new S.a},t}(),O=function(){return(O=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},A=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},D=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},R=function(){function t(t){this.config=O({adapter:new P},t),this.client=new x.a({queue:this.config.queue})}return t.prototype.create=function(t){return A(this,void 0,void 0,(function(){return D(this,(function(t){if(this.config.readonly)throw new T.a;throw new S.a}))}))},t.prototype.read=function(){return A(this,void 0,Promise,(function(){var t,e,n,r,i;return D(this,(function(o){return t=this.config,e=t.modelId,n=t.adapter,r=t.serializer,i=[{mattertags:["id","label","description","color","enabled",{floor:["id"]},{room:["id"]},{anchorPosition:["x","y","z"]},"stemEnabled",{stemNormal:["x","y","z"]},"stemLength","media","mediaType","created","modified"]}],[2,this.client.model(i,{id:e}).then((function(t){if(!t||!t.data)return null;var e=t.data.model.mattertags,i=n?e.map(n.decode,n):e;return r?i.map(r.deserialize,r):e}))]}))}))},t.prototype.update=function(){return A(this,void 0,void 0,(function(){return D(this,(function(t){if(this.config.readonly)throw new T.a;throw new S.a}))}))},t.prototype.delete=function(){return A(this,void 0,void 0,(function(){return D(this,(function(t){if(this.config.readonly)throw new T.a;throw new S.a}))}))},t}(),C=n(92),I=n(55),k=n(71),L=n(104),N=n(220),j=n(41),B=n(30),F=n(151);n(545),n(546),n(547);!function(t){t.LINK="link",t.PHOTO="photo",t.VIDEO="video",t.RICH="rich"}(i||(i={}));n(548),n(549);var U=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},z=new g.a("mattertags");function G(t,e){var n=new _.a(t);return function(t){if(!t)return null;var r={};for(var i in t){var o=t[i];try{if(e&&(!o.enabled||0===o.label.length&&0===o.description.length&&(!o.media||0===o.media.src.length)))continue;var s=new y;s.sid=o.sid,s.created=Object(j.b)(o.created),s.modified=Object(j.b)(o.modified),s.enabled=o.enabled,s.label=o.label,s.description=o.description,s.parsedDescription=n.parse(o.description),s.anchorPosition=new a.Jc(o.position.x,o.position.y,o.position.z),Object(F.b)(o.normal)?z.debug("Ignored empty Mattertag normal",o.normal):s.anchorNormal=new a.Jc(o.normal.x,o.normal.y,o.normal.z),s.stemVector=new a.Jc(o.stem.direction.x,o.stem.direction.y,o.stem.direction.z),s.stemHeight=s.stemVector.length(),s.stemVisible=void 0===o.stem.enabled||o.stem.enabled,s.floorIndex=o.floor,s.color=o.color?new a.s(o.color):new a.s("#03687d"),o.media?(s.mediaType=c.a.parse(o.media.type),s.mediaSrc=o.media.src):(s.mediaType=c.a.none,s.mediaSrc=""),r[i]=s}catch(t){z.error("Failed to parse tag: "+o.sid,t)}}return r}}var H=function(t){var e,n={sid:t.sid,created:Object(j.a)(t.created),modified:Object(j.a)(t.modified),enabled:t.enabled,label:t.label,description:t.description,color:Object(M.a)(t.color),position:Object(M.c)(t.anchorPosition),normal:Object(M.c)(t.anchorNormal),floor:t.floorIndex,stem:{direction:Object(M.c)(t.stemVector),enabled:void 0===t.stemVisible||t.stemVisible}};return e=t.mediaType,Object.values(i).includes(e)&&(n.media={type:t.mediaType,src:t.mediaSrc}),n},V=function(t,e){var n,r,i={},o=Object(B.a)(t);Object(B.e)(o,e);try{for(var a=U(Object.keys(o)),s=a.next();!s.done;s=a.next()){var c=o[s.value];c&&(i[c.sid]=H(c))}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return i},W=function(t,e){var n,r,i=[],o=Object(B.a)(t);Object(B.e)(o,e);try{for(var a=U(Object.keys(o)),s=a.next();!s.done;s=a.next()){var c=o[s.value];c&&i.push(H(c))}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return i},q=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},Y=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},J=function(){function t(t){this.config={modelId:t.modelId,readonly:void 0===t.readonly||t.readonly,baseUrl:t.baseUrl||window.location.origin,serialize:t.serialize,deserialize:t.deserialize,queue:t.queue||new C.RequestQueue({retries:0})},this.sync=this.makeSync()}return t.prototype.create=function(){return q(this,void 0,void 0,(function(){return Y(this,(function(t){if(this.config.readonly)throw new T.a;throw new S.a}))}))},t.prototype.read=function(){return q(this,void 0,Promise,(function(){return Y(this,(function(t){return[2,this.sync.load().then((function(t){return Object.values(t)}))]}))}))},t.prototype.update=function(){return q(this,void 0,void 0,(function(){return Y(this,(function(t){if(this.config.readonly)throw new T.a;throw new S.a}))}))},t.prototype.delete=function(){return q(this,void 0,void 0,(function(){return Y(this,(function(t){if(this.config.readonly)throw new T.a;throw new S.a}))}))},t.prototype.addMonitor=function(t){this.sync.addMonitor(t)},t.prototype.makeSync=function(){var t=this.config,e=t.modelId,n=t.readonly,r=t.baseUrl,i=t.deserialize,o=t.serialize,a=t.queue,s=r+"/api/v1/jsonstore/model/mattertags/"+e;if(n){var c=new k.c({queue:a,path:s,deserialize:i});return new I.a({publishStores:[c]})}var u=new k.b({queue:a,path:s,batchUpdate:!0,deserialize:i,serialize:o}),l=r+"/api/v1/jsonstore/model/workshopSession/"+e,h=new L.b({queue:a,path:l,cachedData:{data:null},deserialize:N.a.sessionCollectionMap(L.a.Mattertags,i),serialize:W},L.a.Mattertags);return new I.a({publishStores:[u],legacyEditStore:h,editStoreKey:I.c.MATTERTAGS})},t}(),X=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},K=new g.a("mattertag-serializer"),Q=function(){function t(t){this.descriptionParser=new _.a(t)}return t.prototype.serialize=function(t){var e={sid:t.sid,created:Object(j.a)(t.created),modified:Object(j.a)(t.modified),enabled:t.enabled,label:t.label,description:t.description,color:Object(M.a)(t.color),position:Object(M.c)(t.anchorPosition),normal:Object(M.c)(t.anchorNormal),floor:t.floorIndex,stem:{direction:Object(M.c)(t.stemVector),enabled:void 0===t.stemVisible||t.stemVisible}};return t.mediaType!==c.a.none&&(e.media={type:t.mediaType,src:t.mediaSrc}),e},t.prototype.deserialize=function(t){if(!this.validate(t))return K.error("Failed to parse tag: ",t),null;var e=new y;return e.sid=t.sid,e.created=Object(j.b)(t.created),e.modified=Object(j.b)(t.modified),e.enabled=t.enabled,e.label=t.label,e.description=t.description,e.parsedDescription=this.descriptionParser.parse(t.description),e.anchorPosition=new a.Jc(t.position.x,t.position.y,t.position.z),Object(F.b)(t.normal)?K.debug("Ignored empty Mattertag normal",t.normal):e.anchorNormal=new a.Jc(t.normal.x,t.normal.y,t.normal.z),e.stemVector=new a.Jc(t.stem.direction.x,t.stem.direction.y,t.stem.direction.z),e.stemHeight=e.stemVector.length(),e.stemVisible=void 0===t.stem.enabled||t.stem.enabled,e.floorIndex=t.floor,e.color=t.color?new a.s(t.color):new a.s("#03687d"),t.media?(e.mediaType=c.a.parse(t.media.type),e.mediaSrc=t.media.src):(e.mediaType=c.a.none,e.mediaSrc=""),e},t.prototype.validate=function(t){var e,n;if(!t)return!1;try{for(var r=X(["position","stem"]),i=r.next();!i.done;i=r.next()){if(!(i.value in t))return!1}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return!0},t}(),Z=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),$=function(){return($=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},tt=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},et=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},nt=new g.a("mattertag-data"),rt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="mattertag-data",e.addTag=function(t){return tt(e,void 0,void 0,(function(){var e,n;return et(this,(function(r){for(e=new y,n=Object(m.m)(11);this.data.getTag(n);)n=Object(m.m)(11);return e.sid=n,this._editTag(e,t),this.data.addTag(e),[2,n]}))}))},e.editTag=function(t){return tt(e,void 0,void 0,(function(){var e;return et(this,(function(n){return(e=this.data.getTag(t.sid))?(this._editTag(e,t.options),[2]):[2]}))}))},e._editTag=function(t,n){void 0!==n.color&&t.color.copy(n.color),void 0!==n.enabled&&(t.enabled=n.enabled),void 0!==n.stemHeight&&(t.stemHeight=n.stemHeight,t.stemVector.copy(t.anchorNormal).setLength(n.stemHeight)),void 0!==n.stemVisible&&(t.stemVisible=n.stemVisible),void 0!==n.label&&(t.label=n.label.slice()),void 0!==n.description&&(t.description=n.description,t.parsedDescription=e.descParser.parse(t.description)),void 0!==n.floorIndex&&(t.floorIndex=n.floorIndex),void 0!==n.mediaType&&(t.mediaType=n.mediaType),void 0!==n.mediaSrc&&(t.mediaSrc=n.mediaSrc.slice()),void 0!==n.normal&&(t.anchorNormal.copy(n.normal).normalize(),t.stemVector.copy(n.normal).setLength(t.stemHeight)),void 0!==n.position&&t.anchorPosition.copy(n.position),t.modified=new Date,t.commit()},e.removeTag=function(t){return tt(e,void 0,void 0,(function(){return et(this,(function(e){return void 0!==this.data.getTag(t.sid)&&this.data.removeTag(t.sid)?[2,t.sid]:[2,void 0]}))}))},e}return Z(e,t),e.prototype.init=function(t,e){return tt(this,void 0,void 0,(function(){var n;return et(this,(function(r){switch(r.label){case 0:return this.config=$({baseUrl:window.location.origin,storageProvider:v.a.JSONSTORE,readonly:!0,parserOptions:{model:t.modelId,supportLinks:!0,keepLinkLabels:!0}},t),this.store=this.configureStorage(),[4,this.store.read()];case 1:return n=r.sent()||{},this.data=e.market.tryGetData(w.a)||new w.a,this.initializeTagData(n,e.market),this.descParser=new _.a({model:t.modelId,supportLinks:!0,keepLinkLabels:!0}),this.bindings.push(e.commandBinder.addBinding(b.a,this.addTag)),this.bindings.push(e.commandBinder.addBinding(b.b,this.editTag)),this.bindings.push(e.commandBinder.addBinding(b.c,this.removeTag)),[2]}}))}))},e.prototype.configureStorage=function(){var t=this.config,e=t.storageProvider,n=t.modelId,r=t.baseUrl,i=t.parserOptions,o=t.readonly;return e===v.a.MDS?(nt.debug("Loading Mattertags from MDS"),new R({modelId:n,readonly:o,serializer:new Q(i)})):(nt.debug("Loading Mattertags from Jsonstore"),new J({modelId:n,baseUrl:r,readonly:o,serialize:V,deserialize:G(i,!1)}))},e.prototype.getDefaultStore=function(){return this.store},e.prototype.initializeTagData=function(t,e){for(var n in t)this.data.addTag(t[n]);e.register(this,w.a,this.data)},e}(o.a);e.default=rt},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(244),a=n(84),s=n(148),c=n(2),u=n(271),l=n(47),h=n(86),f=n(7),p=n(103),d=function(){function t(){}return t.prototype.decode=function(t){var e=t.floor&&t.floor.id?parseInt(t.floor.id,10):0;return{position:t.position?Object(p.c)(f.a.fromVisionVector(t.position)):void 0,sid:t.id,text:t.label,visible:t.enabled,floorId:e,roomId:"",modified:t.modified,created:t.created,version:"3.0"}},t.prototype.encode=function(t){throw new l.a},t}(),y=n(0),m=n(41),v=n(238),g=function(){function t(){}return t.prototype.serialize=function(t){return{floorId:t.floor,position:t.position,sid:t.sid,text:t.text,visible:t.visible,roomId:t.roomId,created:Object(m.a)(t.created),modified:Object(m.a)(t.modified),version:t.version}},t.prototype.deserialize=function(t){if(!t)return null;if(!t.version||isNaN(Number.parseFloat(t.version))||Number.parseFloat(t.version)<3)return null;var e=new v.a;return e.copy({floor:void 0!==t.floorId?t.floorId:0,position:new y.Jc(t.position.x,t.position.y,t.position.z),sid:t.sid,text:t.text,visible:t.visible,roomId:t.roomId,created:Object(m.b)(t.created),modified:Object(m.b)(t.modified),version:t.version}),e},t.prototype.validate=function(t){return!(!t.position||void 0===t.floorId)},t}(),b=function(){return(b=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},w=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},_=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},x=function(){function t(t){this.config=b({adapter:new d,serializer:new g},t),this.client=new u.a({queue:this.config.queue})}return t.prototype.create=function(t){return w(this,void 0,void 0,(function(){return _(this,(function(t){if(this.config.readonly)throw new h.a;throw new l.a}))}))},t.prototype.read=function(){return w(this,void 0,Promise,(function(){var t,e,n,r,i;return _(this,(function(o){return t=this.config,e=t.modelId,n=t.adapter,r=t.serializer,i=[{labels:["id",{position:["x","y","z"]},{floor:["id"]},"label","enabled","created","modified"]}],[2,this.client.model(i,{id:e}).then((function(t){if(!t||!t.data)return null;var e=t.data.model.labels,i=n?e.map(n.decode,n):e;return r?i.map(r.deserialize,r):e}))]}))}))},t.prototype.update=function(){return w(this,void 0,void 0,(function(){return _(this,(function(t){if(this.config.readonly)throw new h.a;throw new l.a}))}))},t.prototype.delete=function(){return w(this,void 0,void 0,(function(){return _(this,(function(t){if(this.config.readonly)throw new h.a;throw new l.a}))}))},t}(),S=n(92),T=n(55),M=n(71),E=n(220),P=n(104),O=n(30),A=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},D=new c.a("label-serialization"),R=function(t){var e,n;if(!t)return null;var r={};if(t)try{for(var i=A(Object.keys(t)),o=i.next();!o.done;o=i.next()){var a=t[o.value];try{if(!a||!a.version||isNaN(Number.parseFloat(a.version))||Number.parseFloat(a.version)<3)continue;var s=new v.a;s.copy({floor:void 0!==a.floorId?a.floorId:0,position:Object(f.i)(a.position),sid:a.sid,text:a.text,visible:a.visible,roomId:a.roomId,created:Object(m.b)(a.created),modified:Object(m.b)(a.modified),version:a.version}),r[a.sid]=s}catch(t){D.warn("Error parsing label data; not adding label: ",a)}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r},C=function(t,e){var n,r,i={},o=Object(O.a)(t);Object(O.e)(o,e);try{for(var a=A(Object.keys(o)),s=a.next();!s.done;s=a.next()){var c=o[s.value];c&&(i[c.sid]={floorId:c.floor,position:c.position,sid:c.sid,text:c.text,visible:c.visible,roomId:c.roomId,created:Object(m.a)(c.created),modified:Object(m.a)(c.modified),version:c.version},i[c.sid].position=Object(f.i)(c.position))}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return i},I=function(t,e){var n,r,i=[],o=Object(O.a)(t);Object(O.e)(o,e);try{for(var a=A(Object.keys(o)),s=a.next();!s.done;s=a.next()){var c=o[s.value];c&&i.push({floorId:c.floor,position:Object(f.i)(c.position),sid:c.sid,text:c.text,visible:c.visible,roomId:c.roomId,created:Object(m.a)(c.created),modified:Object(m.a)(c.modified),version:c.version})}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return i},k=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},L=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},N=function(){function t(t){this.config={modelId:t.modelId,serialize:t.serialize||C,deserialize:t.deserialize||R,readonly:void 0===t.readonly||t.readonly,baseUrl:t.baseUrl||window.location.origin,queue:t.queue||new S.RequestQueue({retries:0})},this.sync=this.makeSync()}return t.prototype.create=function(){return k(this,void 0,void 0,(function(){return L(this,(function(t){if(this.config.readonly)throw new h.a;throw new l.a}))}))},t.prototype.read=function(){return k(this,void 0,Promise,(function(){return L(this,(function(t){return[2,this.sync.load().then((function(t){return Object.values(t)}))]}))}))},t.prototype.update=function(){return k(this,void 0,void 0,(function(){return L(this,(function(t){if(this.config.readonly)throw new h.a;throw new l.a}))}))},t.prototype.delete=function(){return k(this,void 0,void 0,(function(){return L(this,(function(t){if(this.config.readonly)throw new h.a;throw new l.a}))}))},t.prototype.addMonitor=function(t){this.sync.addMonitor(t)},t.prototype.makeSync=function(){var t=this.config,e=t.modelId,n=t.readonly,r=t.baseUrl,i=t.serialize,o=t.deserialize,a=t.queue,s=r+"/api/v1/jsonstore/model/Labels/"+e;if(n){var c=new M.c({queue:a,path:s,deserialize:o});return new T.a({publishStores:[c]})}var u=new M.b({queue:a,path:s,batchUpdate:!0,deserialize:o,serialize:i}),l=r+"/api/v1/jsonstore/model/workshopSession/"+e,h=new P.b({queue:a,path:l,cachedData:{data:null},deserialize:E.a.sessionCollectionMap(P.a.Labels,R),serialize:I},P.a.Labels);return new T.a({publishStores:[u],legacyEditStore:h,editStoreKey:T.c.LABELS})},t}(),j=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),B=function(){return(B=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},F=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},U=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},z=new c.a("label-data"),G=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="label-data",e}return j(e,t),e.prototype.init=function(t,e){return F(this,void 0,void 0,(function(){var n,r;return U(this,(function(i){switch(i.label){case 0:return this.config=B({baseUrl:window.location.origin,readonly:!0,storageProvider:s.a.JSONSTORE},t),this.market=e.market,this.store=this.configureStorage(),[4,this.store.read()];case 1:return n=i.sent()||{},r=Object(a.b)(n),this.labelData=new o.a(r),this.market.register(this,o.a,this.labelData),[2]}}))}))},e.prototype.configureStorage=function(){var t=this.config,e=t.storageProvider,n=t.modelId,r=t.baseUrl,i=t.readonly;return e===s.a.MDS?(z.debug("Loading Labels from MDS"),new x({modelId:n,readonly:i,adapter:new d})):(z.debug("Loading Labels from Jsonstore"),new N({modelId:n,baseUrl:r,readonly:i,serialize:C,deserialize:R}))},e.prototype.getDefaultStore=function(){return this.store},e.prototype.onUpdate=function(t){},e}(i.a);e.default=G},function(t,e,n){"use strict";n.r(e);var r,i=n(0),o=n(4),a=n(15),s=function(){function t(t){this.comparator=t,this.nodes=[]}return t.prototype.push=function(t){return this.nodes.push(t),this.siftdown(0,this.nodes.length-1)},t.prototype.pop=function(){var t,e;return this.nodes.length&&(t=this.nodes.pop())?(this.nodes.length?(e=this.nodes[0],this.nodes[0]=t,this.siftup(0)):e=t,e):null},t.prototype.peek=function(){return this.nodes[0]},t.prototype.contains=function(t){return-1!==this.nodes.indexOf(t)},t.prototype.replace=function(t){if(this.nodes.length){var e=this.nodes[0];return this.nodes[0]=t,this.siftup(0),e}return null},t.prototype._pushpop=function(t,e,n){var r,i=n||this.defaultCompare;return t.length&&i(t[0],e)<0&&(e=(r=[t[0],e])[0],t[0]=r[1],this._siftup(t,0,i)),e},t.prototype.pushpop=function(t){return this._pushpop(this.nodes,t,this.comparator)},t.prototype._heapify=function(t,e){var n,r,i,o,a,s,c=Math.floor(t.length/2),u=function(){for(s=[],i=0,a=c;0<=a?i<a:i>a;0<=a?i++:i--)s.push(i);return s}.apply(this).reverse(),l=[];for(r=0,o=u.length;r<o;r++)n=u[r],l.push(this._siftup(t,n,e));return l},t.prototype.heapify=function(){var t,e,n,r,i,o,a=Math.floor(this.nodes.length/2),s=function(){for(o=[],n=0,i=a;0<=i?n<i:n>i;0<=i?n++:n--)o.push(n);return o}.apply(this).reverse(),c=[];for(e=0,r=s.length;e<r;e++)t=s[e],c.push(this.siftup(t));return c},t.prototype.updateItem=function(t){var e=this.nodes.indexOf(t);return-1===e?null:(this.siftdown(0,e),this.siftup(e))},t.prototype.clear=function(){return this.nodes=[]},t.prototype.empty=function(){return 0===this.nodes.length},t.prototype.size=function(){return this.nodes.length},t.prototype.clone=function(){var e=new t(this.comparator);return e.nodes=this.nodes.slice(0),e},t.prototype.toArray=function(){return this.nodes.slice(0)},t.prototype.insert=function(t){return this.push(t)},t.prototype.top=function(){return this.peek()},t.prototype.front=function(){return this.peek()},t.prototype.has=function(t){return this.contains(t)},t.prototype.copy=function(){return this.clone()},t.prototype.nlargest=function(t){var e,n,r,i=this.nodes.slice(0,t);if(!i.length)return i;this._heapify(i,this.comparator);var o=this.nodes.slice(t);for(n=0,r=o.length;n<r;n++)e=o[n],this._pushpop(i,e,this.comparator);return i.sort(this.comparator).reverse()},t.prototype.defaultCompare=function(t,e){return t<e?-1:t>e?1:0},t.prototype._siftdown=function(t,e,n,r){for(var i,o,a=r||this.defaultCompare,s=t[n];n>e&&a(s,i=t[o=n-1>>1])<0;)t[n]=i,n=o;return t[n]=s},t.prototype.siftdown=function(t,e){return this._siftdown(this.nodes,t,e,this.comparator)},t.prototype._siftup=function(t,e,n){var r,i,o=n||this.defaultCompare,a=t.length,s=e,c=t[e];for(r=2*e+1;r<a;)(i=r+1)<a&&!(o(t[r],t[i])<0)&&(r=i),t[e]=t[r],r=2*(e=r)+1;return t[e]=c,this._siftdown(t,s,e,o)},t.prototype.siftup=function(t){return this._siftup(this.nodes,t,this.comparator)},t}(),c=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};function u(t,e){var n,r;try{for(var i=c(e),o=i.next();!o.done;o=i.next()){if(o.value===t)return!0}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return!1}!function(t){t[t.Success=0]="Success",t[t.NoPath=1]="NoPath",t[t.Timeout=2]="Timeout"}(r||(r={}));function l(t){if(void 0!==t.parent){var e=l(t.parent);return e.push(t.data),e}return[t.data]}function h(t){return t.toString()}function f(t,e){if(t.f&&e.f)return t.f-e.f;throw new Error('heapComparator() -> Property "f" is undefined.')}var p,d=Object.freeze({sweeps:{maxNeighborDistance:50}}),y=n(265),m=n(266),v=(p=function(t,e){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}p(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),g=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},b=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},w=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="sweep-path",e}return v(e,t),e.prototype.init=function(t,e){return g(this,void 0,void 0,(function(){var n;return b(this,(function(r){switch(r.label){case 0:return this.engine=e,n=this,[4,e.market.waitForData(a.a)];case 1:return n.sweepData=r.sent(),this.validNeighbors={},this.maxNeighborDistance=t.maxNeighborDistance||d.sweeps.maxNeighborDistance,this.buildDistanceMap(),[2]}}))}))},e.prototype.setRestrictedSweeps=function(t,e){if(void 0===e&&(e=0),this.restrictedSweeps=[],t){for(var n=e;n<t.length;n++)this.restrictedSweeps.push(t[n].id);this.engine.broadcast(new y.a(this.restrictedSweeps))}else this.restrictedSweeps=void 0,this.engine.broadcast(new m.a)},e.prototype.findShortestPath=function(t,e,n,i,o,a,p){var d=this;void 0===p&&(p=5e3);var y=this.sweepData.getSweep(t),m=this.sweepData.getSweep(e),v=function(t){var e,n;void 0===t.timeout&&(t.timeout=1/0);var i=t.hash||h,o={data:t.start,g:0,h:t.heuristic(t.start)},a=o;o.f=o.h;var p=[],d=new s(f),y={};d.push(o),y[i(o.data)]=o;for(var m,v,g=Date.now();d.size();){if(Date.now()-g>t.timeout)return{status:r.Timeout,cost:a.g,path:l(a)};var b=d.pop();if(delete y[i(b.data)],b&&t.isEnd(b.data))return{status:r.Success,cost:b.g,path:l(b)};u(m=i(b.data),v=p)||v.push(m);var w=t.neighbor(b.data);try{for(var _=c(w),x=_.next();!x.done;x=_.next()){var S=x.value;if(!u(i(S),p)){var T=b.g+t.distance(b.data,S),M=y[i(S)],E=!1;if(void 0===M)M={data:S,g:0,h:0,f:0},y[i(S)]=M;else{if(M.g<T)continue;E=!0}M.parent=b||void 0,M.g=T,M.h=t.heuristic(S),M.f=T+M.h,M.h<a.h&&(a=M),E?d.heapify():d.push(M)}}}catch(t){e={error:t}}finally{try{x&&!x.done&&(n=_.return)&&n.call(_)}finally{if(e)throw e.error}}}return{status:r.NoPath,cost:a.g,path:l(a)}}({start:y,isEnd:function(t){return t===m},neighbor:function(t){return d.getValidNeighbors(t.id,a)},distance:function(t,e){return d.getDistance(t.id,e.id)},heuristic:function(t,e){return 1},hash:function(t){return t.id},timeout:p});return v.status===r.Success&&v.path.length<o?(this.addSweepsNearPath(v.path,n),this.filterCloseSweepsFromPath(v.path,i)):null},e.prototype.addSweepsNearPath=function(t,e){for(var n,r,o=new i.Jc,a=new i.Jc,s=new i.Jc,c=new i.Jc,u=new i.Jc,l=new i.Jc,h=[],f=new i.Jc,p=function(t,e,n){return s.copy(e).sub(t),s.dot(n)},d=function(t,e){return p(f,t.position,o)-p(f,e.position,o)},y=0;y<t.length-1;){var m=t[y].id,v=t[y+1].id,g=this.sweepData.getSweep(m),b=this.sweepData.getSweep(v);f.copy(g.position),h.length=0,o.copy(b.position).sub(f).normalize();var _=this.findConnectedSweeps(g,this.maxNeighborDistance),x=this.findConnectedSweeps(b,this.maxNeighborDistance),S=_.concat(x);try{for(var T=w(S),M=T.next();!M.done;M=T.next()){var E=M.value,P=s.copy(E.position).sub(f).dot(o);if(P>0)if(u.copy(o),u.multiplyScalar(P),c.copy(s),c.sub(u),c.length()<e)a.copy(o).negate(),l.copy(E.position).sub(b.position),l.dot(a)>0&&h.push(E)}}catch(t){n={error:t}}finally{try{M&&!M.done&&(r=T.return)&&r.call(T)}finally{if(n)throw n.error}}if(h.length>0){h.sort(d);for(var O=t.length+h.length-1;O>=y+h.length;O--)t[O]=t[O-h.length];for(var A=0;A<h.length;A++)t[A+y+1]=h[A]}y+=h.length+1}},e.prototype.findConnectedSweeps=function(t,e,n){void 0===n&&(n=2);var r=[];return this._findConnectedSweeps(t,t,e,r,{},n,0),r},e.prototype._findConnectedSweeps=function(t,e,n,r,i,o,a){var s,c,u=this.getValidNeighbors(t.id);try{for(var l=w(u),h=l.next();!h.done;h=l.next()){var f=h.value;if(!i[f.id])f.position.distanceTo(e.position)<n&&(r.push(f),i[f.id]=!0,a<o&&this._findConnectedSweeps(f,e,n,r,i,o,a+1))}}catch(t){s={error:t}}finally{try{h&&!h.done&&(c=l.return)&&c.call(l)}finally{if(s)throw s.error}}},e.prototype.getValidNeighbors=function(t,e){var n,r,i=this.validNeighbors[t];if(!i){i=[],this.validNeighbors[t]=i;var o=this.sweepData.getSweep(t),a=o.neighbours;try{for(var s=w(a),c=s.next();!c.done;c=s.next()){var u=c.value,l=this.sweepData.getSweep(u),h=this.getDistance(t,u);if(l.enabled&&!(h>this.maxNeighborDistance)){var f=!0;if(e){var p=l.position.clone().sub(o.position).normalize();f=0===e(o.position,p,h).length}f&&i.push(l)}}}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}}return i},e.prototype.filterCloseSweepsFromPath=function(t,e){var n,r,i=[],o=null,a=!1;try{for(var s=w(t),c=s.next();!c.done;c=s.next()){var u=c.value;a=o&&u.position.distanceTo(o.position)<e||!1,o&&a||(i.push(u),o=u)}}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return i.length<2?t:(a&&t.length>1&&(i[i.length-1]=t[t.length-1]),i)},e.prototype.getCurveForPath=function(t){for(var e=0,n=[0],r=1;r<t.length;r++)e+=t[r-1].distanceTo(t[r]),n.push(e);var o=[0];for(r=1;r<t.length;r++)o.push(n[r]/e);var a=new i.q(t,!1);return{curve:new i.q(a.getSpacedPoints(2*e).concat(t[t.length-1])),totalLength:e,sourceDistances:n,normalSourceDistances:o}},e.prototype.buildDistanceMap=function(){var t=this,e={},n=new i.Jc(0,0,0);this.sweepData.iterate((function(r){var i,o,a={},s=r.neighbours;try{for(var c=w(s),u=c.next();!u.done;u=c.next()){var l=u.value,h=t.sweepData.getSweep(l);n.copy(r.position).sub(h.position);var f=Math.max(0,Math.abs(n.y)-.2),p=Math.sqrt(n.x*n.x+n.z*n.z),d=void 0;f>0?(f=Math.pow(4*f,2),p=Math.pow(p,2),d=Math.sqrt(f*f+p*p)):d=n.length(),a[h.id]=d}}catch(t){i={error:t}}finally{try{u&&!u.done&&(o=c.return)&&o.call(c)}finally{if(i)throw i.error}}e[r.id]=a})),this.distanceMap=e},e.prototype.getDistance=function(t,e){return this.distanceMap[t][e]},e}(o.a);e.default=_},function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t.ACCESS_TOKEN_REQUIRED="object.access.token.required",t.FORBIDDEN="spaces.public.access.password.forbidden",t.INVALID_PASSWORD="spaces.public.access.invalid_password",t.TOO_MANY_ATTEMPTS="spaces.public.access.too_many_attempts",t.UNAUTHORIZED="user.unauthorized"}(r||(r={}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(9),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e){var n=t.call(this)||this;return n.pixelRatio=e,n}return o(e,t),e}(i.a)},function(t,e,n){"use strict";var r,i=n(9),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n,r){var i=t.call(this)||this;return i.size=e,i.sweepId=n,i.renderTarget=r,i}return o(e,t),e}(i.a);e.a=a},function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return a}));var r=n(0),i=function(){return Math.random()},o=function(t){return void 0===t&&(t=.25),new r.Kc(i(),i(),i(),t)},a=function(){return new r.s(i(),i(),i())}},function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return s}));var r,i=n(9),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(i.a),s=function(t){function e(e){var n=t.call(this)||this;return n.errorType=e,n}return o(e,t),e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(44),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(){var e=t.call(this)||this;return e.message="Tried to start view-mode transition while another transition was active!",e}return o(e,t),e}(i.a)},function(t,e,n){"use strict";function r(t){void 0===t&&(t=11);for(var e="",n="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",r=0;r<t;r++)e+=n.charAt(Math.floor(Math.random()*n.length));return e}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r,i=n(0),o=n(66),a=n(69),s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=o.a.FloorplanOnly,e.sid="",e.visible=!1,e.version="3.2",e.created=new Date,e.modified=new Date,e.start_position=new i.Jc,e.end_position=new i.Jc,e.text="",e.start_normal=new i.Jc,e.end_normal=new i.Jc,e.floor=-1,e.room=-1,e.group=-1,e.groupOrder=-1,e}return s(e,t),e.prototype.copy=function(t){return this.type=t.type,this.sid=t.sid,this.text=t.text,this.visible=t.visible,this.created=t.created,this.modified=t.modified,this.floor=t.floor,this.start_position.copy(t.start_position),this.end_position.copy(t.end_position),this.start_normal.copy(t.start_normal),this.end_normal.copy(t.end_normal),this.group=t.group,this.groupOrder=t.groupOrder,this.room=t.room,this.commit(),this},e.RAYCASTER_GROUP="measurements",e}(a.a)},function(t,e,n){"use strict";n.r(e);var r,i=n(11),o=n(4),a=n(194),s=n(221),c=n(118),u=n(2),l=n(105),h=n(49),f=n(357),p=n.n(f),d=(n(839),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),y=function(t){function e(e){return t.call(this,e)||this}return d(e,t),e.prototype.render=function(){var t=this.props,e=t.attributionLinkText,n=t.attributionLinkUrl,r=this.context.locale;return Object(i.h)("div",{class:"powered-by"},Object(i.h)("p",{class:"powered-by-label"},r.t(h.a.POWERED_BY)),Object(i.h)("img",{class:"powered-by-logo",alt:"Matterport",src:p.a,width:"150",height:"32"}),n&&Object(i.h)("a",{href:n,class:"powered-by-link"},e||n))},e}(i.Component),m=(n(841),n(582)),v=n.n(m),g=n(44),b=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),w=function(t){function e(e){void 0===e&&(e="Invalid password");var n=t.call(this,e)||this;return n.name="InvalidPassword",n}return b(e,t),e}(g.a),_=function(t){function e(e){void 0===e&&(e="Too many attempts, please try again in a few minutes");var n=t.call(this,e)||this;return n.name="TooManyAttempts",n}return b(e,t),e}(g.a),x=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),S=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},T=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},M=new u.a("showcase-password"),E=function(t){function e(e){var n=t.call(this,e)||this;return n.onInputChange=function(t){var e=t.target,r=e.name,i=e.value;"password"===r&&n.setState({password:i,hasError:!1})},n.onSubmit=function(t){return S(n,void 0,void 0,(function(){return T(this,(function(e){switch(e.label){case 0:return t.preventDefault(),this.setState({formEnabled:!1}),[4,this.authenticate()];case 1:return e.sent(),this.setState({formEnabled:!0}),[2]}}))}))},n.state={formEnabled:!0,hasError:!1,tooManyAttempts:!1,password:""},n}return x(e,t),e.prototype.authenticate=function(){return S(this,void 0,void 0,(function(){var t,e,n,r=this;return T(this,(function(i){switch(i.label){case 0:return t=this.props.authenticate,e=this.state.password,M.debug("Validating password input..."),[4,t(e).catch((function(t){return t instanceof _&&r.setState({hasError:!0,tooManyAttempts:!0}),!1}))];case 1:return n=i.sent(),this.setState({hasError:!n}),[2]}}))}))},e.prototype.getChildContext=function(){return{locale:this.props.locale}},e.prototype.stopPropagation=function(t){t.stopPropagation()},e.prototype.renderLockout=function(){var t=this.props.locale;return Object(i.h)("div",{class:"sc-password-modal sc-password-lockout"},Object(i.h)("header",{class:"modal-header"},Object(i.h)("h1",{class:"modal-title"},t.t(h.a.SC_LOCKOUT_TITLE))),Object(i.h)("p",{class:"modal-body"},t.t(h.a.SC_LOCKOUT_MESSAGE)))},e.prototype.renderLoginForm=function(){var t=this.state,e=t.hasError,n=t.password,r=t.formEnabled,o=this.props.locale;return Object(i.h)("div",{class:"sc-password-modal sc-password-login"},Object(i.h)("header",{class:"modal-header"},Object(i.h)("h1",{class:"modal-title"},o.t(h.a.SC_PASSWORD_TITLE))),Object(i.h)("div",{class:"modal-body"},Object(i.h)("form",{onSubmit:this.onSubmit,class:"sc-password-form"},Object(i.h)("input",{type:"password",name:"password",placeholder:o.t(h.a.SC_PASSWORD_PLACEHOLDER),onInput:this.onInputChange,onKeyDown:this.stopPropagation,onKeyPress:this.stopPropagation,onKeyUp:this.stopPropagation,disabled:!r,value:n,class:l("sc-password-input",{error:e}),autocomplete:"on"}),Object(i.h)("button",{type:"submit",disabled:!r,class:"sc-password-submit"},o.t(h.a.SC_PASSWORD_SUBMIT))),e&&Object(i.h)("p",{class:"help-text error"},Object(i.h)("span",{class:"icon icon-error"}),o.t(h.a.SC_PASSWORD_INVALID)),!e&&Object(i.h)("p",{class:"help-text"})))},e.prototype.render=function(){var t=this.state,e=t.hasError,n=t.tooManyAttempts,r=e&&n?this.renderLockout():this.renderLoginForm();return Object(i.h)("div",{class:"sc-password-ui",style:"background-image: url("+v.a+")"},Object(i.h)("div",{class:"sc-password-content"},r),Object(i.h)("footer",{class:"sc-password-footer"},Object(i.h)(y,null)))},e}(i.Component),P=n(310),O=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),A=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},D=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},R=new u.a("showcase-password"),C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="showcase-password",e.authenticated=!1,e}return O(e,t),e.prototype.init=function(t,e){return A(this,void 0,void 0,(function(){var n;return D(this,(function(r){return this.config=t,this.engine=e,n=t.baseUrl||window.location.origin,this.auth=new a.a(n),[2]}))}))},e.prototype.showPasswordScreen=function(){this.loadUi()},e.prototype.hidePasswordScreen=function(){this.unloadUi()},e.prototype.loadUi=function(){return A(this,void 0,void 0,(function(){var t,e,n,r=this;return D(this,(function(o){switch(o.label){case 0:return t=this.config.container,[4,this.engine.getModule(c.default)];case 1:return e=o.sent(),n=Object(i.h)(E,{locale:e,authenticate:function(t){return r.authenticate(t)}}),this.ref=Object(i.render)(n,t),[2]}}))}))},e.prototype.unloadUi=function(){if(this.ref){var t=this.config.container;Object(i.render)(null,t,this.ref)}},e.prototype.authenticate=function(t){return A(this,void 0,Promise,(function(){var e;return D(this,(function(n){switch(n.label){case 0:return e=this.config.modelId,[4,this.auth.authenticate(e,t)];case 1:if(!n.sent()){switch(this.engine.broadcast(new P.a(this.auth.errorType)),this.auth.errorType){case s.a.INVALID_CREDENTIALS:throw new w;case s.a.TOO_MANY_ATTEMPTS:throw new _}return[2,!1]}return R.debug("Password authentication was successful"),this.engine.broadcast(new P.b),[2,!0]}}))}))},e}(o.a);e.default=C},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(0),a=n(600),s=n.n(a),c=n(601),u=n.n(c),l=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),h=function(t){function e(){var n=o.Bc.clone(e.uniforms);return t.call(this,{vertexShader:s.a,fragmentShader:u.a,uniforms:n,name:"PortalViewportMaterial",side:o.f})||this}return l(e,t),e.prototype.updateTexture=function(t){this.uniforms.tMap.value=t},e.uniforms={tMap:{type:"t",value:null}},e}(o.cc),f=n(13),p=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},d=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},y=function(){function t(t,e,n,r){this.tempLookDirection=new o.Jc,this.worldCamera=r,this.camera=new o.o,this.renderSize=n,this.sweepTextureLoader=t,this.textureRenderer=e,this.renderTargets={},this.renderCube=new o.lb(new o.k(4,4,4),new h)}return t.prototype.getPortalTexture=function(t,e,n){return p(this,void 0,void 0,(function(){var r,i;return d(this,(function(o){switch(o.label){case 0:return r=this.renderTargets[t]||this.textureRenderer.createRenderTarget2D(this.renderSize,this.renderSize),[4,this.sweepTextureLoader.load(t,f.d.BASE)];case 1:return i=o.sent(),this.renderCube.material.updateTexture(i),this.renderCube.quaternion.copy(e),this.camera.projectionMatrix.copy(this.worldCamera.projectionMatrix),this.worldCamera.getWorldPosition(this.tempLookDirection),this.camera.lookAt(this.tempLookDirection.sub(n).negate()),this.textureRenderer.render(r,this.renderCube,this.camera),[2,r.texture]}}))}))},t.prototype.releasePortalTexture=function(t){var e=this.renderTargets[t];e&&this.textureRenderer.disposeRenderTarget2D(e)},t}(),m=n(200),v=n(6),g=Object(v.A)("geond",15),b=Object(v.A)("geowo",.1),w=n(96),_=n(91),x=n(113),S=n(31),T=n(159),M=n(25),E=n(268),P=n(15),O=n(22),A=n(189),D=n(40),R=n(119),C=n(2),I=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),k=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},L=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},N=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},j=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},B=new C.a("sweep-portal-mesh"),F=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="sweep-portal-mesh",e.portalCount=0,e}return I(e,t),e.prototype.init=function(t,e){return k(this,void 0,void 0,(function(){var t,n,r,i,o,a,s,c,u,l,h,f,p,d=this;return L(this,(function(v){switch(v.label){case 0:return[4,Promise.all([e.getModule(w.default),e.getModule(_.default),e.getModule(S.default),e.getModule(T.default),e.getModule(M.default),e.market.waitForData(P.a),e.getModule(E.default)])];case 1:return t=N.apply(void 0,[v.sent(),6]),n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],this.portalData={},c=a.getScene().camera,u=new A.a(n.getSignedUrls()),this.raycaster=r,l=new y(u,o,256,c),h=a.getScene().scene,this.portalRenderer=new m.b(h,i,l),f=O.b.MANUAL,p=s.filter((function(t){return D.k(t)})),s.iterate((function(t){d.portalData[t.id]||(d.portalData[t.id]=[]),D.k(t)&&d.addPortals(t,d.portalRenderer,s,p);var e=t.placementType;d.bindings.push(t.onPropertyChanged("placementType",(function(n){e!==f&&n===f&&d.addPortals(t,d.portalRenderer,s,p),e===f&&n!==f&&d.removePortals(t.id,d.portalRenderer),e=n}))),d.bindings.push(t.onChanged((function(){D.k(t)&&(d.removePortals(t.id,d.portalRenderer),d.addPortals(t,d.portalRenderer,s,p))})))})),e.addComponent(this,this.portalRenderer),[2]}}))}))},e.prototype.filter=function(t){this.portalRenderer.filter(t)},e.prototype.getPortalToExterior=function(t){return this.portalRenderer.mapSweepToMesh(t)},e.prototype.removePortals=function(t,e){var n,r;try{for(var i=j(this.portalData[t]),o=i.next();!o.done;o=i.next()){var a=o.value;e.removePortal(a)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}this.portalData[t]=[]},e.prototype.addPortals=function(t,e,n,r){var i,o,a=this.nearestAlignedSweep(t,n);if(a){var s=this.entryLinks(t,a),c=this.neighborLinks(t,r);this.portalData[t.id]=s.concat(c);try{for(var u=j(this.portalData[t.id]),l=u.next();!l.done;l=u.next()){var h=l.value;e.addPortal(h)}}catch(t){i={error:t}}finally{try{l&&!l.done&&(o=u.return)&&o.call(u)}finally{if(i)throw i.error}}}else B.debug("Couldn't find the nearest sweep for a 360 on floor "+t.floor+"; not adding portals")},e.prototype.nearestAlignedSweep=function(t,e){var n=[D.i(t),D.c(),D.b(),D.j(t)],r=[R.c(t.position)],i=e.sortByScore(n,r)[0];return i?i.sweep:null},e.prototype.modelIntersection=function(t,e){var n=(new o.Jc).copy(t.position).sub(e.position).setY(0).normalize();return{intersect:this.raycaster.picking.pick(e.position,n,x.b),rayDirection:n}},e.prototype.entryLinks=function(t,e){var n=[],r=this.modelIntersection(t,e),i=new o.Jc,a=new o.Jc;return r.intersect&&r.intersect.face?(i=r.intersect.face.normal.clone().setY(0).normalize(),a=r.intersect.point.clone().addScaledVector(i,b).setY(e.position.y)):(i=r.rayDirection.clone().negate(),a=e.position.clone().addScaledVector(r.rayDirection,2)),n.push({index:this.portalCount++,toSweep:t,fromSweep:e,position:a,lookDirection:i,toExterior:!0,fromInterior:!0}),n.push({index:this.portalCount++,toSweep:e,fromSweep:t,position:t.position.clone().addScaledVector(i,2).setY(t.position.y),lookDirection:i.clone().negate(),toExterior:!1,fromInterior:!1}),n},e.prototype.neighborLinks=function(t,e){var n,r,i=[];try{for(var o=j(e),a=o.next();!a.done;a=o.next()){var s=a.value;if(s.floor===t.floor&&t.position.distanceTo(s.position)<g){var c=s.position.clone().sub(t.position).setY(0).normalize(),u=t.position.clone().addScaledVector(c,2);c.negate(),i.push({index:this.portalCount++,toSweep:s,fromSweep:t,position:u,lookDirection:c,toExterior:!0,fromInterior:!1})}}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i},e}(i.a);e.default=F},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(317),a=n(1),s=n(17),c=n(53),u=n(51),l=n(15),h=n(5),f=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),p=function(t){function e(e){var n=t.call(this)||this;return n.payload={disable:e},n}return f(e,t),e}(h.a),d=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),y=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},m=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="cursor-controller",e.visibilityRules=[],e.disabled=!1,e}return d(e,t),e.prototype.init=function(t,e){return y(this,void 0,Promise,(function(){var t,n=this;return m(this,(function(r){switch(r.label){case 0:return t=this,[4,e.getModule(o.default)];case 1:return t.cursorMesh=r.sent(),this.visibilityRules.push((function(){var t=e.market.tryGetData(s.a);return!!t&&t.closestMode===a.a.Panorama}),(function(){var t=e.market.tryGetData(l.a);return!!t&&!t.isSweepUnaligned(t.currentSweep)}),(function(){var t=e.market.tryGetData(c.a);return!!t&&!t.isTourActive()}),(function(){var t=e.market.tryGetData(u.a);return!!t&&!t.isMobile()})),this.bindings.push(e.commandBinder.addBinding(p,(function(t){return y(n,void 0,void 0,(function(){return m(this,(function(e){return this.disabled=t.disable,[2]}))}))}))),[2]}}))}))},e.prototype.onUpdate=function(){this.updateCursorVisibility()},e.prototype.addVisibilityRule=function(t){this.visibilityRules.push(t)},e.prototype.removeVisibilityRule=function(t){var e=this.visibilityRules.indexOf(t);-1!==e&&this.visibilityRules.splice(e,1)},e.prototype.updateCursorVisibility=function(){var t=!this.disabled&&this.visibilityRules.reduce((function(t,e){return t&&e()}),!0);this.cursorMesh.setVisible(t)},e}(i.a);e.default=v},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(0),a=n(192),s=n(109),c=n(43),u=n(3),l=n(48),h=n(360),f=n(589),p=n.n(f),d=n(42),y=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},m=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},v=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},g=function(){function t(t,e){void 0===e&&(e=c.a.ALL);var n=this;this.scene=t,this.layer=e,this.supportsMobile=!1,this.style=h.a.Reticle,this.defaultTexture=Object(l.a)(p.a),this.bindings=[],this.onOpacityUpdate=function(t){n.material.opacity=t.opacity.value},this.onPositionUpdate=function(t){if(t.hit&&t.hit.face){var e=t.hit.point.clone(),r=t.hit.face.normal;n.container.position.copy(e).addScaledVector(r,.01),n.container.quaternion.setFromUnitVectors(u.b.FORWARD,r)}},this.container=new o.J,this.container.name="cursor";var r=new o.Jb(.4,.4);this.material=new o.mb({side:o.w,transparent:!0,depthTest:!0,depthWrite:!1,map:this.defaultTexture});var i=new o.lb(r,this.material);this.container.add(i),i.renderOrder=d.a.reticule,i.layers.mask=this.layer.mask}return t.prototype.init=function(){},t.prototype.render=function(){},t.prototype.dispose=function(){this.material.map&&this.material.map.dispose(),this.container.children.forEach((function(t){if(t.isMesh){t.geometry.dispose();var e=t.material;e.dispose(),e.map&&e.map.dispose()}}))},t.prototype.activate=function(t){return y(this,void 0,void 0,(function(){var e,n;return m(this,(function(r){switch(r.label){case 0:return[4,t.market.waitForData(a.a)];case 1:return e=r.sent(),[4,t.market.waitForData(s.b)];case 2:return n=r.sent(),this.bindings.push(e.onChanged(this.onOpacityUpdate),n.onChanged(this.onPositionUpdate)),this.scene.add(this.container),[2]}}))}))},t.prototype.deactivate=function(){var t,e;try{for(var n=v(this.bindings),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.bindings.length=0,this.scene.remove(this.container)},t.prototype.setVisible=function(t){this.container.visible=t},t}(),b=n(25),w=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),_=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},x=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="cursor-mesh",e.setVisible=function(t){e.cursor&&e.cursor.setVisible(t)},e}return w(e,t),e.prototype.init=function(t,e){return _(this,void 0,void 0,(function(){var t,n,r;return x(this,(function(i){switch(i.label){case 0:return[4,e.getModule(b.default)];case 1:return t=i.sent(),n=t.getScene(),r=e.claimRenderLayer(this.name),this.cursor=new g(n,r),e.addComponent(this,this.cursor),[2]}}))}))},Object.defineProperty(e.prototype,"container",{get:function(){return this.cursor.container},enumerable:!0,configurable:!0}),e}(i.a);e.default=S},,function(t,e,n){"use strict";n.r(e);var r,i=n(0),o=n(4),a=n(15),s=n(1),c=n(97),u=n(10),l=n(22),h=n(20),f=n(26),p=n(60),d=n(188),y=n(25),m=n(199),v=n(90),g=n(405),b=n(21),w=n(7),_=n(156),x=n(24),S=n(116),T=n(50),M=n(275),E=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),P=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},O=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},A=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},D=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="showcase-start",e.firstRenderPromise=new x.a,e.flyInPromise=new x.a,e.handleFlyIn=function(t,n,r){return e.renderer.startRender(!1),e.doStandardStart(t,n,r,!0).catch((function(){return e.renderer.startRender(!0)}))},e}return E(e,t),e.prototype.init=function(t,e){return P(this,void 0,void 0,(function(){var t,n,r,i,o,s,c=this;return O(this,(function(u){switch(u.label){case 0:return[4,Promise.all([e.market.waitForData(f.a),e.getModule(d.default)])];case 1:return n=A.apply(void 0,[u.sent(),2]),r=n[0],i=n[1],[4,Promise.all([e.market.waitForData(a.a),e.getModule(_.default),e.getModule(p.default),e.getModule(y.default)])];case 2:return t=A.apply(void 0,[u.sent(),4]),this.sweepData=t[0],this.sweepModule=t[1],this.cameraModule=t[2],this.renderer=t[3],(o=r.tryGetProperty("quickstart",!1))?[3,4]:[4,e.getModule(M.default)];case 3:u.sent(),u.label=4;case 4:return s=i.getStartingPose(),(o?this.doQuickStart(s,e):this.doStandardStart(s,e,r,!1)).then((function(){return c.flyInPromise.resolve()})),this.bindings.push(e.commandBinder.addBinding(g.a,(function(t){return P(c,void 0,void 0,(function(){return O(this,(function(n){return this.handleFlyIn(t.pose||i.getStartingPose(),e,r),[2]}))}))}))),[2,this.waitForFirstRender]}}))}))},Object.defineProperty(e.prototype,"waitForFirstRender",{get:function(){return this.firstRenderPromise.nativePromise()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"waitForFlyin",{get:function(){return this.flyInPromise.nativePromise()},enumerable:!0,configurable:!0}),e.prototype.doQuickStart=function(t,e){return P(this,void 0,void 0,(function(){var n;return O(this,(function(r){switch(r.label){case 0:return n=this.sweepData.getStartSweep(t).id,t.mode!==s.a.Dollhouse&&t.mode!==s.a.Floorplan?[3,5]:[4,e.getModule(c.default)];case 1:return[4,r.sent().switchToMode(t.mode,u.a.Instant,{sweepID:n,position:t.camera.position,rotation:t.camera.rotation,zoom:-1!==t.camera.zoom?t.camera.zoom:void 0})];case 2:return r.sent(),t.floorVisibility?[4,e.commandBinder.issueCommandWhenBound(new S.a(t.floorVisibility.lastIndexOf(1),!0,0))]:[3,4];case 3:r.sent(),r.label=4;case 4:return[3,7];case 5:return[4,e.commandBinder.issueCommand(new v.a({sweep:n,rotation:t.camera.rotation,transition:u.a.Instant}))];case 6:r.sent(),r.label=7;case 7:return[2,this.renderBeforeStarting(e)]}}))}))},e.prototype.doStandardStart=function(t,e,n,r){return P(this,void 0,void 0,(function(){var o,a,l,f,p,d,y,m,v,g,_,x;return O(this,(function(M){switch(M.label){case 0:return[4,Promise.all([e.getModule(c.default)])];case 1:return o=A.apply(void 0,[M.sent(),1]),a=o[0],l=n.checkUrlParam("dh",0,1)||!n.tryGetProperty(b.a.Dollhouse,!0),f=n.checkUrlParam("fp",0,1)||!n.tryGetProperty(b.a.FloorPlan,!0),t&&(t.mode===s.a.Dollhouse&&l||t.mode===s.a.Floorplan&&f||t.mode===s.a.Panorama&&!t.pano)&&(t=null),p=!t||t&&(t.mode===s.a.Dollhouse||t.mode===s.a.Floorplan),d=!t||t&&!this.is360Pano(t)&&t.mode===s.a.Panorama&&!l,y=t?t.mode:s.a.Panorama,m=this.sweepData.getStartSweep(t).id,(v=t?t.camera.rotation:this.sweepData.getFirstSweep().rotation)&&y!==s.a.Floorplan&&(v=Object(w.m)(v)),d?[4,e.getModule(T.default)]:[3,8];case 2:return M.sent(),g=a.getFlyinEndPose({sweepID:m,position:t?t.camera.position:void 0,rotation:v}),_=a.getFlyinStartPose(g,r?new i.Jc(0,0,0):void 0),x=this.sweepModule.activateSweep({sweepId:m}),[4,a.switchToMode(s.a.Dollhouse,u.a.Instant,_)];case 3:return M.sent(),[4,this.renderBeforeStarting(e)];case 4:return M.sent(),[4,Object(h.d)(750)];case 5:return M.sent(),[4,this.cameraModule.moveTo({transitionType:u.a.Interpolate,pose:g}).nativePromise()];case 6:return M.sent(),[4,x];case 7:return M.sent(),[2,a.switchToMode(s.a.Panorama,u.a.Interpolate,{sweepID:m,rotation:v},c.DEFAULT_TRANSITION_TIME)];case 8:return[4,a.switchToMode(y,u.a.Instant,{sweepID:m,position:t?t.camera.position:void 0,rotation:v,zoom:t&&-1!==t.camera.zoom?t.camera.zoom:void 0})];case 9:return M.sent(),p&&t&&t.floorVisibility?[4,e.commandBinder.issueCommandWhenBound(new S.a(t.floorVisibility.lastIndexOf(1),!0,0))]:[3,11];case 10:M.sent(),M.label=11;case 11:return[4,this.renderBeforeStarting(e)];case 12:M.sent(),M.label=13;case 13:return[2]}}))}))},e.prototype.is360Pano=function(t){var e;if(t.pano.uuid){if(e=this.sweepData.getSweep(t.pano.uuid))return e.alignmentType!==l.a.ALIGNED}else if(e=this.sweepData.getFirstSweep())return e.alignmentType!==l.a.ALIGNED;return!1},e.prototype.renderBeforeStarting=function(t){return P(this,void 0,void 0,(function(){return O(this,(function(e){switch(e.label){case 0:return[4,this.renderer.renderOnce()];case 1:return e.sent(),[4,t.getModule(m.default)];case 2:return e.sent(),this.renderer.startRender(!0),this.firstRenderPromise.resolve(),[2]}}))}))},e}(o.a);e.default=D},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(9),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n){var r=t.call(this)||this;return r.from=e,r.to=n,r}return o(e,t),e}(i.a)},,function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return a}));var r=n(131),i=n(41),o=function(t){if(!t)return null;var e=new r.a;if(!t.icon)return null;e.modified=Object(i.b)(t&&t.modified),e.icon=t.icon||void 0,e.pose={};var n=250,o=Math.ceil(140.625);return e.thumb=t.image?t.image+"&width="+n+"&height="+o+"&fit=crop&imgopt=1":void 0,e},a=function(t,e){var n=e&&"icon"in e?e:t;return{modified:Object(i.a)(n.modified),thumb:n.thumb,icon:n.icon}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return h})),n.d(e,"b",(function(){return f}));var r=n(7),i=n(22),o=n(30),a=n(20),s=n(103),c=n(2),u=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},l=new c.a("sweeps");function h(t){function e(e,n,r,i,o){var a=e[n];if(void 0!==a)r[i]=o?o(a):a;else if(t)throw Error("Required property missing in data: "+n)}return void 0===t&&(t=!0),function(t){var n,o,a,s;if(!t||Object.keys(t).length<1)return null;var c={};try{var h=[];try{for(var f=u(t),p=f.next();!p.done;p=f.next()){var d=p.value,y=new i.c;if(e(d,"index",y,"index"),h[y.index])throw Error("Duplicate sweep index found");h[y.index]=y,e(d,"sweep_uuid",h[y.index],"id",(function(t){return t.replace(/-/g,"")}))}}catch(t){n={error:t}}finally{try{p&&!p.done&&(o=f.return)&&o.call(f)}finally{if(n)throw n.error}}var m=function(t){var n=h[t.index];e(t,"neighbors",n,"neighbours",(function(t){return t.map((function(t){return h[t]?h[t].id:void 0})).filter((function(t){return void 0!==t}))})),e(t,"alignment_type",n,"alignmentType",(function(t){return"string"==typeof t&&i.a.hasOwnProperty(t.toUpperCase())?t:i.a.UNALIGNED})),e(t,"placement",n,"placementType",(function(e){return"string"==typeof t.placement&&i.b.hasOwnProperty(t.placement.toUpperCase())?t.placement:i.b.UNPLACED})),e(t,"rotation",n,"rotation",(function(t){return r.a.fromVisionQuaternion(t)})),e(t,"position",n,"position",(function(t){return r.a.fromVisionVector(t)})),e(t,"floor_position",n,"floorPosition",(function(t){return r.a.fromVisionVector(t)})),e(t,"sweep_name",n,"name"),e(t,"floor_index",n,"floor",(function(t){return isNaN(t)?-1:t})),e(t,"room_index",n,"room",(function(t){return isNaN(t)?-1:t})),e(t,"tags",n,"enabled",(function(t){return-1!==t.indexOf("showcase")})),e(t,"tags",n,"vrenabled",(function(t){return-1!==t.indexOf("vr")})),c[n.id]=n};try{for(var v=u(t),g=v.next();!g.done;g=v.next()){m(d=g.value)}}catch(t){a={error:t}}finally{try{g&&!g.done&&(s=v.return)&&s.call(v)}finally{if(a)throw a.error}}}catch(t){l.error("Error reading sweeps list",t)}return 0===Object.keys(c).length?null:c}}var f=function(t,e){var n=[];if(!e)throw Error("SweepsV2 must serialize via diffs");function c(t,e,n){return function(r,i,c){if(Object(a.j)(e,r)){var u=void 0;"object"==typeof e[r]?(u={},Object(o.e)(u,t[r]),"rotation"===r&&(u=Object(s.b)(u))):u=t[r],n[i]=c?c(u):u}}}for(var u in e){var l=t[u],h=e[u],f={},p=c(l,h,f);p("placementType","placement"),h.placementType!==i.b.UNPLACED&&(p("position","position",(function(t){return r.a.toVisionVector(t)})),p("rotation","rotation",(function(t){return Object(s.b)(r.a.toVisionQuaternion(t))}))),(Object(a.j)(h,"enabled")||Object(a.j)(h,"vrenabled"))&&(f.tags=[],(void 0!==h.enabled?h.enabled:l.enabled)&&(f.tags.push("showcase"),(void 0!==h.vrenabled?h.vrenabled:l.vrenabled)&&f.tags.push("vr"))),p("name","sweep_name"),p("floor","floor_index"),Object.keys(f).length>0&&(f.index=l.index,f.sweep_uuid=l.id,n.push(f))}return 0===n.length?null:n}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return c}));var r=function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},i=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},o=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},a=function(t){return t.replace(/,/gi," ").trim()},s=function(t){if(!t||!t.floors)return null;var e={};return t.floors.split(",").forEach((function(t,n){var r=t.trim();r&&(e[n]={name:r,floorIndex:n})})),e},c=function(t,e){var n,s,c=r({},t,e),u=[];try{for(var l=i(Object.entries(c)),h=l.next();!h.done;h=l.next()){var f=o(h.value,2),p=f[0],d=f[1];if(d){var y=a(d.name);void 0!==d.floorIndex?u[d.floorIndex]=y:u[+p]=y}}}catch(t){n={error:t}}finally{try{h&&!h.done&&(s=l.return)&&s.call(l)}finally{if(n)throw n.error}}return{floors:u.join(",")}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return f})),n.d(e,"b",(function(){return p}));var r=n(7),i=n(313),o=n(66),a=n(30),s=n(2),c=n(41),u=n(3),l=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},h=new s.a("measurement-serialization"),f=function(t){var e,n;if(!t)return null;var a={};try{if(t)try{for(var s=l(Object.keys(t)),f=s.next();!f.done;f=s.next()){var p=t[f.value];if(p&&p.version&&!isNaN(Number.parseFloat(p.version))&&!(Number.parseFloat(p.version)<3)){var d="type"in p?p.type:p.start_normal?o.a.ThreeD:o.a.FloorplanOnly,y=new i.a;a[p.sid]=y.copy({start_position:Object(r.i)(p.start_position),end_position:Object(r.i)(p.end_position),type:d,start_normal:p.start_normal&&Object(r.i)(p.start_normal)||u.b.UP.clone(),end_normal:p.end_normal&&Object(r.i)(p.end_normal)||u.b.UP.clone(),sid:p.sid,text:p.text,visible:p.visible,floor:void 0!==p.floor?p.floor:-1,created:Object(c.b)(p.created),modified:Object(c.b)(p.modified),version:y.version,room:void 0!==p.room?p.room:-1,group:void 0!==p.group?p.group:-1,groupOrder:void 0!==p.groupOrder?p.groupOrder:-1})}}}catch(t){e={error:t}}finally{try{f&&!f.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}}catch(t){return h.debug("Error parsing measurement data;",t),null}return a},p=function(t){return function(e,n){var r,i,o=Object(a.a)(e);Object(a.e)(o,n);var s={};try{for(var c=l(Object.keys(o)),u=c.next();!u.done;u=c.next()){var h=u.value,f=o[h];void 0!==t&&f.type!==t||(s[h]=f)}}catch(t){r={error:t}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}return d(s,{})}},d=function(t,e){var n,i,o={},s=Object(a.a)(t);Object(a.e)(s,e);try{for(var u=l(Object.keys(s)),h=u.next();!h.done;h=u.next()){var f=s[h.value];f&&(o[f.sid]={type:f.type,start_position:Object(r.i)(f.start_position),end_position:Object(r.i)(f.end_position),start_normal:Object(r.i)(f.start_normal),end_normal:Object(r.i)(f.end_normal),floor:f.floor,sid:f.sid,text:f.text,visible:f.visible,created:Object(c.a)(f.created),modified:Object(c.a)(f.modified),version:"3.2",room:f.room,group:f.group,groupOrder:f.groupOrder})}}catch(t){n={error:t}}finally{try{h&&!h.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}return o}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o}));var r=n(21),i=function(t){return t&&t.player_options?("unit_type"in t.player_options||(t.player_options.unit_type=t.unit_type),new r.b(t.player_options)):null},o=function(t,e){var n=t.options;return e&&e.options&&(n=e.options),{player_options:n}}},,,,function(t,e){t.exports={}},function(t,e,n){t.exports=n(153)},function(t,e,n){var r=n(153),i=n(288),o=n(383),a=n(482),s=r.Symbol,c=i("wks");t.exports=function(t){return c[t]||(c[t]=a&&s[t]||(a?s:o)("Symbol."+t))}},function(t,e,n){"use strict";t.exports=n(494)()?Object.setPrototypeOf:n(495)},function(t,e,n){"use strict";var r=Object.prototype.toString,i=r.call(function(){return arguments}());t.exports=function(t){return r.call(t)===i}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=Object.prototype.toString,o=i.call("");t.exports=function(t){return"string"==typeof t||t&&"object"===r(t)&&(t instanceof String||i.call(t)===o)||!1}},function(t,e,n){"use strict";(function(e){!e.version||0===e.version.indexOf("v0.")||0===e.version.indexOf("v1.")&&0!==e.version.indexOf("v1.8.")?t.exports={nextTick:function(t,n,r,i){if("function"!=typeof t)throw new TypeError('"callback" argument must be a function');var o,a,s=arguments.length;switch(s){case 0:case 1:return e.nextTick(t);case 2:return e.nextTick((function(){t.call(null,n)}));case 3:return e.nextTick((function(){t.call(null,n,r)}));case 4:return e.nextTick((function(){t.call(null,n,r,i)}));default:for(o=new Array(s-1),a=0;a<o.length;)o[a++]=arguments[a];return e.nextTick((function(){t.apply(null,o)}))}}}:t.exports=e}).call(this,n(169))},function(t,e,n){var r=n(170).Buffer;function i(t){r.isBuffer(t)||(t=r.from(t));for(var e=t.length/4|0,n=new Array(e),i=0;i<e;i++)n[i]=t.readUInt32BE(4*i);return n}function o(t){for(;0<t.length;t++)t[0]=0}function a(t,e,n,r,i){for(var o,a,s,c,u=n[0],l=n[1],h=n[2],f=n[3],p=t[0]^e[0],d=t[1]^e[1],y=t[2]^e[2],m=t[3]^e[3],v=4,g=1;g<i;g++)o=u[p>>>24]^l[d>>>16&255]^h[y>>>8&255]^f[255&m]^e[v++],a=u[d>>>24]^l[y>>>16&255]^h[m>>>8&255]^f[255&p]^e[v++],s=u[y>>>24]^l[m>>>16&255]^h[p>>>8&255]^f[255&d]^e[v++],c=u[m>>>24]^l[p>>>16&255]^h[d>>>8&255]^f[255&y]^e[v++],p=o,d=a,y=s,m=c;return o=(r[p>>>24]<<24|r[d>>>16&255]<<16|r[y>>>8&255]<<8|r[255&m])^e[v++],a=(r[d>>>24]<<24|r[y>>>16&255]<<16|r[m>>>8&255]<<8|r[255&p])^e[v++],s=(r[y>>>24]<<24|r[m>>>16&255]<<16|r[p>>>8&255]<<8|r[255&d])^e[v++],c=(r[m>>>24]<<24|r[p>>>16&255]<<16|r[d>>>8&255]<<8|r[255&y])^e[v++],[o>>>=0,a>>>=0,s>>>=0,c>>>=0]}var s=[0,1,2,4,8,16,32,64,128,27,54],c=function(){for(var t=new Array(256),e=0;e<256;e++)t[e]=e<128?e<<1:e<<1^283;for(var n=[],r=[],i=[[],[],[],[]],o=[[],[],[],[]],a=0,s=0,c=0;c<256;++c){var u=s^s<<1^s<<2^s<<3^s<<4;u=u>>>8^255&u^99,n[a]=u,r[u]=a;var l=t[a],h=t[l],f=t[h],p=257*t[u]^16843008*u;i[0][a]=p<<24|p>>>8,i[1][a]=p<<16|p>>>16,i[2][a]=p<<8|p>>>24,i[3][a]=p,p=16843009*f^65537*h^257*l^16843008*a,o[0][u]=p<<24|p>>>8,o[1][u]=p<<16|p>>>16,o[2][u]=p<<8|p>>>24,o[3][u]=p,0===a?a=s=1:(a=l^t[t[t[f^l]]],s^=t[t[s]])}return{SBOX:n,INV_SBOX:r,SUB_MIX:i,INV_SUB_MIX:o}}();function u(t){this._key=i(t),this._reset()}u.blockSize=16,u.keySize=32,u.prototype.blockSize=u.blockSize,u.prototype.keySize=u.keySize,u.prototype._reset=function(){for(var t=this._key,e=t.length,n=e+6,r=4*(n+1),i=[],o=0;o<e;o++)i[o]=t[o];for(o=e;o<r;o++){var a=i[o-1];o%e==0?(a=a<<8|a>>>24,a=c.SBOX[a>>>24]<<24|c.SBOX[a>>>16&255]<<16|c.SBOX[a>>>8&255]<<8|c.SBOX[255&a],a^=s[o/e|0]<<24):e>6&&o%e==4&&(a=c.SBOX[a>>>24]<<24|c.SBOX[a>>>16&255]<<16|c.SBOX[a>>>8&255]<<8|c.SBOX[255&a]),i[o]=i[o-e]^a}for(var u=[],l=0;l<r;l++){var h=r-l,f=i[h-(l%4?0:4)];u[l]=l<4||h<=4?f:c.INV_SUB_MIX[0][c.SBOX[f>>>24]]^c.INV_SUB_MIX[1][c.SBOX[f>>>16&255]]^c.INV_SUB_MIX[2][c.SBOX[f>>>8&255]]^c.INV_SUB_MIX[3][c.SBOX[255&f]]}this._nRounds=n,this._keySchedule=i,this._invKeySchedule=u},u.prototype.encryptBlockRaw=function(t){return a(t=i(t),this._keySchedule,c.SUB_MIX,c.SBOX,this._nRounds)},u.prototype.encryptBlock=function(t){var e=this.encryptBlockRaw(t),n=r.allocUnsafe(16);return n.writeUInt32BE(e[0],0),n.writeUInt32BE(e[1],4),n.writeUInt32BE(e[2],8),n.writeUInt32BE(e[3],12),n},u.prototype.decryptBlock=function(t){var e=(t=i(t))[1];t[1]=t[3],t[3]=e;var n=a(t,this._invKeySchedule,c.INV_SUB_MIX,c.INV_SBOX,this._nRounds),o=r.allocUnsafe(16);return o.writeUInt32BE(n[0],0),o.writeUInt32BE(n[3],4),o.writeUInt32BE(n[2],8),o.writeUInt32BE(n[1],12),o},u.prototype.scrub=function(){o(this._keySchedule),o(this._invKeySchedule),o(this._key)},t.exports.AES=u},function(t,e,n){var r=n(228).Buffer,i=n(390);t.exports=function(t,e,n,o){if(r.isBuffer(t)||(t=r.from(t,"binary")),e&&(r.isBuffer(e)||(e=r.from(e,"binary")),8!==e.length))throw new RangeError("salt should be Buffer with 8 byte length");for(var a=n/8,s=r.alloc(a),c=r.alloc(o||0),u=r.alloc(0);a>0||o>0;){var l=new i;l.update(u),l.update(t),e&&l.update(e),u=l.digest();var h=0;if(a>0){var f=s.length-a;h=Math.min(a,u.length),u.copy(s,f,0,h),a-=h}if(h<u.length&&o>0){var p=c.length-o,d=Math.min(o,u.length-h);u.copy(c,p,h,h+d),o-=d}}return u.fill(0),{key:s,iv:c}}},function(t,e,n){"use strict";var r=e;r.base=n(752),r.short=n(753),r.mont=n(754),r.edwards=n(755)},function(t,e,n){(function(e){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(771),o=n(782),a=n(783),s=n(398),c=n(510);function u(t){var n;"object"!==r(t)||e.isBuffer(t)||(n=t.passphrase,t=t.key),"string"==typeof t&&(t=new e(t));var u,l,h=a(t,n),f=h.tag,p=h.data;switch(f){case"CERTIFICATE":l=i.certificate.decode(p,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(l||(l=i.PublicKey.decode(p,"der")),u=l.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return i.RSAPublicKey.decode(l.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return l.subjectPrivateKey=l.subjectPublicKey,{type:"ec",data:l};case"1.2.840.10040.4.1":return l.algorithm.params.pub_key=i.DSAparam.decode(l.subjectPublicKey.data,"der"),{type:"dsa",data:l.algorithm.params};default:throw new Error("unknown key id "+u)}throw new Error("unknown key type "+f);case"ENCRYPTED PRIVATE KEY":p=function(t,n){var r=t.algorithm.decrypt.kde.kdeparams.salt,i=parseInt(t.algorithm.decrypt.kde.kdeparams.iters.toString(),10),a=o[t.algorithm.decrypt.cipher.algo.join(".")],u=t.algorithm.decrypt.cipher.iv,l=t.subjectPrivateKey,h=parseInt(a.split("-")[1],10)/8,f=c.pbkdf2Sync(n,r,i,h),p=s.createDecipheriv(a,f,u),d=[];return d.push(p.update(l)),d.push(p.final()),e.concat(d)}(p=i.EncryptedPrivateKey.decode(p,"der"),n);case"PRIVATE KEY":switch(u=(l=i.PrivateKey.decode(p,"der")).algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return i.RSAPrivateKey.decode(l.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:l.algorithm.curve,privateKey:i.ECPrivateKey.decode(l.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return l.algorithm.params.priv_key=i.DSAparam.decode(l.subjectPrivateKey,"der"),{type:"dsa",params:l.algorithm.params};default:throw new Error("unknown key id "+u)}throw new Error("unknown key type "+f);case"RSA PUBLIC KEY":return i.RSAPublicKey.decode(p,"der");case"RSA PRIVATE KEY":return i.RSAPrivateKey.decode(p,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:i.DSAPrivateKey.decode(p,"der")};case"EC PRIVATE KEY":return{curve:(p=i.ECPrivateKey.decode(p,"der")).parameters.value,privateKey:p.privateKey};default:throw new Error("unknown key type "+f)}}t.exports=u,u.signature=i.signature}).call(this,n(59).Buffer)},function(t,e){(function(e){t.exports=e}).call(this,{})},function(t,e,n){"use strict";var r=n(825);t.exports=Function.prototype.bind||r},function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return a}));var r=n(0),i=new r.A,o=function(t,e){var n=i.setFromQuaternion(t,"YXZ");return(e=e||{}).x=r.ib.radToDeg(n.x),e.y=r.ib.radToDeg(n.y),e.z=r.ib.radToDeg(n.z),e},a=function(t){return i.x=r.ib.degToRad(t.x),i.y=r.ib.degToRad(t.y),i.z=r.ib.degToRad(t.z),i.order="YXZ",(new r.Pb).setFromEuler(i)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}));var r=function(t){return void 0!==t.pointerId},i=function(t){return void 0!==t.changedTouches}},function(t,e,n){"use strict";n.r(e);var r,i=n(0),o=n(4),a=n(107),s=n(565),c=n(18),u=n(137),l=n(209),h=n(112),f=n(70),p=n(10),d=n(15),y=n(302),m=n(300),v=n(12),g=n(1),b=n(93),w=n(26),_=n(566),x=n(90),S=n(550),T=n(2),M=n(32),E=n(34),P=n(85),O=n(99),A=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),D=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},R=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},C=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},I=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},k=new T.a("mattertag-viewdata-module"),L=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="mattertags-viewdata",e.distance=new i.Jc,e.cameraPosition=new i.Jc,e.hoverTimeout=0,e.updateViewData=function(){e.data.iterate((function(t){e.viewData.derivedData[t.sid]=e.makeViewDataForMattertag(t)})),e.viewData.commit()},e.makeViewDataForMattertag=function(t){var n=e.viewData.activeBillboards.get(t.sid),r=e.viewData.selectedTag===t.sid,i=n?n.position:null,o=n?n.distance:0;return{position:i,selected:r,located:!(!i||!o),closeTheTag:!n||n.closing||!(r||!e.viewData.selectedTag),navigating:!(!e.viewData.navigating||e.viewData.navigating!==t.sid),navigatingPosition:r?e.viewData.getNavigatingPosition():void 0,positioned:!1,distance:o,stemHeight:t.stemHeight,visible:t.enabled,color:"#"+t.color.getHexString(),onTagDirectionChanged:e.onTagDirectionChanged}},e.onCameraUpdate=function(t){e.viewData.activeBillboards.keys.length>0&&(e.cameraPosition.copy(t.pose.position),e.updateActiveBillboards(e.viewData.activeBillboards.keys),e.viewData.commit())},e.updateBillboardData=function(t,n){var r=e.viewData.activeBillboards.get(t);r&&(Object.assign(r,n),r.commit())},e.addActiveBillboard=function(t){e.viewData.activeBillboards.has(t)||e.viewData.activeBillboards.set(t,new E.a(t))},e.removeFromActiveBillboards=function(t){e.viewData.activeBillboards.has(t)&&e.viewData.activeBillboards.delete(t)},e.handleOpenBillboardChanged=function(){var t=e.viewData.openTag;e.viewData.activeBillboards.atomic((function(){var n,r;t&&(e.viewData.activeBillboards.get(t)?(window.clearTimeout(e.viewData.activeBillboards.get(t).timeoutId),e.updateBillboardData(t,{timeoutId:0,closing:!1})):e.addActiveBillboard(t),e.updateActiveBillboards([t]));var i=function(n){if(n===t)return{value:void 0};e.updateBillboardData(n,{closing:!0,direction:void 0,timeoutId:window.setTimeout((function(){e.removeFromActiveBillboards(n)}),1e3)})};try{for(var o=C(e.viewData.activeBillboards.keys),a=o.next();!a.done;a=o.next()){var s=i(a.value);if("object"==typeof s)return s.value}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}))},e.updateActiveBillboards=function(t){return D(e,void 0,void 0,(function(){var e,n=this;return R(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.engine.commandBinder.issueCommand(new s.a(t)).then((function(t){var e,r;try{for(var i=C(t),o=i.next();!o.done;o=i.next()){var a=o.value;n.updateBillboardData(a.sid,{distance:n.distance.copy(n.cameraPosition).distanceToSquared(a.world),position:a.screen})}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}}))];case 1:return r.sent(),[3,3];case 2:return e=r.sent(),k.error("Could not get Disc Positions for tags - "+e),[3,3];case 3:return[2]}}))}))},e.onSweepChosen=function(t){e.viewData.setNavigatingPosition(t)},e.onDiscHoverChange=function(t){var n=e.viewData.toolState;if(n===E.b.CLOSED||!e.viewData.selectedTag){var r=e.data.getTag(t.sid);if(r&&r.enabled)if(e.engine.commandBinder.issueCommand(new O.a(t.hovering?P.a.FINGER:null)),clearTimeout(e.hoverTimeout),t.hovering)n!==E.b.EDITING&&(e.hoverTimeout=window.setTimeout((function(){return e.discHoverChange(t.sid,t.hovering)}),125));else{if(t.sid===e.viewData.selectedTag)return;e.discHoverChange(t.sid,!1)}}},e.onDiscClicked=function(t){t.sid===e.viewData.selectedTag?e.closeBillboard(t.sid):(e.viewData.setSelectedTag(t.sid),e.navigateToTag(t.sid,p.a.Interpolate))},e.onSweepExit=function(t){t.toSweep&&t.fromSweep!==t.toSweep&&(e.viewData.isCreatingNewMattertag()||e.viewData.closeOpenBillboard())},e.onAppChange=function(t){e.currentApp=t.application,e.viewData.closeOpenBillboard(),e.viewData.setSelectedTag(null)},e.onViewmodeChange=function(t){null===e.viewData.navigating&&t.fromMode===g.a.Panorama&&e.viewData.closeOpenBillboard()},e.onNavigationLinkClicked=function(t){return D(e,void 0,void 0,(function(){var e,n,r,i,o,a,s,c,u;return R(this,(function(l){if(t.chunk.link&&t.chunk.link.navigationData)if(e={2:M.b.DOLLHOUSE,3:M.b.FLOORPLAN},n=t.chunk.link.navigationData,r=n.sweepIndex,i=n.quaternion,o=n.mode,a=t.chunk.link.navigationData,s=a.panoId,c=a.position,s||void 0===r||(u=this.sweepData.getSweepByIndex(r))&&(s=u.id),s)this.engine.commandBinder.issueCommand(new x.a({sweep:s,rotation:i,transition:p.a.FadeToBlack}));else{if(!(o in e))throw new Error("Unknown navigation link pose: "+JSON.stringify(t.chunk.link.navigationData));this.engine.commandBinder.issueCommand(new S.a({mode:e[o],options:{rotation:i,position:c}}))}return[2]}))}))},e.onTagDirectionChanged=function(t,n){e.updateBillboardData(t,{direction:n})},e}return A(e,t),e.prototype.init=function(t,e){return D(this,void 0,void 0,(function(){var t,n=this;return R(this,(function(r){switch(r.label){case 0:return this.engine=e,[4,Promise.all([e.market.waitForData(a.a),e.market.waitForData(d.a),e.market.waitForData(w.a),e.market.waitForData(c.a)])];case 1:return t=I.apply(void 0,[r.sent(),4]),this.data=t[0],this.sweepData=t[1],this.settings=t[2],this.cameraData=t[3],this.viewData=e.market.tryGetData(E.c)||new E.c(this.data),e.market.register(this,E.c,this.viewData),this.viewData.setViewDataFactory(this.makeViewDataForMattertag),this.updateViewData(),this.settings.onPropertyChanged(b.b,(function(t){0!==t&&n.viewData.closeOpenBillboard()})),this.bindings.push(e.subscribe(u.c,this.onDiscHoverChange),e.subscribe(u.a,this.onDiscClicked),e.subscribe(l.a,this.onSweepExit),e.subscribe(h.a,this.onViewmodeChange),e.subscribe(f.b,this.onAppChange),this.cameraData.onChanged(this.onCameraUpdate),this.data.onChanged(this.updateViewData),this.viewData.onOpenTagChanged(this.handleOpenBillboardChanged),this.viewData.activeBillboards.onChanged(this.updateViewData)),this.engine.commandBinder.addBinding(_.a,this.onNavigationLinkClicked),[2]}}))}))},e.prototype.openBillboard=function(t){var e=this.viewData.tagCapabilities[t];e&&!e.opening||this.viewData.openBillboard(t)},e.prototype.closeBillboard=function(t){this.viewData.closeBillboard(t)},e.prototype.navigateToTag=function(t,e){return D(this,void 0,Promise,(function(){var n,r,i,o,a=this;return R(this,(function(s){if(!(n=this.data.getTag(t)))throw new Error("No tag with that sid was found");if(!n.enabled)throw new Error("Cannot navigate to a disabled mattertag");return(r=this.viewData.tagCapabilities[t])&&!r.navigating?[2]:(this.viewData.setNavigatingTag(t),i=this.viewData.activeBillboards.get(t),o=i&&i.direction,[2,this.engine.commandBinder.issueCommand(new y.a({tagId:t,transition:e,onSweepChosen:this.onSweepChosen,tagDirection:o})).then((function(){a.onTagVisited(t),a.openBillboard(t),a.viewData.setNavigatingTag(null),a.viewData.setNavigatingPosition(void 0)})).catch((function(t){k.debug(t),a.viewData.setNavigatingTag(null),a.viewData.setNavigatingPosition(void 0)}))])}))}))},e.prototype.onTagVisited=function(t){this.viewData.visitTag(t),this.engine.broadcast(new u.g(t,m.b.OPEN)),this.engine.broadcast(new u.e(t))},e.prototype.discHoverChange=function(t,e){if(this.data.getTag(t)){var n=this.viewData.openTag===t;e&&!n?(this.currentApp===v.b.SHOWCASE&&this.engine.broadcast(new u.g(t,m.b.HOVER)),this.openBillboard(t)):!e&&n&&this.closeBillboard(t),this.viewData.commit()}},e}(o.a);e.default=L},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(101),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n){var r=t.call(this)||this;return r.position=e,r.delta=n,r}return o(e,t),e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r,i,o=n(2),a=n(6),s=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},c=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},u=new o.a("vr-platform-select"),l=function(){return s(void 0,void 0,Promise,(function(){var t,e;return c(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,h()];case 1:return n.sent(),"getVRDisplays"in navigator?[4,navigator.getVRDisplays()]:[2,null];case 2:return(t=n.sent()).length>0&&t[0].capabilities.canPresent?[2,t[0]]:[3,4];case 3:return e=n.sent(),u.warn("Getting VR display failed"),u.warn(e),[3,4];case 4:return[2,null]}}))}))},h=(r=Object(a.h)()&&!("getVRDisplays"in navigator)&&!Object(a.o)(),i=!1,function(){return s(void 0,void 0,void 0,(function(){var t,e;return c(this,(function(o){switch(o.label){case 0:return!r||i?[3,2]:[4,n.e(9).then(n.t.bind(null,930,7))];case 1:t=o.sent(),e=new t.default,u.info("Falling back to WebVR support, native:: "+e.hasNative,{webvrPolyfillNeeded:r,polyfill:e}),i=!0,o.label=2;case 2:return[2]}}))}))})},function(t,e,n){"use strict";var r,i=n(44),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e){void 0===e&&(e="Out of range");var n=t.call(this,e)||this;return n.name="OutOfRangeException",n}return o(e,t),e}(i.a);e.a=a},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(201),a=n(6),s=n(44),c=n(404),u=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},h=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},f=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e}(s.a),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="container-resizer",e.touchDevice=Object(a.b)(),e.resetScroll=function(){e.touchDevice&&window.scrollTo(0,0)},e.resizeContainer=function(){e.containerElement.style.height=window.innerHeight+"px",e.resetScroll()},e}return u(e,t),e.prototype.init=function(t,e){return l(this,void 0,void 0,(function(){var n,r,i,a;return h(this,(function(s){if(!t.container)throw new p;this.containerElement=t.container,this.bindings.push(Object(o.c)(o.b.RESIZE,this.resizeContainer));try{for(i=f(this.bindings),a=i.next();!a.done;a=i.next())a.value.renew()}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return this.bindings.push(e.subscribe(c.a,this.resetScroll)),this.resizeContainer(),[2]}))}))},e}(i.a);e.default=d},function(t,e,n){"use strict";function r(t){try{var e=t.getExtension("WEBGL_debug_renderer_info");if(e)return{vendor:t.getParameter(e.UNMASKED_VENDOR_WEBGL),renderer:t.getParameter(e.UNMASKED_RENDERER_WEBGL)}}catch(t){}return{vendor:"Unknown",renderer:"Unknown"}}function i(t){return/Apple A(9|1\d)/.test(t.renderer)||/Adreno \(TM\) (512|530|540|[6-9]\d\d)/.test(t.renderer)||/Mali-G(7[1-9]|[8-9]\d)/.test(t.renderer)}n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},i=function(){function t(t){this.comparer=t||this.defaultComparer,this.poolArray=[]}return t.prototype.add=function(t){var e=this.createObjectDescriptor(t);return e.object=t,e.inUse=!0,this.addObjectDescriptorToPool(e),e},t.prototype.get=function(t){var e,n;try{for(var i=r(this.poolArray),o=i.next();!o.done;o=i.next()){var a=o.value;if(!a.inUse&&this.comparer(a,t))return a.inUse=!0,a}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return null},t.prototype.free=function(t){var e,n;try{for(var i=r(this.poolArray),o=i.next();!o.done;o=i.next()){var a=o.value;if(a.object===t)return a.inUse=!1,!0}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return!1},t.prototype.all=function(){return this.poolArray},t.prototype.remove=function(t){var e=this.poolArray.findIndex((function(e){return e.object===t}));return-1!==e&&(this.poolArray.splice(e,1),!0)},t.prototype.defaultComparer=function(t,e){return!0},t.prototype.createObjectDescriptor=function(t){return{object:t,inUse:!1}},t.prototype.addObjectDescriptorToPool=function(t){this.poolArray.push(t)},t}()},function(t,e,n){"use strict";var r=n(22),i=n(191),o=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},a=function(){function t(t,e){var n,a;this.textureUsageCounter={},this.model=t,this.sweepList=e;var s=new i.a((function(t){return t.id}));try{for(var c=o(this.sweepList),u=c.next();!u.done;u=c.next()){var l=u.value;l.isObservableProxy&&(l=(new r.c).copy(l)),s.add(l)}}catch(t){n={error:t}}finally{try{u&&!u.done&&(a=c.return)&&a.call(c)}finally{if(n)throw n.error}}this.sweepListMap=s}return t.prototype.init=function(){},t.prototype.dispose=function(){},t.prototype.activate=function(t){},t.prototype.deactivate=function(t){},t.prototype.beforeRender=function(){},t.prototype.render=function(){},t.prototype.activateSweep=function(t){return this.initTextureUsage(t),Promise.resolve(null)},t.prototype.useTexture=function(t){return this.incrementTextureUsage(t),null},t.prototype.freeTexture=function(t,e){void 0===e&&(e=!1),e?this.setTextureUsage(t,0):this.decrementTextureUsage(t)},t.prototype.initTextureUsage=function(t){this.textureUsageCounter[t]||(this.textureUsageCounter[t]=0)},t.prototype.setTextureUsage=function(t,e){this.textureUsageCounter[t]=e},t.prototype.incrementTextureUsage=function(t){this.textureUsageCounter[t]++},t.prototype.decrementTextureUsage=function(t){this.textureUsageCounter[t]--},t}();e.a=a},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(5),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n,r,i){void 0===i&&(i=1);var o=t.call(this)||this;return o.id="SCHEDULE_PROCESS_COMMAND",o.payload={type:e,func:n,maxDelay:r,steps:i},o}return o(e,t),e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(9),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n,r){var i=t.call(this)||this;return i.index=e,i.from=n,i.to=r,i}return o(e,t),e}(i.a)},function(t,e,n){"use strict";var r,i=n(9),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e){var n=t.call(this)||this;return n.zoomLevel=e,n}return o(e,t),e}(i.a);e.a=a},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(9),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n,r,i,o,a){var s=t.call(this)||this;return s.roomId=e,s.roomIndex=n,s.viewmode=r,s.visitCount=i,s.roomCount=o,s.roomType=a,s}return o(e,t),e}(i.a)},function(t,e,n){t.exports=n.p+"images/matterport-logo-light.svg"},function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return o}));var r=n(0);function i(t){var e=t.match(/group([0-9]+)/),n=t.match(/sub([0-9]+)/);return{floorIndex:e?parseInt(e[1],10):0,roomIndex:n?parseInt(n[1],10):0}}function o(t,e){if(void 0===e&&(e=!1),!t.getAttribute("barycentric")){for(var n=(t.getIndex()||t.getAttribute("position")).count/3,i=[],o=0;o<n;o++){var a=e?1:0;o%2==0?i.push(0,0,1,0,1,0,1,0,a):i.push(0,1,0,0,0,1,1,0,a)}var s=new Float32Array(i),c=new r.l(s,3);t.setAttribute("barycentric",c)}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(5),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e){var n=t.call(this)||this;return n.id="TOGGLE_MESH_OVERLAY_COLOR",n.payload={enabled:e},n}return o(e,t),e}(i.a)},function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.Reticle=0]="Reticle",t[t.GridPlane=1]="GridPlane"}(r||(r={}))},function(t,e,n){"use strict";var r,i=n(9),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n,r){var i=t.call(this)||this;return i.sweepId=e,i.sweepIndex=n,i.totalSweeps=r,i}return o(e,t),e}(i.a);e.a=a},function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var r=n(2),i=n(0),o=n(124),a=n(66),s=n(35),c=n(369),u=n(54),l=new r.a("line-data"),h=function(t,e,n,r,h,f,p){void 0===p&&(p=function(){return{lineVisibleByFeatureType:!0,labelVisibleByFeatureType:!0}});var d=this;this.cameraData=t,this.viewmodeData=e,this.floorsViewData=n,this.isCurrentSweepAligned=r,this.getUnits=h,this.isFeatureEnabled=f,this.visibleFilter=p,this.derivedDataCache={},this.setVisibilityFilter=function(t){d.visibleFilter=t},this.defaultVisibilityFilter=function(){d.visibleFilter=function(){return{lineVisibleByFeatureType:!0,labelVisibleByFeatureType:!0}}},this.make=function(t,e,n){var r=e(),i=r.start_position,s=r.end_position,l=r.visible,h=r.floor,f=r.type,p=r.text,y=f===a.a.ThreeD,m=void 0!==n?n.opacity.value:0,v=0===m||m===u.c.LABEL_HIDDEN_OPACITY,g=l&&d.isFeatureEnabled(),b=g&&d.visibleByFloorAndModes(h,y);if(n&&v&&(!g||!b))return n;var w=b,_=b;if(b){var x=d.visibleFilter(t);w=w&&x.lineVisibleByFeatureType,_=_&&x.labelVisibleByFeatureType}var S,T=0,M=i.distanceTo(s),E=Object(c.c)(M,d.getUnits());if(_||!v){var P=Object(c.a)(p.length+E.length),O=P.width,A=P.height,D=Object(c.b)(i,s,d.cameraData);d.tmpVec.copy(D.startScreenPosition).sub(D.endScreenPosition);var R=Math.abs(d.tmpVec.y)<Math.abs(d.tmpVec.x)?A:O;u.c.ALIGN_LABELS&&(R=O,T=D.rotation),_=_&&D.pixelDistance>R}var C=w&&_?1:w&&!_?u.c.LABEL_HIDDEN_OPACITY:0;n?(S=n.opacity).endValue===C&&w===n.visible&&_===n.labelVisible||S.modifyAnimation(S.value,C,u.c.FADE_DURATION):S=new o.a(0,C,u.c.FADE_DURATION);var I={sid:t,rotation:T,labelVisible:_,visible:w,length:M,displayLength:E,labelContents:p.length>0?E+" "+p:E,opacity:S};return d.derivedDataCache[t]={getLineData:e,previousDerivedData:I},I},this.update=function(t){if(d.derivedDataCache[t]){var e=d.derivedDataCache[t],n=e.getLineData,r=e.previousDerivedData;return d.make(t,n,r)}l.warn("data not found for "+t)},this.get=function(t){if(d.derivedDataCache[t])return d.derivedDataCache[t].previousDerivedData},this.remove=function(t){d.derivedDataCache[t]&&delete d.derivedDataCache[t]},this.clear=function(){d.derivedDataCache={}},this.visibleByFloorAndModes=function(t,e){if(d.floorsViewData.transition.progress.active)return!1;var n=d.viewmodeData.isPano(),r=d.viewmodeData.isFloorplan(),i=d.viewmodeData.isDollhouse(),o=d.floorsViewData.currentFloor,a=o===s.a,c=o===t,u=d.floorsViewData.totalFloors-1,l=!e&&r&&(c||u===t&&a),h=e&&i&&(c||a);return e&&n&&d.isCurrentSweepAligned()||h||l},this.tmpVec=new i.Ic}},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(267),a=function(){function t(t){this.name=t,this.taskDurations=new o.a(100)}return Object.defineProperty(t.prototype,"typicalStepDuration",{get:function(){return 1},enumerable:!0,configurable:!0}),t.prototype.addTaskDuration=function(t){this.taskDurations.push(t)},t}();!function(t){t.WAITING="waiting",t.STARTED="started",t.DONE="done"}(r||(r={}));var s,c=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},u=function(){function t(){this.tasks=[],this.types={}}return t.prototype.getType=function(t){return this.types[t]||(this.types[t]=new a(t)),this.types[t]},t.prototype.addTask=function(t){this.tasks.push(t)},t.prototype.update=function(t){var e,n;this.tasks=this.tasks.filter((function(t){return t.status!==r.DONE})),this.tasks.sort((function(t,e){return e.urgency-t.urgency}));var i=0;try{t:for(var o=c(this.tasks),a=o.next();!a.done;a=o.next())for(var s=a.value;s.status!==r.DONE;){var u=performance.now(),l=i+s.type.typicalStepDuration>t,h=u>=s.deadline;if(l&&!h)break t;var f=u;s.run();var p=performance.now()-f;s.type.addTaskDuration(p),i+=p}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}},t}(),l=n(177),h=n(353),f=function(){function t(t,e,n,i){var o=this;this.type=t,this.func=e,this.deadline=n,this.steps=i,this.status=r.WAITING,this.promise=new Promise((function(t,e){o.onSuccess=t,o.onError=e}))}return t.prototype.run=function(){var t;this.status=r.STARTED;try{t=this.func.next()}catch(t){return this.status=r.DONE,void this.onError(t)}this.steps-=1,t.done&&(this.status=r.DONE,this.onSuccess(t.value))},Object.defineProperty(t.prototype,"estimatedDuration",{get:function(){return this.steps*this.type.typicalStepDuration},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"urgency",{get:function(){var t=this.deadline-performance.now();return t<=0?1e6-t:this.estimatedDuration/t/t},enumerable:!0,configurable:!0}),t}(),p=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),d=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},y=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="scheduler-module",e.scheduler=new u,e}return p(e,t),e.prototype.init=function(t,e){return d(this,void 0,void 0,(function(){var t=this;return y(this,(function(n){return this.engine=e,this.engine.commandBinder.addBinding(l.a,(function(e){return d(t,void 0,void 0,(function(){var t;return y(this,(function(n){return t=new f(this.scheduler.getType(e.type),e.func,performance.now()+e.maxDelay,e.steps),this.scheduler.addTask(t),[2,t]}))}))})),this.engine.commandBinder.addBinding(h.a,(function(e){return d(t,void 0,void 0,(function(){var t;return y(this,(function(n){return t=new f(this.scheduler.getType(e.type),e.func,performance.now()+e.maxDelay,e.steps),this.scheduler.addTask(t),[2,t]}))}))})),[2]}))}))},e.prototype.onUpdate=function(t){this.scheduler.update(4)},e}(i.a);e.default=m},function(t,e,n){"use strict";n.r(e);var r,i=n(21),o=n(4),a=n(26),s=n(1),c=n(53),u=n(15),l=n(246),h=n(175),f=n(165),p=n(140),d=n(2),y=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),m=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},v=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},g=new d.a("tour-data"),b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="tours-data",e.defaultModes=[s.a.Panorama,s.a.Outdoor],e.deleteUnusedTourSnapshots=function(){return m(e,void 0,void 0,(function(){var t,e,n,r,i;return v(this,(function(o){switch(o.label){case 0:for(e in t=[],this.snapshotsData.collection)t.push(e);n=0,o.label=1;case 1:return n<t.length?(r=t[n],(i=this.snapshotsData.collection[r]).category!==p.a.tour||this.tourData.isSnapshotInTour(i.sid)?[3,3]:[4,this.engine.commandBinder.issueCommand(new f.d(i.sid))]):[3,4];case 2:o.sent(),o.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},e.onUpdateSnapshots=function(){e.tourData.updateSnapshots(e.snapshotsData.collection)},e}return y(e,t),e.prototype.init=function(t,e){return m(this,void 0,void 0,(function(){var n,r,i,o,s,p,d;return v(this,(function(y){switch(y.label){case 0:return this.engine=e,[4,e.market.waitForData(a.a)];case 1:return n=y.sent(),r=this.getFilterModes(n,this.defaultModes),[4,t.activeReelSync.load()];case 2:return i=y.sent()||new l.a,o=this,[4,e.market.waitForData(u.a)];case 3:return o.sweepData=y.sent(),s=this,[4,e.market.waitForData(h.a)];case 4:return s.snapshotsData=y.sent(),this.tourData=new c.a(this.snapshotsData.collection,i,r,this.sweepData.getSweepList(),t.looping),e.market.register(this,c.a,this.tourData),this.bindings.push(e.commandBinder.addBinding(f.b,this.deleteUnusedTourSnapshots)),this.bindings.push(this.snapshotsData.onChanged(this.onUpdateSnapshots)),p=Object.keys(i.reel).length,d=this.tourData.getSnapshotCount(),p!==d&&g.info(p-d+" items in snapshots, but not in reel"),[2]}}))}))},e.prototype.getFilterModes=function(t,e){var n=t.tryGetProperty("dh",1)>0,r=t.tryGetProperty(i.a.Dollhouse,!0);n&&r&&e.push(s.a.Dollhouse);var o=t.tryGetProperty("fp",1)>0,a=t.tryGetProperty(i.a.FloorPlan,!0);return o&&a&&e.push(s.a.Floorplan),e},e}(o.a);e.default=b},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(0),a=n(29),s=n(134),c=n(108),u=n(301),l=n(361),h=n(564),f=n(98),p=n(27),d=n(8),y=n(25),m=n(31),v=n(26),g=n(18),b=n(114),w=n(17),_=n(1),x=n(366),S=n(90),T=n(51),M=n(132),E=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),P=function(){return(P=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},O=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},A=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},D=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},R=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},C={enabled:x.a,enabledHover:x.a},I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="sweep-pucks",e.IDLE_OPACITY=.3,e.EDITING_OPACITY=.9,e.IDLE_COLOR=new o.s("white"),e.SELECTION_COLOR=new o.s(16724312),e.defaultCheckRenderModes=function(){return!0},e.unselectingSweep=null,e.editingEnabled=!1,e.selectionBindings=[],e.unselectionBindings=[],e.selectionHandled=!0,e.unselectionHandled=!0,e.handlePuckClickedMessage=function(t){if(!t)throw new Error("SweepPucks -> on PuckClickedMessage: Tried to move to invalid sweep id.");e.canSelectPuck()||e.sweepViewData.data.canTransition()&&e.cameraData.canTransition()&&e.engine.commandBinder.issueCommand(new S.a({transition:M.b[e.interactionmodeData.mode],sweep:t}))},e.handleSweepSelectionChange=function(){e.updateHighlightOnSelectedPuck(!1),e.selectedSweep=e.sweepViewData.selectedSweep,e.updateHighlightOnSelectedPuck(!0),e.updateHandlers()},e.updateViewmode=function(){e.viewmode=e.viewmodeData.currentMode,e.updateHighlightOnSelectedPuck(e.editingEnabled),e.updateHandlers()},e.updateHandlers=function(){e.selectionHandled=e.toggleHandlers(e.canSelectPuck(),e.selectionBindings,e.selectionHandled),e.unselectionHandled=e.toggleHandlers(e.canUnselectPuck(),e.unselectionBindings,e.unselectionHandled)},e.unselectPuck=function(){e.unselectingSweep=null,e.sweepViewData.setSelectedSweep(null)},e.onUnselectPuck=function(t){var n=e.sweepViewData.selectedSweep;return n&&(t.down?e.unselectingSweep=n:e.unselectingSweep&&e.unselectPuck()),!0},e.onPointerOnPuck=function(t,n){if(t.button===p.a.PRIMARY){var r=e.renderer.getSweepId(n.id);r&&(t.down?r===e.selectedSweep?e.unselectingSweep=r:(e.unselectingSweep=null,e.sweepViewData.setSelectedSweep(r)):(r===e.unselectingSweep&&e.unselectPuck(),e.unselectingSweep=null))}},e}return E(e,t),e.prototype.init=function(t,e){return O(this,void 0,void 0,(function(){var n,r,i,o,f,p,_,x,S=this;return A(this,(function(M){switch(M.label){case 0:return this.engine=e,void 0!==t.checkRenderModes&&(this.defaultCheckRenderModes=t.checkRenderModes),[4,e.getModule(y.default)];case 1:return n=M.sent().getScene(),[4,e.getModule(m.default)];case 2:return r=M.sent(),[4,Promise.all([e.market.waitForData(v.a),e.market.waitForData(g.a),e.market.waitForData(b.a),e.market.waitForData(w.a),e.market.waitForData(T.a)])];case 3:return i=D.apply(void 0,[M.sent(),5]),o=i[0],f=i[1],p=i[2],_=i[3],x=i[4],this.viewmodeData=_,this.viewmode=_.currentMode,this.sweepViewData=p,this.cameraData=f,this.interactionmodeData=x,!0,this.renderer=new u.b(n.scene,r,o,p,C,!0,this.defaultCheckRenderModes,this.IDLE_COLOR,this.SELECTION_COLOR,this.IDLE_OPACITY,this.EDITING_OPACITY,void 0,void 0,e.claimRenderLayer(this.name)),e.addComponent(this,this.renderer),this.bindings.push(e.commandBinder.addBinding(h.a,(function(t){return O(S,void 0,void 0,(function(){return A(this,(function(e){return[2,this.togglePuckEditing(t.enabled)]}))}))})),e.subscribe(l.a,(function(t){return S.handlePuckClickedMessage(t.sweepId)}))),this.selectionBindings.push(r.registerMeshHandler(d.m,a.a.isType(u.a),this.onPointerOnPuck),r.registerHandler(d.n,(function(){S.unselectingSweep=null}))),this.selectionHandled=this.toggleHandlers(!1,this.selectionBindings,this.selectionHandled),this.selectionSub=this.sweepViewData.onSelectedSweepChanged(this.handleSweepSelectionChange),this.unselectionBindings.push(r.registerPriorityHandler(d.a,c.a,(function(){return!0})),r.registerPriorityHandler(d.m,c.a,this.onUnselectPuck),r.registerPriorityHandler(d.m,s.a,this.onUnselectPuck)),this.unselectionHandled=this.toggleHandlers(!1,this.unselectionBindings,this.unselectionHandled),[2]}}))}))},e.prototype.dispose=function(e){var n,r;try{for(var i=R(this.bindings),o=i.next();!o.done;o=i.next()){o.value.cancel()}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}this.bindings=[],this.togglePuckEditing(!1),t.prototype.dispose.call(this,e)},e.prototype.updatePuckImagery=function(t){void 0===t&&(t={});var e=P({},C,t);e.disabled&&!e.disabledHover&&(e.disabledHover=e.disabled),this.renderer.updatePuckImagery(e)},e.prototype.updateCheckRenderModes=function(t){this.renderer.updateCheckRenderModes(t||this.defaultCheckRenderModes)},e.prototype.updateHighlightOnSelectedPuck=function(t){var e=this.selectedSweep;if(e){if(!this.sweepViewData.isSweepAligned(e))return;var n=this.viewmode===_.a.Dollhouse||this.viewmode===_.a.Floorplan;this.renderer.renderPuckHighlight(e,this.editingEnabled&&n&&t)}},e.prototype.togglePuckEditing=function(t){this.editingEnabled=t,this.selectedSweep=this.sweepViewData.selectedSweep,this.updateViewmode(),this.renderer.toggleEditingEnabled(t),t?(this.engine.subscribe(f.a,this.updateViewmode),this.selectionSub.renew()):(this.engine.unsubscribe(f.a,this.updateViewmode),this.selectionSub.cancel())},e.prototype.canUnselectPuck=function(){var t=this.viewmode===_.a.Dollhouse||this.viewmode===_.a.Floorplan;return this.editingEnabled&&!!this.selectedSweep&&t},e.prototype.canSelectPuck=function(){var t=this.viewmode===_.a.Dollhouse||this.viewmode===_.a.Floorplan;return this.editingEnabled&&t},e.prototype.toggleHandlers=function(t,e,n){var r,i;if(t!==n)try{for(var o=R(e),a=o.next();!a.done;a=o.next()){var s=a.value;t?s.renew():s.cancel()}}catch(t){r={error:t}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return t},e}(i.a);e.default=I},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(48),i=n(590),o=n.n(i),a=Object(r.a)(o.a)},function(t,e,n){"use strict";var r,i;n.d(e,"a",(function(){return i})),function(t){t[t.NAVIGATION=0]="NAVIGATION",t[t.MODEL=1]="MODEL",t[t.EXT_LINK=2]="EXT_LINK"}(i||(i={}));(r={})[i.NAVIGATION]="navigation",r[i.MODEL]="model",r[i.EXT_LINK]="ext-link"},function(t,e,n){"use strict";n.r(e);var r,i=n(0),o=n(4),a=n(202),s=n(193),c=n(258),u=n(91),l=n(3),h=n(123),f=n(2),p=n(66),d=n(113),y=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),m=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},v=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},g=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},b=new f.a("measurements"),w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="measurements-data",e.tryInferRooms=function(t){var n=new i.Jc;for(var r in t){var o=t[r];if(o.type===p.a.ThreeD&&(void 0===o.room||-1===o.room)){var a=e.roomData.roomIdsFromPoint(o.start_position);if(1===a.length)o.room=a[0];else{n.copy(o.start_position).addScaledVector(l.b.UP,.2);var s=e.raycaster.picking.pick(n,l.b.DOWN,d.b);s&&s.object instanceof h.a&&(o.room=s.object.roomIndex,o.floor=s.object.floorIndex)}}}},e.tryInferFloors=function(t){for(var n in t){var r=t[n];if(void 0===r.floor||r.floor<0)try{var i=e.floorsData.getFloorContainingPoint(r.start_position,!0)||e.floorsData.getFloorAtHeight(r.start_position.y,!0);i&&(r.floor=i.floorIndex)}catch(t){b.debug("Couldn't find valid floor for measurement "+r.sid+", defaulting to 0"),r.floor=0}}},e.tryInferGroups=function(t){var e,n,r=Object.keys(t);if(!r.every((function(e){return void 0!==t[e].group&&-1!==t[e].group}))){var i=0,o=0,a=0,s={},c={},u=new Set,l=function(t){return t.x.toFixed(5)+","+t.y.toFixed(5)+","+t.z.toFixed(5)};try{for(var h=g(r),f=h.next();!f.done;f=h.next()){var p=f.value,d=t[p],y=l(d.start_position),m=l(d.end_position);u.has(y)?(o=s[y],a=t[c[y]].groupOrder+1):u.has(m)?(o=s[m],a=t[c[m]].groupOrder+1):(o=i++,a=0),u.has(y)||u.add(y),u.has(m)||u.add(m),s[y]=o,s[m]=o,c[y]=d.sid,c[m]=d.sid,d.group=o,d.groupOrder=a,d.commit()}}catch(t){e={error:t}}finally{try{f&&!f.done&&(n=h.return)&&n.call(h)}finally{if(e)throw e.error}}}},e}return y(e,t),e.prototype.init=function(t,e){return m(this,void 0,void 0,(function(){var n,r,i,o,l,h;return v(this,(function(f){switch(f.label){case 0:return n={},r=[this.tryInferRooms,this.tryInferFloors,this.tryInferGroups],[4,t.measurementsSync.load()];case 1:return n=f.sent()||{},i=this,[4,e.market.waitForData(s.a)];case 2:return i.floorsData=f.sent(),o=this,[4,e.market.waitForData(c.a)];case 3:return o.roomData=f.sent(),l=this,[4,e.getModule(u.default)];case 4:return l.raycaster=f.sent(),h=Object(a.c)(n,r),b.debug("Creating "+h.length+" measurements",h.getCollection()),e.market.register(this,a.a,h),[2]}}))}))},e.prototype.onUpdate=function(t){},e}(o.a);e.default=w},function(t,e,n){"use strict";n.d(e,"b",(function(){return f})),n.d(e,"c",(function(){return d})),n.d(e,"a",(function(){return y}));var r=n(0),i=n(7),o=n(21),a=n(65),s=n(172),c=new r.Ic,u=new r.Jc,l=new r.Ic,h=new r.Ic,f=function(t,e,n){var r=function(t,e,n){return Object(a.g)(n,t,l),Object(a.g)(n,e,h),{pixelDistance:l.distanceTo(h),startScreenPosition:l,endScreenPosition:h}}(t,e,n);return{screenPosition:function(t,e,n){return u.copy(t).add(e).multiplyScalar(.5),Object(a.g)(n,u,c),c}(t,e,n),rotation:p(l,h),pixelDistance:r.pixelDistance,startScreenPosition:r.startScreenPosition,endScreenPosition:r.endScreenPosition}},p=function(t,e){var n=t.y-e.y,r=t.x-e.x,o=Math.atan2(n,r)*i.c;return o=o>=90||o<=-90?o+180:o},d=function(t,e){void 0===e&&(e=o.c.USFractional);var n='0"';switch(e){case o.c.USFractional:var r=Object(s.c)(t),i=r.feet,a=r.inches;n=i>0?i+"' "+a+'"':a+'"';break;case o.c.Metric:n=t.toFixed(2)+"m"}return n},y=function(t,e,n){void 0===e&&(e=10),void 0===n&&(n=40);return{width:Math.max(9*Math.max(t,2)+e,n),height:18+e}}},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(202),a=n(117),s=n(87),c=n(270),u=n(362),l=n(18),h=n(17),f=n(15),p=n(173),d=n(98),y=n(35),m=n(26),v=n(21),g=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),b=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},w=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="measurements-viewdata",e.isFeatureEnabled=function(){return!1},e.dirty=!1,e.setDirty=function(){e.dirty=!0},e.updateViewData=function(){e.data.iterate((function(t,n){e.viewData.derivedData[n]=e.makeViewDataForMeasurement(t,e.viewData.derivedData[n])})),e.viewData.commit(),e.dirty=!1},e.makeViewDataForMeasurement=function(t,n){return e.lineDerivedDataFactory.make(t.sid,(function(){return t}),n)},e}return g(e,t),e.prototype.init=function(t,e){return b(this,void 0,void 0,(function(){var t,n,r,i,g,b,_=this;return w(this,(function(w){switch(w.label){case 0:return t=this,[4,e.market.waitForData(o.a)];case 1:return t.data=w.sent(),n=this,[4,e.market.waitForData(l.a)];case 2:return n.cameraData=w.sent(),r=this,[4,e.market.waitForData(y.b)];case 3:return r.floorsViewData=w.sent(),i=this,[4,e.market.waitForData(h.a)];case 4:return i.viewmodeData=w.sent(),g=this,[4,e.market.waitForData(f.a)];case 5:return g.sweepData=w.sent(),b=this,[4,e.market.waitForData(m.a)];case 6:return b.settingsData=w.sent(),this.lineDerivedDataFactory=new u.a(this.cameraData,this.viewmodeData,this.floorsViewData,(function(){return Object(p.a)(_.sweepData)}),(function(){return _.getUnitType()}),(function(){return _.isFeatureEnabled()})),this.viewData=new c.a(this.data),this.viewData.initialize(e),this.viewData.setViewDataFactory(this.makeViewDataForMeasurement),e.market.register(this,c.a,this.viewData),this.defaultFeatureCheck(),this.setDirty(),this.bindings.push(this.cameraData.onChanged(this.setDirty),e.subscribe(d.a,this.setDirty),this.floorsViewData.onChanged(this.setDirty),this.viewData.onChanged(this.setDirty),this.settingsData.onPropertyChanged(a.b,this.setDirty),this.settingsData.onPropertyChanged(v.a.Measurements,this.setDirty),this.settingsData.onPropertyChanged(v.a.SavedMeasurements,this.setDirty),this.settingsData.onPropertyChanged(s.a.UnitType,this.setDirty)),[2]}}))}))},e.prototype.getUnitType=function(){return this.settingsData.tryGetProperty(s.a.UnitType,v.c.USFractional)},e.prototype.setFeatureVisibilityCheck=function(t){this.isFeatureEnabled=t,this.setDirty()},e.prototype.defaultFeatureCheck=function(){var t=this;this.setFeatureVisibilityCheck((function(){var e=t.settingsData.tryGetProperty(a.b,!1),n=t.settingsData.tryGetProperty(v.a.Measurements,!1),r=t.settingsData.tryGetProperty(v.a.SavedMeasurements,!1);return n&&r&&e}))},e.prototype.dispose=function(e){t.prototype.dispose.call(this,e),this.settingsData.removeOnPropertyChanged(a.b,this.setDirty),this.settingsData.removeOnPropertyChanged(v.a.Measurements,this.setDirty),this.settingsData.removeOnPropertyChanged(v.a.SavedMeasurements,this.setDirty),this.settingsData.removeOnPropertyChanged(s.a.UnitType,this.setDirty)},e.prototype.onUpdate=function(t){this.viewData.iterateDerived((function(e){e.opacity.tick(t)})),this.isFeatureEnabled()&&this.dirty&&this.updateViewData()},e}(i.a);e.default=_},function(t,e,n){"use strict";var r=n(2),i=n(12),o=n(210),a=n(349),s=n(211),c=n(6),u=n(96),l=n(131),h=n(188),f=n(322),p=n(264),d=n(440),y=n(218),m=n(217),v=n(146),g=n(71),b=n(92),w=n(31),_=n(60),x=n(156),S=n(420),T=n(323),M=n(305),E=n(25),P=n(216),O=n(314),A=n(310),D=n(319),R=n(275),C=n(87),I=n(56),k=n(53),L=n(246),N=n(140),j=n(241),B=n(364),F=n(198),U=n(448),z=n(50),G=n(439),H=n(97),V=n(91),W=n(324),q=n(268),Y=n(438),J=n(445),X=n(437),K=n(423),Q=n(424),Z=n(317),$=n(365),tt=n(280),et=n(441),nt=n(449),rt=n(303),it=n(345),ot=n(447),at=n(263),st=n(425),ct=n(304),ut=n(426),lt=n(368),ht=n(370),ft=n(325),pt=n(138),dt=n(154),yt=n(240),mt=n(118),vt=n(412),gt=n(195),bt=n(316),wt=n(1),_t=n(199),xt=n(442),St=n(181),Tt=n(427),Mt=n(446),Et=n(315),Pt=n(428),Ot=n(219),At=n(429),Dt=n(159),Rt=n(430),Ct=n(431),It=n(444),kt=n(17),Lt=n(135),Nt=n(432),jt=n(433),Bt=n(436),Ft=n(21),Ut=n(326),zt=n(55),Gt=n(434),Ht=n(196),Vt=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},Wt=new r.a("AB"),qt=function(){function t(t){for(var e in this.values={},t){var n=t[e];if(n&&n.ab)try{this.values[e]=Yt(n.ab)}catch(t){Wt.warn("Skipping key "+e+", could not pick: "+t)}}}return t.prototype.get=function(t){return this.values[t]},t.prototype.serialize=function(){var t=this;return Object.keys(this.values).map((function(e){return e+":"+t.values[e]}))},t}();function Yt(t){var e,n,r,i;if(0===t.length)throw Error("A/B cannot choose from an empty choice array");var o=0;try{for(var a=Vt(t),s=a.next();!s.done;s=a.next()){if(void 0===(f=s.value).value||void 0===f.weight||f.weight<0)throw Error("Malformed AB choice: "+f);o+=f.weight}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}var c=Math.random()*o,u=0;try{for(var l=Vt(t),h=l.next();!h.done;h=l.next()){var f;if(c<=(u+=(f=h.value).weight))return f.value}}catch(t){r={error:t}}finally{try{h&&!h.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}}var Jt=n(46),Xt=n(93),Kt=n(459),Qt=n(117),Zt=n(215),$t=n(259),te=n(14),ee=n(197),ne=n(52),re=n(350),ie=n(13),oe=new r.a("showcase-settings/quality"),ae=n(435),se=n(58),ce=n(184),ue=n(243),le=n(90),he=n(20),fe=n(443),pe=n(190),de=n(416),ye=n(242),me=n(24),ve=n(363),ge=function(t,e,n){var r=this;this.engine=t,this.onErrorCallback=n,this.ticking=!1,this.start=function(){r.ticking=!0},this.stop=function(){r.ticking=!1},this.tick=function(t,e){if(r.ticking)try{r.engine.setXrFrame(e),r.engine.tick()}catch(t){r.stop(),r.onErrorCallback(t)}},e.setAnimationLoop(this.tick)},be=n(148),we=n(160),_e=function(){function t(t,e){this.proxy=t,this.target=e}return t.prototype.beginExternalTransition=function(){this.proxy.activeSession(this)&&this.target.beginExternalTransition()},t.prototype.endExternalTransition=function(){this.proxy.activeSession(this)&&this.target.endExternalTransition()},t.prototype.updateCameraPosition=function(t){this.proxy.activeSession(this)&&this.target.updateCameraPosition(t)},t.prototype.updateCameraRotation=function(t){this.proxy.activeSession(this)&&this.target.updateCameraRotation(t)},t.prototype.updateCameraFocus=function(t){this.proxy.activeSession(this)&&this.target.updateCameraFocus(t)},t.prototype.moveTo=function(t){return this.proxy.activeSession(this)?this.target.moveTo(t):me.a.resolve()},t}(),xe=function(){function t(t,e){this.controller=t,this.data=e,this.proxies=[]}return Object.defineProperty(t.prototype,"pose",{get:function(){return this.data},enumerable:!0,configurable:!0}),t.prototype.activeSession=function(t){return 0!==this.proxies.length&&this.proxies[this.proxies.length-1].controller===t},t.prototype.newSession=function(t){var e=this,n=null;if(-1!==this.proxies.findIndex((function(e){return e.requester===t})))throw new Error("Cannot create two sessions with the same requester");return Object(we.b)((function(){if(!n){if(e.proxies.length>0){var r=e.proxies[e.proxies.length-1];r.requester.onAccessRevoked(r.controller)}n=new _e(e,e.controller),e.proxies.push({controller:n,requester:t}),t.onAccessGranted(n)}}),(function(){if(n){var t=e.proxies.findIndex((function(t){return t.controller===n}));if(-1!==t){var r=e.proxies[t],i=t===e.proxies.length-1;if(i&&r.requester.onAccessRevoked(r.controller),e.proxies.splice(t,1),e.proxies.length>0&&i){var o=e.proxies[e.proxies.length-1];o.requester.onAccessGranted(o.controller)}}}}))},t}(),Se=n(18),Te=n(147);n.d(e,"a",(function(){return Ce}));var Me=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},Ee=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Pe=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},Oe=new r.a("showcase"),Ae=window.MP_PREFETCHED_MODELDATA,De=Ae&&Ae.model&&!Ae.model.has_public_access_password?Ae.model:null,Re=function(){function t(t,e,n){void 0===n&&(n={});var r=this;this.sdkBindings=t,this.inWorkshop=e,this.settingOverrides=n,this.urlValues=c.s(),this.storeQueue=new b.RequestQueue({retries:0}),this.scanmodelStoreCache={data:De},this.errorPromise=new me.a,this.quickstart="1"===this.urlValues.qs,this.stopTourHook=function(t){return Me(r,void 0,void 0,(function(){var e;return Ee(this,(function(n){switch(n.label){case 0:return(e=t.market.tryGetData(k.a))&&e.tourPlaying?[4,t.commandBinder.issueCommand(new ue.d)]:[3,3];case 1:return n.sent(),[4,Object(he.d)(10)];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))};var i=this.settingOverrides,o=i.apiHost,a=i.container;this.apiHost=o||window.location.origin,this.container=a||document.body,this.modelUrls=Object(gt.d)(this.urlValues.m||this.urlValues.model,this.apiHost),this.modelUrl=this.modelUrls.urlBase+"/api/v1/player/models/"+this.modelUrls.sid}return t.prototype.getManifest=function(){var t=[{type:o.default,promise:function(){return Promise.resolve().then(n.bind(null,210))}},{type:I.default,promise:function(){return Promise.resolve().then(n.bind(null,56))}},{type:pe.default,promise:function(){return Promise.resolve().then(n.bind(null,190))}},{type:y.default,promise:function(){return Promise.resolve().then(n.bind(null,218))}},{type:O.default,promise:function(){return Promise.resolve().then(n.bind(null,314))}},{type:_t.default,promise:function(){return Promise.resolve().then(n.bind(null,199))}},{type:v.default,promise:function(){return Promise.resolve().then(n.bind(null,146))}},{type:u.default,promise:function(){return Promise.resolve().then(n.bind(null,96))}},{type:V.default,promise:function(){return Promise.resolve().then(n.bind(null,91))}},{type:h.default,promise:function(){return Promise.resolve().then(n.bind(null,188))}},{type:p.default,promise:function(){return Promise.resolve().then(n.bind(null,264))}},{type:mt.default,promise:function(){return Promise.resolve().then(n.bind(null,118))}},{type:x.default,promise:function(){return Promise.resolve().then(n.bind(null,156))}},{type:P.default,promise:function(){return Promise.resolve().then(n.bind(null,216))}},{type:E.default,promise:function(){return Promise.resolve().then(n.bind(null,25))}},{type:a.default,promise:function(){return Promise.resolve().then(n.bind(null,349))}},{type:s.default,promise:function(){return Promise.resolve().then(n.bind(null,211))}},{type:w.default,promise:function(){return Promise.resolve().then(n.bind(null,31))}},{type:St.default,promise:function(){return Promise.resolve().then(n.bind(null,181))}},{type:_.default,promise:function(){return Promise.resolve().then(n.bind(null,60))}},{type:ve.default,promise:function(){return Promise.resolve().then(n.bind(null,363))}},{type:S.default,promise:function(){return Promise.all([n.e(1),n.e(0),n.e(2)]).then(n.bind(null,420))}},{type:F.default,promise:function(){return Promise.all([n.e(1),n.e(0),n.e(2)]).then(n.bind(null,198))}},{type:U.default,promise:function(){return Promise.all([n.e(1),n.e(0),n.e(2)]).then(n.bind(null,448))}},{type:G.default,promise:function(){return Promise.all([n.e(1),n.e(0),n.e(2)]).then(n.bind(null,439))}},{type:z.default,promise:function(){return Promise.all([n.e(1),n.e(0),n.e(2)]).then(n.bind(null,50))}},{type:H.default,promise:function(){return Promise.all([n.e(1),n.e(0),n.e(2)]).then(n.bind(null,97))}},{type:Rt.default,promise:function(){return Promise.all([n.e(1),n.e(0),n.e(2)]).then(n.bind(null,430))}},{type:q.default,promise:function(){return Promise.all([n.e(1),n.e(0),n.e(2)]).then(n.bind(null,268))}},{type:Dt.default,promise:function(){return Promise.all([n.e(1),n.e(0),n.e(2)]).then(n.bind(null,159))}},{type:yt.default,promise:function(){return Promise.all([n.e(1),n.e(0),n.e(2)]).then(n.bind(null,240))}},{type:dt.default,promise:function(){return Promise.all([n.e(1),n.e(0),n.e(2)]).then(n.bind(null,154))}},{type:tt.default,promise:function(){return Promise.all([n.e(1),n.e(0),n.e(2)]).then(n.bind(null,280))}},{type:Gt.default,promise:function(){return Promise.all([n.e(1),n.e(0),n.e(2)]).then(n.bind(null,434))}},{type:Y.default,promise:function(){return Promise.all([n.e(1),n.e(0),n.e(2)]).then(n.bind(null,438))}},{type:J.default,promise:function(){return Promise.all([n.e(1),n.e(0),n.e(2)]).then(n.bind(null,445))}},{type:K.default,promise:function(){return Promise.all([n.e(1),n.e(0),n.e(2)]).then(n.bind(null,423))}},{type:et.default,promise:function(){return Promise.all([n.e(1),n.e(0),n.e(2)]).then(n.bind(null,441))}},{type:nt.default,promise:function(){return Promise.all([n.e(1),n.e(0),n.e(2)]).then(n.bind(null,449))}},{type:vt.default,promise:function(){return Promise.resolve().then(n.bind(null,412))}},{type:At.default,promise:function(){return Promise.all([n.e(1),n.e(0),n.e(2)]).then(n.bind(null,429))}},{type:D.default,promise:function(){return Promise.all([n.e(1),n.e(0),n.e(2)]).then(n.bind(null,319))}},{type:R.default,promise:function(){return Promise.all([n.e(1),n.e(0),n.e(2)]).then(n.bind(null,275))}},{type:m.default,promise:function(){return Promise.all([n.e(1),n.e(0),n.e(2)]).then(n.bind(null,217))}},{type:$.default,promise:function(){return Promise.resolve().then(n.bind(null,365))}},{type:Q.default,promise:function(){return Promise.resolve().then(n.bind(null,424))}},{type:Z.default,promise:function(){return Promise.resolve().then(n.bind(null,317))}},{type:bt.default,promise:function(){return Promise.resolve().then(n.bind(null,316))}},{type:ct.default,promise:function(){return Promise.resolve().then(n.bind(null,304))}},{type:ut.default,promise:function(){return Promise.resolve().then(n.bind(null,426))}},{type:lt.default,promise:function(){return Promise.resolve().then(n.bind(null,368))}},{type:ht.default,promise:function(){return Promise.resolve().then(n.bind(null,370))}},{type:rt.default,promise:function(){return Promise.resolve().then(n.bind(null,303))}},{type:it.default,promise:function(){return Promise.resolve().then(n.bind(null,345))}},{type:ot.default,promise:function(){return Promise.resolve().then(n.bind(null,447))}},{type:at.default,promise:function(){return Promise.resolve().then(n.bind(null,263))}},{type:st.default,promise:function(){return Promise.resolve().then(n.bind(null,425))}},{type:M.default,promise:function(){return Promise.resolve().then(n.bind(null,305))}},{type:B.default,promise:function(){return Promise.resolve().then(n.bind(null,364))}},{type:j.default,promise:function(){return Promise.resolve().then(n.bind(null,241))}},{type:xt.default,promise:function(){return Promise.resolve().then(n.bind(null,442))}},{type:jt.default,promise:function(){return Promise.resolve().then(n.bind(null,433))}},{type:Bt.default,promise:function(){return Promise.resolve().then(n.bind(null,436))}},{type:Tt.default,promise:function(){return Promise.resolve().then(n.bind(null,427))}},{type:d.default,promise:function(){return Promise.resolve().then(n.bind(null,440))}},{type:Ct.default,promise:function(){return Promise.resolve().then(n.bind(null,431))}},{type:It.default,promise:function(){return Promise.resolve().then(n.bind(null,444))}},{type:pt.default,promise:function(){return Promise.resolve().then(n.bind(null,138))}},{type:ae.default,promise:function(){return Promise.resolve().then(n.bind(null,435))}},{type:Lt.default,promise:function(){return Promise.resolve().then(n.bind(null,135))}},{type:Nt.default,promise:function(){return Promise.resolve().then(n.bind(null,432))}},{type:fe.default,promise:function(){return Promise.resolve().then(n.bind(null,443))}},{type:Mt.default,promise:function(){return Promise.resolve().then(n.bind(null,446))}},{type:Et.default,promise:function(){return Promise.resolve().then(n.bind(null,315))}},{type:Pt.default,promise:function(){return Promise.resolve().then(n.bind(null,428))}},{type:Ot.default,promise:function(){return Promise.resolve().then(n.bind(null,219))}},{type:X.default,promise:function(){return Promise.resolve().then(n.bind(null,437))}}],e=Object(de.b)();return e&&t.push(e),t},t.prototype.getAppPhases=function(t){var e,n=this;return(e={})[i.a.UNINITIALIZED]=[],e[i.a.WAITING]=[Me(n,void 0,void 0,(function(){return Ee(this,(function(e){switch(e.label){case 0:return[4,t.getModule(_t.default)];case 1:return e.sent(),[2]}}))}))],e[i.a.LOADING]=[Me(n,void 0,void 0,(function(){return Ee(this,(function(e){switch(e.label){case 0:return[4,t.getModule(_t.default)];case 1:return[2,e.sent().waitForPlaying]}}))}))],e[i.a.STARTING]=[Me(n,void 0,void 0,(function(){return Ee(this,(function(e){switch(e.label){case 0:return[4,t.getModule(D.default)];case 1:return[2,e.sent().waitForFirstRender]}}))}))],e[i.a.PLAYING]=[Me(n,void 0,void 0,(function(){return Ee(this,(function(e){switch(e.label){case 0:return[4,t.getModule(D.default)];case 1:return[2,e.sent().waitForFlyin]}}))}))],e[i.a.ERROR]=[this.errorPromise.nativePromise()],e},t.prototype.getStorageProvider=function(t){void 0===t&&(t="");var e=!1;return"mds"in this.urlValues&&(e="1"===this.urlValues.mds||!(!t||!this.urlValues.mds.split(",").includes(t))),e&&Oe.warn("Enabled experimental MDS "+t+" storage provider in Showcase"),e?be.a.MDS:be.a.JSONSTORE},t.prototype.setError=function(t){this.errorPromise.reject(t),this.engineTick.stop()},t.prototype.load=function(t,e){return Me(this,void 0,Promise,(function(){var n,h,f,p,y,b,w,x,T,P,O,A,N,V,X,tt,dt,mt,gt,Vt,Wt,Yt,he,ye,me,be,we,_e,De,Re,Ce,Ie,ke,Le,Ne,je,Be,Fe,Ue,ze,Ge,He,Ve,We,qe,Ye,Je,Xe,Ke,Qe,Ze,$e,tn,en,nn=this;return Ee(this,(function(rn){switch(rn.label){case 0:return this.engine=t,this.engine.loadModule({type:o.default,config:{tasks:this.getAppPhases(t)}}),this.engine.loadModule({type:I.default,config:{useGUI:!0}}),this.engine.loadModule({type:pe.default}),t.getModule(o.default).then((function(t){t.updateActiveApp(i.b.SHOWCASE)})),t.market.waitForData(i.c).then((function(e){e.onChanged((function(){return Me(nn,void 0,void 0,(function(){var n,r;return Ee(this,(function(o){switch(o.label){case 0:return e.phase!==i.a.ERROR?[3,2]:(n=e.error,[4,t.getModule(St.default)]);case 1:throw r=o.sent(),n instanceof Ht.c?r.showError(St.ErrorType.UNSUPPORTED):n instanceof Ht.b?r.showError(St.ErrorType.WEBGL):r.showError(St.ErrorType.GENERIC),n;case 2:return[2]}}))}))}))})),e.coldStart?(Oe.info("Showcase app version: 3.1.10.4-0-ga56ce8cdd"),this.canvas=document.createElement("canvas"),this.canvas.className="webgl-canvas",p=document.querySelector("#app-container"),y=document.querySelector("#canvas-container"),b=parseInt(this.urlValues.log,10),this.urlValues.hasOwnProperty("log")&&!isNaN(b)&&(r.a.level=b),this.quickstart&&Oe.info("Quickstart engaged. Hold on to your knickers. "+performance.now()),this.engine.loadModule({type:v.default,config:{queue:this.storeQueue,prefetchedData:Ae,baseUrl:this.modelUrls.urlBase,preloadConfig:"showcase"}}),this.engine.loadModule({type:E.default,config:{canvas:this.canvas,antialias:"1"===this.urlValues.aa}}),this.engine.loadModule({type:_.default}),this.engine.loadModule({type:a.default,config:{container:p}}),this.engine.loadModule({type:s.default,config:{canvas:this.canvas,container:y}}),this.engine.loadModule({type:ve.default}),[4,Promise.all([t.getModule(v.default),t.getModule(E.default),t.getModule(I.default),t.getModule(_.default)])]):(this.loadUI(),[2]);case 1:for(_e in w=Pe.apply(void 0,[rn.sent(),4]),x=w[0],T=w[1],P=w[2],O=w[3],this.engineTick=new ge(this.engine,T.threeRenderer,(function(t){nn.engine.getModule(St.default).then((function(e){nn.setError(t),e.showError(St.ErrorType.GENERIC)}))})),A=x.getApi(),N=A.user.getFlags("showcase/"),V=Object(ee.d)(parseFloat(this.urlValues.wts)),X=this.urlValues,tt=X.labels,dt=X.mt,mt=X.measure,gt=X.savedMeasurements,Vt=X.smooth,Wt=X.sc2pan,Yt=X.roomnav,he=N.has(Qt.c)&&"0"!==mt,ye=N.has(Qt.b)&&"0"!==gt,me=N.has(Qt.a),be="en-US"===navigator.language?Ft.c.USFractional:Ft.c.Metric,we={Features:(n={},n[$t.a]=!0,n[Jt.b]=!0,n[Zt.a]=!0,n[Kt.a]="0"!==tt,n[Xt.b]="0"!==dt,n[te.d]=void 0===Vt&&N.has(te.d)||"0"!==Vt,n[te.c]=void 0===Wt&&N.has(te.c)||"0"!==Wt,n[Te.b]=void 0===Yt&&N.has(Te.b)||void 0!==Yt&&"0"!==Yt,n[Qt.c]=he,n[Qt.b]=he&&ye,n[te.e]=V,n[Qt.a]=me,n),"User Preferences":(h={},h[C.a.UnitType]=be,h[C.a.MeasurementSnapping]=!0,h[C.a.MeasurementContinuousLines]=!0,h[C.a.MeasurementUserNudgeSeen]=!1,h)})for(Ce in we[_e])void 0!==we[_e][Ce]&&(De="User Preferences"===_e?I.SettingPersistence.LOCAL_STORAGE:I.SettingPersistence.NONE,P.registerSetting(_e,Ce,we[_e][Ce],!0,De));for(Ce in(f={})[ce.a]="showcase_3.0",f[ce.b]="showcase",f[se.a]=null,f.sid=this.modelUrls.sid,f.quickstart=this.quickstart,f.lang=this.urlValues.lang,f.perf=this.urlValues.perf,f.perfInterval=this.urlValues.perfInterval,Re=f)P.updateSetting(Ce,Re[Ce]);if(this.settingOverrides)for(Ce in this.settingOverrides)P.updateSetting(Ce,this.settingOverrides[Ce]);return[4,A.getConfigs("showcase")];case 2:return Ie=rn.sent(),ke=new qt(Ie),this.loadInitialAppModules(ke,T.gpuInfo,we),P.hasProperty(Xt.a)||P.updateSetting(Xt.a,Ie.embedly_key),Le=new g.c({queue:this.storeQueue,path:this.modelUrl,deserialize:function(t){return t},cachedData:this.scanmodelStoreCache}),[4,this.loadModel(this.modelUrls.sid,e,A,Le).catch((function(t){nn.setError(t)}))];case 3:rn.sent(),this.setupSdk(t,A),t.commandBinder.hookCommand(le.a,!0,(function(){return nn.stopTourHook(t)})),t.commandBinder.hookCommand(ue.c,!0,(function(){return nn.stopTourHook(t)})),rn.label=4;case 4:return rn.trys.push([4,6,,7]),[4,t.waitForLoadingModules()];case 5:return rn.sent(),[3,7];case 6:return Ne=rn.sent(),this.setError(Ne),t.tick(),[3,7];case 7:return je=document,[4,t.getModule(u.default)];case 8:return je.title=rn.sent().getModel().data.name,[4,t.market.waitForData(l.a)];case 9:return Be=rn.sent().pose,!this.quickstart||Be&&Be.mode===wt.a.Panorama||(Oe.warn("Disabling quickstart. No panorama start position."),this.quickstart=!1,P.updateSetting("quickstart",!1)),Fe=function(t,e){var n,r,i,o;Object(c.n)()||Object(c.j)()?Object(c.n)()&&Object(re.b)(e)?(n=ne.e.ULTRA,r=ie.a[ie.d.STANDARD],i=ie.a[ie.d.HIGH],o=10):(n=ne.e.MEDIUM,r=ie.a[ie.d.STANDARD],i=ie.a[ie.d.HIGH],o=6):(n=ne.e.ULTRA,r=ie.a[ie.d.HIGH],i=ie.a[ie.d.ULTRAHIGH],o=20);try{n=t.maxmeshq?Object(ne.f)(parseInt(t.maxmeshq,10)):n}catch(e){oe.warn("Not a valid texture size: "+t.maxmeshq)}return{maxMeshQuality:n,navPanoSize:r=t.maxtileq?parseInt(t.maxtileq,10):r,zoomPanoSize:i=t.maxztileq?parseInt(t.maxztileq,10):i,textureLODThreshold:o=t.lodtexth?parseInt(t.lodtexth,10):o}}(this.urlValues,T.gpuInfo),Ue=Fe.maxMeshQuality,ze=Fe.navPanoSize,Ge=Fe.zoomPanoSize,He=Fe.textureLODThreshold,Oe.info({maxMeshQuality:Ue,navPanoSize:ze,zoomPanoSize:Ge,textureLODThreshold:He,gpuInfo:T.gpuInfo}),"0"===this.urlValues.tiles?[3,11]:[4,this.engine.loadModule({type:F.default,config:{navPanoSize:ze,zoomPanoSize:Ge}})];case 10:return rn.sent(),[3,13];case 11:return[4,this.engine.loadModule({type:U.default})];case 12:rn.sent(),rn.label=13;case 13:return[4,this.engine.loadModule({type:G.default})];case 14:return rn.sent(),this.quickstart&&(this.loadPanoControls(),this.engineTick.start()),[4,t.getModule(_t.default)];case 15:return[4,rn.sent().waitForPlaying];case 16:return rn.sent(),Ve=new g.c({queue:this.storeQueue,path:this.modelUrl,deserialize:Ut.a,cachedData:this.scanmodelStoreCache}),We=new zt.e({publishStores:[Ve]}),qe=new g.c({queue:this.storeQueue,path:this.modelUrl,deserialize:W.a,cachedData:this.scanmodelStoreCache}),Ye=new zt.e({publishStores:[qe]}),[4,t.market.waitForData(Se.a)];case 17:return Je=rn.sent(),Xe=function(t,e){return new xe(t,e)}(O,Je.pose),this.engine.loadModule({type:Gt.default,config:{container:this.container}}),this.engine.loadModule({type:z.default,config:{renderMeshGeometry:!0,maxQuality:Ue,textureLOD:"2"===this.urlValues.texlod?z.TextureLOD.RAYCAST:"0"===this.urlValues.texlod?z.TextureLOD.NONE:ke.get("raycast_lod")?z.TextureLOD.RAYCAST:z.TextureLOD.NONE,textureLODThreshold:void 0!==this.urlValues.texlodthreshold?parseInt(this.urlValues.texlodthreshold,10):He,maxEdgeLength:this.urlValues.tessellate?parseFloat(this.urlValues.tessellate):void 0,colorizeRooms:"1"===this.urlValues.colorizeRooms,colorizeChunks:"1"===this.urlValues.colorizeChunks,wireframe:"1"===this.urlValues.wireframe}}),this.engine.loadModule({type:Rt.default}),this.engine.loadModule({type:H.default,config:{startingMode:this.quickstart?wt.a.Panorama:null}}),this.engine.loadModule({type:J.default}),this.engine.loadModule({type:S.default}),this.engine.loadModule({type:q.default,config:{floorsSync:Ye}}),this.engine.loadModule({type:Y.default,config:{disableFloorchanges:"0"===this.urlValues.f,focusBasedNav:we.Features[Te.b]}}),this.engine.loadModule({type:Dt.default}),this.engine.loadModule({type:yt.default,config:{sid:this.modelUrls.sid,container:this.container}}),this.engine.loadModule({type:K.default}),this.engine.loadModule({type:et.default,config:{cameraPoseProxy:Xe}}),this.engine.loadModule({type:nt.default}),this.engine.loadModule({type:vt.default,config:{enabled:"1"!==this.urlValues.nozoom,tiles:"0"!==this.urlValues.tiles}}),this.engine.loadModule({type:D.default}),this.engine.loadModule({type:m.default,config:{enableWheel:"1"===this.urlValues.nozoom,focusBasedNav:we.Features[Te.b]}}),this.engine.loadModule({type:R.default,config:{optionsSync:We,modelDetailsStore:Le}}),this.engine.loadModule({type:At.default}),this.quickstart||this.engineTick.start(),this.quickstart||this.loadPanoControls(),[4,this.engine.waitForLoadingModules()];case 18:return rn.sent(),Object(de.c)(t,Xe),"/api/v1/jsonstore/model/",Ke=this.modelUrls.urlBase+"/api/v1/jsonstore/model/measurements/"+this.modelUrls.sid,Qe=new g.c({queue:this.storeQueue,path:Ke,deserialize:ft.a}),Ze=new zt.a({publishStores:[Qe]}),$e=this.modelUrls.urlBase+"/api/v1/jsonstore/model/highlights/"+this.modelUrls.sid,tn=new g.c({queue:this.storeQueue,path:$e,deserialize:L.b}),en=new zt.e({publishStores:[tn]}),"0"!==this.urlValues.portal&&(this.engine.loadModule({type:Et.default}),this.engine.loadModule({type:Mt.default})),"0"!==this.urlValues.pin&&(this.engine.loadModule({type:Ot.default}),this.engine.loadModule({type:Pt.default})),this.engine.loadModule({type:$.default,config:{checkRenderModes:function(){var e=t.market.tryGetData(k.a);if(e&&e.isTourActive())return!1;var n=t.market.tryGetData(kt.a);return!!n&&n.isPano()}}}),this.engine.loadModule({type:ct.default,config:{modelId:this.modelUrls.sid,baseUrl:this.modelUrls.urlBase,storageProvider:this.getStorageProvider("labels"),readonly:!0}}),this.engine.loadModule({type:ut.default}),this.engine.loadModule({type:lt.default,config:{measurementsSync:Ze}}),this.engine.loadModule({type:ht.default}),this.engine.loadModule({type:pt.default}),this.engine.loadModule({type:rt.default,config:{modelId:this.modelUrls.sid,baseUrl:this.modelUrls.urlBase,storageProvider:this.getStorageProvider("mattertags"),readonly:!0,parserOptions:{model:this.modelUrls.sid,supportLinks:!this.urlValues.mls||"0"===this.urlValues.mls,keepLinkLabels:!0}}}),this.engine.loadModule({type:it.default}),this.engine.loadModule({type:ot.default}),this.engine.loadModule({type:at.default}),this.engine.loadModule({type:st.default}),this.engine.loadModule({type:M.default}),this.engine.loadModule({type:B.default,config:{activeReelSync:en,looping:"1"===this.urlValues.lp}}),this.engine.loadModule({type:j.default}),this.engine.loadModule({type:xt.default}),this.engine.loadModule({type:Q.default}),this.engine.loadModule({type:Z.default}),this.engine.loadModule({type:bt.default}),this.engine.loadModule({type:jt.default}),this.engine.loadModule({type:Tt.default}),this.engine.loadModule({type:Ct.default}),this.engine.loadModule({type:It.default}),this.engine.loadModule({type:ae.default}),this.engine.loadModule({type:fe.default}),this.engine.loadModule({type:Lt.default,config:{inputDebug:"1"===this.urlValues.tapeDebug,floorplanDebug:"1"===this.urlValues.floorplanDebug}}),this.engine.loadModule({type:Nt.default}),this.engine.loadModule({type:d.default,config:{queue:this.storeQueue,uploadEndpoint:this.modelUrl+"/images/"}}),this.engine.loadModule({type:Bt.default,config:{enableEventPositions:!1,framebufferScaling:Math.min(this.urlValues.xrframebuffer?parseFloat(this.urlValues.xrframebuffer):0,1),tracking:0,navPanoSize:ze}}),[2]}}))}))},t.prototype.unload=function(t){return Me(this,void 0,Promise,(function(){var e;return Ee(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,t.getModuleSync(j.default).stopTour()];case 1:return n.sent(),[3,3];case 2:return e=n.sent(),Oe.debug("showcase unload called before tour controls registered, ignoring stopTour",e),[3,3];case 3:return[4,this.guiModule.unloadUi(this.guiNode)];case 4:return n.sent(),t.commandBinder.resetHooks(),[2]}}))}))},t.prototype.loadModel=function(t,e,n,r){return Me(this,void 0,void 0,(function(){var i=this;return Ee(this,(function(o){switch(o.label){case 0:return Oe.info("Loading model "+t),[4,n.modelExists(t).catch((function(t){return Me(i,void 0,void 0,(function(){return Ee(this,(function(e){switch(e.label){case 0:return t instanceof ye.c?[4,this.login()]:[3,2];case 1:return e.sent(),[3,3];case 2:throw t;case 3:return[2]}}))}))}))];case 1:return o.sent(),this.loadInitialDataModules(this.modelUrls.sid,e,r),[2]}}))}))},t.prototype.loadInitialAppModules=function(t,e,n){this.engine.loadModule({type:V.default}),this.engine.loadModule({type:w.default,config:{disableWheel:"0"===this.urlValues.wh,pointerPreventDefault:!this.settingOverrides||!this.settingOverrides.hasOwnProperty("pointerPreventDefault")||!!this.settingOverrides.pointerPreventDefault}}),this.engine.loadModule({type:mt.default,config:{queue:this.storeQueue}}),this.engine.loadModule({type:P.default,config:{provider:this.urlValues.analytics,additionalValues:{ab_tests:t.serialize(),gpu:e}}}),this.engine.loadModule({type:St.default})},t.prototype.loadInitialDataModules=function(t,e,n){var r=new g.c({queue:this.storeQueue,path:this.modelUrl,deserialize:f.a,cachedData:this.scanmodelStoreCache}),i=new zt.e({publishStores:[r]}),o=new g.c({queue:this.storeQueue,path:this.modelUrl,deserialize:N.c,cachedData:this.scanmodelStoreCache}),a=this.modelUrls.urlBase+"/api/v2/models/"+this.modelUrls.sid+"/sweeps?tag=showcase",s=new g.c({queue:this.storeQueue,path:a,deserialize:Object(T.a)(!0),cachedData:{data:null}}),l=new zt.a({publishStores:[s]}),d=!("1"!==this.urlValues.play&&!e.autoPlay),y=c.o()&&!c.d("xr-spatial-tracking"),m=!c.g()||d&&!y,v=!(c.n()||y);this.engine.loadModule({type:_t.default,config:{inWorkshop:this.inWorkshop,modelDetailsStore:n,sid:this.modelUrls.sid,baseUrl:this.modelUrls.urlBase,quickstart:this.quickstart,autoplay:m,allowPlayInIframe:v,startNewTab:"1"===this.urlValues.nt,hideTitle:"0"===this.urlValues.title||"2"===this.urlValues.title,hideBranding:"1"===this.urlValues.mls||"2"===this.urlValues.mls||"0"===this.urlValues.brand}}),this.engine.loadModule({type:p.default,config:{snapshotsStore:o}}),this.engine.loadModule({type:X.default,config:{sid:this.modelUrls.sid,queue:this.storeQueue,storageProvider:this.getStorageProvider("semantic")}}),this.engine.loadModule({type:h.default,config:{cameraStartSync:i}}),this.engine.loadModule({type:u.default,config:{modelDetailsStore:n,sid:this.modelUrls.sid}}),this.engine.loadModule({type:x.default,config:{sweepSync:l}})},t.prototype.loadPanoControls=function(){this.loadUI(),this.engine.loadModule({type:dt.default}),this.engine.loadModule({type:tt.default})},t.prototype.setupSdk=function(t,e){return Me(this,void 0,void 0,(function(){function n(){return Me(this,void 0,Promise,(function(){var t,n;return Ee(this,(function(r){switch(r.label){case 0:return[4,e.getAppKey("showcase","sdk_version")];case 1:return(t=r.sent())?t.startsWith("https")?n=t:/^\d+\.\d+\.\d+\.\d+-\d+\-g\w{9}$/.test(t)?n="https://static.matterport.com/showcase/"+t+"/sdk-client.js":(Oe.warn("The sdk client version was configured incorrectly. Falling back to the last built version."),n="./sdk-client.js"):(Oe.warn("The sdk client version was not configured. Falling back to the last built version."),n="./sdk-client.js"),[2,n]}}))}))}var r;return Ee(this,(function(e){switch(e.label){case 0:return[4,n().catch((function(t){return Oe.error(t),"./sdk-client.js"}))];case 1:return r=e.sent(),this.engine.loadModule({type:y.default,config:{validationUrl:this.apiHost+"/api/v1/user/",clientScriptUrl:r,queue:this.storeQueue}}),Object(y.setupSdk)(t,this.sdkBindings),[2]}}))}))},t.prototype.loadUI=function(){var t=this;Promise.all([this.engine.getModule(yt.default),Promise.all([n.e(1),n.e(0),n.e(2)]).then(n.bind(null,1530))]).then((function(e){var n=Pe(e,2),r=n[0],i=n[1];t.guiModule=r,r.loadUi(i.initShowcaseUi).then((function(e){t.guiNode=e}))}))},t.prototype.login=function(){var t=this;return new Promise((function(e){return Me(t,void 0,void 0,(function(){var t;return Ee(this,(function(n){switch(n.label){case 0:return this.engine.loadModule({type:O.default,config:{modelId:this.modelUrls.sid,baseUrl:this.modelUrls.urlBase,container:this.container}}),[4,this.engine.getModule(O.default)];case 1:return t=n.sent(),this.engine.subscribe(A.b,(function(){t.hidePasswordScreen(),e()})),t.showPasswordScreen(),[2]}}))}))}))},t}(),Ce=(e.b=Re,function(t,e){return Me(void 0,void 0,void 0,(function(){return Ee(this,(function(r){switch(r.label){case 0:return[4,n.e(6).then(n.bind(null,1528))];case 1:return r.sent().bindSdkInterface(t,t.commandBinder,e),[2]}}))}))})},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(5),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e){var n=t.call(this)||this;return n.payload={appPhase:e},n}return o(e,t),e.id="START_APPLICATION",e}(i.a)},,,function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){"use strict";n.d(e,"e",(function(){return o})),n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return s})),n.d(e,"d",(function(){return c})),n.d(e,"a",(function(){return u}));var r=n(0),i=new(n(2).a)("sdk.utils"),o=function(t){return!!t&&(t instanceof r.Jc||!!("object"==typeof t&&"x"in t&&"y"in t&&"z"in t&&s(t.x)&&s(t.y)&&s(t.z)))},a=function(t){return!!t&&(t instanceof r.s||!!("object"==typeof t&&"r"in t&&"g"in t&&"b"in t&&s(t.r)&&s(t.g)&&s(t.b)))},s=function(t){if(null==t||isNaN(t))return!1;if("number"==typeof t)return!0;var e=parseFloat(t);return!isNaN(e)&&"number"==typeof e},c=function(t){if(void 0!==t)return s(t)?t:void i.warn('transitionTime was not a valid number, received "'+t+'". Using default transition time.')};function u(t){return t-0}},function(t,e,n){var r=n(226),i=n(378),o=n(379),a=n(248),s=n(380),c=n(204),u=n(471),l=Object.getOwnPropertyDescriptor;e.f=r?l:function(t,e){if(t=a(t),e=s(e,!0),u)try{return l(t,e)}catch(t){}if(c(t,e))return o(!i.f.call(t,e),t[e])}},function(t,e,n){"use strict";var r={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,o=i&&!r.call({1:2},1);e.f=o?function(t){var e=i(this,t);return!!e&&e.enumerable}:r},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){var r=n(249);t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){var r=n(153),i=n(286);t.exports=function(t,e){try{i(r,t,e)}catch(n){r[t]=e}return e}},function(t,e,n){var r=n(288),i=n(383),o=r("keys");t.exports=function(t){return o[t]||(o[t]=i(t))}},function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++n+r).toString(36)}},function(t,e,n){var r=n(478),i=n(385).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,i)}},function(t,e){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(t,e,n){var r=n(478),i=n(385);t.exports=Object.keys||function(t){return r(t,i)}},function(t,e,n){"use strict";t.exports=n(663)()?Object.assign:n(664)},function(t,e,n){"use strict";t.exports=n(669)()?String.prototype.contains:n(670)},function(t,e,n){"use strict";var r,i=n(492),o=n(387),a=n(186),s=n(185),c=n(227),u=n(690),l=n(205),h=Object.defineProperty,f=Object.defineProperties;t.exports=r=function(t,e){if(!(this instanceof r))throw new TypeError("Constructor requires 'new'");f(this,{__list__:c("w",s(t)),__context__:c("w",e),__nextIndex__:c("w",0)}),e&&(a(e.on),e.on("_add",this._onAdd),e.on("_delete",this._onDelete),e.on("_clear",this._onClear))},delete r.prototype.constructor,f(r.prototype,o({_next:c((function(){var t;if(this.__list__)return this.__redo__&&void 0!==(t=this.__redo__.shift())?t:this.__nextIndex__<this.__list__.length?this.__nextIndex__++:void this._unBind()})),next:c((function(){return this._createResult(this._next())})),_createResult:c((function(t){return void 0===t?{done:!0,value:void 0}:{done:!1,value:this._resolve(t)}})),_resolve:c((function(t){return this.__list__[t]})),_unBind:c((function(){this.__list__=null,delete this.__redo__,this.__context__&&(this.__context__.off("_add",this._onAdd),this.__context__.off("_delete",this._onDelete),this.__context__.off("_clear",this._onClear),this.__context__=null)})),toString:c((function(){return"[object "+(this[l.toStringTag]||"Object")+"]"}))},u({_onAdd:c((function(t){t>=this.__nextIndex__||(++this.__nextIndex__,this.__redo__?(this.__redo__.forEach((function(e,n){e>=t&&(this.__redo__[n]=++e)}),this),this.__redo__.push(t)):h(this,"__redo__",c("c",[t])))})),_onDelete:c((function(t){var e;t>=this.__nextIndex__||(--this.__nextIndex__,this.__redo__&&(-1!==(e=this.__redo__.indexOf(t))&&this.__redo__.splice(e,1),this.__redo__.forEach((function(e,n){e>t&&(this.__redo__[n]=--e)}),this)))})),_onClear:c((function(){this.__redo__&&i.call(this.__redo__),this.__nextIndex__=0}))}))),h(r.prototype,l.iterator,c((function(){return this})))},function(t,e,n){"use strict";(function(e){var r=n(37),i=n(499),o=new Array(16);function a(){i.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}function s(t,e){return t<<e|t>>>32-e}function c(t,e,n,r,i,o,a){return s(t+(e&n|~e&r)+i+o|0,a)+e|0}function u(t,e,n,r,i,o,a){return s(t+(e&r|n&~r)+i+o|0,a)+e|0}function l(t,e,n,r,i,o,a){return s(t+(e^n^r)+i+o|0,a)+e|0}function h(t,e,n,r,i,o,a){return s(t+(n^(e|~r))+i+o|0,a)+e|0}r(a,i),a.prototype._update=function(){for(var t=o,e=0;e<16;++e)t[e]=this._block.readInt32LE(4*e);var n=this._a,r=this._b,i=this._c,a=this._d;n=c(n,r,i,a,t[0],3614090360,7),a=c(a,n,r,i,t[1],3905402710,12),i=c(i,a,n,r,t[2],606105819,17),r=c(r,i,a,n,t[3],3250441966,22),n=c(n,r,i,a,t[4],4118548399,7),a=c(a,n,r,i,t[5],1200080426,12),i=c(i,a,n,r,t[6],2821735955,17),r=c(r,i,a,n,t[7],4249261313,22),n=c(n,r,i,a,t[8],1770035416,7),a=c(a,n,r,i,t[9],2336552879,12),i=c(i,a,n,r,t[10],4294925233,17),r=c(r,i,a,n,t[11],2304563134,22),n=c(n,r,i,a,t[12],1804603682,7),a=c(a,n,r,i,t[13],4254626195,12),i=c(i,a,n,r,t[14],2792965006,17),n=u(n,r=c(r,i,a,n,t[15],1236535329,22),i,a,t[1],4129170786,5),a=u(a,n,r,i,t[6],3225465664,9),i=u(i,a,n,r,t[11],643717713,14),r=u(r,i,a,n,t[0],3921069994,20),n=u(n,r,i,a,t[5],3593408605,5),a=u(a,n,r,i,t[10],38016083,9),i=u(i,a,n,r,t[15],3634488961,14),r=u(r,i,a,n,t[4],3889429448,20),n=u(n,r,i,a,t[9],568446438,5),a=u(a,n,r,i,t[14],3275163606,9),i=u(i,a,n,r,t[3],4107603335,14),r=u(r,i,a,n,t[8],1163531501,20),n=u(n,r,i,a,t[13],2850285829,5),a=u(a,n,r,i,t[2],4243563512,9),i=u(i,a,n,r,t[7],1735328473,14),n=l(n,r=u(r,i,a,n,t[12],2368359562,20),i,a,t[5],4294588738,4),a=l(a,n,r,i,t[8],2272392833,11),i=l(i,a,n,r,t[11],1839030562,16),r=l(r,i,a,n,t[14],4259657740,23),n=l(n,r,i,a,t[1],2763975236,4),a=l(a,n,r,i,t[4],1272893353,11),i=l(i,a,n,r,t[7],4139469664,16),r=l(r,i,a,n,t[10],3200236656,23),n=l(n,r,i,a,t[13],681279174,4),a=l(a,n,r,i,t[0],3936430074,11),i=l(i,a,n,r,t[3],3572445317,16),r=l(r,i,a,n,t[6],76029189,23),n=l(n,r,i,a,t[9],3654602809,4),a=l(a,n,r,i,t[12],3873151461,11),i=l(i,a,n,r,t[15],530742520,16),n=h(n,r=l(r,i,a,n,t[2],3299628645,23),i,a,t[0],4096336452,6),a=h(a,n,r,i,t[7],1126891415,10),i=h(i,a,n,r,t[14],2878612391,15),r=h(r,i,a,n,t[5],4237533241,21),n=h(n,r,i,a,t[12],1700485571,6),a=h(a,n,r,i,t[3],2399980690,10),i=h(i,a,n,r,t[10],4293915773,15),r=h(r,i,a,n,t[1],2240044497,21),n=h(n,r,i,a,t[8],1873313359,6),a=h(a,n,r,i,t[15],4264355552,10),i=h(i,a,n,r,t[6],2734768916,15),r=h(r,i,a,n,t[13],1309151649,21),n=h(n,r,i,a,t[4],4149444226,6),a=h(a,n,r,i,t[11],3174756917,10),i=h(i,a,n,r,t[2],718787259,15),r=h(r,i,a,n,t[9],3951481745,21),this._a=this._a+n|0,this._b=this._b+r|0,this._c=this._c+i|0,this._d=this._d+a|0},a.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var t=new e(16);return t.writeInt32LE(this._a,0),t.writeInt32LE(this._b,4),t.writeInt32LE(this._c,8),t.writeInt32LE(this._d,12),t},t.exports=a}).call(this,n(59).Buffer)},function(t,e,n){t.exports=i;var r=n(231).EventEmitter;function i(){r.call(this)}n(37)(i,r),i.Readable=n(392),i.Writable=n(714),i.Duplex=n(715),i.Transform=n(716),i.PassThrough=n(717),i.Stream=i,i.prototype.pipe=function(t,e){var n=this;function i(e){t.writable&&!1===t.write(e)&&n.pause&&n.pause()}function o(){n.readable&&n.resume&&n.resume()}n.on("data",i),t.on("drain",o),t._isStdio||e&&!1===e.end||(n.on("end",s),n.on("close",c));var a=!1;function s(){a||(a=!0,t.end())}function c(){a||(a=!0,"function"==typeof t.destroy&&t.destroy())}function u(t){if(l(),0===r.listenerCount(this,"error"))throw t}function l(){n.removeListener("data",i),t.removeListener("drain",o),n.removeListener("end",s),n.removeListener("close",c),n.removeListener("error",u),t.removeListener("error",u),n.removeListener("end",l),n.removeListener("close",l),t.removeListener("close",l)}return n.on("error",u),t.on("error",u),n.on("end",l),n.on("close",l),t.on("close",l),t.emit("pipe",n),t}},function(t,e,n){(e=t.exports=n(500)).Stream=e,e.Readable=e,e.Writable=n(393),e.Duplex=n(229),e.Transform=n(503),e.PassThrough=n(713)},function(t,e,n){"use strict";(function(e,r,i){var o=n(336);function a(t){var e=this;this.next=null,this.entry=null,this.finish=function(){!function(t,e,n){var r=t.entry;t.entry=null;for(;r;){var i=r.callback;e.pendingcb--,i(n),r=r.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}(e,t)}}t.exports=g;var s,c=!e.browser&&["v0.10","v0.9."].indexOf(e.version.slice(0,5))>-1?r:o.nextTick;g.WritableState=v;var u=n(290);u.inherits=n(37);var l={deprecate:n(712)},h=n(501),f=n(228).Buffer,p=i.Uint8Array||function(){};var d,y=n(502);function m(){}function v(t,e){s=s||n(229),t=t||{};var r=e instanceof s;this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var i=t.highWaterMark,u=t.writableHighWaterMark,l=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(u||0===u)?u:l,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var h=!1===t.decodeStrings;this.decodeStrings=!h,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,e){var n=t._writableState,r=n.sync,i=n.writecb;if(function(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}(n),e)!function(t,e,n,r,i){--e.pendingcb,n?(o.nextTick(i,r),o.nextTick(T,t,e),t._writableState.errorEmitted=!0,t.emit("error",r)):(i(r),t._writableState.errorEmitted=!0,t.emit("error",r),T(t,e))}(t,n,r,e,i);else{var a=x(n);a||n.corked||n.bufferProcessing||!n.bufferedRequest||_(t,n),r?c(w,t,n,a,i):w(t,n,a,i)}}(e,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new a(this)}function g(t){if(s=s||n(229),!(d.call(g,this)||this instanceof s))return new g(t);this._writableState=new v(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),h.call(this)}function b(t,e,n,r,i,o,a){e.writelen=r,e.writecb=a,e.writing=!0,e.sync=!0,n?t._writev(i,e.onwrite):t._write(i,o,e.onwrite),e.sync=!1}function w(t,e,n,r){n||function(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}(t,e),e.pendingcb--,r(),T(t,e)}function _(t,e){e.bufferProcessing=!0;var n=e.bufferedRequest;if(t._writev&&n&&n.next){var r=e.bufferedRequestCount,i=new Array(r),o=e.corkedRequestsFree;o.entry=n;for(var s=0,c=!0;n;)i[s]=n,n.isBuf||(c=!1),n=n.next,s+=1;i.allBuffers=c,b(t,e,!0,e.length,i,"",o.finish),e.pendingcb++,e.lastBufferedRequest=null,o.next?(e.corkedRequestsFree=o.next,o.next=null):e.corkedRequestsFree=new a(e),e.bufferedRequestCount=0}else{for(;n;){var u=n.chunk,l=n.encoding,h=n.callback;if(b(t,e,!1,e.objectMode?1:u.length,u,l,h),n=n.next,e.bufferedRequestCount--,e.writing)break}null===n&&(e.lastBufferedRequest=null)}e.bufferedRequest=n,e.bufferProcessing=!1}function x(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function S(t,e){t._final((function(n){e.pendingcb--,n&&t.emit("error",n),e.prefinished=!0,t.emit("prefinish"),T(t,e)}))}function T(t,e){var n=x(e);return n&&(!function(t,e){e.prefinished||e.finalCalled||("function"==typeof t._final?(e.pendingcb++,e.finalCalled=!0,o.nextTick(S,t,e)):(e.prefinished=!0,t.emit("prefinish")))}(t,e),0===e.pendingcb&&(e.finished=!0,t.emit("finish"))),n}u.inherits(g,h),v.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(v.prototype,"buffer",{get:l.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(d=Function.prototype[Symbol.hasInstance],Object.defineProperty(g,Symbol.hasInstance,{value:function(t){return!!d.call(this,t)||this===g&&(t&&t._writableState instanceof v)}})):d=function(t){return t instanceof this},g.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},g.prototype.write=function(t,e,n){var r,i=this._writableState,a=!1,s=!i.objectMode&&(r=t,f.isBuffer(r)||r instanceof p);return s&&!f.isBuffer(t)&&(t=function(t){return f.from(t)}(t)),"function"==typeof e&&(n=e,e=null),s?e="buffer":e||(e=i.defaultEncoding),"function"!=typeof n&&(n=m),i.ended?function(t,e){var n=new Error("write after end");t.emit("error",n),o.nextTick(e,n)}(this,n):(s||function(t,e,n,r){var i=!0,a=!1;return null===n?a=new TypeError("May not write null values to stream"):"string"==typeof n||void 0===n||e.objectMode||(a=new TypeError("Invalid non-string/buffer chunk")),a&&(t.emit("error",a),o.nextTick(r,a),i=!1),i}(this,i,t,n))&&(i.pendingcb++,a=function(t,e,n,r,i,o){if(!n){var a=function(t,e,n){t.objectMode||!1===t.decodeStrings||"string"!=typeof e||(e=f.from(e,n));return e}(e,r,i);r!==a&&(n=!0,i="buffer",r=a)}var s=e.objectMode?1:r.length;e.length+=s;var c=e.length<e.highWaterMark;c||(e.needDrain=!0);if(e.writing||e.corked){var u=e.lastBufferedRequest;e.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},u?u.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else b(t,e,!1,s,r,i,o);return c}(this,i,s,t,e,n)),a},g.prototype.cork=function(){this._writableState.corked++},g.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.finished||t.bufferProcessing||!t.bufferedRequest||_(this,t))},g.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+t);return this._writableState.defaultEncoding=t,this},Object.defineProperty(g.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),g.prototype._write=function(t,e,n){n(new Error("_write() is not implemented"))},g.prototype._writev=null,g.prototype.end=function(t,e,n){var r=this._writableState;"function"==typeof t?(n=t,t=null,e=null):"function"==typeof e&&(n=e,e=null),null!=t&&this.write(t,e),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||function(t,e,n){e.ending=!0,T(t,e),n&&(e.finished?o.nextTick(n):t.once("finish",n));e.ended=!0,t.writable=!1}(this,r,n)},Object.defineProperty(g.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),g.prototype.destroy=y.destroy,g.prototype._undestroy=y.undestroy,g.prototype._destroy=function(t,e){this.end(),e(t)}}).call(this,n(169),n(710).setImmediate,n(144))},function(t,e,n){"use strict";var r=n(228).Buffer,i=r.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(t){var e;switch(this.encoding=function(t){var e=function(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}(t);if("string"!=typeof e&&(r.isEncoding===i||!i(t)))throw new Error("Unknown encoding: "+t);return e||t}(t),this.encoding){case"utf16le":this.text=c,this.end=u,e=4;break;case"utf8":this.fillLast=s,e=4;break;case"base64":this.text=l,this.end=h,e=3;break;default:return this.write=f,void(this.end=p)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(e)}function a(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function s(t){var e=this.lastTotal-this.lastNeed,n=function(t,e,n){if(128!=(192&e[0]))return t.lastNeed=0,"";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,""}}(this,t);return void 0!==n?n:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function c(t,e){if((t.length-e)%2==0){var n=t.toString("utf16le",e);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function u(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,n)}return e}function l(t,e){var n=(t.length-e)%3;return 0===n?t.toString("base64",e):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-n))}function h(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function f(t){return t.toString(this.encoding)}function p(t){return t&&t.length?this.write(t):""}e.StringDecoder=o,o.prototype.write=function(t){if(0===t.length)return"";var e,n;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<t.length?e?e+this.text(t,n):this.text(t,n):e||""},o.prototype.end=function(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"":e},o.prototype.text=function(t,e){var n=function(t,e,n){var r=e.length-1;if(r<n)return 0;var i=a(e[r]);if(i>=0)return i>0&&(t.lastNeed=i-1),i;if(--r<n||-2===i)return 0;if((i=a(e[r]))>=0)return i>0&&(t.lastNeed=i-2),i;if(--r<n||-2===i)return 0;if((i=a(e[r]))>=0)return i>0&&(2===i?i=0:t.lastNeed=i-3),i;return 0}(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=n;var r=t.length-(n-this.lastNeed);return t.copy(this.lastChar,0,r),t.toString("utf8",e,r)},o.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}},function(t,e,n){"use strict";var r=n(59).Buffer,i=n(37),o=n(499),a=new Array(16),s=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],c=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],u=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],l=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],h=[0,1518500249,1859775393,2400959708,2840853838],f=[1352829926,1548603684,1836072691,2053994217,0];function p(){o.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}function d(t,e){return t<<e|t>>>32-e}function y(t,e,n,r,i,o,a,s){return d(t+(e^n^r)+o+a|0,s)+i|0}function m(t,e,n,r,i,o,a,s){return d(t+(e&n|~e&r)+o+a|0,s)+i|0}function v(t,e,n,r,i,o,a,s){return d(t+((e|~n)^r)+o+a|0,s)+i|0}function g(t,e,n,r,i,o,a,s){return d(t+(e&r|n&~r)+o+a|0,s)+i|0}function b(t,e,n,r,i,o,a,s){return d(t+(e^(n|~r))+o+a|0,s)+i|0}i(p,o),p.prototype._update=function(){for(var t=a,e=0;e<16;++e)t[e]=this._block.readInt32LE(4*e);for(var n=0|this._a,r=0|this._b,i=0|this._c,o=0|this._d,p=0|this._e,w=0|this._a,_=0|this._b,x=0|this._c,S=0|this._d,T=0|this._e,M=0;M<80;M+=1){var E,P;M<16?(E=y(n,r,i,o,p,t[s[M]],h[0],u[M]),P=b(w,_,x,S,T,t[c[M]],f[0],l[M])):M<32?(E=m(n,r,i,o,p,t[s[M]],h[1],u[M]),P=g(w,_,x,S,T,t[c[M]],f[1],l[M])):M<48?(E=v(n,r,i,o,p,t[s[M]],h[2],u[M]),P=v(w,_,x,S,T,t[c[M]],f[2],l[M])):M<64?(E=g(n,r,i,o,p,t[s[M]],h[3],u[M]),P=m(w,_,x,S,T,t[c[M]],f[3],l[M])):(E=b(n,r,i,o,p,t[s[M]],h[4],u[M]),P=y(w,_,x,S,T,t[c[M]],f[4],l[M])),n=p,p=o,o=d(i,10),i=r,r=E,w=T,T=S,S=d(x,10),x=_,_=P}var O=this._b+i+S|0;this._b=this._c+o+T|0,this._c=this._d+p+w|0,this._d=this._e+n+_|0,this._e=this._a+r+x|0,this._a=O},p.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var t=r.alloc?r.alloc(20):new r(20);return t.writeInt32LE(this._a,0),t.writeInt32LE(this._b,4),t.writeInt32LE(this._c,8),t.writeInt32LE(this._d,12),t.writeInt32LE(this._e,16),t},t.exports=p},function(t,e,n){(e=t.exports=function(t){t=t.toLowerCase();var n=e[t];if(!n)throw new Error(t+" is not supported (we accept pull requests)");return new n}).sha=n(718),e.sha1=n(719),e.sha224=n(720),e.sha256=n(504),e.sha384=n(721),e.sha512=n(505)},function(t,e,n){"use strict";e.utils=n(728),e.Cipher=n(729),e.DES=n(730),e.CBC=n(731),e.EDE=n(732)},function(t,e,n){var r=n(733),i=n(741),o=n(517);e.createCipher=e.Cipher=r.createCipher,e.createCipheriv=e.Cipheriv=r.createCipheriv,e.createDecipher=e.Decipher=i.createDecipher,e.createDecipheriv=e.Decipheriv=i.createDecipheriv,e.listCiphers=e.getCiphers=function(){return Object.keys(o)}},function(t,e,n){var r={ECB:n(734),CBC:n(735),CFB:n(736),CFB8:n(737),CFB1:n(738),OFB:n(739),CTR:n(515),GCM:n(515)},i=n(517);for(var o in i)i[o].module=r[i[o].mode];t.exports=i},function(t,e,n){(function(e){var r=n(95),i=n(252);function o(t,n){var i=function(t){var e=a(t);return{blinder:e.toRed(r.mont(t.modulus)).redPow(new r(t.publicExponent)).fromRed(),unblinder:e.invm(t.modulus)}}(n),o=n.modulus.byteLength(),s=(r.mont(n.modulus),new r(t).mul(i.blinder).umod(n.modulus)),c=s.toRed(r.mont(n.prime1)),u=s.toRed(r.mont(n.prime2)),l=n.coefficient,h=n.prime1,f=n.prime2,p=c.redPow(n.exponent1),d=u.redPow(n.exponent2);p=p.fromRed(),d=d.fromRed();var y=p.isub(d).imul(l).umod(h);return y.imul(f),d.iadd(y),new e(d.imul(i.unblinder).umod(n.modulus).toArray(!1,o))}function a(t){for(var e=t.modulus.byteLength(),n=new r(i(e));n.cmp(t.modulus)>=0||!n.umod(t.prime1)||!n.umod(t.prime2);)n=new r(i(e));return n}t.exports=o,o.getr=a}).call(this,n(59).Buffer)},function(t,e,n){var r=e;r.utils=n(171),r.common=n(292),r.sha=n(757),r.ripemd=n(761),r.hmac=n(762),r.sha1=r.sha.sha1,r.sha256=r.sha.sha256,r.sha224=r.sha.sha224,r.sha384=r.sha.sha384,r.sha512=r.sha.sha512,r.ripemd160=r.ripemd.ripemd160},function(t,e){t.exports="varying vec2 vUv;\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n"},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=Function.prototype.toString,o=/^\s*class /,a=function(t){try{var e=i.call(t).replace(/\/\/.*\n/g,"").replace(/\/\*[.\s\S]*\*\//g,"").replace(/\n/gm," ").replace(/ {2}/g," ");return o.test(e)}catch(t){return!1}},s=Object.prototype.toString,c="function"==typeof Symbol&&"symbol"===r(Symbol.toStringTag);t.exports=function(t){if(!t)return!1;if("function"!=typeof t&&"object"!==r(t))return!1;if(c)return function(t){try{return!a(t)&&(i.call(t),!0)}catch(t){return!1}}(t);if(a(t))return!1;var e=s.call(t);return"[object Function]"===e||"[object GeneratorFunction]"===e}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(9),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(5),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e){var n=t.call(this)||this;return n.payload={pose:e},n}return o(e,t),e}(i.a)},function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return s}));var r,i=n(5),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e){var n=t.call(this)||this;return n.id="PIN_UNSELECT",n.payload={id:e},n}return o(e,t),e}(i.a),s=function(t){function e(e,n){var r=t.call(this)||this;return r.id="HIGHLIGHT_PIN",r.payload={sweepId:e,highlight:n},r}return o(e,t),e}(i.a)},,,,function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(9),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e){var n=t.call(this)||this;return n.is360=e,n}return o(e,t),e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return p}));var r,i=n(0),o=n(42),a=n(120),s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=new i.Jc(0,0,0),u=new i.Jc(100,100,100),l=new i.Jc,h=new i.Jc,f=new i.h,p=function(t){function e(){var e=t.call(this)||this;return e.bounds=new i.h,e.geometry=new i.j(1,1,1),e.geometry.computeBoundingBox(),e.geometry.computeBoundingSphere(),e.chunk=new a.a(-1,-1,e.geometry),e.chunk.onMaterialUpdate=function(t){e.material=t,e.material.side=i.f,e.material.transparent=!0,e.material.depthWrite=!1},e.chunk.onMaterialUpdate(e.chunk.material),e.name="FallbackMesh",e.renderOrder=o.a.boundingSkybox,e.setFromCenterAndSize(c,u),e}return s(e,t),e.prototype.setBounds=function(t){if(!this.bounds.equals(t)){this.bounds.copy(t);var e=t.getSize(l);this.position.copy(t.getCenter(h)),this.scale.set(e.x,e.y,e.z),this.updateMatrixWorld(!0)}},e.prototype.setFromCenterAndSize=function(t,e){void 0===e&&(e=u),this.setBounds(f.setFromCenterAndSize(t,e))},e}(i.lb)},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(31),a=n(8),s=n(130),c=n(16),u=n(77),l=n(60),h=n(18),f=n(79),p=n(17),d=n(1),y=n(198),m=n(15),v=n(0),g=n(68),b=n(7),w=n(127),_=n(278),x=n(2),S=n(355),T=n(13),M=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),E=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},P=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},O=new x.a("Showcase Zoom Controls"),A=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="zoom-controls",e.uhQuality={},e.config={enabled:!0,tiles:!0},e}return M(e,t),e.prototype.init=function(t,e){return E(this,void 0,void 0,(function(){var n,r,i,o,a,s,c=this;return P(this,(function(u){switch(u.label){case 0:if(this.config.enabled=!!t.enabled,this.config.tiles=!!t.tiles,!this.config.tiles)return[3,4];u.label=1;case 1:return u.trys.push([1,3,,4]),n=this,[4,e.getModule(y.default)];case 2:return n.sweepTilingModule=u.sent(),[3,4];case 3:return r=u.sent(),O.debug("Tiling not enabled for zoom controls - "+r),[3,4];case 4:return this.config.enabled?[4,this.registerControls(e)]:[3,6];case 5:u.sent(),u.label=6;case 6:return this.engine=e,i=this,[4,e.getModule(l.default)];case 7:return i.cameraModule=u.sent(),o=this,[4,e.market.waitForData(h.a)];case 8:return o.cameraData=u.sent(),a=this,[4,e.market.waitForData(p.a)];case 9:return a.viewmodeData=u.sent(),s=this,[4,e.market.waitForData(m.a)];case 10:return s.sweepData=u.sent(),this.bindings.push(e.commandBinder.addBinding(_.b,(function(t){return E(c,void 0,void 0,(function(){return P(this,(function(e){return[2,this.zoomBy(t.step)]}))}))})),e.commandBinder.addBinding(_.c,(function(t){return E(c,void 0,void 0,(function(){return P(this,(function(e){return[2,this.zoomBy(-t.step)]}))}))})),e.commandBinder.addBinding(_.d,(function(){return E(c,void 0,void 0,(function(){return P(this,(function(t){return[2,this.zoomTo(1)]}))}))})),e.commandBinder.addBinding(_.e,(function(t){return E(c,void 0,void 0,(function(){return P(this,(function(e){return[2,this.zoomTo(t.value)]}))}))})),e.commandBinder.addBinding(_.a,this.getMaxZoomAvailable.bind(this))),[2]}}))}))},e.prototype.registerControls=function(t){return E(this,void 0,void 0,(function(){var e=this;return P(this,(function(n){return t.getModule(o.default).then((function(t){e.bindings.push(t.registerHandler(a.q,(function(t){return e.zoomByInput(e.scrollToZoomDelta(t))}))),e.bindings.push(t.registerHandler(a.l,(function(t){return e.zoomByInput(e.pinchToZoomDelta(t))}))),e.bindings.push(t.registerHandler(s.a,(function(t){return e.keyHandler(t)})))})),[2]}))}))},e.prototype.zoomTo=function(t){var e=this.cameraData.zoom();if(!this.validateViewmode())return e;this.engine.broadcast(new S.a(t));var n=this.sweepData.currentSweep;if(this.config.tiles&&this.checkTilingZoomLevels(t,n),(t=Object(b.e)(t,w.a.minZoom,w.a.maxHighResZoom))!==e){var r=v.ib.radToDeg(this.cameraData.baseFovY/t),i=f.a.near,o=f.a.far;this.cameraModule.updateCameraProjection((new g.a).makePerspectiveFov(r,this.cameraData.aspect(),i,o))}return t},e.prototype.checkTilingZoomLevels=function(t,e){var n=this;t>=w.a.highResThreshold&&this.zoomedSweep!==e?(this.zoomedSweep=e,this.sweepTilingModule.enableZooming(!0,e).then((function(t){t?n.uhQuality[e]=!0:(n.uhQuality[e]=!1,n.zoomedSweep=void 0)}))):t<w.a.highResThreshold&&this.zoomedSweep===e&&(this.sweepTilingModule.enableZooming(!1,this.zoomedSweep),this.zoomedSweep=void 0)},e.prototype.getMaxZoom=function(t){return this.uhQuality[t]?w.a.maxHighResZoom:w.a.maxZoom},e.prototype.zoomBy=function(t){var e=this.cameraData.zoom();return this.validateViewmode()?this.zoomTo(e+t):e},e.prototype.validateViewmode=function(){return this.viewmodeData.currentMode===d.a.Panorama&&this.cameraData.canTransition()},e.prototype.scrollToZoomDelta=function(t){return-Math.sign(t.delta.y)*w.a.zoomStep},e.prototype.pinchToZoomDelta=function(t){return t.pinchDelta*(w.a.maxZoom-w.a.minZoom)},e.prototype.zoomByInput=function(t){var e=this.cameraData.zoom();if(!this.validateViewmode())return e;var n=this.sweepData.currentSweep,r=Object(b.e)(e+t,w.a.minZoom,this.getMaxZoom(n));return this.zoomTo(r)},e.prototype.keyHandler=function(t){if(t.state===u.a.DOWN)switch(t.key){case c.a.PLUSEQUALS:this.zoomByInput(w.a.zoomStep);break;case c.a.DASHUNDERSCORE:this.zoomByInput(-w.a.zoomStep);break;case c.a.OPENBRACKET:this.zoomTo(1)}},e.prototype.getMaxZoomAvailable=function(){return E(this,void 0,Promise,(function(){var t;return P(this,(function(e){switch(e.label){case 0:return t=this.sweepData.currentSweep,[4,this.sweepTilingModule.availableResolution(t,T.d.ULTRAHIGH)];case 1:return[2,e.sent()>=T.d.ULTRAHIGH?w.a.maxHighResZoom:w.a.maxZoom]}}))}))},e}(i.a);e.default=A},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(5),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n,r){var i=t.call(this)||this;return i.id="MESH_PREVIEW_POSITION",i.payload={enabled:e,previewCirclePosition:n,size:r},i}return o(e,t),e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return s}));var r,i=n(5),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.id="WEBVR_PRELOAD",e}return o(e,t),e}(i.a),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.id="WEBVR_PRESENT",e}return o(e,t),e}(i.a)},function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return T})),n.d(e,"c",(function(){return E}));var r,i,o=n(5),a=n(25),s=n(43),c=n(100),u=n(96),l=n(189),h=n(15),f=n(3),p=n(28),d=n(0),y=n(115),m=n(149),v=n(2),g=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),b=function(){return(b=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},w=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},_=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},x=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},S=new v.a("Renderer");!function(t){t.Base64JPG="screenshot.base64.jpg",t.ArrayBufferJPG="screenshot.arraybuffer.jpg"}(i||(i={}));var T=function(t){function e(e){var n=t.call(this)||this;return n.id="SCREENSHOT",n.payload=b({},e),n}return g(e,t),e}(o.a),M=function(t){function e(){var e=t.call(this)||this;return e.id="EQSS",e.payload={},e}return g(e,t),e}(o.a),E=function(t,e,n){Promise.all([t.getModule(a.default),e.issueCommandWhenBound(new y.d),t.getModule(u.default),t.market.waitForData(h.a)]).then((function(t){var n=x(t,4),r=n[0],o=n[1],a=n[2],s=n[3],c=new l.a(a.getSignedUrls()),u=r.getScene().camera,h=r.getScene().scene,v=u.clone();e.addBinding(T,(function(t){return w(void 0,void 0,void 0,(function(){var n,a,s;return _(this,(function(c){switch(c.label){case 0:if(n=t.resolution,a=r.maxTextureSize,n.width<=0||n.width>a||n.height<=0||n.height>a)throw Error('"resolution" provided was not valid');return u.getWorldPosition(v.position),u.getWorldQuaternion(v.quaternion),v.projectionMatrix.copy(u.projectionMatrix),v.layers.mask=t.visibleObjects.mask,o.setSize(n.width,n.height),[4,e.issueCommand(new y.e(o,h,v))];case 1:return c.sent(),[4,Object(m.a)(o)];case 2:return s=c.sent(),o.setSize(0,0),t.returnType===i.ArrayBufferJPG?[2,s.buffer]:[2,Object(m.b)(s)]}}))}))}));var g=new d.Jc;u.getWorldDirection(g);var b=f.b.FORWARD.clone(),S=4096,E=2048;e.addBinding(M,(function(t){return w(void 0,void 0,void 0,(function(){var t,n,r,i;return _(this,(function(a){switch(a.label){case 0:if(!s.currentSweep)throw new Error("Can only capture equirectangular projections while stationary in a sweep");return[4,c.load(s.currentSweep)];case 1:return t=a.sent(),n=s.getSweep(s.currentSweep),b.copy(f.b.FORWARD).applyQuaternion(n.rotation).setY(0),r=Object(p.q)(b,u.getWorldDirection(g).setY(0))+Math.PI,o.setSize(S,E),[4,e.issueCommand(new y.c(o,t,r))];case 2:return a.sent(),[4,Object(m.a)(o,Object(m.d)(o.width,o.height,0,0))];case 3:return i=a.sent(),o.setSize(0,0),[2,Object(m.b)(i)]}}))}))}))}));var r=function(e){if(void 0===e&&(e={}),!e.resolution){var n=t.market.tryGetData(c.a);n&&(e.resolution={width:n.width,height:n.height})}var r=s.a.ALL;e.visibleObjects&&(e.visibleObjects.hasOwnProperty("mattertags")&&!e.visibleObjects.mattertags&&r.removeLayers(t.getRenderLayer("mattertag-mesh")),e.visibleObjects.hasOwnProperty("sweeps")&&!e.visibleObjects.sweep&&r.removeLayers(t.getRenderLayer("sweep-pucks")),e.visibleObjects.hasOwnProperty("measurements")&&!e.visibleObjects.measurements&&r.removeLayers(t.getRenderLayer("measurements")));var o=i.Base64JPG;return e.returnType&&(o=e.returnType.returnType),new T({resolution:e.resolution,visibleObjects:r,returnType:o})};n.addCommandToInterface({version:"3.x",namespace:"Renderer",name:"takeScreenShot",args:["resolution","visibleObjects","returnType"]},r),n.addCommandToInterface({version:"3.x",namespace:"Renderer",name:"takeEquirectangular",args:[]},(function(){return new M})),n.addCommandToInterface({version:"3.x",namespace:"Camera",name:"takeScreenShot",args:["resolution","visibleObjects"]},(function(t){return S.warn("Camera.takeScreenshot deprecated, please use Renderer.takeScreenshot"),r(t)}))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return s}));var r=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},i=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=[],a=function(){return null},s=function(t,e){return r(void 0,void 0,void 0,(function(){return i(this,(function(t){return[2,Promise.resolve()]}))}))}},,function(t,e,n){(function(n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i;e=t.exports=J,i="object"===(void 0===n?"undefined":r(n))&&n.env&&n.env.NODE_DEBUG&&/\bsemver\b/i.test(n.env.NODE_DEBUG)?function(){var t=Array.prototype.slice.call(arguments,0);t.unshift("SEMVER"),console.log.apply(console,t)}:function(){},e.SEMVER_SPEC_VERSION="2.0.0";var o=Number.MAX_SAFE_INTEGER||9007199254740991,a=e.re=[],s=e.src=[],c=0,u=c++;s[u]="0|[1-9]\\d*";var l=c++;s[l]="[0-9]+";var h=c++;s[h]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var f=c++;s[f]="("+s[u]+")\\.("+s[u]+")\\.("+s[u]+")";var p=c++;s[p]="("+s[l]+")\\.("+s[l]+")\\.("+s[l]+")";var d=c++;s[d]="(?:"+s[u]+"|"+s[h]+")";var y=c++;s[y]="(?:"+s[l]+"|"+s[h]+")";var m=c++;s[m]="(?:-("+s[d]+"(?:\\."+s[d]+")*))";var v=c++;s[v]="(?:-?("+s[y]+"(?:\\."+s[y]+")*))";var g=c++;s[g]="[0-9A-Za-z-]+";var b=c++;s[b]="(?:\\+("+s[g]+"(?:\\."+s[g]+")*))";var w=c++,_="v?"+s[f]+s[m]+"?"+s[b]+"?";s[w]="^"+_+"$";var x="[v=\\s]*"+s[p]+s[v]+"?"+s[b]+"?",S=c++;s[S]="^"+x+"$";var T=c++;s[T]="((?:<|>)?=?)";var M=c++;s[M]=s[l]+"|x|X|\\*";var E=c++;s[E]=s[u]+"|x|X|\\*";var P=c++;s[P]="[v=\\s]*("+s[E]+")(?:\\.("+s[E]+")(?:\\.("+s[E]+")(?:"+s[m]+")?"+s[b]+"?)?)?";var O=c++;s[O]="[v=\\s]*("+s[M]+")(?:\\.("+s[M]+")(?:\\.("+s[M]+")(?:"+s[v]+")?"+s[b]+"?)?)?";var A=c++;s[A]="^"+s[T]+"\\s*"+s[P]+"$";var D=c++;s[D]="^"+s[T]+"\\s*"+s[O]+"$";var R=c++;s[R]="(?:^|[^\\d])(\\d{1,16})(?:\\.(\\d{1,16}))?(?:\\.(\\d{1,16}))?(?:$|[^\\d])";var C=c++;s[C]="(?:~>?)";var I=c++;s[I]="(\\s*)"+s[C]+"\\s+",a[I]=new RegExp(s[I],"g");var k=c++;s[k]="^"+s[C]+s[P]+"$";var L=c++;s[L]="^"+s[C]+s[O]+"$";var N=c++;s[N]="(?:\\^)";var j=c++;s[j]="(\\s*)"+s[N]+"\\s+",a[j]=new RegExp(s[j],"g");var B=c++;s[B]="^"+s[N]+s[P]+"$";var F=c++;s[F]="^"+s[N]+s[O]+"$";var U=c++;s[U]="^"+s[T]+"\\s*("+x+")$|^$";var z=c++;s[z]="^"+s[T]+"\\s*("+_+")$|^$";var G=c++;s[G]="(\\s*)"+s[T]+"\\s*("+x+"|"+s[P]+")",a[G]=new RegExp(s[G],"g");var H=c++;s[H]="^\\s*("+s[P]+")\\s+-\\s+("+s[P]+")\\s*$";var V=c++;s[V]="^\\s*("+s[O]+")\\s+-\\s+("+s[O]+")\\s*$";var W=c++;s[W]="(<|>)?=?\\s*\\*";for(var q=0;q<35;q++)i(q,s[q]),a[q]||(a[q]=new RegExp(s[q]));function Y(t,e){if(t instanceof J)return t;if("string"!=typeof t)return null;if(t.length>256)return null;if(!(e?a[S]:a[w]).test(t))return null;try{return new J(t,e)}catch(t){return null}}function J(t,e){if(t instanceof J){if(t.loose===e)return t;t=t.version}else if("string"!=typeof t)throw new TypeError("Invalid Version: "+t);if(t.length>256)throw new TypeError("version is longer than 256 characters");if(!(this instanceof J))return new J(t,e);i("SemVer",t,e),this.loose=e;var n=t.trim().match(e?a[S]:a[w]);if(!n)throw new TypeError("Invalid Version: "+t);if(this.raw=t,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>o||this.major<0)throw new TypeError("Invalid major version");if(this.minor>o||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>o||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map((function(t){if(/^[0-9]+$/.test(t)){var e=+t;if(e>=0&&e<o)return e}return t})):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}e.parse=Y,e.valid=function(t,e){var n=Y(t,e);return n?n.version:null},e.clean=function(t,e){var n=Y(t.trim().replace(/^[=v]+/,""),e);return n?n.version:null},e.SemVer=J,J.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},J.prototype.toString=function(){return this.version},J.prototype.compare=function(t){return i("SemVer.compare",this.version,this.loose,t),t instanceof J||(t=new J(t,this.loose)),this.compareMain(t)||this.comparePre(t)},J.prototype.compareMain=function(t){return t instanceof J||(t=new J(t,this.loose)),K(this.major,t.major)||K(this.minor,t.minor)||K(this.patch,t.patch)},J.prototype.comparePre=function(t){if(t instanceof J||(t=new J(t,this.loose)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;var e=0;do{var n=this.prerelease[e],r=t.prerelease[e];if(i("prerelease compare",e,n,r),void 0===n&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===n)return-1;if(n!==r)return K(n,r)}while(++e)},J.prototype.inc=function(t,e){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e),this.inc("pre",e);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",e),this.inc("pre",e);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var n=this.prerelease.length;--n>=0;)"number"==typeof this.prerelease[n]&&(this.prerelease[n]++,n=-2);-1===n&&this.prerelease.push(0)}e&&(this.prerelease[0]===e?isNaN(this.prerelease[1])&&(this.prerelease=[e,0]):this.prerelease=[e,0]);break;default:throw new Error("invalid increment argument: "+t)}return this.format(),this.raw=this.version,this},e.inc=function(t,e,n,r){"string"==typeof n&&(r=n,n=void 0);try{return new J(t,n).inc(e,r).version}catch(t){return null}},e.diff=function(t,e){if(tt(t,e))return null;var n=Y(t),r=Y(e);if(n.prerelease.length||r.prerelease.length){for(var i in n)if(("major"===i||"minor"===i||"patch"===i)&&n[i]!==r[i])return"pre"+i;return"prerelease"}for(var i in n)if(("major"===i||"minor"===i||"patch"===i)&&n[i]!==r[i])return i},e.compareIdentifiers=K;var X=/^[0-9]+$/;function K(t,e){var n=X.test(t),r=X.test(e);return n&&r&&(t=+t,e=+e),n&&!r?-1:r&&!n?1:t<e?-1:t>e?1:0}function Q(t,e,n){return new J(t,n).compare(new J(e,n))}function Z(t,e,n){return Q(t,e,n)>0}function $(t,e,n){return Q(t,e,n)<0}function tt(t,e,n){return 0===Q(t,e,n)}function et(t,e,n){return 0!==Q(t,e,n)}function nt(t,e,n){return Q(t,e,n)>=0}function rt(t,e,n){return Q(t,e,n)<=0}function it(t,e,n,i){var o;switch(e){case"===":"object"===r(t)&&(t=t.version),"object"===r(n)&&(n=n.version),o=t===n;break;case"!==":"object"===r(t)&&(t=t.version),"object"===r(n)&&(n=n.version),o=t!==n;break;case"":case"=":case"==":o=tt(t,n,i);break;case"!=":o=et(t,n,i);break;case">":o=Z(t,n,i);break;case">=":o=nt(t,n,i);break;case"<":o=$(t,n,i);break;case"<=":o=rt(t,n,i);break;default:throw new TypeError("Invalid operator: "+e)}return o}function ot(t,e){if(t instanceof ot){if(t.loose===e)return t;t=t.value}if(!(this instanceof ot))return new ot(t,e);i("comparator",t,e),this.loose=e,this.parse(t),this.semver===at?this.value="":this.value=this.operator+this.semver.version,i("comp",this)}e.rcompareIdentifiers=function(t,e){return K(e,t)},e.major=function(t,e){return new J(t,e).major},e.minor=function(t,e){return new J(t,e).minor},e.patch=function(t,e){return new J(t,e).patch},e.compare=Q,e.compareLoose=function(t,e){return Q(t,e,!0)},e.rcompare=function(t,e,n){return Q(e,t,n)},e.sort=function(t,n){return t.sort((function(t,r){return e.compare(t,r,n)}))},e.rsort=function(t,n){return t.sort((function(t,r){return e.rcompare(t,r,n)}))},e.gt=Z,e.lt=$,e.eq=tt,e.neq=et,e.gte=nt,e.lte=rt,e.cmp=it,e.Comparator=ot;var at={};function st(t,e){if(t instanceof st)return t.loose===e?t:new st(t.raw,e);if(t instanceof ot)return new st(t.value,e);if(!(this instanceof st))return new st(t,e);if(this.loose=e,this.raw=t,this.set=t.split(/\s*\|\|\s*/).map((function(t){return this.parseRange(t.trim())}),this).filter((function(t){return t.length})),!this.set.length)throw new TypeError("Invalid SemVer Range: "+t);this.format()}function ct(t){return!t||"x"===t.toLowerCase()||"*"===t}function ut(t,e,n,r,i,o,a,s,c,u,l,h,f){return((e=ct(n)?"":ct(r)?">="+n+".0.0":ct(i)?">="+n+"."+r+".0":">="+e)+" "+(s=ct(c)?"":ct(u)?"<"+(+c+1)+".0.0":ct(l)?"<"+c+"."+(+u+1)+".0":h?"<="+c+"."+u+"."+l+"-"+h:"<="+s)).trim()}function lt(t,e){for(var n=0;n<t.length;n++)if(!t[n].test(e))return!1;if(e.prerelease.length){for(n=0;n<t.length;n++)if(i(t[n].semver),t[n].semver!==at&&t[n].semver.prerelease.length>0){var r=t[n].semver;if(r.major===e.major&&r.minor===e.minor&&r.patch===e.patch)return!0}return!1}return!0}function ht(t,e,n){try{e=new st(e,n)}catch(t){return!1}return e.test(t)}function ft(t,e,n,r){var i,o,a,s,c;switch(t=new J(t,r),e=new st(e,r),n){case">":i=Z,o=rt,a=$,s=">",c=">=";break;case"<":i=$,o=nt,a=Z,s="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(ht(t,e,r))return!1;for(var u=0;u<e.set.length;++u){var l=e.set[u],h=null,f=null;if(l.forEach((function(t){t.semver===at&&(t=new ot(">=0.0.0")),h=h||t,f=f||t,i(t.semver,h.semver,r)?h=t:a(t.semver,f.semver,r)&&(f=t)})),h.operator===s||h.operator===c)return!1;if((!f.operator||f.operator===s)&&o(t,f.semver))return!1;if(f.operator===c&&a(t,f.semver))return!1}return!0}ot.prototype.parse=function(t){var e=this.loose?a[U]:a[z],n=t.match(e);if(!n)throw new TypeError("Invalid comparator: "+t);this.operator=n[1],"="===this.operator&&(this.operator=""),n[2]?this.semver=new J(n[2],this.loose):this.semver=at},ot.prototype.toString=function(){return this.value},ot.prototype.test=function(t){return i("Comparator.test",t,this.loose),this.semver===at||("string"==typeof t&&(t=new J(t,this.loose)),it(t,this.operator,this.semver,this.loose))},ot.prototype.intersects=function(t,e){if(!(t instanceof ot))throw new TypeError("a Comparator is required");var n;if(""===this.operator)return n=new st(t.value,e),ht(this.value,n,e);if(""===t.operator)return n=new st(this.value,e),ht(t.semver,n,e);var r=!(">="!==this.operator&&">"!==this.operator||">="!==t.operator&&">"!==t.operator),i=!("<="!==this.operator&&"<"!==this.operator||"<="!==t.operator&&"<"!==t.operator),o=this.semver.version===t.semver.version,a=!(">="!==this.operator&&"<="!==this.operator||">="!==t.operator&&"<="!==t.operator),s=it(this.semver,"<",t.semver,e)&&(">="===this.operator||">"===this.operator)&&("<="===t.operator||"<"===t.operator),c=it(this.semver,">",t.semver,e)&&("<="===this.operator||"<"===this.operator)&&(">="===t.operator||">"===t.operator);return r||i||o&&a||s||c},e.Range=st,st.prototype.format=function(){return this.range=this.set.map((function(t){return t.join(" ").trim()})).join("||").trim(),this.range},st.prototype.toString=function(){return this.range},st.prototype.parseRange=function(t){var e=this.loose;t=t.trim(),i("range",t,e);var n=e?a[V]:a[H];t=t.replace(n,ut),i("hyphen replace",t),t=t.replace(a[G],"$1$2$3"),i("comparator trim",t,a[G]),t=(t=(t=t.replace(a[I],"$1~")).replace(a[j],"$1^")).split(/\s+/).join(" ");var r=e?a[U]:a[z],o=t.split(" ").map((function(t){return function(t,e){return i("comp",t),t=function(t,e){return t.trim().split(/\s+/).map((function(t){return function(t,e){i("caret",t,e);var n=e?a[F]:a[B];return t.replace(n,(function(e,n,r,o,a){var s;return i("caret",t,e,n,r,o,a),ct(n)?s="":ct(r)?s=">="+n+".0.0 <"+(+n+1)+".0.0":ct(o)?s="0"===n?">="+n+"."+r+".0 <"+n+"."+(+r+1)+".0":">="+n+"."+r+".0 <"+(+n+1)+".0.0":a?(i("replaceCaret pr",a),"-"!==a.charAt(0)&&(a="-"+a),s="0"===n?"0"===r?">="+n+"."+r+"."+o+a+" <"+n+"."+r+"."+(+o+1):">="+n+"."+r+"."+o+a+" <"+n+"."+(+r+1)+".0":">="+n+"."+r+"."+o+a+" <"+(+n+1)+".0.0"):(i("no pr"),s="0"===n?"0"===r?">="+n+"."+r+"."+o+" <"+n+"."+r+"."+(+o+1):">="+n+"."+r+"."+o+" <"+n+"."+(+r+1)+".0":">="+n+"."+r+"."+o+" <"+(+n+1)+".0.0"),i("caret return",s),s}))}(t,e)})).join(" ")}(t,e),i("caret",t),t=function(t,e){return t.trim().split(/\s+/).map((function(t){return function(t,e){var n=e?a[L]:a[k];return t.replace(n,(function(e,n,r,o,a){var s;return i("tilde",t,e,n,r,o,a),ct(n)?s="":ct(r)?s=">="+n+".0.0 <"+(+n+1)+".0.0":ct(o)?s=">="+n+"."+r+".0 <"+n+"."+(+r+1)+".0":a?(i("replaceTilde pr",a),"-"!==a.charAt(0)&&(a="-"+a),s=">="+n+"."+r+"."+o+a+" <"+n+"."+(+r+1)+".0"):s=">="+n+"."+r+"."+o+" <"+n+"."+(+r+1)+".0",i("tilde return",s),s}))}(t,e)})).join(" ")}(t,e),i("tildes",t),t=function(t,e){return i("replaceXRanges",t,e),t.split(/\s+/).map((function(t){return function(t,e){t=t.trim();var n=e?a[D]:a[A];return t.replace(n,(function(e,n,r,o,a,s){i("xRange",t,e,n,r,o,a,s);var c=ct(r),u=c||ct(o),l=u||ct(a);return"="===n&&l&&(n=""),c?e=">"===n||"<"===n?"<0.0.0":"*":n&&l?(u&&(o=0),l&&(a=0),">"===n?(n=">=",u?(r=+r+1,o=0,a=0):l&&(o=+o+1,a=0)):"<="===n&&(n="<",u?r=+r+1:o=+o+1),e=n+r+"."+o+"."+a):u?e=">="+r+".0.0 <"+(+r+1)+".0.0":l&&(e=">="+r+"."+o+".0 <"+r+"."+(+o+1)+".0"),i("xRange return",e),e}))}(t,e)})).join(" ")}(t,e),i("xrange",t),t=function(t,e){return i("replaceStars",t,e),t.trim().replace(a[W],"")}(t,e),i("stars",t),t}(t,e)})).join(" ").split(/\s+/);return this.loose&&(o=o.filter((function(t){return!!t.match(r)}))),o=o.map((function(t){return new ot(t,e)}))},st.prototype.intersects=function(t,e){if(!(t instanceof st))throw new TypeError("a Range is required");return this.set.some((function(n){return n.every((function(n){return t.set.some((function(t){return t.every((function(t){return n.intersects(t,e)}))}))}))}))},e.toComparators=function(t,e){return new st(t,e).set.map((function(t){return t.map((function(t){return t.value})).join(" ").trim().split(" ")}))},st.prototype.test=function(t){if(!t)return!1;"string"==typeof t&&(t=new J(t,this.loose));for(var e=0;e<this.set.length;e++)if(lt(this.set[e],t))return!0;return!1},e.satisfies=ht,e.maxSatisfying=function(t,e,n){var r=null,i=null;try{var o=new st(e,n)}catch(t){return null}return t.forEach((function(t){o.test(t)&&(r&&-1!==i.compare(t)||(i=new J(r=t,n)))})),r},e.minSatisfying=function(t,e,n){var r=null,i=null;try{var o=new st(e,n)}catch(t){return null}return t.forEach((function(t){o.test(t)&&(r&&1!==i.compare(t)||(i=new J(r=t,n)))})),r},e.validRange=function(t,e){try{return new st(t,e).range||"*"}catch(t){return null}},e.ltr=function(t,e,n){return ft(t,e,"<",n)},e.gtr=function(t,e,n){return ft(t,e,">",n)},e.outside=ft,e.prerelease=function(t,e){var n=Y(t,e);return n&&n.prerelease.length?n.prerelease:null},e.intersects=function(t,e,n){return t=new st(t,n),e=new st(e,n),t.intersects(e)},e.coerce=function(t){if(t instanceof J)return t;if("string"!=typeof t)return null;var e=t.match(a[R]);return null==e?null:Y((e[1]||"0")+"."+(e[2]||"0")+"."+(e[3]||"0"))}}).call(this,n(169))},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(790),o=n(791);function a(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}e.parse=w,e.resolve=function(t,e){return w(t,!1,!0).resolve(e)},e.resolveObject=function(t,e){return t?w(t,!1,!0).resolveObject(e):e},e.format=function(t){o.isString(t)&&(t=w(t));return t instanceof a?t.format():a.prototype.format.call(t)},e.Url=a;var s=/^([a-z0-9.+-]+:)/i,c=/:[0-9]*$/,u=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,l=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),h=["'"].concat(l),f=["%","/","?",";","#"].concat(h),p=["/","?","#"],d=/^[+a-z0-9A-Z_-]{0,63}$/,y=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,m={javascript:!0,"javascript:":!0},v={javascript:!0,"javascript:":!0},g={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},b=n(792);function w(t,e,n){if(t&&o.isObject(t)&&t instanceof a)return t;var r=new a;return r.parse(t,e,n),r}a.prototype.parse=function(t,e,n){if(!o.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+r(t));var a=t.indexOf("?"),c=-1!==a&&a<t.indexOf("#")?"?":"#",l=t.split(c);l[0]=l[0].replace(/\\/g,"/");var w=t=l.join(c);if(w=w.trim(),!n&&1===t.split("#").length){var _=u.exec(w);if(_)return this.path=w,this.href=w,this.pathname=_[1],_[2]?(this.search=_[2],this.query=e?b.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var x=s.exec(w);if(x){var S=(x=x[0]).toLowerCase();this.protocol=S,w=w.substr(x.length)}if(n||x||w.match(/^\/\/[^@\/]+@[^@\/]+/)){var T="//"===w.substr(0,2);!T||x&&v[x]||(w=w.substr(2),this.slashes=!0)}if(!v[x]&&(T||x&&!g[x])){for(var M,E,P=-1,O=0;O<p.length;O++){-1!==(A=w.indexOf(p[O]))&&(-1===P||A<P)&&(P=A)}-1!==(E=-1===P?w.lastIndexOf("@"):w.lastIndexOf("@",P))&&(M=w.slice(0,E),w=w.slice(E+1),this.auth=decodeURIComponent(M)),P=-1;for(O=0;O<f.length;O++){var A;-1!==(A=w.indexOf(f[O]))&&(-1===P||A<P)&&(P=A)}-1===P&&(P=w.length),this.host=w.slice(0,P),w=w.slice(P),this.parseHost(),this.hostname=this.hostname||"";var D="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!D)for(var R=this.hostname.split(/\./),C=(O=0,R.length);O<C;O++){var I=R[O];if(I&&!I.match(d)){for(var k="",L=0,N=I.length;L<N;L++)I.charCodeAt(L)>127?k+="x":k+=I[L];if(!k.match(d)){var j=R.slice(0,O),B=R.slice(O+1),F=I.match(y);F&&(j.push(F[1]),B.unshift(F[2])),B.length&&(w="/"+B.join(".")+w),this.hostname=j.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),D||(this.hostname=i.toASCII(this.hostname));var U=this.port?":"+this.port:"",z=this.hostname||"";this.host=z+U,this.href+=this.host,D&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==w[0]&&(w="/"+w))}if(!m[S])for(O=0,C=h.length;O<C;O++){var G=h[O];if(-1!==w.indexOf(G)){var H=encodeURIComponent(G);H===G&&(H=escape(G)),w=w.split(G).join(H)}}var V=w.indexOf("#");-1!==V&&(this.hash=w.substr(V),w=w.slice(0,V));var W=w.indexOf("?");if(-1!==W?(this.search=w.substr(W),this.query=w.substr(W+1),e&&(this.query=b.parse(this.query)),w=w.slice(0,W)):e&&(this.search="",this.query={}),w&&(this.pathname=w),g[S]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){U=this.pathname||"";var q=this.search||"";this.path=U+q}return this.href=this.format(),this},a.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",n=this.pathname||"",r=this.hash||"",i=!1,a="";this.host?i=t+this.host:this.hostname&&(i=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&o.isObject(this.query)&&Object.keys(this.query).length&&(a=b.stringify(this.query));var s=this.search||a&&"?"+a||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||g[e])&&!1!==i?(i="//"+(i||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):i||(i=""),r&&"#"!==r.charAt(0)&&(r="#"+r),s&&"?"!==s.charAt(0)&&(s="?"+s),e+i+(n=n.replace(/[?#]/g,(function(t){return encodeURIComponent(t)})))+(s=s.replace("#","%23"))+r},a.prototype.resolve=function(t){return this.resolveObject(w(t,!1,!0)).format()},a.prototype.resolveObject=function(t){if(o.isString(t)){var e=new a;e.parse(t,!1,!0),t=e}for(var n=new a,r=Object.keys(this),i=0;i<r.length;i++){var s=r[i];n[s]=this[s]}if(n.hash=t.hash,""===t.href)return n.href=n.format(),n;if(t.slashes&&!t.protocol){for(var c=Object.keys(t),u=0;u<c.length;u++){var l=c[u];"protocol"!==l&&(n[l]=t[l])}return g[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(t.protocol&&t.protocol!==n.protocol){if(!g[t.protocol]){for(var h=Object.keys(t),f=0;f<h.length;f++){var p=h[f];n[p]=t[p]}return n.href=n.format(),n}if(n.protocol=t.protocol,t.host||v[t.protocol])n.pathname=t.pathname;else{for(var d=(t.pathname||"").split("/");d.length&&!(t.host=d.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==d[0]&&d.unshift(""),d.length<2&&d.unshift(""),n.pathname=d.join("/")}if(n.search=t.search,n.query=t.query,n.host=t.host||"",n.auth=t.auth,n.hostname=t.hostname||t.host,n.port=t.port,n.pathname||n.search){var y=n.pathname||"",m=n.search||"";n.path=y+m}return n.slashes=n.slashes||t.slashes,n.href=n.format(),n}var b=n.pathname&&"/"===n.pathname.charAt(0),w=t.host||t.pathname&&"/"===t.pathname.charAt(0),_=w||b||n.host&&t.pathname,x=_,S=n.pathname&&n.pathname.split("/")||[],T=(d=t.pathname&&t.pathname.split("/")||[],n.protocol&&!g[n.protocol]);if(T&&(n.hostname="",n.port=null,n.host&&(""===S[0]?S[0]=n.host:S.unshift(n.host)),n.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===d[0]?d[0]=t.host:d.unshift(t.host)),t.host=null),_=_&&(""===d[0]||""===S[0])),w)n.host=t.host||""===t.host?t.host:n.host,n.hostname=t.hostname||""===t.hostname?t.hostname:n.hostname,n.search=t.search,n.query=t.query,S=d;else if(d.length)S||(S=[]),S.pop(),S=S.concat(d),n.search=t.search,n.query=t.query;else if(!o.isNullOrUndefined(t.search)){if(T)n.hostname=n.host=S.shift(),(A=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=A.shift(),n.host=n.hostname=A.shift());return n.search=t.search,n.query=t.query,o.isNull(n.pathname)&&o.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!S.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var M=S.slice(-1)[0],E=(n.host||t.host||S.length>1)&&("."===M||".."===M)||""===M,P=0,O=S.length;O>=0;O--)"."===(M=S[O])?S.splice(O,1):".."===M?(S.splice(O,1),P++):P&&(S.splice(O,1),P--);if(!_&&!x)for(;P--;P)S.unshift("..");!_||""===S[0]||S[0]&&"/"===S[0].charAt(0)||S.unshift(""),E&&"/"!==S.join("/").substr(-1)&&S.push("");var A,D=""===S[0]||S[0]&&"/"===S[0].charAt(0);T&&(n.hostname=n.host=D?"":S.length?S.shift():"",(A=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=A.shift(),n.host=n.hostname=A.shift()));return(_=_||n.host&&S.length)&&!D&&S.unshift(""),S.length?n.pathname=S.join("/"):(n.pathname=null,n.path=null),o.isNull(n.pathname)&&o.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=t.auth||n.auth,n.slashes=n.slashes||t.slashes,n.href=n.format(),n},a.prototype.parseHost=function(){var t=this.host,e=c.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(15),a=n(114),s=n(72),c=n(17),u=n(164),l=n(35),h=n(70),f=n(111),p=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),d=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},y=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="sweep-viewdata",e.selectionEnabled=!0,e.nonPanoCurrentPuckVisible=!1,e.sweepMap={},e.sweepIdList=[],e.enableSweepSelection=function(t){return d(e,void 0,Promise,(function(){return y(this,(function(t){return this.selectionEnabled=!0,[2]}))}))},e.disableSweepSelection=function(t){return d(e,void 0,Promise,(function(){return y(this,(function(t){return this.selectionEnabled=!1,[2]}))}))},e.toggleCurrentPuck=function(t){return d(e,void 0,Promise,(function(){return y(this,(function(e){return this.nonPanoCurrentPuckVisible=t.visible,this.updateVisibility(this.viewData.data.currentSweep),[2]}))}))},e.onSweepSelectCommand=function(t){return d(e,void 0,Promise,(function(){return y(this,(function(e){return this.selectionEnabled?(this.viewData.modifySelectAnimation(t.id,t.selected,t.duration),[2]):[2]}))}))},e.onSweepHoverCommand=function(t){return d(e,void 0,Promise,(function(){return y(this,(function(e){return this.viewData.modifySelectAnimation(t.id,t.hovered,t.duration),[2]}))}))},e.onSweepVisibilityCommand=function(t){return d(e,void 0,Promise,(function(){return y(this,(function(e){return this.viewData.setVisible(t.sweepId,t.visible),[2]}))}))},e.updateVisibility=function(t){return d(e,void 0,Promise,(function(){var e,n=this;return y(this,(function(r){return this.viewmodeData.isPano()?t&&(e=this.viewData.getSweep(t).neighbours,this.viewData.iterate((function(t){var r=-1!==e.indexOf(t.id);n.viewData.setVisible(t.id,r)})),this.viewData.setVisible(t,!1)):(this.viewData.iterate((function(t){n.viewData.setVisible(t.id,Object(l.c)(t.floor))})),t&&this.viewData.setVisible(t,this.nonPanoCurrentPuckVisible)),[2]}))}))},e}return p(e,t),e.prototype.init=function(t,e){return d(this,void 0,void 0,(function(){var t,n,r=this;return y(this,(function(i){switch(i.label){case 0:return t=this,[4,e.market.waitForData(o.a)];case 1:return t.data=i.sent(),this.viewData=e.market.tryGetData(a.a)||new a.a(this.data),e.market.register(this,a.a,this.viewData),this.bindings.push(e.commandBinder.addBinding(s.f,this.onSweepSelectCommand),e.commandBinder.addBinding(s.e,this.onSweepHoverCommand),e.commandBinder.addBinding(s.g,this.onSweepVisibilityCommand),e.commandBinder.addBinding(s.c,this.enableSweepSelection),e.commandBinder.addBinding(s.b,this.disableSweepSelection),e.commandBinder.addBinding(s.h,this.toggleCurrentPuck),this.data.onChanged((function(){return r.viewData.updateViewData()})),e.msgBus.subscribe(f.e,(function(){return r.viewData.updateViewData()}))),n=this,[4,e.market.waitForData(c.a)];case 2:return n.viewmodeData=i.sent(),this.bindings.push(this.data.onPropertyChanged("currentSweep",this.updateVisibility),e.subscribe(u.a,(function(){return r.updateVisibility(r.viewData.data.currentSweep)})),e.subscribe(h.b,(function(){return r.updateVisibility(r.viewData.data.currentSweep)})),this.viewmodeData.makeModeChangeSubscription((function(){return r.updateVisibility(r.viewData.data.currentSweep)}))),this.updateVisibility(this.viewData.data.currentSweep),[2]}}))}))},e.prototype.onUpdate=function(t){this.viewData.updateAnimations(t)},e}(i.a);e.default=m},function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return _})),n.d(e,"b",(function(){return M}));var r=n(112),i=n(20),o=n(267),a=n(70),s=n(12),c=n(1),u=n(2),l=n(17),h=n(307),f=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},p=new u.a(t),d=0,y=1/0,m=null,v=null,g=window.devicePixelRatio||1,b={},w=new o.a(1e3),_=function(){this.handlers=[{msgType:r.a,func:function(t,e,n){v!==s.a.STARTING&&v!==s.a.PLAYING||x(t,c.a[e.toMode],1e4)}},{msgType:a.a,func:function(t,e,n){var r=n.tryGetData(l.a);e.phase===s.a.LOADING?x(t,"Loading",6e4):e.phase===s.a.STARTING?x(t,"Starting",6e4):e.phase===s.a.PLAYING&&r&&r.currentMode&&x(t,c.a[r.currentMode],1e4),v=e.phase}},{msgType:h.a,func:function(t,e,n){g=e.pixelRatio}}]};function x(t,e,n){e!==m&&(m&&(T(t),S()),b[e]||(y=n,b[m=e]=!0))}var S=function(){m=null,w.clear(),d=0},T=function(t){var e=w.getList();if(0!==e.length)try{var n=E(e);t.track("performance",n)}catch(t){p.warn("Could not send performance metrics",t)}},M=function(t,e){m&&(w.push(e),(d+=e)>=y&&(T(t),S()))},E=function(t){var e,n,r=0,o=0,a=0,s=0,c=0,u=0;try{for(var l=f(t),h=l.next();!h.done;h=l.next()){var p=h.value;r+=p,p<0||(p<=16.7?o+=p:p<=33.3?a+=p:p<=100?s+=p:p<=1e3?c+=p:u+=p)}}catch(t){e={error:t}}finally{try{h&&!h.done&&(n=l.return)&&n.call(l)}finally{if(e)throw e.error}}if(r<=0)throw Error("No positive timings, cannot calculate performance data");var d=r/t.length;o/=r,a/=r,s/=r,c/=r,u/=r;var y=t.slice(),v=Object(i.l)(y,50),b=Object(i.l)(y,95,!1),w=y[y.length-1];return{phase:m,frame_delta:d,frame_delta_avg:d,frame_delta_median:v,frame_delta_95th:b,frame_delta_max:w,duration:r,time_60_fps:o,time_60_30_fps:a,time_30_10_fps:s,time_10_1_fps:c,time_1_0_fps:u,pixel_ratio:g}}}).call(this,"/index.js")},function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return l}));var r,i=n(0),o=n(52),a=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},c=function(){function t(t,e){this.slots=t,this.renderToTextureModule=e,this.renderTarget=new i.Nc(1,1),this.sizeMultiplier=.25,this.pixelBuffer=new Uint8Array(4)}return t.prototype.render=function(t,e,n){void 0===n&&(n=!1),this.beforeRender();var r=this.renderToTextureModule.getRenderSize(),i=r.width,o=r.height;i=Math.max(1,Math.floor(i*this.sizeMultiplier)),o=Math.max(1,Math.floor(o*this.sizeMultiplier)),i===this.renderTarget.width&&o===this.renderTarget.height||this.renderTarget.setSize(i,o),this.renderToTextureModule.render(this.renderTarget,t,e),n&&this.renderToScreen(),this.afterRender()},t.prototype.renderToScreen=function(){this.renderToTextureModule.renderToScreen(this.renderTarget)},t.prototype.readPixels=function(){var t=this.renderTarget.width*this.renderTarget.height*4;this.pixelBuffer.length!==t&&(this.pixelBuffer=new Uint8Array(t));var e=this.pixelBuffer;return this.renderToTextureModule.getRenderTargetData(this.renderTarget,e),this.pixelBuffer},t.prototype.beforeRender=function(){var t,e,n,r;try{for(var i=s(this.slots),o=i.next();!o.done;o=i.next()){var a=o.value;try{for(var c=s(a.chunks),u=c.next();!u.done;u=c.next()){var l=u.value;this.beforeRenderChunk(l,a)}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},t.prototype.afterRender=function(){var t,e,n,r;try{for(var i=s(this.slots),o=i.next();!o.done;o=i.next()){var a=o.value;try{for(var c=s(a.chunks),u=c.next();!u.done;u=c.next()){var l=u.value;this.afterRenderChunk(l,a)}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},t}(),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.beforeRenderChunk=function(t,e){t.setColorOverlay(o.d[e.quality].debugColor)},e.prototype.afterRenderChunk=function(t,e){t.setColorOverlay(null)},e}(c),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.beforeRender=function(){this.maxValue=this.slots.reduce((function(t,e){return Math.max(t,e.screenCoverageScore)}),1e-9),t.prototype.beforeRender.call(this)},e.prototype.beforeRenderChunk=function(t,e){var n=e.screenCoverageScore/this.maxValue,r=new i.Kc(n,n,n,1);t.setColorOverlay(r)},e.prototype.afterRenderChunk=function(t,e){t.setColorOverlay(null)},e}(c)},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(25),a=n(31),s=n(8),c=n(45),u=n(130),l=n(51),h=n(62),f=n(237),p=n(6),d=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),y=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},m=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="interactionmode",e.onPointerButtonEvent=function(t){var n=e.data.source;switch(t.device){case c.b.TOUCH:n=h.a.Touch;break;case c.b.MOUSE:n=h.a.Mouse;break;case c.b.PEN:n=h.a.Pen;break;case c.b.GAMEPAD:e.renderer.xr.enabled&&e.renderer.xr.isPresenting&&(n=h.a.XRController);break;default:e.log.debug("source:",t.device,t)}e.updateSource(n)},e.onKeyEvent=function(){e.updateSource(h.a.Key)},e}return d(e,t),e.prototype.init=function(t,e){return y(this,void 0,void 0,(function(){var t,n=this;return m(this,(function(r){switch(r.label){case 0:return this.engine=e,this.data=new l.a,this.mobileBrowser=Object(p.n)(),[4,e.getModule(o.default)];case 1:return t=r.sent(),this.renderer=t.threeRenderer,this.updateMode(this.getInteractionMode(),this.data.mode),this.engine.market.register(this,l.a,this.data),e.getModule(a.default).then((function(t){n.bindings.push(t.registerHandler(s.m,n.onPointerButtonEvent),t.registerHandler(u.a,n.onKeyEvent))})),[2]}}))}))},e.prototype.onUpdate=function(t){var e=this.getInteractionMode();this.updateMode(e,this.data.mode)},e.prototype.getInteractionMode=function(){if(this.renderer.xr.enabled&&this.renderer.xr.isPresenting){var t=this.renderer.xr.getSession();if(null!==t&&t.inputSources.length>0)switch(t.inputSources[0].targetRayMode){case"gaze":case"screen":return h.b.VrOrientOnly;case"tracked-pointer":return h.b.VrWithTrackedController}return h.b.VrOrientOnly}return this.mobileBrowser?h.b.Mobile:h.b.Desktop},e.prototype.updateMode=function(t,e){t!==this.data.mode&&(this.data.updateMode(t),this.data.commit(),this.engine.broadcast(new f.a(this.data.mode,e)))},e.prototype.updateSource=function(t){t!==this.data.source&&(this.data.updateSource(t),this.data.commit(),this.engine.broadcast(new f.b(this.data.source)))},e}(i.a);e.default=v},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(0),a=n(192),s=n(8),c=n(31),u=n(2),l=n(109),h=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),f=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},p=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},d=new u.a("cursor-data"),y=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.name="cursor-data",n.cursorState=new a.a,n.position=new o.Ic,n.timeToFade=0,n.onPointerMove=function(){if(null!==n.raycasterData.hit&&n.raycasterData.pointerNdcPosition.distanceToSquared(n.position)>e.movementThreshold){n.position.copy(n.raycasterData.pointerNdcPosition),n.timeToFade=e.fadeOutDelay;var t=o.ib.lerp(0,e.fadeInDuration,1-n.cursorState.opacity.value);n.cursorState.opacity.modifyAnimation(n.cursorState.opacity.value,1,t),n.cursorState.commit()}},n}return h(e,t),e.prototype.init=function(t,n){return f(this,void 0,void 0,(function(){var t,r;return p(this,(function(i){switch(i.label){case 0:return t=this,[4,n.getModule(c.default)];case 1:return t.input=i.sent(),r=this,[4,n.market.waitForData(l.b)];case 2:return r.raycasterData=i.sent(),n.market.register(this,a.a,this.cursorState),this.bindings.push(this.input.registerHandler(s.n,this.onPointerMove)),e.fadeInDuration>e.fadeOutDelay&&d.warn("fadeInDuration should be less than fadeOutDelay!"),[2]}}))}))},e.prototype.onUpdate=function(t){var n=!1;this.timeToFade>0&&(this.timeToFade-=t,this.timeToFade<=0&&(n=!0)),this.cursorState.opacity.tick(t),this.cursorState.commit(),n&&this.cursorState.opacity.modifyAnimation(1,0,e.fadeOutDuration)},e.prototype.dispose=function(e){t.prototype.dispose.call(this,e)},e.fadeOutDelay=700,e.fadeOutDuration=700,e.fadeInDuration=300,e.movementThreshold=.003,e}(i.a);e.default=y},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(15),a=n(12),s=n(26),c=n(107),u=n(263),l=n(17),h=n(98),f=n(1),p=n(35),d=n(158),y=n(214),m=n(93),v=n(51),g=n(34),b=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),w=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},_=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},x=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="mattertag-controller",e.tagSettingEnabled=!1,e.visibilityNeedsUpdate=!0,e.updateTagVisibilityBySetting=function(){e.tagSettingEnabled=e.settings.tryGetProperty(m.b,!0),e.setDirty()},e.updateTagVisibilityByViewmode=function(t){e.viewmode=t.toMode,e.setDirty()},e.setDirty=function(){e.visibilityNeedsUpdate=!0},e.onUpdate=function(){if(e.visibilityNeedsUpdate)if(e.visibilityNeedsUpdate=!1,e.tagSettingEnabled&&e.floorsViewData)if(e.viewmode===f.a.Panorama){var t=!e.sweepData.isSweepUnaligned(e.sweepData.currentSweep),n=!e.interactionmodeData.isVR();e.mattertagMeshModule.setTagVisibility(t&&n)}else e.viewmode!==f.a.Dollhouse&&e.viewmode!==f.a.Floorplan||e.mattertagMeshModule.filterTagVisibility((function(t){var n=e.mattertagData.getTag(t).floorIndex;return!e.floorsViewData.transition.progress.active&&!e.floorsViewData.isHidden(n)}));else e.mattertagMeshModule.setTagVisibility(!1)},e}return b(e,t),e.prototype.init=function(t,e){return w(this,void 0,void 0,(function(){var t,n,r=this;return _(this,(function(i){switch(i.label){case 0:return[4,Promise.all([e.getModule(u.default),e.market.waitForData(c.a),e.market.waitForData(g.c),e.market.waitForData(o.a),e.market.waitForData(l.a),e.market.waitForData(v.a),e.market.waitForData(a.c),e.market.waitForData(s.a),e.market.waitForData(p.b)])];case 1:return t=x.apply(void 0,[i.sent(),9]),this.mattertagMeshModule=t[0],this.mattertagData=t[1],this.mattertagsViewData=t[2],this.sweepData=t[3],this.viewmodeData=t[4],this.interactionmodeData=t[5],this.appData=t[6],this.settings=t[7],this.floorsViewData=t[8],this.viewmodeData.currentMode&&(this.viewmode=this.viewmodeData.currentMode),this.bindings.push(this.floorsViewData.onChanged(this.setDirty),this.interactionmodeData.onChanged(this.setDirty),this.settings.onPropertyChanged(m.b,this.updateTagVisibilityBySetting),e.subscribe(d.a,this.setDirty),e.subscribe(y.a,this.updateTagVisibilityByViewmode),e.subscribe(h.a,this.updateTagVisibilityByViewmode),this.mattertagsViewData.onToolStateChanged(this.setDirty)),n=this.appData.application,this.bindings.push(this.appData.onPropertyChanged("application",(function(t){t!==n&&(r.setDirty(),n=t)}))),this.updateTagVisibilityBySetting(),[2]}}))}))},e}(i.a);e.default=S},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(244),a=n(75),s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},u=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="label-viewdata",e}return s(e,t),e.prototype.init=function(t,e){return c(this,void 0,void 0,(function(){var t,n;return u(this,(function(r){switch(r.label){case 0:return t=this,[4,e.market.waitForData(o.a)];case 1:return t.data=r.sent(),(n=new a.b(this.data)).initialize(e),e.market.register(this,a.b,n),[2]}}))}))},e}(i.a);e.default=l},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(56),a=n(60),s=n(18),c=n(15),u=n(17),l=n(132),h=n(121),f=n(280),p=n(35),d=n(259),y=n(254),m=n(14),v=n(197),g=n(26),b=n(16),w=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),_=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},x=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="quick-menus",e}return w(e,t),e.prototype.init=function(t,e){return _(this,void 0,void 0,(function(){var t,n,r,i,y,w,_=this;return x(this,(function(x){switch(x.label){case 0:return t=this,[4,e.getModuleSync(o.default)];case 1:return t.settingsModule=x.sent(),this.settingsGui=this.settingsModule.getSettingsGui(),[4,e.market.waitForData(c.a)];case 2:return n=x.sent(),[4,e.market.waitForData(g.a)];case 3:return r=x.sent(),[4,e.market.waitForData(u.a)];case 4:return i=x.sent(),[4,e.market.waitForData(p.b)];case 5:return y=x.sent(),[4,e.market.waitForData(s.a)];case 6:return w=x.sent(),this.uIndex=this.settingsGui.addPanel("Link to location",[b.a.U],{allowSubGroups:!1,width:400,ratio:90}),this.pIndex=this.settingsGui.addPanel("Quick settings",[b.a.P],{allowSubGroups:!1}),this.settingsGui.loadPromise.then((function(){_.settingsGui.addControl(_.uIndex,"","Link",{}),_.settingsGui.addControl(_.uIndex,"","Shorten URL",!0),_.settingsGui.addButton(_.uIndex,"","Copy to clipboard",(function(){var t=document.createElement("input");t.type="text",t.value=_.buildLink(w,i,y,n),document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)})),_.settingsGui.toggle(_.uIndex);var t=h.c*(180/Math.PI)*60;_.settingsGui.addControl(_.pIndex,"",d.a,!0),_.settingsGui.addSlider(_.pIndex,"",f.lookAccelerationKey,t,.25,10,2),_.settingsGui.addSlider(_.pIndex,"",a.baseTransitionSpeedKey,l.a.camera.baseTransitionTime,1,5e3,0);var e=r.tryGetProperty(m.e,m.f);_.settingsGui.addSlider(_.pIndex,"",m.g,Object(v.c)(e),.5,10,2),_.settingsGui.toggle(_.pIndex),_.settingsModule.registerSetting("Quick settings",f.lookAccelerationKey,t,!1),_.settingsModule.registerSetting("Quick settings",a.baseTransitionSpeedKey,l.a.camera.baseTransitionTime,!1),_.settingsGui.onToggle(_.uIndex,(function(t){t&&_.settingsGui.updateSetting(_.uIndex,"Link",_.buildLink(w,i,y,n))})),w.pose.onChanged((function(){_.settingsGui.isLoaded&&_.settingsGui.isVisible(_.uIndex)&&_.settingsGui.updateSetting(_.uIndex,"Link",_.buildLink(w,i,y,n))})),r.onPropertyChanged(m.g,(function(t){r.setProperty(m.e,Object(v.d)(t))}))})),[2]}}))}))},e.prototype.buildLink=function(t,e,n,r){var i=this.settingsGui.getSetting(this.uIndex,"Shorten URL"),o=y.a.getQueryString({cameraData:t,viewmodeData:e,floorsViewData:n,sweepData:r},i);return location.origin+"/show/?"+o},e}(i.a);e.default=S},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(219),a=n(152),s=n(99),c=n(85),u=n(1),l=n(10),h=n(97),f=n(17),p=n(0),d=n(31),y=n(8),m=n(29),v=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),g=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},b=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},w=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="sweep-pin-navigation",e}return v(e,t),e.prototype.init=function(t,e){return g(this,void 0,void 0,(function(){var t,n,r,i,v,g,_;return b(this,(function(b){switch(b.label){case 0:return[4,Promise.all([e.getModule(o.default),e.getModule(h.default),e.market.waitForData(f.a),e.getModule(d.default)])];case 1:return t=w.apply(void 0,[b.sent(),4]),n=t[0],r=t[1],i=t[2],v=t[3],g=function(t,e){i.currentMode&&i.currentMode!==u.a.Panorama&&r.switchToMode(u.a.Panorama,l.a.FadeToBlack,{sweepID:t,rotation:e})},_=new p.Pb,this.bindings.push(v.registerMeshHandler(y.a,m.a.isType(a.a),(function(t,e,r){var o=n.mapColliderToSweep(e);return!(!o||i.transition.active)&&(_.set(0,0,0,1).multiply(o.rotation),g(o.id,_),!0)})),v.registerMeshHandler(y.e,m.a.isType(a.a),(function(t,r){n.mapColliderToSweep(r)&&e.commandBinder.issueCommand(new s.a(c.a.FINGER))})),v.registerMeshHandler(y.r,m.a.isType(a.a),(function(t,r){n.mapColliderToSweep(r)&&e.commandBinder.issueCommand(new s.a(null))}))),[2]}}))}))},e}(i.a);e.default=_},function(t,e,n){"use strict";n.r(e);var r,i=n(31),o=n(130),a=n(16),s=n(32),c=n(178),u=n(4),l=n(77),h=n(17),f=n(1),p=n(26),d=n(46),y=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),m=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},v=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},g=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},b=function(t){function e(){var e,n,r=null!==t&&t.apply(this,arguments)||this;return r.name="showcase-hotkeys",r.inputCommandMap=((e={})[l.a.PRESSED]=((n={})[a.a.ONE]=function(){return r.switchToMode(s.b.INSIDE)},n[a.a.TWO]=function(){return r.switchToMode(s.b.DOLLHOUSE)},n[a.a.THREE]=function(){return r.switchToMode(s.b.FLOORPLAN)},n[a.a.ZERO]=function(){var t=r.currentView++%r.meshViews.length;return r.meshViews[t](),r.switchToMode(s.b.INSIDE)},n),e),r.currentView=0,r.meshViews=[function(){r.issueCommand(new c.a(1)),r.settings.setProperty(d.c,!1)},function(){r.issueCommand(new c.a(1)),r.settings.setProperty(d.c,!0)},function(){r.issueCommand(new c.a(0)),r.settings.setProperty(d.c,!0)},function(){r.issueCommand(new c.a(0)),r.settings.setProperty(d.c,!1)}],r}return y(e,t),e.prototype.init=function(t,e){return m(this,void 0,void 0,(function(){var t,n,r=this;return v(this,(function(a){switch(a.label){case 0:return[4,e.getModule(i.default)];case 1:return n=a.sent(),[4,Promise.all([e.market.waitForData(h.a),e.market.waitForData(p.a)])];case 2:return t=g.apply(void 0,[a.sent(),2]),this.viewmodeData=t[0],this.settings=t[1],this.issueCommand=e.commandBinder.issueCommand.bind(e.commandBinder),n.registerHandler(o.a,(function(t){return m(r,void 0,void 0,(function(){return v(this,(function(e){switch(e.label){case 0:return this.inputCommandMap[t.state]&&this.inputCommandMap[t.state][t.key]?[4,this.inputCommandMap[t.state][t.key]()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))})),[2]}}))}))},e.prototype.switchToMode=function(t){return m(this,void 0,void 0,(function(){return v(this,(function(e){switch(e.label){case 0:return this.viewmodeData.currentMode===f.a.Transition?[3,2]:[4,this.issueCommand(new s.a(t))];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},e}(u.a);e.default=b},function(t,e,n){"use strict";n.r(e);var r,i=n(21),o=n(4),a=n(32),s=n(97),c=n(26),u=n(1),l=n(10),h=n(50),f=n(3),p=n(0),d=n(28),y=n(15),m=n(18),v=n(90),g=n(12),b=n(70),w=n(17),_=n(131),x=n(35),S=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),T=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},M=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},E=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="viewmode-change",e}return S(e,t),e.prototype.init=function(t,e){return T(this,void 0,void 0,(function(){var t,n,r=this;return M(this,(function(i){switch(i.label){case 0:return this.engine=e,t=this,[4,e.getModule(s.default)];case 1:return t.viewmodesModule=i.sent(),n=this,[4,e.market.waitForData(c.a)];case 2:return n.settings=i.sent(),this.engine.market.waitForData(g.c).then((function(t){return r.setEnabledModes(t.application)})),this.bindings.push(e.subscribe(b.b,(function(t){return r.setEnabledModes(t.application)})),e.commandBinder.addBinding(a.a,this.onChangeViewmodeCommand.bind(this))),[2]}}))}))},e.prototype.setEnabledModes=function(t){return T(this,void 0,void 0,(function(){var e,n,r,o,a,s,c=this;return M(this,(function(h){switch(h.label){case 0:return t!==g.b.SHOWCASE?[3,7]:(this.dhDisabled=function(){return c.settings.checkUrlParam("dh",0,1)||!c.settings.tryGetProperty(i.a.Dollhouse,!1)},this.fpDisabled=function(){return c.settings.checkUrlParam("fp",0,1)||!c.settings.tryGetProperty(i.a.FloorPlan,!1)},this.previousApp?[4,this.engine.market.waitForData(w.a)]:[2]);case 1:return(e=h.sent().currentMode)===u.a.Dollhouse&&this.dhDisabled()||e===u.a.Floorplan&&this.fpDisabled()?[4,this.engine.market.waitForData(_.a)]:[3,6];case 2:return n=h.sent(),(r=n.pose)&&r.mode===u.a.Panorama?(this.goToInsideMode(l.a.Interpolate,{position:r.camera.position}),[3,6]):[3,3];case 3:return[4,this.engine.market.waitForData(m.a)];case 4:return o=h.sent().pose,[4,this.engine.market.waitForData(y.a)];case 5:a=h.sent().getClosestSweep(o.position,!0),s=a?{position:a.position}:void 0,this.goToInsideMode(l.a.Interpolate,s),h.label=6;case 6:return[3,8];case 7:t===g.b.WORKSHOP&&(this.dhDisabled=function(){return!1},this.fpDisabled=function(){return!1}),h.label=8;case 8:return this.previousApp=t,[2]}}))}))},e.prototype.onChangeViewmodeCommand=function(t){return T(this,void 0,void 0,(function(){return M(this,(function(e){switch(t.mode){case a.b.INSIDE:return[2,this.goToInsideMode(t.transitionType,t.pose)];case a.b.DOLLHOUSE:return[2,this.goToDollhouse(t.transitionType,t.pose)];case a.b.FLOORPLAN:return[2,this.goToFloorplan(t.transitionType,t.pose)]}return[2,Promise.reject("viewmode-change => Could not move to "+t.mode)]}))}))},e.prototype.goToInsideMode=function(t,e){return void 0===t&&(t=l.a.Interpolate),void 0===e&&(e={}),T(this,void 0,void 0,(function(){var n,r,i;return M(this,(function(o){switch(o.label){case 0:return(n=this.engine.market.tryGetData(y.a))?(r=e.sweepID||n.currentSweep)?[3,2]:[4,this.getLookAtSweep(n)]:[2,Promise.reject("Cannot go to inside mode")];case 1:r=o.sent(),o.label=2;case 2:return n.isSweepUnaligned(r)&&(i=n.getFirstAlignedSweep()||n.getFirstSweep(),r=i.id),this.viewmodesModule.currentMode===u.a.Panorama&&n.isSweepUnaligned(n.currentSweep)?[2,this.engine.commandBinder.issueCommand(new v.a({sweep:r,rotation:e.rotation,transition:l.a.FadeToBlack}))]:[2,this.viewmodesModule.switchToMode(u.a.Panorama,t,{sweepID:r},s.DEFAULT_TRANSITION_TIME)]}}))}))},e.prototype.getLookAtSweep=function(t){return T(this,void 0,Promise,(function(){var e,n,r,i,o;return M(this,(function(a){return(e=this.engine.market.tryGetData(m.a))?(n=this.getCurrentFloorHeight(),r=new p.Hb(f.b.DOWN,n),(i=Object(d.h)(e.pose.position,e.pose.rotation,r))?((o=t.getClosestSweep(i,!0))||(o=t.getFirstSweep()),[2,o.id]):[2,t.getFirstSweep().id]):[2,t.getFirstSweep().id]}))}))},e.prototype.getCurrentFloorHeight=function(){if(!this.floorsViewData)try{this.floorsViewData=this.engine.market.tryGetData(x.b)}catch(t){return this.getModelMinHeight()}if(!this.floorsViewData)throw Error("Could not get floors viewdata");return this.floorsViewData.getFloorMin()},e.prototype.getModelMinHeight=function(){if(!this.modelMeshModule)try{this.modelMeshModule=this.engine.getModuleSync(h.default)}catch(t){return 0}return this.modelMeshModule.mesh.boundingBox.min.y},e.prototype.goToDollhouse=function(t,e){return void 0===t&&(t=l.a.Interpolate),void 0===e&&(e={}),T(this,void 0,void 0,(function(){return M(this,(function(n){return this.dhDisabled()?[2,Promise.reject("Cannot go to dollhouse mode")]:[2,this.viewmodesModule.switchToMode(u.a.Dollhouse,t,e)]}))}))},e.prototype.goToFloorplan=function(t,e){return void 0===t&&(t=l.a.Interpolate),void 0===e&&(e={}),T(this,void 0,void 0,(function(){return M(this,(function(n){return this.fpDisabled()?[2,Promise.reject("Cannot go to floorplan mode")]:[2,this.viewmodesModule.switchToMode(u.a.Floorplan,t,e)]}))}))},e}(o.a);e.default=E},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(50),a=n(413),s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},u=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},l=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="model-mesh-preview",e.defaultSize=.3,e}return s(e,t),e.prototype.init=function(t,e){return c(this,void 0,void 0,(function(){var t;return u(this,(function(n){switch(n.label){case 0:return this.engine=e,this.bindings.push(e.commandBinder.addBinding(a.a,this.update.bind(this))),t=this,[4,e.getModule(o.default)];case 1:return t.modelMeshModule=n.sent(),[2]}}))}))},e.prototype.update=function(t){return c(this,void 0,void 0,(function(){var e,n,r,i,a,s,c;return u(this,(function(u){switch(u.label){case 0:return this.modelMeshModule?[3,2]:(r=this,[4,this.engine.getModule(o.default)]);case 1:r.modelMeshModule=u.sent(),u.label=2;case 2:i=t.enabled&&t.previewCirclePosition?t.previewCirclePosition:null,a=t.size?t.size:this.defaultSize;try{for(s=l(this.modelMeshModule.mesh.chunks),c=s.next();!c.done;c=s.next())c.value.setMeshPreviewSphere(i,a)}catch(t){e={error:t}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return[2]}}))}))},e}(i.a);e.default=h},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(2),a=n(25),s=n(82),c=n(138),u=n(18),l=n(26),h=n(270),f=n(117),p=n(135),d=n(234),y=n(139),m=n(102),v=n(21),g=n(42),b=n(12),w=n(17),_=n(54),x=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),S=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},T=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},M=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},E=new o.a("showcase-measurements"),P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="measurement3d",e.featureActive=!1,e.checkFeatureEnablement=function(){var t=e.settings.tryGetProperty(f.c,!1),n=e.settings.tryGetProperty(v.a.Measurements,!1),r=e.measurementModeData.phase!==p.MeasuringPhase.CLOSED,i=e.appData&&e.appData.application===b.b.SHOWCASE&&t&&n&&r;i!==e.featureActive&&(E.debug("checkFeatureEnablement():",{featureVisible:i,featureFlagEnabled:t,userEnabled:n}),i?e.activate():e.deactivate())},e.clearPointGroups=function(){for(;e.pointGroups.length>0;)e.pointGroups.pop()},e.addMeasurementsToPointGroups=function(){var t=e.measurementViewData.data.grouper;e.pointGroups.copy(t.pointGroups.groups()),e.lookup=t.lookup},e}return x(e,t),e.prototype.init=function(t,e){return S(this,void 0,void 0,(function(){var t,n,r,i,o,s,f,v,_,x,S,E,P,O,A,D,R=this;return T(this,(function(T){switch(T.label){case 0:return[4,Promise.all([e.getModule(a.default),e.getModule(c.default),e.market.waitForData(u.a),e.market.waitForData(l.a),e.market.waitForData(h.a),e.market.waitForData(p.MeasurementModeData),e.market.waitForData(b.c),e.market.waitForData(w.a)])];case 1:return t=M.apply(void 0,[T.sent(),8]),n=t[0],r=t[1],i=t[2],o=t[3],s=t[4],f=t[5],v=t[6],_=t[7],this.appData=v,this.measurementModeData=f,this.measurementViewData=s,this.scene=n.getScene(),this.settings=o,this.engine=e,x=e.claimRenderLayer(this.name),S=Object(y.b)([]),this.pointGroups=new p.Grouper(S),E=function(t,e,n){return void 0===n&&(n=!1),Object(m.b)(S,t).createSubscription(e,n)},P=function(){return R.measurementModeData.selectedGroupIndex},O=function(){return _.isFloorplan()},A=function(t,e,n){var r=e-R.pointGroups.getGroupStartIndex(t),i=R.lookup.groupToIds[t][r];return R.measurementViewData.getViewData(i)},this.lineRenderer=new p.MeasurementLineRenderer(this.pointGroups,E,i,r,x,x,P,O,A,16777215),D=new d.a({color:"black",backgroundColor:"white"}),this.textRenderer=new p.MeasurementLabelRenderer(this.pointGroups,E,i,x,g.a.labels,D,A,O),this.checkFeatureEnablement(),[2]}}))}))},e.prototype.activate=function(){this.engine.addComponent(this,this.lineRenderer),this.engine.addComponent(this,this.textRenderer),this.addMeasurementsToPointGroups(),this.scene.addChild(s.a.Root,this.textRenderer.container),this.featureActive=!0},e.prototype.deactivate=function(){this.clearPointGroups(),this.engine.removeComponent(this,this.lineRenderer),this.engine.removeComponent(this,this.textRenderer),this.scene.removeChild(s.a.Root,this.textRenderer.container),this.featureActive=!1},e.prototype.onUpdate=function(){if(this.checkFeatureEnablement(),this.featureActive)for(var t=0;t<this.pointGroups.groupCount;t++){var e=this.lookup.groupToIds[t][0],n=this.measurementViewData.getViewData(e);if(void 0!==n){var r=n.opacity.value;(n.opacity.value<=_.c.LABEL_HIDDEN_OPACITY||_.c.HIDE_LABELS)&&(r=0),this.textRenderer&&this.textRenderer.setTextOpacityByGroup(t,r),this.lineRenderer&&this.lineRenderer.setLineOpacityByGroup(t,n.opacity.value)}}},e.prototype.dispose=function(e){this.deactivate(),this.textRenderer.dispose(),this.lineRenderer.dispose(),e.disposeRenderLayer(this.name),t.prototype.dispose.call(this,e)},e}(i.a);e.default=P},function(t,e,n){"use strict";n.r(e);n(466),n(491);var r,i=n(4),o=n(347),a=n(6),s=n(146),c=n(56),u=n(2),l=n(569),h=n(12),f=n(414),p=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),d=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},y=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},m=new u.a("webvr-loader"),v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="webvr-loader",e}return p(e,t),e.prototype.init=function(t,e){return d(this,void 0,void 0,(function(){var t,n,r=this;return y(this,(function(i){switch(i.label){case 0:return this.engine=e,this.onExitVr=this.onExitVr.bind(this),[4,e.getModule(s.default)];case 1:return t=i.sent(),n=this,[4,t.getApi().getAppKey("SHOWCASE","webvr_version")];case 2:return n.hackWebVRVersion=i.sent(),e.commandBinder.addBinding(f.a,(function(){return d(r,void 0,void 0,(function(){return y(this,(function(t){return[2,this.hackLoadVrScript()]}))}))})),e.commandBinder.addBinding(f.b,(function(){return d(r,void 0,void 0,(function(){return y(this,(function(t){return[2,this.hackEnterVrMode()]}))}))})),[2]}}))}))},e.prototype.maybeCacheVrDisplay=function(){return d(this,void 0,void 0,(function(){var t;return y(this,(function(e){switch(e.label){case 0:return[4,o.a()];case 1:return(t=e.sent())&&(this.vrDisplay=t),[2]}}))}))},e.prototype.hackEnterVrMode=function(){return d(this,void 0,void 0,(function(){return y(this,(function(t){switch(t.label){case 0:return[4,this.maybeCacheVrDisplay()];case 1:return t.sent(),m.debug("Presenting legacy webvr app to "+this.vrDisplay),this.vrDisplay?(m.info("Headset mounted"),this.engine.getModuleSync(c.default).disposeGui(),this.engine.deactivate(),this.explosivelyDisableGui(),[4,this.engine.commandBinder.issueCommand(new l.a(h.b.WEBVR))]):[3,3];case 2:return t.sent(),[3,4];case 3:m.error("vrDisplay not found"),t.label=4;case 4:return[2]}}))}))},e.prototype.hackLoadVrScript=function(){var t=a.A("webvr")||this.hackWebVRVersion;m.debug("Loading legacy webvr app version "+t);var e="https://static.matterport.com/webvr/"+t+"/js/main.js";return new Promise((function(t,n){var r=document.createElement("script");r.type="text/javascript",r.src=e,r.onload=t,document.head.appendChild(r)}))},e.prototype.onExitVr=function(){this.vrDisplay.isPresenting||(window.removeEventListener("vrdisplaypresentchange",this.onExitVr),m.info("Exiting VR"),this.hackUnload())},e.prototype.hackUnload=function(){var t=window.location.href;-1===window.location.search.indexOf("&qs=1")&&(t+="&qs=1"),window.location.replace(t)},e.prototype.explosivelyDisableGui=function(){var t=document.getElementById("gui");t&&t.remove()},e}(i.a);e.default=v},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(99),a=(n(874),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(){return(s=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},c=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},u=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="mouse-cursor",e.activeCursor=null,e}return a(e,t),e.prototype.init=function(t,e){return c(this,void 0,void 0,(function(){var n=this;return u(this,(function(r){return this.config=s({classPrefix:"cursor"},t),this.bindings.push(e.commandBinder.addBinding(o.a,(function(t){return c(n,void 0,void 0,(function(){return u(this,(function(e){return[2,this.changeCursor(t.cursor)]}))}))}))),[2]}))}))},e.prototype.changeCursor=function(t){var e=this.config,n=e.container,r=e.classPrefix;t!==this.activeCursor&&(this.activeCursor&&n.classList.remove(r+"-"+this.activeCursor),t&&n.classList.add(r+"-"+t),this.activeCursor=t)},e}(i.a);e.default=l},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(56),a=n(415),s=n(100),c=n(6),u=n(149),l=n(180),h=n(120),f=n(178),p=n(2),d=n(43),y=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),m=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},v=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},g=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},b=new p.a("screenshots"),w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="screenshots-module",e}return y(e,t),e.prototype.init=function(t,e){return m(this,void 0,void 0,(function(){var t,n=this;return v(this,(function(r){switch(r.label){case 0:return this.engine=e,[4,Promise.all([e.getModule(o.default),e.market.waitForData(s.a)])];case 1:return t=g.apply(void 0,[r.sent(),2]),this.settingsModule=t[0],this.canvas=t[1],this.settingsModule.registerButton("Debug","Take screenshot",(function(){return m(n,void 0,void 0,(function(){var t;return v(this,(function(e){switch(e.label){case 0:return t=Date.now(),[4,this.takeAndDownloadScreenshot({height:this.canvas.height,width:this.canvas.width},"image_"+t+".jpg",d.a.ALL)];case 1:return e.sent(),[2]}}))}))})),this.settingsModule.registerButton("Debug","Take 16k screenshot",(function(){return m(n,void 0,void 0,(function(){var t;return v(this,(function(e){switch(e.label){case 0:return t=Date.now(),[4,this.takeAndDownloadScreenshot({height:9e3,width:16e3},"image_"+t+".jpg",d.a.ALL)];case 1:return e.sent(),[2]}}))}))})),this.settingsModule.registerButton("Debug","Take FB 3D screenshot",(function(){return m(n,void 0,void 0,(function(){var t,e,n,r,i;return v(this,(function(o){switch(o.label){case 0:t=Date.now(),e=this.engine.getRenderLayer("model-mesh"),n=this.engine.getRenderLayer("skybox"),(r=e.clone()).addLayers(n),o.label=1;case 1:return o.trys.push([1,6,7,10]),[4,this.takeAndDownloadScreenshot({height:this.canvas.height,width:this.canvas.width},"image_"+t+".jpg",r)];case 2:return o.sent(),[4,this.engine.commandBinder.issueCommand(new l.a(h.b.Depth))];case 3:return o.sent(),[4,this.engine.commandBinder.issueCommand(new f.a(1))];case 4:return o.sent(),[4,this.takeAndDownloadScreenshot({height:Math.floor(this.canvas.height/4),width:Math.floor(this.canvas.width/4)},"image_"+t+"_depth.jpg",e)];case 5:return o.sent(),[3,10];case 6:throw i=o.sent(),b.error("Could not take screenshot"),i;case 7:return[4,this.engine.commandBinder.issueCommand(new l.a(null))];case 8:return o.sent(),[4,this.engine.commandBinder.issueCommand(new f.a(0))];case 9:return o.sent(),[7];case 10:return[2]}}))}))})),[2]}}))}))},e.prototype.takeAndDownloadScreenshot=function(t,e,n){return m(this,void 0,void 0,(function(){var r;return v(this,(function(i){switch(i.label){case 0:return[4,this.engine.commandBinder.issueCommand(new a.a({visibleObjects:n,resolution:t,returnType:a.b.ArrayBufferJPG}))];case 1:return r=i.sent(),Object(c.v)(Object(u.c)(r),e),[2]}}))}))},e}(i.a);e.default=w},function(t,e,n){"use strict";n.r(e);var r,i,o=n(2),a=n(4),s=n(160),c=n(7),u=n(0),l=n(3),h=n(211),f=n(60),p=n(18),d=n(91),y=n(109),m=n(26),v=n(25),g=n(65),b=new u.Jc(0,-100,0),w=new u.Ic(-2,-2),_=new u.Jc(-1,-1,-1),x=new u.Jc(1,1,1),S=function(){function t(t){var e=this;this.raycaster=t,this.lastHits=[],this.lastRay=new u.dc(b,new u.Jc(0,-1,0)),this.currentRay=new u.dc,this.origin=b,this.direction=new u.Jc,this.pointerNdc=w,this.cameraCache={position:new u.Jc,quaternion:new u.Pb,camera:void 0},this.cast=function(){var t=e.currentRay;return e.lastRay.equals(t)?e.lastHits:(e.lastHits=e.raycaster.cast(t.origin,t.direction).slice(),e.lastRay.copy(t),e.lastHits)},this.update3D=function(t,n,r){t instanceof u.Jc&&e.origin.copy(t),n instanceof u.Jc&&e.direction.copy(n),e.cameraCache.camera=r,e.currentRay.set(e.origin,e.direction)},this.updateNDCPosition=function(){var t=e.lastHits[0];if(e.cameraCache.camera&&t&&t.point){var n=e.cameraCache.camera;e.cameraCache.position.setFromMatrixPosition(n.matrixWorld),e.cameraCache.quaternion.setFromRotationMatrix(n.matrixWorld);var r=Object(g.f)(t.point,e.cameraCache.position,e.cameraCache.quaternion,n.projectionMatrix);r.clamp(_,x),e.pointerNdc.set(r.x,r.y)}},this.updatePointer=function(){}}return Object.defineProperty(t.prototype,"pointerRay",{get:function(){return this.currentRay},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ndcPosition",{get:function(){return this.updateNDCPosition(),this.pointerNdc},enumerable:!0,configurable:!0}),t}(),T=n(9),M=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),E=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e}(T.a),P=function(t){function e(e){var n=t.call(this)||this;return n.trackedCamera=e,n}return M(e,t),e}(E),O=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e}(E),A=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e}(E),D=n(556),R=n(298),C=n(43),I=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},k=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},L=function(){function t(t){var e=this;this.renderer=t,this._defaultController=0,this.controllerGroups=[],this.bindings=[],this.cancel=function(){e.bindings.forEach((function(t){return t.cancel()})),e.bindings.length=0},this.container=new u.J,this.container.name="XRControllerMesh",H.controllers.forEach((function(t){var n=e.createControllerGroup(t);e.controllerGroups.push(n),e.container.add(n.grip,n.pointer)})),this.connectControllerModel(),this.container.matrixAutoUpdate=!1}return t.prototype.controller=function(t){return void 0===t&&(t=this._defaultController),this.controllerGroups[t]},t.prototype.setDefault=function(t){this._defaultController=t},t.prototype.connectControllerModel=function(){return I(this,void 0,Promise,(function(){var t,e,r=this;return k(this,(function(i){switch(i.label){case 0:return[4,n.e(9).then(n.t.bind(null,1525,7))];case 1:return i.sent(),[4,n.e(9).then(n.bind(null,1532))];case 2:return t=i.sent(),e=new t.XRControllerModelFactory,H.controllers.forEach((function(t){var n=r.controller(t).grip;n.add(e.createControllerModel(n))})),[2]}}))}))},t.prototype.createControllerGroup=function(t){var e=this.renderer.xr.getController(t);e.name="Controller Ray "+t;var n=this.renderer.xr.getControllerGrip(t);n.name="Controller Grip "+t,n.visible=!1;var r={index:t,pointer:e,grip:n,connected:!1,hand:"none"},i=function(t){r.hand=t.data.handedness,r.connected=!0},o=function(){r.hand="none",r.connected=!1};return this.bindings.push(Object(s.b)((function(){return e.addEventListener("connected",i)}),(function(){return e.removeEventListener("connected",i)})),Object(s.b)((function(){return e.addEventListener("disconnected",o)}),(function(){return e.removeEventListener("disconnected",o)}))),r},t}(),N=new o.a("xr-input-forwarding"),j=function(){function t(t){var e=this;this.options=t,this.dispatchPointerDown=function(t){e.forwardEvent("pointerdown",e.mockPointerEventInit(t))},this.dispatchPointerUp=function(t){e.forwardEvent("pointerup",e.mockPointerEventInit(t))},this.target=t.forwardToElement}return t.prototype.dispatchPointerMove=function(t){this.forwardEvent("pointermove",this.mockPointerEventInit(t))},t.prototype.mockPointerEventInit=function(t){var e=0,n=0;if(this.options.getPointerScreenPosition){var r=this.options.getPointerScreenPosition();e=r.x,n=r.y}return{pointerType:"gamepad",pointerId:t,clientX:e,clientY:n}},t.prototype.forwardEvent=function(t,e){var n;try{(n=window.PointerEvent?new PointerEvent(t,e):new MouseEvent(t,e))&&this.target.dispatchEvent(n)}catch(t){N.error(t)}},t}(),B=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),F=function(){return(F=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},U=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},z=function(t){function e(e,n){var r=t.call(this)||this;return r.renderer=e,r.options={forwardNativeXrEvents:!0,dispatchToControllerGroup:!1,axisMoveTriggerThreshold:.5},r.previousGamepad=new Map,r.forwardedEvents=["selectstart","select","selectend","squeeze","squeezestart","squeezeend"],r.active=!1,r.renew=function(){!r.active&&r.options.forwardNativeXrEvents&&(r.addSessionListeners(),r.active=!0)},r.cancel=function(){r.active&&r.options.forwardNativeXrEvents&&(r.removeSessionListeners(),r.active=!1)},r.updateFromGamepads=function(){var t,e;if(r.active){var n=r.renderer.xr.getSession();if(n){var i=function(t){var e=n.inputSources[t];if(!e||!e.gamepad)return"continue";var i=r.renderer.xr.getController(t),o=r.previousGamepad.get(e),a={buttons:e.gamepad.buttons.map((function(t){return t.value})),axes:e.gamepad.axes.slice()},s={controllerIndex:t,inputSource:e,axes:a.axes};o&&(a.buttons.forEach((function(t,e){t!==o.buttons[e]&&(1===t?r.sendGamepadEvent(i,F({},s,{type:"buttondown",value:t,index:e})):0===t&&r.sendGamepadEvent(i,F({},s,{type:"buttonup",value:t,index:e})))})),a.axes.forEach((function(t,e){var n=o.axes[e];if(t!==n){r.sendGamepadEvent(i,F({},s,{type:"axesmove",value:t,index:e})),0===n&&r.sendGamepadEvent(i,F({},s,{type:"axesmovestart",value:t,index:e}));var a=r.options.axisMoveTriggerThreshold;Math.abs(n)<a&&Math.abs(t)>a&&r.sendGamepadEvent(i,F({},s,{type:"axestriggered",value:t,index:e})),0===t&&r.sendGamepadEvent(i,F({},s,{type:"axesmoveend",value:t,index:e}))}}))),r.previousGamepad.set(e,a)};try{for(var o=U(H.controllers),a=o.next();!a.done;a=o.next()){i(a.value)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}}}},r.onGamepadEvent=function(e,n){return Object(s.b)((function(){return t.prototype.addEventListener.call(r,e,n)}),(function(){return t.prototype.removeEventListener.call(r,e,n)}))},r.onSessionEvent=function(e,n){return Object(s.b)((function(){return t.prototype.addEventListener.call(r,e,n)}),(function(){return t.prototype.removeEventListener.call(r,e,n)}))},r.sendGamepadEvent=function(t,e){r.dispatchEvent(e),r.options.dispatchToControllerGroup&&t.dispatchEvent(e)},r.sendSessionEvent=function(t,e){r.dispatchEvent({type:t,controllerIndex:e})},r.addSessionListeners=function(){H.controllers.forEach((function(t){var e,n,i=r.renderer.xr.getController(t);try{for(var o=U(r.forwardedEvents),a=o.next();!a.done;a=o.next()){var s=a.value;i.addEventListener(s,(function(e){return r.sendSessionEvent(e.type,t)}))}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}}))},r.removeSessionListeners=function(){H.controllers.forEach((function(t){var e,n,i=r.renderer.xr.getController(t);try{for(var o=U(r.forwardedEvents),a=o.next();!a.done;a=o.next()){var s=a.value;i.removeEventListener(s,(function(e){return r.sendSessionEvent(e.type,t)}))}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}}))},n&&(r.options=F({},r.options,n)),r.renew(),r}return B(e,t),e}(u.B);!function(t){t[t.Mono=0]="Mono",t[t.Stereo=1]="Stereo",t[t.SixDof=2]="SixDof",t[t.__length=3]="__length"}(i||(i={}));var G,H={controllers:Object.freeze([0,1]),rotationDegrees:25};!function(t){t[t.touchpadX=0]="touchpadX",t[t.touchpadY=1]="touchpadY",t[t.thumbstickX=2]="thumbstickX",t[t.thumbstickY=3]="thumbstickY"}(G||(G={}));var V=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),W={x:0,y:0,z:0,w:1},q=function(t){function e(e,n,r,o,a){var s=t.call(this)||this;return s.engine=e,s.renderer=n,s.webglScene=r,s.cameraData=o,s.cameraModule=a,s.trackingStyle=i.Mono,s.session=null,s.rotations={initialYawOffset:new u.Pb,yawOffset:new u.Pb,invYawOffset:new u.Pb,trackingOffset:new u.Pb},s.setTrackingStyle=function(t){t<i.__length&&(s.trackingStyle=t,s.resetInitialRotation())},s.offsetRotation=function(t){s.rotations.invYawOffset.multiply(t),s.rotations.yawOffset.copy(s.rotations.invYawOffset).inverse()},s.onPresentStart=function(t){t.cameras[0].layers.mask=C.a.ALL.mask,t.cameras[1].layers.mask=C.a.ALL.mask,t.layers.mask=C.a.ALL.mask,s.resetInitialRotation(),s.broadcast(new O)},s.resetInitialRotation=function(){var t=s.cameraData.pose.rotation.clone();Object(c.j)(t,s.rotations.initialYawOffset),s.rotations.yawOffset.copy(s.rotations.initialYawOffset),s.rotations.invYawOffset.copy(s.rotations.initialYawOffset).inverse()},s.onPresentEnd=function(){s.broadcast(new A)},s.applyTrackingOverrides=function(t,e,n){if(t.xr.isPresenting&&n instanceof u.d){t.clear();var r=n.cameras[0],o=n.cameras[1];if(s.frame=s.engine.getXrFrame(),s.session||(s.session=t.xr.getSession(),s.onPresentStart(n)),s.frame&&s.session){s.rotations.trackingOffset.copy(s.rotations.yawOffset).multiply(n.quaternion),s.cameraModule.updateCameraRotation(s.rotations.trackingOffset);var a=s.webglScene.camera.parent;if(a){var c=s.getReferenceSpace(s.frame,a);s.updateCameras(n,s.frame,c,a),s.updateControllers(s.session,s.frame,c,a)}switch(s.trackingStyle){case i.Mono:o.matrixWorld.copy(r.matrixWorld),o.matrixWorldInverse.getInverse(o.matrixWorld)}s.broadcast(new P(r))}}else s.session&&(s.session=null,s.onPresentEnd())},s.getReferenceSpace=function(t,e){var n=s.renderer.xr.getReferenceSpace(),r=t.getViewerPose(n).views[0].transform.position,o=s.trackingStyle===i.SixDof?W:r,a=new XRRigidTransform({x:o.x-e.position.x,y:o.y-e.position.y,z:o.z-e.position.z}),c=n.getOffsetReferenceSpace(a),u=s.rotations.invYawOffset,l=s.cameraData.pose.position,h=new XRRigidTransform({x:l.x,y:l.y,z:l.z,w:1},{x:u.x,y:u.y,z:u.z,w:u.w});return c.getOffsetReferenceSpace(h)},s.updateCameras=function(t,e,n,r){var i=e.getViewerPose(n);if(i)for(var o=i.views,a=0;a<o.length;a++){var s=o[a],c=t.cameras[a];c.matrix.fromArray(s.transform.matrix),c.projectionMatrix.fromArray(s.projectionMatrix),c.projectionMatrixInverse.getInverse(c.projectionMatrix),c.matrixWorld.multiplyMatrices(r.matrixWorld,c.matrix),c.matrixWorldInverse.getInverse(c.matrixWorld),c.matrix.decompose(c.position,c.quaternion,c.scale),0===a&&(t.matrix.copy(c.matrix),t.matrix.decompose(t.position,t.quaternion,t.scale),t.matrixWorld.copy(c.matrixWorld),t.matrixWorldInverse.copy(c.matrixWorldInverse),t.projectionMatrix.copy(c.projectionMatrix),t.projectionMatrixInverse.copy(c.projectionMatrixInverse))}},s.updateControllers=function(t,e,n,r){for(var i=0;i<2;i++){var o=s.renderer.xr.getController(i),a=s.renderer.xr.getControllerGrip(i),c=t.inputSources[i],u=null,l=null;c&&(o&&((u=e.getPose(c.targetRaySpace,n))&&(o.matrix.fromArray(u.transform.matrix),o.matrixWorld.multiplyMatrices(r.matrixWorld,o.matrix),o.matrix.decompose(o.position,o.quaternion,o.scale)),o.visible=!!u),a&&c.gripSpace&&(l=e.getPose(c.gripSpace,n))&&(a.matrix.fromArray(l.transform.matrix),a.matrixWorld.multiplyMatrices(r.matrixWorld,a.matrix),a.children.forEach((function(t){t.updateMatrixWorld()})),a.matrix.decompose(a.position,a.quaternion,a.scale))),a&&(a.visible=!!l)}},s.webglScene.scene.onBeforeRender=s.applyTrackingOverrides,s}return V(e,t),e}(R.a),Y=n(38),J=n(163),X=n(138),K=n(157),Q=n(233),Z=n(72),$=n(301),tt=n(15),et=n(51),nt=n(17),rt=n(192),it=n(48),ot=n(612),at=n.n(ot),st=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},ct=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},ut=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},lt=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(ut(arguments[e]));return t},ht=function(){function t(){var t=this;this.active=!1,this.target=new Y.a(null),this.previousSweep=null,this.activate=function(){t.active||(t.updateLoopSub.renew(),t.selectionChangeSub.renew(),t.ray.toggle(!0),t.targetDecoration.toggle(!0),t.active=!0)},this.deactivate=function(){t.active&&(t.target.value=null,t.selectionChangeSub.cancel(),t.updateLoopSub.cancel(),t.ray.toggle(!1),t.targetDecoration.toggle(!1),t.active=!1)},this.getTargetSweep=function(t,e,n){if(e.object instanceof $.a)return t.getSweep(e.object.userData.sid);var r=Object(Q.b)(t,!0,e.intersection);return r.length>0?r[0].sweep:null}}return Object.defineProperty(t.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0}),t.prototype.init=function(t){return st(this,void 0,void 0,(function(){var e,n=this;return ct(this,(function(r){switch(r.label){case 0:return this.engine=t,this._container=new u.J,this._container.name="XRNavigationVisuals",this.ray=new ft(this.container),this.targetDecoration=new pt(this.container),[4,this.engine.market.waitForData(y.b)];case 1:return e=r.sent(),this.updateLoopSub=e.onChanged((function(){return n.update(e)})),this.updateLoopSub.cancel(),this.selectionChangeSub=this.target.onChanged((function(t){null!==n.previousSweep&&n.engine.commandBinder.issueCommand(new Z.e(n.previousSweep.id,!1,200)),null!==t&&(n.engine.commandBinder.issueCommand(new Z.e(t.id,!0,200)),n.targetDecoration.updateTargetPosition(t.floorPosition)),n.previousSweep=t})),this.selectionChangeSub.cancel(),[2,this]}}))}))},t.prototype.update=function(t){var e=this.engine.market.tryGetData(tt.a),n=this.engine.market.tryGetData(p.a),r=this.engine.market.tryGetData(nt.a),i=this.engine.market.tryGetData(rt.a),o=this.engine.market.tryGetData(et.a);if(e&&n&&r&&o&&i&&o.isVR()&&r.isPano()){var a=t.hit,s=t.pointerDirection,c=t.pointerOrigin;if(a){var u=this.getTargetSweep(e,a,s);this.target.value=u,this.ray.update(c,a.point,i.opacity.value),this.targetDecoration.update(n.pose.rotation,i.opacity.value)}}},t}(),ft=function(t){var e=this;this.container=t,this.styles={ray:{color:"white",transparent:!0,opacity:.3,linewidth:2,depthWrite:!1},hit:{color:"white",transparent:!0,opacity:.3},hitScale:.02},this.update=function(t,n,r){e.ray.updatePositions(t,n).opacity(Math.min(r,e.styles.ray.opacity)),e.hitMarker.position.copy(n),e.hitMarker.material.opacity=Math.min(r,e.styles.hit.opacity)},this.toggle=function(t){var n,r;t?((n=e.container).add.apply(n,lt(e.ray.children)),e.container.add(e.hitMarker)):((r=e.container).remove.apply(r,lt(e.ray.children)),e.container.remove(e.hitMarker))};var n=this.styles,r=n.ray,i=n.hit,o=X.default.makeLineMaterial(r.color,!1,r);this.ray=new K.b(new u.Jc,new u.Jc,o,{}),this.ray.updateResolution(window.innerWidth,window.innerHeight),this.hitMarker=new J.a(new u.nc(this.styles.hitScale),new u.mb(i)),this.hitMarker.name="hit"},pt=function(t){var e=this;this.container=t,this.styles={scale:.46,animationSpeed:1,plane:{color:"white",transparent:!0,opacity:.6,depthWrite:!1,depthTest:!1,map:Object(it.a)(at.a)}},this.position=new u.Jc,this.quaternion=new u.Pb,this.updateTargetPosition=function(t){e.position.copy(Object(c.p)(t,l.b.UP,.05))},this.update=function(t,n){var r=Object(c.j)(t,e.quaternion);e.target.quaternion.copy(r),e.target.position.lerp(e.position,e.styles.animationSpeed),e.target.material.opacity=Math.min(n,e.styles.plane.opacity)},this.toggle=function(t){t?e.container.add(e.target):e.container.remove(e.target)};var n=new u.Ib(1),r=new u.jb;r.makeRotationFromEuler(new u.A(-Math.PI/2,0,0,"XYZ")),n.applyMatrix4(r),this.target=new J.a(n,new u.mb(this.styles.plane)),this.target.name="Destination",this.target.scale.set(this.styles.scale,this.styles.scale,this.styles.scale)},dt=function(){function t(t){this.controllers=t,this._lastInputWas=0}return t.prototype.focus=function(t){var e=this;t!==this._lastInputWas&&(H.controllers.forEach((function(n){e.controllers.controller(n).grip.visible=n!==t})),this._lastInputWas=t)},t}(),yt=n(272),mt=n(222),vt=n(13),gt=n(58),bt=n(6);var wt=n(32),_t=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),xt=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},St=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Tt=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},Mt=new o.a("xr"),Et=(new u.Pb).setFromAxisAngle(l.b.UP,u.ib.DEG2RAD*H.rotationDegrees),Pt=(new u.Pb).setFromAxisAngle(l.b.UP,u.ib.DEG2RAD*-H.rotationDegrees),Ot=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="webxr",e.framebufferScaledTo=1,e.framebufferScale=0,e.ray={forward:new u.Jc,origin:new u.Jc},e.onXrPresentBegin=function(){var t=e.renderer.xr.getSession();Mt.info("Session framebuffer: "+t.renderState.baseLayer),e.engine.commandBinder.issueCommand(new mt.a(!0)),e.engine.commandBinder.issueCommand(new mt.b(vt.c.HIGH)),e.viewmodeData.isPano()||e.engine.commandBinder.issueCommand(new wt.a(wt.b.INSIDE)),e.xrPointer=new S(e.raycaster.picking),e.raycaster.setOverridePointer(e.xrPointer),e.xrNavVisuals.activate()},e.onXrPresentEnd=function(){var t=null!==e.settings.tryGetProperty(gt.a,null);e.engine.commandBinder.issueCommand(new mt.a(t)),e.engine.commandBinder.issueCommand(new mt.b(e.config.navPanoSize)),e.xrNavVisuals.deactivate(),e.raycaster.setOverridePointer(null),e.cameraModule.updateCameraRotation(Object(c.j)(e.cameraData.pose.rotation,new u.Pb)),e.webglScene.setCameraDirty()},e.onXrTrackingApplied=function(t){var n=e.controllerMesh.controller();if(n.connected){var r=e.ray.forward.copy(l.b.FORWARD).applyQuaternion(n.pointer.quaternion),i=e.ray.origin.setFromMatrixPosition(n.pointer.matrixWorld);e.xrPointer.update3D(i,r,t.trackedCamera),e.xrPointerInput.dispatchPointerMove(n.index)}e.xrGamepadInput.updateFromGamepads()},e.requestSession=function(t,n){return xt(e,void 0,Promise,(function(){var e,r;return St(this,(function(i){switch(i.label){case 0:return[4,Object(yt.c)()];case 1:return i.sent()!==yt.b.webxr?[2,null]:this.renderer.xr.isPresenting?[2,this.renderer.xr.getSession()]:yt.e.apiExists()?[4,navigator.xr.requestSession(t,{optionalFeatures:n})]:[3,3];case 2:return e=i.sent(),r=XRWebGLLayer.getNativeFramebufferScaleFactor(e),this.framebufferScaledTo=this.framebufferScale*(r-1)+1,Mt.info("Scaling framebuffer by:",this.framebufferScaledTo,"native size:",r," * factor:",this.framebufferScale),0!==this.framebufferScale&&this.renderer.xr.setFramebufferScaleFactor(this.framebufferScaledTo),this.renderer.xr.setSession(e),[2,e];case 3:return[2,null]}}))}))},e}return _t(e,t),e.prototype.init=function(t,e){return xt(this,void 0,void 0,(function(){var n,r,i,o,a,c,u,l,g=this;return St(this,(function(b){switch(b.label){case 0:return this.config=t,this.engine=e,[4,e.getModule(v.default)];case 1:return i=b.sent(),this.renderer=i.threeRenderer,this.webglScene=i.getScene(),o=this,[4,e.market.waitForData(m.a)];case 2:return o.settings=b.sent(),this.bindings.push(e.commandBinder.addBinding(D.a,(function(t){return g.requestSession(t.type,t.features)}))),[4,Object(yt.c)()];case 3:return b.sent()!==yt.b.webxr?[2]:[4,Promise.all([e.getModule(h.default),e.getModule(f.default),e.getModule(d.default)])];case 4:return n=Tt.apply(void 0,[b.sent(),3]),this.canvasModule=n[0],this.cameraModule=n[1],this.raycaster=n[2],[4,Promise.all([e.market.waitForData(p.a),e.market.waitForData(y.b),e.market.waitForData(nt.a)])];case 5:return r=Tt.apply(void 0,[b.sent(),3]),this.cameraData=r[0],this.raycasterData=r[1],this.viewmodeData=r[2],this.renderer.xr.setReferenceSpaceType("local"),this.framebufferScale=this.config.framebufferScaling||(w=i.gpuInfo,!(_=Object(bt.n)())||_&&function(t){return/Adreno \(TM\) (540|[6-9]\d\d)/.test(t.renderer)}(w)?1:0),(a=new q(e,this.renderer,this.webglScene,this.cameraData,this.cameraModule)).setTrackingStyle(t.tracking),this.bindings.push(a.subscribe(O,this.onXrPresentBegin),a.subscribe(A,this.onXrPresentEnd),a.subscribe(P,this.onXrTrackingApplied)),this.controllerMesh=new L(this.renderer),this.webglScene.add(this.controllerMesh.container),c=new dt(this.controllerMesh),u=t.enableEventPositions?function(){return g.raycasterData.pointerScreenPosition}:void 0,this.xrPointerInput=new j({forwardToElement:this.canvasModule.element,getPointerScreenPosition:u}),this.xrGamepadInput=new z(this.renderer),l=new s.a(this.xrGamepadInput.onGamepadEvent("axestriggered",(function(t){t.index!==G.thumbstickX&&t.index!==G.touchpadX||(Mt.debug(t.inputSource.handedness+" "+G[t.index]+" axis.value over threshold, do the rotate!"),Math.sign(t.value)>0?a.offsetRotation(Et):a.offsetRotation(Pt));c.focus(t.controllerIndex),g.controllerMesh.setDefault(t.controllerIndex)})),this.xrGamepadInput.onSessionEvent("selectstart",(function(t){g.xrPointerInput.dispatchPointerDown(t.controllerIndex),c.focus(t.controllerIndex),g.controllerMesh.setDefault(t.controllerIndex)})),this.xrGamepadInput.onSessionEvent("selectend",(function(t){g.xrPointerInput.dispatchPointerUp(t.controllerIndex),c.focus(t.controllerIndex),g.controllerMesh.setDefault(t.controllerIndex)})),this.xrGamepadInput.onSessionEvent("squeezestart",(function(t){c.focus(t.controllerIndex),g.controllerMesh.setDefault(t.controllerIndex)}))),this.bindings.push(l,this.xrGamepadInput),this.xrNavVisuals=new ht,this.xrNavVisuals.init(e),this.webglScene.add(this.xrNavVisuals.container),[2]}var w,_}))}))},e}(a.a);e.default=Ot},function(t,e,n){"use strict";n.r(e);var r,i=n(2),o=n(4),a=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(t){this.areaFloor=t.area_floor},c=function(t){function e(e){var n=t.call(this,e)||this;return n.floors=(e.floors||[]).map((function(t){return new u(t)})),n.rooms=(e.rooms||[]).map((function(t){return new l(t)})),n}return a(e,t),e}(s),u=function(t){function e(e){var n=t.call(this,e)||this;return n.id=e.id,n}return a(e,t),e}(s),l=function(t){function e(e){var n=t.call(this,e)||this;return n.id=e.id,n.floorId=e.floor_id,n.width=e.width,n.depth=e.depth,n.height=e.height,n.labels=e.labels||[],n.sweepUuids=e.sweep_uuids||[],n}return a(e,t),e}(s),h=n(47),f=function(){function t(){}return t.prototype.serialize=function(t){throw new h.a},t.prototype.deserialize=function(t){return new c(t)},t}(),p=n(23),d=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),y=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},m=function(t){function e(e){var n,r,i,o,a,s,c,u,l=t.call(this)||this;if(l.name="semantic-model-data",l.floors=new Map,l.rooms=new Map,l.roomsPerFloor=new Map,l.roomsPerLabel=new Map,l.hasRoom=function(t){return l.rooms.has(t)},l.getRoom=function(t){return l.rooms.get(t)},l.getLabels=function(){return l.roomsPerLabel.keys()},l.getRoomsByLabel=function(t){return l.roomsPerLabel.get(t)||[]},l.getAllRoomsByLabel=function(){var t,e,n={};try{for(var r=y(l.roomsPerLabel.keys()),i=r.next();!i.done;i=r.next()){var o=i.value;n[o]=l.roomsPerLabel.get(o)||[]}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return n},l.roomIterator=function(){return l.rooms.values()},!e)return l;try{for(var h=y(e.floors),f=h.next();!f.done;f=h.next()){var p=f.value;l.floors.set(p.id,p)}}catch(t){n={error:t}}finally{try{f&&!f.done&&(r=h.return)&&r.call(h)}finally{if(n)throw n.error}}try{for(var d=y(e.rooms),m=d.next();!m.done;m=d.next()){var v=m.value;l.rooms.set(v.id,v);var g=l.roomsPerFloor.get(v.floorId)||[];if(g.push(v),l.roomsPerFloor.set(v.floorId,g),v.labels.length>0)try{for(var b=y(v.labels),w=b.next();!w.done;w=b.next()){var _=w.value;if(!(v.sweepUuids.length<1)){var x=l.roomsPerLabel.get(_)||[];x.push(v),l.roomsPerLabel.set(_,x)}}}catch(t){a={error:t}}finally{try{w&&!w.done&&(s=b.return)&&s.call(b)}finally{if(a)throw a.error}}}}catch(t){i={error:t}}finally{try{m&&!m.done&&(o=d.return)&&o.call(d)}finally{if(i)throw i.error}}try{for(var S=y(l.roomsPerLabel.values()),T=S.next();!T.done;T=S.next()){T.value.sort((function(t,e){return e.areaFloor-t.areaFloor}))}}catch(t){c={error:t}}finally{try{T&&!T.done&&(u=S.return)&&u.call(S)}finally{if(c)throw c.error}}return l}return d(e,t),e.prototype.getRoomsByFloor=function(t){return this.roomsPerFloor.get(t)||[]},Object.defineProperty(e.prototype,"roomCount",{get:function(){return this.rooms.size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"floorCount",{get:function(){return this.floors.size},enumerable:!0,configurable:!0}),e}(p.a),v=n(271),g=n(86),b=function(){return(b=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},w=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},_=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},x=function(){function t(t){this.config=b({},t),this.client=new v.a({queue:this.config.queue})}return t.prototype.create=function(){return w(this,void 0,void 0,(function(){return _(this,(function(t){throw new g.a}))}))},t.prototype.read=function(){return w(this,void 0,Promise,(function(){var t,e,n,r,i;return _(this,(function(o){return t=this.config,e=t.modelId,n=t.serializer,r=t.adapter,i=[{floors:["id",{dimensions:["height","width","depth","areaFloor"]},{rooms:["id","tags",{panoLocations:["id"]},{dimensions:["height","width","depth","areaFloor"]}]}]}],[2,this.client.model(i,{id:e}).then((function(t){if(!t||!t.data)return null;var e=t.data.model.floors,i=r?r.decode(e):e;return n?n.deserialize(i):i}))]}))}))},t.prototype.update=function(){return w(this,void 0,void 0,(function(){return _(this,(function(t){throw new g.a}))}))},t.prototype.delete=function(){return w(this,void 0,void 0,(function(){return _(this,(function(t){throw new g.a}))}))},t}(),S=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},T=function(){function t(){}return t.prototype.decode=function(t){var e,n,r,i,o={floors:[],rooms:[],area_floor:-1};try{for(var a=S(t),s=a.next();!s.done;s=a.next()){var c=s.value,u={id:parseInt(c.id,10),area_floor:c.dimensions&&c.dimensions.areaFloor?c.dimensions.areaFloor:-1};if(o.floors.push(u),c.rooms)try{for(var l=S(c.rooms),h=l.next();!h.done;h=l.next()){var f=h.value,p=f.dimensions||null,d={id:parseInt(f.id,10),floor_id:parseInt(c.id,10),area_floor:p&&p.areaFloor?p.areaFloor:-1,height:p&&p.height?p.height:-1,width:p&&p.width?p.width:-1,depth:p&&p.depth?p.depth:-1,sweep_uuids:f.panoLocations?f.panoLocations.map((function(t){return t.id.replace(/-/g,"")})):[],labels:f.tags?f.tags:[]};o.rooms.push(d)}}catch(t){r={error:t}}finally{try{h&&!h.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return o},t.prototype.encode=function(t){throw new g.a},t}(),M=n(148),E=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),P=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},O=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},A=new i.a("semantic"),D=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="semantic-data",e.store=null,e.getDataStore=function(t,n){return P(e,void 0,void 0,(function(){var e,n,r,i;return O(this,(function(o){e=null,n=t.sid,r=t.queue,i=t.storageProvider;try{i===M.a.MDS&&(e=new x({modelId:n,readonly:!0,adapter:new T,serializer:new f,queue:r}))}catch(t){A.error(t)}return[2,e]}))}))},e}return E(e,t),e.prototype.init=function(t,e){return P(this,void 0,void 0,(function(){var n,r,i;return O(this,(function(o){switch(o.label){case 0:return n=null,r=this,[4,this.getDataStore(t,e)];case 1:return r.store=o.sent(),this.store?[4,this.store.read()]:[3,3];case 2:n=o.sent(),o.label=3;case 3:return i=new m(n),e.market.register(this,m,i),A.debug("Semantic data",{storageProvider:t.storageProvider},i),[2]}}))}))},e.prototype.onUpdate=function(){},e}(o.a),R=n(544);n.d(e,"SemanticData",(function(){return m})),n.d(e,"ISemanticDataModuleConfig",(function(){return R.ISemanticDataModuleConfig}));e.default=D},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(60),a=n(50),s=n(31),c=n(118),u=n(8),l=n(16),h=n(77),f=n(15),p=n(17),d=n(18),y=n(174),m=n(164),v=n(207),g=n(112),b=n(109),w=n(1),_=n(53),x=n(193),S=n(0),T=n(7),M=n(57),E=n(3),P=n(46),O=n(232),A=n(35),D=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},R=function(){function t(t,e,n,r,i,o,a,s,c){var u=this;this.enableAngleFade=t,this.pose=e,this.floorsViewData=n,this.viewmodeData=r,this.sweepData=i,this.raycasterData=o,this.floorMeshes=a,this.meshData=s,this.touchDevice=c,this.vectors={lookDir:new S.Jc,flattenedLookDir:new S.Jc},this.floorTargetOpacity={},this.getAngleModifier=function(){var t=u.vectors.lookDir.copy(E.b.FORWARD).applyQuaternion(u.pose.rotation),e=u.vectors.flattenedLookDir.copy(t).setY(0),n=t.angleTo(e)*T.c,r=P.a.FADE_IN_START_ANGLE,i=P.a.FADE_IN_END_ANGLE,o=1-Object(T.g)(n,r,i,0,1);return Object(M.f)(o,0,1,1)},this.getDiscardDistance=function(t){return t?4+(u.pose.focalDistance*P.a.DISCARD_FOCAL_MULTI||0):0}}return t.prototype.activate=function(){},t.prototype.init=function(){},t.prototype.dispose=function(){},t.prototype.deactivate=function(){var t,e,n,r;try{for(var i=D(this.floorMeshes),o=i.next();!o.done;o=i.next()){var a=o.value;try{for(var s=D(a.roomMeshes),c=s.next();!c.done;c=s.next()){c.value.opacity=1}}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},t.prototype.beforeRender=function(){var t,e,n=this.floorsViewData.nearestFloor,r=this.floorsViewData.transition.progress.active,i=!this.viewmodeData.isPano()&&-1!==n,o=P.a.FADE_OPAQUE,a=o,s=o;i&&(this.enableAngleFade?(a=o*this.getAngleModifier()*P.a.FADE_IN_VALUE,s=Math.max(a,P.a.FADE_BELOW_MIN)):(a=P.a.FADE_ABOVE,s=P.a.FADE_BELOW));this.sweepData.isSweepUnaligned(this.sweepData.currentSweep)&&this.viewmodeData.isPano()&&(o=0,a=0,s=0);try{for(var c=D(this.floorMeshes),u=c.next();!u.done;u=c.next()){var l=u.value,h=l.floorIndex,f=o,p=this.isBelowSelectedFloor(h)?s:a,d=Object(T.e)(p+P.a.FADE_IN_HOVER_BOOST_VALUE,0,1);f=this.isHoveredFloor(h)&&!r&&p>0?d:p,f=this.isFloorTransitioningOut(h)?p:f,f=this.isSelectedFloor(h)||this.isFloorTransitioningIn(h)?o:f,f=this.clampForViewmodeTransitions(f),this.floorTargetOpacity[l.floorIndex]=f}}catch(e){t={error:e}}finally{try{u&&!u.done&&(e=c.return)&&e.call(c)}finally{if(t)throw t.error}}},t.prototype.render=function(){var t,e,n,r,i=this.floorsViewData.nearestFloor,o=this.viewmodeData.isDollhouse()&&-1!==i;try{for(var a=D(this.floorMeshes),s=a.next();!s.done;s=a.next()){var c=s.value;try{for(var u=D(c.roomMeshes),l=u.next();!l.done;l=u.next()){var h=l.value,f=h.opacity,p=this.floorTargetOpacity[h.floorIndex];h.opacity=S.ib.lerp(f,p,.2),h.transparentFadeDist=this.getDiscardDistance(o&&h.floorIndex>i)}}catch(t){n={error:t}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}},t.prototype.clampForViewmodeTransitions=function(t){if(this.viewmodeData.currentMode===w.a.Transition&&this.viewmodeData.transition.to===w.a.Panorama)return Math.max(1-this.meshData.opacity.value,t);return t},t.prototype.isHoveredFloor=function(t){if(this.raycasterData.hit&&this.viewmodeData.isDollhouse()&&!this.touchDevice){var e=this.raycasterData.hit.object;if(e&&Object(O.a)(e))return t===e.floorIndex}return!1},t.prototype.isSelectedFloor=function(t){return this.floorsViewData.nearestFloor===A.a||this.floorsViewData.nearestFloor===t},t.prototype.isBelowSelectedFloor=function(t){return this.floorsViewData.nearestFloor>t},t.prototype.isFloorTransitioningIn=function(t){return!(!this.floorsViewData.transition.progress.active||this.floorsViewData.transition.to!==A.a&&this.floorsViewData.transition.to!==t)},t.prototype.isFloorTransitioningOut=function(t){return!(!this.floorsViewData.transition.progress.active||this.floorsViewData.transition.from!==A.a&&this.floorsViewData.transition.from!==t&&this.floorsViewData.transition.to===t)},t}(),C=n(24),I=n(320),k=n(63),L=n(10),N=n(90),j=n(72),B=n(6),F={debugFocusPoint:1===Object(B.A)("debugFocusPoint",0),useFocusPoint:1===Object(B.A)("floorFocusPoint",1),lookAtFocusPoint:Object(B.A)("floorFocusPoint",.4),maxShiftMultiplier:Object(B.A)("floorFocusMaxShift",7)},U=n(28),z=n(40),G=n(119),H=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},V=function(){function t(t,e,n,r,i,o,a,s,c){var u=this;this.engine=t,this.floorsData=e,this.viewData=n,this.sweepData=r,this.cameraData=i,this.cameraModule=o,this.viewmodeData=a,this.updateCurrentFloor=s,this.meshData=c,this.FLOOR_TRANSITION_TIME=500,this.moveFloorUp=function(t,e){void 0===t&&(t=!1);var n=Math.min(u.viewData.totalFloors,u.viewData.currentFloor+1);return u.moveToFloor(n,t,e)},this.moveFloorDown=function(t,e){void 0===t&&(t=!1);var n=Math.max(0,u.viewData.currentFloor-1);return u.moveToFloor(n,t,e)},this.moveToFloor=function(t,e,n,r){void 0===e&&(e=!1);var i=u.viewData.currentFloor===t,o=1===u.viewData.totalFloors&&t===A.a;if(i||o)return u.updateCurrentFloor(t),C.a.resolve();if(!u.canMoveToFloor(t,e))return C.a.reject("Cannot transition floors");u.engine.broadcast(new I.a(u.viewData.currentFloor,t)),void 0===n&&(n=u.FLOOR_TRANSITION_TIME);var a,s=new C.a;u.viewData.transitionToFloor(u.viewData.currentFloor,t,n,s.nativePromise()),u.viewData.commit();var c,l=r,h=Promise.resolve(),f=u.floorsData.getFloor(t)?z.g:function(t){return function(t){return Object(A.c)(t.floor)}},p=[Object(z.b)(),Object(z.c)(),f(t)],d=[Object(G.e)(r||u.cameraData.pose.position)],y=u.sweepData.sortByScore(p,d).shift();y&&(l=y.sweep.position,a=y.sweep.id,(u.viewmodeData.isDollhouse()||u.viewmodeData.isFloorplan())&&(h=u.engine.commandBinder.issueCommand(new j.d(a)))),c=e?Promise.resolve():u.getCameraTransition(t,n,a,l);var m=u,v=C.a.all([s,c,h]);return u.engine.startGenerator((function(){var t,e,n;return H(this,(function(r){switch(r.label){case 0:t=Date.now(),r.label=1;case 1:return m.viewData.transition.progress.active?[4,new k.b]:[3,3];case 2:return r.sent(),e=Date.now(),n=e-t,m.viewData.transition.progress.tick(n),m.viewData.commit(),t=e,[3,1];case 3:return m.updateCurrentFloor(m.viewData.transition.to),s.resolve(),[2]}}))})),v}}return t.prototype.canMoveToFloor=function(t,e){var n=this.viewData.transition.progress.active,r=this.cameraData.canTransition()||e,i=t<=this.viewData.totalFloors-1;return!n&&r&&i&&t>=-1},t.prototype.getCameraTransition=function(t,e,n,r){if(this.viewmodeData.currentMode===w.a.Dollhouse||this.viewmodeData.currentMode===w.a.Floorplan){var i=this.getPoseForFloor(t,r);return this.cameraModule.moveTo({transitionType:L.a.Interpolate,pose:i.pose,focalDistance:i.focalDistance,transitionTime:e}).nativePromise()}return this.viewmodeData.currentMode===w.a.Panorama&&n?this.engine.commandBinder.issueCommand(new N.a({transition:L.a.Interpolate,sweep:n})):Promise.resolve()},t.prototype.getPoseForFloor=function(t,e){var n=this.cameraData.pose,r=n.position,i=n.rotation,o=this.floorsData.getFloor(t),a=o?o.medianSweepHeight():this.meshData.center.y,s=o?o.center:this.meshData.center;s.setY(a);var c,u,l=E.b.FORWARD.clone().applyQuaternion(i),h=r.clone();if(e&&F.useFocusPoint){var f=r.clone().addScaledVector(l,this.cameraData.pose.focalDistance),p=(new S.Jc).set(0,r.y,0),d=(new S.Jc).set(0,f.y,0),y=p.distanceTo(d);h.setY(a+y);var m=e.clone();p.set(h.x,0,h.z),d.set(m.x,0,m.z),p.distanceTo(d)<y*F.maxShiftMultiplier&&(m=f.clone().lerp(e,F.lookAtFocusPoint).setY(e.y)),u=m.distanceTo(h),this.viewmodeData.isDollhouse()&&(c=Object(U.j)(h,m))}else{var v=(o?o.size.y:W)/2+W*-l.y;h.setY(a+v),u=h.distanceTo(s)}return{focalDistance:u,pose:{position:h,rotation:c}}},t}(),W=8,q=n(116),Y=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),J=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},X=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},K=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="floors-viewdata",e.lockToFloor=null,e.updateCurrentFloor=function(t){null!==e.lockToFloor&&(t=e.lockToFloor),e.floorsViewData.currentFloor!==t&&(e.floorsViewData.transitionToFloorInstant(t),e.engine.broadcast(new m.a(t,e.floorsViewData.getFloorName(t))))},e}return Y(e,t),e.prototype.init=function(t,e){return J(this,void 0,void 0,(function(){var n,r,i,u,l,h,m,S,T,M,E,P,O=this;return X(this,(function(D){switch(D.label){case 0:return this.engine=e,[4,e.getModule(c.default)];case 1:return n=D.sent(),r=this,[4,e.market.waitForData(x.a)];case 2:return r.floorsData=D.sent(),i=function(){return void 0!==O.sweepData.currentAlignedSweepObject&&O.viewmodeData.isPano()},this.floorsViewData=new A.b(this.floorsData,n.t.bind(n),i),t.disableFloorchanges&&(this.updateCurrentFloor(-1),this.lockToFloor=-1),e.market.register(this,A.b,this.floorsViewData),u=this,[4,e.market.waitForData(p.a)];case 3:return u.viewmodeData=D.sent(),l=this,[4,e.market.waitForData(f.a)];case 4:return l.sweepData=D.sent(),h=this,[4,e.market.waitForData(d.a)];case 5:return h.cameraData=D.sent(),m=this,[4,e.getModule(s.default)];case 6:return m.input=D.sent(),[4,e.getModule(o.default)];case 7:return S=D.sent(),[4,e.market.waitForData(y.a)];case 8:return T=D.sent(),[4,e.getModule(a.default)];case 9:return M=D.sent(),E=this,[4,e.market.waitForData(b.b)];case 10:return E.raycasterData=D.sent(),this.floorNavigation=new V(e,this.floorsData,this.floorsViewData,this.sweepData,this.cameraData,S,this.viewmodeData,this.updateCurrentFloor,T),P=new R(t.focusBasedNav,this.cameraData.pose,this.floorsViewData,this.viewmodeData,this.sweepData,this.raycasterData,M.mesh.floorMeshes.copyToList([]),T,Object(B.b)()),e.addComponent(this,P),this.bindings.push(this.registerKeys(),this.floorsData.onChanged(this.floorsViewData.updateViewData),e.subscribe(v.a,(function(t){var e=O.sweepData.getSweep(t.toSweep);e&&O.updateCurrentFloor(e.floor)})),e.subscribe(g.a,(function(t){if(t.toMode===w.a.Dollhouse&&t.fromMode===w.a.Panorama){var n=e.market.tryGetData(_.a);!n||n&&n.isTourActive()||e.commandBinder.issueCommand(new q.a(-1,!0,0))}})),e.commandBinder.addBinding(q.a,(function(t){return J(O,void 0,void 0,(function(){return X(this,(function(e){return this.floorNavigation.moveToFloor(t.floor,t.suppressCameraMovement,t.transitionTime,t.focusPoint),[2]}))}))}))),[2]}}))}))},e.prototype.onUpdate=function(){},e.prototype.registerKeys=function(){var t=this;return this.input.registerHandler(u.f,(function(e){return J(t,void 0,void 0,(function(){var t,n,r;return X(this,(function(i){if(!this.cameraData.canTransition())return[2];if(t=e.modifiers.shiftKey,n=(this.floorsViewData.getHighestVisibleFloor()+1)%this.floorsViewData.totalFloors,r=(this.floorsViewData.getHighestVisibleFloor()-1)%this.floorsViewData.totalFloors,e.state===h.a.PRESSED)switch(e.key){case l.a.UPARROW:t&&this.floorNavigation.moveToFloor(n);break;case l.a.DOWNARROW:t&&this.floorNavigation.moveToFloor(r);break;case l.a.R:this.floorNavigation.moveFloorUp();break;case l.a.F:this.floorNavigation.moveFloorDown();break;case l.a.Y:this.floorNavigation.moveToFloor(-1)}return[2]}))}))}))},e}(i.a);e.default=K},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(0),a=n(80),s=n(81),c={sky:{uniforms:{topColor:{type:"v3",value:new o.Jc(.094,.102,.11)},bottomColor:{type:"v3",value:new o.Jc(.2,.216,.235)},radius:{type:"f",value:100}},vertexShader:s+n(863),fragmentShader:a+n(864)}},u=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=function(){return(l=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},h=function(t){function e(e){return void 0===e&&(e={}),t.call(this,l({fragmentShader:c.sky.fragmentShader,vertexShader:c.sky.vertexShader,uniforms:o.Bc.clone(c.sky.uniforms),name:"SkyboxMaterial"},e))||this}return u(e,t),e}(o.cc),f=n(43),p=n(134),d=n(42),y=n(82),m=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},v=y.a.CameraRig,g=function(){function t(t,e,n,r){void 0===r&&(r=f.a.ALL),this.scene=t,this.addToRaycasting=e,this.removeFromRaycasting=n,this.renderLayer=r,this.bindings=[]}return t.prototype.init=function(){this.skySphere=this.setupSkysphere(),this.material=this.skySphere.material},t.prototype.dispose=function(){this.material.uniforms.pano0Map.value.dispose(),this.material.uniforms.pano1Map.value.dispose(),this.material.dispose(),this.skySphere.geometry.dispose()},t.prototype.activate=function(t){this.scene.addChild(v,this.skySphere),this.skySphere.updateMatrixWorld(!0),this.skySphere.visible=!0,this.addToRaycasting(this.skySphere,!1)},t.prototype.deactivate=function(t){var e,n;try{for(var r=m(this.bindings),i=r.next();!i.done;i=r.next()){i.value.cancel()}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}this.bindings=[],this.scene.removeChild(v,this.skySphere),this.removeFromRaycasting(this.skySphere)},t.prototype.updateBackgroundColors=function(t,e){var n=new o.s(t),r=new o.s(e);this.material.uniforms.topColor.value.set(n.r,n.g,n.b),this.material.uniforms.bottomColor.value.set(r.r,r.g,r.b)},t.prototype.render=function(){},t.prototype.setupSkysphere=function(t){var e=new o.nc(900,5,5);e.computeBoundingBox(),t||(t=new h({side:o.f}));var n=new p.a(e,t);return t.uniforms.radius.value=900,n.layers.mask=this.renderLayer.mask,n.name="Skysphere",n.renderOrder=d.a.boundingSkybox,n.updateMatrixWorld(!0),n},t}(),b=n(25),w=n(31),_=n(26),x=n(142),S=n(21),T=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),M=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},E=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},P=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},O=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="skybox-module",e}return T(e,t),e.prototype.init=function(t,e){return M(this,void 0,void 0,(function(){var t,n,r,i,o,a,s,c=this;return E(this,(function(u){switch(u.label){case 0:return[4,Promise.all([e.getModule(b.default),e.market.waitForData(_.a),e.getModule(w.default)])];case 1:return t=P.apply(void 0,[u.sent(),3]),n=t[0],r=t[1],i=t[2],o=e.claimRenderLayer("skybox"),a=n.getScene(),this.skybox=new g(a,i.registerMesh,i.unregisterMesh,o),e.addComponent(this,this.skybox),s=r.tryGetProperty(S.a.BackgroundColor,x.a.default),this.skybox.updateBackgroundColors(x.b[s].bgPrimary,x.b[s].bgSecondary),this.bindings.push(r.onPropertyChanged(S.a.BackgroundColor,(function(t){c.skybox.updateBackgroundColors(x.b[t].bgPrimary,x.b[t].bgSecondary)}))),[2]}}))}))},e}(i.a);e.default=O},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(264),a=n(25),s=n(15),c=n(18),u=n(1),l=n(17),h=n(115),f=n(149),p=n(141),d=n(198),y=n(58),m=n(43),v=n(13),g=n(7),b=n(165),w=n(38),_=n(175),x=n(188),S=n(140),T=n(20),M=n(2),E=new M.a("snapshots"),P=function(){function t(t,e,n,r,i,o,a){this.sweepData=t,this.meshData=e,this.viewmodeData=n,this.cameraData=r,this.floorsViewData=i,this.queue=o,this.uploadEndpoint=a,this.cameraMeshMode=3}return t.prototype.upload=function(t,e){var n=new FormData;return n.append("src",t,e.name+".jpg"),n.append("name",e.name),n.append("metadata",JSON.stringify(e.metadata)),n.append("category",e.category),this.queue.post(this.uploadEndpoint+"?format=json",{body:n,responseType:"json"}).then((function(t){return E.info("Captured successfully!",t),Object(S.b)(t)})).catch((function(t){return E.error(t),null}))},t.prototype.rename=function(t,e){var n={name:e};return this.queue.patch(""+this.uploadEndpoint+t+"?format=json",{body:n,responseType:"json"}).then((function(t){E.info("Renamed successfully!",t)})).catch((function(t){E.error(t)}))},t.prototype.delete=function(t){return this.queue.delete(""+this.uploadEndpoint+t+"?format=json").then((function(t){E.info("deleted successfully!",t)})).catch((function(t){E.error(t)}))},Object.defineProperty(t.prototype,"lastUploadedWasMeshSnapshot",{get:function(){return 1===this.meshData.opacity.value},enumerable:!0,configurable:!0}),t.prototype.formatPoseMetaData=function(t){var e=this.viewmodeData.isPano(),n=Object(T.i)(new Date);if(e){var r=this.sweepData.getSweep(this.sweepData.currentSweep).name;r&&(n=r)}var i=Object(g.i)(this.cameraData.pose.position),o=Object(g.h)(this.cameraData.pose.rotation),a={x:o.x,y:o.y,z:o.z,w:o.w},s=this.viewmodeData.isPano()&&1===this.meshData.opacity.value?this.cameraMeshMode:Object(u.b)(this.viewmodeData.currentMode),c=this.viewmodeData.currentMode===u.a.Floorplan,l={camera_mode:s,camera_position:i,camera_quaternion:a,ortho_zoom:c?this.cameraData.zoom():-1,ss_zoom:this.cameraData.zoom(),scan_id:e?this.sweepData.currentSweep:"",is_ortho:c,floorVisibility:this.floorsViewData.getFloorsVisibility()};return!e&&(-1!==this.floorsViewData.currentFloor||Math.max(this.floorsViewData.currentFloor,0)<this.floorsViewData.totalFloors)&&(l.highest_floor=this.floorsViewData.currentFloor),{name:n,category:t,metadata:l}},t}(),O=n(3),A=n(297),D=n(28),R=n(299),C=n(44),I=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),k=function(t){function e(e){var n=t.call(this,e)||this;return n.name="SnapshotCaptureError",n}return I(e,t),e}(C.a),L=function(t){function e(e){var n=t.call(this,e)||this;return n.name="SnapshotUploadError",n}return I(e,t),e}(C.a),N=n(35),j=n(174),B=n(22),F=n(173),U=n(183),z=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),G=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},H=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},V=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},W=new M.a("snapshot-editor"),q=y.c.uploadIntervalDelay,Y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="snapshots-editor",e}return z(e,t),e.prototype.init=function(t,e){return G(this,void 0,void 0,(function(){var n,r,i,p,y,m,g,x,M,E=this;return H(this,(function(A){switch(A.label){case 0:return this.engine=e,[4,Promise.all([e.getModule(a.default),e.getModule(d.default),e.getModule(o.default)])];case 1:return n=V.apply(void 0,[A.sent(),3]),this.renderer=n[0],this.sweepTilingModule=n[1],this.snapshotsModule=n[2],[4,Promise.all([e.market.waitForData(s.a),e.market.waitForData(l.a),e.market.waitForData(j.a),e.market.waitForData(c.a)])];case 2:return r=V.apply(void 0,[A.sent(),4]),this.sweepData=r[0],this.viewmodeData=r[1],this.meshData=r[2],this.cameraData=r[3],[4,Promise.all([e.commandBinder.issueCommandWhenBound(new h.d),e.commandBinder.issueCommandWhenBound(new h.d)])];case 3:return i=V.apply(void 0,[A.sent(),2]),this.snapshotTarget=i[0],this.snapshotOverlayTarget=i[1],[4,Promise.all([e.market.waitForData(N.b),e.market.waitForData(_.a)])];case 4:return p=V.apply(void 0,[A.sent(),2]),y=p[0],m=p[1],g=new P(this.sweepData,this.meshData,this.viewmodeData,this.cameraData,y,t.queue,t.uploadEndpoint),this.bindings.push(e.commandBinder.addBinding(b.a,(function(t){return G(E,void 0,void 0,(function(){var n,r,i,o,a,s,c,l=this;return H(this,(function(f){switch(f.label){case 0:return n=10,(r=t.onProgress||Object(w.b)(0)).value=n,e.commandBinder.issueCommand(new U.a),[4,this.queryIdealResolution(t.maxSize,t.aspect)];case 1:return i=f.sent(),this.snapshotTarget.setSize(i.width,i.height),this.snapshotOverlayTarget.setSize(i.width,i.height),[4,this.fetchHighestAvailable(!1,t.maxSize,(function(t){return r.value=Math.max(n,t)}))];case 2:return f.sent(),[4,Object(T.d)(2*q)];case 3:return f.sent(),[4,this.takeScreenshot()];case 4:return f.sent(),t.getOverlay?[4,t.getOverlay(i.width,i.height)]:[3,8];case 5:return(o=f.sent())?[4,e.commandBinder.issueCommand(new h.b(this.snapshotOverlayTarget,o))]:[3,8];case 6:return f.sent(),[4,e.commandBinder.issueCommand(new h.a(this.snapshotTarget,this.snapshotOverlayTarget))];case 7:f.sent(),f.label=8;case 8:return a=this.sweepData.getSweep(this.sweepData.currentSweep),this.viewmodeData.currentMode!==u.a.Panorama?[3,10]:[4,this.sweepTilingModule.revertTilingSettings(a.id)];case 9:f.sent(),f.label=10;case 10:return e.commandBinder.issueCommand(new U.b),s=t.category,a&&(a.alignmentType===B.a.UNALIGNED||a.placementType===B.b.MANUAL)&&s===S.a.user&&(s=S.a.unaligned),c=this.uploadAndAddSnapshot(g,this.sweepData,m,s,t.setAsStartLocation).then((function(t){return t&&t.sid})).catch((function(t){throw W.error(t),l.engine.broadcast(new R.b(t)),t})),[2,t.waitForUpload?c:null]}}))}))}))),x=O.b.FORWARD.clone(),M=O.b.FORWARD.clone(),this.bindings.push(e.commandBinder.addBinding(b.c,(function(t){return G(E,void 0,void 0,(function(){var n,r,i,o,a,s,c,u=this;return H(this,(function(l){switch(l.label){case 0:return n=10,(r=t.onProgress||Object(w.b)(0)).value=n,e.commandBinder.issueCommand(new U.a),[4,Object(T.d)(50)];case 1:return l.sent(),i=this.queryIdealEqResolution(),this.snapshotTarget.setSize(i.width,i.height),o=this.sweepData.getSweep(this.sweepData.currentSweep),x.copy(O.b.FORWARD).applyQuaternion(o.rotation).setY(0),M.copy(O.b.FORWARD).applyQuaternion(this.cameraData.pose.rotation).setY(0),a=Object(D.q)(x,M)+Math.PI,[4,this.fetchHighestAvailable(!0,v.d.ULTRAHIGH,(function(t){return r.value=Math.max(n,t)}))];case 2:return l.sent(),[4,this.takeEquirectangular(a)];case 3:return l.sent(),[4,this.sweepTilingModule.revertTilingSettings(o.id)];case 4:return l.sent(),e.commandBinder.issueCommand(new U.b),s=Object(f.d)(this.snapshotTarget.width,this.snapshotTarget.height,a,0),c=this.uploadAndAddSnapshot(g,this.sweepData,m,S.a.panorama,t.setAsStartLocation,s).then((function(t){return t&&t.sid})).catch((function(t){throw W.error(t),u.engine.broadcast(new R.b(t)),t})),[2,t.waitForUpload?c:null]}}))}))}))),this.bindings.push(e.commandBinder.addBinding(b.e,(function(t){return G(E,void 0,void 0,(function(){var e;return H(this,(function(n){return(e=m.get(t.sid)).name=t.name,m.commit(),[2,g.rename(e.sid,e.name)]}))}))}))),this.bindings.push(e.commandBinder.addBinding(b.d,(function(t){return G(E,void 0,void 0,(function(){return H(this,(function(e){return[2,g.delete(t.sid)]}))}))}))),[2]}}))}))},e.prototype.uploadAndAddSnapshot=function(t,e,n,r,i,o){return void 0===i&&(i=!1),G(this,void 0,void 0,(function(){var a,s,c,l,h,p,d;return H(this,(function(y){switch(y.label){case 0:return a=t.formatPoseMetaData(r),c=f.c,[4,Object(f.a)(this.snapshotTarget,o)];case 1:return s=c.apply(void 0,[y.sent()]),[4,t.upload(s,a)];case 2:if(!(l=y.sent()))throw new L("Failed to upload snapshot");return h=l.metadata.camera_mode===u.a.Panorama,p=!Object(F.b)(e,l.metadata.scan_id),l.is360=h&&p,this.snapshotsModule.addSnapshot(l),d=n.get(l.sid),this.engine.broadcast(new R.a(d.sid,d.is360,r,d.height,t.lastUploadedWasMeshSnapshot,l.imageUrl)),i?[4,this.engine.getModule(x.default)]:[3,4];case 3:y.sent().updateStartLocationFromSnapshot(l),y.label=4;case 4:return[2,l]}}))}))},e.prototype.queryIdealResolution=function(t,e){return void 0===t&&(t=v.d.ULTRAHIGH),G(this,void 0,Promise,(function(){var n,r,i,o,a,s,c;return H(this,(function(l){switch(l.label){case 0:return r=(n=3840)*A.c,i=this.renderer.maxTextureSize,n>i&&(W.warn("The active gl context does not support 4k x 2k equirectangular capture\nCapture is limited to a max size of "+i),r=(n=i)*A.c),this.viewmodeData.currentMode!==u.a.Panorama?[3,2]:[4,this.sweepTilingModule.availableResolution(this.sweepData.currentSweep,t)];case 1:o=l.sent(),a=p.b.getPanoSize(o),s=this.cameraData.fovY()*g.c,c=a*s/90,n=Math.min(Math.round(c*e),i),r=Math.round(n/e),l.label=2;case 2:return[2,Promise.resolve({width:n,height:r})]}}))}))},e.prototype.queryIdealEqResolution=function(){var t=4096;if(this.viewmodeData.currentMode!==u.a.Panorama)throw new k("Equirectangular capture is only supported in Panorama mode");var e=this.renderer.maxTextureSize;return t>e&&W.warn("The active gl context does not support 4k x 2k equirectangular capture\nCapture is limited to a max size of "+e),{width:t=Math.min(e,t),height:.5*t}},e.prototype.fetchHighestAvailable=function(t,n,r){var i=this;if(void 0===n&&(n=v.d.ULTRAHIGH),this.viewmodeData.currentMode===u.a.Panorama){var o=this.sweepData.currentSweep,a=t?d.DownloadQueueStyle.FullPanorama:d.DownloadQueueStyle.CurrentView;return this.sweepTilingModule.requestResolution(o,n,a,!0).then((function(t){var n=i.sweepTilingModule.waitForQueue(a,t);return r&&n.progress((function(t){return r(t*e.captureProgressFudgeFactor)})),n}))}return r&&r(e.captureProgressFudgeFactor),Promise.resolve()},e.prototype.takeScreenshot=function(){var t=m.a.ALL;t.removeLayers(this.engine.getRenderLayer("grid-underlay")),t.removeLayers(this.engine.getRenderLayer("cursor-mesh")),t.removeLayers(this.engine.getRenderLayer("current-pano-marker"));var e=this.renderer.getScene().scene,n=this.renderer.getScene().camera,r=n.layers.mask;return n.layers.mask=t.mask,this.engine.commandBinder.issueCommand(new h.e(this.snapshotTarget,e,n)).then((function(){n.layers.mask=r}))},e.prototype.takeEquirectangular=function(t){var e=this.sweepData.currentSweep,n=this.sweepTilingModule.getRenderer(),r=n.useTexture(e),i=this.engine.commandBinder.issueCommand(new h.c(this.snapshotTarget,r,t));return n.freeTexture(e),i},e.captureProgressFudgeFactor=90,e}(i.a);e.default=Y},function(t,e,n){"use strict";n.r(e);var r,i,o,a=n(4),s=n(0),c=n(31),u=n(3),l=n(61),h=n(7),f=80*h.b,p=0*h.b,d=Math.PI/1e3,y=n(269),m=n(24),v=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),g=l.a.epsilon,b=function(t){function e(e,n,r,i){void 0===i&&(i=!1);var o=t.call(this)||this;return o.cameraPoseProxy=e,o.tempOrientation=new s.Pb,o.tempAxis=new s.Jc,o.tempVector=new s.Jc,o.nextPosition=new s.Jc,o.nextOrientation=new s.Pb,o.currentOrientation=new s.Pb,o.currentPosition=new s.Jc,o.positionDelta=new s.Jc,o.angularAccel=new s.Ic,o.angularVelocity=new s.Ic,o.linearAccel=new s.Ic,o.linearVelocity=new s.Ic,o.zoomAccel=0,o.zoomVelocity=0,o.cameraOrientation=new s.A,o.aimTarget=new s.Jc,o.poseController=null,o.checkBounds=i,o.bounds=n.clone(),o.boundsCenter=r.clone(),o.setupBounds(),o._maxZoomDistance=Math.max(30,1.5*o.worldBounds.getSize(new s.Jc).length()),o.transition={active:!1,startTime:0,elapsed:0,duration:0,angularVelocity:new s.Ic,linearVelocity:new s.Ic,zoomVelocity:0,easeOut:!1},e.newSession(o),o}return v(e,t),e.prototype.onAccessGranted=function(t){this.poseController=t},e.prototype.onAccessRevoked=function(t){this.stop()},Object.defineProperty(e.prototype,"maxZoomDistance",{get:function(){return this._maxZoomDistance},enumerable:!0,configurable:!0}),e.prototype.setOrbitalAcceleration=function(t,e){void 0===e&&(e=!1),this.transition.active||(e&&this.haltVelocity(t,this.angularVelocity),this.angularAccel.x=void 0!==t.x?t.x:this.angularAccel.x,this.angularAccel.y=void 0!==t.y?t.y:this.angularAccel.y)},e.prototype.setPanAcceleration=function(t,e){void 0===e&&(e=!1),this.transition.active||(e&&this.haltVelocity(t,this.linearVelocity),this.linearAccel.x=void 0!==t.x?t.x:this.linearAccel.x,this.linearAccel.y=void 0!==t.y?t.y:this.linearAccel.y)},e.prototype.setZoomAcceleration=function(t){this.transition.active||(this.zoomAccel=t)},e.prototype.haltVelocity=function(t,e){t.x&&e.x&&Math.sign(t.x)!==Math.sign(e.x)&&(e.x=0),t.y&&e.y&&Math.sign(t.y)!==Math.sign(e.y)&&(e.y=0)},e.prototype.startTransition=function(t,e,n,r,i){if(null===this.poseController)return m.a.reject("Unable to start transition, since controller is unavailable.");var o=new m.a;return this.transition.active=!0,this.transition.duration=t,this.transition.elapsed=0,this.transition.startTime=Date.now(),this.transition.deferred=o,this.transition.angularVelocity.copy(e),this.transition.linearVelocity.copy(n),this.transition.zoomVelocity=r,this.transition.easeOut=i,this.angularAccel.set(0,0),this.linearAccel.set(0,0),this.zoomAccel=0,this.angularVelocity.copy(e),this.linearVelocity.copy(n),this.zoomVelocity=r,this.poseController.beginExternalTransition(),o.promise()},e.prototype.stopTransition=function(){this.transition.active&&(this.poseController&&this.poseController.endExternalTransition(),this.transition.active=!1),this.transition.deferred&&(this.transition.deferred.resolve(),this.transition.deferred=void 0)},e.prototype.updateTransition=function(t,e,n,r){var i=1,o=t/(1e3/60);(this.transition.elapsed+=t,this.transition.elapsed>=this.transition.duration)&&(i=(this.transition.duration-(this.transition.elapsed-t))/t,o=1);e&&(this.angularVelocity.copy(this.transition.angularVelocity).multiplyScalar(i*o),this.orbit(this.angularVelocity)),n&&(this.linearVelocity.copy(this.transition.linearVelocity).multiplyScalar(i*o),this.pan(this.linearVelocity)),r&&(this.zoomVelocity=this.transition.zoomVelocity*i*o,this.zoom(this.zoomVelocity)),this.transition.elapsed>=this.transition.duration&&(this.stop(this.transition.easeOut),this.transition.active=!1)},e.prototype.updateDefault=function(t,e,n,r){var i=t/(1e3/60);e&&(this.angularVelocity.addScaledVector(this.angularAccel,i),this.orbit(this.angularVelocity),this.angularVelocity.multiplyScalar(Math.pow(.92,i))),n&&(this.linearVelocity.addScaledVector(this.linearAccel,i),this.pan(this.linearVelocity),this.linearVelocity.multiplyScalar(Math.pow(.92,i))),r&&(this.zoomVelocity+=this.zoomAccel*i,this.zoom(this.zoomVelocity),this.zoomVelocity*=Math.pow(.84,i))},e.prototype.startRotateTransition=function(t,e,n){return e.x*=-1,this.startTransition(t,e.clone().multiplyScalar(1e3/60),new s.Ic,0,n).nativePromise()},e.prototype.startTranslateTransition=function(t,e,n){return void 0===n&&(n=!0),this.startTransition(t,new s.Ic,e.clone().multiplyScalar(1e3/60),0,n).nativePromise()},e.prototype.startZoomTransition=function(t,e,n){return this.startTransition(t,new s.Ic(0,0),new s.Ic(0,0),e,n).nativePromise()},e.prototype.update=function(t){var e=this.angularAccel.length()>g||this.angularVelocity.length()>g,n=this.linearAccel.length()>g||this.linearVelocity.length()>g,r=Math.abs(this.zoomAccel)>g||Math.abs(this.zoomVelocity)>g;this.transition.active?this.updateTransition(t,e,n,r):this.updateDefault(t,e,n,r)},e.prototype.stopMomentum=function(){this.transition.active||(this.angularVelocity.set(0,0),this.linearVelocity.set(0,0),this.zoomVelocity=0)},e.prototype.stopAcceleration=function(){this.transition.active||(this.setOrbitalAcceleration({x:0,y:0}),this.setPanAcceleration({x:0,y:0}),this.setZoomAcceleration(0))},e.prototype.stop=function(t){void 0===t&&(t=!1),this.stopTransition(),this.stopAcceleration(),t||this.stopMomentum()},e.prototype.pan=function(t){if(this.poseController){var e=this.cameraPoseProxy.pose;if(this.positionDelta.x=t.x,this.positionDelta.z=t.y,this.nextPosition.copy(e.position).add(this.positionDelta),this.checkBounds&&!this.insideBounds(this.nextPosition,e.rotation)){this.tempVector.copy(u.b.FORWARD).applyQuaternion(e.rotation),this.tempVector.multiplyScalar(e.focalDistance).add(this.nextPosition);var n=this.tempVector.sub(this.boundsCenter).length();if(this.tempVector.copy(u.b.FORWARD).applyQuaternion(e.rotation),this.tempVector.multiplyScalar(e.focalDistance).add(e.position),n>this.tempVector.sub(this.boundsCenter).length())return}this.currentPosition.copy(this.nextPosition),this.poseController.updateCameraPosition(this.currentPosition)}},e.prototype.orbit=function(t){if(this.poseController){var e=this.cameraPoseProxy.pose;this.cameraOrientation.setFromQuaternion(e.rotation,"YXZ");var n=-this.cameraOrientation.x,r=Object(h.e)(t.y,p-n,f-n);this.aimTarget.copy(u.b.FORWARD).applyQuaternion(e.rotation),this.aimTarget.setLength(e.focalDistance),this.aimTarget.addVectors(e.position,this.aimTarget),this.tempAxis.copy(u.b.RIGHT),this.tempOrientation.setFromAxisAngle(this.tempAxis.applyQuaternion(e.rotation),-r),this.nextPosition.copy(e.position).sub(this.aimTarget).applyQuaternion(this.tempOrientation),this.nextOrientation.copy(e.rotation).premultiply(this.tempOrientation),this.tempOrientation.setFromAxisAngle(u.b.UP,t.x),this.nextPosition.applyQuaternion(this.tempOrientation),this.nextOrientation.premultiply(this.tempOrientation),this.nextPosition=this.nextPosition.add(this.aimTarget),this.nextOrientation.normalize(),this.checkBounds&&!this.insideBounds(e.position,this.nextOrientation)||(this.currentPosition.copy(this.nextPosition),this.currentOrientation.copy(this.nextOrientation),e.rotation.equals(this.currentOrientation)||(this.poseController.updateCameraPosition(this.currentPosition),this.poseController.updateCameraRotation(this.currentOrientation)))}},e.prototype.zoom=function(t){if(this.poseController){var e=this.cameraPoseProxy.pose,n=this.maxZoomDistance-2,r=e.focalDistance,i=Object(h.e)(t*n+r,2,this.maxZoomDistance)-r;this.nextPosition.copy(e.position).add(u.b.FORWARD.clone().applyQuaternion(e.rotation).setLength(-i)),this.checkBounds&&!this.insideBounds(this.nextPosition,e.rotation)||(this.currentPosition.copy(this.nextPosition),this.poseController.updateCameraPosition(this.currentPosition),this.poseController.updateCameraFocus(e.focalDistance+i))}},e.prototype.setupBounds=function(){this.bounds.min.x=this.adjustBound(this.bounds.min.x,4),this.bounds.min.y=this.adjustBound(this.bounds.min.y,4),this.bounds.min.z=this.adjustBound(this.bounds.min.z,4),this.bounds.max.x=this.adjustBound(this.bounds.max.x,-4),this.bounds.max.y=this.adjustBound(this.bounds.max.y,-4),this.bounds.max.z=this.adjustBound(this.bounds.max.z,-4),this.worldBounds=(new s.h).setFromCenterAndSize(this.boundsCenter,new s.Jc(this.bounds.max.x-this.bounds.min.x,this.bounds.max.y-this.bounds.min.y,this.bounds.max.z-this.bounds.min.z))},e.prototype.insideBounds=function(t,e){return!!Object(h.k)(t,e,this.cameraPoseProxy.pose.projection,this.worldBounds)},e.prototype.adjustBound=function(t,e){return Math.sign(t+e)===Math.sign(t)?t+e:0},e}(y.a),w=n(17),_=n(27),x=n(16),S=n(77),T=n(1),M=n(112),E=n(8),P=n(154),O=n(50),A=n(6),D=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),R=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},C=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};(o=i||(i={}))[o.NONE=_.b.NONE]="NONE",o[o.ROTATE=_.b.PRIMARY]="ROTATE",o[o.PAN=_.b.SECONDARY]="PAN",o[o.ZOOM=_.b.MIDDLE]="ZOOM";var I=function(t){function e(){var e,n,r=null!==t&&t.apply(this,arguments)||this;return r.name="dollhouse-controls",r.controlState=i.NONE,r.movementKeys=new s.Ic,r.resetControlState=function(){r.controlState=i.NONE},r.convertDeltaToLocal=(e=new s.Jc,n=new s.Jc,function(t){var i=t.x||0,o=t.y||0,a=2*i*r.cameraPoseProxy.pose.focalDistance,s=2*o*r.cameraPoseProxy.pose.focalDistance/r.cameraPoseProxy.pose.aspect();return e.copy(u.b.RIGHT).applyQuaternion(r.cameraPoseProxy.pose.rotation).setY(0).setLength(a),n.copy(u.b.FORWARD).applyQuaternion(r.cameraPoseProxy.pose.rotation),e.add(n.setY(0).setLength(s)),e}),r}return D(e,t),e.prototype.init=function(t,e){return R(this,void 0,void 0,(function(){var n,r,o,a=this;return C(this,(function(u){switch(u.label){case 0:return this.cameraPoseProxy=t.cameraPoseProxy,[4,e.getModule(O.default)];case 1:return n=u.sent(),this.modelMesh=n.mesh,r=this,[4,e.market.waitForData(w.a)];case 2:return r.viewmodeData=u.sent(),o=this,[4,e.getModule(P.default)];case 3:return o.commonControlsModule=u.sent(),this.controls=new b(this.cameraPoseProxy,this.modelMesh.boundingBox,this.modelMesh.center,!0),this.commonControlsModule.addControls(T.a.Dollhouse,this.controls),this.modelSize=Math.max(this.modelMesh.boundingBox.getSize(new s.Jc).length(),1),this.bindings.push(e.subscribe(M.a,(function(t){a.controls.stop(),a.resetControlState()}))),e.getModule(c.default).then((function(t){a.bindings.push(t.registerHandler(E.q,(function(t){a.validateViewmode()&&a.onScrollWheel(t)}))),a.bindings.push(t.registerHandler(E.b,(function(t){a.validateViewmode()&&a.onDragBegin(t.buttons)}))),a.bindings.push(t.registerHandler(E.c,(function(t){a.validateViewmode()&&(t.timeSinceLastMove<100&&(a.onDrag(t.delta),a.controls.update(1e3/60),a.controls.stopAcceleration()),a.onDragEnd(t.delta,t.buttons))}))),a.bindings.push(t.registerHandler(E.d,(function(t){a.validateViewmode()&&(a.onDrag(t.delta),a.controls.update(1e3/60),a.controls.stop())}))),a.bindings.push(t.registerHandler(E.l,(function(t){a.validateViewmode()&&(a.controls.setZoomAcceleration(-t.pinchDelta),a.controls.update(1e3/60),a.controls.stopAcceleration())}))),a.bindings.push(t.registerHandler(E.k,a.resetControlState)),a.bindings.push(t.registerHandler(E.j,(function(t){a.validateViewmode()&&2===t.pointerCount&&(a.controlState=i.PAN,a.onDrag(t.delta),a.controls.update(1e3/60),a.controls.stop())}))),a.bindings.push(t.registerHandler(E.i,a.resetControlState)),a.bindings.push(t.registerHandler(E.f,(function(t){a.validateViewmode()&&t.state!==S.a.PRESSED&&a.onKey(t.key,t.state)})))})),[2]}}))}))},e.prototype.onUpdate=function(t){this.validateViewmode()&&this.controls.update(t)},e.prototype.onScrollWheel=function(t){if(0!==t.delta.y){var e=1/this.cameraPoseProxy.pose.focalDistance*2,n=this.modelSize;this.controls.setZoomAcceleration(.1*t.delta.y/(e*n*500)),this.controls.update(1e3/60),this.controls.setZoomAcceleration(0)}},e.prototype.onDragBegin=function(t){if(this.controlState===i.NONE){var e=t;this.controlState=e}this.controls.stop()},e.prototype.onDrag=function(t){switch(this.controlState){case i.ROTATE:this.controls.setOrbitalAcceleration({x:-Math.PI*t.x,y:-Math.PI*t.y});break;case i.PAN:var e=this.convertDeltaToLocal(t);this.controls.setPanAcceleration({x:-e.x,y:-e.z});break;case i.ZOOM:0!==t.y&&this.controls.setZoomAcceleration(-t.y)}},e.prototype.onDragEnd=function(t,e){e&this.controlState||(this.controlState=i.NONE,Object(A.n)()&&this.controls.stop())},e.prototype.onKey=function(t,e){var n=e===S.a.DOWN,r=!1;switch(t){case x.a.LEFTARROW:case x.a.J:this.controls.setOrbitalAcceleration({x:n?d:0},!0);break;case x.a.RIGHTARROW:case x.a.L:this.controls.setOrbitalAcceleration({x:n?-d:0},!0);break;case x.a.UPARROW:case x.a.I:this.controls.setOrbitalAcceleration({y:n?-d:0},!0);break;case x.a.DOWNARROW:case x.a.K:this.controls.setOrbitalAcceleration({y:n?d:0},!0);break;case x.a.W:this.movementKeys.y=n?1:0,r=!0;break;case x.a.S:this.movementKeys.y=n?-1:0,r=!0;break;case x.a.D:this.movementKeys.x=n?1:0,r=!0;break;case x.a.A:this.movementKeys.x=n?-1:0,r=!0}if(r){var i=this.convertDeltaToLocal(this.movementKeys).setLength(.02);this.controls.setPanAcceleration({x:i.x,y:i.z})}},e.prototype.validateViewmode=function(){return this.viewmodeData.currentMode===T.a.Dollhouse},e}(a.a);e.default=I},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(15),a=n(265),s=n(266),c=n(20),u=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};!function(t){t[t.None=0]="None",t[t.Queued=1]="Queued",t[t.Rendering=2]="Rendering",t[t.Rendered=3]="Rendered"}(r||(r={}));var l,h=function(){function t(t){this.statusMap={},this.active=[],this.queued=[],this.panoRenderer=t,this.disablePreRendering()}return t.prototype.init=function(){},t.prototype.dispose=function(){},t.prototype.activate=function(t){},t.prototype.deactivate=function(t){this.disablePreRendering()},t.prototype.enablePreRendering=function(){this.enabled=!0},t.prototype.disablePreRendering=function(){this.enabled=!1},t.prototype.render=function(){},t.prototype.beforeRender=function(){this.enabled&&this.processQueued()},t.prototype.tryPreRender=function(t){return this.getPreRenderState(t)===r.None&&(this.queued.push(t),this.statusMap[t]=r.Queued,!0)},t.prototype.getPreRenderState=function(t){var e=this.statusMap[t];return void 0!==e?e:r.None},t.prototype.processQueued=function(){var t,e,n=this,i=0;try{for(var o=u(Object.keys(this.statusMap)),a=o.next();!a.done;a=o.next()){var s=a.value;this.statusMap[s]===r.Rendering&&i++}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}if(0===i&&this.queued.length>0){var c=this.queued.shift();if(c)this.active.push(c),this.statusMap[c]=r.Rendering,this.panoRenderer.activateSweep(c).then((function(){n.onRendered(c)}))}},t.prototype.cleanup=function(t){var e,n,i,o;void 0===t&&(t=[]);var a=Object(c.b)(t),s=[];try{for(var l=u(this.queued),h=l.next();!h.done;h=l.next()){a[y=h.value]?s.push(y):this.statusMap[y]=r.None}}catch(t){e={error:t}}finally{try{h&&!h.done&&(n=l.return)&&n.call(l)}finally{if(e)throw e.error}}this.queued.length=0,this.queued.push.apply(this.queued,s);var f=[];try{for(var p=u(this.active),d=p.next();!d.done;d=p.next()){var y;a[y=d.value]?f.push(y):this.statusMap[y]=r.None}}catch(t){i={error:t}}finally{try{d&&!d.done&&(o=p.return)&&o.call(p)}finally{if(i)throw i.error}}this.active.length=0,this.active.push.apply(this.active,f)},t.prototype.onRendered=function(t){this.statusMap[t]=r.Rendered},t}(),f=n(6),p=Object.freeze({prerender:{preRenderTourPanos:f.A("pre",1)}}),d=n(176),y=(l=function(t,e){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),m=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},v=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="prerenderer-module",e.lastPrerendered=null,e}return y(e,t),e.prototype.init=function(t,e){return m(this,void 0,void 0,(function(){var n,r,i=this;return v(this,(function(c){switch(c.label){case 0:return p.prerender.preRenderTourPanos||t.preRenderTourPanos?(n=this,[4,e.market.waitForData(o.a)]):[3,3];case 1:return n.sweepData=c.sent(),r=this,[4,e.getModuleByParent(d.a)];case 2:r.panoRenderer=c.sent().getRenderer(),this.preRenderer=new h(this.panoRenderer),e.addComponent(this,this.preRenderer),this.bindings.push(e.subscribe(a.a,(function(t){i.preRenderer.enablePreRendering(),i.lastPrerendered=null,t.sweepIds&&t.sweepIds.length>=3&&(i.lastPrerendered=t.sweepIds[2],i.preRenderer.tryPreRender(i.lastPrerendered)),i.cleanup(i.sweepData),i.currentRestrictedSweeps=t.sweepIds}))),this.bindings.push(e.subscribe(s.a,(function(t){i.preRenderer.disablePreRendering(),i.cleanup(i.sweepData,!0),i.currentRestrictedSweeps=null}))),c.label=3;case 3:return[2]}}))}))},e.prototype.getCurrentSweeps=function(){return this.currentRestrictedSweeps||[]},e.prototype.cleanup=function(t,e){void 0===e&&(e=!1);var n=[];t.transition.active?(t.transition.from&&n.push(t.transition.from),t.transition.to&&n.push(t.transition.to)):t.currentSweep&&n.push(t.currentSweep),this.lastPrerendered&&n.push(this.lastPrerendered),e&&this.panoRenderer.freeAllTextures(n),this.preRenderer.cleanup(n)},e}(i.a);e.default=g},function(t,e,n){"use strict";n.r(e);var r,i,o=n(2),a=n(4),s=n(243),c=n(56),u=n(111),l=n(25),h=n(6),f=n(64),p=function(){function t(){this._dateNow=Date.now,this._performanceNow=performance.now,this.nowOverride=0}return t.prototype.slowTime=function(t){var e=this;this.fps=t,this.nowOverride=Date.now(),Date.now=function(){return e.nowOverride},performance.now=function(){return e.nowOverride}},t.prototype.tick=function(){this.nowOverride+=1e3/this.fps},t.prototype.resetTime=function(){Date.now=this._dateNow,performance.now=this._performanceNow},t}(),d=n(463),y=n(63),m=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),v=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},g=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},b=new o.a("video-recorder");!function(t){t[t.STOPPED=0]="STOPPED",t[t.RECORDING=1]="RECORDING"}(i||(i={}));var w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="video-recorder-module",e.state=i.STOPPED,e.frostMage=new p,e}return m(e,t),e.prototype.init=function(t,e){return v(this,void 0,void 0,(function(){var t,n,r=this;return g(this,(function(o){switch(o.label){case 0:return t=this,[4,e.getModule(c.default)];case 1:return t.settingsModule=o.sent(),n=this,[4,e.getModule(l.default)];case 2:return n.webglRenderer=o.sent(),this.engine=e,this.settingsModule.registerButton("Tour Recorder (Chrome Only)","Download 1080p @ 60",(function(){r.state===i.STOPPED&&r.record(1920,1080,60)})),this.settingsModule.registerButton("Tour Recorder (Chrome Only)","Download 720p @ 30",(function(){r.state===i.STOPPED&&r.record(1280,720,30)})),this.settingsModule.registerButton("Tour Recorder (Chrome Only)","Download instagram",(function(){r.state===i.STOPPED&&r.record(1080,1080,30)})),this.settingsModule.registerButton("Tour Recorder (Chrome Only)","Download instagram story",(function(){r.state===i.STOPPED&&r.record(1080,1920,30)})),this.settingsModule.registerButton("Tour Recorder (Chrome Only)","Stop & download current",(function(){r.state===i.RECORDING&&r.stop()})),[2]}}))}))},e.prototype.record=function(t,e,r){return v(this,void 0,void 0,(function(){var o,a,c,l,h=this;return g(this,(function(p){switch(p.label){case 0:return this.state!==i.STOPPED?(b.warn("Can't start recording... we're already recording!"),[2]):(b.info("Starting recording of tour. Now is a good time to get a coffee :)"),this.state=i.RECORDING,[4,n.e(3).then(n.bind(null,1526))]);case 1:return o=p.sent(),this.encoder=new o.WebMWriter({quality:.95,frameRate:r}),this.frostMage.slowTime(r),[4,this.engine.commandBinder.issueCommand(new f.a({resizeDimensions:[{property:f.b.width,setDimension:t,duration:0},{property:f.b.height,setDimension:e,duration:0}]}))];case 2:return p.sent(),[4,this.engine.commandBinder.issueCommand(new s.b)];case 3:return p.sent(),a=this.engine.subscribe(u.f,(function(){a.cancel(),h.state===i.RECORDING&&h.stop()})),l=(c=this).webglRenderer.cwfRenderer.renderer.getContext().canvas,this.engine.startGenerator((function(){return g(this,(function(t){switch(t.label){case 0:return c.state!==i.RECORDING?[3,3]:(c.encoder.addFrame(l),[4,new y.b]);case 1:return t.sent(),c.frostMage.tick(),[4,new y.b];case 2:return t.sent(),[3,0];case 3:return[2]}}))})),[2]}}))}))},e.prototype.stop=function(){return v(this,void 0,void 0,(function(){var t;return g(this,(function(e){switch(e.label){case 0:return this.state!==i.RECORDING?(b.warn("Can't stop recording, we weren't recording at all"),[2]):(this.frostMage.resetTime(),this.state=i.STOPPED,[4,this.engine.commandBinder.issueCommand(new f.a(Object(d.b)(0)))]);case 1:return e.sent(),b.info("Encoding tour to video..."),[4,this.encoder.complete()];case 2:return t=e.sent(),b.info("Tour encoded! Prompting user to download."),Object(h.v)(t,"tour.webm"),[2]}}))}))},e}(a.a);e.default=w},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=n(1),a=n(0),s=n(42),c=function(){function t(e,n,r,i,o){this.scene=e,this.viewmodeData=r,this.sweepData=i,this.panoMarkerEnabled=!0,this.material=new a.mb({transparent:!0,map:n,depthWrite:!1}),this.mesh=new a.lb(t.planeGeometry,this.material),this.mesh.name="CurrentPanoMarker",this.mesh.renderOrder=s.a.panoMarker,this.mesh.layers.mask=o.mask,this.mesh.lookAt(this.mesh.position.clone().setY(1))}return t.prototype.init=function(){},t.prototype.dispose=function(){this.material.map&&this.material.map.dispose(),this.mesh.geometry.dispose()},t.prototype.render=function(){var t=this.sweepData.currentAlignedSweepObject;!this.panoMarkerEnabled||this.viewmodeData.currentMode===o.a.Panorama||this.viewmodeData.currentMode===o.a.Transition||!t?this.resetMesh():(this.move(t.floorPosition),this.material.opacity=1)},t.prototype.activate=function(){this.scene.add(this.mesh)},t.prototype.deactivate=function(){this.scene.remove(this.mesh)},t.prototype.togglePanoMarker=function(t){this.panoMarkerEnabled=t},t.prototype.move=function(e){this.mesh.position.copy(e).setY(e.y+t.floorOffset)},t.prototype.resetMesh=function(){this.material.opacity=0},t.floorOffset=.01,t.planeGeometry=new a.Jb(.5,.5),t}(),u=n(48),l=n(25),h=n(17),f=n(15),p=n(611),d=n.n(p),y=n(568),m=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),v=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},g=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="current-pano-marker",e}return m(e,t),e.prototype.init=function(t,e){return v(this,void 0,void 0,(function(){var t,n,r,i,o,a,s,p=this;return g(this,(function(m){switch(m.label){case 0:return t=Object(u.a)(d.a),[4,e.getModule(l.default)];case 1:return n=m.sent(),r=n.getScene(),[4,e.market.waitForData(f.a)];case 2:return i=m.sent(),[4,e.market.waitForData(h.a)];case 3:return o=m.sent(),a=e.claimRenderLayer(this.name),s=new c(r,t,o,i,a),e.addComponent(this,s),this.bindings.push(e.commandBinder.addBinding(y.a,(function(t){return v(p,void 0,void 0,(function(){return g(this,(function(e){return s.togglePanoMarker(t.enabled),[2]}))}))}))),[2]}}))}))},e}(i.a);e.default=b},function(t,e,n){"use strict";n.r(e);var r,i=n(4),o=function(){},a=n(50),s=n(258),c=n(15),u=n(17),l=n(356),h=n(161),f=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),p=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},d=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},y=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},m=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="room-data",e.visitedRooms={},e}return f(e,t),e.prototype.init=function(t,e){return p(this,void 0,void 0,(function(){var t,n,r,i,f,p,v,g,b,w,_,x,S,T,M,E,P,O,A,D,R,C,I,k,L=this;return d(this,(function(d){switch(d.label){case 0:return b=(g=Promise).all,[4,e.getModule(a.default)];case 1:return w=[d.sent()],[4,e.market.waitForData(u.a)];case 2:return[4,b.apply(g,[w.concat([d.sent()])])];case 3:f=y.apply(void 0,[d.sent(),2]),p=f[0],v=f[1],_={};try{for(x=m(p.mesh.floorMeshes),S=x.next();!S.done;S=x.next()){T=S.value;try{for(M=m(T.roomMeshes),E=M.next();!E.done;E=M.next())P=E.value,O=_[P.roomIndex],A=Object(h.a)(P.geometry),O||((O=new o).id="room-"+P.roomIndex,O.index=P.roomIndex,O.floorId=P.floorIndex,O.min={x:A.min.x,y:A.min.y,z:A.min.z},O.max={x:A.max.x,y:A.max.y,z:A.max.z},O.mesh=P,_[P.roomIndex.toString()]=O,this.visitedRooms[O.id]={visitCount:0})}catch(t){r={error:t}}finally{try{E&&!E.done&&(i=M.return)&&i.call(M)}finally{if(r)throw r.error}}}}catch(e){t={error:e}}finally{try{S&&!S.done&&(n=x.return)&&n.call(x)}finally{if(t)throw t.error}}return this.data=new s.a(_),e.market.register(this,s.a,this.data),D=Object.keys(this.visitedRooms).length,R=function(t){var n=v.closestMode;L.visitedRooms[t.id].visitCount++;var r=L.visitedRooms[t.id].visitCount;e.broadcast(new l.a(t.id,t.index,n,r,D,""))},[4,e.market.waitForData(c.a)];case 4:return C=d.sent(),I=C.makeSweepChangeSubscription((function(t){if(t){var e=C.getSweep(t);L.data.selected.value=e.room,L.data.commit()}})),k=this.data.selected.onChanged((function(t){if(null!==t){var e=L.data.get(t);e&&R(e)}})),this.bindings.push(I,k),[2]}}))}))},e}(i.a);e.default=v},function(t,e,n){"use strict";n.r(e);var r,i=n(6),o=n(172),a=Object(i.A)("geodist",Object(o.a)(Object(i.A)("geodistft",20))),s=n(4),c=n(315),u=n(22),l=n(1),h=n(10),f=n(18),p=n(15),d=n(97),y=n(17),m=n(200),v=n(90),g=n(26),b=n(215),w=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),_=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},x=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},S=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="sweep-portal-navigation",e.onChange=function(){e.portalRenderer.filter((function(t){if(!e.settingsData.tryGetProperty(b.a,!0))return m.c.HIDE;if(e.viewmodeData.closestMode!==l.a.Panorama)return m.c.HIDE;var n=e.sweepData.getSweep(e.sweepData.currentSweep||"");if(n)if(n.alignmentType===u.a.ALIGNED){if(t.fromInterior&&t.toExterior&&t.position.distanceTo(n.position)<a)return m.c.SHOW}else if(n.placementType===u.b.MANUAL&&t.fromSweep.id===n.id)return m.c.ONTOP;return m.c.HIDE}))},e}return w(e,t),e.prototype.init=function(t,e){return _(this,void 0,void 0,(function(){var t,n,r=this;return x(this,(function(i){switch(i.label){case 0:return[4,Promise.all([e.getModule(c.default),e.market.waitForData(f.a),e.getModule(d.default),e.market.waitForData(y.a),e.market.waitForData(p.a),e.market.waitForData(g.a)])];case 1:return t=S.apply(void 0,[i.sent(),6]),this.portalRenderer=t[0],this.cameraData=t[1],this.viewmodeModule=t[2],this.viewmodeData=t[3],this.sweepData=t[4],this.settingsData=t[5],n=function(t,n){r.viewmodeData.currentMode&&r.cameraData.canTransition()&&(r.viewmodeData.currentMode!==l.a.Panorama?r.viewmodeModule.switchToMode(l.a.Panorama,h.a.FadeToBlack,{sweepID:t,rotation:n}):e.commandBinder.issueCommand(new v.a({sweep:t,rotation:n,transition:h.a.FadeToBlack})))},this.settingsData.onPropertyChanged(b.a,this.onChange),this.bindings.push(e.subscribe(m.a,(function(t){n(t.toSweep.id)})),this.viewmodeData.onChanged(this.onChange),this.sweepData.onChanged(this.onChange)),this.onChange(),[2]}}))}))},e}(s.a);e.default=T},function(t,e,n){"use strict";n.r(e);var r,i=n(0),o=n(4),a=n(3),s=n(1),c=n(10),u=n(18),l=n(107),h=n(34),f=n(121),p=n(91),d=n(15),y=n(40),m=n(119),v=n(32),g=n(97),b=n(90),w=n(2),_=n(28),x=n(7),S=n(65),T={anyDistance:!0,visibleDistance:8,cameraClearance:.1},M={tiltTolerance:25},E=n(302),P=n(113),O=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),A=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},D=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},R=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},C=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},I=new w.a("mattertag-navigation"),k=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="navigation",e.navigateToTag=function(t){return A(e,void 0,Promise,(function(){var e,n;return D(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,9]),[4,this.tryNavigateToTag(t)];case 1:return r.sent(),[3,9];case 2:return e=r.sent(),I.debug(e),t.transition!==c.a.Interpolate?[2,this.goToNearestSweep(t)]:[4,this.commandBinder.issueCommand(new v.a(v.b.DOLLHOUSE,c.a.Interpolate))];case 3:r.sent(),r.label=4;case 4:return r.trys.push([4,6,,8]),[4,this.tryNavigateToTag(t)];case 5:return r.sent(),[3,8];case 6:return n=r.sent(),I.debug(n),[4,this.goToNearestSweep(t)];case 7:return r.sent(),[3,8];case 8:return[3,9];case 9:return[2]}}))}))},e.tryNavigateToTag=function(t){var n=t.tagId,r=t.transition,o=t.onSweepChosen,a=t.tagDirection;return A(e,void 0,void 0,(function(){var t,e,u,l,h,f,p,d,v,g,w,_,x,T,M,E,O,A,C,I,k,L,N,j,B;return D(this,(function(D){switch(D.label){case 0:if(!this.cameraData.canTransition()||!this.sweepData.canTransition())return[2];u=[],l=[],h=this.tagData.getTag(n),f=h.anchorPosition.clone().add(h.stemVector),u.push(y.b()),u.push(y.c()),this.viewmodeModule.currentMode===s.a.Panorama&&(.5,p=this.sweepData.currentSweep,d=this.sweepData.getSweep(p),v=d.position.clone().sub(f).normalize(),u.push(y.a(f,v,.5)),u.push(y.d(d)),l.push(m.b(f,v))),u.push(this.withinLatitudeFilter(f)),u.push(this.notTooCloseFilter(f)),u.push(this.notTooFarFilter(f)),-2,l.push(m.d(f,-2)),g=this.sweepData.sortByScore(u,l),w=new i.Jc,_=null,x=!1;try{for(T=R(g),M=T.next();!M.done;M=T.next())if(E=M.value,O=E.sweep,w.copy(f).sub(O.position).normalize(),A=O.position.distanceTo(f),!(C=this.raycaster.picking.pick(O.position,w,P.c))||C&&C.distance>A){x=!0,I=this.getSweepToTagRotation(O.position,f,a),k=this.cameraData.pose.projection.asThreeMatrix4(),L=this.cameraData,N=L.width,j=L.height,B=Object(S.c)(f,O.position,I,N,j,k),o&&o(B),_=this.viewmodeModule.currentMode!==s.a.Panorama?this.viewmodeModule.switchToMode(s.a.Panorama,r,{rotation:I,sweepID:O.id}):this.commandBinder.issueCommand(new b.a({transition:r||c.a.Interpolate,sweep:O.id,rotation:I}));break}}catch(e){t={error:e}}finally{try{M&&!M.done&&(e=T.return)&&e.call(T)}finally{if(t)throw t.error}}if(!x)throw new Error("No direct Mattertag navigation found.");return _?[4,_]:[3,2];case 1:D.sent(),D.label=2;case 2:return[2]}}))}))},e.notTooCloseFilter=function(t){return function(e){return Math.abs(e.position.x-t.x)>T.cameraClearance||Math.abs(e.position.z-t.z)>T.cameraClearance}},e.notTooFarFilter=function(t){return function(e){return!!T.anyDistance||e.position.distanceTo(t)>T.visibleDistance}},e.withinLatitudeFilter=function(t){return function(e){var n=(new i.Jc).copy(t).sub(e.position),r=-Math.atan(n.y/Math.sqrt(n.x*n.x+n.z*n.z)),o=i.ib.degToRad(M.tiltTolerance);return f.d-o<r&&r<f.e+o}},e.getSweepToTagRotation=function(t,e,n){var r=new i.Pb,o=Object(_.j)(t,e),s=(new i.Jc).copy(e).sub(t).normalize().y,c=0,u=0;return!n||[h.d.RIGHT,h.d.RIGHT_DOWN,h.d.RIGHT_UP].includes(n)?u-=.25:[h.d.LEFT,h.d.LEFT_DOWN,h.d.LEFT_UP].includes(n)&&(u+=.25),n?[h.d.UP,h.d.RIGHT_UP,h.d.LEFT_UP].includes(n)?c+=.25:[h.d.DOWN,h.d.RIGHT_DOWN,h.d.LEFT_DOWN].includes(n)&&(c-=.25):c=s<0?.25:-.25,c&&(r.setFromAxisAngle(a.b.RIGHT,c),o.multiply(r)),u&&(r.setFromAxisAngle(a.b.UP,u),o.multiply(r)),I.debug("Calculated sweep to tag rotation offset ["+u+", "+c+"] for tag direction: "+n),Object(x.m)(o)},e}return O(e,t),e.prototype.init=function(t,e){return A(this,void 0,void 0,(function(){var t,n,r,i,o,a;return D(this,(function(s){switch(s.label){case 0:return[4,Promise.all([e.market.waitForData(u.a),e.getModule(g.default),e.getModule(p.default),e.market.waitForData(d.a),e.market.waitForData(l.a)])];case 1:return t=C.apply(void 0,[s.sent(),5]),n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],this.tagData=a,this.cameraData=n,this.viewmodeModule=r,this.raycaster=i,this.sweepData=o,this.commandBinder=e.commandBinder,this.bindings.push(e.commandBinder.addBinding(E.a,this.navigateToTag)),[2]}}))}))},e.prototype.goToNearestSweep=function(t){var e=t.tagId,n=t.transition,r=t.onSweepChosen,i=t.tagDirection;return A(this,void 0,void 0,(function(){var t,o,a,s,u,l,h,f,p;return D(this,(function(d){switch(d.label){case 0:if(t=this.tagData.getTag(e),o=t.anchorPosition.clone().add(t.stemVector),!(a=this.sweepData.getClosestSweep(o,!0)))throw new Error("Cannot find sweep closest to Mattertag disc");return s=this.getSweepToTagRotation(a.position,o,i),u=this.cameraData.pose.projection.asThreeMatrix4(),l=this.cameraData,h=l.width,f=l.height,p=Object(S.c)(o,a.position,s,h,f,u),r&&r(p),[4,this.commandBinder.issueCommand(new b.a({sweep:a.id,rotation:s,transition:n||c.a.Interpolate}))];case 1:return d.sent(),[2]}}))}))},e}(o.a);e.default=k},function(t,e,n){"use strict";n.r(e);var r,i=n(189),o=n(352),a=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.sweepLoader=new i.a(e),r}return a(e,t),e.prototype.activateSweep=function(e){return t.prototype.activateSweep.call(this,e),this.sweepLoader.load(e).then((function(t){return t}))},e.prototype.useTexture=function(e){var n=this.sweepLoader.useTexture(e);return n&&t.prototype.useTexture.call(this,e),n},e.prototype.freeTexture=function(e,n){void 0===n&&(n=!1),t.prototype.freeTexture.call(this,e,n),0===this.textureUsageCounter[e]&&this.sweepLoader.unload(e)},e.prototype.freeAllTextures=function(t){this.sweepLoader.unloadAll(t)},e}(o.a),c=n(96),u=n(15),l=n(176),h=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),f=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},p=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="sweep-pano",e}return h(e,t),e.prototype.init=function(t,e){return f(this,void 0,void 0,(function(){var t,n;return p(this,(function(r){switch(r.label){case 0:return[4,e.getModule(c.default)];case 1:return t=r.sent().getSignedUrls(),[4,e.market.waitForData(u.a)];case 2:return n=r.sent().getSweepList(),this.panoRenderer=new s(t,n),e.addComponent(this,this.panoRenderer),[2]}}))}))},e.prototype.getRenderer=function(){return this.panoRenderer},e}(l.a);e.default=d},function(t,e,n){"use strict";n.r(e);var r,i,o,a=n(4),s=n(0),c=n(31),u=n(68),l=n(3),h=n(76),f=n(61),p=n(7),d=n(28),y=n(269),m=n(24),v=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),g=function(t){function e(e,n,r,i){void 0===i&&(i=!1);var o=t.call(this)||this;return o.cameraModule=e,o.targetProjection=new u.a,o.currentOrientation=new s.Pb,o.currentPosition=new s.Jc,o.positionDelta=new s.Jc,o.angularAccel=0,o.angularVelocity=0,o.linearAccel=new s.Ic,o.linearVelocity=new s.Ic,o.zoomAccel=0,o.zoomVelocity=0,o.scale=1,o.maxZoom=0,o.minZoom=h.i,o.checkBounds=i,o.bounds=n.clone(),o.boundsCenter=r.clone(),o.setupBounds(),o.transition={active:!1,startTime:0,elapsed:0,duration:0,angularVelocity:0,linearVelocity:new s.Ic,zoomVelocity:0,easeOut:!1},o}return v(e,t),e.prototype.start=function(){this.scale=1,this.maxZoom=this.cameraModule.getData(!1).defaultZoom()*h.j},e.prototype.setRollAcceleration=function(t,e){void 0===e&&(e=!1),this.transition.active||(e&&t&&this.angularVelocity&&Math.sign(t)!==Math.sign(this.angularVelocity)&&(this.angularVelocity=0),this.angularAccel=t)},e.prototype.setPanAcceleration=function(t,e){void 0===e&&(e=!1),this.transition.active||(e&&this.haltVelocity(t,this.linearVelocity),this.linearAccel.x=void 0!==t.x?t.x:this.linearAccel.x,this.linearAccel.y=void 0!==t.y?t.y:this.linearAccel.y)},e.prototype.setZoomAcceleration=function(t){this.transition.active||(this.zoomAccel=t)},e.prototype.haltVelocity=function(t,e){t.x&&e.x&&Math.sign(t.x)!==Math.sign(e.x)&&(e.x=0),t.y&&e.y&&Math.sign(t.y)!==Math.sign(e.y)&&(e.y=0)},e.prototype.startRotateTransition=function(t,e,n){return this.startTransition(t,e.x*h.b,new s.Ic,0,n).nativePromise()},e.prototype.startTranslateTransition=function(t,e,n){return void 0===n&&(n=!0),this.startTransition(t,0,e.clone().multiplyScalar(h.b),0,n).nativePromise()},e.prototype.startZoomTransition=function(t,e,n){return this.startTransition(t,0,new s.Ic(0,0),e,n).nativePromise()},e.prototype.startTransition=function(t,e,n,r,i){var o=new m.a;return this.transition.active=!0,this.transition.duration=t,this.transition.elapsed=0,this.transition.startTime=Date.now(),this.transition.deferred=o,this.transition.angularVelocity=e,this.transition.linearVelocity.copy(n),this.transition.zoomVelocity=r,this.transition.easeOut=i,this.angularAccel=0,this.linearAccel.set(0,0),this.zoomAccel=0,this.angularVelocity=e,this.linearVelocity.copy(n),this.zoomVelocity=r,this.cameraModule.beginExternalTransition(),o.promise()},e.prototype.stopTransition=function(){this.transition.active&&(this.cameraModule.endExternalTransition(),this.transition.active=!1),this.transition.deferred&&(this.transition.deferred.resolve(),this.transition.deferred=void 0)},e.prototype.updateTransition=function(t,e,n,r){var i=1,o=t/h.b;(this.transition.elapsed+=t,this.transition.elapsed>=this.transition.duration)&&(i=(this.transition.duration-(this.transition.elapsed-t))/t,o=1);e&&(this.angularVelocity=this.transition.angularVelocity*o*i,this.roll(this.angularVelocity)),n&&(this.linearVelocity.copy(this.transition.linearVelocity).multiplyScalar(i*o),this.pan(this.linearVelocity)),r&&(this.zoomVelocity=this.transition.zoomVelocity*i*o,this.zoom(this.zoomVelocity)),this.transition.elapsed>=this.transition.duration&&(this.stop(this.transition.easeOut),this.transition.active=!1)},e.prototype.updateDefault=function(t,e,n,r){var i=t/h.b;e&&(this.angularVelocity=this.angularVelocity+this.angularAccel*i,this.roll(this.angularVelocity),this.angularVelocity*=Math.pow(1-h.a,i)),n&&(this.linearVelocity.addScaledVector(this.linearAccel,i),this.pan(this.linearVelocity),this.linearVelocity.multiplyScalar(Math.pow(1-h.a,i))),r&&(this.zoomVelocity=this.zoomVelocity+this.zoomAccel*i,this.zoom(this.zoomVelocity),this.zoomVelocity*=Math.pow(1-h.h,i))},e.prototype.update=function(t){var e=Math.abs(this.angularAccel)>f.a.epsilon||Math.abs(this.angularVelocity)>f.a.epsilon,n=this.linearAccel.length()>f.a.epsilon||this.linearVelocity.length()>f.a.epsilon,r=Math.abs(this.zoomAccel)>f.a.epsilon||Math.abs(this.zoomVelocity)>f.a.epsilon;this.transition.active?this.updateTransition(t,e,n,r):this.updateDefault(t,e,n,r)},e.prototype.stopMomentum=function(){this.transition.active||(this.angularVelocity=0,this.linearVelocity.set(0,0),this.zoomVelocity=0)},e.prototype.stopAcceleration=function(){this.transition.active||(this.setPanAcceleration({x:0,y:0}),this.setRollAcceleration(0),this.setZoomAcceleration(0))},e.prototype.stop=function(t){void 0===t&&(t=!1),this.stopTransition(),this.stopAcceleration(),t||this.stopMomentum()},e.prototype.pan=function(t){var e=this.cameraModule.getData(!1);this.positionDelta.x=t.x,this.positionDelta.z=t.y,this.currentPosition.copy(e.pose.position).add(this.positionDelta),this.checkBounds&&!this.insideBounds(this.currentPosition,e.pose.rotation,e.pose.projection)||this.cameraModule.updateCameraPosition(this.currentPosition)},e.prototype.roll=function(t){var e=this.cameraModule.getData(!1);this.currentOrientation.setFromAxisAngle(l.b.FORWARD,t),this.currentOrientation.multiplyQuaternions(e.pose.rotation,this.currentOrientation),this.currentOrientation.normalize(),this.checkBounds&&!this.insideBounds(e.pose.position,this.currentOrientation,e.pose.projection)||e.pose.rotation.equals(this.currentOrientation)||this.cameraModule.updateCameraRotation(this.currentOrientation)},e.prototype.zoom=function(t){var e=this.cameraModule.getData(!1);this.targetProjection.copy(e.pose.projection);var n=this.scale*(1-t);if(Math.abs(n-this.scale)>f.a.epsilon){this.targetProjection.elements[0]*=n/this.scale,this.targetProjection.elements[5]*=n/this.scale;var r=Object(d.e)(this.targetProjection);if(t<0&&r<=this.minZoom||t>0&&r>=this.maxZoom)return;if(this.checkBounds&&!this.insideBounds(e.pose.position,e.pose.rotation,this.targetProjection))return;this.scale=n,this.cameraModule.updateCameraProjection(this.targetProjection.clone())}},e.prototype.setupBounds=function(){this.bounds.min.x=this.adjustBound(this.bounds.min.x,2),this.bounds.min.y=this.adjustBound(this.bounds.min.y,2),this.bounds.min.z=this.adjustBound(this.bounds.min.z,2),this.bounds.max.x=this.adjustBound(this.bounds.max.x,-2),this.bounds.max.y=this.adjustBound(this.bounds.max.y,-2),this.bounds.max.z=this.adjustBound(this.bounds.max.z,-2),this.worldBounds=(new s.h).setFromCenterAndSize(this.boundsCenter,new s.Jc(this.bounds.max.x-this.bounds.min.x,this.bounds.max.y-this.bounds.min.y,this.bounds.max.z-this.bounds.min.z))},e.prototype.insideBounds=function(t,e,n){return!!Object(p.k)(t,e,n,this.worldBounds)},e.prototype.adjustBound=function(t,e){return Math.sign(t+e)===Math.sign(t)?t+e:0},e}(y.a),b=n(60),w=n(17),_=n(27),x=n(16),S=n(77),T=n(1),M=n(112),E=n(98),P=n(8),O=n(154),A=n(50),D=n(18),R=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),C=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},I=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},k=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};(o=i||(i={}))[o.NONE=_.b.NONE]="NONE",o[o.PAN=_.b.PRIMARY]="PAN",o[o.ROTATE=_.b.SECONDARY]="ROTATE",o[o.ZOOM=_.b.MIDDLE]="ZOOM";var L=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="floorplan-controls",e.controlState=i.NONE,e.controlsEngaged=!1,e.movementKeys=new s.Ic,e.resetControlState=function(){e.controlState=i.NONE},e}return R(e,t),e.prototype.init=function(t,e){return C(this,void 0,void 0,(function(){var t,n,r,i,o,a,u=this;return I(this,(function(l){switch(l.label){case 0:return[4,Promise.all([e.getModule(A.default),e.getModule(b.default),e.getModule(O.default),e.market.waitForData(D.a),e.market.waitForData(w.a)])];case 1:return t=k.apply(void 0,[l.sent(),5]),n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],this.cameraModule=r,this.cameraData=o,this.viewmodeData=a,this.modelMesh=n.mesh,this.modelSize=Math.max(this.modelMesh.boundingBox.getSize(new s.Jc).length(),1),this.commonControlsModule=i,this.controls=new g(this.cameraModule,this.modelMesh.boundingBox,this.modelMesh.center,!0),this.commonControlsModule.addControls(T.a.Floorplan,this.controls),e.getModule(c.default).then((function(t){u.bindings.push(t.registerHandler(P.q,(function(t){u.validateViewmode()&&u.onScrollWheel(t)}))),u.bindings.push(t.registerHandler(P.b,(function(t){u.validateViewmode()&&u.onDragBegin(t.buttons)}))),u.bindings.push(t.registerHandler(P.d,(function(t){u.validateViewmode()&&(u.controlsEngaged=!0,u.onDrag(t.delta),u.controls.update(h.b),u.controls.stop())}))),u.bindings.push(t.registerHandler(P.c,(function(t){u.validateViewmode()&&u.controlsEngaged&&(t.timeSinceLastMove<100&&(u.onDrag(t.delta),u.controls.update(h.b),u.controls.stopAcceleration()),u.onDragEnd(t.delta,t.buttons),u.controlsEngaged=!1)}))),u.bindings.push(t.registerHandler(P.l,(function(t){u.validateViewmode()&&(u.controls.setZoomAcceleration(-t.pinchDelta*h.k),u.controls.update(h.b),u.controls.stop())}))),u.bindings.push(t.registerHandler(P.k,u.resetControlState)),u.bindings.push(t.registerHandler(P.p,(function(t){u.validateViewmode()&&(u.controls.setRollAcceleration(t.rotateDelta),u.controls.update(h.b),u.controls.stop())}))),u.bindings.push(t.registerHandler(P.o,u.resetControlState)),u.bindings.push(t.registerHandler(P.f,(function(t){u.validateViewmode()&&t.state!==S.a.PRESSED&&u.onKey(t.key,t.state)})))})),this.bindings.push(e.subscribe(M.a,(function(t){u.controls.stop(),u.resetControlState()}))),this.bindings.push(e.subscribe(E.a,(function(t){t.toMode===T.a.Floorplan&&u.controls.start()}))),[2]}}))}))},e.prototype.onUpdate=function(t){this.validateViewmode()&&this.controls.update(t)},e.prototype.onScrollWheel=function(t){if(0!==t.delta.y){var e=Object(p.r)(this.modelSize,1,1500,2,.125);this.controls.setZoomAcceleration(t.delta.y*h.l/(e*h.g)),this.controls.update(h.b),this.controls.setZoomAcceleration(0)}},e.prototype.onDragBegin=function(t){if(this.controlState===i.NONE){var e=t;this.controlState=e}this.controls.stop()},e.prototype.onDrag=function(t){switch(this.controlState){case i.ROTATE:this.controls.setRollAcceleration(t.x*Math.PI);break;case i.PAN:var e=this.convertDeltaToLocal(t);this.controls.setPanAcceleration({x:-e.x,y:-e.z});break;case i.ZOOM:0!==t.y&&this.controls.setZoomAcceleration(-t.y)}},e.prototype.onDragEnd=function(t,e){e&this.controlState||(this.controlState=i.NONE)},e.prototype.onKey=function(t,e){var n=e===S.a.DOWN,r=!1;switch(t){case x.a.LEFTARROW:case x.a.J:this.controls.setRollAcceleration(n?h.d:0,!0);break;case x.a.RIGHTARROW:case x.a.L:this.controls.setRollAcceleration(n?-h.d:0,!0);break;case x.a.A:this.movementKeys.x=n?-1:0,r=!0;break;case x.a.D:this.movementKeys.x=n?1:0,r=!0;break;case x.a.W:this.movementKeys.y=n?1:0,r=!0;break;case x.a.S:this.movementKeys.y=n?-1:0,r=!0;break;case x.a.K:case x.a.DOWNARROW:this.controls.setZoomAcceleration(n?h.e:0);break;case x.a.I:case x.a.UPARROW:this.controls.setZoomAcceleration(n?-h.e:0)}if(r){var i=this.convertDeltaToLocal(this.movementKeys).setLength(h.c);this.controls.setPanAcceleration({x:i.x,y:i.z})}},e.prototype.validateViewmode=function(){return this.viewmodeData.currentMode===T.a.Floorplan},e.prototype.convertDeltaToLocal=function(t){var e=t.x||0,n=t.y||0,r=e/this.cameraData.pose.projection.elements[0],i=n/this.cameraData.pose.projection.elements[5],o=new s.Jc;return o.set(r,i,0),o.applyQuaternion(this.cameraData.pose.rotation),o},e}(a.a);e.default=L},,,,,function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},i=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.dependencies=t}return t.prototype.getDependencies=function(){return r(this,void 0,Promise,(function(){return i(this,(function(t){return[2,Promise.all(this.dependencies)]}))}))},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(r(arguments[e]));return t},o=function(){function t(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.ctor=t,this.args=e}return t.prototype.create=function(){var t;return new((t=this.ctor).bind.apply(t,i([void 0],this.args)))},t}()},,function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return u}));var r=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},i=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},a=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t},s=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},c=function(){function t(t,e,n){this.dependencies=t,this.subscribeToChanges=e,this.observers=new Set,this.currentData=n.create(),this.freshDataCache=n.create()}return t.create=function(e,n,o){return r(this,void 0,void 0,(function(){return i(this,(function(r){switch(r.label){case 0:return[4,e.getDependencies()];case 1:return[2,new t(r.sent(),n,o)]}}))}))},t.prototype.getData=function(){return this.currentData.data},t.prototype.subscribe=function(t){var e=this;return this.addObserver(t),{renew:function(){e.addObserver(t)},cancel:function(){e.removeObserver(t)}}},t.prototype.addObserver=function(t){var e,n=this;this.observers.has(t)||(this.observers.add(t),1===this.observers.size&&((e=this.currentData).update.apply(e,a(this.dependencies)),this.changeSubscription=this.subscribeToChanges.apply(this,a([function(){return n.onChange()}],this.dependencies))),t.dirty=!0)},t.prototype.removeObserver=function(t){0!==this.observers.size&&(this.observers.delete(t),0===this.observers.size&&this.changeSubscription.cancel())},t.prototype.onChange=function(){var t,e,n;if((t=this.freshDataCache).update.apply(t,a(this.dependencies)),!this.currentData.equals(this.freshDataCache)){this.currentData.copy(this.freshDataCache);try{for(var r=s(this.observers),i=r.next();!i.done;i=r.next()){i.value.dirty=!0}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}},t}(),u=function(){this.dirty=!1}},function(t,e,n){"use strict";n.d(e,"c",(function(){return r})),n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return o})),n.d(e,"d",(function(){return s})),n.d(e,"f",(function(){return c})),n.d(e,"e",(function(){return u}));var r,i,o,a=n(12);!function(t){t.WEBVR="application.webvr",t.SHOWCASE="application.showcase",t.WORKSHOP="application.workshop"}(r||(r={})),function(t){t.UNINITIALIZED="appphase.uninitialized",t.WAITING="appphase.waiting",t.LOADING="appphase.loading",t.STARTING="appphase.starting",t.PLAYING="appphase.playing",t.ERROR="appphase.error"}(i||(i={})),function(t){t.PHASE_CHANGE="application.phasechange",t.APP_CHANGE="application.appchange"}(o||(o={}));var s=function(t){switch(t){case r.WEBVR:return a.b.WEBVR;case r.SHOWCASE:return a.b.SHOWCASE;case r.WORKSHOP:return a.b.WORKSHOP;default:return}},c=function(t){switch(t){case a.b.WEBVR:return r.WEBVR;case a.b.SHOWCASE:return r.SHOWCASE;case a.b.WORKSHOP:return r.WORKSHOP;default:return}},u=function(t){var e=a.a[t];if(e in i)return i[e]}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r="features/labels"},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},i=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},a=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t},s=function(){function t(t,e){this.dependencies=t,this.executor=e.create()}return t.create=function(e,n){return r(this,void 0,void 0,(function(){return i(this,(function(r){switch(r.label){case 0:return[4,e.getDependencies()];case 1:return[2,new t(r.sent(),n)]}}))}))},t.prototype.exec=function(t,e){var n,r,i=(n=this.executor).validateInput.apply(n,a([t],this.dependencies));(r=this.executor).exec.apply(r,a([i,e],this.dependencies))},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(21),i=n(172),o=function(t,e){if(e===r.c.Metric)return t.toFixed(2)+"m";var n=Object(i.c)(t),o=n.feet,a=n.inches;return o>0?o+"' "+a+'"':a+'"'}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},i=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.subs=t}return t.prototype.renew=function(){var t,e;try{for(var n=r(this.subs),i=n.next();!i.done;i=n.next()){i.value.renew()}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},t.prototype.cancel=function(){var t,e;try{for(var n=r(this.subs),i=n.next();!i.done;i=n.next()){i.value.cancel()}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o}));var r=n(64),i=function(t,e){void 0===e&&(e=200);var n=0,i=0,o=1/t,a=function(t){return t.width/t.height};return{resizeDimensions:[{property:r.b.width,setDimension:function(e){return n=a(e)<t?e.width:e.height*t},duration:e},{property:r.b.height,setDimension:function(e){return i=a(e)<t?e.width*o:e.height},duration:e},{property:r.b.top,setDimension:function(e){return a(e)<t?(e.height-i)/2:0},duration:e},{property:r.b.left,setDimension:function(e){return a(e)<t?0:(e.width-n)/2},duration:e}]}},o=function(t){return void 0===t&&(t=200),{resizeDimensions:[{property:r.b.width,setDimension:function(t){return t.width},duration:t},{property:r.b.height,setDimension:function(t){return t.height},duration:t},{property:r.b.top,setDimension:function(){return 0},duration:t},{property:r.b.left,setDimension:function(){return 0},duration:t}]}}},,function(t,e,n){"use strict";var r,i=n(44),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});function a(t,e){if(t.byteLength!==e.byteLength)throw new s;for(var n=e.length,r=0;r<n;++r)t[r]=e[r]}var s=function(t){function e(){var e=t.call(this,"Cannot copy into an array of a different size")||this;return e.name="ArraySizeMismatch",e}return o(e,t),e}(i.a);function c(t,e){t.x=e.x,t.y=e.y}function u(t,e){c(t,e),t.z=e.z}var l=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};function h(t,e){for(var n,r,i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];try{for(var a=l(i),s=a.next();!s.done;s=a.next()){var c=s.value;t[c]=e[c]}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}}n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return c})),n.d(e,"d",(function(){return u})),n.d(e,"a",(function(){return h}))},function(t,e,n){"use strict";t.exports=n(638).polyfill()},function(t,e,n){var r=n(153),i=n(377).f,o=n(286),a=n(473),s=n(381),c=n(643),u=n(647);t.exports=function(t,e){var n,l,h,f,p,d=t.target,y=t.global,m=t.stat;if(n=y?r:m?r[d]||s(d,{}):(r[d]||{}).prototype)for(l in e){if(f=e[l],h=t.noTargetGet?(p=i(n,l))&&p.value:n[l],!u(y?l:d+(m?".":"#")+l,t.forced)&&void 0!==h){if(typeof f==typeof h)continue;c(f,h)}(t.sham||h&&h.sham)&&o(f,"sham",!0),a(n,l,f,t)}}},function(t,e,n){var r=n(247),i=n(469),o="".split;t.exports=r((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==i(t)?o.call(t,""):Object(t)}:Object},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t}},function(t,e,n){var r=n(226),i=n(247),o=n(472);t.exports=!r&&!i((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},function(t,e,n){var r=n(153),i=n(249),o=r.document,a=i(o)&&i(o.createElement);t.exports=function(t){return a?o.createElement(t):{}}},function(t,e,n){var r=n(153),i=n(288),o=n(286),a=n(204),s=n(381),c=n(475),u=n(476),l=u.get,h=u.enforce,f=String(c).split("toString");i("inspectSource",(function(t){return c.call(t)})),(t.exports=function(t,e,n,i){var c=!!i&&!!i.unsafe,u=!!i&&!!i.enumerable,l=!!i&&!!i.noTargetGet;"function"==typeof n&&("string"!=typeof e||a(n,"name")||o(n,"name",e),h(n).source=f.join("string"==typeof e?e:"")),t!==r?(c?!l&&t[e]&&(u=!0):delete t[e],u?t[e]=n:o(t,e,n)):u?t[e]=n:s(e,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&l(this).source||c.call(this)}))},function(t,e){t.exports=!1},function(t,e,n){var r=n(288);t.exports=r("native-function-to-string",Function.toString)},function(t,e,n){var r,i,o,a=n(642),s=n(153),c=n(249),u=n(286),l=n(204),h=n(382),f=n(330),p=s.WeakMap;if(a){var d=new p,y=d.get,m=d.has,v=d.set;r=function(t,e){return v.call(d,t,e),e},i=function(t){return y.call(d,t)||{}},o=function(t){return m.call(d,t)}}else{var g=h("state");f[g]=!0,r=function(t,e){return u(t,g,e),e},i=function(t){return l(t,g)?t[g]:{}},o=function(t){return l(t,g)}}t.exports={set:r,get:i,has:o,enforce:function(t){return o(t)?i(t):r(t,{})},getterFor:function(t){return function(e){var n;if(!c(e)||(n=i(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return n}}}},function(t,e,n){var r=n(331),i=n(153),o=function(t){return"function"==typeof t?t:void 0};t.exports=function(t,e){return arguments.length<2?o(r[t])||o(i[t]):r[t]&&r[t][e]||i[t]&&i[t][e]}},function(t,e,n){var r=n(204),i=n(248),o=n(645).indexOf,a=n(330);t.exports=function(t,e){var n,s=i(t),c=0,u=[];for(n in s)!r(a,n)&&r(s,n)&&u.push(n);for(;e.length>c;)r(s,n=e[c++])&&(~o(u,n)||u.push(n));return u}},function(t,e,n){var r=n(480),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var r=n(247);t.exports=!!Object.getOwnPropertySymbols&&!r((function(){return!String(Symbol())}))},function(t,e,n){var r=n(469);t.exports=Array.isArray||function(t){return"Array"==r(t)}},function(t,e,n){var r=n(470);t.exports=function(t){return Object(r(t))}},function(t,e,n){e.f=n(332)},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i={object:!0,symbol:!0};t.exports=function(){var t;if("function"!=typeof Symbol)return!1;t=Symbol("test symbol");try{String(t)}catch(t){return!1}return!!i[r(Symbol.iterator)]&&(!!i[r(Symbol.toPrimitive)]&&!!i[r(Symbol.toStringTag)])}},function(t,e){t.exports=function(){return this}()},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i,o,a,s,c=n(227),u=n(671),l=Object.create,h=Object.defineProperties,f=Object.defineProperty,p=Object.prototype,d=l(null);if("function"==typeof Symbol){i=Symbol;try{String(i()),s=!0}catch(t){}}var y,m=(y=l(null),function(t){for(var e,n,r=0;y[t+(r||"")];)++r;return y[t+=r||""]=!0,f(p,e="@@"+t,c.gs(null,(function(t){n||(n=!0,f(this,e,c(t)),n=!1)}))),e});a=function(t){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return o(t)},t.exports=o=function t(e){var n;if(this instanceof t)throw new TypeError("Symbol is not a constructor");return s?i(e):(n=l(a.prototype),e=void 0===e?"":String(e),h(n,{__description__:c("",e),__name__:c("",m(e))}))},h(o,{for:c((function(t){return d[t]?d[t]:d[t]=o(String(t))})),keyFor:c((function(t){var e;for(e in u(t),d)if(d[e]===t)return e})),hasInstance:c("",i&&i.hasInstance||o("hasInstance")),isConcatSpreadable:c("",i&&i.isConcatSpreadable||o("isConcatSpreadable")),iterator:c("",i&&i.iterator||o("iterator")),match:c("",i&&i.match||o("match")),replace:c("",i&&i.replace||o("replace")),search:c("",i&&i.search||o("search")),species:c("",i&&i.species||o("species")),split:c("",i&&i.split||o("split")),toPrimitive:c("",i&&i.toPrimitive||o("toPrimitive")),toStringTag:c("",i&&i.toStringTag||o("toStringTag")),unscopables:c("",i&&i.unscopables||o("unscopables"))}),h(a.prototype,{constructor:c(o),toString:c("",(function(){return this.__name__}))}),h(o.prototype,{toString:c((function(){return"Symbol ("+u(this).__description__+")"})),valueOf:c((function(){return u(this)}))}),f(o.prototype,o.toPrimitive,c("",(function(){var t=u(this);return"symbol"===r(t)?t:t.toString()}))),f(o.prototype,o.toStringTag,c("c","Symbol")),f(a.prototype,o.toStringTag,c("c",o.prototype[o.toStringTag])),f(a.prototype,o.toPrimitive,c("c",o.prototype[o.toPrimitive]))},function(t,e,n){"use strict";t.exports=function(){}},function(t,e,n){"use strict";var r=n(251),i=Array.prototype.forEach,o=Object.create,a=function(t,e){var n;for(n in t)e[n]=t[n]};t.exports=function(t){var e=o(null);return i.call(arguments,(function(t){r(t)&&a(Object(t),e)})),e}},function(t,e,n){"use strict";n(673)()||Object.defineProperty(n(487),"Set",{value:n(674),configurable:!0,enumerable:!1,writable:!0})},function(t,e,n){"use strict";var r=n(185);t.exports=function(){return r(this).length=0,this}},function(t,e,n){"use strict";var r=n(679),i=Math.max;t.exports=function(t){return i(0,r(t))}},function(t,e,n){"use strict";var r=Object.create,i=Object.getPrototypeOf,o={};t.exports=function(){var t=Object.setPrototypeOf,e=arguments[0]||r;return"function"==typeof t&&i(t(e(null),o))===o}},function(t,e,n){"use strict";var r,i=n(683),o=n(185),a=Object.prototype.isPrototypeOf,s=Object.defineProperty,c={configurable:!0,enumerable:!1,writable:!0,value:void 0};r=function(t,e){if(o(t),null===e||i(e))return t;throw new TypeError("Prototype must be null or an object")},t.exports=function(t){var e,n;return t?(2===t.level?t.set?(n=t.set,e=function(t,e){return n.call(r(t,e),e),t}):e=function(t,e){return r(t,e).__proto__=e,t}:e=function t(e,n){var i;return r(e,n),(i=a.call(t.nullPolyfill,e))&&delete t.nullPolyfill.__proto__,null===n&&(n=t.nullPolyfill),e.__proto__=n,i&&s(t.nullPolyfill,"__proto__",c),e},Object.defineProperty(e,"level",{configurable:!1,enumerable:!1,writable:!1,value:t.level})):null}(function(){var t,e=Object.create(null),n={},r=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(r){try{(t=r.set).call(e,n)}catch(t){}if(Object.getPrototypeOf(e)===n)return{set:t,level:2}}return e.__proto__=n,Object.getPrototypeOf(e)===n?{level:2}:((e={}).__proto__=n,Object.getPrototypeOf(e)===n&&{level:1})}()),n(684)},function(t,e,n){"use strict";var r=n(686);t.exports=function(t){if(!r(t))throw new TypeError(t+" is not iterable");return t}},function(t,e){},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){"use strict";var r=n(706).Buffer,i=n(391).Transform;function o(t){i.call(this),this._block=r.allocUnsafe(t),this._blockSize=t,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}n(37)(o,i),o.prototype._transform=function(t,e,n){var r=null;try{this.update(t,e)}catch(t){r=t}n(r)},o.prototype._flush=function(t){var e=null;try{this.push(this.digest())}catch(t){e=t}t(e)},o.prototype.update=function(t,e){if(function(t,e){if(!r.isBuffer(t)&&"string"!=typeof t)throw new TypeError(e+" must be a string or a buffer")}(t,"Data"),this._finalized)throw new Error("Digest already called");r.isBuffer(t)||(t=r.from(t,e));for(var n=this._block,i=0;this._blockOffset+t.length-i>=this._blockSize;){for(var o=this._blockOffset;o<this._blockSize;)n[o++]=t[i++];this._update(),this._blockOffset=0}for(;i<t.length;)n[this._blockOffset++]=t[i++];for(var a=0,s=8*t.length;s>0;++a)this._length[a]+=s,(s=this._length[a]/4294967296|0)>0&&(this._length[a]-=4294967296*s);return this},o.prototype._update=function(){throw new Error("_update is not implemented")},o.prototype.digest=function(t){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var e=this._digest();void 0!==t&&(e=e.toString(t)),this._block.fill(0),this._blockOffset=0;for(var n=0;n<4;++n)this._length[n]=0;return e},o.prototype._digest=function(){throw new Error("_digest is not implemented")},t.exports=o},function(t,e,n){"use strict";(function(e,r){var i=n(336);t.exports=b;var o,a=n(498);b.ReadableState=g;n(231).EventEmitter;var s=function(t,e){return t.listeners(e).length},c=n(501),u=n(228).Buffer,l=e.Uint8Array||function(){};var h=n(290);h.inherits=n(37);var f=n(707),p=void 0;p=f&&f.debuglog?f.debuglog("stream"):function(){};var d,y=n(708),m=n(502);h.inherits(b,c);var v=["error","close","destroy","pause","resume"];function g(t,e){t=t||{};var r=e instanceof(o=o||n(229));this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var i=t.highWaterMark,a=t.readableHighWaterMark,s=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(a||0===a)?a:s,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new y,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(d||(d=n(394).StringDecoder),this.decoder=new d(t.encoding),this.encoding=t.encoding)}function b(t){if(o=o||n(229),!(this instanceof b))return new b(t);this._readableState=new g(t,this),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),c.call(this)}function w(t,e,n,r,i){var o,a=t._readableState;null===e?(a.reading=!1,function(t,e){if(e.ended)return;if(e.decoder){var n=e.decoder.end();n&&n.length&&(e.buffer.push(n),e.length+=e.objectMode?1:n.length)}e.ended=!0,S(t)}(t,a)):(i||(o=function(t,e){var n;r=e,u.isBuffer(r)||r instanceof l||"string"==typeof e||void 0===e||t.objectMode||(n=new TypeError("Invalid non-string/buffer chunk"));var r;return n}(a,e)),o?t.emit("error",o):a.objectMode||e&&e.length>0?("string"==typeof e||a.objectMode||Object.getPrototypeOf(e)===u.prototype||(e=function(t){return u.from(t)}(e)),r?a.endEmitted?t.emit("error",new Error("stream.unshift() after end event")):_(t,a,e,!0):a.ended?t.emit("error",new Error("stream.push() after EOF")):(a.reading=!1,a.decoder&&!n?(e=a.decoder.write(e),a.objectMode||0!==e.length?_(t,a,e,!1):M(t,a)):_(t,a,e,!1))):r||(a.reading=!1));return function(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}(a)}function _(t,e,n,r){e.flowing&&0===e.length&&!e.sync?(t.emit("data",n),t.read(0)):(e.length+=e.objectMode?1:n.length,r?e.buffer.unshift(n):e.buffer.push(n),e.needReadable&&S(t)),M(t,e)}Object.defineProperty(b.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),b.prototype.destroy=m.destroy,b.prototype._undestroy=m.undestroy,b.prototype._destroy=function(t,e){this.push(null),e(t)},b.prototype.push=function(t,e){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof t&&((e=e||r.defaultEncoding)!==r.encoding&&(t=u.from(t,e),e=""),n=!0),w(this,t,e,!1,n)},b.prototype.unshift=function(t){return w(this,t,null,!0,!1)},b.prototype.isPaused=function(){return!1===this._readableState.flowing},b.prototype.setEncoding=function(t){return d||(d=n(394).StringDecoder),this._readableState.decoder=new d(t),this._readableState.encoding=t,this};function x(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!=t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=function(t){return t>=8388608?t=8388608:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}function S(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(p("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?i.nextTick(T,t):T(t))}function T(t){p("emit readable"),t.emit("readable"),A(t)}function M(t,e){e.readingMore||(e.readingMore=!0,i.nextTick(E,t,e))}function E(t,e){for(var n=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(p("maybeReadMore read 0"),t.read(0),n!==e.length);)n=e.length;e.readingMore=!1}function P(t){p("readable nexttick read 0"),t.read(0)}function O(t,e){e.reading||(p("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),A(t),e.flowing&&!e.reading&&t.read(0)}function A(t){var e=t._readableState;for(p("flow",e.flowing);e.flowing&&null!==t.read(););}function D(t,e){return 0===e.length?null:(e.objectMode?n=e.buffer.shift():!t||t>=e.length?(n=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.head.data:e.buffer.concat(e.length),e.buffer.clear()):n=function(t,e,n){var r;t<e.head.data.length?(r=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):r=t===e.head.data.length?e.shift():n?function(t,e){var n=e.head,r=1,i=n.data;t-=i.length;for(;n=n.next;){var o=n.data,a=t>o.length?o.length:t;if(a===o.length?i+=o:i+=o.slice(0,t),0===(t-=a)){a===o.length?(++r,n.next?e.head=n.next:e.head=e.tail=null):(e.head=n,n.data=o.slice(a));break}++r}return e.length-=r,i}(t,e):function(t,e){var n=u.allocUnsafe(t),r=e.head,i=1;r.data.copy(n),t-=r.data.length;for(;r=r.next;){var o=r.data,a=t>o.length?o.length:t;if(o.copy(n,n.length-t,0,a),0===(t-=a)){a===o.length?(++i,r.next?e.head=r.next:e.head=e.tail=null):(e.head=r,r.data=o.slice(a));break}++i}return e.length-=i,n}(t,e);return r}(t,e.buffer,e.decoder),n);var n}function R(t){var e=t._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,i.nextTick(C,e,t))}function C(t,e){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function I(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}b.prototype.read=function(t){p("read",t),t=parseInt(t,10);var e=this._readableState,n=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return p("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?R(this):S(this),null;if(0===(t=x(t,e))&&e.ended)return 0===e.length&&R(this),null;var r,i=e.needReadable;return p("need readable",i),(0===e.length||e.length-t<e.highWaterMark)&&p("length less than watermark",i=!0),e.ended||e.reading?p("reading or ended",i=!1):i&&(p("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=x(n,e))),null===(r=t>0?D(t,e):null)?(e.needReadable=!0,t=0):e.length-=t,0===e.length&&(e.ended||(e.needReadable=!0),n!==t&&e.ended&&R(this)),null!==r&&this.emit("data",r),r},b.prototype._read=function(t){this.emit("error",new Error("_read() is not implemented"))},b.prototype.pipe=function(t,e){var n=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=t;break;case 1:o.pipes=[o.pipes,t];break;default:o.pipes.push(t)}o.pipesCount+=1,p("pipe count=%d opts=%j",o.pipesCount,e);var c=(!e||!1!==e.end)&&t!==r.stdout&&t!==r.stderr?l:b;function u(e,r){p("onunpipe"),e===n&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,p("cleanup"),t.removeListener("close",v),t.removeListener("finish",g),t.removeListener("drain",h),t.removeListener("error",m),t.removeListener("unpipe",u),n.removeListener("end",l),n.removeListener("end",b),n.removeListener("data",y),f=!0,!o.awaitDrain||t._writableState&&!t._writableState.needDrain||h())}function l(){p("onend"),t.end()}o.endEmitted?i.nextTick(c):n.once("end",c),t.on("unpipe",u);var h=function(t){return function(){var e=t._readableState;p("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&s(t,"data")&&(e.flowing=!0,A(t))}}(n);t.on("drain",h);var f=!1;var d=!1;function y(e){p("ondata"),d=!1,!1!==t.write(e)||d||((1===o.pipesCount&&o.pipes===t||o.pipesCount>1&&-1!==I(o.pipes,t))&&!f&&(p("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,d=!0),n.pause())}function m(e){p("onerror",e),b(),t.removeListener("error",m),0===s(t,"error")&&t.emit("error",e)}function v(){t.removeListener("finish",g),b()}function g(){p("onfinish"),t.removeListener("close",v),b()}function b(){p("unpipe"),n.unpipe(t)}return n.on("data",y),function(t,e,n){if("function"==typeof t.prependListener)return t.prependListener(e,n);t._events&&t._events[e]?a(t._events[e])?t._events[e].unshift(n):t._events[e]=[n,t._events[e]]:t.on(e,n)}(t,"error",m),t.once("close",v),t.once("finish",g),t.emit("pipe",n),o.flowing||(p("pipe resume"),n.resume()),t},b.prototype.unpipe=function(t){var e=this._readableState,n={hasUnpiped:!1};if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,n),this);if(!t){var r=e.pipes,i=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var o=0;o<i;o++)r[o].emit("unpipe",this,n);return this}var a=I(e.pipes,t);return-1===a?this:(e.pipes.splice(a,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,n),this)},b.prototype.on=function(t,e){var n=c.prototype.on.call(this,t,e);if("data"===t)!1!==this._readableState.flowing&&this.resume();else if("readable"===t){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&S(this):i.nextTick(P,this))}return n},b.prototype.addListener=b.prototype.on,b.prototype.resume=function(){var t=this._readableState;return t.flowing||(p("resume"),t.flowing=!0,function(t,e){e.resumeScheduled||(e.resumeScheduled=!0,i.nextTick(O,t,e))}(this,t)),this},b.prototype.pause=function(){return p("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(p("pause"),this._readableState.flowing=!1,this.emit("pause")),this},b.prototype.wrap=function(t){var e=this,n=this._readableState,r=!1;for(var i in t.on("end",(function(){if(p("wrapped end"),n.decoder&&!n.ended){var t=n.decoder.end();t&&t.length&&e.push(t)}e.push(null)})),t.on("data",(function(i){(p("wrapped data"),n.decoder&&(i=n.decoder.write(i)),n.objectMode&&null==i)||(n.objectMode||i&&i.length)&&(e.push(i)||(r=!0,t.pause()))})),t)void 0===this[i]&&"function"==typeof t[i]&&(this[i]=function(e){return function(){return t[e].apply(t,arguments)}}(i));for(var o=0;o<v.length;o++)t.on(v[o],this.emit.bind(this,v[o]));return this._read=function(e){p("wrapped _read",e),r&&(r=!1,t.resume())},this},Object.defineProperty(b.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),b._fromList=D}).call(this,n(144),n(169))},function(t,e,n){t.exports=n(231).EventEmitter},function(t,e,n){"use strict";var r=n(336);function i(t,e){t.emit("error",e)}t.exports={destroy:function(t,e){var n=this,o=this._readableState&&this._readableState.destroyed,a=this._writableState&&this._writableState.destroyed;return o||a?(e?e(t):!t||this._writableState&&this._writableState.errorEmitted||r.nextTick(i,this,t),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,(function(t){!e&&t?(r.nextTick(i,n,t),n._writableState&&(n._writableState.errorEmitted=!0)):e&&e(t)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(t,e,n){"use strict";t.exports=a;var r=n(229),i=n(290);function o(t,e){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!=e&&this.push(e),r(t);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function a(t){if(!(this instanceof a))return new a(t);r.call(this,t),this._transformState={afterTransform:o.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",s)}function s(){var t=this;"function"==typeof this._flush?this._flush((function(e,n){c(t,e,n)})):c(this,null,null)}function c(t,e,n){if(e)return t.emit("error",e);if(null!=n&&t.push(n),t._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(t._transformState.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}i.inherits=n(37),i.inherits(a,r),a.prototype.push=function(t,e){return this._transformState.needTransform=!1,r.prototype.push.call(this,t,e)},a.prototype._transform=function(t,e,n){throw new Error("_transform() is not implemented")},a.prototype._write=function(t,e,n){var r=this._transformState;if(r.writecb=n,r.writechunk=t,r.writeencoding=e,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},a.prototype._read=function(t){var e=this._transformState;null!==e.writechunk&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0},a.prototype._destroy=function(t,e){var n=this;r.prototype._destroy.call(this,t,(function(t){e(t),n.emit("close")}))}},function(t,e,n){var r=n(37),i=n(253),o=n(230).Buffer,a=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],s=new Array(64);function c(){this.init(),this._w=s,i.call(this,64,56)}function u(t,e,n){return n^t&(e^n)}function l(t,e,n){return t&e|n&(t|e)}function h(t){return(t>>>2|t<<30)^(t>>>13|t<<19)^(t>>>22|t<<10)}function f(t){return(t>>>6|t<<26)^(t>>>11|t<<21)^(t>>>25|t<<7)}function p(t){return(t>>>7|t<<25)^(t>>>18|t<<14)^t>>>3}r(c,i),c.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},c.prototype._update=function(t){for(var e,n=this._w,r=0|this._a,i=0|this._b,o=0|this._c,s=0|this._d,c=0|this._e,d=0|this._f,y=0|this._g,m=0|this._h,v=0;v<16;++v)n[v]=t.readInt32BE(4*v);for(;v<64;++v)n[v]=0|(((e=n[v-2])>>>17|e<<15)^(e>>>19|e<<13)^e>>>10)+n[v-7]+p(n[v-15])+n[v-16];for(var g=0;g<64;++g){var b=m+f(c)+u(c,d,y)+a[g]+n[g]|0,w=h(r)+l(r,i,o)|0;m=y,y=d,d=c,c=s+b|0,s=o,o=i,i=r,r=b+w|0}this._a=r+this._a|0,this._b=i+this._b|0,this._c=o+this._c|0,this._d=s+this._d|0,this._e=c+this._e|0,this._f=d+this._f|0,this._g=y+this._g|0,this._h=m+this._h|0},c.prototype._hash=function(){var t=o.allocUnsafe(32);return t.writeInt32BE(this._a,0),t.writeInt32BE(this._b,4),t.writeInt32BE(this._c,8),t.writeInt32BE(this._d,12),t.writeInt32BE(this._e,16),t.writeInt32BE(this._f,20),t.writeInt32BE(this._g,24),t.writeInt32BE(this._h,28),t},t.exports=c},function(t,e,n){var r=n(37),i=n(253),o=n(230).Buffer,a=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],s=new Array(160);function c(){this.init(),this._w=s,i.call(this,128,112)}function u(t,e,n){return n^t&(e^n)}function l(t,e,n){return t&e|n&(t|e)}function h(t,e){return(t>>>28|e<<4)^(e>>>2|t<<30)^(e>>>7|t<<25)}function f(t,e){return(t>>>14|e<<18)^(t>>>18|e<<14)^(e>>>9|t<<23)}function p(t,e){return(t>>>1|e<<31)^(t>>>8|e<<24)^t>>>7}function d(t,e){return(t>>>1|e<<31)^(t>>>8|e<<24)^(t>>>7|e<<25)}function y(t,e){return(t>>>19|e<<13)^(e>>>29|t<<3)^t>>>6}function m(t,e){return(t>>>19|e<<13)^(e>>>29|t<<3)^(t>>>6|e<<26)}function v(t,e){return t>>>0<e>>>0?1:0}r(c,i),c.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},c.prototype._update=function(t){for(var e=this._w,n=0|this._ah,r=0|this._bh,i=0|this._ch,o=0|this._dh,s=0|this._eh,c=0|this._fh,g=0|this._gh,b=0|this._hh,w=0|this._al,_=0|this._bl,x=0|this._cl,S=0|this._dl,T=0|this._el,M=0|this._fl,E=0|this._gl,P=0|this._hl,O=0;O<32;O+=2)e[O]=t.readInt32BE(4*O),e[O+1]=t.readInt32BE(4*O+4);for(;O<160;O+=2){var A=e[O-30],D=e[O-30+1],R=p(A,D),C=d(D,A),I=y(A=e[O-4],D=e[O-4+1]),k=m(D,A),L=e[O-14],N=e[O-14+1],j=e[O-32],B=e[O-32+1],F=C+N|0,U=R+L+v(F,C)|0;U=(U=U+I+v(F=F+k|0,k)|0)+j+v(F=F+B|0,B)|0,e[O]=U,e[O+1]=F}for(var z=0;z<160;z+=2){U=e[z],F=e[z+1];var G=l(n,r,i),H=l(w,_,x),V=h(n,w),W=h(w,n),q=f(s,T),Y=f(T,s),J=a[z],X=a[z+1],K=u(s,c,g),Q=u(T,M,E),Z=P+Y|0,$=b+q+v(Z,P)|0;$=($=($=$+K+v(Z=Z+Q|0,Q)|0)+J+v(Z=Z+X|0,X)|0)+U+v(Z=Z+F|0,F)|0;var tt=W+H|0,et=V+G+v(tt,W)|0;b=g,P=E,g=c,E=M,c=s,M=T,s=o+$+v(T=S+Z|0,S)|0,o=i,S=x,i=r,x=_,r=n,_=w,n=$+et+v(w=Z+tt|0,Z)|0}this._al=this._al+w|0,this._bl=this._bl+_|0,this._cl=this._cl+x|0,this._dl=this._dl+S|0,this._el=this._el+T|0,this._fl=this._fl+M|0,this._gl=this._gl+E|0,this._hl=this._hl+P|0,this._ah=this._ah+n+v(this._al,w)|0,this._bh=this._bh+r+v(this._bl,_)|0,this._ch=this._ch+i+v(this._cl,x)|0,this._dh=this._dh+o+v(this._dl,S)|0,this._eh=this._eh+s+v(this._el,T)|0,this._fh=this._fh+c+v(this._fl,M)|0,this._gh=this._gh+g+v(this._gl,E)|0,this._hh=this._hh+b+v(this._hl,P)|0},c.prototype._hash=function(){var t=o.allocUnsafe(64);function e(e,n,r){t.writeInt32BE(e,r),t.writeInt32BE(n,r+4)}return e(this._ah,this._al,0),e(this._bh,this._bl,8),e(this._ch,this._cl,16),e(this._dh,this._dl,24),e(this._eh,this._el,32),e(this._fh,this._fl,40),e(this._gh,this._gl,48),e(this._hh,this._hl,56),t},t.exports=c},function(t,e,n){"use strict";var r=n(37),i=n(723),o=n(206),a=n(507).Buffer,s=n(508),c=n(395),u=n(396),l=a.alloc(128);function h(t,e){o.call(this,"digest"),"string"==typeof e&&(e=a.from(e));var n="sha512"===t||"sha384"===t?128:64;(this._alg=t,this._key=e,e.length>n)?e=("rmd160"===t?new c:u(t)).update(e).digest():e.length<n&&(e=a.concat([e,l],n));for(var r=this._ipad=a.allocUnsafe(n),i=this._opad=a.allocUnsafe(n),s=0;s<n;s++)r[s]=54^e[s],i[s]=92^e[s];this._hash="rmd160"===t?new c:u(t),this._hash.update(r)}r(h,o),h.prototype._update=function(t){this._hash.update(t)},h.prototype._final=function(){var t=this._hash.digest();return("rmd160"===this._alg?new c:u(this._alg)).update(this._opad).update(t).digest()},t.exports=function(t,e){return"rmd160"===(t=t.toLowerCase())||"ripemd160"===t?new h("rmd160",e):"md5"===t?new i(s,e):new h(t,e)}},function(t,e,n){t.exports=n(59)},function(t,e,n){var r=n(390);t.exports=function(t){return(new r).update(t).digest()}},function(t){t.exports=JSON.parse('{"sha224WithRSAEncryption":{"sign":"rsa","hash":"sha224","id":"302d300d06096086480165030402040500041c"},"RSA-SHA224":{"sign":"ecdsa/rsa","hash":"sha224","id":"302d300d06096086480165030402040500041c"},"sha256WithRSAEncryption":{"sign":"rsa","hash":"sha256","id":"3031300d060960864801650304020105000420"},"RSA-SHA256":{"sign":"ecdsa/rsa","hash":"sha256","id":"3031300d060960864801650304020105000420"},"sha384WithRSAEncryption":{"sign":"rsa","hash":"sha384","id":"3041300d060960864801650304020205000430"},"RSA-SHA384":{"sign":"ecdsa/rsa","hash":"sha384","id":"3041300d060960864801650304020205000430"},"sha512WithRSAEncryption":{"sign":"rsa","hash":"sha512","id":"3051300d060960864801650304020305000440"},"RSA-SHA512":{"sign":"ecdsa/rsa","hash":"sha512","id":"3051300d060960864801650304020305000440"},"RSA-SHA1":{"sign":"rsa","hash":"sha1","id":"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{"sign":"ecdsa","hash":"sha1","id":""},"sha256":{"sign":"ecdsa","hash":"sha256","id":""},"sha224":{"sign":"ecdsa","hash":"sha224","id":""},"sha384":{"sign":"ecdsa","hash":"sha384","id":""},"sha512":{"sign":"ecdsa","hash":"sha512","id":""},"DSA-SHA":{"sign":"dsa","hash":"sha1","id":""},"DSA-SHA1":{"sign":"dsa","hash":"sha1","id":""},"DSA":{"sign":"dsa","hash":"sha1","id":""},"DSA-WITH-SHA224":{"sign":"dsa","hash":"sha224","id":""},"DSA-SHA224":{"sign":"dsa","hash":"sha224","id":""},"DSA-WITH-SHA256":{"sign":"dsa","hash":"sha256","id":""},"DSA-SHA256":{"sign":"dsa","hash":"sha256","id":""},"DSA-WITH-SHA384":{"sign":"dsa","hash":"sha384","id":""},"DSA-SHA384":{"sign":"dsa","hash":"sha384","id":""},"DSA-WITH-SHA512":{"sign":"dsa","hash":"sha512","id":""},"DSA-SHA512":{"sign":"dsa","hash":"sha512","id":""},"DSA-RIPEMD160":{"sign":"dsa","hash":"rmd160","id":""},"ripemd160WithRSA":{"sign":"rsa","hash":"rmd160","id":"3021300906052b2403020105000414"},"RSA-RIPEMD160":{"sign":"rsa","hash":"rmd160","id":"3021300906052b2403020105000414"},"md5WithRSAEncryption":{"sign":"rsa","hash":"md5","id":"3020300c06082a864886f70d020505000410"},"RSA-MD5":{"sign":"rsa","hash":"md5","id":"3020300c06082a864886f70d020505000410"}}')},function(t,e,n){e.pbkdf2=n(725),e.pbkdf2Sync=n(513)},function(t,e,n){(function(e){var n=Math.pow(2,30)-1;function r(t,n){if("string"!=typeof t&&!e.isBuffer(t))throw new TypeError(n+" must be a buffer or string")}t.exports=function(t,e,i,o){if(r(t,"Password"),r(e,"Salt"),"number"!=typeof i)throw new TypeError("Iterations not a number");if(i<0)throw new TypeError("Bad iterations");if("number"!=typeof o)throw new TypeError("Key length not a number");if(o<0||o>n||o!=o)throw new TypeError("Bad key length")}}).call(this,n(59).Buffer)},function(t,e,n){(function(e){var n;e.browser?n="utf-8":n=parseInt(e.version.split(".")[0].slice(1),10)>=6?"utf-8":"binary";t.exports=n}).call(this,n(169))},function(t,e,n){var r=n(508),i=n(395),o=n(396),a=n(511),s=n(512),c=n(514).Buffer,u=c.alloc(128),l={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function h(t,e,n){var a=function(t){function e(e){return o(t).update(e).digest()}return"rmd160"===t||"ripemd160"===t?i:"md5"===t?r:e}(t),s="sha512"===t||"sha384"===t?128:64;e.length>s?e=a(e):e.length<s&&(e=c.concat([e,u],s));for(var h=c.allocUnsafe(s+l[t]),f=c.allocUnsafe(s+l[t]),p=0;p<s;p++)h[p]=54^e[p],f[p]=92^e[p];var d=c.allocUnsafe(s+n+4);h.copy(d,0,0,s),this.ipad1=d,this.ipad2=h,this.opad=f,this.alg=t,this.blocksize=s,this.hash=a,this.size=l[t]}h.prototype.run=function(t,e){return t.copy(e,this.blocksize),this.hash(e).copy(this.opad,this.blocksize),this.hash(this.opad)},t.exports=function(t,e,n,r,i){a(t,e,n,r),c.isBuffer(t)||(t=c.from(t,s)),c.isBuffer(e)||(e=c.from(e,s));var o=new h(i=i||"sha1",t,e.length),u=c.allocUnsafe(r),f=c.allocUnsafe(e.length+4);e.copy(f,0,0,e.length);for(var p=0,d=l[i],y=Math.ceil(r/d),m=1;m<=y;m++){f.writeUInt32BE(m,e.length);for(var v=o.run(f,o.ipad1),g=v,b=1;b<n;b++){g=o.run(g,o.ipad2);for(var w=0;w<d;w++)v[w]^=g[w]}v.copy(u,p),p+=d}return u}},function(t,e,n){t.exports=n(59)},function(t,e,n){var r=n(291),i=n(170).Buffer,o=n(516);function a(t){var e=t._cipher.encryptBlockRaw(t._prev);return o(t._prev),e}e.encrypt=function(t,e){var n=Math.ceil(e.length/16),o=t._cache.length;t._cache=i.concat([t._cache,i.allocUnsafe(16*n)]);for(var s=0;s<n;s++){var c=a(t),u=o+16*s;t._cache.writeUInt32BE(c[0],u+0),t._cache.writeUInt32BE(c[1],u+4),t._cache.writeUInt32BE(c[2],u+8),t._cache.writeUInt32BE(c[3],u+12)}var l=t._cache.slice(0,e.length);return t._cache=t._cache.slice(e.length),r(e,l)}},function(t,e){t.exports=function(t){for(var e,n=t.length;n--;){if(255!==(e=t.readUInt8(n))){e++,t.writeUInt8(e,n);break}t.writeUInt8(0,n)}}},function(t){t.exports=JSON.parse('{"aes-128-ecb":{"cipher":"AES","key":128,"iv":0,"mode":"ECB","type":"block"},"aes-192-ecb":{"cipher":"AES","key":192,"iv":0,"mode":"ECB","type":"block"},"aes-256-ecb":{"cipher":"AES","key":256,"iv":0,"mode":"ECB","type":"block"},"aes-128-cbc":{"cipher":"AES","key":128,"iv":16,"mode":"CBC","type":"block"},"aes-192-cbc":{"cipher":"AES","key":192,"iv":16,"mode":"CBC","type":"block"},"aes-256-cbc":{"cipher":"AES","key":256,"iv":16,"mode":"CBC","type":"block"},"aes128":{"cipher":"AES","key":128,"iv":16,"mode":"CBC","type":"block"},"aes192":{"cipher":"AES","key":192,"iv":16,"mode":"CBC","type":"block"},"aes256":{"cipher":"AES","key":256,"iv":16,"mode":"CBC","type":"block"},"aes-128-cfb":{"cipher":"AES","key":128,"iv":16,"mode":"CFB","type":"stream"},"aes-192-cfb":{"cipher":"AES","key":192,"iv":16,"mode":"CFB","type":"stream"},"aes-256-cfb":{"cipher":"AES","key":256,"iv":16,"mode":"CFB","type":"stream"},"aes-128-cfb8":{"cipher":"AES","key":128,"iv":16,"mode":"CFB8","type":"stream"},"aes-192-cfb8":{"cipher":"AES","key":192,"iv":16,"mode":"CFB8","type":"stream"},"aes-256-cfb8":{"cipher":"AES","key":256,"iv":16,"mode":"CFB8","type":"stream"},"aes-128-cfb1":{"cipher":"AES","key":128,"iv":16,"mode":"CFB1","type":"stream"},"aes-192-cfb1":{"cipher":"AES","key":192,"iv":16,"mode":"CFB1","type":"stream"},"aes-256-cfb1":{"cipher":"AES","key":256,"iv":16,"mode":"CFB1","type":"stream"},"aes-128-ofb":{"cipher":"AES","key":128,"iv":16,"mode":"OFB","type":"stream"},"aes-192-ofb":{"cipher":"AES","key":192,"iv":16,"mode":"OFB","type":"stream"},"aes-256-ofb":{"cipher":"AES","key":256,"iv":16,"mode":"OFB","type":"stream"},"aes-128-ctr":{"cipher":"AES","key":128,"iv":16,"mode":"CTR","type":"stream"},"aes-192-ctr":{"cipher":"AES","key":192,"iv":16,"mode":"CTR","type":"stream"},"aes-256-ctr":{"cipher":"AES","key":256,"iv":16,"mode":"CTR","type":"stream"},"aes-128-gcm":{"cipher":"AES","key":128,"iv":12,"mode":"GCM","type":"auth"},"aes-192-gcm":{"cipher":"AES","key":192,"iv":12,"mode":"GCM","type":"auth"},"aes-256-gcm":{"cipher":"AES","key":256,"iv":12,"mode":"GCM","type":"auth"}}')},function(t,e,n){var r=n(337),i=n(170).Buffer,o=n(206),a=n(37),s=n(740),c=n(291),u=n(516);function l(t,e,n,a){o.call(this);var c=i.alloc(4,0);this._cipher=new r.AES(e);var l=this._cipher.encryptBlock(c);this._ghash=new s(l),n=function(t,e,n){if(12===e.length)return t._finID=i.concat([e,i.from([0,0,0,1])]),i.concat([e,i.from([0,0,0,2])]);var r=new s(n),o=e.length,a=o%16;r.update(e),a&&(a=16-a,r.update(i.alloc(a,0))),r.update(i.alloc(8,0));var c=8*o,l=i.alloc(8);l.writeUIntBE(c,0,8),r.update(l),t._finID=r.state;var h=i.from(t._finID);return u(h),h}(this,n,l),this._prev=i.from(n),this._cache=i.allocUnsafe(0),this._secCache=i.allocUnsafe(0),this._decrypt=a,this._alen=0,this._len=0,this._mode=t,this._authTag=null,this._called=!1}a(l,o),l.prototype._update=function(t){if(!this._called&&this._alen){var e=16-this._alen%16;e<16&&(e=i.alloc(e,0),this._ghash.update(e))}this._called=!0;var n=this._mode.encrypt(this,t);return this._decrypt?this._ghash.update(t):this._ghash.update(n),this._len+=t.length,n},l.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var t=c(this._ghash.final(8*this._alen,8*this._len),this._cipher.encryptBlock(this._finID));if(this._decrypt&&function(t,e){var n=0;t.length!==e.length&&n++;for(var r=Math.min(t.length,e.length),i=0;i<r;++i)n+=t[i]^e[i];return n}(t,this._authTag))throw new Error("Unsupported state or unable to authenticate data");this._authTag=t,this._cipher.scrub()},l.prototype.getAuthTag=function(){if(this._decrypt||!i.isBuffer(this._authTag))throw new Error("Attempting to get auth tag in unsupported state");return this._authTag},l.prototype.setAuthTag=function(t){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=t},l.prototype.setAAD=function(t){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(t),this._alen+=t.length},t.exports=l},function(t,e,n){var r=n(337),i=n(170).Buffer,o=n(206);function a(t,e,n,a){o.call(this),this._cipher=new r.AES(e),this._prev=i.from(n),this._cache=i.allocUnsafe(0),this._secCache=i.allocUnsafe(0),this._decrypt=a,this._mode=t}n(37)(a,o),a.prototype._update=function(t){return this._mode.encrypt(this,t,this._decrypt)},a.prototype._final=function(){this._cipher.scrub()},t.exports=a},function(t,e,n){var r=n(252);t.exports=g,g.simpleSieve=m,g.fermatTest=v;var i=n(95),o=new i(24),a=new(n(521)),s=new i(1),c=new i(2),u=new i(5),l=(new i(16),new i(8),new i(10)),h=new i(3),f=(new i(7),new i(11)),p=new i(4),d=(new i(12),null);function y(){if(null!==d)return d;var t=[];t[0]=2;for(var e=1,n=3;n<1048576;n+=2){for(var r=Math.ceil(Math.sqrt(n)),i=0;i<e&&t[i]<=r&&n%t[i]!=0;i++);e!==i&&t[i]<=r||(t[e++]=n)}return d=t,t}function m(t){for(var e=y(),n=0;n<e.length;n++)if(0===t.modn(e[n]))return 0===t.cmpn(e[n]);return!0}function v(t){var e=i.mont(t);return 0===c.toRed(e).redPow(t.subn(1)).fromRed().cmpn(1)}function g(t,e){if(t<16)return new i(2===e||5===e?[140,123]:[140,39]);var n,d;for(e=new i(e);;){for(n=new i(r(Math.ceil(t/8)));n.bitLength()>t;)n.ishrn(1);if(n.isEven()&&n.iadd(s),n.testn(1)||n.iadd(c),e.cmp(c)){if(!e.cmp(u))for(;n.mod(l).cmp(h);)n.iadd(p)}else for(;n.mod(o).cmp(f);)n.iadd(p);if(m(d=n.shrn(1))&&m(n)&&v(d)&&v(n)&&a.test(d)&&a.test(n))return n}}},function(t,e,n){var r=n(95),i=n(522);function o(t){this.rand=t||new i.Rand}t.exports=o,o.create=function(t){return new o(t)},o.prototype._randbelow=function(t){var e=t.bitLength(),n=Math.ceil(e/8);do{var i=new r(this.rand.generate(n))}while(i.cmp(t)>=0);return i},o.prototype._randrange=function(t,e){var n=e.sub(t);return t.add(this._randbelow(n))},o.prototype.test=function(t,e,n){var i=t.bitLength(),o=r.mont(t),a=new r(1).toRed(o);e||(e=Math.max(1,i/48|0));for(var s=t.subn(1),c=0;!s.testn(c);c++);for(var u=t.shrn(c),l=s.toRed(o);e>0;e--){var h=this._randrange(new r(2),s);n&&n(h);var f=h.toRed(o).redPow(u);if(0!==f.cmp(a)&&0!==f.cmp(l)){for(var p=1;p<c;p++){if(0===(f=f.redSqr()).cmp(a))return!1;if(0===f.cmp(l))break}if(p===c)return!1}}return!0},o.prototype.getDivisor=function(t,e){var n=t.bitLength(),i=r.mont(t),o=new r(1).toRed(i);e||(e=Math.max(1,n/48|0));for(var a=t.subn(1),s=0;!a.testn(s);s++);for(var c=t.shrn(s),u=a.toRed(i);e>0;e--){var l=this._randrange(new r(2),a),h=t.gcd(l);if(0!==h.cmpn(1))return h;var f=l.toRed(i).redPow(c);if(0!==f.cmp(o)&&0!==f.cmp(u)){for(var p=1;p<s;p++){if(0===(f=f.redSqr()).cmp(o))return f.fromRed().subn(1).gcd(t);if(0===f.cmp(u))break}if(p===s)return(f=f.redSqr()).fromRed().subn(1).gcd(t)}}return!1}},function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i;function o(t){this.rand=t}if(t.exports=function(t){return i||(i=new o(null)),i.generate(t)},t.exports.Rand=o,o.prototype.generate=function(t){return this._rand(t)},o.prototype._rand=function(t){if(this.rand.getBytes)return this.rand.getBytes(t);for(var e=new Uint8Array(t),n=0;n<e.length;n++)e[n]=this.rand.getByte();return e},"object"===("undefined"==typeof self?"undefined":r(self)))self.crypto&&self.crypto.getRandomValues?o.prototype._rand=function(t){var e=new Uint8Array(t);return self.crypto.getRandomValues(e),e}:self.msCrypto&&self.msCrypto.getRandomValues?o.prototype._rand=function(t){var e=new Uint8Array(t);return self.msCrypto.getRandomValues(e),e}:"object"===("undefined"==typeof window?"undefined":r(window))&&(o.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var a=n(745);if("function"!=typeof a.randomBytes)throw new Error("Not supported");o.prototype._rand=function(t){return a.randomBytes(t)}}catch(t){}},function(t,e,n){"use strict";var r=e;function i(t){return 1===t.length?"0"+t:t}function o(t){for(var e="",n=0;n<t.length;n++)e+=i(t[n].toString(16));return e}r.toArray=function(t,e){if(Array.isArray(t))return t.slice();if(!t)return[];var n=[];if("string"!=typeof t){for(var r=0;r<t.length;r++)n[r]=0|t[r];return n}if("hex"===e){(t=t.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(t="0"+t);for(r=0;r<t.length;r+=2)n.push(parseInt(t[r]+t[r+1],16))}else for(r=0;r<t.length;r++){var i=t.charCodeAt(r),o=i>>8,a=255&i;o?n.push(o,a):n.push(a)}return n},r.zero2=i,r.toHex=o,r.encode=function(t,e){return"hex"===e?o(t):t}},function(t,e,n){"use strict";var r=n(171).rotr32;function i(t,e,n){return t&e^~t&n}function o(t,e,n){return t&e^t&n^e&n}function a(t,e,n){return t^e^n}e.ft_1=function(t,e,n,r){return 0===t?i(e,n,r):1===t||3===t?a(e,n,r):2===t?o(e,n,r):void 0},e.ch32=i,e.maj32=o,e.p32=a,e.s0_256=function(t){return r(t,2)^r(t,13)^r(t,22)},e.s1_256=function(t){return r(t,6)^r(t,11)^r(t,25)},e.g0_256=function(t){return r(t,7)^r(t,18)^t>>>3},e.g1_256=function(t){return r(t,17)^r(t,19)^t>>>10}},function(t,e,n){"use strict";var r=n(171),i=n(292),o=n(524),a=n(145),s=r.sum32,c=r.sum32_4,u=r.sum32_5,l=o.ch32,h=o.maj32,f=o.s0_256,p=o.s1_256,d=o.g0_256,y=o.g1_256,m=i.BlockHash,v=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function g(){if(!(this instanceof g))return new g;m.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=v,this.W=new Array(64)}r.inherits(g,m),t.exports=g,g.blockSize=512,g.outSize=256,g.hmacStrength=192,g.padLength=64,g.prototype._update=function(t,e){for(var n=this.W,r=0;r<16;r++)n[r]=t[e+r];for(;r<n.length;r++)n[r]=c(y(n[r-2]),n[r-7],d(n[r-15]),n[r-16]);var i=this.h[0],o=this.h[1],m=this.h[2],v=this.h[3],g=this.h[4],b=this.h[5],w=this.h[6],_=this.h[7];for(a(this.k.length===n.length),r=0;r<n.length;r++){var x=u(_,p(g),l(g,b,w),this.k[r],n[r]),S=s(f(i),h(i,o,m));_=w,w=b,b=g,g=s(v,x),v=m,m=o,o=i,i=s(x,S)}this.h[0]=s(this.h[0],i),this.h[1]=s(this.h[1],o),this.h[2]=s(this.h[2],m),this.h[3]=s(this.h[3],v),this.h[4]=s(this.h[4],g),this.h[5]=s(this.h[5],b),this.h[6]=s(this.h[6],w),this.h[7]=s(this.h[7],_)},g.prototype._digest=function(t){return"hex"===t?r.toHex32(this.h,"big"):r.split32(this.h,"big")}},function(t,e,n){"use strict";var r=n(171),i=n(292),o=n(145),a=r.rotr64_hi,s=r.rotr64_lo,c=r.shr64_hi,u=r.shr64_lo,l=r.sum64,h=r.sum64_hi,f=r.sum64_lo,p=r.sum64_4_hi,d=r.sum64_4_lo,y=r.sum64_5_hi,m=r.sum64_5_lo,v=i.BlockHash,g=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function b(){if(!(this instanceof b))return new b;v.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=g,this.W=new Array(160)}function w(t,e,n,r,i){var o=t&n^~t&i;return o<0&&(o+=4294967296),o}function _(t,e,n,r,i,o){var a=e&r^~e&o;return a<0&&(a+=4294967296),a}function x(t,e,n,r,i){var o=t&n^t&i^n&i;return o<0&&(o+=4294967296),o}function S(t,e,n,r,i,o){var a=e&r^e&o^r&o;return a<0&&(a+=4294967296),a}function T(t,e){var n=a(t,e,28)^a(e,t,2)^a(e,t,7);return n<0&&(n+=4294967296),n}function M(t,e){var n=s(t,e,28)^s(e,t,2)^s(e,t,7);return n<0&&(n+=4294967296),n}function E(t,e){var n=a(t,e,14)^a(t,e,18)^a(e,t,9);return n<0&&(n+=4294967296),n}function P(t,e){var n=s(t,e,14)^s(t,e,18)^s(e,t,9);return n<0&&(n+=4294967296),n}function O(t,e){var n=a(t,e,1)^a(t,e,8)^c(t,e,7);return n<0&&(n+=4294967296),n}function A(t,e){var n=s(t,e,1)^s(t,e,8)^u(t,e,7);return n<0&&(n+=4294967296),n}function D(t,e){var n=a(t,e,19)^a(e,t,29)^c(t,e,6);return n<0&&(n+=4294967296),n}function R(t,e){var n=s(t,e,19)^s(e,t,29)^u(t,e,6);return n<0&&(n+=4294967296),n}r.inherits(b,v),t.exports=b,b.blockSize=1024,b.outSize=512,b.hmacStrength=192,b.padLength=128,b.prototype._prepareBlock=function(t,e){for(var n=this.W,r=0;r<32;r++)n[r]=t[e+r];for(;r<n.length;r+=2){var i=D(n[r-4],n[r-3]),o=R(n[r-4],n[r-3]),a=n[r-14],s=n[r-13],c=O(n[r-30],n[r-29]),u=A(n[r-30],n[r-29]),l=n[r-32],h=n[r-31];n[r]=p(i,o,a,s,c,u,l,h),n[r+1]=d(i,o,a,s,c,u,l,h)}},b.prototype._update=function(t,e){this._prepareBlock(t,e);var n=this.W,r=this.h[0],i=this.h[1],a=this.h[2],s=this.h[3],c=this.h[4],u=this.h[5],p=this.h[6],d=this.h[7],v=this.h[8],g=this.h[9],b=this.h[10],O=this.h[11],A=this.h[12],D=this.h[13],R=this.h[14],C=this.h[15];o(this.k.length===n.length);for(var I=0;I<n.length;I+=2){var k=R,L=C,N=E(v,g),j=P(v,g),B=w(v,g,b,O,A),F=_(v,g,b,O,A,D),U=this.k[I],z=this.k[I+1],G=n[I],H=n[I+1],V=y(k,L,N,j,B,F,U,z,G,H),W=m(k,L,N,j,B,F,U,z,G,H);k=T(r,i),L=M(r,i),N=x(r,i,a,s,c),j=S(r,i,a,s,c,u);var q=h(k,L,N,j),Y=f(k,L,N,j);R=A,C=D,A=b,D=O,b=v,O=g,v=h(p,d,V,W),g=f(d,d,V,W),p=c,d=u,c=a,u=s,a=r,s=i,r=h(V,W,q,Y),i=f(V,W,q,Y)}l(this.h,0,r,i),l(this.h,2,a,s),l(this.h,4,c,u),l(this.h,6,p,d),l(this.h,8,v,g),l(this.h,10,b,O),l(this.h,12,A,D),l(this.h,14,R,C)},b.prototype._digest=function(t){return"hex"===t?r.toHex32(this.h,"big"):r.split32(this.h,"big")}},function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(37),o=n(294).Reporter,a=n(59).Buffer;function s(t,e){o.call(this,e),a.isBuffer(t)?(this.base=t,this.offset=0,this.length=t.length):this.error("Input not Buffer")}function c(t,e){if(Array.isArray(t))this.length=0,this.value=t.map((function(t){return t instanceof c||(t=new c(t,e)),this.length+=t.length,t}),this);else if("number"==typeof t){if(!(0<=t&&t<=255))return e.error("non-byte EncoderBuffer value");this.value=t,this.length=1}else if("string"==typeof t)this.value=t,this.length=a.byteLength(t);else{if(!a.isBuffer(t))return e.error("Unsupported type: "+r(t));this.value=t,this.length=t.length}}i(s,o),e.DecoderBuffer=s,s.prototype.save=function(){return{offset:this.offset,reporter:o.prototype.save.call(this)}},s.prototype.restore=function(t){var e=new s(this.base);return e.offset=t.offset,e.length=this.offset,this.offset=t.offset,o.prototype.restore.call(this,t.reporter),e},s.prototype.isEmpty=function(){return this.offset===this.length},s.prototype.readUInt8=function(t){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(t||"DecoderBuffer overrun")},s.prototype.skip=function(t,e){if(!(this.offset+t<=this.length))return this.error(e||"DecoderBuffer overrun");var n=new s(this.base);return n._reporterState=this._reporterState,n.offset=this.offset,n.length=this.offset+t,this.offset+=t,n},s.prototype.raw=function(t){return this.base.slice(t?t.offset:this.offset,this.length)},e.EncoderBuffer=c,c.prototype.join=function(t,e){return t||(t=new a(this.length)),e||(e=0),0===this.length?t:(Array.isArray(this.value)?this.value.forEach((function(n){n.join(t,e),e+=n.length})):("number"==typeof this.value?t[e]=this.value:"string"==typeof this.value?t.write(this.value,e):a.isBuffer(this.value)&&this.value.copy(t,e),e+=this.length),t)}},function(t,e,n){var r=e;r._reverse=function(t){var e={};return Object.keys(t).forEach((function(n){(0|n)==n&&(n|=0);var r=t[n];e[r]=n})),e},r.der=n(776)},function(t,e,n){var r=n(37),i=n(293),o=i.base,a=i.bignum,s=i.constants.der;function c(t){this.enc="der",this.name=t.name,this.entity=t,this.tree=new u,this.tree._init(t.body)}function u(t){o.Node.call(this,"der",t)}function l(t,e){var n=t.readUInt8(e);if(t.isError(n))return n;var r=s.tagClass[n>>6],i=0==(32&n);if(31==(31&n)){var o=n;for(n=0;128==(128&o);){if(o=t.readUInt8(e),t.isError(o))return o;n<<=7,n|=127&o}}else n&=31;return{cls:r,primitive:i,tag:n,tagStr:s.tag[n]}}function h(t,e,n){var r=t.readUInt8(n);if(t.isError(r))return r;if(!e&&128===r)return null;if(0==(128&r))return r;var i=127&r;if(i>4)return t.error("length octect is too long");r=0;for(var o=0;o<i;o++){r<<=8;var a=t.readUInt8(n);if(t.isError(a))return a;r|=a}return r}t.exports=c,c.prototype.decode=function(t,e){return t instanceof o.DecoderBuffer||(t=new o.DecoderBuffer(t,e)),this.tree._decode(t,e)},r(u,o.Node),u.prototype._peekTag=function(t,e,n){if(t.isEmpty())return!1;var r=t.save(),i=l(t,'Failed to peek tag: "'+e+'"');return t.isError(i)?i:(t.restore(r),i.tag===e||i.tagStr===e||i.tagStr+"of"===e||n)},u.prototype._decodeTag=function(t,e,n){var r=l(t,'Failed to decode tag of "'+e+'"');if(t.isError(r))return r;var i=h(t,r.primitive,'Failed to get length of "'+e+'"');if(t.isError(i))return i;if(!n&&r.tag!==e&&r.tagStr!==e&&r.tagStr+"of"!==e)return t.error('Failed to match tag: "'+e+'"');if(r.primitive||null!==i)return t.skip(i,'Failed to match body of: "'+e+'"');var o=t.save(),a=this._skipUntilEnd(t,'Failed to skip indefinite length body: "'+this.tag+'"');return t.isError(a)?a:(i=t.offset-o.offset,t.restore(o),t.skip(i,'Failed to match body of: "'+e+'"'))},u.prototype._skipUntilEnd=function(t,e){for(;;){var n=l(t,e);if(t.isError(n))return n;var r,i=h(t,n.primitive,e);if(t.isError(i))return i;if(r=n.primitive||null!==i?t.skip(i):this._skipUntilEnd(t,e),t.isError(r))return r;if("end"===n.tagStr)break}},u.prototype._decodeList=function(t,e,n,r){for(var i=[];!t.isEmpty();){var o=this._peekTag(t,"end");if(t.isError(o))return o;var a=n.decode(t,"der",r);if(t.isError(a)&&o)break;i.push(a)}return i},u.prototype._decodeStr=function(t,e){if("bitstr"===e){var n=t.readUInt8();return t.isError(n)?n:{unused:n,data:t.raw()}}if("bmpstr"===e){var r=t.raw();if(r.length%2==1)return t.error("Decoding of string type: bmpstr length mismatch");for(var i="",o=0;o<r.length/2;o++)i+=String.fromCharCode(r.readUInt16BE(2*o));return i}if("numstr"===e){var a=t.raw().toString("ascii");return this._isNumstr(a)?a:t.error("Decoding of string type: numstr unsupported characters")}if("octstr"===e)return t.raw();if("objDesc"===e)return t.raw();if("printstr"===e){var s=t.raw().toString("ascii");return this._isPrintstr(s)?s:t.error("Decoding of string type: printstr unsupported characters")}return/str$/.test(e)?t.raw().toString():t.error("Decoding of string type: "+e+" unsupported")},u.prototype._decodeObjid=function(t,e,n){for(var r,i=[],o=0;!t.isEmpty();){var a=t.readUInt8();o<<=7,o|=127&a,0==(128&a)&&(i.push(o),o=0)}128&a&&i.push(o);var s=i[0]/40|0,c=i[0]%40;if(r=n?i:[s,c].concat(i.slice(1)),e){var u=e[r.join(" ")];void 0===u&&(u=e[r.join(".")]),void 0!==u&&(r=u)}return r},u.prototype._decodeTime=function(t,e){var n=t.raw().toString();if("gentime"===e)var r=0|n.slice(0,4),i=0|n.slice(4,6),o=0|n.slice(6,8),a=0|n.slice(8,10),s=0|n.slice(10,12),c=0|n.slice(12,14);else{if("utctime"!==e)return t.error("Decoding "+e+" time is not supported yet");r=0|n.slice(0,2),i=0|n.slice(2,4),o=0|n.slice(4,6),a=0|n.slice(6,8),s=0|n.slice(8,10),c=0|n.slice(10,12);r=r<70?2e3+r:1900+r}return Date.UTC(r,i-1,o,a,s,c,0)},u.prototype._decodeNull=function(t){return null},u.prototype._decodeBool=function(t){var e=t.readUInt8();return t.isError(e)?e:0!==e},u.prototype._decodeInt=function(t,e){var n=t.raw(),r=new a(n);return e&&(r=e[r.toString(10)]||r),r},u.prototype._use=function(t,e){return"function"==typeof t&&(t=t(e)),t._getDecoder("der").tree}},function(t,e,n){var r=n(37),i=n(59).Buffer,o=n(293),a=o.base,s=o.constants.der;function c(t){this.enc="der",this.name=t.name,this.entity=t,this.tree=new u,this.tree._init(t.body)}function u(t){a.Node.call(this,"der",t)}function l(t){return t<10?"0"+t:t}t.exports=c,c.prototype.encode=function(t,e){return this.tree._encode(t,e).join()},r(u,a.Node),u.prototype._encodeComposite=function(t,e,n,r){var o,a=function(t,e,n,r){var i;"seqof"===t?t="seq":"setof"===t&&(t="set");if(s.tagByName.hasOwnProperty(t))i=s.tagByName[t];else{if("number"!=typeof t||(0|t)!==t)return r.error("Unknown tag: "+t);i=t}if(i>=31)return r.error("Multi-octet tag encoding unsupported");e||(i|=32);return i|=s.tagClassByName[n||"universal"]<<6}(t,e,n,this.reporter);if(r.length<128)return(o=new i(2))[0]=a,o[1]=r.length,this._createEncoderBuffer([o,r]);for(var c=1,u=r.length;u>=256;u>>=8)c++;(o=new i(2+c))[0]=a,o[1]=128|c;u=1+c;for(var l=r.length;l>0;u--,l>>=8)o[u]=255&l;return this._createEncoderBuffer([o,r])},u.prototype._encodeStr=function(t,e){if("bitstr"===e)return this._createEncoderBuffer([0|t.unused,t.data]);if("bmpstr"===e){for(var n=new i(2*t.length),r=0;r<t.length;r++)n.writeUInt16BE(t.charCodeAt(r),2*r);return this._createEncoderBuffer(n)}return"numstr"===e?this._isNumstr(t)?this._createEncoderBuffer(t):this.reporter.error("Encoding of string type: numstr supports only digits and space"):"printstr"===e?this._isPrintstr(t)?this._createEncoderBuffer(t):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(e)?this._createEncoderBuffer(t):"objDesc"===e?this._createEncoderBuffer(t):this.reporter.error("Encoding of string type: "+e+" unsupported")},u.prototype._encodeObjid=function(t,e,n){if("string"==typeof t){if(!e)return this.reporter.error("string objid given, but no values map found");if(!e.hasOwnProperty(t))return this.reporter.error("objid not found in values map");t=e[t].split(/[\s\.]+/g);for(var r=0;r<t.length;r++)t[r]|=0}else if(Array.isArray(t)){t=t.slice();for(r=0;r<t.length;r++)t[r]|=0}if(!Array.isArray(t))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(t));if(!n){if(t[1]>=40)return this.reporter.error("Second objid identifier OOB");t.splice(0,2,40*t[0]+t[1])}var o=0;for(r=0;r<t.length;r++){var a=t[r];for(o++;a>=128;a>>=7)o++}var s=new i(o),c=s.length-1;for(r=t.length-1;r>=0;r--){a=t[r];for(s[c--]=127&a;(a>>=7)>0;)s[c--]=128|127&a}return this._createEncoderBuffer(s)},u.prototype._encodeTime=function(t,e){var n,r=new Date(t);return"gentime"===e?n=[l(r.getFullYear()),l(r.getUTCMonth()+1),l(r.getUTCDate()),l(r.getUTCHours()),l(r.getUTCMinutes()),l(r.getUTCSeconds()),"Z"].join(""):"utctime"===e?n=[l(r.getFullYear()%100),l(r.getUTCMonth()+1),l(r.getUTCDate()),l(r.getUTCHours()),l(r.getUTCMinutes()),l(r.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+e+" time is not supported yet"),this._encodeStr(n,"octstr")},u.prototype._encodeNull=function(){return this._createEncoderBuffer("")},u.prototype._encodeInt=function(t,e){if("string"==typeof t){if(!e)return this.reporter.error("String int or enum given, but no values map");if(!e.hasOwnProperty(t))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(t));t=e[t]}if("number"!=typeof t&&!i.isBuffer(t)){var n=t.toArray();!t.sign&&128&n[0]&&n.unshift(0),t=new i(n)}if(i.isBuffer(t)){var r=t.length;0===t.length&&r++;var o=new i(r);return t.copy(o),0===t.length&&(o[0]=0),this._createEncoderBuffer(o)}if(t<128)return this._createEncoderBuffer(t);if(t<256)return this._createEncoderBuffer([0,t]);r=1;for(var a=t;a>=256;a>>=8)r++;for(a=(o=new Array(r)).length-1;a>=0;a--)o[a]=255&t,t>>=8;return 128&o[0]&&o.unshift(0),this._createEncoderBuffer(new i(o))},u.prototype._encodeBool=function(t){return this._createEncoderBuffer(t?255:0)},u.prototype._use=function(t,e){return"function"==typeof t&&(t=t(e)),t._getEncoder("der").tree},u.prototype._skipDefault=function(t,e,n){var r,i=this._baseState;if(null===i.default)return!1;var o=t.join();if(void 0===i.defaultBuffer&&(i.defaultBuffer=this._encodeValue(i.default,e,n).join()),o.length!==i.defaultBuffer.length)return!1;for(r=0;r<o.length;r++)if(o[r]!==i.defaultBuffer[r])return!1;return!0}},function(t){t.exports=JSON.parse('{"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"}')},function(t,e,n){(function(e){var r=n(289);function i(t){var n=new e(4);return n.writeUInt32BE(t,0),n}t.exports=function(t,n){for(var o,a=new e(""),s=0;a.length<n;)o=i(s++),a=e.concat([a,r("sha1").update(t).update(o).digest()]);return a.slice(0,n)}}).call(this,n(59).Buffer)},function(t,e){t.exports=function(t,e){for(var n=t.length,r=-1;++r<n;)t[r]^=e[r];return t}},function(t,e,n){(function(e){var r=n(95);t.exports=function(t,n){return new e(t.toRed(r.mont(n.modulus)).redPow(new r(n.publicExponent)).fromRed().toArray())}}).call(this,n(59).Buffer)},function(t,e){},function(t,e,n){t.exports=n.p+"images/outlineBasic512.png"},function(t,e,n){t.exports=n.p+"images/outlineEnhanced512.png"},function(t,e){t.exports=function(t){switch(t){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},function(t,e,n){"use strict";var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;function a(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(t){r[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var n,s,c=a(t),u=1;u<arguments.length;u++){for(var l in n=Object(arguments[u]))i.call(n,l)&&(c[l]=n[l]);if(r){s=r(n);for(var h=0;h<s.length;h++)o.call(n,s[h])&&(c[s[h]]=n[s[h]])}}return c}},function(t,e){},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(827),o=n(829),a="function"==typeof Symbol&&"symbol"===r(Symbol()),s=Object.prototype.toString,c=Object.defineProperty&&function(){var t={};try{for(var e in Object.defineProperty(t,"x",{enumerable:!1,value:t}),t)return!1;return t.x===t}catch(t){return!1}}(),u=function(t,e,n,r){var i;e in t&&("function"!=typeof(i=r)||"[object Function]"!==s.call(i)||!r())||(c?Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:n,writable:!0}):t[e]=n)},l=function(t,e){var n=arguments.length>2?arguments[2]:{},r=i(e);a&&(r=r.concat(Object.getOwnPropertySymbols(e))),o(r,(function(r){u(t,r,e[r],n[r])}))};l.supportsDescriptors=!!c,t.exports=l},function(t,e,n){"use strict";var r=n(342),i=n(830),o=r.call(Function.call,String.prototype.replace),a=/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/,s=/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/;t.exports=function(){var t=i.ToString(i.CheckObjectCoercible(this));return o(o(t,a,""),s,"")}},function(t,e,n){"use strict";var r=n(542);t.exports=function(){return String.prototype.trim&&""==="".trim()?String.prototype.trim:r}},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e,n){"use strict";n.d(e,"a",(function(){return b})),n.d(e,"b",(function(){return w}));var r,i=n(5),o=n(281),a=n(10),s=n(311),c=n(343),u=n(376),l=n(0),h=n(7),f=n(32),p=n(551),d=n(2),y=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),m=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},v=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},g=new d.a("move-to-mode-command"),b=function(t){function e(e){var n=t.call(this)||this;return n.id="MOVE_TO_MODE",n.payload=e,n}return y(e,t),e.validateMoveToModeInput=function(t){if(!t)throw Error("Mode.moveTo -> no arguments provided -- mode is required");t.options||(t.options={});var n=t.mode;if(!Object(p.a)(f.b,t.mode))throw Error("Mode.moveTo -> "+t.mode+" is not a valid viewmode");if(n===f.b.TRANSITIONING)throw Error("Mode.moveTo -> "+t.mode+" is not a valid viewmode");t.options&&t.options.rotation&&(t.options.rotation.z=t.options.rotation.z||0);var r=e.validatePayloadOptions(t.options);return{mode:n,options:{transition:r.transition,position:r.position,rotation:r.rotation,zoom:r.zoom}}},e.validatePayloadOptions=function(t){var e,n,r,i;if(t){if(t.transition&&void 0===(r=Object(o.a)(t.transition)))throw Error("Mode.moveTo -> "+t.transition+" is not a valid transition style");t.rotation&&Object(u.e)(t.rotation)&&(e=Object(c.a)(t.rotation)),t.position&&Object(u.e)(t.position)&&(n=new l.Jc(t.position.x,t.position.y,t.position.z)),t.zoom&&!isNaN(t.zoom)&&(i=Object(h.e)(t.zoom,1,30))}return{rotation:e,position:n,transition:r,zoom:i}},e}(i.a),w=function(t,e,n){e.addBinding(b,(function(t){return m(void 0,void 0,void 0,(function(){var n,r,i,o;return v(this,(function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),t.options=t.options||{},n=a.a.Interpolate,void 0===(r=t.options.transition)||isNaN(r)||(n=r),[4,e.issueCommand(new f.a(t.mode,n,{position:t.options.position,rotation:t.options.rotation,zoom:t.options.zoom}))];case 1:return c.sent(),[2,t.mode];case 2:if(i=c.sent(),o=i instanceof s.a?"Mode.moveTo -> Cannot move to "+t.mode+" during a mode transition":"Mode.moveTo -> Could not move to "+t.mode,g.error(i,o),i instanceof s.a)throw Error("Mode.moveTo -> Cannot move to "+t.mode+" during a mode transition");throw Error("Mode.moveTo -> Could not move to "+t.mode);case 3:return[2]}}))}))})),n.addCommandToInterface({version:"3.x",namespace:"Mode",name:"moveTo",args:["mode","options"]},(function(t){return new b(b.validateMoveToModeInput(t))})),n.addEnumToInterface({version:"3.x",namespace:"Mode",name:"Mode",values:f.b}),n.addEnumToInterface({version:"3.x",namespace:"Mode",name:"TransitionType",values:o.b})}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},i=function(t,e){var n,i,o=Object.keys(t);try{for(var a=r(o),s=a.next();!s.done;s=a.next()){if(t[s.value]===e)return!0}}catch(t){n={error:t}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}return!1}},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r,i=n(5),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(){return(a=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},s=function(t){function e(e){var n=t.call(this)||this;return n.id="XR_PRESENT",n.payload=a({},e),n}return o(e,t),e}(i.a)},,function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=new Set;function i(){var t;do{t=Math.floor(1e6*Math.random())}while(r.has(t));return r.add(t),t}r.add(0)},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(9),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n){var r=t.call(this)||this;return r.x=e,r.y=n,r}return o(e,t),e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r,i=n(5),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(){return(a=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},s=function(t){function e(e){var n=t.call(this)||this;return n.name="screen-to-canvas-point",n.payload=a({},e),n}return o(e,t),e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(5),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n){var r=t.call(this)||this;return r.name="blur-canvas",r.payload={duration:e,pixelBlur:n},r}return o(e,t),e}(i.a)},function(t,e,n){"use strict";var r,i=n(9),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.urls=e,o.sid=n,o.vrSupported=r,o.sweepList=i,o}return o(e,t),e}(i.a);e.a=a},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(0),i=n(3),o={sharpTurnDotThreshold:.65,directionWeightFactorStd:.75,directionWeightFactorSharp:.2,positionalWeightFactorStd:.4,positionalWeightFactorSharp:.2,finalWalkingNodeDirectionWeight:5,lookAheadNodes:3},a=function(){function t(t){void 0===t&&(t=o),this.settings=t}return t.prototype.getOrientationsForPath=function(t,e){for(var n=[],o=0;o<t.length;o++){var a=new r.Jc;this.getLookVectorsForPathNode(t,o,e,a);var s=(new r.jb).lookAt(t[o],a,i.b.UP);n[o]=(new r.Pb).setFromRotationMatrix(s)}return n.push(e),n},t.prototype.getLookVectorsForPathNode=function(t,e,n,i){var o=new r.Jc,a=new r.Jc,s=new r.Jc,c=new r.Jc,u=t.length;if(e>=u)return!1;for(var l,h=1,f=1,p=new r.Jc,d=e;d<e+this.settings.lookAheadNodes&&d<u;d++){if(l=t[d],this.getOrientationForPathNode(t,d,n,s),d===e&&o.copy(s),d>e){var y=o.dot(s)<this.settings.sharpTurnDotThreshold;h*=y?this.settings.directionWeightFactorSharp:this.settings.directionWeightFactorStd,f*=y?this.settings.positionalWeightFactorSharp:this.settings.positionalWeightFactorStd}d===u-1&&(h=this.settings.finalWalkingNodeDirectionWeight,f=1),p.copy(s),s.multiplyScalar(h),a.add(s),c.lerp(l,f)}return a.normalize(),i.copy(c),i.add(a),!0},t.prototype.getOrientationForPathNode=function(t,e,n,r){if(e>=t.length)return!1;if(e===t.length-1)r.copy(i.b.FORWARD).applyQuaternion(n);else{var o=t[e],a=t[e+1];r.copy(a).sub(o)}return r.normalize(),!0},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(5),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e){var n=t.call(this)||this;return n.id="TOGGLE_PUCK_EDITING",n.payload={enabled:e},n}return o(e,t),e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return p})),n.d(e,"b",(function(){return d}));var r,i=n(5),o=n(107),a=n(0),s=n(18),c=n(65),u=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},h=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},f=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},p=function(t){function e(e){var n=t.call(this)||this;return n.id="MATTERTAG_DISC_POSITIONS",n.payload={tags:e},n}return u(e,t),e}(i.a),d=function(t,e,n){return l(void 0,void 0,void 0,(function(){var n=this;return h(this,(function(r){return Promise.all([t.market.waitForData(o.a),t.market.waitForData(s.a)]).then((function(t){var r=f(t,2),i=r[0],o=r[1],s=[],u={},d={},y=new a.Jc;e.addBinding(p,(function(t){return l(n,void 0,Promise,(function(){return h(this,(function(e){return s.length=0,t.tags.forEach((function(t){var e=i.getTag(t);e&&(d[t]||(d[t]=new a.Jc),d[t].copy(e.anchorPosition).add(e.stemVector),u[t]||(u[t]=new a.Ic),Object(c.g)(o,d[t],u[t],y),s.push({sid:t,screen:y.z>1?null:u[t],world:d[t]}))})),[2,s]}))}))}))})),[2]}))}))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(5),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e){var n=t.call(this)||this;return n.id="MATTERTAG_NAV_LINK",n.payload={chunk:e},n}return o(e,t),e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(r(arguments[e]));return t},o=function(t,e){var n;return void 0===e&&(e=250),function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];var a=function(){return t.apply.apply(t,i([null],r))};clearTimeout(n),n=window.setTimeout(a,e)}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(5),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e){var n=t.call(this)||this;return n.id="TOGGLE_PANO_MARKER",n.payload={enabled:e},n}return o(e,t),e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return l})),n.d(e,"b",(function(){return h}));var r,i=n(5),o=n(210),a=n(458),s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},u=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},l=function(t){function e(e){var n=t.call(this)||this;return n.id="SWITCH_APP",n.payload={app:e},n}return s(e,t),e}(i.a),h=function(t,e,n){t.getModule(o.default).then((function(t){e.addBinding(l,(function(e){return c(void 0,void 0,void 0,(function(){return u(this,(function(n){try{t.updateActiveApp(e.app)}catch(t){throw Error("Error: Can't switch application mode at this time")}return[2]}))}))}))})),n.addCommandToInterface({version:"3.x",namespace:"App",name:"switchApplication",args:["app"]},(function(t){var e=Object(a.d)(t.app);if(void 0===e)throw Error(t.app+" is not a valid application");return new l(e)}))}},,function(t,e,n){"use strict";var r=n(3),i=n(0),o=function(){function t(t,e,n){return this.thisType=t,this.container=e,this.mesh=n(),this.mesh.name=""+t.name,this.material=this.mesh.material,this.geometry=this.mesh.geometry,this}return t.prototype.opacity=function(t){return this.material.opacity=t,this},t}(),a=function(){function t(){this.animationInit=!1}return t.prototype.initAnimationMixin=function(t,e){this.animState={scale:e?e.clone():new i.Jc(1,1,1),position:t?t.clone():new i.Jc,target:{scale:e?e.clone():new i.Jc(1,1,1),position:t?t.clone():new i.Jc},temp:{pos:new i.Jc,scale:new i.Jc,makeScale:new i.Jc}},this.animationInit=!0},t.prototype.update=function(e,n){if(!this.animationInit)throw Error(t.name+" call this.initAnimationMixin() in "+this.style+" constructor to enable update, because I said so.");this.mesh.position.copy(e);var r=this.vector3From(n);return r.equals(this.mesh.scale)||this.mesh.scale.copy(r),this.animState.scale.copy(this.mesh.scale),this.animState.position.copy(this.mesh.position),this.mesh.updateMatrixWorld(!0),this},t.prototype.animate=function(e,n,r){if(!this.animationInit)throw Error(t.name+" call this.initAnimationMixin() in "+this.style+" constructor to enable animations, because I said so.");var i=this.vector3From(r);this.animState.target.scale.copy(i),this.animState.target.position.copy(n);var o=this.animState.temp.pos.copy(this.mesh.position).lerp(n,e),a=this.animState.temp.scale.copy(this.mesh.scale).lerp(i,e);return this.update(o,a),this},t.prototype.vector3From=function(t){if(t instanceof i.Jc)return this.animState.temp.makeScale.copy(t).clamp(s,c);if("number"==typeof t)return this.animState.temp.makeScale.set(t,t,t).clamp(s,c);throw Error("Unexpected scale input")},t}(),s=new i.Jc(.01,.01,.01),c=new i.Jc(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),u=function(){function t(){}return t.prototype.toggle=function(t){return t?this.container.add(this.mesh):this.container.remove(this.mesh),this.isVisible=t,this},t}();function l(t,e){e.forEach((function(e){Object.getOwnPropertyNames(e.prototype).forEach((function(n){t.prototype[n]=e.prototype[n]}))}))}var h,f=(h=function(t,e){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),p=function(t){function e(n,r){var o=t.call(this,e,n,(function(){return new i.lb(new i.oc(1),new i.mb(r))}))||this;return o.container=n,o.style="SphereMesh",o.radius=1,o.mesh.frustumCulled=!1,o.initAnimationMixin(),o}return f(e,t),e}(o);l(p,[u,a]);var d=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),y=function(t){function e(n,r){var o=t.call(this,e,n,(function(){return new i.lb(new i.k(1,1,1),new i.mb(r))}))||this;return o.container=n,o.style="Box",o.mesh.frustumCulled=!1,o.geometry.computeBoundingBox(),o.initAnimationMixin(),o}return d(e,t),e}(o);l(y,[a,u]);var m=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),v=function(t){function e(n,r){var o=t.call(this,e,n,(function(){var t=new i.i((new i.h).setFromCenterAndSize(new i.Jc,new i.Jc(1,1,1)));return new i.X(t.geometry,t.material)}))||this;return o.container=n,o.style="BoxWireframeMesh",r&&o.material.setValues(r),o.mesh.frustumCulled=!1,o.initAnimationMixin(),o}return m(e,t),e}(o);l(v,[u,a]);var g=n(166),b=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),w=function(){return(w=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},_=function(t){function e(n,r){var o=t.call(this,e,n,(function(){return new i.T(new i.m,new i.V(w({color:g.a.MP_BRAND,opacity:1,transparent:!0},r)))}))||this;return o.container=n,o.positionsBuffer=new i.l(new Float32Array(150),3),o.point=new i.Jc,o.points={start:new i.Jc,control:new i.Jc,end:new i.Jc},o.updatePoints=function(t,e,n){o.points.start.copy(o.curve.v0.copy(t)),o.points.control.copy(o.curve.v1.copy(e)),o.points.end.copy(o.curve.v2.copy(n));for(var r=0;r<50;r++){var i=r/49;o.curve.getPoint(i,o.point),o.positionsBuffer.setXYZ(r,o.point.x,o.point.y,o.point.z)}return o.positionsBuffer.needsUpdate=!0,o},o.animatePoints=function(t,e,n,r){var i=o.points,a=i.start,s=i.control,c=i.end;return a.equals(s)&&a.equals(c)?(o.updatePoints(e,n,r),o):(a.lerp(e,t),s.lerp(n,t),c.lerp(r,t),o.updatePoints(a,s,c),o)},o.mesh.frustumCulled=!1,o.curve=new i.Ob(new i.Jc,new i.Jc,new i.Jc),o.geometry.setAttribute("position",o.positionsBuffer),o.geometry.computeBoundingBox(),o}return b(e,t),e}(o);l(_,[u]);var x=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),S=function(t){function e(n,r){var o=t.call(this,e,n,(function(){return new i.p(r)}))||this;return o.container=n,o.style="CameraHelper",o.updateCamera(r),o}return x(e,t),e.prototype.updateCamera=function(t){return this.mesh.camera.copy(this.camWithSaneFarDistance(t)),this.mesh.update(),this},e.prototype.camWithSaneFarDistance=function(t){var e=t.clone();return e.far=5,e},e}(o);l(S,[u]);var T=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),M=function(t){function e(n,r){var o=t.call(this,e,n,(function(){return new i.lb(new i.Jb(1),new i.mb(r))}))||this;o.container=n,o.style="PlaneMesh",o.radius=1;var a=new i.jb;return a.makeRotationFromEuler(new i.A(-Math.PI/2,0,0,"XYZ")),o.geometry.applyMatrix4(a),o.mesh.frustumCulled=!1,o.initAnimationMixin(),o}return T(e,t),e}(o);l(M,[u,a]);var E,P,O=n(234),A=n(25),D=n(138),R=n(157),C=function(){return(C=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},I=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},k=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},L=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},N=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(L(arguments[e]));return t},j=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},B=function(){function t(t){var e,n,o,a,s=this;this.cache={},this.helperCache={},this.toggle=function(t){return s.options.scene&&(t?s.options.scene.add(s.options.container):s.options.scene.remove(s.options.container)),s},this.box=function(t,e){return s.cache[E.box][t]||(s.cache[E.box][t]=new y(s.options.container,e).toggle(!0)),s.cache[E.box][t]},this.boxWire=function(t,e){return s.cache[E.boxWire][t]||(s.cache[E.boxWire][t]=new v(s.options.container,e).toggle(!0)),s.cache[E.boxWire][t]},this.cam=function(t,e){return s.cache[E.cameraHelper][t]||(s.cache[E.cameraHelper][t]=new S(s.options.container,e).toggle(!0)),s.cache[E.cameraHelper][t]},this.label=function(t,e,n,r){if(void 0===r&&(r=.25),!s.cache[E.label][t]){var i=s.labelCreator.createLabel();s.cache[E.label][t]=i,i.position.copy(n),i.text=e,i.scaleFactor=r,s.options.container.add(i)}return s.cache[E.label][t]},this.line=function(t,e,n){if(void 0===e&&(e=s.options.lineColor),void 0===n&&(n=s.options.linewidth),!s.cache[E.line][t]){var o=D.default.makeLineMaterial("string"==typeof e?new i.s(e).getHex():e.getHex(),!1,{linewidth:n}),a={onShow:function(){var t;return(t=s.options.container).add.apply(t,N(c.children))},onHide:function(){var t;return(t=s.options.container).remove.apply(t,N(c.children))}},c=new R.b(r.b.ZERO.clone(),r.b.ZERO.clone(),o,a);c.updateResolution(window.innerWidth,window.innerHeight).opacity(1).toggle(!0),s.cache[E.line][t]=c}return s.cache[E.line][t]},this.plane=function(t,e){return s.cache[E.plane][t]||(s.cache[E.plane][t]=new M(s.options.container,e).toggle(!0)),s.cache[E.plane][t]},this.sphere=function(t,e){return s.cache[E.sphere][t]||(s.cache[E.sphere][t]=new p(s.options.container,e).toggle(!0)),s.cache[E.sphere][t]},this.spline=function(t,e){return s.cache[E.spline][t]||(s.cache[E.spline][t]=new _(s.options.container,e).toggle(!0)),s.cache[E.spline][t]},this.randomColor=function(t){if(void 0!==t){if(!s.helperCache[P.color][t]){var e=new i.s(F(),F(),F());s.helperCache[P.color][t]=e}return s.helperCache[P.color][t]}return new i.s(F(),F(),F())},this.randomVector3=function(t){if(void 0!==t){if(!s.helperCache[P.vector3][t]){var e=new i.Jc(2*(.5-F()),2*(.5-F()),2*(.5-F()));s.helperCache[P.vector3][t]=e}return s.helperCache[P.vector3][t]}return new i.Jc(2*(.5-F()),2*(.5-F()),2*(.5-F()))},this.toggleAll=function(t){var e,n,r,i;try{for(var o=j(Object.values(E)),a=o.next();!a.done;a=o.next()){var c=a.value,u=Object.values(s.cache[c]);try{for(var l=j(u),h=l.next();!h.done;h=l.next()){var f=h.value;"toggle"in f&&f.toggle(t)}}catch(t){r={error:t}}finally{try{h&&!h.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return s},this.options=C({},U,t);try{for(var c=j(Object.values(E)),u=c.next();!u.done;u=c.next()){var l=u.value;this.cache[l]={}}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(e)throw e.error}}try{for(var h=j(Object.values(P)),f=h.next();!f.done;f=h.next()){l=f.value;this.helperCache[l]={}}}catch(t){o={error:t}}finally{try{f&&!f.done&&(a=h.return)&&a.call(h)}finally{if(o)throw o.error}}var d=this.options,m=d.color,g=d.backgroundColor,b=d.backgroundOpacity,w=d.background;this.labelCreator=new O.a({color:m,background:w,backgroundColor:g,backgroundOpacity:b}),this.options.scene&&this.toggle(!0)}return t.prototype.addToScene=function(t){return I(this,void 0,void 0,(function(){var e;return k(this,(function(n){switch(n.label){case 0:return e=this.options,[4,t.getModule(A.default)];case 1:return e.scene=n.sent().getScene(),this.toggle(!0),[2,this]}}))}))},t}(),F=function(){return Math.random()},U={lineColor:"white",linewidth:2,color:"white",background:!0,backgroundColor:"white",backgroundOpacity:.5,container:new i.J};!function(t){t.box="box",t.boxWire="boxWire",t.label="label",t.line="line",t.plane="plane",t.sphere="sphere",t.spline="spline",t.cameraHelper="cameraHelper"}(E||(E={})),function(t){t.color="color",t.vector3="vector3"}(P||(P={})),n.d(e,"a",(function(){return B}))},function(t,e,n){var r=n(808),i=n(37),o=n(812),a=n(815),s=n(539),c=n(817),u=n(818),l=THREE.BufferGeometry;function h(t){l.call(this),"string"==typeof t&&(t={text:t}),this._opt=s({},t),t&&this.update(t)}t.exports=function(t){return new h(t)},i(h,l),h.prototype.update=function(t){if("string"==typeof t&&(t={text:t}),!(t=s({},this._opt,t)).font)throw new TypeError("must specify a { font } in options");this.layout=r(t);var e=!1!==t.flipY,n=t.font,i=n.common.scaleW,u=n.common.scaleH,l=this.layout.glyphs.filter((function(t){var e=t.data;return e.width*e.height>0}));this.visibleGlyphs=l;var h=c.positions(l),f=c.uvs(l,i,u,e),p=o({clockwise:!0,type:"uint16",count:l.length});if(a.index(this,p,1,"uint16"),a.attr(this,"position",h,2),a.attr(this,"uv",f,2),!t.multipage&&"page"in this.attributes)this.removeAttribute("page");else if(t.multipage){var d=c.pages(l);a.attr(this,"page",d,1)}},h.prototype.computeBoundingSphere=function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);var t=this.attributes.position.array,e=this.attributes.position.itemSize;if(!t||!e||t.length<2)return this.boundingSphere.radius=0,void this.boundingSphere.center.set(0,0,0);u.computeSphere(t,this.boundingSphere),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')},h.prototype.computeBoundingBox=function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);var t=this.boundingBox,e=this.attributes.position.array,n=this.attributes.position.itemSize;!e||!n||e.length<2?t.makeEmpty():u.computeBox(e,t)}},function(t,e,n){var r=n(539);t.exports=function(t){var e="number"==typeof(t=t||{}).opacity?t.opacity:1,n="number"==typeof t.alphaTest?t.alphaTest:1e-4,i=t.precision||"highp",o=t.color,a=t.map,s="boolean"!=typeof t.negate||t.negate;return delete t.map,delete t.color,delete t.precision,delete t.opacity,delete t.negate,r({uniforms:{opacity:{type:"f",value:e},map:{type:"t",value:a||new THREE.Texture},color:{type:"c",value:new THREE.Color(o)}},vertexShader:["attribute vec2 uv;","attribute vec4 position;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * position;","}"].join("\n"),fragmentShader:["#ifdef GL_OES_standard_derivatives","#extension GL_OES_standard_derivatives : enable","#endif","precision "+i+" float;","uniform float opacity;","uniform vec3 color;","uniform sampler2D map;","varying vec2 vUv;","float median(float r, float g, float b) {","  return max(min(r, g), min(max(r, g), b));","}","void main() {","  vec3 sample = "+(s?"1.0 - ":"")+"texture2D(map, vUv).rgb;","  float sigDist = median(sample.r, sample.g, sample.b) - 0.5;","  float alpha = clamp(sigDist/fwidth(sigDist) + 0.5, 0.0, 1.0);","  gl_FragColor = vec4(color.xyz, alpha * opacity);",0===n?"":"  if (gl_FragColor.a < "+n+") discard;","}"].join("\n")},t)}},function(t,e,n){t.exports=n.p+"images/Roboto-Bold.png"},function(t){t.exports=JSON.parse('{"pages":["Roboto-Bold.png"],"chars":[{"id":40,"width":24,"height":52,"xoffset":0,"yoffset":-33.140625,"xadvance":14.7451171875,"chnl":15,"x":0,"y":0,"page":0},{"id":41,"width":22,"height":52,"xoffset":0,"yoffset":-33.140625,"xadvance":14.806640625,"chnl":15,"x":0,"y":54,"page":0},{"id":93,"width":19,"height":52,"xoffset":0,"yoffset":-34.740234375,"xadvance":11.6689453125,"chnl":15,"x":0,"y":108,"page":0},{"id":91,"width":21,"height":52,"xoffset":0,"yoffset":-34.740234375,"xadvance":11.6689453125,"chnl":15,"x":0,"y":162,"page":0},{"id":106,"width":21,"height":50,"xoffset":0,"yoffset":-30.9873046875,"xadvance":10.91015625,"chnl":15,"x":0,"y":216,"page":0},{"id":125,"width":23,"height":50,"xoffset":0,"yoffset":-32.7509765625,"xadvance":13.86328125,"chnl":15,"x":0,"y":268,"page":0},{"id":123,"width":23,"height":50,"xoffset":0,"yoffset":-32.7509765625,"xadvance":13.86328125,"chnl":15,"x":0,"y":320,"page":0},{"id":36,"width":32,"height":49,"xoffset":0,"yoffset":-34.5966796875,"xadvance":24.0966796875,"chnl":15,"x":0,"y":372,"page":0},{"id":64,"width":46,"height":48,"xoffset":0,"yoffset":-29.0390625,"xadvance":37.5908203125,"chnl":15,"x":0,"y":423,"page":0},{"id":81,"width":37,"height":46,"xoffset":0,"yoffset":-30.26953125,"xadvance":28.998046875,"chnl":15,"x":48,"y":423,"page":0},{"id":87,"width":46,"height":40,"xoffset":0,"yoffset":-29.859375,"xadvance":36.7294921875,"chnl":15,"x":87,"y":423,"page":0},{"id":124,"width":17,"height":45,"xoffset":0,"yoffset":-29.859375,"xadvance":10.623046875,"chnl":15,"x":34,"y":372,"page":0},{"id":77,"width":44,"height":40,"xoffset":0,"yoffset":-29.859375,"xadvance":36.791015625,"chnl":15,"x":135,"y":423,"page":0},{"id":109,"width":44,"height":33,"xoffset":0,"yoffset":-22.599609375,"xadvance":36.3603515625,"chnl":15,"x":0,"y":473,"page":0},{"id":92,"width":29,"height":42,"xoffset":0,"yoffset":-29.859375,"xadvance":17.71875,"chnl":15,"x":53,"y":372,"page":0},{"id":98,"width":32,"height":42,"xoffset":0,"yoffset":-31.5,"xadvance":23.6455078125,"chnl":15,"x":84,"y":372,"page":0},{"id":96,"width":22,"height":42,"xoffset":0,"yoffset":-31.5,"xadvance":13.8837890625,"chnl":15,"x":118,"y":372,"page":0},{"id":107,"width":33,"height":42,"xoffset":0,"yoffset":-31.5,"xadvance":22.435546875,"chnl":15,"x":142,"y":372,"page":0},{"id":102,"width":25,"height":42,"xoffset":0,"yoffset":-31.9306640625,"xadvance":15.052734375,"chnl":15,"x":177,"y":372,"page":0},{"id":108,"width":19,"height":42,"xoffset":0,"yoffset":-31.5,"xadvance":11.1357421875,"chnl":15,"x":204,"y":372,"page":0},{"id":47,"width":25,"height":42,"xoffset":0,"yoffset":-29.859375,"xadvance":15.6884765625,"chnl":15,"x":225,"y":372,"page":0},{"id":34,"width":22,"height":42,"xoffset":0,"yoffset":-31.5,"xadvance":13.4736328125,"chnl":15,"x":252,"y":372,"page":0},{"id":104,"width":31,"height":42,"xoffset":0,"yoffset":-31.5,"xadvance":23.501953125,"chnl":15,"x":276,"y":372,"page":0},{"id":39,"width":16,"height":42,"xoffset":0,"yoffset":-31.5,"xadvance":6.7880859375,"chnl":15,"x":309,"y":372,"page":0},{"id":100,"width":31,"height":42,"xoffset":0,"yoffset":-31.5,"xadvance":23.666015625,"chnl":15,"x":327,"y":372,"page":0},{"id":48,"width":32,"height":41,"xoffset":0,"yoffset":-30.26953125,"xadvance":24.0966796875,"chnl":15,"x":360,"y":372,"page":0},{"id":103,"width":32,"height":41,"xoffset":0,"yoffset":-22.599609375,"xadvance":23.9736328125,"chnl":15,"x":394,"y":372,"page":0},{"id":105,"width":19,"height":41,"xoffset":0,"yoffset":-30.9873046875,"xadvance":11.1357421875,"chnl":15,"x":428,"y":372,"page":0},{"id":113,"width":31,"height":41,"xoffset":0,"yoffset":-22.599609375,"xadvance":23.7275390625,"chnl":15,"x":449,"y":372,"page":0},{"id":63,"width":29,"height":41,"xoffset":0,"yoffset":-30.26953125,"xadvance":20.8974609375,"chnl":15,"x":482,"y":372,"page":0},{"id":51,"width":32,"height":41,"xoffset":0,"yoffset":-30.26953125,"xadvance":24.0966796875,"chnl":15,"x":25,"y":320,"page":0},{"id":112,"width":32,"height":41,"xoffset":0,"yoffset":-22.599609375,"xadvance":23.6455078125,"chnl":15,"x":59,"y":320,"page":0},{"id":79,"width":37,"height":41,"xoffset":0,"yoffset":-30.26953125,"xadvance":28.998046875,"chnl":15,"x":93,"y":320,"page":0},{"id":67,"width":36,"height":41,"xoffset":0,"yoffset":-30.26953125,"xadvance":27.48046875,"chnl":15,"x":132,"y":320,"page":0},{"id":37,"width":39,"height":41,"xoffset":0,"yoffset":-30.2900390625,"xadvance":31.0078125,"chnl":15,"x":170,"y":320,"page":0},{"id":54,"width":33,"height":41,"xoffset":0,"yoffset":-30.1669921875,"xadvance":24.0966796875,"chnl":15,"x":211,"y":320,"page":0},{"id":38,"width":37,"height":41,"xoffset":0,"yoffset":-30.26953125,"xadvance":27.5625,"chnl":15,"x":246,"y":320,"page":0},{"id":71,"width":36,"height":41,"xoffset":0,"yoffset":-30.26953125,"xadvance":28.6083984375,"chnl":15,"x":285,"y":320,"page":0},{"id":56,"width":32,"height":41,"xoffset":0,"yoffset":-30.26953125,"xadvance":24.0966796875,"chnl":15,"x":323,"y":320,"page":0},{"id":83,"width":34,"height":41,"xoffset":0,"yoffset":-30.26953125,"xadvance":25.8193359375,"chnl":15,"x":357,"y":320,"page":0},{"id":57,"width":32,"height":41,"xoffset":0,"yoffset":-30.26953125,"xadvance":24.0966796875,"chnl":15,"x":393,"y":320,"page":0},{"id":121,"width":31,"height":41,"xoffset":0,"yoffset":-22.189453125,"xadvance":21.08203125,"chnl":15,"x":427,"y":320,"page":0},{"id":69,"width":33,"height":40,"xoffset":0,"yoffset":-29.859375,"xadvance":23.625,"chnl":15,"x":181,"y":423,"page":0},{"id":76,"width":32,"height":40,"xoffset":0,"yoffset":-29.859375,"xadvance":22.7431640625,"chnl":15,"x":216,"y":423,"page":0},{"id":78,"width":37,"height":40,"xoffset":0,"yoffset":-29.859375,"xadvance":29.654296875,"chnl":15,"x":250,"y":423,"page":0},{"id":33,"width":19,"height":40,"xoffset":0,"yoffset":-29.859375,"xadvance":11.4228515625,"chnl":15,"x":289,"y":423,"page":0},{"id":80,"width":36,"height":40,"xoffset":0,"yoffset":-29.859375,"xadvance":27.0908203125,"chnl":15,"x":310,"y":423,"page":0},{"id":74,"width":31,"height":40,"xoffset":0,"yoffset":-29.859375,"xadvance":23.4609375,"chnl":15,"x":348,"y":423,"page":0},{"id":82,"width":36,"height":40,"xoffset":0,"yoffset":-29.859375,"xadvance":26.8037109375,"chnl":15,"x":381,"y":423,"page":0},{"id":73,"width":19,"height":40,"xoffset":0,"yoffset":-29.859375,"xadvance":12.2431640625,"chnl":15,"x":419,"y":423,"page":0},{"id":84,"width":35,"height":40,"xoffset":0,"yoffset":-29.859375,"xadvance":25.9833984375,"chnl":15,"x":440,"y":423,"page":0},{"id":85,"width":35,"height":40,"xoffset":0,"yoffset":-29.859375,"xadvance":27.64453125,"chnl":15,"x":477,"y":423,"page":0},{"id":86,"width":37,"height":40,"xoffset":0,"yoffset":-29.859375,"xadvance":27.4599609375,"chnl":15,"x":460,"y":320,"page":0},{"id":72,"width":37,"height":40,"xoffset":0,"yoffset":-29.859375,"xadvance":29.6748046875,"chnl":15,"x":25,"y":268,"page":0},{"id":88,"width":36,"height":40,"xoffset":0,"yoffset":-29.859375,"xadvance":26.6806640625,"chnl":15,"x":64,"y":268,"page":0},{"id":89,"width":36,"height":40,"xoffset":0,"yoffset":-29.859375,"xadvance":25.962890625,"chnl":15,"x":102,"y":268,"page":0},{"id":90,"width":34,"height":40,"xoffset":0,"yoffset":-29.859375,"xadvance":25.4501953125,"chnl":15,"x":140,"y":268,"page":0},{"id":75,"width":37,"height":40,"xoffset":0,"yoffset":-29.859375,"xadvance":26.66015625,"chnl":15,"x":176,"y":268,"page":0},{"id":68,"width":35,"height":40,"xoffset":0,"yoffset":-29.859375,"xadvance":27.2958984375,"chnl":15,"x":215,"y":268,"page":0},{"id":66,"width":35,"height":40,"xoffset":0,"yoffset":-29.859375,"xadvance":26.8037109375,"chnl":15,"x":252,"y":268,"page":0},{"id":94,"width":27,"height":40,"xoffset":0,"yoffset":-29.859375,"xadvance":18.3544921875,"chnl":15,"x":289,"y":268,"page":0},{"id":65,"width":38,"height":40,"xoffset":0,"yoffset":-29.859375,"xadvance":28.259765625,"chnl":15,"x":318,"y":268,"page":0},{"id":35,"width":34,"height":40,"xoffset":0,"yoffset":-29.859375,"xadvance":25.01953125,"chnl":15,"x":358,"y":268,"page":0},{"id":119,"width":40,"height":32,"xoffset":0,"yoffset":-22.189453125,"xadvance":30.8642578125,"chnl":15,"x":46,"y":473,"page":0},{"id":59,"width":19,"height":40,"xoffset":0,"yoffset":-22.88671875,"xadvance":11.0126953125,"chnl":15,"x":394,"y":268,"page":0},{"id":55,"width":32,"height":40,"xoffset":0,"yoffset":-29.859375,"xadvance":24.0966796875,"chnl":15,"x":415,"y":268,"page":0},{"id":53,"width":32,"height":40,"xoffset":0,"yoffset":-29.859375,"xadvance":24.0966796875,"chnl":15,"x":449,"y":268,"page":0},{"id":52,"width":33,"height":40,"xoffset":0,"yoffset":-29.859375,"xadvance":24.0966796875,"chnl":15,"x":23,"y":216,"page":0},{"id":50,"width":32,"height":40,"xoffset":0,"yoffset":-30.26953125,"xadvance":24.0966796875,"chnl":15,"x":58,"y":216,"page":0},{"id":49,"width":26,"height":40,"xoffset":0,"yoffset":-29.900390625,"xadvance":24.0966796875,"chnl":15,"x":483,"y":268,"page":0},{"id":42,"width":29,"height":40,"xoffset":0,"yoffset":-29.859375,"xadvance":19.03125,"chnl":15,"x":92,"y":216,"page":0},{"id":70,"width":32,"height":40,"xoffset":0,"yoffset":-29.859375,"xadvance":23.009765625,"chnl":15,"x":123,"y":216,"page":0},{"id":116,"width":23,"height":38,"xoffset":0,"yoffset":-27.64453125,"xadvance":14.19140625,"chnl":15,"x":157,"y":216,"page":0},{"id":43,"width":32,"height":35,"xoffset":0,"yoffset":-24.732421875,"xadvance":22.927734375,"chnl":15,"x":182,"y":216,"page":0},{"id":126,"width":35,"height":27,"xoffset":0,"yoffset":-16.9599609375,"xadvance":27.234375,"chnl":15,"x":88,"y":473,"page":0},{"id":117,"width":31,"height":33,"xoffset":0,"yoffset":-22.189453125,"xadvance":23.501953125,"chnl":15,"x":216,"y":216,"page":0},{"id":101,"width":32,"height":33,"xoffset":0,"yoffset":-22.599609375,"xadvance":22.7021484375,"chnl":15,"x":249,"y":216,"page":0},{"id":97,"width":31,"height":33,"xoffset":0,"yoffset":-22.599609375,"xadvance":22.517578125,"chnl":15,"x":283,"y":216,"page":0},{"id":110,"width":31,"height":33,"xoffset":0,"yoffset":-22.599609375,"xadvance":23.5224609375,"chnl":15,"x":316,"y":216,"page":0},{"id":111,"width":32,"height":33,"xoffset":0,"yoffset":-22.599609375,"xadvance":23.748046875,"chnl":15,"x":349,"y":216,"page":0},{"id":58,"width":19,"height":33,"xoffset":0,"yoffset":-22.88671875,"xadvance":11.853515625,"chnl":15,"x":383,"y":216,"page":0},{"id":62,"width":30,"height":33,"xoffset":0,"yoffset":-22.599609375,"xadvance":21.697265625,"chnl":15,"x":404,"y":216,"page":0},{"id":114,"width":25,"height":33,"xoffset":0,"yoffset":-22.599609375,"xadvance":15.3193359375,"chnl":15,"x":436,"y":216,"page":0},{"id":115,"width":30,"height":33,"xoffset":0,"yoffset":-22.599609375,"xadvance":21.5947265625,"chnl":15,"x":463,"y":216,"page":0},{"id":60,"width":29,"height":33,"xoffset":0,"yoffset":-22.6201171875,"xadvance":21.369140625,"chnl":15,"x":23,"y":162,"page":0},{"id":99,"width":31,"height":33,"xoffset":0,"yoffset":-22.599609375,"xadvance":21.90234375,"chnl":15,"x":54,"y":162,"page":0},{"id":118,"width":31,"height":32,"xoffset":0,"yoffset":-22.189453125,"xadvance":21.2255859375,"chnl":15,"x":87,"y":162,"page":0},{"id":120,"width":31,"height":32,"xoffset":0,"yoffset":-22.189453125,"xadvance":21.369140625,"chnl":15,"x":120,"y":162,"page":0},{"id":122,"width":30,"height":32,"xoffset":0,"yoffset":-22.189453125,"xadvance":21.369140625,"chnl":15,"x":153,"y":162,"page":0},{"id":61,"width":31,"height":30,"xoffset":0,"yoffset":-20.138671875,"xadvance":24.03515625,"chnl":15,"x":185,"y":162,"page":0},{"id":95,"width":29,"height":15,"xoffset":0,"yoffset":0,"xadvance":18.744140625,"chnl":15,"x":125,"y":473,"page":0},{"id":45,"width":24,"height":25,"xoffset":0,"yoffset":-15.17578125,"xadvance":16.283203125,"chnl":15,"x":218,"y":162,"page":0},{"id":44,"width":18,"height":23,"xoffset":0,"yoffset":-5.044921875,"xadvance":10.25390625,"chnl":15,"x":244,"y":162,"page":0},{"id":46,"width":19,"height":16,"xoffset":0,"yoffset":-6.0908203125,"xadvance":12.2021484375,"chnl":15,"x":23,"y":197,"page":0},{"id":32,"width":0,"height":0,"xoffset":0,"yoffset":0,"xadvance":10.458984375,"chnl":15,"x":0,"y":508,"page":0}],"info":{"face":"Roboto Bold","size":42,"bold":0,"italic":0,"charset":[" ","!","\\"","#","$","%","&","\'","(",")","*","+",",","-",".","/","0","1","2","3","4","5","6","7","8","9",":",";","<","=",">","?","@","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","[","\\\\","]","^","_","`","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","{","|","}","~"],"unicode":1,"stretchH":100,"smooth":1,"aa":1,"padding":[0,0,0,0],"spacing":[2,2]},"common":{"lineHeight":44.091796875,"base":38.96484375,"scaleW":512,"scaleH":512,"pages":1,"packed":0,"alphaChnl":0,"redChnl":0,"greenChnl":0,"blueChnl":0},"kernings":[{"first":32,"second":84,"amount":-1.23046875},{"first":34,"second":34,"amount":-0.7587890625},{"first":34,"second":39,"amount":-0.7587890625},{"first":34,"second":65,"amount":-2.4609375},{"first":34,"second":97,"amount":-1.025390625},{"first":34,"second":99,"amount":-1.2099609375},{"first":34,"second":100,"amount":-1.2099609375},{"first":34,"second":101,"amount":-1.2099609375},{"first":34,"second":103,"amount":-1.2099609375},{"first":34,"second":109,"amount":-0.41015625},{"first":34,"second":110,"amount":-0.41015625},{"first":34,"second":111,"amount":-1.8662109375},{"first":34,"second":112,"amount":-0.41015625},{"first":34,"second":113,"amount":-1.2099609375},{"first":34,"second":115,"amount":-1.88671875},{"first":39,"second":34,"amount":-0.7587890625},{"first":39,"second":39,"amount":-0.7587890625},{"first":39,"second":65,"amount":-2.4609375},{"first":39,"second":97,"amount":-1.025390625},{"first":39,"second":99,"amount":-1.2099609375},{"first":39,"second":100,"amount":-1.2099609375},{"first":39,"second":101,"amount":-1.2099609375},{"first":39,"second":103,"amount":-1.2099609375},{"first":39,"second":109,"amount":-0.41015625},{"first":39,"second":110,"amount":-0.41015625},{"first":39,"second":111,"amount":-1.8662109375},{"first":39,"second":112,"amount":-0.41015625},{"first":39,"second":113,"amount":-1.2099609375},{"first":39,"second":115,"amount":-1.88671875},{"first":40,"second":86,"amount":0.41015625},{"first":40,"second":87,"amount":0.779296875},{"first":40,"second":89,"amount":0.451171875},{"first":44,"second":34,"amount":-5.8447265625},{"first":44,"second":39,"amount":-5.8447265625},{"first":46,"second":34,"amount":-5.8447265625},{"first":46,"second":39,"amount":-5.8447265625},{"first":47,"second":47,"amount":-5.0859375},{"first":65,"second":34,"amount":-2.4609375},{"first":65,"second":39,"amount":-2.4609375},{"first":65,"second":67,"amount":-0.4306640625},{"first":65,"second":71,"amount":-0.4306640625},{"first":65,"second":79,"amount":-0.4306640625},{"first":65,"second":81,"amount":-0.4306640625},{"first":65,"second":84,"amount":-2.4609375},{"first":65,"second":85,"amount":-0.3486328125},{"first":65,"second":86,"amount":-1.5791015625},{"first":65,"second":87,"amount":-0.7998046875},{"first":65,"second":89,"amount":-3.076171875},{"first":65,"second":109,"amount":-0.984375},{"first":65,"second":110,"amount":-0.984375},{"first":65,"second":111,"amount":-0.24609375},{"first":65,"second":112,"amount":-0.984375},{"first":65,"second":117,"amount":-0.2255859375},{"first":65,"second":118,"amount":-1.025390625},{"first":65,"second":121,"amount":-1.025390625},{"first":65,"second":122,"amount":0.24609375},{"first":66,"second":84,"amount":-0.5537109375},{"first":66,"second":86,"amount":-0.4921875},{"first":66,"second":89,"amount":-1.1279296875},{"first":67,"second":84,"amount":-0.5947265625},{"first":68,"second":44,"amount":-2.501953125},{"first":68,"second":46,"amount":-2.501953125},{"first":68,"second":65,"amount":-0.4306640625},{"first":68,"second":84,"amount":-1.7431640625},{"first":68,"second":86,"amount":-0.451171875},{"first":68,"second":88,"amount":-0.451171875},{"first":68,"second":89,"amount":-0.8818359375},{"first":68,"second":90,"amount":-0.4716796875},{"first":69,"second":84,"amount":0.41015625},{"first":69,"second":99,"amount":-0.3896484375},{"first":69,"second":100,"amount":-0.3896484375},{"first":69,"second":101,"amount":-0.3896484375},{"first":69,"second":103,"amount":-0.3896484375},{"first":69,"second":111,"amount":-0.3896484375},{"first":69,"second":113,"amount":-0.3896484375},{"first":69,"second":117,"amount":-0.3486328125},{"first":69,"second":118,"amount":-0.533203125},{"first":69,"second":121,"amount":-0.533203125},{"first":70,"second":44,"amount":-5.619140625},{"first":70,"second":46,"amount":-5.619140625},{"first":70,"second":65,"amount":-3.9375},{"first":70,"second":74,"amount":-4.265625},{"first":70,"second":84,"amount":0.41015625},{"first":70,"second":97,"amount":-0.697265625},{"first":70,"second":99,"amount":-0.4306640625},{"first":70,"second":100,"amount":-0.4306640625},{"first":70,"second":101,"amount":-0.4306640625},{"first":70,"second":103,"amount":-0.4306640625},{"first":70,"second":111,"amount":-0.4306640625},{"first":70,"second":113,"amount":-0.4306640625},{"first":70,"second":114,"amount":-0.533203125},{"first":70,"second":117,"amount":-0.451171875},{"first":70,"second":118,"amount":-0.4921875},{"first":70,"second":121,"amount":-0.4921875},{"first":72,"second":65,"amount":0.369140625},{"first":72,"second":84,"amount":-0.5947265625},{"first":72,"second":88,"amount":0.3486328125},{"first":72,"second":89,"amount":-0.57421875},{"first":73,"second":65,"amount":0.369140625},{"first":73,"second":84,"amount":-0.5947265625},{"first":73,"second":88,"amount":0.3486328125},{"first":73,"second":89,"amount":-0.57421875},{"first":74,"second":65,"amount":-0.451171875},{"first":75,"second":45,"amount":-3.36328125},{"first":75,"second":67,"amount":-0.6357421875},{"first":75,"second":71,"amount":-0.6357421875},{"first":75,"second":79,"amount":-0.6357421875},{"first":75,"second":81,"amount":-0.6357421875},{"first":75,"second":99,"amount":-0.533203125},{"first":75,"second":100,"amount":-0.533203125},{"first":75,"second":101,"amount":-0.533203125},{"first":75,"second":103,"amount":-0.533203125},{"first":75,"second":111,"amount":-0.5537109375},{"first":75,"second":113,"amount":-0.533203125},{"first":75,"second":117,"amount":-0.4716796875},{"first":75,"second":118,"amount":-0.8203125},{"first":75,"second":121,"amount":-0.8203125},{"first":76,"second":34,"amount":-5.90625},{"first":76,"second":39,"amount":-5.90625},{"first":76,"second":65,"amount":0.3896484375},{"first":76,"second":67,"amount":-1.3125},{"first":76,"second":71,"amount":-1.3125},{"first":76,"second":79,"amount":-1.3125},{"first":76,"second":81,"amount":-1.3125},{"first":76,"second":84,"amount":-4.2041015625},{"first":76,"second":85,"amount":-0.4921875},{"first":76,"second":86,"amount":-4.224609375},{"first":76,"second":87,"amount":-1.9072265625},{"first":76,"second":89,"amount":-5.7216796875},{"first":76,"second":117,"amount":-0.287109375},{"first":76,"second":118,"amount":-2.5224609375},{"first":76,"second":121,"amount":-2.5224609375},{"first":77,"second":65,"amount":0.369140625},{"first":77,"second":84,"amount":-0.5947265625},{"first":77,"second":88,"amount":0.3486328125},{"first":77,"second":89,"amount":-0.57421875},{"first":78,"second":65,"amount":0.369140625},{"first":78,"second":84,"amount":-0.5947265625},{"first":78,"second":88,"amount":0.3486328125},{"first":78,"second":89,"amount":-0.57421875},{"first":79,"second":44,"amount":-2.501953125},{"first":79,"second":46,"amount":-2.501953125},{"first":79,"second":65,"amount":-0.4306640625},{"first":79,"second":84,"amount":-1.7431640625},{"first":79,"second":86,"amount":-0.451171875},{"first":79,"second":88,"amount":-0.451171875},{"first":79,"second":89,"amount":-0.8818359375},{"first":79,"second":90,"amount":-0.4716796875},{"first":80,"second":44,"amount":-8.28515625},{"first":80,"second":46,"amount":-8.28515625},{"first":80,"second":65,"amount":-3.650390625},{"first":80,"second":74,"amount":-3.7734375},{"first":80,"second":88,"amount":-1.0458984375},{"first":80,"second":90,"amount":-0.73828125},{"first":80,"second":97,"amount":-0.2255859375},{"first":80,"second":99,"amount":-0.2666015625},{"first":80,"second":100,"amount":-0.2666015625},{"first":80,"second":101,"amount":-0.2666015625},{"first":80,"second":103,"amount":-0.2666015625},{"first":80,"second":111,"amount":-0.2666015625},{"first":80,"second":113,"amount":-0.2666015625},{"first":80,"second":118,"amount":0.3076171875},{"first":80,"second":121,"amount":0.3076171875},{"first":81,"second":84,"amount":-0.6767578125},{"first":81,"second":86,"amount":-0.57421875},{"first":81,"second":87,"amount":-0.41015625},{"first":81,"second":89,"amount":-0.7177734375},{"first":82,"second":84,"amount":-1.025390625},{"first":82,"second":86,"amount":-0.3896484375},{"first":82,"second":89,"amount":-0.984375},{"first":84,"second":44,"amount":-5.291015625},{"first":84,"second":45,"amount":-5.578125},{"first":84,"second":46,"amount":-5.291015625},{"first":84,"second":65,"amount":-2.4609375},{"first":84,"second":67,"amount":-0.57421875},{"first":84,"second":71,"amount":-0.57421875},{"first":84,"second":74,"amount":-4.4296875},{"first":84,"second":79,"amount":-0.57421875},{"first":84,"second":81,"amount":-0.57421875},{"first":84,"second":83,"amount":-0.328125},{"first":84,"second":84,"amount":0.328125},{"first":84,"second":86,"amount":0.328125},{"first":84,"second":87,"amount":0.3076171875},{"first":84,"second":89,"amount":0.328125},{"first":84,"second":97,"amount":-3.4453125},{"first":84,"second":99,"amount":-1.8251953125},{"first":84,"second":100,"amount":-1.8251953125},{"first":84,"second":101,"amount":-1.8251953125},{"first":84,"second":103,"amount":-1.8251953125},{"first":84,"second":109,"amount":-1.8251953125},{"first":84,"second":110,"amount":-1.8251953125},{"first":84,"second":111,"amount":-4.265625},{"first":84,"second":112,"amount":-1.8251953125},{"first":84,"second":113,"amount":-1.8251953125},{"first":84,"second":115,"amount":-1.55859375},{"first":84,"second":117,"amount":-1.3330078125},{"first":84,"second":118,"amount":-1.681640625},{"first":84,"second":120,"amount":-1.5791015625},{"first":84,"second":121,"amount":-1.681640625},{"first":84,"second":122,"amount":-1.23046875},{"first":85,"second":65,"amount":-0.451171875},{"first":86,"second":44,"amount":-4.4091796875},{"first":86,"second":45,"amount":-3.2197265625},{"first":86,"second":46,"amount":-4.4091796875},{"first":86,"second":65,"amount":-1.5380859375},{"first":86,"second":67,"amount":-0.2666015625},{"first":86,"second":71,"amount":-0.2666015625},{"first":86,"second":79,"amount":-0.2666015625},{"first":86,"second":81,"amount":-0.2666015625},{"first":86,"second":97,"amount":-0.943359375},{"first":86,"second":99,"amount":-0.90234375},{"first":86,"second":100,"amount":-0.90234375},{"first":86,"second":101,"amount":-0.90234375},{"first":86,"second":103,"amount":-0.90234375},{"first":86,"second":111,"amount":-0.943359375},{"first":86,"second":113,"amount":-0.90234375},{"first":86,"second":117,"amount":-0.57421875},{"first":86,"second":118,"amount":-0.2255859375},{"first":86,"second":121,"amount":-0.2255859375},{"first":87,"second":44,"amount":-2.9326171875},{"first":87,"second":45,"amount":-1.23046875},{"first":87,"second":46,"amount":-2.9326171875},{"first":87,"second":65,"amount":-0.8818359375},{"first":87,"second":84,"amount":0.287109375},{"first":87,"second":97,"amount":-0.6767578125},{"first":87,"second":99,"amount":-0.6357421875},{"first":87,"second":100,"amount":-0.6357421875},{"first":87,"second":101,"amount":-0.6357421875},{"first":87,"second":103,"amount":-0.6357421875},{"first":87,"second":111,"amount":-0.6357421875},{"first":87,"second":113,"amount":-0.6357421875},{"first":87,"second":117,"amount":-0.3896484375},{"first":88,"second":45,"amount":-3.19921875},{"first":88,"second":67,"amount":-0.5126953125},{"first":88,"second":71,"amount":-0.5126953125},{"first":88,"second":79,"amount":-0.5126953125},{"first":88,"second":81,"amount":-0.5126953125},{"first":88,"second":86,"amount":0.287109375},{"first":88,"second":99,"amount":-0.533203125},{"first":88,"second":100,"amount":-0.533203125},{"first":88,"second":101,"amount":-0.533203125},{"first":88,"second":103,"amount":-0.533203125},{"first":88,"second":111,"amount":-0.4306640625},{"first":88,"second":113,"amount":-0.533203125},{"first":88,"second":117,"amount":-0.4306640625},{"first":88,"second":118,"amount":-0.6357421875},{"first":88,"second":121,"amount":-0.6357421875},{"first":89,"second":44,"amount":-4.7373046875},{"first":89,"second":45,"amount":-3.1171875},{"first":89,"second":46,"amount":-4.7373046875},{"first":89,"second":65,"amount":-3.076171875},{"first":89,"second":67,"amount":-0.5947265625},{"first":89,"second":71,"amount":-0.5947265625},{"first":89,"second":74,"amount":-1.96875},{"first":89,"second":79,"amount":-0.5947265625},{"first":89,"second":81,"amount":-0.5947265625},{"first":89,"second":83,"amount":-0.328125},{"first":89,"second":84,"amount":0.3486328125},{"first":89,"second":85,"amount":-1.96875},{"first":89,"second":86,"amount":0.369140625},{"first":89,"second":87,"amount":0.3486328125},{"first":89,"second":88,"amount":0.2666015625},{"first":89,"second":89,"amount":0.369140625},{"first":89,"second":97,"amount":-1.2919921875},{"first":89,"second":99,"amount":-1.3330078125},{"first":89,"second":100,"amount":-1.3330078125},{"first":89,"second":101,"amount":-1.3330078125},{"first":89,"second":103,"amount":-1.3330078125},{"first":89,"second":109,"amount":-0.8203125},{"first":89,"second":110,"amount":-0.8203125},{"first":89,"second":111,"amount":-1.3330078125},{"first":89,"second":112,"amount":-0.8203125},{"first":89,"second":113,"amount":-1.3330078125},{"first":89,"second":115,"amount":-1.189453125},{"first":89,"second":117,"amount":-0.7998046875},{"first":89,"second":118,"amount":-0.41015625},{"first":89,"second":120,"amount":-0.4716796875},{"first":89,"second":121,"amount":-0.41015625},{"first":89,"second":122,"amount":-0.615234375},{"first":90,"second":65,"amount":0.2666015625},{"first":90,"second":67,"amount":-0.533203125},{"first":90,"second":71,"amount":-0.533203125},{"first":90,"second":79,"amount":-0.533203125},{"first":90,"second":81,"amount":-0.533203125},{"first":90,"second":99,"amount":-0.4306640625},{"first":90,"second":100,"amount":-0.4306640625},{"first":90,"second":101,"amount":-0.4306640625},{"first":90,"second":103,"amount":-0.4306640625},{"first":90,"second":111,"amount":-0.4306640625},{"first":90,"second":113,"amount":-0.4306640625},{"first":90,"second":117,"amount":-0.3896484375},{"first":90,"second":118,"amount":-0.5537109375},{"first":90,"second":121,"amount":-0.5537109375},{"first":91,"second":74,"amount":-0.369140625},{"first":91,"second":85,"amount":-0.369140625},{"first":97,"second":34,"amount":-0.3486328125},{"first":97,"second":39,"amount":-0.3486328125},{"first":97,"second":118,"amount":-0.3076171875},{"first":97,"second":121,"amount":-0.3076171875},{"first":98,"second":34,"amount":-0.5947265625},{"first":98,"second":39,"amount":-0.5947265625},{"first":98,"second":118,"amount":-0.2255859375},{"first":98,"second":120,"amount":-0.3076171875},{"first":98,"second":121,"amount":-0.2255859375},{"first":98,"second":122,"amount":-0.3076171875},{"first":99,"second":34,"amount":-0.2255859375},{"first":99,"second":39,"amount":-0.2255859375},{"first":101,"second":34,"amount":-0.287109375},{"first":101,"second":39,"amount":-0.287109375},{"first":101,"second":118,"amount":-0.2666015625},{"first":101,"second":121,"amount":-0.2666015625},{"first":102,"second":34,"amount":0.328125},{"first":102,"second":39,"amount":0.328125},{"first":102,"second":41,"amount":0.41015625},{"first":102,"second":93,"amount":0.369140625},{"first":102,"second":99,"amount":-0.4921875},{"first":102,"second":100,"amount":-0.4921875},{"first":102,"second":101,"amount":-0.4921875},{"first":102,"second":103,"amount":-0.4921875},{"first":102,"second":113,"amount":-0.4921875},{"first":102,"second":125,"amount":0.3896484375},{"first":104,"second":34,"amount":-1.640625},{"first":104,"second":39,"amount":-1.640625},{"first":107,"second":99,"amount":-0.41015625},{"first":107,"second":100,"amount":-0.41015625},{"first":107,"second":101,"amount":-0.41015625},{"first":107,"second":103,"amount":-0.41015625},{"first":107,"second":113,"amount":-0.41015625},{"first":109,"second":34,"amount":-1.640625},{"first":109,"second":39,"amount":-1.640625},{"first":110,"second":34,"amount":-1.640625},{"first":110,"second":39,"amount":-1.640625},{"first":111,"second":34,"amount":-1.8046875},{"first":111,"second":39,"amount":-1.8046875},{"first":111,"second":118,"amount":-0.3076171875},{"first":111,"second":120,"amount":-0.4306640625},{"first":111,"second":121,"amount":-0.3076171875},{"first":111,"second":122,"amount":-0.328125},{"first":112,"second":34,"amount":-0.5947265625},{"first":112,"second":39,"amount":-0.5947265625},{"first":112,"second":118,"amount":-0.2255859375},{"first":112,"second":120,"amount":-0.3076171875},{"first":112,"second":121,"amount":-0.2255859375},{"first":112,"second":122,"amount":-0.3076171875},{"first":114,"second":34,"amount":0.328125},{"first":114,"second":39,"amount":0.328125},{"first":114,"second":44,"amount":-3.5478515625},{"first":114,"second":46,"amount":-3.5478515625},{"first":114,"second":97,"amount":-0.615234375},{"first":114,"second":99,"amount":-0.3896484375},{"first":114,"second":100,"amount":-0.3896484375},{"first":114,"second":101,"amount":-0.3896484375},{"first":114,"second":103,"amount":-0.3896484375},{"first":114,"second":111,"amount":-0.73828125},{"first":114,"second":113,"amount":-0.3896484375},{"first":114,"second":118,"amount":0.369140625},{"first":114,"second":121,"amount":0.369140625},{"first":116,"second":111,"amount":-0.615234375},{"first":118,"second":34,"amount":0.3076171875},{"first":118,"second":39,"amount":0.3076171875},{"first":118,"second":44,"amount":-3.4248046875},{"first":118,"second":46,"amount":-3.4248046875},{"first":118,"second":97,"amount":-0.3076171875},{"first":118,"second":99,"amount":-0.2666015625},{"first":118,"second":100,"amount":-0.2666015625},{"first":118,"second":101,"amount":-0.2666015625},{"first":118,"second":103,"amount":-0.2666015625},{"first":118,"second":111,"amount":-0.3076171875},{"first":118,"second":113,"amount":-0.2666015625},{"first":119,"second":44,"amount":-2.54296875},{"first":119,"second":46,"amount":-2.54296875},{"first":120,"second":99,"amount":-0.41015625},{"first":120,"second":100,"amount":-0.41015625},{"first":120,"second":101,"amount":-0.41015625},{"first":120,"second":103,"amount":-0.41015625},{"first":120,"second":111,"amount":-0.8203125},{"first":120,"second":113,"amount":-0.41015625},{"first":121,"second":34,"amount":0.3076171875},{"first":121,"second":39,"amount":0.3076171875},{"first":121,"second":44,"amount":-3.4248046875},{"first":121,"second":46,"amount":-3.4248046875},{"first":121,"second":97,"amount":-0.3076171875},{"first":121,"second":99,"amount":-0.2666015625},{"first":121,"second":100,"amount":-0.2666015625},{"first":121,"second":101,"amount":-0.2666015625},{"first":121,"second":103,"amount":-0.2666015625},{"first":121,"second":111,"amount":-0.3076171875},{"first":121,"second":113,"amount":-0.2666015625},{"first":122,"second":99,"amount":-0.328125},{"first":122,"second":100,"amount":-0.328125},{"first":122,"second":101,"amount":-0.328125},{"first":122,"second":103,"amount":-0.328125},{"first":122,"second":111,"amount":-0.328125},{"first":122,"second":113,"amount":-0.328125},{"first":123,"second":74,"amount":-0.41015625},{"first":123,"second":85,"amount":-0.41015625}]}')},function(t,e,n){t.exports=n.p+"images/dot_default_2.png"},function(t,e,n){t.exports=n.p+"images/dot_selected_2_2.png"},function(t,e,n){t.exports=n.p+"images/line_default_2.png"},function(t,e,n){t.exports=n.p+"images/line_selected_2_2.png"},function(t,e,n){(function(t){var r;function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(o,a){"use strict";var s="model",c="name",u="type",l="vendor",h="version",f="mobile",p="tablet",d="smarttv",y={extend:function(t,e){var n={};for(var r in t)e[r]&&e[r].length%2==0?n[r]=e[r].concat(t[r]):n[r]=t[r];return n},has:function(t,e){return"string"==typeof t&&-1!==e.toLowerCase().indexOf(t.toLowerCase())},lowerize:function(t){return t.toLowerCase()},major:function(t){return"string"===i(t)?t.replace(/[^\d\.]/g,"").split(".")[0]:void 0},trim:function(t){return t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},m={rgx:function(t,e){for(var n,r,o,a,s,c,u=0;u<e.length&&!s;){var l=e[u],h=e[u+1];for(n=r=0;n<l.length&&!s;)if(s=l[n++].exec(t))for(o=0;o<h.length;o++)c=s[++r],"object"===i(a=h[o])&&a.length>0?2==a.length?"function"==i(a[1])?this[a[0]]=a[1].call(this,c):this[a[0]]=a[1]:3==a.length?"function"!==i(a[1])||a[1].exec&&a[1].test?this[a[0]]=c?c.replace(a[1],a[2]):void 0:this[a[0]]=c?a[1].call(this,c,a[2]):void 0:4==a.length&&(this[a[0]]=c?a[3].call(this,c.replace(a[1],a[2])):void 0):this[a]=c||void 0;u+=2}},str:function(t,e){for(var n in e)if("object"===i(e[n])&&e[n].length>0){for(var r=0;r<e[n].length;r++)if(y.has(e[n][r],t))return"?"===n?void 0:n}else if(y.has(e[n],t))return"?"===n?void 0:n;return t}},v={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},g={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[c,h],[/(opios)[\/\s]+([\w\.]+)/i],[[c,"Opera Mini"],h],[/\s(opr)\/([\w\.]+)/i],[[c,"Opera"],h],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim)(?:browser)?[\/\s]?([\w\.]*)/i,/(bidubrowser|baidubrowser)[\/\s]?([\w\.]+)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i],[c,h],[/(konqueror)\/([\w\.]+)/i],[[c,"Konqueror"],h],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[c,"IE"],h],[/(edge|edgios|edga|edg)\/((\d+)?[\w\.]+)/i],[[c,"Edge"],h],[/(yabrowser)\/([\w\.]+)/i],[[c,"Yandex"],h],[/(Avast)\/([\w\.]+)/i],[[c,"Avast Secure Browser"],h],[/(AVG)\/([\w\.]+)/i],[[c,"AVG Secure Browser"],h],[/(puffin)\/([\w\.]+)/i],[[c,"Puffin"],h],[/(focus)\/([\w\.]+)/i],[[c,"Firefox Focus"],h],[/(opt)\/([\w\.]+)/i],[[c,"Opera Touch"],h],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[c,"UCBrowser"],h],[/(comodo_dragon)\/([\w\.]+)/i],[[c,/_/g," "],h],[/(windowswechat qbcore)\/([\w\.]+)/i],[[c,"WeChat(Win) Desktop"],h],[/(micromessenger)\/([\w\.]+)/i],[[c,"WeChat"],h],[/(brave)\/([\w\.]+)/i],[[c,"Brave"],h],[/(qqbrowserlite)\/([\w\.]+)/i],[c,h],[/(QQ)\/([\d\.]+)/i],[c,h],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[c,h],[/(baiduboxapp)[\/\s]?([\w\.]+)/i],[c,h],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[c,h],[/(MetaSr)[\/\s]?([\w\.]+)/i],[c],[/(LBBROWSER)/i],[c],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[h,[c,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[h,[c,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/android.+(line)\/([\w\.]+)\/iab/i],[c,h],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[h,[c,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[c,/(.+)/,"$1 WebView"],h],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[c,/(.+(?:g|us))(.+)/,"$1 $2"],h],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[h,[c,"Android Browser"]],[/(sailfishbrowser)\/([\w\.]+)/i],[[c,"Sailfish Browser"],h],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[c,h],[/(dolfin)\/([\w\.]+)/i],[[c,"Dolphin"],h],[/(qihu|qhbrowser|qihoobrowser|360browser)/i],[[c,"360 Browser"]],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[c,"Chrome"],h],[/(coast)\/([\w\.]+)/i],[[c,"Opera Coast"],h],[/fxios\/([\w\.-]+)/i],[h,[c,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[h,[c,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[h,c],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[c,"GSA"],h],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[c,[h,m.str,v.browser.oldsafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[c,h],[/(navigator|netscape)\/([\w\.-]+)/i],[[c,"Netscape"],h],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[c,h]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",y.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/windows\s(ce|mobile);\sppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[["architecture",/ower/,"",y.lowerize]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+[;l]))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[["architecture",y.lowerize]]],device:[[/\((ipad|playbook);[\w\s\),;-]+(rim|apple)/i],[s,l,[u,p]],[/applecoremedia\/[\w\.]+ \((ipad)/],[s,[l,"Apple"],[u,p]],[/(apple\s{0,1}tv)/i],[[s,"Apple TV"],[l,"Apple"],[u,d]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[l,s,[u,p]],[/(kf[A-z]+)\sbuild\/.+silk\//i],[s,[l,"Amazon"],[u,p]],[/(sd|kf)[0349hijorstuw]+\sbuild\/.+silk\//i],[[s,m.str,v.device.amazon.model],[l,"Amazon"],[u,f]],[/android.+aft([bms])\sbuild/i],[s,[l,"Amazon"],[u,d]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[s,l,[u,f]],[/\((ip[honed|\s\w*]+);/i],[s,[l,"Apple"],[u,f]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[l,s,[u,f]],[/\(bb10;\s(\w+)/i],[s,[l,"BlackBerry"],[u,f]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone|p00c)/i],[s,[l,"Asus"],[u,p]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[l,"Sony"],[s,"Xperia Tablet"],[u,p]],[/android.+\s([c-g]\d{4}|so[-l]\w+)(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[s,[l,"Sony"],[u,f]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[l,s,[u,"console"]],[/android.+;\s(shield)\sbuild/i],[s,[l,"Nvidia"],[u,"console"]],[/(playstation\s[34portablevi]+)/i],[s,[l,"Sony"],[u,"console"]],[/(sprint\s(\w+))/i],[[l,m.str,v.device.sprint.vendor],[s,m.str,v.device.sprint.model],[u,f]],[/(htc)[;_\s-]+([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[l,[s,/_/g," "],[u,f]],[/(nexus\s9)/i],[s,[l,"HTC"],[u,p]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p|vog-l29|ane-lx1|eml-l29)/i],[s,[l,"Huawei"],[u,f]],[/android.+(bah2?-a?[lw]\d{2})/i],[s,[l,"Huawei"],[u,p]],[/(microsoft);\s(lumia[\s\w]+)/i],[l,s,[u,f]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[s,[l,"Microsoft"],[u,"console"]],[/(kin\.[onetw]{3})/i],[[s,/\./g," "],[l,"Microsoft"],[u,f]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[s,[l,"Motorola"],[u,f]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[s,[l,"Motorola"],[u,p]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[l,y.trim],[s,y.trim],[u,d]],[/hbbtv.+maple;(\d+)/i],[[s,/^/,"SmartTV"],[l,"Samsung"],[u,d]],[/\(dtv[\);].+(aquos)/i],[s,[l,"Sharp"],[u,d]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[l,"Samsung"],s,[u,p]],[/smart-tv.+(samsung)/i],[l,[u,d],s],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[l,"Samsung"],s,[u,f]],[/sie-(\w*)/i],[s,[l,"Siemens"],[u,f]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[l,"Nokia"],s,[u,f]],[/android[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[s,[l,"Acer"],[u,p]],[/android.+([vl]k\-?\d{3})\s+build/i],[s,[l,"LG"],[u,p]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[l,"LG"],s,[u,p]],[/(lg) netcast\.tv/i],[l,s,[u,d]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[s,[l,"LG"],[u,f]],[/(lenovo)\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+))/i],[l,s,[u,p]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[s,[l,"Lenovo"],[u,p]],[/(lenovo)[_\s-]?([\w-]+)/i],[l,s,[u,f]],[/linux;.+((jolla));/i],[l,s,[u,f]],[/((pebble))app\/[\d\.]+\s/i],[l,s,[u,"wearable"]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[l,s,[u,f]],[/crkey/i],[[s,"Chromecast"],[l,"Google"],[u,d]],[/android.+;\s(glass)\s\d/i],[s,[l,"Google"],[u,"wearable"]],[/android.+;\s(pixel c)[\s)]/i],[s,[l,"Google"],[u,p]],[/android.+;\s(pixel( [23])?( xl)?)[\s)]/i],[s,[l,"Google"],[u,f]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:a\d|one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]*[\w\s]+))\s+build/i],[[s,/_/g," "],[l,"Xiaomi"],[u,f]],[/android.+(mi[\s\-_]*(?:pad)(?:[\s_]*[\w\s]+))\s+build/i],[[s,/_/g," "],[l,"Xiaomi"],[u,p]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[s,[l,"Meizu"],[u,f]],[/(mz)-([\w-]{2,})/i],[[l,"Meizu"],s,[u,f]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})[\s)]/i],[s,[l,"OnePlus"],[u,f]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[s,[l,"RCA"],[u,p]],[/android.+[;\/\s]+(Venue[\d\s]{2,7})\s+build/i],[s,[l,"Dell"],[u,p]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[s,[l,"Verizon"],[u,p]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[l,"Barnes & Noble"],s,[u,p]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[s,[l,"NuVision"],[u,p]],[/android.+;\s(k88)\sbuild/i],[s,[l,"ZTE"],[u,p]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[s,[l,"Swiss"],[u,f]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[s,[l,"Swiss"],[u,p]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[s,[l,"Zeki"],[u,p]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[l,"Dragon Touch"],s,[u,p]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[s,[l,"Insignia"],[u,p]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[s,[l,"NextBook"],[u,p]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[l,"Voice"],s,[u,f]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[l,"LvTel"],s,[u,f]],[/android.+;\s(PH-1)\s/i],[s,[l,"Essential"],[u,f]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[s,[l,"Envizen"],[u,p]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[l,s,[u,p]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[s,[l,"MachSpeed"],[u,p]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[l,s,[u,p]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[s,[l,"Rotor"],[u,p]],[/android.+(KS(.+))\s+build/i],[s,[l,"Amazon"],[u,p]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[l,s,[u,p]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[u,y.lowerize],l,s],[/[\s\/\(](smart-?tv)[;\)]/i],[[u,d]],[/(android[\w\.\s\-]{0,9});.+build/i],[s,[l,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[h,[c,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[h,[c,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[c,h],[/rv\:([\w\.]{1,9}).+(gecko)/i],[h,c]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[c,h],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[c,[h,m.str,v.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[c,"Windows"],[h,m.str,v.os.windows.version]],[/\((bb)(10);/i],[[c,"BlackBerry"],h],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen|kaios)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i],[c,h],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[c,"Symbian"],h],[/\((series40);/i],[c],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[c,"Firefox OS"],h],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[c,h],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[c,"Chromium OS"],h],[/(sunos)\s?([\w\.\d]*)/i],[[c,"Solaris"],h],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[c,h],[/(haiku)\s(\w+)/i],[c,h],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[h,/_/g,"."],[c,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[c,"Mac OS"],[h,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[c,h]]},b=function t(e,n){if("object"===i(e)&&(n=e,e=void 0),!(this instanceof t))return new t(e,n).getResult();var r=e||(o&&o.navigator&&o.navigator.userAgent?o.navigator.userAgent:""),a=n?y.extend(g,n):g;return this.getBrowser=function(){var t={name:void 0,version:void 0};return m.rgx.call(t,r,a.browser),t.major=y.major(t.version),t},this.getCPU=function(){var t={architecture:void 0};return m.rgx.call(t,r,a.cpu),t},this.getDevice=function(){var t={vendor:void 0,model:void 0,type:void 0};return m.rgx.call(t,r,a.device),t},this.getEngine=function(){var t={name:void 0,version:void 0};return m.rgx.call(t,r,a.engine),t},this.getOS=function(){var t={name:void 0,version:void 0};return m.rgx.call(t,r,a.os),t},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return r},this.setUA=function(t){return r=t,this},this};b.VERSION="0.7.21",b.BROWSER={NAME:c,MAJOR:"major",VERSION:h},b.CPU={ARCHITECTURE:"architecture"},b.DEVICE={MODEL:s,VENDOR:l,TYPE:u,CONSOLE:"console",MOBILE:f,SMARTTV:d,TABLET:p,WEARABLE:"wearable",EMBEDDED:"embedded"},b.ENGINE={NAME:c,VERSION:h},b.OS={NAME:c,VERSION:h},"undefined"!==i(e)?("undefined"!==i(t)&&t.exports&&(e=t.exports=b),e.UAParser=b):void 0===(r=function(){return b}.call(e,n,e,t))||(t.exports=r);var w=o&&(o.jQuery||o.Zepto);if(w&&!w.ua){var _=new b;w.ua=_.getResult(),w.ua.get=function(){return _.getUA()},w.ua.set=function(t){_.setUA(t);var e=_.getResult();for(var n in e)w.ua[n]=e[n]}}}("object"===("undefined"==typeof window?"undefined":i(window))?window:this)}).call(this,n(375)(t))},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(822),o=n(823),a=n(824),s=n(826),c=function(t){o(!1,t)},u=String.prototype.replace,l=String.prototype.split,h=function(t){var e=t%100,n=e%10;return 11!==e&&1===n?0:2<=n&&n<=4&&!(e>=12&&e<=14)?1:2},f={pluralTypes:{arabic:function(t){if(t<3)return t;var e=t%100;return e>=3&&e<=10?3:e>=11?4:5},bosnian_serbian:h,chinese:function(){return 0},croatian:h,french:function(t){return t>1?1:0},german:function(t){return 1!==t?1:0},russian:h,lithuanian:function(t){return t%10==1&&t%100!=11?0:t%10>=2&&t%10<=9&&(t%100<11||t%100>19)?1:2},czech:function(t){return 1===t?0:t>=2&&t<=4?1:2},polish:function(t){if(1===t)return 0;var e=t%10;return 2<=e&&e<=4&&(t%100<10||t%100>=20)?1:2},icelandic:function(t){return t%10!=1||t%100==11?1:0},slovenian:function(t){var e=t%100;return 1===e?0:2===e?1:3===e||4===e?2:3}},pluralTypeToLanguages:{arabic:["ar"],bosnian_serbian:["bs-Latn-BA","bs-Cyrl-BA","srl-RS","sr-RS"],chinese:["id","id-ID","ja","ko","ko-KR","lo","ms","th","th-TH","zh"],croatian:["hr","hr-HR"],german:["fa","da","de","en","es","fi","el","he","hi-IN","hu","hu-HU","it","nl","no","pt","sv","tr"],french:["fr","tl","pt-br"],russian:["ru","ru-RU"],lithuanian:["lt"],czech:["cs","cs-CZ","sk"],polish:["pl"],icelandic:["is"],slovenian:["sl-SL"]}};function p(t,e){var n,r,o=(n=t.pluralTypeToLanguages,r={},i(n,(function(t,e){i(t,(function(t){r[t]=e}))})),r);return o[e]||o[l.call(e,/-/,1)[0]]||o.en}function d(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var y=/%\{(.*?)\}/g;function m(t,e,n,r,i){if("string"!=typeof t)throw new TypeError("Polyglot.transformPhrase expects argument #1 to be string");if(null==e)return t;var o=t,c=r||y,h=i||f,d="number"==typeof e?{smart_count:e}:e;if(null!=d.smart_count&&o){var m=l.call(o,"||||");o=s(m[function(t,e,n){return t.pluralTypes[p(t,e)](n)}(h,n||"en",d.smart_count)]||m[0])}return o=u.call(o,c,(function(t,e){return a(d,e)&&null!=d[e]?d[e]:t}))}function v(t){var e=t||{};this.phrases={},this.extend(e.phrases||{}),this.currentLocale=e.locale||"en";var n=e.allowMissing?m:null;this.onMissingKey="function"==typeof e.onMissingKey?e.onMissingKey:n,this.warn=e.warn||c,this.tokenRegex=function(t){var e=t&&t.prefix||"%{",n=t&&t.suffix||"}";if("||||"===e||"||||"===n)throw new RangeError('"||||" token is reserved for pluralization');return new RegExp(d(e)+"(.*?)"+d(n),"g")}(e.interpolation),this.pluralRules=e.pluralRules||f}v.prototype.locale=function(t){return t&&(this.currentLocale=t),this.currentLocale},v.prototype.extend=function(t,e){i(t,(function(t,n){var i=e?e+"."+n:n;"object"===r(t)?this.extend(t,i):this.phrases[i]=t}),this)},v.prototype.unset=function(t,e){"string"==typeof t?delete this.phrases[t]:i(t,(function(t,n){var i=e?e+"."+n:n;"object"===r(t)?this.unset(t,i):delete this.phrases[i]}),this)},v.prototype.clear=function(){this.phrases={}},v.prototype.replace=function(t){this.clear(),this.extend(t)},v.prototype.t=function(t,e){var n,r,i=null==e?{}:e;if("string"==typeof this.phrases[t])n=this.phrases[t];else if("string"==typeof i._)n=i._;else if(this.onMissingKey){r=(0,this.onMissingKey)(t,i,this.currentLocale,this.tokenRegex,this.pluralRules)}else this.warn('Missing translation for key: "'+t+'"'),r=t;return"string"==typeof n&&(r=m(n,i,this.currentLocale,this.tokenRegex,this.pluralRules)),r},v.prototype.has=function(t){return a(this.phrases,t)},v.transformPhrase=function(t,e,n){return m(t,e,n)},t.exports=v},function(t,e,n){t.exports=n.p+"images/showcase-password-background.jpg"},function(t,e,n){"use strict";t.exports=i;var r=n(843);function i(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}i.Varint=0,i.Fixed64=1,i.Bytes=2,i.Fixed32=5;function o(t){return t.type===i.Bytes?t.readVarint()+t.pos:t.pos+1}function a(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function s(t,e,n){var r=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.ceil(Math.log(e)/(7*Math.LN2));n.realloc(r);for(var i=n.pos-1;i>=t;i--)n.buf[i+r]=n.buf[i]}function c(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function u(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function l(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function h(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function f(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function p(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function d(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function y(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function m(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function v(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function g(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function b(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}i.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var r=this.readVarint(),i=r>>3,o=this.pos;this.type=7&r,t(i,e,this),this.pos===o&&this.skip(r)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=v(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=b(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=v(this.buf,this.pos)+4294967296*v(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=v(this.buf,this.pos)+4294967296*b(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=r.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=r.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,r=this.buf;return e=127&(n=r[this.pos++]),n<128?e:(e|=(127&(n=r[this.pos++]))<<7,n<128?e:(e|=(127&(n=r[this.pos++]))<<14,n<128?e:(e|=(127&(n=r[this.pos++]))<<21,n<128?e:function(t,e,n){var r,i,o=n.buf;if(i=o[n.pos++],r=(112&i)>>4,i<128)return a(t,r,e);if(i=o[n.pos++],r|=(127&i)<<3,i<128)return a(t,r,e);if(i=o[n.pos++],r|=(127&i)<<10,i<128)return a(t,r,e);if(i=o[n.pos++],r|=(127&i)<<17,i<128)return a(t,r,e);if(i=o[n.pos++],r|=(127&i)<<24,i<128)return a(t,r,e);if(i=o[n.pos++],r|=(1&i)<<31,i<128)return a(t,r,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=r[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=function(t,e,n){var r="",i=e;for(;i<n;){var o,a,s,c=t[i],u=null,l=c>239?4:c>223?3:c>191?2:1;if(i+l>n)break;1===l?c<128&&(u=c):2===l?128==(192&(o=t[i+1]))&&(u=(31&c)<<6|63&o)<=127&&(u=null):3===l?(o=t[i+1],a=t[i+2],128==(192&o)&&128==(192&a)&&((u=(15&c)<<12|(63&o)<<6|63&a)<=2047||u>=55296&&u<=57343)&&(u=null)):4===l&&(o=t[i+1],a=t[i+2],s=t[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&((u=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&s)<=65535||u>=1114112)&&(u=null)),null===u?(u=65533,l=1):u>65535&&(u-=65536,r+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),r+=String.fromCharCode(u),i+=l}return r}(this.buf,this.pos,t);return this.pos=t,e},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){var n=o(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===i.Varint)for(;this.buf[this.pos++]>127;);else if(e===i.Bytes)this.pos=this.readVarint()+this.pos;else if(e===i.Fixed32)this.pos+=4;else{if(e!==i.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),g(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),g(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),g(this.buf,-1&t,this.pos),g(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),g(this.buf,-1&t,this.pos),g(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var n,r;t>=0?(n=t%4294967296|0,r=t/4294967296|0):(r=~(-t/4294967296),4294967295^(n=~(-t%4294967296))?n=n+1|0:(n=0,r=r+1|0));if(t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,n){n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos]=127&t}(n,0,e),function(t,e){var n=(7&t)<<4;if(e.buf[e.pos++]|=n|((t>>>=3)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;e.buf[e.pos++]=127&t}(r,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,n){for(var r,i,o=0;o<e.length;o++){if((r=e.charCodeAt(o))>55295&&r<57344){if(!i){r>56319||o+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):i=r;continue}if(r<56320){t[n++]=239,t[n++]=191,t[n++]=189,i=r;continue}r=i-55296<<10|r-56320|65536,i=null}else i&&(t[n++]=239,t[n++]=191,t[n++]=189,i=null);r<128?t[n++]=r:(r<2048?t[n++]=r>>6|192:(r<65536?t[n++]=r>>12|224:(t[n++]=r>>18|240,t[n++]=r>>12&63|128),t[n++]=r>>6&63|128),t[n++]=63&r|128)}return n}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&s(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),r.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),r.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var r=this.pos-n;r>=128&&s(n,r,this),this.pos=n-1,this.writeVarint(r),this.pos+=r},writeMessage:function(t,e,n){this.writeTag(t,i.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){this.writeMessage(t,c,e)},writePackedSVarint:function(t,e){this.writeMessage(t,u,e)},writePackedBoolean:function(t,e){this.writeMessage(t,f,e)},writePackedFloat:function(t,e){this.writeMessage(t,l,e)},writePackedDouble:function(t,e){this.writeMessage(t,h,e)},writePackedFixed32:function(t,e){this.writeMessage(t,p,e)},writePackedSFixed32:function(t,e){this.writeMessage(t,d,e)},writePackedFixed64:function(t,e){this.writeMessage(t,y,e)},writePackedSFixed64:function(t,e){this.writeMessage(t,m,e)},writeBytesField:function(t,e){this.writeTag(t,i.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,i.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,i.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,i.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,i.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,i.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,i.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,i.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,i.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,i.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}}},function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return x}));var r=n(0),i=n(92),o=n(46),a=n(52),s=n(585),c=n(586),u=n(422),l=n(28),h=n(2),f=n(123),p=n(587),d=n(50),y=n(7),m=n(177),v=n(113),g=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},b=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},w=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},_=new h.a(t),x=function(){function t(t,e,n,r,i,o,l,h,f,p){var d,y;this.textureLOD=t,this.urls=e,this.modelMesh=n,this.camera=r,this.cameraData=i,this.renderer=o,this.renderToTextureModule=l,this.raycaster=h,this.scene=f,this.engine=p,this.slots=[],this.chunkIdToSlot={},this.minQuality=a.c,this.maxQuality=a.b,this.concurrentLoadingTextures=3,this.concurrentDownloadingTiles=12,this.autoLoadTiles=!1,this.lastSortedAt=0,this.loadingTextures=0,this.downloadingTiles=0,this.textureQualityRenderPass=new u.a(this.slots,this.renderToTextureModule),this.textureScoreRenderPass=new u.b(this.slots,this.renderToTextureModule),this._raycastCounter=0;var m={};try{for(var v=w(n.chunks),g=v.next();!g.done;g=v.next()){var b=g.value,_=m[b.textureName];_||(_=new s.a(b.textureName),m[b.textureName]=_,this.slots.push(m[b.textureName])),_.chunks.push(b),this.chunkIdToSlot[b.id]=_}}catch(t){d={error:t}}finally{try{g&&!g.done&&(y=v.return)&&y.call(v)}finally{if(d)throw d.error}}this.textureBudgeter=new c.a(this.slots)}return t.prototype.setQuality=function(t,e){var n,r;if(t>e)throw new Error("min quality must be smaller or equal to max");this.minQuality=t,this.maxQuality=e;try{for(var i=w(this.slots),o=i.next();!o.done;o=i.next()){var a=o.value;a.minQuality=this.minQuality,a.maxQuality=Math.min(a.maxQuality,this.maxQuality)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},Object.defineProperty(t.prototype,"textureCount",{get:function(){return this.slots.length},enumerable:!0,configurable:!0}),t.prototype.loadAll=function(t){var e=this;if(!this.slots[0]||!this.slots[0].textureName)return Promise.resolve([]);var n=this.slots.map((function(n){return e.loadTexture(n,t,!1)}));return Promise.all(n)},t.prototype.loadTexture=function(t,e,n){return void 0===n&&(n=!0),g(this,void 0,Promise,(function(){var i,o,s;return b(this,(function(c){switch(c.label){case 0:if(i=a.d[e].textureSize,t.lastLoadedAt=performance.now(),e===t.quality)return _.warn("Texture was already at level "+a.e[e]+", not reloading"),[2,t.texture];if(e<t.quality)return o=this.renderToTextureModule.resizeTexture(t.texture,i),t.quality=e,t.setTexture(o),[2,t.texture];(s=new r.vc).format=r.Xb,this.textureLOD!==d.TextureLOD.NONE&&n&&(s.generateMipmaps=!1,s.minFilter=r.Y,s.magFilter=r.Y),this.renderer.initSizedTexture2D(i,s),t.loading=!0,this.loadingTextures++,c.label=1;case 1:return c.trys.push([1,6,7,8]),s.sourceFile=t.getUrl(e),this.textureLOD!==d.TextureLOD.NONE&&n?[4,this.updateTextureTiled(s,e)]:[3,3];case 2:return c.sent(),[3,5];case 3:return[4,this.updateTextureSolid(s,e)];case 4:c.sent(),c.label=5;case 5:return t.setTexture(s),[3,8];case 6:return c.sent(),_.warn("Failed loading texture "+s.sourceFile),[3,8];case 7:return this.loadingTextures--,t.quality=e,t.loading=!1,[7];case 8:return[2,s]}}))}))},t.prototype.updateTextureTiled=function(t,e){return g(this,void 0,void 0,(function(){var n,r,o,s,c,u,l,h,f,p=this;return b(this,(function(d){for(n=a.d[e],r=n.textureSize,o=n.tileSize,s=n.assetSize,c=s/(r/o),u=function(e,n){return g(p,void 0,void 0,(function(){var a,u,l,h,f=this;return b(this,(function(p){switch(p.label){case 0:a={},c!==o&&(a.width=""+o),c!==s&&(a.crop=c+","+c+",x"+e/r+",y"+n/r),this.downloadingTiles+=1,p.label=1;case 1:return p.trys.push([1,,3,4]),[4,this.urls.getImageBitmap(t.sourceFile,o,o,{priority:i.RequestPriority.LOW,flipY:!0},a)];case 2:return u=p.sent(),[3,4];case 3:return this.downloadingTiles-=1,[7];case 4:return l=e,h=r-n-u.height,[4,this.engine.commandBinder.issueCommand(new m.a("mesh/texture/upload-tiles",(function(){return f.renderer.uploadTexture2D(u,t,l,h)}),100))];case 5:return[2,p.sent().promise]}}))}))},l=[],h=0;h<r;h+=o)for(f=0;f<r;f+=o)l.push(u(h,f));return[2,Promise.all(l)]}))}))},t.prototype.updateTextureSolid=function(t,e){return g(this,void 0,void 0,(function(){var n,r;return b(this,(function(o){switch(o.label){case 0:return n=a.d[e].textureSize,[4,this.urls.getImageBitmap(t.sourceFile,n,n,{priority:i.RequestPriority.LOW,flipY:!0},{width:""+n})];case 1:return r=o.sent(),this.renderer.uploadTexture2D(r,t,0,0),[2]}}))}))},t.prototype.raycastRandomScreenLocation=function(t,e,n){this._raycastCounter++;var i=(2-2*e)/t,o=-1+e,a=this._raycastCounter%(t*t),s=a%t,c=o+(a-s)/t*i,u=o+s*i+Math.random()*i,l=c+Math.random()*i,h=new r.Jc(u,l,-1).unproject(this.camera),p=new r.Jc(u,l,1).unproject(this.camera).clone().sub(h).normalize(),d=this.raycaster.pick(h,p,v.c);if(d&&d.object&&d.object instanceof f.a&&d.face){n&&n(d);var y=d.object.getChunk(d.face.materialIndex);this.chunkIdToSlot[y.id].addSighting(d.point.clone(),d.distance,this._raycastCounter)}},t.prototype.analyzeTextureScreenCoverageFromRaycasts=function(){var t,e,n,i,o=window.innerWidth,a=(new r.Jc).copy(this.cameraData.pose.position);try{for(var s=w(this.slots),c=s.next();!c.done;c=s.next()){var u=c.value;u.screenCoverage=0,u.screenCoverageScore=0,u.maxQuality=this.minQuality;try{for(var h=w(u.sightings),f=h.next();!f.done;f=h.next()){var p=f.value;if(!(this._raycastCounter-p.time>1e3)){var d=a.distanceTo(p.point),y=S(Object(l.m)(d,this.camera.projectionMatrix,o));y=Math.min(y,this.maxQuality),u.screenCoverageScore+=y,u.screenCoverage+=1,u.maxQuality=Math.max(y,u.maxQuality)}}}catch(t){n={error:t}}finally{try{f&&!f.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{c&&!c.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}}this.slots.sort((function(t,e){return e.screenCoverageScore-t.screenCoverageScore})),this.textureBudgeter.updateTargetQualitiesFromBudget()},t.prototype.update=function(t){var e,n,r=this;if(this.textureBudgeter.update(t),this.camera&&this.autoLoadTiles){var i=performance.now();this.textureLOD===d.TextureLOD.RAYCAST&&this.minQuality!==this.maxQuality&&(this.raycastTaskPromise||(this.raycastTaskPromise=this.engine.commandBinder.issueCommand(new m.a("mesh/texture/raycast",(function(){r.raycastRandomScreenLocation(5,.05,o.e.debugLOD?Object(p.a)(65280,r.scene):void 0)}),50)).then((function(t){return g(r,void 0,void 0,(function(){return b(this,(function(e){switch(e.label){case 0:return[4,t.promise];case 1:return e.sent(),this.raycastTaskPromise=null,[2]}}))}))}))),!this.analyzeTaskPromise&&i-this.lastSortedAt>200&&(this.analyzeTaskPromise=this.engine.commandBinder.issueCommand(new m.a("mesh/texture/analyze-screen-coverage",(function(){r.analyzeTextureScreenCoverageFromRaycasts(),r.lastSortedAt=performance.now()}),100)).then((function(t){return g(r,void 0,void 0,(function(){return b(this,(function(e){switch(e.label){case 0:return[4,t.promise];case 1:return e.sent(),this.analyzeTaskPromise=null,[2]}}))}))}))));for(var a=this.slots.length-1;a>=0;a--){var s=this.slots[a],c=Object(y.e)(s.targetQuality,s.minQuality,s.maxQuality),u=i-s.lastLoadedAt<1e3;if(!s.loading&&s.quality>c&&!u){this.loadTexture(s,c);break}}try{for(var l=w(this.slots),h=l.next();!h.done;h=l.next()){s=h.value;if(this.loadingTextures>=this.concurrentLoadingTextures||this.downloadingTiles>=this.concurrentDownloadingTiles)break;c=Object(y.e)(s.targetQuality,s.minQuality,s.maxQuality);!s.loading&&s.quality<c&&this.loadTexture(s,s.quality+1)}}catch(t){e={error:t}}finally{try{h&&!h.done&&(n=l.return)&&n.call(l)}finally{if(e)throw e.error}}o.e.debugLOD&&(this.textureScoreRenderPass.render(this.modelMesh,this.camera,!0),this.textureQualityRenderPass.render(this.modelMesh,this.camera,!0))}},t}();function S(t){for(var e=a.b;t>a.d[e].texelSize&&e>a.c;)e--;return e}}).call(this,"/index.js")},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(52),i=n(267),o=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},a=function(){function t(t){this.textureName=t,this.chunks=[],this.minQuality=r.c,this.maxQuality=r.c,this.targetQuality=r.c,this.loading=!1,this.screenCoverage=0,this.screenCoverageScore=0,this.sightings=new i.a(100)}return t.prototype.setTexture=function(t){var e,n;this.texture&&this.texture!==t&&this.texture.dispose(),this.texture=t;try{for(var r=o(this.chunks),i=r.next();!i.done;i=r.next()){i.value.setMeshTexture(this.texture)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.getUrl=function(t){var e=r.d[t].assetType,n=this.textureName.match(/^([a-f0-9]+(_10k|_50k)?)/);if(!n)throw new Error("Unknown format for texture name: "+this.textureName);return n[0]+"_texture_jpg_"+e+"/"+this.textureName},t.prototype.addSighting=function(t,e,n){this.sightings.push({point:t,distance:e,time:n})},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(52),o=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};!function(t){t[t.LOAD_MORE=0]="LOAD_MORE",t[t.STAY=1]="STAY",t[t.UNLOAD=2]="UNLOAD"}(r||(r={}));var a=function(){function t(t){this.slots=t,this.strategy=r.STAY,this.baseSizeUnit=i.d[i.c].textureSize,this.minBudget=this.slots.length,this.maxBudget=this.slots.length*this.getBudgetSize(i.b),this._budget=this.minBudget}return t.prototype.update=function(t){this.budget=this.maxBudget},t.prototype.getBudgetSize=function(t){return t?Math.pow(i.d[t].textureSize/this.baseSizeUnit,2):0},t.prototype.calcCurrentUsedBudget=function(){var t=this;return this.slots.reduce((function(e,n){return e+t.getBudgetSize(n.quality)}),0)},t.prototype.clampBudget=function(t){return Math.min(this.maxBudget,Math.max(this.minBudget,t))},Object.defineProperty(t.prototype,"budget",{get:function(){return this._budget},set:function(t){t=this.clampBudget(t),this.budget!==t&&(this._budget=t,this.updateTargetQualitiesFromBudget())},enumerable:!0,configurable:!0}),t.prototype.updateTargetQualitiesFromBudget=function(){var t,e,n,r,a,s,c=0;try{for(var u=o(this.slots),l=u.next();!l.done;l=u.next()){(m=l.value).targetQuality=i.c,c+=this.getBudgetSize(m.targetQuality)}}catch(e){t={error:e}}finally{try{l&&!l.done&&(e=u.return)&&e.call(u)}finally{if(t)throw t.error}}try{for(var h=o(i.a),f=h.next();!f.done;f=h.next()){var p=f.value;try{for(var d=o(this.slots),y=d.next();!y.done;y=d.next()){var m;if(!((m=y.value).maxQuality<p)){if(c-=this.getBudgetSize(m.targetQuality),(c+=this.getBudgetSize(p))>this.budget)return;m.targetQuality=p}}}catch(t){a={error:t}}finally{try{y&&!y.done&&(s=d.return)&&s.call(d)}finally{if(a)throw a.error}}}}catch(t){n={error:t}}finally{try{f&&!f.done&&(r=h.return)&&r.call(h)}finally{if(n)throw n.error}}},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(0),i=[],o=0,a=function(t,e){if(0===i.length)for(var n=0;n<100;n++){var a=new r.lb(new r.nc(.005),new r.mb);i.push(a)}return function(n){var r=i[o++%i.length];r.position.copy(n.point),r.scale.set(n.distance,n.distance,n.distance),r.material.color.setHex(t),r.parent||e.scene.add(r)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(865);e.adapters=r.default;var i=n(868),o=n(869),a=n(870);e.query=function(t,e){return Array.isArray(t)?e?new e(t).queriesBuilder(t):new o.default(t).queriesBuilder(t):e?new e(t).queryBuilder():new o.default(t).queryBuilder()},e.mutation=function(t,e){return Array.isArray(t)?e?new e(t).mutationsBuilder(t):new i.default(t).mutationsBuilder(t):e?new e(t).mutationBuilder():new i.default(t).mutationBuilder()},e.subscription=function(t,e){return Array.isArray(t)?e?new e(t).subscriptionsBuilder(t):new a.default(t).subscriptionsBuilder(t):e?new e(t).subscriptionBuilder():new a.default(t).subscriptionBuilder()}},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAMAAABrrFhUAAAAhFBMVEUAAAD///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8g2+bRAAAAK3RSTlMAswpHBJ4d+GmsJHYX2zYTkGDwT4Prp4kPWjvMP6Ms5uFvMJZVfsPSe7i+UNMvaAAAD+NJREFUeNrs2Yd2okAUBuB/CsPM0AXFXrDL+7/fuutKMclmKSLJyfcAOvdyy3DAjx8/umW7u020VZejsx4OzKvBcO0cD8qIrYBpju9r7Er/7JjpP5nrg3FiAt/MmO3JOq1gcNgGGt+DCIxjWsuQWFOKL40y30kbMYn8spUg5MVM2+D47OvNRmEd0k9cx//KuVpdl8Gn3bCd4wsZy8PHocyUv9mxRFAUcHs5D+XeuHy8JVa+i6+BLcz3Izj7gUvxCS6YtZi9/wtHOUbfedb6vWq/RKGHMu55QugrITyPo4wvA8N574eMKfpsaZhvz3y2Eo47KlwWWJFvKFKiDD+yAuYWO8Nj8TsLdLbr7URkl7dFGzOKG6qZjBbkU4tIMp2lwQ4Ww/TBetPL20E4e/OsLI0bwaRPKvFldh/mbLtKywZR74bB7vgY/UbgD5udRqSW0YnZuJn7w4cU7HtVBewh/KG/xG/clQZpxJAux298d374D6s3KXAfev8cclxR11KkBcr6uzzFySnv1QB9oEfl2vQ1rngWfUs54LcyOJT77PVLkUalxedsxn/fAEnLjEDcym1U+sORwEsxpxR+wAHweUyeIp5zXInSZcO0OF5GkNLO3+GK7gzyNMaO4kqXUjBL8CJB8RjrCa5sqchTKWnfUlAsgpjiBTxVPMOe/gmfdOCWguRS7D0XnWOrNLcQnYWfpyB00oy5QbeoX2xCF8BYKtIZJccAuDVIM8RDh5bHNLOaAODhiHRqFPKHKbx20ZmNmddeRAG4Bumc4eJqtyosRHRDnAurLwFgR+QlIhuAZ3TdBklh+vkU4KEiL6JCDiAc5m0wxdOFZt79DID2yQv5GoB97nAbbNKM8gA+IS824QCkmRclnon7ea4lAOGTl/MFgMTJ7yQcT0NJvvs1AKZIDygGwMuPdqZ4EjHLC40D1CI9YVEA+/zheHiKZFUuf4P0hiEAsOxe6Ai0rfT7AwZg3ovyv1NzAMt1tp+WaB0zs2WbAFySnpEcsLMeHUzRsrmZdZgA6J70zp4Wp7TJ0Co3q39CARqTHoopgG2WgSlalAyK9wxvS3pp6wGIsy5YojXL7Lbdt/FfZojiOlwJtERn+y8AoEekt0a6eFt3PLRCr4vxu71af4+UC0Bm85qiBcIpxs9aKdVIhmyaaGGPOR/bQidTFsqoldZixRo4czQ2LsUfNg3dmsw1xQeonk+spmkIi3NggcZIcf4x0sDCYgL/QTBr0bQG4rbejvNcRgBcUpc6hQIViPCkSF1u8T5goRGW/rUFoOueKWYUlVEW1822BkBauRDp+wVIARCjem0/sVGTPTHqbUMB0Fl6s/ZQGz2mNwcKeLUOs9FoRG9qJd0D7Pv2JqhtdE+iDdBtvS+ZjdT+3rqlwHLQbAzk69RMar3/qMBDK7xA1XozYvfzuw3fgHcA31fuwwlFa+ik8vzZc2DfaAyIYWEBSlKRpGgVrX4CAKTJGDinNxcA8+rfK9pV5wvMHPCc+mNApjdDGxCqWvUzPAWr1gdKAIlZdwzo+wBgADWqbb4xnmRcbScaNH+ODkU1h/QmBmCRChYJnij5Rd25LScLBEG4WVjkpKIQxROJ0eTX+P7v91+IswHRnbUquvvdJVWpCM70dA+IRikh/dXJ88cm4CowTEDlGH/KuDTMRdkbzXIDwkvrJIYCsMCfszCUgUK9l3xiJZ5BblD+NZ5AbdAGeQBI80ng00kzOuFlhadQlUYlOX5vyjkEEzFs/qIGEhPn8RzMfFkC7E9nZqZLkC8gyG1qf8XCpAnIEC7ZCkijszAQ3Kfim+wIw2nT0uBAolEAWcyV2yWezJL90jIgpb2ugQc8Aii5/6TG06ljrjYDQaNq7wJ6PGUBRvwl3AtIYv6StOCPwqWyjoG09/03qQEZAD9NtBPcEDCt+Aq4xItY8nXwkyabhvXpzAGoZlbq/wOzYFYBkt7Y+xxVqUQWzv8H/UCktL3EPahStkAW2+b/HveEcaZKQHAW4R/sAijxYkrTEtjiDsmvAuAJ7Ms/xFzxRpUqgY8At9lRmTALoMbLqZklQBZ/j5uIKQlFZr8AmglhRv290m6CBxkQOSEABjIQASNtKGyuhUpAcEbAZgwrGG84g0CQyZM6F5wAe4/BJyzh02Owp83IoLo/A7+ZKWALa9iyEgGFwgi9VI1KLniXwmYvn4AEz7WvgUPzWTf0MlEzcG53BHgsFMyB8HRmhGsoMeZA6OnJYRW5pyekqJOjh+x0pgYmnh7LHnKXeHomJIPvvUJC/RFI6zPQNRFPBpsLZWtcs6JFwIihgNY8wuaCmLF2Yznd9dclVCYgdcQDGzvilBY+b8EtG7xiucDYugJgv+zmOpl/axmcsjrAjicYdZiwemB3Yw6IgUEHxJaEgDbj2KAHhujg0++D2L0RwB0EsZoDCdqoyhhxsrWVZKwe2PTngSFpQ+RSCjLNRBE5fq/XBg4EIF0zgSZ2ULYOlSCLeOTUkYS1SE73/uvbC+U0BH0XTRDfDPnAnI6V+H1WDq5KIE8GD4DfIwKV6ouZPlZbzFwbYoBx44Z7XMA3ELq1CDFfjIQ08RIoUronwHcxBpgEAp8uEU2u16EFwwUcYDUHvhPYXWtgCOw8DQWspvA07ICaGr6ThKaA8HRY/v0neg0TCC6HS4zolGi91AaWs2H42BUVfINqCl8fKC0nZajgprsUmVNAipwegqxBGNHQU3oekw8sHZcAhgiUZHtkdyGcARt3g9AFqVexsDsG3s5GGBDOSwBDBARwHgMfnSQwBEKHk+CFBd8MB+17446MdZgD3/azZqzFftppoCBN8J1dBikSfhrw2zYgZazWrU5CZwTjosZXOw6l9GPq/hAApF7Io/ZSaE5ZsHTjtrB7sA6iaH+aVJIPyt28IvKfvTNoTRgIovCAm4gxEhOwFMHqQYL9/3+wl5mJUyis1EOSb/fW3lyym5l57315TR85ujxURVmwEamW3QvndcSVN8S7mJFoRXZL7wRyuoGdawNjHIckSbPNhrw1R5IkRbfYwSrhbjHWyH/ZJjuRbZCIbzYgaVdQB2VUQq3IEJqBk83J68U3wyJ5v+IUpIHBrGP1gkWhabUZG3ANU0E9EBkPz4zcsX+vz4yDrNfeyxsw2289Pq9UNiB7A8oRKJdgeQ2GQqhjFEKdF0KlFC7NUGmHn5SxL+xApNIUBXYkhh+K7lUdx47Fe+WLYIWRDV0aaxQfixVHE1Qe33p3f9O/KQaJ5AaJWArWWIuM3QlYk9RDX4swm9z+t1v+gjVK1hqbxVplZdDXANUsLaM3xMe12+WP0S4fc6M9NjCh/6qwkZlGi2FsaEo0Ut1RY3Pmk9pQg5Oem8NGZ886KMeGp42g0VLj83YJ9FSAgs1JL1iERmOAISpExSEia8foOC4nrgmyRQUp2c5csSgtB81RYWr+bFBxetPeUIGKdjruVKSmPR3fVKiqo7drKlbX2qQHFaxs/cAhQdHazta+U+HqNi4dqXh9OdsdQf3AgolmH9RPbPyQd2+7jcJAGID/MbY54zSkkIQcSbpq1+//fqvdBJterFRzCEh8l71oizszNrHU3zSJXGjICvjFdElCP3GcfC/cHoeM2cG1ydpbaNCSCdoRS43awqYpgYWGrWHblMBS4/ZM5m690MBFsHf9z++lRm6aiNp8oaGrYOfmpXChsbt4a1ZrocHL5o1gLRcavW1eCmmh4etAoR/uC43fN+9NZ+Wy1rTZ4iW2G3KpS3U277g/ZIeGcGoCEie8wEmQUwMIhy2wwSt7GJAh0ZwGwY5+LpT2CFBxOKifTfCeAB452CiMSm3IgQck788GqOGk1OaeCDE5ONYYUX0kB7HNEtcl3LBUPwQAE+TiusVItldyIRgQ6IeUwVHm29KRIbkoPIzCK8hFKG0r+xmcxc3aKeBAblYRBhetyM0BUKnNEndH9kCIgBwFDINi7r/Bt0foQl3shwj8gxwVO4bBsF1Bjj64/XDnomB0GQPaA1hJrsI3hUGot5BclQzw9PcB0H0MrE8Au5GzMEjQWxKE5OzGgNPaHAE7o6aGEkAJ6uAaoZfoSh0IBSSX7wOg3xioGCAL6kLsEnSU7AR1UUiAVXYA9LD3W8sYhdRN6TE4Y15J3YRRq3j9PXq56qcbgIy6Cj9zCQcy/wypqwzATT9d0dNKtw7THvVwjD2JH5BefKQePAClflqht6Nu3Snk1I+Id4eI4T9YdNjFgvrJW7c7+oj++Fe7mjwagNgEubevI5lsOd8mMqr3Xh5sBA3Aa/ftF0d/dp7qAEAW0oyFGYBA271rECpt10BU0GwVUfvvnyoMRJ710ycAKWimhATwqZ/OEoM5rdt7gbrRLN1Ue/6vTxjQ3m+fB1hJM1Sy9v7v7zEoz6wAMYB90Ox8MICReX4PA9ubLqgSgAc0MwEHksrU/x6DO5lJeDkBOMxqOwwPAE4XM/9OGIFMzfp6M9sMhATgmRpNJUahKt0+FrOYZiJm7eOvrhRGwr50gxQAbxZtEHoAFOnGF8No+FE30hqAXNHkVhJAnerGkWNMK93wAwB8RxPbcQCBrxsrjCz2ba0l5r5iAvYGJrGd6ccY3f6iG+85AJ6HNJEw5wDyd9247PECirQhFIBkQ5PYJACU0AYpOOrfBuc7AGSCXk5kAHA/v7D8reyiDZIAeF7QSxU5ByBJG5cMDoZsg3XMAWyDkF4mDLYAeLyeoPxbbWCk+eMOi17kceOWp3qC8reyVFu/69csgX38+re20gwTYKWvLRF1uMnsfN8aCW35JcM06kpb/mMJ2F3QaMSdPR7f11ZVYzI89r8tgQQAfihpFOWBA4AU335ozDElWegWv8geX30TNDDxJvFXVvi6pZj+n7zuK932684BgGdxSIMJ4+zxXe+/dFs1j9ibP+3d626CMBQAYKGUVkqRdlSNomCQi573f7+xsBFuytAtlsTvbxOS9hzaENpTEUETL6qomPUYPN17s8qrgkNTpE09J5MpaLmUaVDlAcVPZj71vh91vkCLYjqV8jFTCS3KDxcVFxVr4yHrArmLSugraJGpTt3/sg0ktEVJaNW//GliTJLQejOBFSYRtMng5Ye2B5inGDrUQbh1s4NocDBGHQKKnDq8rjgo6IhPukX/h3XeQ0++QavGKNkeEizw8bIz02E/YAJ5dqNvK7TJoWd/1vreyx0m0MexOFrd0Vq5tu2UbNtd9RqPAnPoI1iPhe+eLc1hCNljhuxfbRHCewJDcqrjqz/A8yO4gfArTulHeHStVsTdY/hBU3zlBG6IfG8xI2GiYASRKuKlSEkCI1QygxuOOizkc/gT3Edaz3t3ONQg8BRiUM0K901l7pih4CHKYDtdV/yJHJFkEiaQWSJmHvk+GxU4i2FEnOECvf4j//9YDhJsg5dZzmMlSUmqmOfZEm+YQM5cZ7u3t7n6BCyj3BOxzBQ1AAAAAElFTkSuQmCC"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAMAAABrrFhUAAAAP1BMVEUAAAD///////////////////////////////////////////////////////////////////////////////9Du/pqAAAAFXRSTlMAmYWNk1l7bCJCEQpjKHQ0GE9HHToMZFdDAAAHfklEQVR42uzcC3LcIAwAUAnxMT//73/WTmcnnWw7za6xMMLJO0HsCEkI1vDjx49rhbz7xaTRKkWkETWRUnZMZvF7DnBjIa9pVPiCGtN6v/cw72YkPIBGs89wD8PqCIuQWwfoW/BO4yna+W7XQzYKWSiToTvZEDKivt7BZgjZkdmgC9FbrMT6CNINSWNFOsmuC5PF6uwEUnmFl1AeBIoL4WVoEZcMFsJL0QKSrISXoxWk2AmboB0kGCw2Y9sXxZCwqRSgqVVjY3qFdjaLAtgNGllQiAVaGBSKoRokQ9989X+mPVwrOhTGRfjSfcP/rWVw6/B/vQxuH/6vlsH9w//LZfAtwv+6ZWBQOANVJRQvQUVi099nDmqJIvY+r9kIVQTB6f+ZClDB3M3zI6oZ2A2EHaEBmGXR5f9fOgOrobPnR9QDMJq7iv8Hmr9j/q9TC2KXz4+oIvCwWIUmZUfnRqtIYxVWZv+rnPE5RHgSQ/bGKUQU1xUn5GPNtMGXtslYWTsjg0yUmSK8JU5Gidkde+Sg3RTgkDA5jRy8gAbI+lh43ax5Q8RQANUyQ7F5UW2LocOTxgwn5bFhKVjxHDcAg8HhOWujBJA2YLIl9jRQPwGkGRjNqUEacKIu7wz26jTgsRh5qMDTpd3AoMVdXArpyjSgsJDKUE0u/6vgoEXo0ZS56B7RhmVogsomwjLbFTMQO0N1s71gOrKKDP8PpnpDGDQW0BNcZCr7+wK8K8k4jOE+pkrwpkHKcRz3QeUA77FiDmT/L6h6eXDH48YIF4sjHrfDO0jSpQzezRrBG9ZOnr/oDaxVAmCERsYaIbCUjBsaiYp/SxBJev4/VwsocgcAzdDQTNwhQNcMHNtdXSHmOVjzn3JPvNMxJXP/x7k3VJyv04IAljFobU8J8MNMbP+1obcE8DCxbQpTdwngwTDNBaI+mE3EUHiEjjw1UNCnjTJPJbRyfplR9yaX5TgLIFHfOAuER2wMqUTYp2w8Q/qm7lqg4vVL5xNJ+493/GU4ncBNtxmwIA+asytARA/8bD65BnLnAXAwBPK5FSDy04bbuTWg5I/BX3Fn+vjQdQkoKAQBnvkezgFeGU80cq7PXdCzfGIZ6y63wScSmYYng/jvNr1lKU5ka99N0Ie5+JzUdbwN+syWJgHqdh9cXMyoMHS0uO+5fhZ12VLeu+8CP7iy+zKmu7MAhjMCU9ZCiRoF/iuUNbR0hy7oQZVkwdDhadD/mJJgzrdJAYeSQC7pA0UXwd9iSS+Y7tEGPtiCwd54nxQAYArKgLpPCgCYCipa59PQ4tloQRWEDiAerYMZb9MGHVvQGR52vMlO6MEd3g55vFEROFIGPDwseIthyPGhyPLnlXU/EP/F3pkjAQzCMBDGDBXh/8/NpMmQUunslZ/gHPiQljMu+YVevUgvrB5q6y0Ey3QCWjewz3OjTBkgFAJTTcBoKWIIZY2WgGgpItQERKlC8McDjULTgCemmoCRXhjwja3+03qpVkBpBpwAfwL+CfoYdCHkUrjNDm+G8O0wfiCCH4nhh6L4sTh+MYJfjeGXo/j1uAUSeIkMXiSFl8nhhZJ4qSxeLG25PN4wgbfM4E1TeNucjZN46yzePI23zxuggEdo4CEqeIyOQUp4lBYepmacHh6oiEdqGqqKx+riwcpGa+Ph6ni8vi9YwF+xcbN3pzkOwjAUgJ9DFrLQQLn/XUfzZzSbWjBOa5bvBBEimx3pXSErp4/ZuYKWTh+1dYWtnT5u7/SBi1fk5hW6evrY3St4+fTR21f4+unj95EsMdiKF6m88SV8WboV6rwbOmK5YwVPLH5EcyN3bCtbzTxdRWO1I5559XsrldPAEdPEqDTzmAHNDPxRcSoNXCWhiVSIgV23icTWRTQQO2KLYAjE53sI6z3xBXa5ga+MEDQW2sBkdsFxizJDyFyIQaBwG2mb0ENAH2ibCLZAG90GbDTcaKMgUXXkM9MItnESGEAW6jvw+ZjBkKMnBuHOTSQJNtSEVVINliRE4cM3n3E1Y5FcnSEhDpsVkuNdnfHQXJ0nOQUCAskywcUhZfyQ0xBdMCQrQISnJmxn/C2EmzedpSa8XAtul+SalmmXX0CyVTF2tDt/Hy68/UC0nIID0G/Dzr6AHfDp7c0YCVraVOOOVsKfjcrz7QWtWtXZ0y74jP9oPBV/UXj+/V8h9Qr+UNGaekbR/fexqPpAYCOa6xVvBqbHC2S1S2HIeI27ymlg73jg+NPgye9/+Gmw4Pc/8m6wbPU/7jQwPd5hIiUmvMms4nbkZ6xxtA2Ru/kpeLj0nboHWYzHO2yqniJ9tHN3OwiDMBSA1x7KxgQU5P2f1QtvTIxubox1Zt8btOEnJOUsUkC7QOm0yKDmkDtNEqgpqIt1vLRsAZLKbFvH1AQri/B5cbW0Obv7h/WvBm9oQ8bruPimhrs2Yp3Krf/uLqDqICpjHD8JgrrVK4ptmisIUxV8xOqfRtebtSOWbv/nzjpD7kGLoM/6z/x5bkUi6AeIUlSkNNU0huwj0wSOPoejr/qJPhSXxEfLDBgiAzDb6CW58t+Vn04aPQDVw5SJCNPsmgAAAABJRU5ErkJggg=="},function(t,e,n){t.exports=n.p+"images/tagmask.png"},function(t,e,n){t.exports=n.p+"images/tagbg.png"},function(t,e,n){t.exports=n.p+"images/scope.svg"},function(t,e,n){t.exports=n.p+"images/vert_arrows.png"},function(t,e,n){t.exports=n.p+"images/surface_grid_planar_256.png"},function(t,e,n){t.exports=n.p+"images/chrome.png"},function(t,e,n){t.exports=n.p+"images/firefox.png"},function(t,e,n){t.exports=n.p+"images/internet-explorer.png"},function(t,e,n){t.exports=n.p+"images/safari.png"},function(t,e){t.exports="precision highp float;\nprecision highp int;\n\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nattribute vec3 position;\n\nvarying vec3 vUvw;\n\nvoid main() {\n  vUvw = position;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n"},function(t,e){t.exports="precision highp float;\nprecision highp int;\n\nuniform samplerCube tMap;\n\nvarying vec3 vUvw;\n\nvoid main() {\n  vec4 color = textureCube(tMap, vec3(-vUvw.x, vUvw.yz));\n  gl_FragColor = vec4(color.rgb, 1.0);\n}\n"},function(t,e){t.exports="precision highp float;\nprecision highp int;\n\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nattribute vec3 position;\nattribute vec2 uv;\n\nvarying vec2 vUv;\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n"},function(t,e){t.exports="precision highp float;\nprecision highp int;\n\nvarying vec2 vUv;\nuniform float progress;\nuniform float opacity;\nuniform sampler2D tNoHover;\nuniform sampler2D tHover;\nuniform sampler2D tPortal;\n\nvoid main() {\n  vec4 noHoverColor = texture2D(tNoHover, vUv);\n  vec4 hoverColor = texture2D(tHover, vUv);\n  vec4 portalColor = texture2D(tPortal, vUv);\n\n  float xToCtr = 2.0 * vUv.x - 1.0;\n  float yToCtr = 2.0 * vUv.y - 1.0;\n\n  float withinRadius = step(xToCtr * xToCtr + yToCtr * yToCtr, 0.9);\n  vec4 mixedPortalColor = mix(hoverColor, portalColor, withinRadius);\n  mixedPortalColor = mix(mixedPortalColor, hoverColor, hoverColor.a);\n  mixedPortalColor = mix(noHoverColor, mixedPortalColor, progress);\n  mixedPortalColor.a = min(mixedPortalColor.a, opacity);\n  gl_FragColor = mixedPortalColor;\n}\n"},function(t,e,n){t.exports=n.p+"images/exterior.png"},function(t,e,n){t.exports=n.p+"images/exterior_hover.png"},function(t,e,n){t.exports=n.p+"images/interior.png"},function(t,e,n){t.exports=n.p+"images/interior_hover.png"},function(t,e){t.exports="precision highp float;\nprecision highp int;\n\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nattribute vec3 position;\nattribute vec2 uv;\n\nvarying vec2 vUv;\n\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n"},function(t,e){t.exports="precision highp float;\nprecision highp int;\n\nvarying vec2 vUv;\nuniform sampler2D tMask;\nuniform sampler2D tPinHole;\nuniform vec3 pinColor;\nuniform float opacity;\n\n// The pin mask has red color which should be replaced with the pin's image.\n// and white color that can be replaced with any other color.\n// 0.1 means color must be almost fully red to be considered red\n// 0.9 means color only has to contain a tad red to be considered red.\n#define COLOR_TOLERANCE 0.9\n\nvoid main() {\n  vec4 maskColor = texture2D(tMask, vUv);\n\n  // The pin hole is slightly off center; the hole center is at y = 110 of the pin with height = 128\n  // so we shift the sampling of the pin hole texture (in NDC) by 110 / 128 / 2 = 0.11\n  vec4 pinHoleColor = vec4(texture2D(tPinHole, vec2(vUv.x, vUv.y - 0.11)).xyz, 1.0);\n\n  float maskHasRed = step(COLOR_TOLERANCE, maskColor.r);\n  float maskHasntBlue = step(maskColor.b, 1.0 - COLOR_TOLERANCE);\n  vec4 mixedPinColor = mix(vec4(pinColor, 1.0), pinHoleColor, maskHasRed * maskHasntBlue);\n  mixedPinColor.a = min(mixedPinColor.a, maskColor.a) * opacity;\n  gl_FragColor = mixedPinColor;\n}\n"},function(t,e,n){t.exports=n.p+"images/360_placement_pin_mask.png"},function(t,e,n){t.exports=n.p+"images/puck_256_red.png"},function(t,e,n){t.exports=n.p+"images/selected_sweep_glow.png"},function(t,e,n){"use strict";n(466),n(639),n(658),n(662),n(491),n(702);if(Math.sign||(Math.sign=function(t){return t>0?1:0===t?0:-1}),Number.parseInt||(Number.parseInt=window.parseInt),Number.parseFloat||(Number.parseFloat=window.parseFloat),Math.log2||(Math.log2=function(t){return Math.log(t)*Math.LOG2E}),!window.location.origin){var r=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"");window.location.origin=r}Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{enumerable:!1,value:function(t){return this.filter((function(e){return e==t})).length>0}});var i=Object.keys;Object.keys=function(t){switch(typeof t){case"string":for(var e=[],n=0;n<t.length;n++)e.push(n.toString());return e;case"boolean":case"number":case"function":return[];default:return i(t)}},Array.prototype.fill||Object.defineProperty(Array.prototype,"fill",{value:function(t){if(null==this)throw new TypeError("this is null or not defined");for(var e=Object(this),n=e.length>>>0,r=arguments[1],i=r>>0,o=i<0?Math.max(n+i,0):Math.min(i,n),a=arguments[2],s=void 0===a?n:a>>0,c=s<0?Math.max(n+s,0):Math.min(s,n);o<c;)e[o]=t,o++;return e}}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(t,e){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),r=1;r<arguments.length;r++){var i=arguments[r];if(null!=i)for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])}return n},writable:!0,configurable:!0}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),n=e.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var r=arguments[1],i=0;i<n;){var o=e[i];if(t.call(r,o,i,e))return o;i++}}}),Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),n=e.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var r=arguments[1],i=0;i<n;){var o=e[i];if(t.call(r,o,i,e))return i;i++}return-1}}),Array.prototype.every||(Array.prototype.every=function(t,e){var n,r;if(null==this)throw new TypeError("this is null or not defined");var i=Object(this),o=i.length>>>0;if("function"!=typeof t&&"[object Function]"!==Object.prototype.toString.call(t))throw new TypeError;for(arguments.length>1&&(n=e),r=0;r<o;){var a;if(r in i)if(a=i[r],!(n?t.call(n,a,r,i):t(a,r,i)))return!1;r++}return!0});var o,a=n(73),s=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},c=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(s(arguments[e]));return t},u=function(){function t(t){this.fetchedModules=[],this.engine=t,this.messageBus=t.msgBus,this.market=new l(t.market),this.commandBinder=t.commandBinder,this.getModuleByParent=t.getModuleByParent.bind(t),this.getModuleSync=t.getModuleSync.bind(t),this.addComponent=t.addComponent.bind(t),this.getComponentByType=t.getComponentByType.bind(t),this.getComponents=t.getComponents.bind(t),this.removeComponent=t.removeComponent.bind(t),this.subscribe=t.subscribe.bind(t),this.unsubscribe=t.unsubscribe.bind(t),this.broadcast=t.broadcast.bind(t),this.claimRenderLayer=t.claimRenderLayer.bind(t),this.getRenderLayer=t.getRenderLayer.bind(t),this.disposeRenderLayer=t.disposeRenderLayer.bind(t),this.startGenerator=t.startGenerator.bind(t),this.stopGenerator=t.stopGenerator.bind(t),this.after=t.after.bind(t),this.deactivate=t.deactivate.bind(t),this.toggleRendering=t.toggleRendering.bind(t),this.getXrFrame=t.getXrFrame.bind(t)}return t.prototype.getModule=function(t){var e=this,n=Date.now();return this.engine.getModule(t).then((function(t){var r=Date.now();return e.fetchedModules.push({moduleName:t.name,isModule:!0,startAwait:n,finishAwait:r}),t}))},t.prototype.getLoadedDependencies=function(){return c(this.fetchedModules,this.market.getLoadedDependencies())},Object.defineProperty(t.prototype,"msgBus",{get:function(){return this.messageBus},enumerable:!0,configurable:!0}),t}(),l=function(){function t(t){this.fetchedData=[],this.market=t,this.register=t.register.bind(t),this.unregister=t.unregister.bind(t),this.tryGetData=t.tryGetData.bind(t),this.getModuleNameFromData=t.getModuleNameFromData.bind(t)}return t.prototype.waitForData=function(t){var e=this,n=Date.now();return this.market.waitForData(t).then((function(t){var r=Date.now();return e.fetchedData.push({moduleName:e.getModuleNameFromData(Object(a.b)(t)),isModule:!1,startAwait:n,finishAwait:r}),t}))},t.prototype.getLoadedDependencies=function(){return this.fetchedData},t}(),h=n(24),f=n(2),p=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},d=new f.a("module-loader");!function(t){t[t.Registered=0]="Registered",t[t.Loading=1]="Loading",t[t.Initialized=2]="Initialized",t[t.Unloaded=3]="Unloaded"}(o||(o={}));var y=function(){function t(){this.registeredModules={},this.typeLookup=new a.a(!0)}return t.prototype.registerModule=function(t,e){var n=this.typeLookup.addIndexByType(t),r={type:t,es6ModulePromise:e,ctorPromise:new h.a,initPromise:new h.a,state:o.Registered};this.registeredModules[n]=r},t.prototype.getTypeID=function(t){var e=this.typeLookup.getIndexByType(t);if(-1===e)throw Error("Trying to access unregistered Module");return e},t.prototype.getTypeFromTypeID=function(t){return this.typeLookup.getTypeByIndex(t)},t.prototype.moduleRegistered=function(t){return-1!==this.typeLookup.getIndexByType(t)},t.prototype.getModule=function(t){var e=this.typeLookup.getIndexByType(t);if(-1===e)throw Error("Trying to get "+Object(a.d)(t)+" before it was registered!");if(this.registeredModules[e].state===o.Unloaded)throw Error(Object(a.d)(t)+" module unloaded");return this.registeredModules[e].initPromise.nativePromise()},t.prototype.getModuleByParent=function(t){var e,n,r=this.typeLookup.getIndicesByType(t);if(0===r.length)throw Error("No registered modules derive from "+Object(a.d)(t)+".");var i=[];try{for(var o=p(r),s=o.next();!s.done;s=o.next()){var c=s.value;i.push(this.registeredModules[c].initPromise.nativePromise())}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return Promise.race(i)},t.prototype.getModuleSync=function(t){var e=this.typeLookup.getIndexByType(t);if(-1===e)throw new Error("Trying to get "+Object(a.d)(t)+" before it was registered!");var n=this.registeredModules[e];if(n.state!==o.Initialized)throw Error(Object(a.d)(t)+" module not loaded!");return n.module},t.prototype.loadModule=function(t,e,n){void 0===n&&(n={});var r=this.typeLookup.getIndexByType(e);if(-1===r)throw Error("Attempting to load an unregistered module");var i=this.registeredModules[r];if(i.state===o.Initialized)return i;if(i.state!==o.Registered&&i.state!==o.Unloaded)throw Error(Object(a.d)(e)+" already loading");return i.state=o.Loading,i.es6ModulePromise().then((function(r){if(!r.default)throw new Error(Object(a.d)(e)+" has no default export during module loading");var s=new r.default;i.ctorPromise.resolve(s).then((function(){var e=Date.now(),r=!1;setTimeout((function(){r||d.debug(s.name+" init took over 2 seconds")}),2e3),s.init(n,t).then((function(){d.debug(s.name+" init took "+(Date.now()-e)/1e3+" secs."),r=!0,i.state=o.Initialized,i.module=s,i.initPromise.resolve(s)})).catch((function(t){i.initPromise.reject(t)}))}))})).catch((function(t){d.error("Failed to load es6Module for "+Object(a.d)(e)+": "+t),i.initPromise.reject(t)})),i},t.prototype.whenQueueEmpties=function(){var t=[];for(var e in this.registeredModules){var n=this.registeredModules[e];n.state===o.Loading&&t.push(n.initPromise)}return h.a.all(t).nativePromise()},t.prototype.unloadModule=function(t){var e=this.typeLookup.getIndexByType(t);if(-1===e)throw Error("Attempting to unload unregistered module");var n=this.registeredModules[e];if(n.state===o.Unloaded||n.state===o.Registered)throw Error("Attempting to unload not-loaded module");n.state=o.Unloaded,n.ctorPromise=new h.a,n.initPromise=new h.a,n.module=void 0},t}(),m=new f.a("market"),v=function(){function t(){this.typeLookup=new a.a,this.store=[],this.moduleRegistry=[],this.firstUpdatePromises=[]}return t.prototype.register=function(t,e,n){var r=this.typeLookup.getIndexByType(e,!0);if(this.moduleRegistry[r])throw Error("Data can only be registered to one Module");this.moduleRegistry[r]=t,this.store[r]=n,n.commit(),this.firstUpdatePromises[r]&&(this.firstUpdatePromises[r].resolve(this.store[r]),delete this.firstUpdatePromises[r])},t.prototype.unregister=function(t,e){var n=this.typeLookup.getIndexByType(e,!0);if(!this.moduleRegistry[n])throw Error("No Data was registered to the Module");delete this.moduleRegistry[n],delete this.store[n]},t.prototype.getData=function(t){var e=this.typeLookup.getIndexByType(t);if(e in this.store)return this.store[e];throw Error("Data not present.")},t.prototype.waitForData=function(t){var e=this,n=this.typeLookup.getIndexByType(t,!0);return n in this.store?Promise.resolve(this.store[n]):(this.firstUpdatePromises[n]||(this.firstUpdatePromises[n]=new h.a,setTimeout((function(){f.a.level>=3&&!(n in e.store)&&m.debug("still waiting for "+(new t).name+"-data after 5 seconds")}),5e3)),this.firstUpdatePromises[n].nativePromise())},t.prototype.tryGetData=function(t){try{return this.getData(t)}catch(t){if("Data not present."!==t.message)throw m.error("tryGetData",t.message),t}return null},t.prototype.debugData=function(){var t={};for(var e in this.moduleRegistry){var n=this.moduleRegistry[e];n&&(t[n.name]||(t[n.name]=[]),t[n.name].push(this.store[e]))}return Object.freeze(t)},t.prototype.getModuleNameFromData=function(t){var e=this.typeLookup.getIndexByType(t);if(-1!==e){var n=this.moduleRegistry[e];if(n)return n.name}throw Error("Data not present.")},t}(),g=n(298),b=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},w=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},_=function(){function t(){var t=this;this.typeLookup=new a.a,this.bindings=[],this.queuedCommands={},this.hookedCommands={},this.resetHooks=function(){t.hookedCommands={}}}return t.prototype.addBinding=function(t,e){var n=this,r=this.typeLookup.getIndexByType(t,!0);if(this.bindings[r])throw Error("Command already bound to a callback");return this.bindings[r]=e,this.callQueuedCommands(r),{renew:function(){n.bindings[r]!==e&&n.addBinding(t,e)},cancel:function(){return n.removeBinding(t,e)},active:this.bindings[r]===e}},t.prototype.removeBinding=function(t,e){var n=this.typeLookup.getIndexByType(t);if(-1===n)throw Error("Trying to unbind unbound command");if(this.bindings[n]!==e)throw Error("Trying to unbind unbound callback");delete this.bindings[n]},t.prototype.issueCommand=function(t,e){void 0===e&&(e=!0);var n=this.typeLookup.getIndexByInstance(t),r=this.bindings[n];return r?this.issueCommandHelper(t,n,r,e):Promise.reject("Command not bound: "+t.id)},t.prototype.issueCommandHelper=function(t,e,n,r){return void 0===r&&(r=!0),this.hookedCommands[e]&&!this.hookedCommands[e].resolving?this.issueHookCommand(t,e):n(t.payload)},t.prototype.issueCommandWhenBound=function(t){var e=this,n=new h.a;return this.issueCommand(t).then((function(t){return n.resolve(t)})).catch((function(r){var i=e.typeLookup.getIndexByInstance(t,!0);e.queuedCommands[i]||(e.queuedCommands[i]=[]),e.queuedCommands[i].push({command:t,deferred:n})})),n.nativePromise()},t.prototype.callQueuedCommands=function(t){var e=this,n=[];this.queuedCommands[t]&&(this.queuedCommands[t].forEach((function(t){n.push(e.issueCommand(t.command).then((function(e){return t.deferred.resolve(e)})))})),Promise.all(n).then((function(){delete e.queuedCommands[t]})))},t.prototype.hookCommand=function(t,e,n){var r=this.typeLookup.getIndexByType(t,!0);if(this.hookedCommands[r]){if(e&&null!==this.hookedCommands[r].preCommandCallback)throw Error("Command "+t.name+" has already been pre hooked");if(!e&&null!==this.hookedCommands[r].postCommandCallback)throw Error("Command "+t.name+" has already been post hooked")}else this.hookedCommands[r]={preCommandCallback:null,postCommandCallback:null,resolving:!1};e?this.hookedCommands[r].preCommandCallback=n:this.hookedCommands[r].postCommandCallback=n},t.prototype.issueHookCommand=function(t,e){return b(this,void 0,Promise,(function(){var n,r,i,o,a,s,c;return w(this,(function(u){switch(u.label){case 0:n=this.hookedCommands[e],r=this.bindings[e],i=t.payload,o=n.preCommandCallback,a=n.postCommandCallback,u.label=1;case 1:return u.trys.push([1,7,,8]),o?[4,o(i)]:[3,3];case 2:u.sent(),u.label=3;case 3:return n.resolving=!0,[4,this.issueCommandHelper(t,e,r,!0)];case 4:return s=u.sent(),n.resolving=!1,a?[4,a(i)]:[3,6];case 5:u.sent(),u.label=6;case 6:return[2,s];case 7:throw c=u.sent(),Error("Could not completely issueHookCommand - "+c);case 8:return[2]}}))}))},t}(),x=n(88),S=n(63),T=n(43),M=n(218),E=n(12),P=function(){function t(){this.phaseTimes=[],this.modules={},this.addAppPhase(E.a.UNINITIALIZED),window.profilingData={phaseTimes:this.phaseTimes,modules:this.modules}}return t.prototype.addAppPhase=function(t){this.phaseTimes[t]=Date.now()},t.prototype.addModuleLoadTime=function(t,e,n,r){var i=r.map((function(t){return t.moduleName})).join(","),o=r.reduce((function(t,e){return t+e.finishAwait-e.startAwait}),0)/(n-e)*100;this.modules[t]=[t,t,null,e,n,null,o,i]},t}(),O=n(70),A=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},D=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},R=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},C=new f.a("engine"),I=x.a.End,k=function(){function t(t){void 0===t&&(t=!1);var e=this;this.moduleLookup=[],this.componentLookup={},this.deactivatedHack=!1,this.currentApplication=null,this.moduleProfiler=new P,this.commandBinder=new _,this.market=new v,this.messageBus=new g.a,this.engineGenerators=new S.d,this.layers=new T.a,this.moduleLoader=new y,this.afterPhasePromises=[],this.afterPhaseListenerCount=[],this.resetPromises(),this.subscribe(O.a,(function(t){return e.moduleProfiler.addAppPhase(t.phase)}))}return t.prototype.loadApplication=function(t,e,n){return A(this,void 0,Promise,(function(){var r,i,o,a,s,c,u,l,h,f,p,d,y,m,v,g,b,w;return D(this,(function(_){switch(_.label){case 0:if(t===this.currentApplication)throw Error("Application already loaded");s=(this.currentApplication?this.currentApplication.getManifest():[]).map((function(t){return t.type})),c=t.getManifest(),u=c.map((function(t){return t.type})),l=this.currentApplication,this.currentApplication=null,h=s.filter((function(t){return-1===u.indexOf(t)}));try{for(f=R(h),p=f.next();!p.done;p=f.next())d=p.value,this.unloadModule(d)}catch(t){r={error:t}}finally{try{p&&!p.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}y=c.filter((function(t){return-1===s.indexOf(t.type)}));try{for(m=R(y),v=m.next();!v.done;v=m.next())g=v.value,this.moduleLoader.moduleRegistered(g.type)||this.registerModule(g)}catch(t){o={error:t}}finally{try{v&&!v.done&&(a=m.return)&&a.call(m)}finally{if(o)throw o.error}}if(!l)return[3,4];_.label=1;case 1:return _.trys.push([1,3,,4]),[4,l.unload(this)];case 2:return _.sent(),[3,4];case 3:return b=_.sent(),C.error(b),e&&e(b),[3,4];case 4:return _.trys.push([4,6,,7]),this.currentApplication=t,[4,t.load(this,{coldStart:null===l,autoPlay:n})];case 5:return _.sent(),[3,7];case 6:return w=_.sent(),C.error(w),e&&e(w),[3,7];case 7:return[2]}}))}))},t.prototype.registerModule=function(t){if(this.currentApplication)throw Error("Cannot register modules while application is running");this.moduleLoader.registerModule(t.type,t.promise)},t.prototype.loadModule=function(t){var e=this,n=t;this.moduleLoadInjectionHook&&(n.config=this.moduleLoadInjectionHook(n.type,n.config||{}));var r=new u(this),i=Date.now(),o=this.moduleLoader.loadModule(r,n.type,n.config);return o.ctorPromise.then((function(t){return e.moduleLookup[e.moduleLoader.getTypeID(n.type)]={module:t,initialized:!1}})),o.initPromise.then((function(t){e.moduleProfiler.addModuleLoadTime(t.name,i,Date.now(),r.getLoadedDependencies()),e.moduleLookup[e.moduleLoader.getTypeID(n.type)].initialized=!0})),o.initPromise.nativePromise()},t.prototype.setLoadInjection=function(t){if(this.moduleLoadInjectionHook)throw Error("Hook already registered");this.moduleLoadInjectionHook=t},t.prototype.unloadModule=function(t){return A(this,void 0,void 0,(function(){var e,n,r=this;return D(this,(function(i){switch(i.label){case 0:return e=this.getModuleSync(t),n=this.getModuleIndex(e),this.componentLookup[n]?[4,Promise.all(this.componentLookup[n].map((function(t){return A(r,void 0,void 0,(function(){return D(this,(function(n){switch(n.label){case 0:return[4,this.removeComponent(e,t.component)];case 1:return n.sent(),t.component.dispose(),[2]}}))}))})))]:[3,2];case 1:i.sent(),this.componentLookup[n]=[],i.label=2;case 2:return this.moduleLoader.unloadModule(t),e.dispose(this),[2]}}))}))},t.prototype.waitForLoadingModules=function(){return this.moduleLoader.whenQueueEmpties()},t.prototype.getModule=function(t){return A(this,void 0,Promise,(function(){return D(this,(function(e){return[2,this.moduleLoader.getModule(t)]}))}))},t.prototype.getModuleByParent=function(t){return A(this,void 0,Promise,(function(){return D(this,(function(e){return[2,this.moduleLoader.getModuleByParent(t)]}))}))},t.prototype.getModuleSync=function(t){return this.moduleLoader.getModuleSync(t)},t.prototype.getComponentByType=function(t){var e,n;for(var r in this.moduleLookup){var i=this.moduleLookup[r].module,o=this.getModuleIndex(i),a=this.componentLookup[o]||[];try{for(var s=R(a),c=s.next();!c.done;c=s.next()){var u=c.value;if(u.component instanceof t)return u.component}}catch(t){e={error:t}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}}return null},t.prototype.addComponent=function(t,e){return A(this,void 0,void 0,(function(){var n,r,i,o;return D(this,(function(a){switch(a.label){case 0:for(n=this.getModuleIndex(t),(r=this.componentLookup[n])||(this.componentLookup[n]=r=[]),i=-1,o=0;o<r.length;o++)if(r[o].component===e){i=o;break}if(-1===i&&(i=r.push({component:e,active:!1})-1,e.init()),r[i].active)throw Error("Tried to add already active component: "+typeof e);return[4,e.activate(this)];case 1:return a.sent(),r[i].active=!0,[2]}}))}))},t.prototype.removeComponent=function(t,e){return A(this,void 0,void 0,(function(){var n,r,i,o,a,s,c,u;return D(this,(function(l){switch(l.label){case 0:if(i=this.getModuleIndex(t),!(o=this.componentLookup[i]))return[3,2];a=null;try{for(s=R(o),c=s.next();!c.done;c=s.next())if((u=c.value).component===e){a=u;break}}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return a&&a.active?[4,e.deactivate(this)]:[3,2];case 1:l.sent(),a.active=!1,l.label=2;case 2:return[2]}}))}))},t.prototype.tick=function(){var t,e;if(!this.deactivatedHack){if(I!==x.a.End)throw Error("Engine.tick called outside of waiting. Did the engine get called recursively?!");I=x.a.Begin,this.resolveAfterPhase(x.a.Begin);var n=performance.now(),r=this.lastTick?n-this.lastTick:16;this.lastTick=n,I=x.a.Logic;try{try{for(var i=R(this.moduleLookup),o=i.next();!o.done;o=i.next()){var a=o.value;a&&a.initialized&&a.module.onUpdate(r)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}}catch(t){throw C.error(t),t}this.resolveAfterPhase(x.a.Logic),this.engineGenerators.processGenerators(S.a.Phase,x.a.Logic);try{this.renderComponents(r)}catch(t){throw C.error(t),t}try{I=x.a.Render,this.resolveAfterPhase(x.a.Render),this.engineGenerators.processGenerators(S.a.Phase,x.a.Render),I=x.a.End,this.resolveAfterPhase(x.a.End),this.engineGenerators.processGenerators(S.a.None),this.engineGenerators.processGenerators(S.a.Promise),this.engineGenerators.processGenerators(S.a.Duration)}catch(t){throw C.error(t),t}}},t.prototype.subscribe=function(t,e,n){return void 0===n&&(n=g.b.PERMANENT),this.messageBus.subscribe(t,e,n)},t.prototype.unsubscribe=function(t,e){this.messageBus.unsubscribe(t,e)},t.prototype.broadcast=function(t){this.messageBus.broadcast(t)},t.prototype.claimRenderLayer=function(t){return this.layers.claimLayer(t)},t.prototype.getRenderLayer=function(t){return this.layers.getLayer(t)},t.prototype.disposeRenderLayer=function(t){this.layers.disposeLayer(t)},t.prototype.startGenerator=function(t){this.engineGenerators.startGenerator(t)},t.prototype.stopGenerator=function(t){this.engineGenerators.stopGenerator(t)},t.prototype.after=function(t){return this.afterPhaseListenerCount[t]++,this.afterPhasePromises[t].nativePromise()},t.prototype.getModuleIndex=function(t){for(var e=0;e<this.moduleLookup.length;e++)if(this.moduleLookup[e]&&this.moduleLookup[e].module===t)return e;return-1},t.prototype.getComponents=function(){var t,e,n,r,i,o,a,s,c,u;return D(this,(function(l){switch(l.label){case 0:for(r in n=[],this.moduleLookup)n.push(r);i=0,l.label=1;case 1:if(!(i<n.length))return[3,10];if(o=n[i],!(a=this.componentLookup[o]))return[3,9];l.label=2;case 2:l.trys.push([2,7,8,9]),s=R(a),c=s.next(),l.label=3;case 3:return c.done?[3,6]:[4,c.value];case 4:l.sent(),l.label=5;case 5:return c=s.next(),[3,3];case 6:return[3,9];case 7:return u=l.sent(),t={error:u},[3,9];case 8:try{c&&!c.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}return[7];case 9:return i++,[3,1];case 10:return[2]}}))},t.prototype.toggleRendering=function(t,e){var n,r,i=this.getModuleIndex(t),o=this.componentLookup[i];if(o)try{for(var a=R(o),s=a.next();!s.done;s=a.next()){s.value.active=e}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}},t.prototype.renderComponents=function(t){var e,n,r,i;for(var o in this.moduleLookup){if(c=this.componentLookup[o])try{for(var a=R(c),s=a.next();!s.done;s=a.next()){(h=s.value).active&&h.component.beforeRender&&h.component.beforeRender(t)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}}for(var o in this.moduleLookup){var c;if(o)if(c=this.componentLookup[o])try{for(var u=R(c),l=u.next();!l.done;l=u.next()){var h;(h=l.value).active&&h.component.render(t)}}catch(t){r={error:t}}finally{try{l&&!l.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}}},t.prototype.resetPromises=function(){this.resetAfterPhasePromises()},t.prototype.resetAfterPhasePromises=function(){this.resetAfterPhasePromise(x.a.Logic),this.resetAfterPhasePromise(x.a.Render),this.resetAfterPhasePromise(x.a.Begin),this.resetAfterPhasePromise(x.a.End)},t.prototype.resetAfterPhasePromise=function(t){this.afterPhasePromises[t]=new h.a,this.afterPhaseListenerCount[t]=0},t.prototype.resolveAfterPhase=function(t){this.afterPhaseListenerCount[t]>0&&(this.afterPhasePromises[t].resolve(),this.resetAfterPhasePromise(t))},t.prototype.deactivate=function(){var t,e;this.getModuleSync(M.default).clearInterface();try{for(var n=R(this.moduleLookup),r=n.next();!r.done;r=n.next()){var i=r.value;if(i&&i.initialized){var o=this.getModuleType(i.module);o&&this.unloadModule(o)}}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.deactivatedHack=!0},t.prototype.setXrFrame=function(t){this.xrFrame=t},t.prototype.getXrFrame=function(){return this.xrFrame},t.prototype.getModuleType=function(t){for(var e=0;e<this.moduleLookup.length;e++){var n=this.moduleLookup[e];if(n&&n.module===t)return this.moduleLoader.getTypeFromTypeID(e)}return null},Object.defineProperty(t.prototype,"msgBus",{get:function(){return this.messageBus},enumerable:!0,configurable:!0}),t}();e.a=k},function(t,e,n){"use strict";var r=new(n(2).a)("polyfills"),i=[];window.fetch||(r.debug("Loading polyfill for fetch()"),i.push(n.e(5).then(n.bind(null,1527))));var o=i;n.d(e,"a",(function(){return l}));var a=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},s=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},c=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},u=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(c(arguments[e]));return t}(o),l=function(){return a(void 0,void 0,void 0,(function(){return s(this,(function(t){return[2,Promise.all(u)]}))}))}},,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){(function(r,i){var o,a,s;function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}s=function(){"use strict";function t(t){return"function"==typeof t}var e=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},n=0,o=void 0,a=void 0,s=function(t,e){y[n]=t,y[n+1]=e,2===(n+=2)&&(a?a(m):_())},u="undefined"!=typeof window?window:void 0,l=u||{},h=l.MutationObserver||l.WebKitMutationObserver,f="undefined"==typeof self&&void 0!==r&&"[object process]"==={}.toString.call(r),p="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function d(){var t=setTimeout;return function(){return t(m,1)}}var y=new Array(1e3);function m(){for(var t=0;t<n;t+=2)(0,y[t])(y[t+1]),y[t]=void 0,y[t+1]=void 0;n=0}var v,g,b,w,_=void 0;function x(t,e){var n=this,r=new this.constructor(M);void 0===r[T]&&j(r);var i=n._state;if(i){var o=arguments[i-1];s((function(){return L(i,r,o,n._result)}))}else I(n,r,t,e);return r}function S(t){if(t&&"object"===c(t)&&t.constructor===this)return t;var e=new this(M);return A(e,t),e}f?_=function(){return r.nextTick(m)}:h?(g=0,b=new h(m),w=document.createTextNode(""),b.observe(w,{characterData:!0}),_=function(){w.data=g=++g%2}):p?((v=new MessageChannel).port1.onmessage=m,_=function(){return v.port2.postMessage(0)}):_=void 0===u?function(){try{var t=Function("return this")().require("vertx");return void 0!==(o=t.runOnLoop||t.runOnContext)?function(){o(m)}:d()}catch(t){return d()}}():d();var T=Math.random().toString(36).substring(2);function M(){}var E={error:null};function P(t){try{return t.then}catch(t){return E.error=t,E}}function O(e,n,r){n.constructor===e.constructor&&r===x&&n.constructor.resolve===S?function(t,e){1===e._state?R(t,e._result):2===e._state?C(t,e._result):I(e,void 0,(function(e){return A(t,e)}),(function(e){return C(t,e)}))}(e,n):r===E?(C(e,E.error),E.error=null):void 0===r?R(e,n):t(r)?function(t,e,n){s((function(t){var r=!1,i=function(t,e,n,r){try{t.call(e,n,r)}catch(t){return t}}(n,e,(function(n){r||(r=!0,e!==n?A(t,n):R(t,n))}),(function(e){r||(r=!0,C(t,e))}),t._label);!r&&i&&(r=!0,C(t,i))}),t)}(e,n,r):R(e,n)}function A(t,e){var n,r;t===e?C(t,new TypeError("You cannot resolve a promise with itself")):(r=c(n=e),null===n||"object"!==r&&"function"!==r?R(t,e):O(t,e,P(e)))}function D(t){t._onerror&&t._onerror(t._result),k(t)}function R(t,e){void 0===t._state&&(t._result=e,t._state=1,0!==t._subscribers.length&&s(k,t))}function C(t,e){void 0===t._state&&(t._state=2,t._result=e,s(D,t))}function I(t,e,n,r){var i=t._subscribers,o=i.length;t._onerror=null,i[o]=e,i[o+1]=n,i[o+2]=r,0===o&&t._state&&s(k,t)}function k(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r=void 0,i=void 0,o=t._result,a=0;a<e.length;a+=3)r=e[a],i=e[a+n],r?L(n,r,i,o):i(o);t._subscribers.length=0}}function L(e,n,r,i){var o=t(r),a=void 0,s=void 0,c=void 0,u=void 0;if(o){if((a=function(t,e){try{return t(e)}catch(t){return E.error=t,E}}(r,i))===E?(u=!0,s=a.error,a.error=null):c=!0,n===a)return void C(n,new TypeError("A promises callback cannot return that same promise."))}else a=i,c=!0;void 0!==n._state||(o&&c?A(n,a):u?C(n,s):1===e?R(n,a):2===e&&C(n,a))}var N=0;function j(t){t[T]=N++,t._state=void 0,t._result=void 0,t._subscribers=[]}var B=function(){function t(t,n){this._instanceConstructor=t,this.promise=new t(M),this.promise[T]||j(this.promise),e(n)?(this.length=n.length,this._remaining=n.length,this._result=new Array(this.length),0===this.length?R(this.promise,this._result):(this.length=this.length||0,this._enumerate(n),0===this._remaining&&R(this.promise,this._result))):C(this.promise,new Error("Array Methods must be provided an Array"))}return t.prototype._enumerate=function(t){for(var e=0;void 0===this._state&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===S){var i=P(t);if(i===x&&void 0!==t._state)this._settledAt(t._state,e,t._result);else if("function"!=typeof i)this._remaining--,this._result[e]=t;else if(n===F){var o=new n(M);O(o,t,i),this._willSettleAt(o,e)}else this._willSettleAt(new n((function(e){return e(t)})),e)}else this._willSettleAt(r(t),e)},t.prototype._settledAt=function(t,e,n){var r=this.promise;void 0===r._state&&(this._remaining--,2===t?C(r,n):this._result[e]=n),0===this._remaining&&R(r,this._result)},t.prototype._willSettleAt=function(t,e){var n=this;I(t,void 0,(function(t){return n._settledAt(1,e,t)}),(function(t){return n._settledAt(2,e,t)}))},t}(),F=function(){function t(e){this[T]=N++,this._result=this._state=void 0,this._subscribers=[],M!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(t,e){try{e((function(e){A(t,e)}),(function(e){C(t,e)}))}catch(e){C(t,e)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(t){return this.then(null,t)},t.prototype.finally=function(t){var e=this.constructor;return this.then((function(n){return e.resolve(t()).then((function(){return n}))}),(function(n){return e.resolve(t()).then((function(){throw n}))}))},t}();return F.prototype.then=x,F.all=function(t){return new B(this,t).promise},F.race=function(t){var n=this;return e(t)?new n((function(e,r){for(var i=t.length,o=0;o<i;o++)n.resolve(t[o]).then(e,r)})):new n((function(t,e){return e(new TypeError("You must pass an array to race."))}))},F.resolve=S,F.reject=function(t){var e=new this(M);return C(e,t),e},F._setScheduler=function(t){a=t},F._setAsap=function(t){s=t},F._asap=s,F.polyfill=function(){var t=void 0;if(void 0!==i)t=i;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var n=null;try{n=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===n&&!e.cast)return}t.Promise=F},F.Promise=F,F},"object"===c(e)&&void 0!==t?t.exports=s():void 0===(a="function"==typeof(o=s)?o.call(e,n,e,t):o)||(t.exports=a)}).call(this,n(169),n(144))},function(t,e,n){t.exports=n(640)},function(t,e,n){n(641);var r=n(331);t.exports=r.Object.getOwnPropertySymbols},function(t,e,n){"use strict";var r=n(467),i=n(153),o=n(474),a=n(226),s=n(482),c=n(247),u=n(204),l=n(483),h=n(249),f=n(287),p=n(484),d=n(248),y=n(380),m=n(379),v=n(648),g=n(386),b=n(384),w=n(651),_=n(481),x=n(377),S=n(250),T=n(378),M=n(286),E=n(473),P=n(288),O=n(382),A=n(330),D=n(383),R=n(332),C=n(485),I=n(652),k=n(653),L=n(476),N=n(654).forEach,j=O("hidden"),B=R("toPrimitive"),F=L.set,U=L.getterFor("Symbol"),z=Object.prototype,G=i.Symbol,H=i.JSON,V=H&&H.stringify,W=x.f,q=S.f,Y=w.f,J=T.f,X=P("symbols"),K=P("op-symbols"),Q=P("string-to-symbol-registry"),Z=P("symbol-to-string-registry"),$=P("wks"),tt=i.QObject,et=!tt||!tt.prototype||!tt.prototype.findChild,nt=a&&c((function(){return 7!=v(q({},"a",{get:function(){return q(this,"a",{value:7}).a}})).a}))?function(t,e,n){var r=W(z,e);r&&delete z[e],q(t,e,n),r&&t!==z&&q(z,e,r)}:q,rt=function(t,e){var n=X[t]=v(G.prototype);return F(n,{type:"Symbol",tag:t,description:e}),a||(n.description=e),n},it=s&&"symbol"==typeof G.iterator?function(t){return"symbol"==typeof t}:function(t){return Object(t)instanceof G},ot=function(t,e,n){t===z&&ot(K,e,n),f(t);var r=y(e,!0);return f(n),u(X,r)?(n.enumerable?(u(t,j)&&t[j][r]&&(t[j][r]=!1),n=v(n,{enumerable:m(0,!1)})):(u(t,j)||q(t,j,m(1,{})),t[j][r]=!0),nt(t,r,n)):q(t,r,n)},at=function(t,e){f(t);var n=d(e),r=g(n).concat(lt(n));return N(r,(function(e){a&&!st.call(n,e)||ot(t,e,n[e])})),t},st=function(t){var e=y(t,!0),n=J.call(this,e);return!(this===z&&u(X,e)&&!u(K,e))&&(!(n||!u(this,e)||!u(X,e)||u(this,j)&&this[j][e])||n)},ct=function(t,e){var n=d(t),r=y(e,!0);if(n!==z||!u(X,r)||u(K,r)){var i=W(n,r);return!i||!u(X,r)||u(n,j)&&n[j][r]||(i.enumerable=!0),i}},ut=function(t){var e=Y(d(t)),n=[];return N(e,(function(t){u(X,t)||u(A,t)||n.push(t)})),n},lt=function(t){var e=t===z,n=Y(e?K:d(t)),r=[];return N(n,(function(t){!u(X,t)||e&&!u(z,t)||r.push(X[t])})),r};s||(E((G=function(){if(this instanceof G)throw TypeError("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,e=D(t),n=function(t){this===z&&n.call(K,t),u(this,j)&&u(this[j],e)&&(this[j][e]=!1),nt(this,e,m(1,t))};return a&&et&&nt(z,e,{configurable:!0,set:n}),rt(e,t)}).prototype,"toString",(function(){return U(this).tag})),T.f=st,S.f=ot,x.f=ct,b.f=w.f=ut,_.f=lt,a&&(q(G.prototype,"description",{configurable:!0,get:function(){return U(this).description}}),o||E(z,"propertyIsEnumerable",st,{unsafe:!0})),C.f=function(t){return rt(R(t),t)}),r({global:!0,wrap:!0,forced:!s,sham:!s},{Symbol:G}),N(g($),(function(t){I(t)})),r({target:"Symbol",stat:!0,forced:!s},{for:function(t){var e=String(t);if(u(Q,e))return Q[e];var n=G(e);return Q[e]=n,Z[n]=e,n},keyFor:function(t){if(!it(t))throw TypeError(t+" is not a symbol");if(u(Z,t))return Z[t]},useSetter:function(){et=!0},useSimple:function(){et=!1}}),r({target:"Object",stat:!0,forced:!s,sham:!a},{create:function(t,e){return void 0===e?v(t):at(v(t),e)},defineProperty:ot,defineProperties:at,getOwnPropertyDescriptor:ct}),r({target:"Object",stat:!0,forced:!s},{getOwnPropertyNames:ut,getOwnPropertySymbols:lt}),r({target:"Object",stat:!0,forced:c((function(){_.f(1)}))},{getOwnPropertySymbols:function(t){return _.f(p(t))}}),H&&r({target:"JSON",stat:!0,forced:!s||c((function(){var t=G();return"[null]"!=V([t])||"{}"!=V({a:t})||"{}"!=V(Object(t))}))},{stringify:function(t){for(var e,n,r=[t],i=1;arguments.length>i;)r.push(arguments[i++]);if(n=e=r[1],(h(e)||void 0!==t)&&!it(t))return l(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!it(e))return e}),r[1]=e,V.apply(H,r)}}),G.prototype[B]||M(G.prototype,B,G.prototype.valueOf),k(G,"Symbol"),A[j]=!0},function(t,e,n){var r=n(153),i=n(475),o=r.WeakMap;t.exports="function"==typeof o&&/native code/.test(i.call(o))},function(t,e,n){var r=n(204),i=n(644),o=n(377),a=n(250);t.exports=function(t,e){for(var n=i(e),s=a.f,c=o.f,u=0;u<n.length;u++){var l=n[u];r(t,l)||s(t,l,c(e,l))}}},function(t,e,n){var r=n(477),i=n(384),o=n(481),a=n(287);t.exports=r("Reflect","ownKeys")||function(t){var e=i.f(a(t)),n=o.f;return n?e.concat(n(t)):e}},function(t,e,n){var r=n(248),i=n(479),o=n(646),a=function(t){return function(e,n,a){var s,c=r(e),u=i(c.length),l=o(a,u);if(t&&n!=n){for(;u>l;)if((s=c[l++])!=s)return!0}else for(;u>l;l++)if((t||l in c)&&c[l]===n)return t||l||0;return!t&&-1}};t.exports={includes:a(!0),indexOf:a(!1)}},function(t,e,n){var r=n(480),i=Math.max,o=Math.min;t.exports=function(t,e){var n=r(t);return n<0?i(n+e,0):o(n,e)}},function(t,e,n){var r=n(247),i=/#|\.prototype\./,o=function(t,e){var n=s[a(t)];return n==u||n!=c&&("function"==typeof e?r(e):!!e)},a=o.normalize=function(t){return String(t).replace(i,".").toLowerCase()},s=o.data={},c=o.NATIVE="N",u=o.POLYFILL="P";t.exports=o},function(t,e,n){var r=n(287),i=n(649),o=n(385),a=n(330),s=n(650),c=n(472),u=n(382)("IE_PROTO"),l=function(){},h=function(){var t,e=c("iframe"),n=o.length;for(e.style.display="none",s.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),h=t.F;n--;)delete h.prototype[o[n]];return h()};t.exports=Object.create||function(t,e){var n;return null!==t?(l.prototype=r(t),n=new l,l.prototype=null,n[u]=t):n=h(),void 0===e?n:i(n,e)},a[u]=!0},function(t,e,n){var r=n(226),i=n(250),o=n(287),a=n(386);t.exports=r?Object.defineProperties:function(t,e){o(t);for(var n,r=a(e),s=r.length,c=0;s>c;)i.f(t,n=r[c++],e[n]);return t}},function(t,e,n){var r=n(477);t.exports=r("document","documentElement")},function(t,e,n){var r=n(248),i=n(384).f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return a&&"[object Window]"==o.call(t)?function(t){try{return i(t)}catch(t){return a.slice()}}(t):i(r(t))}},function(t,e,n){var r=n(331),i=n(204),o=n(485),a=n(250).f;t.exports=function(t){var e=r.Symbol||(r.Symbol={});i(e,t)||a(e,t,{value:o.f(t)})}},function(t,e,n){var r=n(250).f,i=n(204),o=n(332)("toStringTag");t.exports=function(t,e,n){t&&!i(t=n?t:t.prototype,o)&&r(t,o,{configurable:!0,value:e})}},function(t,e,n){var r=n(655),i=n(468),o=n(484),a=n(479),s=n(657),c=[].push,u=function(t){var e=1==t,n=2==t,u=3==t,l=4==t,h=6==t,f=5==t||h;return function(p,d,y,m){for(var v,g,b=o(p),w=i(b),_=r(d,y,3),x=a(w.length),S=0,T=m||s,M=e?T(p,x):n?T(p,0):void 0;x>S;S++)if((f||S in w)&&(g=_(v=w[S],S,b),t))if(e)M[S]=g;else if(g)switch(t){case 3:return!0;case 5:return v;case 6:return S;case 2:c.call(M,v)}else if(l)return!1;return h?-1:u||l?l:M}};t.exports={forEach:u(0),map:u(1),filter:u(2),some:u(3),every:u(4),find:u(5),findIndex:u(6)}},function(t,e,n){var r=n(656);t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 0:return function(){return t.call(e)};case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t}},function(t,e,n){var r=n(249),i=n(483),o=n(332)("species");t.exports=function(t,e){var n;return i(t)&&("function"!=typeof(n=t.constructor)||n!==Array&&!i(n.prototype)?r(n)&&null===(n=n[o])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===e?0:e)}},function(t,e,n){t.exports=n(659)},function(t,e,n){n(660);var r=n(331);t.exports=r.Object.values},function(t,e,n){var r=n(467),i=n(661).values;r({target:"Object",stat:!0},{values:function(t){return i(t)}})},function(t,e,n){var r=n(226),i=n(386),o=n(248),a=n(378).f,s=function(t){return function(e){for(var n,s=o(e),c=i(s),u=c.length,l=0,h=[];u>l;)n=c[l++],r&&!a.call(s,n)||h.push(t?[n,s[n]]:s[n]);return h}};t.exports={entries:s(!0),values:s(!1)}},function(t,e,n){"use strict";n(486)()||Object.defineProperty(n(487),"Symbol",{value:n(488),configurable:!0,enumerable:!1,writable:!0})},function(t,e,n){"use strict";t.exports=function(){var t,e=Object.assign;return"function"==typeof e&&(e(t={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),t.foo+t.bar+t.trzy==="razdwatrzy")}},function(t,e,n){"use strict";var r=n(665),i=n(185),o=Math.max;t.exports=function(t,e){var n,a,s,c=o(arguments.length,2);for(t=Object(i(t)),s=function(r){try{t[r]=e[r]}catch(t){n||(n=t)}},a=1;a<c;++a)e=arguments[a],r(e).forEach(s);if(void 0!==n)throw n;return t}},function(t,e,n){"use strict";t.exports=n(666)()?Object.keys:n(667)},function(t,e,n){"use strict";t.exports=function(){try{return Object.keys("primitive"),!0}catch(t){return!1}}},function(t,e,n){"use strict";var r=n(251),i=Object.keys;t.exports=function(t){return i(r(t)?Object(t):t)}},function(t,e,n){"use strict";t.exports=function(t){return"function"==typeof t}},function(t,e,n){"use strict";var r="razdwatrzy";t.exports=function(){return"function"==typeof r.contains&&(!0===r.contains("dwa")&&!1===r.contains("foo"))}},function(t,e,n){"use strict";var r=String.prototype.indexOf;t.exports=function(t){return r.call(this,t,arguments[1])>-1}},function(t,e,n){"use strict";var r=n(672);t.exports=function(t){if(!r(t))throw new TypeError(t+" is not a symbol");return t}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}t.exports=function(t){return!!t&&("symbol"===r(t)||!!t.constructor&&("Symbol"===t.constructor.name&&"Symbol"===t[t.constructor.toStringTag]))}},function(t,e,n){"use strict";t.exports=function(){var t,e;return"function"==typeof Set&&(t=new Set(["raz","dwa","trzy"]),"[object Set]"===String(t)&&(3===t.size&&("function"==typeof t.add&&("function"==typeof t.clear&&("function"==typeof t.delete&&("function"==typeof t.entries&&("function"==typeof t.forEach&&("function"==typeof t.has&&("function"==typeof t.keys&&("function"==typeof t.values&&(!1===(e=t.values().next()).done&&"raz"===e.value)))))))))))}},function(t,e,n){"use strict";var r,i,o,a=n(492),s=n(675),c=n(333),u=n(186),l=n(227),h=n(685),f=n(205),p=n(496),d=n(687),y=n(700),m=n(701),v=Function.prototype.call,g=Object.defineProperty,b=Object.getPrototypeOf;m&&(o=Set),t.exports=r=function(){var t,e=arguments[0];if(!(this instanceof r))throw new TypeError("Constructor requires 'new'");return t=m&&c?c(new o,b(this)):this,null!=e&&p(e),g(t,"__setData__",l("c",[])),e?(d(e,(function(t){-1===s.call(this,t)&&this.push(t)}),t.__setData__),t):t},m&&(c&&c(r,o),r.prototype=Object.create(o.prototype,{constructor:l(r)})),h(Object.defineProperties(r.prototype,{add:l((function(t){return this.has(t)?this:(this.emit("_add",this.__setData__.push(t)-1,t),this)})),clear:l((function(){this.__setData__.length&&(a.call(this.__setData__),this.emit("_clear"))})),delete:l((function(t){var e=s.call(this.__setData__,t);return-1!==e&&(this.__setData__.splice(e,1),this.emit("_delete",e,t),!0)})),entries:l((function(){return new y(this,"key+value")})),forEach:l((function(t){var e,n,r,i=arguments[1];for(u(t),n=(e=this.values())._next();void 0!==n;)r=e._resolve(n),v.call(t,i,r,r,this),n=e._next()})),has:l((function(t){return-1!==s.call(this.__setData__,t)})),keys:l(i=function(){return this.values()}),size:l.gs((function(){return this.__setData__.length})),values:l((function(){return new y(this)})),toString:l((function(){return"[object Set]"}))})),g(r.prototype,f.iterator,l(i)),g(r.prototype,f.toStringTag,l("c","Set"))},function(t,e,n){"use strict";var r=n(676),i=n(493),o=n(185),a=Array.prototype.indexOf,s=Object.prototype.hasOwnProperty,c=Math.abs,u=Math.floor;t.exports=function(t){var e,n,l,h;if(!r(t))return a.apply(this,arguments);for(n=i(o(this).length),l=arguments[1],e=l=isNaN(l)?0:l>=0?u(l):i(this.length)-u(c(l));e<n;++e)if(s.call(this,e)&&(h=this[e],r(h)))return e;return-1}},function(t,e,n){"use strict";t.exports=n(677)()?Number.isNaN:n(678)},function(t,e,n){"use strict";t.exports=function(){var t=Number.isNaN;return"function"==typeof t&&(!t({})&&t(NaN)&&!t(34))}},function(t,e,n){"use strict";t.exports=function(t){return t!=t}},function(t,e,n){"use strict";var r=n(680),i=Math.abs,o=Math.floor;t.exports=function(t){return isNaN(t)?0:0!==(t=Number(t))&&isFinite(t)?r(t)*o(i(t)):t}},function(t,e,n){"use strict";t.exports=n(681)()?Math.sign:n(682)},function(t,e,n){"use strict";t.exports=function(){var t=Math.sign;return"function"==typeof t&&(1===t(10)&&-1===t(-20))}},function(t,e,n){"use strict";t.exports=function(t){return t=Number(t),isNaN(t)||0===t?t:t>0?1:-1}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(251),o={function:!0,object:!0};t.exports=function(t){return i(t)&&o[r(t)]||!1}},function(t,e,n){"use strict";var r,i,o,a,s=Object.create;n(494)()||(r=n(495)),t.exports=r?1!==r.level?s:(i={},o={},a={configurable:!1,enumerable:!1,writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach((function(t){o[t]="__proto__"!==t?a:{configurable:!0,enumerable:!1,writable:!0,value:void 0}})),Object.defineProperties(i,o),Object.defineProperty(r,"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:i}),function(t,e){return s(null===t?i:t,e)}):s},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i,o,a,s,c,u,l,h=n(227),f=n(186),p=Function.prototype.apply,d=Function.prototype.call,y=Object.create,m=Object.defineProperty,v=Object.defineProperties,g=Object.prototype.hasOwnProperty,b={configurable:!0,enumerable:!1,writable:!0};o=function(t,e){var n,r;return f(e),r=this,i.call(this,t,n=function(){a.call(r,t,n),p.call(e,this,arguments)}),n.__eeOnceListener__=e,this},c={on:i=function(t,e){var n;return f(e),g.call(this,"__ee__")?n=this.__ee__:(n=b.value=y(null),m(this,"__ee__",b),b.value=null),n[t]?"object"===r(n[t])?n[t].push(e):n[t]=[n[t],e]:n[t]=e,this},once:o,off:a=function(t,e){var n,i,o,a;if(f(e),!g.call(this,"__ee__"))return this;if(!(n=this.__ee__)[t])return this;if("object"===r(i=n[t]))for(a=0;o=i[a];++a)o!==e&&o.__eeOnceListener__!==e||(2===i.length?n[t]=i[a?0:1]:i.splice(a,1));else i!==e&&i.__eeOnceListener__!==e||delete n[t];return this},emit:s=function(t){var e,n,i,o,a;if(g.call(this,"__ee__")&&(o=this.__ee__[t]))if("object"===r(o)){for(n=arguments.length,a=new Array(n-1),e=1;e<n;++e)a[e-1]=arguments[e];for(o=o.slice(),e=0;i=o[e];++e)p.call(i,this,a)}else switch(arguments.length){case 1:d.call(o,this);break;case 2:d.call(o,this,arguments[1]);break;case 3:d.call(o,this,arguments[1],arguments[2]);break;default:for(n=arguments.length,a=new Array(n-1),e=1;e<n;++e)a[e-1]=arguments[e];p.call(o,this,a)}}},u={on:h(i),once:h(o),off:h(a),emit:h(s)},l=v({},u),t.exports=e=function(t){return null==t?y(l):v(Object(t),u)},e.methods=c},function(t,e,n){"use strict";var r=n(334),i=n(251),o=n(335),a=n(205).iterator,s=Array.isArray;t.exports=function(t){return!!i(t)&&(!!s(t)||(!!o(t)||(!!r(t)||"function"==typeof t[a])))}},function(t,e,n){"use strict";var r=n(334),i=n(186),o=n(335),a=n(688),s=Array.isArray,c=Function.prototype.call,u=Array.prototype.some;t.exports=function(t,e){var n,l,h,f,p,d,y,m,v=arguments[2];if(s(t)||r(t)?n="array":o(t)?n="string":t=a(t),i(e),h=function(){f=!0},"array"!==n)if("string"!==n)for(l=t.next();!l.done;){if(c.call(e,v,l.value,h),f)return;l=t.next()}else for(d=t.length,p=0;p<d&&(y=t[p],p+1<d&&(m=y.charCodeAt(0))>=55296&&m<=56319&&(y+=t[++p]),c.call(e,v,y,h),!f);++p);else u.call(t,(function(t){return c.call(e,v,t,h),f}))}},function(t,e,n){"use strict";var r=n(334),i=n(335),o=n(689),a=n(699),s=n(496),c=n(205).iterator;t.exports=function(t){return"function"==typeof s(t)[c]?t[c]():r(t)?new o(t):i(t)?new a(t):new o(t)}},function(t,e,n){"use strict";var r,i=n(333),o=n(388),a=n(227),s=n(205),c=n(389),u=Object.defineProperty;r=t.exports=function(t,e){if(!(this instanceof r))throw new TypeError("Constructor requires 'new'");c.call(this,t),e=e?o.call(e,"key+value")?"key+value":o.call(e,"key")?"key":"value":"value",u(this,"__kind__",a("",e))},i&&i(r,c),delete r.prototype.constructor,r.prototype=Object.create(c.prototype,{_resolve:a((function(t){return"value"===this.__kind__?this.__list__[t]:"key+value"===this.__kind__?[t,this.__list__[t]]:t}))}),u(r.prototype,s.toStringTag,a("c","Array Iterator"))},function(t,e,n){"use strict";var r,i=n(691),o=n(490),a=n(186),s=n(696),c=n(186),u=n(185),l=Function.prototype.bind,h=Object.defineProperty,f=Object.prototype.hasOwnProperty;r=function(t,e,n){var r,o=u(e)&&c(e.value);return delete(r=i(e)).writable,delete r.value,r.get=function(){return!n.overwriteDefinition&&f.call(this,t)?o:(e.value=l.call(o,n.resolveContext?n.resolveContext(this):this),h(this,t,e),this[t])},r},t.exports=function(t){var e=o(arguments[1]);return null!=e.resolveContext&&a(e.resolveContext),s(t,(function(t,n){return r(n,t,e)}))}},function(t,e,n){"use strict";var r=n(692),i=n(387),o=n(185);t.exports=function(t){var e=Object(o(t)),n=arguments[1],a=Object(arguments[2]);if(e!==t&&!n)return e;var s={};return n?r(n,(function(e){(a.ensure||e in t)&&(s[e]=t[e])})):i(s,t),s}},function(t,e,n){"use strict";t.exports=n(693)()?Array.from:n(694)},function(t,e,n){"use strict";t.exports=function(){var t,e,n=Array.from;return"function"==typeof n&&(e=n(t=["raz","dwa"]),Boolean(e&&e!==t&&"dwa"===e[1]))}},function(t,e,n){"use strict";var r=n(205).iterator,i=n(334),o=n(695),a=n(493),s=n(186),c=n(185),u=n(251),l=n(335),h=Array.isArray,f=Function.prototype.call,p={configurable:!0,enumerable:!0,writable:!0,value:null},d=Object.defineProperty;t.exports=function(t){var e,n,y,m,v,g,b,w,_,x,S=arguments[1],T=arguments[2];if(t=Object(c(t)),u(S)&&s(S),this&&this!==Array&&o(this))e=this;else{if(!S){if(i(t))return 1!==(v=t.length)?Array.apply(null,t):((m=new Array(1))[0]=t[0],m);if(h(t)){for(m=new Array(v=t.length),n=0;n<v;++n)m[n]=t[n];return m}}m=[]}if(!h(t))if(void 0!==(_=t[r])){for(b=s(_).call(t),e&&(m=new e),w=b.next(),n=0;!w.done;)x=S?f.call(S,T,w.value,n):w.value,e?(p.value=x,d(m,n,p)):m[n]=x,w=b.next(),++n;v=n}else if(l(t)){for(v=t.length,e&&(m=new e),n=0,y=0;n<v;++n)x=t[n],n+1<v&&(g=x.charCodeAt(0))>=55296&&g<=56319&&(x+=t[++n]),x=S?f.call(S,T,x,y):x,e?(p.value=x,d(m,y,p)):m[y]=x,++y;v=y}if(void 0===v)for(v=a(t.length),e&&(m=new e(v)),n=0;n<v;++n)x=S?f.call(S,T,t[n],n):t[n],e?(p.value=x,d(m,n,p)):m[n]=x;return e&&(p.value=null,m.length=v),m}},function(t,e,n){"use strict";var r=Object.prototype.toString,i=r.call(n(489));t.exports=function(t){return"function"==typeof t&&r.call(t)===i}},function(t,e,n){"use strict";var r=n(186),i=n(697),o=Function.prototype.call;t.exports=function(t,e){var n={},a=arguments[2];return r(e),i(t,(function(t,r,i,s){n[r]=o.call(e,a,t,r,i,s)})),n}},function(t,e,n){"use strict";t.exports=n(698)("forEach")},function(t,e,n){"use strict";var r=n(186),i=n(185),o=Function.prototype.bind,a=Function.prototype.call,s=Object.keys,c=Object.prototype.propertyIsEnumerable;t.exports=function(t,e){return function(n,u){var l,h=arguments[2],f=arguments[3];return n=Object(i(n)),r(u),l=s(n),f&&l.sort("function"==typeof f?o.call(f,n):void 0),"function"!=typeof t&&(t=l[t]),a.call(t,l,(function(t,r){return c.call(n,t)?a.call(u,h,n[t],t,n,r):e}))}}},function(t,e,n){"use strict";var r,i=n(333),o=n(227),a=n(205),s=n(389),c=Object.defineProperty;r=t.exports=function(t){if(!(this instanceof r))throw new TypeError("Constructor requires 'new'");t=String(t),s.call(this,t),c(this,"__length__",o("",t.length))},i&&i(r,s),delete r.prototype.constructor,r.prototype=Object.create(s.prototype,{_next:o((function(){if(this.__list__)return this.__nextIndex__<this.__length__?this.__nextIndex__++:void this._unBind()})),_resolve:o((function(t){var e,n=this.__list__[t];return this.__nextIndex__===this.__length__?n:(e=n.charCodeAt(0))>=55296&&e<=56319?n+this.__list__[this.__nextIndex__++]:n}))}),c(r.prototype,a.toStringTag,o("c","String Iterator"))},function(t,e,n){"use strict";var r,i=n(333),o=n(388),a=n(227),s=n(389),c=n(205).toStringTag,u=Object.defineProperty;r=t.exports=function(t,e){if(!(this instanceof r))return new r(t,e);s.call(this,t.__setData__,t),e=e&&o.call(e,"key+value")?"key+value":"value",u(this,"__kind__",a("",e))},i&&i(r,s),r.prototype=Object.create(s.prototype,{constructor:a(r),_resolve:a((function(t){return"value"===this.__kind__?this.__list__[t]:[this.__list__[t],this.__list__[t]]})),toString:a((function(){return"[object Set Iterator]"}))}),u(r.prototype,c,a("c","Set Iterator"))},function(t,e,n){"use strict";t.exports="undefined"!=typeof Set&&"[object Set]"===Object.prototype.toString.call(Set.prototype)},function(t,e){String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(t,e){void 0===e&&(e=0);var n=e>0?0|e:0;return this.substring(n,n+t.length)===t}}),String.prototype.includes||(String.prototype.includes=function(t,e){"use strict";return"number"!=typeof e&&(e=0),!(e+t.length>this.length)&&-1!==this.indexOf(t,e)})},function(t,e,n){"use strict";e.randomBytes=e.rng=e.pseudoRandomBytes=e.prng=n(252),e.createHash=e.Hash=n(289),e.createHmac=e.Hmac=n(506);var r=n(724),i=Object.keys(r),o=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(i);e.getHashes=function(){return o};var a=n(510);e.pbkdf2=a.pbkdf2,e.pbkdf2Sync=a.pbkdf2Sync;var s=n(726);e.Cipher=s.Cipher,e.createCipher=s.createCipher,e.Cipheriv=s.Cipheriv,e.createCipheriv=s.createCipheriv,e.Decipher=s.Decipher,e.createDecipher=s.createDecipher,e.Decipheriv=s.Decipheriv,e.createDecipheriv=s.createDecipheriv,e.getCiphers=s.getCiphers,e.listCiphers=s.listCiphers;var c=n(743);e.DiffieHellmanGroup=c.DiffieHellmanGroup,e.createDiffieHellmanGroup=c.createDiffieHellmanGroup,e.getDiffieHellman=c.getDiffieHellman,e.createDiffieHellman=c.createDiffieHellman,e.DiffieHellman=c.DiffieHellman;var u=n(748);e.createSign=u.createSign,e.Sign=u.Sign,e.createVerify=u.createVerify,e.Verify=u.Verify,e.createECDH=n(785);var l=n(786);e.publicEncrypt=l.publicEncrypt,e.privateEncrypt=l.privateEncrypt,e.publicDecrypt=l.publicDecrypt,e.privateDecrypt=l.privateDecrypt;var h=n(789);e.randomFill=h.randomFill,e.randomFillSync=h.randomFillSync,e.createCredentials=function(){throw new Error(["sorry, createCredentials is not implemented yet","we accept pull requests","https://github.com/crypto-browserify/crypto-browserify"].join("\n"))},e.constants={DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,NPN_ENABLED:1,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}},function(t,e,n){"use strict";e.byteLength=function(t){var e=u(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){for(var e,n=u(t),r=n[0],a=n[1],s=new o(function(t,e,n){return 3*(e+n)/4-n}(0,r,a)),c=0,l=a>0?r-4:r,h=0;h<l;h+=4)e=i[t.charCodeAt(h)]<<18|i[t.charCodeAt(h+1)]<<12|i[t.charCodeAt(h+2)]<<6|i[t.charCodeAt(h+3)],s[c++]=e>>16&255,s[c++]=e>>8&255,s[c++]=255&e;2===a&&(e=i[t.charCodeAt(h)]<<2|i[t.charCodeAt(h+1)]>>4,s[c++]=255&e);1===a&&(e=i[t.charCodeAt(h)]<<10|i[t.charCodeAt(h+1)]<<4|i[t.charCodeAt(h+2)]>>2,s[c++]=e>>8&255,s[c++]=255&e);return s},e.fromByteArray=function(t){for(var e,n=t.length,i=n%3,o=[],a=0,s=n-i;a<s;a+=16383)o.push(l(t,a,a+16383>s?s:a+16383));1===i?(e=t[n-1],o.push(r[e>>2]+r[e<<4&63]+"==")):2===i&&(e=(t[n-2]<<8)+t[n-1],o.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"="));return o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,c=a.length;s<c;++s)r[s]=a[s],i[a.charCodeAt(s)]=s;function u(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function l(t,e,n){for(var i,o,a=[],s=e;s<n;s+=3)i=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),a.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return a.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,i){var o,a,s=8*i-r-1,c=(1<<s)-1,u=c>>1,l=-7,h=n?i-1:0,f=n?-1:1,p=t[e+h];for(h+=f,o=p&(1<<-l)-1,p>>=-l,l+=s;l>0;o=256*o+t[e+h],h+=f,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;l>0;a=256*a+t[e+h],h+=f,l-=8);if(0===o)o=1-u;else{if(o===c)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,r),o-=u}return(p?-1:1)*a*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var a,s,c,u=8*o-i-1,l=(1<<u)-1,h=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,d=r?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=l):(a=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-a))<1&&(a--,c*=2),(e+=a+h>=1?f/c:f*Math.pow(2,1-h))*c>=2&&(a++,c/=2),a+h>=l?(s=0,a=l):a+h>=1?(s=(e*c-1)*Math.pow(2,i),a+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;t[n+p]=255&s,p+=d,s/=256,i-=8);for(a=a<<i|s,u+=i;u>0;t[n+p]=255&a,p+=d,a/=256,u-=8);t[n+p-d]|=128*y}},function(t,e,n){t.exports=n(59)},function(t,e){},function(t,e,n){"use strict";var r=n(228).Buffer,i=n(709);t.exports=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.head=null,this.tail=null,this.length=0}return t.prototype.push=function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length},t.prototype.unshift=function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length},t.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},t.prototype.clear=function(){this.head=this.tail=null,this.length=0},t.prototype.join=function(t){if(0===this.length)return"";for(var e=this.head,n=""+e.data;e=e.next;)n+=t+e.data;return n},t.prototype.concat=function(t){if(0===this.length)return r.alloc(0);if(1===this.length)return this.head.data;for(var e,n,i,o=r.allocUnsafe(t>>>0),a=this.head,s=0;a;)e=a.data,n=o,i=s,e.copy(n,i),s+=a.data.length,a=a.next;return o},t}(),i&&i.inspect&&i.inspect.custom&&(t.exports.prototype[i.inspect.custom]=function(){var t=i.inspect({length:this.length});return this.constructor.name+" "+t})},function(t,e){},function(t,e,n){(function(t){var r=void 0!==t&&t||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function o(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new o(i.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new o(i.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},n(711),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(144))},function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var r,i,o,a,s,c=1,u={},l=!1,h=t.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(t);f=f&&f.setTimeout?f:t,"[object process]"==={}.toString.call(t.process)?r=function(t){e.nextTick((function(){d(t)}))}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?t.MessageChannel?((o=new MessageChannel).port1.onmessage=function(t){d(t.data)},r=function(t){o.port2.postMessage(t)}):h&&"onreadystatechange"in h.createElement("script")?(i=h.documentElement,r=function(t){var e=h.createElement("script");e.onreadystatechange=function(){d(t),e.onreadystatechange=null,i.removeChild(e),e=null},i.appendChild(e)}):r=function(t){setTimeout(d,0,t)}:(a="setImmediate$"+Math.random()+"$",s=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(a)&&d(+e.data.slice(a.length))},t.addEventListener?t.addEventListener("message",s,!1):t.attachEvent("onmessage",s),r=function(e){t.postMessage(a+e,"*")}),f.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var i={callback:t,args:e};return u[c]=i,r(c),c++},f.clearImmediate=p}function p(t){delete u[t]}function d(t){if(l)setTimeout(d,0,t);else{var e=u[t];if(e){l=!0;try{!function(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(void 0,n)}}(e)}finally{p(t),l=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(144),n(169))},function(t,e,n){(function(e){function n(t){try{if(!e.localStorage)return!1}catch(t){return!1}var n=e.localStorage[t];return null!=n&&"true"===String(n).toLowerCase()}t.exports=function(t,e){if(n("noDeprecation"))return t;var r=!1;return function(){if(!r){if(n("throwDeprecation"))throw new Error(e);n("traceDeprecation")?console.trace(e):console.warn(e),r=!0}return t.apply(this,arguments)}}}).call(this,n(144))},function(t,e,n){"use strict";t.exports=o;var r=n(503),i=n(290);function o(t){if(!(this instanceof o))return new o(t);r.call(this,t)}i.inherits=n(37),i.inherits(o,r),o.prototype._transform=function(t,e,n){n(null,t)}},function(t,e,n){t.exports=n(393)},function(t,e,n){t.exports=n(229)},function(t,e,n){t.exports=n(392).Transform},function(t,e,n){t.exports=n(392).PassThrough},function(t,e,n){var r=n(37),i=n(253),o=n(230).Buffer,a=[1518500249,1859775393,-1894007588,-899497514],s=new Array(80);function c(){this.init(),this._w=s,i.call(this,64,56)}function u(t){return t<<30|t>>>2}function l(t,e,n,r){return 0===t?e&n|~e&r:2===t?e&n|e&r|n&r:e^n^r}r(c,i),c.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},c.prototype._update=function(t){for(var e,n=this._w,r=0|this._a,i=0|this._b,o=0|this._c,s=0|this._d,c=0|this._e,h=0;h<16;++h)n[h]=t.readInt32BE(4*h);for(;h<80;++h)n[h]=n[h-3]^n[h-8]^n[h-14]^n[h-16];for(var f=0;f<80;++f){var p=~~(f/20),d=0|((e=r)<<5|e>>>27)+l(p,i,o,s)+c+n[f]+a[p];c=s,s=o,o=u(i),i=r,r=d}this._a=r+this._a|0,this._b=i+this._b|0,this._c=o+this._c|0,this._d=s+this._d|0,this._e=c+this._e|0},c.prototype._hash=function(){var t=o.allocUnsafe(20);return t.writeInt32BE(0|this._a,0),t.writeInt32BE(0|this._b,4),t.writeInt32BE(0|this._c,8),t.writeInt32BE(0|this._d,12),t.writeInt32BE(0|this._e,16),t},t.exports=c},function(t,e,n){var r=n(37),i=n(253),o=n(230).Buffer,a=[1518500249,1859775393,-1894007588,-899497514],s=new Array(80);function c(){this.init(),this._w=s,i.call(this,64,56)}function u(t){return t<<5|t>>>27}function l(t){return t<<30|t>>>2}function h(t,e,n,r){return 0===t?e&n|~e&r:2===t?e&n|e&r|n&r:e^n^r}r(c,i),c.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},c.prototype._update=function(t){for(var e,n=this._w,r=0|this._a,i=0|this._b,o=0|this._c,s=0|this._d,c=0|this._e,f=0;f<16;++f)n[f]=t.readInt32BE(4*f);for(;f<80;++f)n[f]=(e=n[f-3]^n[f-8]^n[f-14]^n[f-16])<<1|e>>>31;for(var p=0;p<80;++p){var d=~~(p/20),y=u(r)+h(d,i,o,s)+c+n[p]+a[d]|0;c=s,s=o,o=l(i),i=r,r=y}this._a=r+this._a|0,this._b=i+this._b|0,this._c=o+this._c|0,this._d=s+this._d|0,this._e=c+this._e|0},c.prototype._hash=function(){var t=o.allocUnsafe(20);return t.writeInt32BE(0|this._a,0),t.writeInt32BE(0|this._b,4),t.writeInt32BE(0|this._c,8),t.writeInt32BE(0|this._d,12),t.writeInt32BE(0|this._e,16),t},t.exports=c},function(t,e,n){var r=n(37),i=n(504),o=n(253),a=n(230).Buffer,s=new Array(64);function c(){this.init(),this._w=s,o.call(this,64,56)}r(c,i),c.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},c.prototype._hash=function(){var t=a.allocUnsafe(28);return t.writeInt32BE(this._a,0),t.writeInt32BE(this._b,4),t.writeInt32BE(this._c,8),t.writeInt32BE(this._d,12),t.writeInt32BE(this._e,16),t.writeInt32BE(this._f,20),t.writeInt32BE(this._g,24),t},t.exports=c},function(t,e,n){var r=n(37),i=n(505),o=n(253),a=n(230).Buffer,s=new Array(160);function c(){this.init(),this._w=s,o.call(this,128,112)}r(c,i),c.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},c.prototype._hash=function(){var t=a.allocUnsafe(48);function e(e,n,r){t.writeInt32BE(e,r),t.writeInt32BE(n,r+4)}return e(this._ah,this._al,0),e(this._bh,this._bl,8),e(this._ch,this._cl,16),e(this._dh,this._dl,24),e(this._eh,this._el,32),e(this._fh,this._fl,40),t},t.exports=c},function(t,e,n){t.exports=n(59)},function(t,e,n){"use strict";var r=n(37),i=n(507).Buffer,o=n(206),a=i.alloc(128);function s(t,e){o.call(this,"digest"),"string"==typeof e&&(e=i.from(e)),this._alg=t,this._key=e,e.length>64?e=t(e):e.length<64&&(e=i.concat([e,a],64));for(var n=this._ipad=i.allocUnsafe(64),r=this._opad=i.allocUnsafe(64),s=0;s<64;s++)n[s]=54^e[s],r[s]=92^e[s];this._hash=[n]}r(s,o),s.prototype._update=function(t){this._hash.push(t)},s.prototype._final=function(){var t=this._alg(i.concat(this._hash));return this._alg(i.concat([this._opad,t]))},t.exports=s},function(t,e,n){t.exports=n(509)},function(t,e,n){(function(e,r){var i,o=n(511),a=n(512),s=n(513),c=n(514).Buffer,u=e.crypto&&e.crypto.subtle,l={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},h=[];function f(t,e,n,r,i){return u.importKey("raw",t,{name:"PBKDF2"},!1,["deriveBits"]).then((function(t){return u.deriveBits({name:"PBKDF2",salt:e,iterations:n,hash:{name:i}},t,r<<3)})).then((function(t){return c.from(t)}))}t.exports=function(t,n,p,d,y,m){"function"==typeof y&&(m=y,y=void 0);var v=l[(y=y||"sha1").toLowerCase()];if(!v||"function"!=typeof e.Promise)return r.nextTick((function(){var e;try{e=s(t,n,p,d,y)}catch(t){return m(t)}m(null,e)}));if(o(t,n,p,d),"function"!=typeof m)throw new Error("No callback provided to pbkdf2");c.isBuffer(t)||(t=c.from(t,a)),c.isBuffer(n)||(n=c.from(n,a)),function(t,e){t.then((function(t){r.nextTick((function(){e(null,t)}))}),(function(t){r.nextTick((function(){e(t)}))}))}(function(t){if(e.process&&!e.process.browser)return Promise.resolve(!1);if(!u||!u.importKey||!u.deriveBits)return Promise.resolve(!1);if(void 0!==h[t])return h[t];var n=f(i=i||c.alloc(8),i,10,128,t).then((function(){return!0})).catch((function(){return!1}));return h[t]=n,n}(v).then((function(e){return e?f(t,n,p,d,v):s(t,n,p,d,y)})),m)}}).call(this,n(144),n(169))},function(t,e,n){var r=n(727),i=n(398),o=n(399),a=n(742),s=n(338);function c(t,e,n){if(t=t.toLowerCase(),o[t])return i.createCipheriv(t,e,n);if(a[t])return new r({key:e,iv:n,mode:t});throw new TypeError("invalid suite type")}function u(t,e,n){if(t=t.toLowerCase(),o[t])return i.createDecipheriv(t,e,n);if(a[t])return new r({key:e,iv:n,mode:t,decrypt:!0});throw new TypeError("invalid suite type")}e.createCipher=e.Cipher=function(t,e){var n,r;if(t=t.toLowerCase(),o[t])n=o[t].key,r=o[t].iv;else{if(!a[t])throw new TypeError("invalid suite type");n=8*a[t].key,r=a[t].iv}var i=s(e,!1,n,r);return c(t,i.key,i.iv)},e.createCipheriv=e.Cipheriv=c,e.createDecipher=e.Decipher=function(t,e){var n,r;if(t=t.toLowerCase(),o[t])n=o[t].key,r=o[t].iv;else{if(!a[t])throw new TypeError("invalid suite type");n=8*a[t].key,r=a[t].iv}var i=s(e,!1,n,r);return u(t,i.key,i.iv)},e.createDecipheriv=e.Decipheriv=u,e.listCiphers=e.getCiphers=function(){return Object.keys(a).concat(i.getCiphers())}},function(t,e,n){(function(e){var r=n(206),i=n(397),o=n(37),a={"des-ede3-cbc":i.CBC.instantiate(i.EDE),"des-ede3":i.EDE,"des-ede-cbc":i.CBC.instantiate(i.EDE),"des-ede":i.EDE,"des-cbc":i.CBC.instantiate(i.DES),"des-ecb":i.DES};function s(t){r.call(this);var n,i=t.mode.toLowerCase(),o=a[i];n=t.decrypt?"decrypt":"encrypt";var s=t.key;"des-ede"!==i&&"des-ede-cbc"!==i||(s=e.concat([s,s.slice(0,8)]));var c=t.iv;this._des=o.create({key:s,iv:c,type:n})}a.des=a["des-cbc"],a.des3=a["des-ede3-cbc"],t.exports=s,o(s,r),s.prototype._update=function(t){return new e(this._des.update(t))},s.prototype._final=function(){return new e(this._des.final())}}).call(this,n(59).Buffer)},function(t,e,n){"use strict";e.readUInt32BE=function(t,e){return(t[0+e]<<24|t[1+e]<<16|t[2+e]<<8|t[3+e])>>>0},e.writeUInt32BE=function(t,e,n){t[0+n]=e>>>24,t[1+n]=e>>>16&255,t[2+n]=e>>>8&255,t[3+n]=255&e},e.ip=function(t,e,n,r){for(var i=0,o=0,a=6;a>=0;a-=2){for(var s=0;s<=24;s+=8)i<<=1,i|=e>>>s+a&1;for(s=0;s<=24;s+=8)i<<=1,i|=t>>>s+a&1}for(a=6;a>=0;a-=2){for(s=1;s<=25;s+=8)o<<=1,o|=e>>>s+a&1;for(s=1;s<=25;s+=8)o<<=1,o|=t>>>s+a&1}n[r+0]=i>>>0,n[r+1]=o>>>0},e.rip=function(t,e,n,r){for(var i=0,o=0,a=0;a<4;a++)for(var s=24;s>=0;s-=8)i<<=1,i|=e>>>s+a&1,i<<=1,i|=t>>>s+a&1;for(a=4;a<8;a++)for(s=24;s>=0;s-=8)o<<=1,o|=e>>>s+a&1,o<<=1,o|=t>>>s+a&1;n[r+0]=i>>>0,n[r+1]=o>>>0},e.pc1=function(t,e,n,r){for(var i=0,o=0,a=7;a>=5;a--){for(var s=0;s<=24;s+=8)i<<=1,i|=e>>s+a&1;for(s=0;s<=24;s+=8)i<<=1,i|=t>>s+a&1}for(s=0;s<=24;s+=8)i<<=1,i|=e>>s+a&1;for(a=1;a<=3;a++){for(s=0;s<=24;s+=8)o<<=1,o|=e>>s+a&1;for(s=0;s<=24;s+=8)o<<=1,o|=t>>s+a&1}for(s=0;s<=24;s+=8)o<<=1,o|=t>>s+a&1;n[r+0]=i>>>0,n[r+1]=o>>>0},e.r28shl=function(t,e){return t<<e&268435455|t>>>28-e};var r=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];e.pc2=function(t,e,n,i){for(var o=0,a=0,s=r.length>>>1,c=0;c<s;c++)o<<=1,o|=t>>>r[c]&1;for(c=s;c<r.length;c++)a<<=1,a|=e>>>r[c]&1;n[i+0]=o>>>0,n[i+1]=a>>>0},e.expand=function(t,e,n){var r=0,i=0;r=(1&t)<<5|t>>>27;for(var o=23;o>=15;o-=4)r<<=6,r|=t>>>o&63;for(o=11;o>=3;o-=4)i|=t>>>o&63,i<<=6;i|=(31&t)<<1|t>>>31,e[n+0]=r>>>0,e[n+1]=i>>>0};var i=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];e.substitute=function(t,e){for(var n=0,r=0;r<4;r++){n<<=4,n|=i[64*r+(t>>>18-6*r&63)]}for(r=0;r<4;r++){n<<=4,n|=i[256+64*r+(e>>>18-6*r&63)]}return n>>>0};var o=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];e.permute=function(t){for(var e=0,n=0;n<o.length;n++)e<<=1,e|=t>>>o[n]&1;return e>>>0},e.padSplit=function(t,e,n){for(var r=t.toString(2);r.length<e;)r="0"+r;for(var i=[],o=0;o<e;o+=n)i.push(r.slice(o,o+n));return i.join(" ")}},function(t,e,n){"use strict";var r=n(145);function i(t){this.options=t,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0}t.exports=i,i.prototype._init=function(){},i.prototype.update=function(t){return 0===t.length?[]:"decrypt"===this.type?this._updateDecrypt(t):this._updateEncrypt(t)},i.prototype._buffer=function(t,e){for(var n=Math.min(this.buffer.length-this.bufferOff,t.length-e),r=0;r<n;r++)this.buffer[this.bufferOff+r]=t[e+r];return this.bufferOff+=n,n},i.prototype._flushBuffer=function(t,e){return this._update(this.buffer,0,t,e),this.bufferOff=0,this.blockSize},i.prototype._updateEncrypt=function(t){var e=0,n=0,r=(this.bufferOff+t.length)/this.blockSize|0,i=new Array(r*this.blockSize);0!==this.bufferOff&&(e+=this._buffer(t,e),this.bufferOff===this.buffer.length&&(n+=this._flushBuffer(i,n)));for(var o=t.length-(t.length-e)%this.blockSize;e<o;e+=this.blockSize)this._update(t,e,i,n),n+=this.blockSize;for(;e<t.length;e++,this.bufferOff++)this.buffer[this.bufferOff]=t[e];return i},i.prototype._updateDecrypt=function(t){for(var e=0,n=0,r=Math.ceil((this.bufferOff+t.length)/this.blockSize)-1,i=new Array(r*this.blockSize);r>0;r--)e+=this._buffer(t,e),n+=this._flushBuffer(i,n);return e+=this._buffer(t,e),i},i.prototype.final=function(t){var e,n;return t&&(e=this.update(t)),n="encrypt"===this.type?this._finalEncrypt():this._finalDecrypt(),e?e.concat(n):n},i.prototype._pad=function(t,e){if(0===e)return!1;for(;e<t.length;)t[e++]=0;return!0},i.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var t=new Array(this.blockSize);return this._update(this.buffer,0,t,0),t},i.prototype._unpad=function(t){return t},i.prototype._finalDecrypt=function(){r.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var t=new Array(this.blockSize);return this._flushBuffer(t,0),this._unpad(t)}},function(t,e,n){"use strict";var r=n(145),i=n(37),o=n(397),a=o.utils,s=o.Cipher;function c(){this.tmp=new Array(2),this.keys=null}function u(t){s.call(this,t);var e=new c;this._desState=e,this.deriveKeys(e,t.key)}i(u,s),t.exports=u,u.create=function(t){return new u(t)};var l=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];u.prototype.deriveKeys=function(t,e){t.keys=new Array(32),r.equal(e.length,this.blockSize,"Invalid key length");var n=a.readUInt32BE(e,0),i=a.readUInt32BE(e,4);a.pc1(n,i,t.tmp,0),n=t.tmp[0],i=t.tmp[1];for(var o=0;o<t.keys.length;o+=2){var s=l[o>>>1];n=a.r28shl(n,s),i=a.r28shl(i,s),a.pc2(n,i,t.keys,o)}},u.prototype._update=function(t,e,n,r){var i=this._desState,o=a.readUInt32BE(t,e),s=a.readUInt32BE(t,e+4);a.ip(o,s,i.tmp,0),o=i.tmp[0],s=i.tmp[1],"encrypt"===this.type?this._encrypt(i,o,s,i.tmp,0):this._decrypt(i,o,s,i.tmp,0),o=i.tmp[0],s=i.tmp[1],a.writeUInt32BE(n,o,r),a.writeUInt32BE(n,s,r+4)},u.prototype._pad=function(t,e){for(var n=t.length-e,r=e;r<t.length;r++)t[r]=n;return!0},u.prototype._unpad=function(t){for(var e=t[t.length-1],n=t.length-e;n<t.length;n++)r.equal(t[n],e);return t.slice(0,t.length-e)},u.prototype._encrypt=function(t,e,n,r,i){for(var o=e,s=n,c=0;c<t.keys.length;c+=2){var u=t.keys[c],l=t.keys[c+1];a.expand(s,t.tmp,0),u^=t.tmp[0],l^=t.tmp[1];var h=a.substitute(u,l),f=s;s=(o^a.permute(h))>>>0,o=f}a.rip(s,o,r,i)},u.prototype._decrypt=function(t,e,n,r,i){for(var o=n,s=e,c=t.keys.length-2;c>=0;c-=2){var u=t.keys[c],l=t.keys[c+1];a.expand(o,t.tmp,0),u^=t.tmp[0],l^=t.tmp[1];var h=a.substitute(u,l),f=o;o=(s^a.permute(h))>>>0,s=f}a.rip(o,s,r,i)}},function(t,e,n){"use strict";var r=n(145),i=n(37),o={};function a(t){r.equal(t.length,8,"Invalid IV length"),this.iv=new Array(8);for(var e=0;e<this.iv.length;e++)this.iv[e]=t[e]}e.instantiate=function(t){function e(e){t.call(this,e),this._cbcInit()}i(e,t);for(var n=Object.keys(o),r=0;r<n.length;r++){var a=n[r];e.prototype[a]=o[a]}return e.create=function(t){return new e(t)},e},o._cbcInit=function(){var t=new a(this.options.iv);this._cbcState=t},o._update=function(t,e,n,r){var i=this._cbcState,o=this.constructor.super_.prototype,a=i.iv;if("encrypt"===this.type){for(var s=0;s<this.blockSize;s++)a[s]^=t[e+s];o._update.call(this,a,0,n,r);for(s=0;s<this.blockSize;s++)a[s]=n[r+s]}else{o._update.call(this,t,e,n,r);for(s=0;s<this.blockSize;s++)n[r+s]^=a[s];for(s=0;s<this.blockSize;s++)a[s]=t[e+s]}}},function(t,e,n){"use strict";var r=n(145),i=n(37),o=n(397),a=o.Cipher,s=o.DES;function c(t,e){r.equal(e.length,24,"Invalid key length");var n=e.slice(0,8),i=e.slice(8,16),o=e.slice(16,24);this.ciphers="encrypt"===t?[s.create({type:"encrypt",key:n}),s.create({type:"decrypt",key:i}),s.create({type:"encrypt",key:o})]:[s.create({type:"decrypt",key:o}),s.create({type:"encrypt",key:i}),s.create({type:"decrypt",key:n})]}function u(t){a.call(this,t);var e=new c(this.type,this.options.key);this._edeState=e}i(u,a),t.exports=u,u.create=function(t){return new u(t)},u.prototype._update=function(t,e,n,r){var i=this._edeState;i.ciphers[0]._update(t,e,n,r),i.ciphers[1]._update(n,r,n,r),i.ciphers[2]._update(n,r,n,r)},u.prototype._pad=s.prototype._pad,u.prototype._unpad=s.prototype._unpad},function(t,e,n){var r=n(399),i=n(518),o=n(170).Buffer,a=n(519),s=n(206),c=n(337),u=n(338);function l(t,e,n){s.call(this),this._cache=new f,this._cipher=new c.AES(e),this._prev=o.from(n),this._mode=t,this._autopadding=!0}n(37)(l,s),l.prototype._update=function(t){var e,n;this._cache.add(t);for(var r=[];e=this._cache.get();)n=this._mode.encrypt(this,e),r.push(n);return o.concat(r)};var h=o.alloc(16,16);function f(){this.cache=o.allocUnsafe(0)}function p(t,e,n){var s=r[t.toLowerCase()];if(!s)throw new TypeError("invalid suite type");if("string"==typeof e&&(e=o.from(e)),e.length!==s.key/8)throw new TypeError("invalid key length "+e.length);if("string"==typeof n&&(n=o.from(n)),"GCM"!==s.mode&&n.length!==s.iv)throw new TypeError("invalid iv length "+n.length);return"stream"===s.type?new a(s.module,e,n):"auth"===s.type?new i(s.module,e,n):new l(s.module,e,n)}l.prototype._final=function(){var t=this._cache.flush();if(this._autopadding)return t=this._mode.encrypt(this,t),this._cipher.scrub(),t;if(!t.equals(h))throw this._cipher.scrub(),new Error("data not multiple of block length")},l.prototype.setAutoPadding=function(t){return this._autopadding=!!t,this},f.prototype.add=function(t){this.cache=o.concat([this.cache,t])},f.prototype.get=function(){if(this.cache.length>15){var t=this.cache.slice(0,16);return this.cache=this.cache.slice(16),t}return null},f.prototype.flush=function(){for(var t=16-this.cache.length,e=o.allocUnsafe(t),n=-1;++n<t;)e.writeUInt8(t,n);return o.concat([this.cache,e])},e.createCipheriv=p,e.createCipher=function(t,e){var n=r[t.toLowerCase()];if(!n)throw new TypeError("invalid suite type");var i=u(e,!1,n.key,n.iv);return p(t,i.key,i.iv)}},function(t,e){e.encrypt=function(t,e){return t._cipher.encryptBlock(e)},e.decrypt=function(t,e){return t._cipher.decryptBlock(e)}},function(t,e,n){var r=n(291);e.encrypt=function(t,e){var n=r(e,t._prev);return t._prev=t._cipher.encryptBlock(n),t._prev},e.decrypt=function(t,e){var n=t._prev;t._prev=e;var i=t._cipher.decryptBlock(e);return r(i,n)}},function(t,e,n){var r=n(170).Buffer,i=n(291);function o(t,e,n){var o=e.length,a=i(e,t._cache);return t._cache=t._cache.slice(o),t._prev=r.concat([t._prev,n?e:a]),a}e.encrypt=function(t,e,n){for(var i,a=r.allocUnsafe(0);e.length;){if(0===t._cache.length&&(t._cache=t._cipher.encryptBlock(t._prev),t._prev=r.allocUnsafe(0)),!(t._cache.length<=e.length)){a=r.concat([a,o(t,e,n)]);break}i=t._cache.length,a=r.concat([a,o(t,e.slice(0,i),n)]),e=e.slice(i)}return a}},function(t,e,n){var r=n(170).Buffer;function i(t,e,n){var i=t._cipher.encryptBlock(t._prev)[0]^e;return t._prev=r.concat([t._prev.slice(1),r.from([n?e:i])]),i}e.encrypt=function(t,e,n){for(var o=e.length,a=r.allocUnsafe(o),s=-1;++s<o;)a[s]=i(t,e[s],n);return a}},function(t,e,n){var r=n(170).Buffer;function i(t,e,n){for(var r,i,a=-1,s=0;++a<8;)r=e&1<<7-a?128:0,s+=(128&(i=t._cipher.encryptBlock(t._prev)[0]^r))>>a%8,t._prev=o(t._prev,n?r:i);return s}function o(t,e){var n=t.length,i=-1,o=r.allocUnsafe(t.length);for(t=r.concat([t,r.from([e])]);++i<n;)o[i]=t[i]<<1|t[i+1]>>7;return o}e.encrypt=function(t,e,n){for(var o=e.length,a=r.allocUnsafe(o),s=-1;++s<o;)a[s]=i(t,e[s],n);return a}},function(t,e,n){(function(t){var r=n(291);function i(t){return t._prev=t._cipher.encryptBlock(t._prev),t._prev}e.encrypt=function(e,n){for(;e._cache.length<n.length;)e._cache=t.concat([e._cache,i(e)]);var o=e._cache.slice(0,n.length);return e._cache=e._cache.slice(n.length),r(n,o)}}).call(this,n(59).Buffer)},function(t,e,n){var r=n(170).Buffer,i=r.alloc(16,0);function o(t){var e=r.allocUnsafe(16);return e.writeUInt32BE(t[0]>>>0,0),e.writeUInt32BE(t[1]>>>0,4),e.writeUInt32BE(t[2]>>>0,8),e.writeUInt32BE(t[3]>>>0,12),e}function a(t){this.h=t,this.state=r.alloc(16,0),this.cache=r.allocUnsafe(0)}a.prototype.ghash=function(t){for(var e=-1;++e<t.length;)this.state[e]^=t[e];this._multiply()},a.prototype._multiply=function(){for(var t,e,n,r=[(t=this.h).readUInt32BE(0),t.readUInt32BE(4),t.readUInt32BE(8),t.readUInt32BE(12)],i=[0,0,0,0],a=-1;++a<128;){for(0!=(this.state[~~(a/8)]&1<<7-a%8)&&(i[0]^=r[0],i[1]^=r[1],i[2]^=r[2],i[3]^=r[3]),n=0!=(1&r[3]),e=3;e>0;e--)r[e]=r[e]>>>1|(1&r[e-1])<<31;r[0]=r[0]>>>1,n&&(r[0]=r[0]^225<<24)}this.state=o(i)},a.prototype.update=function(t){var e;for(this.cache=r.concat([this.cache,t]);this.cache.length>=16;)e=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(e)},a.prototype.final=function(t,e){return this.cache.length&&this.ghash(r.concat([this.cache,i],16)),this.ghash(o([0,t,0,e])),this.state},t.exports=a},function(t,e,n){var r=n(518),i=n(170).Buffer,o=n(399),a=n(519),s=n(206),c=n(337),u=n(338);function l(t,e,n){s.call(this),this._cache=new h,this._last=void 0,this._cipher=new c.AES(e),this._prev=i.from(n),this._mode=t,this._autopadding=!0}function h(){this.cache=i.allocUnsafe(0)}function f(t,e,n){var s=o[t.toLowerCase()];if(!s)throw new TypeError("invalid suite type");if("string"==typeof n&&(n=i.from(n)),"GCM"!==s.mode&&n.length!==s.iv)throw new TypeError("invalid iv length "+n.length);if("string"==typeof e&&(e=i.from(e)),e.length!==s.key/8)throw new TypeError("invalid key length "+e.length);return"stream"===s.type?new a(s.module,e,n,!0):"auth"===s.type?new r(s.module,e,n,!0):new l(s.module,e,n)}n(37)(l,s),l.prototype._update=function(t){var e,n;this._cache.add(t);for(var r=[];e=this._cache.get(this._autopadding);)n=this._mode.decrypt(this,e),r.push(n);return i.concat(r)},l.prototype._final=function(){var t=this._cache.flush();if(this._autopadding)return function(t){var e=t[15];if(e<1||e>16)throw new Error("unable to decrypt data");var n=-1;for(;++n<e;)if(t[n+(16-e)]!==e)throw new Error("unable to decrypt data");if(16===e)return;return t.slice(0,16-e)}(this._mode.decrypt(this,t));if(t)throw new Error("data not multiple of block length")},l.prototype.setAutoPadding=function(t){return this._autopadding=!!t,this},h.prototype.add=function(t){this.cache=i.concat([this.cache,t])},h.prototype.get=function(t){var e;if(t){if(this.cache.length>16)return e=this.cache.slice(0,16),this.cache=this.cache.slice(16),e}else if(this.cache.length>=16)return e=this.cache.slice(0,16),this.cache=this.cache.slice(16),e;return null},h.prototype.flush=function(){if(this.cache.length)return this.cache},e.createDecipher=function(t,e){var n=o[t.toLowerCase()];if(!n)throw new TypeError("invalid suite type");var r=u(e,!1,n.key,n.iv);return f(t,r.key,r.iv)},e.createDecipheriv=f},function(t,e){e["des-ecb"]={key:8,iv:0},e["des-cbc"]=e.des={key:8,iv:8},e["des-ede3-cbc"]=e.des3={key:24,iv:8},e["des-ede3"]={key:24,iv:0},e["des-ede-cbc"]={key:16,iv:8},e["des-ede"]={key:16,iv:0}},function(t,e,n){(function(t){var r=n(520),i=n(746),o=n(747);var a={binary:!0,hex:!0,base64:!0};e.DiffieHellmanGroup=e.createDiffieHellmanGroup=e.getDiffieHellman=function(e){var n=new t(i[e].prime,"hex"),r=new t(i[e].gen,"hex");return new o(n,r)},e.createDiffieHellman=e.DiffieHellman=function e(n,i,s,c){return t.isBuffer(i)||void 0===a[i]?e(n,"binary",i,s):(i=i||"binary",c=c||"binary",s=s||new t([2]),t.isBuffer(s)||(s=new t(s,c)),"number"==typeof n?new o(r(n,s),s,!0):(t.isBuffer(n)||(n=new t(n,i)),new o(n,s,!0)))}}).call(this,n(59).Buffer)},function(t,e){},function(t,e){},function(t){t.exports=JSON.parse('{"modp1":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},"modp2":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},"modp5":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},"modp14":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},"modp15":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},"modp16":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},"modp17":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},"modp18":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"}}')},function(t,e,n){(function(e){var r=n(95),i=new(n(521)),o=new r(24),a=new r(11),s=new r(10),c=new r(3),u=new r(7),l=n(520),h=n(252);function f(t,n){return n=n||"utf8",e.isBuffer(t)||(t=new e(t,n)),this._pub=new r(t),this}function p(t,n){return n=n||"utf8",e.isBuffer(t)||(t=new e(t,n)),this._priv=new r(t),this}t.exports=y;var d={};function y(t,e,n){this.setGenerator(e),this.__prime=new r(t),this._prime=r.mont(this.__prime),this._primeLen=t.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,n?(this.setPublicKey=f,this.setPrivateKey=p):this._primeCode=8}function m(t,n){var r=new e(t.toArray());return n?r.toString(n):r}Object.defineProperty(y.prototype,"verifyError",{enumerable:!0,get:function(){return"number"!=typeof this._primeCode&&(this._primeCode=function(t,e){var n=e.toString("hex"),r=[n,t.toString(16)].join("_");if(r in d)return d[r];var h,f=0;if(t.isEven()||!l.simpleSieve||!l.fermatTest(t)||!i.test(t))return f+=1,f+="02"===n||"05"===n?8:4,d[r]=f,f;switch(i.test(t.shrn(1))||(f+=2),n){case"02":t.mod(o).cmp(a)&&(f+=8);break;case"05":(h=t.mod(s)).cmp(c)&&h.cmp(u)&&(f+=8);break;default:f+=4}return d[r]=f,f}(this.__prime,this.__gen)),this._primeCode}}),y.prototype.generateKeys=function(){return this._priv||(this._priv=new r(h(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},y.prototype.computeSecret=function(t){var n=(t=(t=new r(t)).toRed(this._prime)).redPow(this._priv).fromRed(),i=new e(n.toArray()),o=this.getPrime();if(i.length<o.length){var a=new e(o.length-i.length);a.fill(0),i=e.concat([a,i])}return i},y.prototype.getPublicKey=function(t){return m(this._pub,t)},y.prototype.getPrivateKey=function(t){return m(this._priv,t)},y.prototype.getPrime=function(t){return m(this.__prime,t)},y.prototype.getGenerator=function(t){return m(this._gen,t)},y.prototype.setGenerator=function(t,n){return n=n||"utf8",e.isBuffer(t)||(t=new e(t,n)),this.__gen=t,this._gen=new r(t),this}}).call(this,n(59).Buffer)},function(t,e,n){(function(e){var r=n(289),i=n(391),o=n(37),a=n(749),s=n(784),c=n(509);function u(t){i.Writable.call(this);var e=c[t];if(!e)throw new Error("Unknown message digest");this._hashType=e.hash,this._hash=r(e.hash),this._tag=e.id,this._signType=e.sign}function l(t){i.Writable.call(this);var e=c[t];if(!e)throw new Error("Unknown message digest");this._hash=r(e.hash),this._tag=e.id,this._signType=e.sign}function h(t){return new u(t)}function f(t){return new l(t)}Object.keys(c).forEach((function(t){c[t].id=new e(c[t].id,"hex"),c[t.toLowerCase()]=c[t]})),o(u,i.Writable),u.prototype._write=function(t,e,n){this._hash.update(t),n()},u.prototype.update=function(t,n){return"string"==typeof t&&(t=new e(t,n)),this._hash.update(t),this},u.prototype.sign=function(t,e){this.end();var n=this._hash.digest(),r=a(n,t,this._hashType,this._signType,this._tag);return e?r.toString(e):r},o(l,i.Writable),l.prototype._write=function(t,e,n){this._hash.update(t),n()},l.prototype.update=function(t,n){return"string"==typeof t&&(t=new e(t,n)),this._hash.update(t),this},l.prototype.verify=function(t,n,r){"string"==typeof n&&(n=new e(n,r)),this.end();var i=this._hash.digest();return s(n,i,t,this._signType,this._tag)},t.exports={Sign:h,Verify:f,createSign:h,createVerify:f}}).call(this,n(59).Buffer)},function(t,e,n){(function(e){var r=n(506),i=n(400),o=n(128).ec,a=n(95),s=n(340),c=n(531);function u(t,n,i,o){if((t=new e(t.toArray())).length<n.byteLength()){var a=new e(n.byteLength()-t.length);a.fill(0),t=e.concat([a,t])}var s=i.length,c=function(t,n){t=(t=l(t,n)).mod(n);var r=new e(t.toArray());if(r.length<n.byteLength()){var i=new e(n.byteLength()-r.length);i.fill(0),r=e.concat([i,r])}return r}(i,n),u=new e(s);u.fill(1);var h=new e(s);return h.fill(0),h=r(o,h).update(u).update(new e([0])).update(t).update(c).digest(),u=r(o,h).update(u).digest(),{k:h=r(o,h).update(u).update(new e([1])).update(t).update(c).digest(),v:u=r(o,h).update(u).digest()}}function l(t,e){var n=new a(t),r=(t.length<<3)-e.bitLength();return r>0&&n.ishrn(r),n}function h(t,n,i){var o,a;do{for(o=new e(0);8*o.length<t.bitLength();)n.v=r(i,n.k).update(n.v).digest(),o=e.concat([o,n.v]);a=l(o,t),n.k=r(i,n.k).update(n.v).update(new e([0])).digest(),n.v=r(i,n.k).update(n.v).digest()}while(-1!==a.cmp(t));return a}function f(t,e,n,r){return t.toRed(a.mont(n)).redPow(e).fromRed().mod(r)}t.exports=function(t,n,r,p,d){var y=s(n);if(y.curve){if("ecdsa"!==p&&"ecdsa/rsa"!==p)throw new Error("wrong private key type");return function(t,n){var r=c[n.curve.join(".")];if(!r)throw new Error("unknown curve "+n.curve.join("."));var i=new o(r).keyFromPrivate(n.privateKey).sign(t);return new e(i.toDER())}(t,y)}if("dsa"===y.type){if("dsa"!==p)throw new Error("wrong private key type");return function(t,n,r){var i,o=n.params.priv_key,s=n.params.p,c=n.params.q,p=n.params.g,d=new a(0),y=l(t,c).mod(c),m=!1,v=u(o,c,t,r);for(;!1===m;)i=h(c,v,r),d=f(p,i,s,c),0===(m=i.invm(c).imul(y.add(o.mul(d))).mod(c)).cmpn(0)&&(m=!1,d=new a(0));return function(t,n){t=t.toArray(),n=n.toArray(),128&t[0]&&(t=[0].concat(t));128&n[0]&&(n=[0].concat(n));var r=[48,t.length+n.length+4,2,t.length];return r=r.concat(t,[2,n.length],n),new e(r)}(d,m)}(t,y,r)}if("rsa"!==p&&"ecdsa/rsa"!==p)throw new Error("wrong private key type");t=e.concat([d,t]);for(var m=y.modulus.byteLength(),v=[0,1];t.length+v.length+1<m;)v.push(255);v.push(0);for(var g=-1;++g<t.length;)v.push(t[g]);return i(v,y)},t.exports.getKey=u,t.exports.makeKey=h}).call(this,n(59).Buffer)},function(t){t.exports=JSON.parse('{"name":"elliptic","version":"6.4.0","description":"EC cryptography","main":"lib/elliptic.js","files":["lib"],"scripts":{"jscs":"jscs benchmarks/*.js lib/*.js lib/**/*.js lib/**/**/*.js test/index.js","jshint":"jscs benchmarks/*.js lib/*.js lib/**/*.js lib/**/**/*.js test/index.js","lint":"npm run jscs && npm run jshint","unit":"istanbul test _mocha --reporter=spec test/index.js","test":"npm run lint && npm run unit","version":"grunt dist && git add dist/"},"repository":{"type":"git","url":"git@github.com:indutny/elliptic"},"keywords":["EC","Elliptic","curve","Cryptography"],"author":"Fedor Indutny <fedor@indutny.com>","license":"MIT","bugs":{"url":"https://github.com/indutny/elliptic/issues"},"homepage":"https://github.com/indutny/elliptic","devDependencies":{"brfs":"^1.4.3","coveralls":"^2.11.3","grunt":"^0.4.5","grunt-browserify":"^5.0.0","grunt-cli":"^1.2.0","grunt-contrib-connect":"^1.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^1.0.1","grunt-mocha-istanbul":"^3.0.1","grunt-saucelabs":"^8.6.2","istanbul":"^0.4.2","jscs":"^2.9.0","jshint":"^2.6.0","mocha":"^2.1.0"},"dependencies":{"bn.js":"^4.4.0","brorand":"^1.0.1","hash.js":"^1.0.0","hmac-drbg":"^1.0.0","inherits":"^2.0.1","minimalistic-assert":"^1.0.0","minimalistic-crypto-utils":"^1.0.0"}}')},function(t,e,n){"use strict";var r=e,i=n(95),o=n(145),a=n(523);r.assert=o,r.toArray=a.toArray,r.zero2=a.zero2,r.toHex=a.toHex,r.encode=a.encode,r.getNAF=function(t,e){for(var n=[],r=1<<e+1,i=t.clone();i.cmpn(1)>=0;){var o;if(i.isOdd()){var a=i.andln(r-1);o=a>(r>>1)-1?(r>>1)-a:a,i.isubn(o)}else o=0;n.push(o);for(var s=0!==i.cmpn(0)&&0===i.andln(r-1)?e+1:1,c=1;c<s;c++)n.push(0);i.iushrn(s)}return n},r.getJSF=function(t,e){var n=[[],[]];t=t.clone(),e=e.clone();for(var r=0,i=0;t.cmpn(-r)>0||e.cmpn(-i)>0;){var o,a,s,c=t.andln(3)+r&3,u=e.andln(3)+i&3;if(3===c&&(c=-1),3===u&&(u=-1),0==(1&c))o=0;else o=3!==(s=t.andln(7)+r&7)&&5!==s||2!==u?c:-c;if(n[0].push(o),0==(1&u))a=0;else a=3!==(s=e.andln(7)+i&7)&&5!==s||2!==c?u:-u;n[1].push(a),2*r===o+1&&(r=1-r),2*i===a+1&&(i=1-i),t.iushrn(1),e.iushrn(1)}return n},r.cachedProperty=function(t,e,n){var r="_"+e;t.prototype[e]=function(){return void 0!==this[r]?this[r]:this[r]=n.call(this)}},r.parseBytes=function(t){return"string"==typeof t?r.toArray(t,"hex"):t},r.intFromLE=function(t){return new i(t,"hex","le")}},function(t,e,n){"use strict";var r=n(95),i=n(128).utils,o=i.getNAF,a=i.getJSF,s=i.assert;function c(t,e){this.type=t,this.p=new r(e.p,16),this.red=e.prime?r.red(e.prime):r.mont(this.p),this.zero=new r(0).toRed(this.red),this.one=new r(1).toRed(this.red),this.two=new r(2).toRed(this.red),this.n=e.n&&new r(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4);var n=this.n&&this.p.div(this.n);!n||n.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function u(t,e){this.curve=t,this.type=e,this.precomputed=null}t.exports=c,c.prototype.point=function(){throw new Error("Not implemented")},c.prototype.validate=function(){throw new Error("Not implemented")},c.prototype._fixedNafMul=function(t,e){s(t.precomputed);var n=t._getDoubles(),r=o(e,1),i=(1<<n.step+1)-(n.step%2==0?2:1);i/=3;for(var a=[],c=0;c<r.length;c+=n.step){var u=0;for(e=c+n.step-1;e>=c;e--)u=(u<<1)+r[e];a.push(u)}for(var l=this.jpoint(null,null,null),h=this.jpoint(null,null,null),f=i;f>0;f--){for(c=0;c<a.length;c++){(u=a[c])===f?h=h.mixedAdd(n.points[c]):u===-f&&(h=h.mixedAdd(n.points[c].neg()))}l=l.add(h)}return l.toP()},c.prototype._wnafMul=function(t,e){var n=4,r=t._getNAFPoints(n);n=r.wnd;for(var i=r.points,a=o(e,n),c=this.jpoint(null,null,null),u=a.length-1;u>=0;u--){for(e=0;u>=0&&0===a[u];u--)e++;if(u>=0&&e++,c=c.dblp(e),u<0)break;var l=a[u];s(0!==l),c="affine"===t.type?l>0?c.mixedAdd(i[l-1>>1]):c.mixedAdd(i[-l-1>>1].neg()):l>0?c.add(i[l-1>>1]):c.add(i[-l-1>>1].neg())}return"affine"===t.type?c.toP():c},c.prototype._wnafMulAdd=function(t,e,n,r,i){for(var s=this._wnafT1,c=this._wnafT2,u=this._wnafT3,l=0,h=0;h<r;h++){var f=(M=e[h])._getNAFPoints(t);s[h]=f.wnd,c[h]=f.points}for(h=r-1;h>=1;h-=2){var p=h-1,d=h;if(1===s[p]&&1===s[d]){var y=[e[p],null,null,e[d]];0===e[p].y.cmp(e[d].y)?(y[1]=e[p].add(e[d]),y[2]=e[p].toJ().mixedAdd(e[d].neg())):0===e[p].y.cmp(e[d].y.redNeg())?(y[1]=e[p].toJ().mixedAdd(e[d]),y[2]=e[p].add(e[d].neg())):(y[1]=e[p].toJ().mixedAdd(e[d]),y[2]=e[p].toJ().mixedAdd(e[d].neg()));var m=[-3,-1,-5,-7,0,7,5,1,3],v=a(n[p],n[d]);l=Math.max(v[0].length,l),u[p]=new Array(l),u[d]=new Array(l);for(var g=0;g<l;g++){var b=0|v[0][g],w=0|v[1][g];u[p][g]=m[3*(b+1)+(w+1)],u[d][g]=0,c[p]=y}}else u[p]=o(n[p],s[p]),u[d]=o(n[d],s[d]),l=Math.max(u[p].length,l),l=Math.max(u[d].length,l)}var _=this.jpoint(null,null,null),x=this._wnafT4;for(h=l;h>=0;h--){for(var S=0;h>=0;){var T=!0;for(g=0;g<r;g++)x[g]=0|u[g][h],0!==x[g]&&(T=!1);if(!T)break;S++,h--}if(h>=0&&S++,_=_.dblp(S),h<0)break;for(g=0;g<r;g++){var M,E=x[g];0!==E&&(E>0?M=c[g][E-1>>1]:E<0&&(M=c[g][-E-1>>1].neg()),_="affine"===M.type?_.mixedAdd(M):_.add(M))}}for(h=0;h<r;h++)c[h]=null;return i?_:_.toP()},c.BasePoint=u,u.prototype.eq=function(){throw new Error("Not implemented")},u.prototype.validate=function(){return this.curve.validate(this)},c.prototype.decodePoint=function(t,e){t=i.toArray(t,e);var n=this.p.byteLength();if((4===t[0]||6===t[0]||7===t[0])&&t.length-1==2*n)return 6===t[0]?s(t[t.length-1]%2==0):7===t[0]&&s(t[t.length-1]%2==1),this.point(t.slice(1,1+n),t.slice(1+n,1+2*n));if((2===t[0]||3===t[0])&&t.length-1===n)return this.pointFromX(t.slice(1,1+n),3===t[0]);throw new Error("Unknown point format")},u.prototype.encodeCompressed=function(t){return this.encode(t,!0)},u.prototype._encode=function(t){var e=this.curve.p.byteLength(),n=this.getX().toArray("be",e);return t?[this.getY().isEven()?2:3].concat(n):[4].concat(n,this.getY().toArray("be",e))},u.prototype.encode=function(t,e){return i.encode(this._encode(e),t)},u.prototype.precompute=function(t){if(this.precomputed)return this;var e={doubles:null,naf:null,beta:null};return e.naf=this._getNAFPoints(8),e.doubles=this._getDoubles(4,t),e.beta=this._getBeta(),this.precomputed=e,this},u.prototype._hasDoubles=function(t){if(!this.precomputed)return!1;var e=this.precomputed.doubles;return!!e&&e.points.length>=Math.ceil((t.bitLength()+1)/e.step)},u.prototype._getDoubles=function(t,e){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var n=[this],r=this,i=0;i<e;i+=t){for(var o=0;o<t;o++)r=r.dbl();n.push(r)}return{step:t,points:n}},u.prototype._getNAFPoints=function(t){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var e=[this],n=(1<<t)-1,r=1===n?null:this.dbl(),i=1;i<n;i++)e[i]=e[i-1].add(r);return{wnd:t,points:e}},u.prototype._getBeta=function(){return null},u.prototype.dblp=function(t){for(var e=this,n=0;n<t;n++)e=e.dbl();return e}},function(t,e,n){"use strict";var r=n(339),i=n(128),o=n(95),a=n(37),s=r.base,c=i.utils.assert;function u(t){s.call(this,"short",t),this.a=new o(t.a,16).toRed(this.red),this.b=new o(t.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=0===this.a.fromRed().cmpn(0),this.threeA=0===this.a.fromRed().sub(this.p).cmpn(-3),this.endo=this._getEndomorphism(t),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function l(t,e,n,r){s.BasePoint.call(this,t,"affine"),null===e&&null===n?(this.x=null,this.y=null,this.inf=!0):(this.x=new o(e,16),this.y=new o(n,16),r&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function h(t,e,n,r){s.BasePoint.call(this,t,"jacobian"),null===e&&null===n&&null===r?(this.x=this.curve.one,this.y=this.curve.one,this.z=new o(0)):(this.x=new o(e,16),this.y=new o(n,16),this.z=new o(r,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}a(u,s),t.exports=u,u.prototype._getEndomorphism=function(t){if(this.zeroA&&this.g&&this.n&&1===this.p.modn(3)){var e,n;if(t.beta)e=new o(t.beta,16).toRed(this.red);else{var r=this._getEndoRoots(this.p);e=(e=r[0].cmp(r[1])<0?r[0]:r[1]).toRed(this.red)}if(t.lambda)n=new o(t.lambda,16);else{var i=this._getEndoRoots(this.n);0===this.g.mul(i[0]).x.cmp(this.g.x.redMul(e))?n=i[0]:(n=i[1],c(0===this.g.mul(n).x.cmp(this.g.x.redMul(e))))}return{beta:e,lambda:n,basis:t.basis?t.basis.map((function(t){return{a:new o(t.a,16),b:new o(t.b,16)}})):this._getEndoBasis(n)}}},u.prototype._getEndoRoots=function(t){var e=t===this.p?this.red:o.mont(t),n=new o(2).toRed(e).redInvm(),r=n.redNeg(),i=new o(3).toRed(e).redNeg().redSqrt().redMul(n);return[r.redAdd(i).fromRed(),r.redSub(i).fromRed()]},u.prototype._getEndoBasis=function(t){for(var e,n,r,i,a,s,c,u,l,h=this.n.ushrn(Math.floor(this.n.bitLength()/2)),f=t,p=this.n.clone(),d=new o(1),y=new o(0),m=new o(0),v=new o(1),g=0;0!==f.cmpn(0);){var b=p.div(f);u=p.sub(b.mul(f)),l=m.sub(b.mul(d));var w=v.sub(b.mul(y));if(!r&&u.cmp(h)<0)e=c.neg(),n=d,r=u.neg(),i=l;else if(r&&2==++g)break;c=u,p=f,f=u,m=d,d=l,v=y,y=w}a=u.neg(),s=l;var _=r.sqr().add(i.sqr());return a.sqr().add(s.sqr()).cmp(_)>=0&&(a=e,s=n),r.negative&&(r=r.neg(),i=i.neg()),a.negative&&(a=a.neg(),s=s.neg()),[{a:r,b:i},{a:a,b:s}]},u.prototype._endoSplit=function(t){var e=this.endo.basis,n=e[0],r=e[1],i=r.b.mul(t).divRound(this.n),o=n.b.neg().mul(t).divRound(this.n),a=i.mul(n.a),s=o.mul(r.a),c=i.mul(n.b),u=o.mul(r.b);return{k1:t.sub(a).sub(s),k2:c.add(u).neg()}},u.prototype.pointFromX=function(t,e){(t=new o(t,16)).red||(t=t.toRed(this.red));var n=t.redSqr().redMul(t).redIAdd(t.redMul(this.a)).redIAdd(this.b),r=n.redSqrt();if(0!==r.redSqr().redSub(n).cmp(this.zero))throw new Error("invalid point");var i=r.fromRed().isOdd();return(e&&!i||!e&&i)&&(r=r.redNeg()),this.point(t,r)},u.prototype.validate=function(t){if(t.inf)return!0;var e=t.x,n=t.y,r=this.a.redMul(e),i=e.redSqr().redMul(e).redIAdd(r).redIAdd(this.b);return 0===n.redSqr().redISub(i).cmpn(0)},u.prototype._endoWnafMulAdd=function(t,e,n){for(var r=this._endoWnafT1,i=this._endoWnafT2,o=0;o<t.length;o++){var a=this._endoSplit(e[o]),s=t[o],c=s._getBeta();a.k1.negative&&(a.k1.ineg(),s=s.neg(!0)),a.k2.negative&&(a.k2.ineg(),c=c.neg(!0)),r[2*o]=s,r[2*o+1]=c,i[2*o]=a.k1,i[2*o+1]=a.k2}for(var u=this._wnafMulAdd(1,r,i,2*o,n),l=0;l<2*o;l++)r[l]=null,i[l]=null;return u},a(l,s.BasePoint),u.prototype.point=function(t,e,n){return new l(this,t,e,n)},u.prototype.pointFromJSON=function(t,e){return l.fromJSON(this,t,e)},l.prototype._getBeta=function(){if(this.curve.endo){var t=this.precomputed;if(t&&t.beta)return t.beta;var e=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(t){var n=this.curve,r=function(t){return n.point(t.x.redMul(n.endo.beta),t.y)};t.beta=e,e.precomputed={beta:null,naf:t.naf&&{wnd:t.naf.wnd,points:t.naf.points.map(r)},doubles:t.doubles&&{step:t.doubles.step,points:t.doubles.points.map(r)}}}return e}},l.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},l.fromJSON=function(t,e,n){"string"==typeof e&&(e=JSON.parse(e));var r=t.point(e[0],e[1],n);if(!e[2])return r;function i(e){return t.point(e[0],e[1],n)}var o=e[2];return r.precomputed={beta:null,doubles:o.doubles&&{step:o.doubles.step,points:[r].concat(o.doubles.points.map(i))},naf:o.naf&&{wnd:o.naf.wnd,points:[r].concat(o.naf.points.map(i))}},r},l.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},l.prototype.isInfinity=function(){return this.inf},l.prototype.add=function(t){if(this.inf)return t;if(t.inf)return this;if(this.eq(t))return this.dbl();if(this.neg().eq(t))return this.curve.point(null,null);if(0===this.x.cmp(t.x))return this.curve.point(null,null);var e=this.y.redSub(t.y);0!==e.cmpn(0)&&(e=e.redMul(this.x.redSub(t.x).redInvm()));var n=e.redSqr().redISub(this.x).redISub(t.x),r=e.redMul(this.x.redSub(n)).redISub(this.y);return this.curve.point(n,r)},l.prototype.dbl=function(){if(this.inf)return this;var t=this.y.redAdd(this.y);if(0===t.cmpn(0))return this.curve.point(null,null);var e=this.curve.a,n=this.x.redSqr(),r=t.redInvm(),i=n.redAdd(n).redIAdd(n).redIAdd(e).redMul(r),o=i.redSqr().redISub(this.x.redAdd(this.x)),a=i.redMul(this.x.redSub(o)).redISub(this.y);return this.curve.point(o,a)},l.prototype.getX=function(){return this.x.fromRed()},l.prototype.getY=function(){return this.y.fromRed()},l.prototype.mul=function(t){return t=new o(t,16),this._hasDoubles(t)?this.curve._fixedNafMul(this,t):this.curve.endo?this.curve._endoWnafMulAdd([this],[t]):this.curve._wnafMul(this,t)},l.prototype.mulAdd=function(t,e,n){var r=[this,e],i=[t,n];return this.curve.endo?this.curve._endoWnafMulAdd(r,i):this.curve._wnafMulAdd(1,r,i,2)},l.prototype.jmulAdd=function(t,e,n){var r=[this,e],i=[t,n];return this.curve.endo?this.curve._endoWnafMulAdd(r,i,!0):this.curve._wnafMulAdd(1,r,i,2,!0)},l.prototype.eq=function(t){return this===t||this.inf===t.inf&&(this.inf||0===this.x.cmp(t.x)&&0===this.y.cmp(t.y))},l.prototype.neg=function(t){if(this.inf)return this;var e=this.curve.point(this.x,this.y.redNeg());if(t&&this.precomputed){var n=this.precomputed,r=function(t){return t.neg()};e.precomputed={naf:n.naf&&{wnd:n.naf.wnd,points:n.naf.points.map(r)},doubles:n.doubles&&{step:n.doubles.step,points:n.doubles.points.map(r)}}}return e},l.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},a(h,s.BasePoint),u.prototype.jpoint=function(t,e,n){return new h(this,t,e,n)},h.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var t=this.z.redInvm(),e=t.redSqr(),n=this.x.redMul(e),r=this.y.redMul(e).redMul(t);return this.curve.point(n,r)},h.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},h.prototype.add=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;var e=t.z.redSqr(),n=this.z.redSqr(),r=this.x.redMul(e),i=t.x.redMul(n),o=this.y.redMul(e.redMul(t.z)),a=t.y.redMul(n.redMul(this.z)),s=r.redSub(i),c=o.redSub(a);if(0===s.cmpn(0))return 0!==c.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var u=s.redSqr(),l=u.redMul(s),h=r.redMul(u),f=c.redSqr().redIAdd(l).redISub(h).redISub(h),p=c.redMul(h.redISub(f)).redISub(o.redMul(l)),d=this.z.redMul(t.z).redMul(s);return this.curve.jpoint(f,p,d)},h.prototype.mixedAdd=function(t){if(this.isInfinity())return t.toJ();if(t.isInfinity())return this;var e=this.z.redSqr(),n=this.x,r=t.x.redMul(e),i=this.y,o=t.y.redMul(e).redMul(this.z),a=n.redSub(r),s=i.redSub(o);if(0===a.cmpn(0))return 0!==s.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var c=a.redSqr(),u=c.redMul(a),l=n.redMul(c),h=s.redSqr().redIAdd(u).redISub(l).redISub(l),f=s.redMul(l.redISub(h)).redISub(i.redMul(u)),p=this.z.redMul(a);return this.curve.jpoint(h,f,p)},h.prototype.dblp=function(t){if(0===t)return this;if(this.isInfinity())return this;if(!t)return this.dbl();if(this.curve.zeroA||this.curve.threeA){for(var e=this,n=0;n<t;n++)e=e.dbl();return e}var r=this.curve.a,i=this.curve.tinv,o=this.x,a=this.y,s=this.z,c=s.redSqr().redSqr(),u=a.redAdd(a);for(n=0;n<t;n++){var l=o.redSqr(),h=u.redSqr(),f=h.redSqr(),p=l.redAdd(l).redIAdd(l).redIAdd(r.redMul(c)),d=o.redMul(h),y=p.redSqr().redISub(d.redAdd(d)),m=d.redISub(y),v=p.redMul(m);v=v.redIAdd(v).redISub(f);var g=u.redMul(s);n+1<t&&(c=c.redMul(f)),o=y,s=g,u=v}return this.curve.jpoint(o,u.redMul(i),s)},h.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},h.prototype._zeroDbl=function(){var t,e,n;if(this.zOne){var r=this.x.redSqr(),i=this.y.redSqr(),o=i.redSqr(),a=this.x.redAdd(i).redSqr().redISub(r).redISub(o);a=a.redIAdd(a);var s=r.redAdd(r).redIAdd(r),c=s.redSqr().redISub(a).redISub(a),u=o.redIAdd(o);u=(u=u.redIAdd(u)).redIAdd(u),t=c,e=s.redMul(a.redISub(c)).redISub(u),n=this.y.redAdd(this.y)}else{var l=this.x.redSqr(),h=this.y.redSqr(),f=h.redSqr(),p=this.x.redAdd(h).redSqr().redISub(l).redISub(f);p=p.redIAdd(p);var d=l.redAdd(l).redIAdd(l),y=d.redSqr(),m=f.redIAdd(f);m=(m=m.redIAdd(m)).redIAdd(m),t=y.redISub(p).redISub(p),e=d.redMul(p.redISub(t)).redISub(m),n=(n=this.y.redMul(this.z)).redIAdd(n)}return this.curve.jpoint(t,e,n)},h.prototype._threeDbl=function(){var t,e,n;if(this.zOne){var r=this.x.redSqr(),i=this.y.redSqr(),o=i.redSqr(),a=this.x.redAdd(i).redSqr().redISub(r).redISub(o);a=a.redIAdd(a);var s=r.redAdd(r).redIAdd(r).redIAdd(this.curve.a),c=s.redSqr().redISub(a).redISub(a);t=c;var u=o.redIAdd(o);u=(u=u.redIAdd(u)).redIAdd(u),e=s.redMul(a.redISub(c)).redISub(u),n=this.y.redAdd(this.y)}else{var l=this.z.redSqr(),h=this.y.redSqr(),f=this.x.redMul(h),p=this.x.redSub(l).redMul(this.x.redAdd(l));p=p.redAdd(p).redIAdd(p);var d=f.redIAdd(f),y=(d=d.redIAdd(d)).redAdd(d);t=p.redSqr().redISub(y),n=this.y.redAdd(this.z).redSqr().redISub(h).redISub(l);var m=h.redSqr();m=(m=(m=m.redIAdd(m)).redIAdd(m)).redIAdd(m),e=p.redMul(d.redISub(t)).redISub(m)}return this.curve.jpoint(t,e,n)},h.prototype._dbl=function(){var t=this.curve.a,e=this.x,n=this.y,r=this.z,i=r.redSqr().redSqr(),o=e.redSqr(),a=n.redSqr(),s=o.redAdd(o).redIAdd(o).redIAdd(t.redMul(i)),c=e.redAdd(e),u=(c=c.redIAdd(c)).redMul(a),l=s.redSqr().redISub(u.redAdd(u)),h=u.redISub(l),f=a.redSqr();f=(f=(f=f.redIAdd(f)).redIAdd(f)).redIAdd(f);var p=s.redMul(h).redISub(f),d=n.redAdd(n).redMul(r);return this.curve.jpoint(l,p,d)},h.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var t=this.x.redSqr(),e=this.y.redSqr(),n=this.z.redSqr(),r=e.redSqr(),i=t.redAdd(t).redIAdd(t),o=i.redSqr(),a=this.x.redAdd(e).redSqr().redISub(t).redISub(r),s=(a=(a=(a=a.redIAdd(a)).redAdd(a).redIAdd(a)).redISub(o)).redSqr(),c=r.redIAdd(r);c=(c=(c=c.redIAdd(c)).redIAdd(c)).redIAdd(c);var u=i.redIAdd(a).redSqr().redISub(o).redISub(s).redISub(c),l=e.redMul(u);l=(l=l.redIAdd(l)).redIAdd(l);var h=this.x.redMul(s).redISub(l);h=(h=h.redIAdd(h)).redIAdd(h);var f=this.y.redMul(u.redMul(c.redISub(u)).redISub(a.redMul(s)));f=(f=(f=f.redIAdd(f)).redIAdd(f)).redIAdd(f);var p=this.z.redAdd(a).redSqr().redISub(n).redISub(s);return this.curve.jpoint(h,f,p)},h.prototype.mul=function(t,e){return t=new o(t,e),this.curve._wnafMul(this,t)},h.prototype.eq=function(t){if("affine"===t.type)return this.eq(t.toJ());if(this===t)return!0;var e=this.z.redSqr(),n=t.z.redSqr();if(0!==this.x.redMul(n).redISub(t.x.redMul(e)).cmpn(0))return!1;var r=e.redMul(this.z),i=n.redMul(t.z);return 0===this.y.redMul(i).redISub(t.y.redMul(r)).cmpn(0)},h.prototype.eqXToP=function(t){var e=this.z.redSqr(),n=t.toRed(this.curve.red).redMul(e);if(0===this.x.cmp(n))return!0;for(var r=t.clone(),i=this.curve.redN.redMul(e);;){if(r.iadd(this.curve.n),r.cmp(this.curve.p)>=0)return!1;if(n.redIAdd(i),0===this.x.cmp(n))return!0}return!1},h.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},h.prototype.isInfinity=function(){return 0===this.z.cmpn(0)}},function(t,e,n){"use strict";var r=n(339),i=n(95),o=n(37),a=r.base,s=n(128).utils;function c(t){a.call(this,"mont",t),this.a=new i(t.a,16).toRed(this.red),this.b=new i(t.b,16).toRed(this.red),this.i4=new i(4).toRed(this.red).redInvm(),this.two=new i(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function u(t,e,n){a.BasePoint.call(this,t,"projective"),null===e&&null===n?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new i(e,16),this.z=new i(n,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}o(c,a),t.exports=c,c.prototype.validate=function(t){var e=t.normalize().x,n=e.redSqr(),r=n.redMul(e).redAdd(n.redMul(this.a)).redAdd(e);return 0===r.redSqrt().redSqr().cmp(r)},o(u,a.BasePoint),c.prototype.decodePoint=function(t,e){return this.point(s.toArray(t,e),1)},c.prototype.point=function(t,e){return new u(this,t,e)},c.prototype.pointFromJSON=function(t){return u.fromJSON(this,t)},u.prototype.precompute=function(){},u.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},u.fromJSON=function(t,e){return new u(t,e[0],e[1]||t.one)},u.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},u.prototype.isInfinity=function(){return 0===this.z.cmpn(0)},u.prototype.dbl=function(){var t=this.x.redAdd(this.z).redSqr(),e=this.x.redSub(this.z).redSqr(),n=t.redSub(e),r=t.redMul(e),i=n.redMul(e.redAdd(this.curve.a24.redMul(n)));return this.curve.point(r,i)},u.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},u.prototype.diffAdd=function(t,e){var n=this.x.redAdd(this.z),r=this.x.redSub(this.z),i=t.x.redAdd(t.z),o=t.x.redSub(t.z).redMul(n),a=i.redMul(r),s=e.z.redMul(o.redAdd(a).redSqr()),c=e.x.redMul(o.redISub(a).redSqr());return this.curve.point(s,c)},u.prototype.mul=function(t){for(var e=t.clone(),n=this,r=this.curve.point(null,null),i=[];0!==e.cmpn(0);e.iushrn(1))i.push(e.andln(1));for(var o=i.length-1;o>=0;o--)0===i[o]?(n=n.diffAdd(r,this),r=r.dbl()):(r=n.diffAdd(r,this),n=n.dbl());return r},u.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},u.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},u.prototype.eq=function(t){return 0===this.getX().cmp(t.getX())},u.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},u.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},function(t,e,n){"use strict";var r=n(339),i=n(128),o=n(95),a=n(37),s=r.base,c=i.utils.assert;function u(t){this.twisted=1!=(0|t.a),this.mOneA=this.twisted&&-1==(0|t.a),this.extended=this.mOneA,s.call(this,"edwards",t),this.a=new o(t.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new o(t.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new o(t.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),c(!this.twisted||0===this.c.fromRed().cmpn(1)),this.oneC=1==(0|t.c)}function l(t,e,n,r,i){s.BasePoint.call(this,t,"projective"),null===e&&null===n&&null===r?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new o(e,16),this.y=new o(n,16),this.z=r?new o(r,16):this.curve.one,this.t=i&&new o(i,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}a(u,s),t.exports=u,u.prototype._mulA=function(t){return this.mOneA?t.redNeg():this.a.redMul(t)},u.prototype._mulC=function(t){return this.oneC?t:this.c.redMul(t)},u.prototype.jpoint=function(t,e,n,r){return this.point(t,e,n,r)},u.prototype.pointFromX=function(t,e){(t=new o(t,16)).red||(t=t.toRed(this.red));var n=t.redSqr(),r=this.c2.redSub(this.a.redMul(n)),i=this.one.redSub(this.c2.redMul(this.d).redMul(n)),a=r.redMul(i.redInvm()),s=a.redSqrt();if(0!==s.redSqr().redSub(a).cmp(this.zero))throw new Error("invalid point");var c=s.fromRed().isOdd();return(e&&!c||!e&&c)&&(s=s.redNeg()),this.point(t,s)},u.prototype.pointFromY=function(t,e){(t=new o(t,16)).red||(t=t.toRed(this.red));var n=t.redSqr(),r=n.redSub(this.one),i=n.redMul(this.d).redAdd(this.one),a=r.redMul(i.redInvm());if(0===a.cmp(this.zero)){if(e)throw new Error("invalid point");return this.point(this.zero,t)}var s=a.redSqrt();if(0!==s.redSqr().redSub(a).cmp(this.zero))throw new Error("invalid point");return s.isOdd()!==e&&(s=s.redNeg()),this.point(s,t)},u.prototype.validate=function(t){if(t.isInfinity())return!0;t.normalize();var e=t.x.redSqr(),n=t.y.redSqr(),r=e.redMul(this.a).redAdd(n),i=this.c2.redMul(this.one.redAdd(this.d.redMul(e).redMul(n)));return 0===r.cmp(i)},a(l,s.BasePoint),u.prototype.pointFromJSON=function(t){return l.fromJSON(this,t)},u.prototype.point=function(t,e,n,r){return new l(this,t,e,n,r)},l.fromJSON=function(t,e){return new l(t,e[0],e[1],e[2])},l.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},l.prototype.isInfinity=function(){return 0===this.x.cmpn(0)&&0===this.y.cmp(this.z)},l.prototype._extDbl=function(){var t=this.x.redSqr(),e=this.y.redSqr(),n=this.z.redSqr();n=n.redIAdd(n);var r=this.curve._mulA(t),i=this.x.redAdd(this.y).redSqr().redISub(t).redISub(e),o=r.redAdd(e),a=o.redSub(n),s=r.redSub(e),c=i.redMul(a),u=o.redMul(s),l=i.redMul(s),h=a.redMul(o);return this.curve.point(c,u,h,l)},l.prototype._projDbl=function(){var t,e,n,r=this.x.redAdd(this.y).redSqr(),i=this.x.redSqr(),o=this.y.redSqr();if(this.curve.twisted){var a=(u=this.curve._mulA(i)).redAdd(o);if(this.zOne)t=r.redSub(i).redSub(o).redMul(a.redSub(this.curve.two)),e=a.redMul(u.redSub(o)),n=a.redSqr().redSub(a).redSub(a);else{var s=this.z.redSqr(),c=a.redSub(s).redISub(s);t=r.redSub(i).redISub(o).redMul(c),e=a.redMul(u.redSub(o)),n=a.redMul(c)}}else{var u=i.redAdd(o);s=this.curve._mulC(this.c.redMul(this.z)).redSqr(),c=u.redSub(s).redSub(s);t=this.curve._mulC(r.redISub(u)).redMul(c),e=this.curve._mulC(u).redMul(i.redISub(o)),n=u.redMul(c)}return this.curve.point(t,e,n)},l.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},l.prototype._extAdd=function(t){var e=this.y.redSub(this.x).redMul(t.y.redSub(t.x)),n=this.y.redAdd(this.x).redMul(t.y.redAdd(t.x)),r=this.t.redMul(this.curve.dd).redMul(t.t),i=this.z.redMul(t.z.redAdd(t.z)),o=n.redSub(e),a=i.redSub(r),s=i.redAdd(r),c=n.redAdd(e),u=o.redMul(a),l=s.redMul(c),h=o.redMul(c),f=a.redMul(s);return this.curve.point(u,l,f,h)},l.prototype._projAdd=function(t){var e,n,r=this.z.redMul(t.z),i=r.redSqr(),o=this.x.redMul(t.x),a=this.y.redMul(t.y),s=this.curve.d.redMul(o).redMul(a),c=i.redSub(s),u=i.redAdd(s),l=this.x.redAdd(this.y).redMul(t.x.redAdd(t.y)).redISub(o).redISub(a),h=r.redMul(c).redMul(l);return this.curve.twisted?(e=r.redMul(u).redMul(a.redSub(this.curve._mulA(o))),n=c.redMul(u)):(e=r.redMul(u).redMul(a.redSub(o)),n=this.curve._mulC(c).redMul(u)),this.curve.point(h,e,n)},l.prototype.add=function(t){return this.isInfinity()?t:t.isInfinity()?this:this.curve.extended?this._extAdd(t):this._projAdd(t)},l.prototype.mul=function(t){return this._hasDoubles(t)?this.curve._fixedNafMul(this,t):this.curve._wnafMul(this,t)},l.prototype.mulAdd=function(t,e,n){return this.curve._wnafMulAdd(1,[this,e],[t,n],2,!1)},l.prototype.jmulAdd=function(t,e,n){return this.curve._wnafMulAdd(1,[this,e],[t,n],2,!0)},l.prototype.normalize=function(){if(this.zOne)return this;var t=this.z.redInvm();return this.x=this.x.redMul(t),this.y=this.y.redMul(t),this.t&&(this.t=this.t.redMul(t)),this.z=this.curve.one,this.zOne=!0,this},l.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},l.prototype.getX=function(){return this.normalize(),this.x.fromRed()},l.prototype.getY=function(){return this.normalize(),this.y.fromRed()},l.prototype.eq=function(t){return this===t||0===this.getX().cmp(t.getX())&&0===this.getY().cmp(t.getY())},l.prototype.eqXToP=function(t){var e=t.toRed(this.curve.red).redMul(this.z);if(0===this.x.cmp(e))return!0;for(var n=t.clone(),r=this.curve.redN.redMul(this.z);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(e.redIAdd(r),0===this.x.cmp(e))return!0}return!1},l.prototype.toP=l.prototype.normalize,l.prototype.mixedAdd=l.prototype.add},function(t,e,n){"use strict";var r,i=e,o=n(401),a=n(128),s=a.utils.assert;function c(t){"short"===t.type?this.curve=new a.curve.short(t):"edwards"===t.type?this.curve=new a.curve.edwards(t):this.curve=new a.curve.mont(t),this.g=this.curve.g,this.n=this.curve.n,this.hash=t.hash,s(this.g.validate(),"Invalid curve"),s(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function u(t,e){Object.defineProperty(i,t,{configurable:!0,enumerable:!0,get:function(){var n=new c(e);return Object.defineProperty(i,t,{configurable:!0,enumerable:!0,value:n}),n}})}i.PresetCurve=c,u("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:o.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),u("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:o.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),u("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:o.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),u("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:o.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),u("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:o.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),u("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:o.sha256,gRed:!1,g:["9"]}),u("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:o.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{r=n(763)}catch(t){r=void 0}u("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:o.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",r]})},function(t,e,n){"use strict";e.sha1=n(758),e.sha224=n(759),e.sha256=n(525),e.sha384=n(760),e.sha512=n(526)},function(t,e,n){"use strict";var r=n(171),i=n(292),o=n(524),a=r.rotl32,s=r.sum32,c=r.sum32_5,u=o.ft_1,l=i.BlockHash,h=[1518500249,1859775393,2400959708,3395469782];function f(){if(!(this instanceof f))return new f;l.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}r.inherits(f,l),t.exports=f,f.blockSize=512,f.outSize=160,f.hmacStrength=80,f.padLength=64,f.prototype._update=function(t,e){for(var n=this.W,r=0;r<16;r++)n[r]=t[e+r];for(;r<n.length;r++)n[r]=a(n[r-3]^n[r-8]^n[r-14]^n[r-16],1);var i=this.h[0],o=this.h[1],l=this.h[2],f=this.h[3],p=this.h[4];for(r=0;r<n.length;r++){var d=~~(r/20),y=c(a(i,5),u(d,o,l,f),p,n[r],h[d]);p=f,f=l,l=a(o,30),o=i,i=y}this.h[0]=s(this.h[0],i),this.h[1]=s(this.h[1],o),this.h[2]=s(this.h[2],l),this.h[3]=s(this.h[3],f),this.h[4]=s(this.h[4],p)},f.prototype._digest=function(t){return"hex"===t?r.toHex32(this.h,"big"):r.split32(this.h,"big")}},function(t,e,n){"use strict";var r=n(171),i=n(525);function o(){if(!(this instanceof o))return new o;i.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}r.inherits(o,i),t.exports=o,o.blockSize=512,o.outSize=224,o.hmacStrength=192,o.padLength=64,o.prototype._digest=function(t){return"hex"===t?r.toHex32(this.h.slice(0,7),"big"):r.split32(this.h.slice(0,7),"big")}},function(t,e,n){"use strict";var r=n(171),i=n(526);function o(){if(!(this instanceof o))return new o;i.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}r.inherits(o,i),t.exports=o,o.blockSize=1024,o.outSize=384,o.hmacStrength=192,o.padLength=128,o.prototype._digest=function(t){return"hex"===t?r.toHex32(this.h.slice(0,12),"big"):r.split32(this.h.slice(0,12),"big")}},function(t,e,n){"use strict";var r=n(171),i=n(292),o=r.rotl32,a=r.sum32,s=r.sum32_3,c=r.sum32_4,u=i.BlockHash;function l(){if(!(this instanceof l))return new l;u.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function h(t,e,n,r){return t<=15?e^n^r:t<=31?e&n|~e&r:t<=47?(e|~n)^r:t<=63?e&r|n&~r:e^(n|~r)}function f(t){return t<=15?0:t<=31?1518500249:t<=47?1859775393:t<=63?2400959708:2840853838}function p(t){return t<=15?1352829926:t<=31?1548603684:t<=47?1836072691:t<=63?2053994217:0}r.inherits(l,u),e.ripemd160=l,l.blockSize=512,l.outSize=160,l.hmacStrength=192,l.padLength=64,l.prototype._update=function(t,e){for(var n=this.h[0],r=this.h[1],i=this.h[2],u=this.h[3],l=this.h[4],g=n,b=r,w=i,_=u,x=l,S=0;S<80;S++){var T=a(o(c(n,h(S,r,i,u),t[d[S]+e],f(S)),m[S]),l);n=l,l=u,u=o(i,10),i=r,r=T,T=a(o(c(g,h(79-S,b,w,_),t[y[S]+e],p(S)),v[S]),x),g=x,x=_,_=o(w,10),w=b,b=T}T=s(this.h[1],i,_),this.h[1]=s(this.h[2],u,x),this.h[2]=s(this.h[3],l,g),this.h[3]=s(this.h[4],n,b),this.h[4]=s(this.h[0],r,w),this.h[0]=T},l.prototype._digest=function(t){return"hex"===t?r.toHex32(this.h,"little"):r.split32(this.h,"little")};var d=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],y=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],m=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],v=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},function(t,e,n){"use strict";var r=n(171),i=n(145);function o(t,e,n){if(!(this instanceof o))return new o(t,e,n);this.Hash=t,this.blockSize=t.blockSize/8,this.outSize=t.outSize/8,this.inner=null,this.outer=null,this._init(r.toArray(e,n))}t.exports=o,o.prototype._init=function(t){t.length>this.blockSize&&(t=(new this.Hash).update(t).digest()),i(t.length<=this.blockSize);for(var e=t.length;e<this.blockSize;e++)t.push(0);for(e=0;e<t.length;e++)t[e]^=54;for(this.inner=(new this.Hash).update(t),e=0;e<t.length;e++)t[e]^=106;this.outer=(new this.Hash).update(t)},o.prototype.update=function(t,e){return this.inner.update(t,e),this},o.prototype.digest=function(t){return this.outer.update(this.inner.digest()),this.outer.digest(t)}},function(t,e){t.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(95),o=n(765),a=n(128),s=a.utils.assert,c=n(766),u=n(767);function l(t){if(!(this instanceof l))return new l(t);"string"==typeof t&&(s(a.curves.hasOwnProperty(t),"Unknown curve "+t),t=a.curves[t]),t instanceof a.curves.PresetCurve&&(t={curve:t}),this.curve=t.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=t.curve.g,this.g.precompute(t.curve.n.bitLength()+1),this.hash=t.hash||t.curve.hash}t.exports=l,l.prototype.keyPair=function(t){return new c(this,t)},l.prototype.keyFromPrivate=function(t,e){return c.fromPrivate(this,t,e)},l.prototype.keyFromPublic=function(t,e){return c.fromPublic(this,t,e)},l.prototype.genKeyPair=function(t){t||(t={});for(var e=new o({hash:this.hash,pers:t.pers,persEnc:t.persEnc||"utf8",entropy:t.entropy||a.rand(this.hash.hmacStrength),entropyEnc:t.entropy&&t.entropyEnc||"utf8",nonce:this.n.toArray()}),n=this.n.byteLength(),r=this.n.sub(new i(2));;){var s=new i(e.generate(n));if(!(s.cmp(r)>0))return s.iaddn(1),this.keyFromPrivate(s)}},l.prototype._truncateToN=function(t,e){var n=8*t.byteLength()-this.n.bitLength();return n>0&&(t=t.ushrn(n)),!e&&t.cmp(this.n)>=0?t.sub(this.n):t},l.prototype.sign=function(t,e,n,a){"object"===r(n)&&(a=n,n=null),a||(a={}),e=this.keyFromPrivate(e,n),t=this._truncateToN(new i(t,16));for(var s=this.n.byteLength(),c=e.getPrivate().toArray("be",s),l=t.toArray("be",s),h=new o({hash:this.hash,entropy:c,nonce:l,pers:a.pers,persEnc:a.persEnc||"utf8"}),f=this.n.sub(new i(1)),p=0;;p++){var d=a.k?a.k(p):new i(h.generate(this.n.byteLength()));if(!((d=this._truncateToN(d,!0)).cmpn(1)<=0||d.cmp(f)>=0)){var y=this.g.mul(d);if(!y.isInfinity()){var m=y.getX(),v=m.umod(this.n);if(0!==v.cmpn(0)){var g=d.invm(this.n).mul(v.mul(e.getPrivate()).iadd(t));if(0!==(g=g.umod(this.n)).cmpn(0)){var b=(y.getY().isOdd()?1:0)|(0!==m.cmp(v)?2:0);return a.canonical&&g.cmp(this.nh)>0&&(g=this.n.sub(g),b^=1),new u({r:v,s:g,recoveryParam:b})}}}}}},l.prototype.verify=function(t,e,n,r){t=this._truncateToN(new i(t,16)),n=this.keyFromPublic(n,r);var o=(e=new u(e,"hex")).r,a=e.s;if(o.cmpn(1)<0||o.cmp(this.n)>=0)return!1;if(a.cmpn(1)<0||a.cmp(this.n)>=0)return!1;var s,c=a.invm(this.n),l=c.mul(t).umod(this.n),h=c.mul(o).umod(this.n);return this.curve._maxwellTrick?!(s=this.g.jmulAdd(l,n.getPublic(),h)).isInfinity()&&s.eqXToP(o):!(s=this.g.mulAdd(l,n.getPublic(),h)).isInfinity()&&0===s.getX().umod(this.n).cmp(o)},l.prototype.recoverPubKey=function(t,e,n,r){s((3&n)===n,"The recovery param is more than two bits"),e=new u(e,r);var o=this.n,a=new i(t),c=e.r,l=e.s,h=1&n,f=n>>1;if(c.cmp(this.curve.p.umod(this.curve.n))>=0&&f)throw new Error("Unable to find sencond key candinate");c=f?this.curve.pointFromX(c.add(this.curve.n),h):this.curve.pointFromX(c,h);var p=e.r.invm(o),d=o.sub(a).mul(p).umod(o),y=l.mul(p).umod(o);return this.g.mulAdd(d,c,y)},l.prototype.getKeyRecoveryParam=function(t,e,n,r){if(null!==(e=new u(e,r)).recoveryParam)return e.recoveryParam;for(var i=0;i<4;i++){var o;try{o=this.recoverPubKey(t,e,i)}catch(t){continue}if(o.eq(n))return i}throw new Error("Unable to find valid recovery factor")}},function(t,e,n){"use strict";var r=n(401),i=n(523),o=n(145);function a(t){if(!(this instanceof a))return new a(t);this.hash=t.hash,this.predResist=!!t.predResist,this.outLen=this.hash.outSize,this.minEntropy=t.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var e=i.toArray(t.entropy,t.entropyEnc||"hex"),n=i.toArray(t.nonce,t.nonceEnc||"hex"),r=i.toArray(t.pers,t.persEnc||"hex");o(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(e,n,r)}t.exports=a,a.prototype._init=function(t,e,n){var r=t.concat(e).concat(n);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var i=0;i<this.V.length;i++)this.K[i]=0,this.V[i]=1;this._update(r),this._reseed=1,this.reseedInterval=281474976710656},a.prototype._hmac=function(){return new r.hmac(this.hash,this.K)},a.prototype._update=function(t){var e=this._hmac().update(this.V).update([0]);t&&(e=e.update(t)),this.K=e.digest(),this.V=this._hmac().update(this.V).digest(),t&&(this.K=this._hmac().update(this.V).update([1]).update(t).digest(),this.V=this._hmac().update(this.V).digest())},a.prototype.reseed=function(t,e,n,r){"string"!=typeof e&&(r=n,n=e,e=null),t=i.toArray(t,e),n=i.toArray(n,r),o(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(t.concat(n||[])),this._reseed=1},a.prototype.generate=function(t,e,n,r){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");"string"!=typeof e&&(r=n,n=e,e=null),n&&(n=i.toArray(n,r||"hex"),this._update(n));for(var o=[];o.length<t;)this.V=this._hmac().update(this.V).digest(),o=o.concat(this.V);var a=o.slice(0,t);return this._update(n),this._reseed++,i.encode(a,e)}},function(t,e,n){"use strict";var r=n(95),i=n(128).utils.assert;function o(t,e){this.ec=t,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}t.exports=o,o.fromPublic=function(t,e,n){return e instanceof o?e:new o(t,{pub:e,pubEnc:n})},o.fromPrivate=function(t,e,n){return e instanceof o?e:new o(t,{priv:e,privEnc:n})},o.prototype.validate=function(){var t=this.getPublic();return t.isInfinity()?{result:!1,reason:"Invalid public key"}:t.validate()?t.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},o.prototype.getPublic=function(t,e){return"string"==typeof t&&(e=t,t=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),e?this.pub.encode(e,t):this.pub},o.prototype.getPrivate=function(t){return"hex"===t?this.priv.toString(16,2):this.priv},o.prototype._importPrivate=function(t,e){this.priv=new r(t,e||16),this.priv=this.priv.umod(this.ec.curve.n)},o.prototype._importPublic=function(t,e){if(t.x||t.y)return"mont"===this.ec.curve.type?i(t.x,"Need x coordinate"):"short"!==this.ec.curve.type&&"edwards"!==this.ec.curve.type||i(t.x&&t.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(t.x,t.y));this.pub=this.ec.curve.decodePoint(t,e)},o.prototype.derive=function(t){return t.mul(this.priv).getX()},o.prototype.sign=function(t,e,n){return this.ec.sign(t,this,e,n)},o.prototype.verify=function(t,e){return this.ec.verify(t,e,this)},o.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},function(t,e,n){"use strict";var r=n(95),i=n(128).utils,o=i.assert;function a(t,e){if(t instanceof a)return t;this._importDER(t,e)||(o(t.r&&t.s,"Signature without r or s"),this.r=new r(t.r,16),this.s=new r(t.s,16),void 0===t.recoveryParam?this.recoveryParam=null:this.recoveryParam=t.recoveryParam)}function s(){this.place=0}function c(t,e){var n=t[e.place++];if(!(128&n))return n;for(var r=15&n,i=0,o=0,a=e.place;o<r;o++,a++)i<<=8,i|=t[a];return e.place=a,i}function u(t){for(var e=0,n=t.length-1;!t[e]&&!(128&t[e+1])&&e<n;)e++;return 0===e?t:t.slice(e)}function l(t,e){if(e<128)t.push(e);else{var n=1+(Math.log(e)/Math.LN2>>>3);for(t.push(128|n);--n;)t.push(e>>>(n<<3)&255);t.push(e)}}t.exports=a,a.prototype._importDER=function(t,e){t=i.toArray(t,e);var n=new s;if(48!==t[n.place++])return!1;if(c(t,n)+n.place!==t.length)return!1;if(2!==t[n.place++])return!1;var o=c(t,n),a=t.slice(n.place,o+n.place);if(n.place+=o,2!==t[n.place++])return!1;var u=c(t,n);if(t.length!==u+n.place)return!1;var l=t.slice(n.place,u+n.place);return 0===a[0]&&128&a[1]&&(a=a.slice(1)),0===l[0]&&128&l[1]&&(l=l.slice(1)),this.r=new r(a),this.s=new r(l),this.recoveryParam=null,!0},a.prototype.toDER=function(t){var e=this.r.toArray(),n=this.s.toArray();for(128&e[0]&&(e=[0].concat(e)),128&n[0]&&(n=[0].concat(n)),e=u(e),n=u(n);!(n[0]||128&n[1]);)n=n.slice(1);var r=[2];l(r,e.length),(r=r.concat(e)).push(2),l(r,n.length);var o=r.concat(n),a=[48];return l(a,o.length),a=a.concat(o),i.encode(a,t)}},function(t,e,n){"use strict";var r=n(401),i=n(128),o=i.utils,a=o.assert,s=o.parseBytes,c=n(769),u=n(770);function l(t){if(a("ed25519"===t,"only tested with ed25519 so far"),!(this instanceof l))return new l(t);t=i.curves[t].curve;this.curve=t,this.g=t.g,this.g.precompute(t.n.bitLength()+1),this.pointClass=t.point().constructor,this.encodingLength=Math.ceil(t.n.bitLength()/8),this.hash=r.sha512}t.exports=l,l.prototype.sign=function(t,e){t=s(t);var n=this.keyFromSecret(e),r=this.hashInt(n.messagePrefix(),t),i=this.g.mul(r),o=this.encodePoint(i),a=this.hashInt(o,n.pubBytes(),t).mul(n.priv()),c=r.add(a).umod(this.curve.n);return this.makeSignature({R:i,S:c,Rencoded:o})},l.prototype.verify=function(t,e,n){t=s(t),e=this.makeSignature(e);var r=this.keyFromPublic(n),i=this.hashInt(e.Rencoded(),r.pubBytes(),t),o=this.g.mul(e.S());return e.R().add(r.pub().mul(i)).eq(o)},l.prototype.hashInt=function(){for(var t=this.hash(),e=0;e<arguments.length;e++)t.update(arguments[e]);return o.intFromLE(t.digest()).umod(this.curve.n)},l.prototype.keyFromPublic=function(t){return c.fromPublic(this,t)},l.prototype.keyFromSecret=function(t){return c.fromSecret(this,t)},l.prototype.makeSignature=function(t){return t instanceof u?t:new u(this,t)},l.prototype.encodePoint=function(t){var e=t.getY().toArray("le",this.encodingLength);return e[this.encodingLength-1]|=t.getX().isOdd()?128:0,e},l.prototype.decodePoint=function(t){var e=(t=o.parseBytes(t)).length-1,n=t.slice(0,e).concat(-129&t[e]),r=0!=(128&t[e]),i=o.intFromLE(n);return this.curve.pointFromY(i,r)},l.prototype.encodeInt=function(t){return t.toArray("le",this.encodingLength)},l.prototype.decodeInt=function(t){return o.intFromLE(t)},l.prototype.isPoint=function(t){return t instanceof this.pointClass}},function(t,e,n){"use strict";var r=n(128).utils,i=r.assert,o=r.parseBytes,a=r.cachedProperty;function s(t,e){this.eddsa=t,this._secret=o(e.secret),t.isPoint(e.pub)?this._pub=e.pub:this._pubBytes=o(e.pub)}s.fromPublic=function(t,e){return e instanceof s?e:new s(t,{pub:e})},s.fromSecret=function(t,e){return e instanceof s?e:new s(t,{secret:e})},s.prototype.secret=function(){return this._secret},a(s,"pubBytes",(function(){return this.eddsa.encodePoint(this.pub())})),a(s,"pub",(function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())})),a(s,"privBytes",(function(){var t=this.eddsa,e=this.hash(),n=t.encodingLength-1,r=e.slice(0,t.encodingLength);return r[0]&=248,r[n]&=127,r[n]|=64,r})),a(s,"priv",(function(){return this.eddsa.decodeInt(this.privBytes())})),a(s,"hash",(function(){return this.eddsa.hash().update(this.secret()).digest()})),a(s,"messagePrefix",(function(){return this.hash().slice(this.eddsa.encodingLength)})),s.prototype.sign=function(t){return i(this._secret,"KeyPair can only verify"),this.eddsa.sign(t,this)},s.prototype.verify=function(t,e){return this.eddsa.verify(t,e,this)},s.prototype.getSecret=function(t){return i(this._secret,"KeyPair is public only"),r.encode(this.secret(),t)},s.prototype.getPublic=function(t){return r.encode(this.pubBytes(),t)},t.exports=s},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(95),o=n(128).utils,a=o.assert,s=o.cachedProperty,c=o.parseBytes;function u(t,e){this.eddsa=t,"object"!==r(e)&&(e=c(e)),Array.isArray(e)&&(e={R:e.slice(0,t.encodingLength),S:e.slice(t.encodingLength)}),a(e.R&&e.S,"Signature without R or S"),t.isPoint(e.R)&&(this._R=e.R),e.S instanceof i&&(this._S=e.S),this._Rencoded=Array.isArray(e.R)?e.R:e.Rencoded,this._Sencoded=Array.isArray(e.S)?e.S:e.Sencoded}s(u,"S",(function(){return this.eddsa.decodeInt(this.Sencoded())})),s(u,"R",(function(){return this.eddsa.decodePoint(this.Rencoded())})),s(u,"Rencoded",(function(){return this.eddsa.encodePoint(this.R())})),s(u,"Sencoded",(function(){return this.eddsa.encodeInt(this.S())})),u.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},u.prototype.toHex=function(){return o.encode(this.toBytes(),"hex").toUpperCase()},t.exports=u},function(t,e,n){"use strict";var r=n(293);e.certificate=n(781);var i=r.define("RSAPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())}));e.RSAPrivateKey=i;var o=r.define("RSAPublicKey",(function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())}));e.RSAPublicKey=o;var a=r.define("SubjectPublicKeyInfo",(function(){this.seq().obj(this.key("algorithm").use(s),this.key("subjectPublicKey").bitstr())}));e.PublicKey=a;var s=r.define("AlgorithmIdentifier",(function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())})),c=r.define("PrivateKeyInfo",(function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(s),this.key("subjectPrivateKey").octstr())}));e.PrivateKey=c;var u=r.define("EncryptedPrivateKeyInfo",(function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())}));e.EncryptedPrivateKey=u;var l=r.define("DSAPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())}));e.DSAPrivateKey=l,e.DSAparam=r.define("DSAparam",(function(){this.int()}));var h=r.define("ECPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(f),this.key("publicKey").optional().explicit(1).bitstr())}));e.ECPrivateKey=h;var f=r.define("ECParameters",(function(){this.choice({namedCurve:this.objid()})}));e.signature=r.define("signature",(function(){this.seq().obj(this.key("r").int(),this.key("s").int())}))},function(t,e,n){var r=n(293),i=n(37);function o(t,e){this.name=t,this.body=e,this.decoders={},this.encoders={}}e.define=function(t,e){return new o(t,e)},o.prototype._createNamed=function(t){var e;try{e=n(773).runInThisContext("(function "+this.name+"(entity) {\n  this._initNamed(entity);\n})")}catch(t){e=function(t){this._initNamed(t)}}return i(e,t),e.prototype._initNamed=function(e){t.call(this,e)},new e(this)},o.prototype._getDecoder=function(t){return t=t||"der",this.decoders.hasOwnProperty(t)||(this.decoders[t]=this._createNamed(r.decoders[t])),this.decoders[t]},o.prototype.decode=function(t,e,n){return this._getDecoder(e).decode(t,n)},o.prototype._getEncoder=function(t){return t=t||"der",this.encoders.hasOwnProperty(t)||(this.encoders[t]=this._createNamed(r.encoders[t])),this.encoders[t]},o.prototype.encode=function(t,e,n){return this._getEncoder(e).encode(t,n)}},function(module,exports){function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var indexOf=function(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1},Object_keys=function(t){if(Object.keys)return Object.keys(t);var e=[];for(var n in t)e.push(n);return e},forEach=function(t,e){if(t.forEach)return t.forEach(e);for(var n=0;n<t.length;n++)e(t[n],n,t)},defineProp=function(){try{return Object.defineProperty({},"_",{}),function(t,e,n){Object.defineProperty(t,e,{writable:!0,enumerable:!1,configurable:!0,value:n})}}catch(t){return function(t,e,n){t[e]=n}}}(),globals=["Array","Boolean","Date","Error","EvalError","Function","Infinity","JSON","Math","NaN","Number","Object","RangeError","ReferenceError","RegExp","String","SyntaxError","TypeError","URIError","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","eval","isFinite","isNaN","parseFloat","parseInt","undefined","unescape"];function Context(){}Context.prototype={};var Script=exports.Script=function(t){if(!(this instanceof Script))return new Script(t);this.code=t};Script.prototype.runInContext=function(t){if(!(t instanceof Context))throw new TypeError("needs a 'context' argument.");var e=document.createElement("iframe");e.style||(e.style={}),e.style.display="none",document.body.appendChild(e);var n=e.contentWindow,r=n.eval,i=n.execScript;!r&&i&&(i.call(n,"null"),r=n.eval),forEach(Object_keys(t),(function(e){n[e]=t[e]})),forEach(globals,(function(e){t[e]&&(n[e]=t[e])}));var o=Object_keys(n),a=r.call(n,this.code);return forEach(Object_keys(n),(function(e){(e in t||-1===indexOf(o,e))&&(t[e]=n[e])})),forEach(globals,(function(e){e in t||defineProp(t,e,n[e])})),document.body.removeChild(e),a},Script.prototype.runInThisContext=function(){return eval(this.code)},Script.prototype.runInNewContext=function(t){var e=Script.createContext(t),n=this.runInContext(e);return t&&forEach(Object_keys(e),(function(n){t[n]=e[n]})),n},forEach(Object_keys(Script.prototype),(function(t){exports[t]=Script[t]=function(e){var n=Script(e);return n[t].apply(n,[].slice.call(arguments,1))}})),exports.isContext=function(t){return t instanceof Context},exports.createScript=function(t){return exports.Script(t)},exports.createContext=Script.createContext=function(t){var e=new Context;return"object"===_typeof(t)&&forEach(Object_keys(t),(function(n){e[n]=t[n]})),e}},function(t,e,n){var r=n(37);function i(t){this._reporterState={obj:null,path:[],options:t||{},errors:[]}}function o(t,e){this.path=t,this.rethrow(e)}e.Reporter=i,i.prototype.isError=function(t){return t instanceof o},i.prototype.save=function(){var t=this._reporterState;return{obj:t.obj,pathLen:t.path.length}},i.prototype.restore=function(t){var e=this._reporterState;e.obj=t.obj,e.path=e.path.slice(0,t.pathLen)},i.prototype.enterKey=function(t){return this._reporterState.path.push(t)},i.prototype.exitKey=function(t){var e=this._reporterState;e.path=e.path.slice(0,t-1)},i.prototype.leaveKey=function(t,e,n){var r=this._reporterState;this.exitKey(t),null!==r.obj&&(r.obj[e]=n)},i.prototype.path=function(){return this._reporterState.path.join("/")},i.prototype.enterObject=function(){var t=this._reporterState,e=t.obj;return t.obj={},e},i.prototype.leaveObject=function(t){var e=this._reporterState,n=e.obj;return e.obj=t,n},i.prototype.error=function(t){var e,n=this._reporterState,r=t instanceof o;if(e=r?t:new o(n.path.map((function(t){return"["+JSON.stringify(t)+"]"})).join(""),t.message||t,t.stack),!n.options.partial)throw e;return r||n.errors.push(e),e},i.prototype.wrapResult=function(t){var e=this._reporterState;return e.options.partial?{result:this.isError(t)?null:t,errors:e.errors}:t},r(o,Error),o.prototype.rethrow=function(t){if(this.message=t+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,o),!this.stack)try{throw new Error(this.message)}catch(t){this.stack=t.stack}return this}},function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(294).Reporter,o=n(294).EncoderBuffer,a=n(294).DecoderBuffer,s=n(145),c=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],u=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(c);function l(t,e){var n={};this._baseState=n,n.enc=t,n.parent=e||null,n.children=null,n.tag=null,n.args=null,n.reverseArgs=null,n.choice=null,n.optional=!1,n.any=!1,n.obj=!1,n.use=null,n.useDecoder=null,n.key=null,n.default=null,n.explicit=null,n.implicit=null,n.contains=null,n.parent||(n.children=[],this._wrap())}t.exports=l;var h=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];l.prototype.clone=function(){var t=this._baseState,e={};h.forEach((function(n){e[n]=t[n]}));var n=new this.constructor(e.parent);return n._baseState=e,n},l.prototype._wrap=function(){var t=this._baseState;u.forEach((function(e){this[e]=function(){var n=new this.constructor(this);return t.children.push(n),n[e].apply(n,arguments)}}),this)},l.prototype._init=function(t){var e=this._baseState;s(null===e.parent),t.call(this),e.children=e.children.filter((function(t){return t._baseState.parent===this}),this),s.equal(e.children.length,1,"Root node can have only one child")},l.prototype._useArgs=function(t){var e=this._baseState,n=t.filter((function(t){return t instanceof this.constructor}),this);t=t.filter((function(t){return!(t instanceof this.constructor)}),this),0!==n.length&&(s(null===e.children),e.children=n,n.forEach((function(t){t._baseState.parent=this}),this)),0!==t.length&&(s(null===e.args),e.args=t,e.reverseArgs=t.map((function(t){if("object"!==r(t)||t.constructor!==Object)return t;var e={};return Object.keys(t).forEach((function(n){n==(0|n)&&(n|=0);var r=t[n];e[r]=n})),e})))},["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"].forEach((function(t){l.prototype[t]=function(){var e=this._baseState;throw new Error(t+" not implemented for encoding: "+e.enc)}})),c.forEach((function(t){l.prototype[t]=function(){var e=this._baseState,n=Array.prototype.slice.call(arguments);return s(null===e.tag),e.tag=t,this._useArgs(n),this}})),l.prototype.use=function(t){s(t);var e=this._baseState;return s(null===e.use),e.use=t,this},l.prototype.optional=function(){return this._baseState.optional=!0,this},l.prototype.def=function(t){var e=this._baseState;return s(null===e.default),e.default=t,e.optional=!0,this},l.prototype.explicit=function(t){var e=this._baseState;return s(null===e.explicit&&null===e.implicit),e.explicit=t,this},l.prototype.implicit=function(t){var e=this._baseState;return s(null===e.explicit&&null===e.implicit),e.implicit=t,this},l.prototype.obj=function(){var t=this._baseState,e=Array.prototype.slice.call(arguments);return t.obj=!0,0!==e.length&&this._useArgs(e),this},l.prototype.key=function(t){var e=this._baseState;return s(null===e.key),e.key=t,this},l.prototype.any=function(){return this._baseState.any=!0,this},l.prototype.choice=function(t){var e=this._baseState;return s(null===e.choice),e.choice=t,this._useArgs(Object.keys(t).map((function(e){return t[e]}))),this},l.prototype.contains=function(t){var e=this._baseState;return s(null===e.use),e.contains=t,this},l.prototype._decode=function(t,e){var n=this._baseState;if(null===n.parent)return t.wrapResult(n.children[0]._decode(t,e));var r,i=n.default,o=!0,s=null;if(null!==n.key&&(s=t.enterKey(n.key)),n.optional){var c=null;if(null!==n.explicit?c=n.explicit:null!==n.implicit?c=n.implicit:null!==n.tag&&(c=n.tag),null!==c||n.any){if(o=this._peekTag(t,c,n.any),t.isError(o))return o}else{var u=t.save();try{null===n.choice?this._decodeGeneric(n.tag,t,e):this._decodeChoice(t,e),o=!0}catch(t){o=!1}t.restore(u)}}if(n.obj&&o&&(r=t.enterObject()),o){if(null!==n.explicit){var l=this._decodeTag(t,n.explicit);if(t.isError(l))return l;t=l}var h=t.offset;if(null===n.use&&null===n.choice){if(n.any)u=t.save();var f=this._decodeTag(t,null!==n.implicit?n.implicit:n.tag,n.any);if(t.isError(f))return f;n.any?i=t.raw(u):t=f}if(e&&e.track&&null!==n.tag&&e.track(t.path(),h,t.length,"tagged"),e&&e.track&&null!==n.tag&&e.track(t.path(),t.offset,t.length,"content"),i=n.any?i:null===n.choice?this._decodeGeneric(n.tag,t,e):this._decodeChoice(t,e),t.isError(i))return i;if(n.any||null!==n.choice||null===n.children||n.children.forEach((function(n){n._decode(t,e)})),n.contains&&("octstr"===n.tag||"bitstr"===n.tag)){var p=new a(i);i=this._getUse(n.contains,t._reporterState.obj)._decode(p,e)}}return n.obj&&o&&(i=t.leaveObject(r)),null===n.key||null===i&&!0!==o?null!==s&&t.exitKey(s):t.leaveKey(s,n.key,i),i},l.prototype._decodeGeneric=function(t,e,n){var r=this._baseState;return"seq"===t||"set"===t?null:"seqof"===t||"setof"===t?this._decodeList(e,t,r.args[0],n):/str$/.test(t)?this._decodeStr(e,t,n):"objid"===t&&r.args?this._decodeObjid(e,r.args[0],r.args[1],n):"objid"===t?this._decodeObjid(e,null,null,n):"gentime"===t||"utctime"===t?this._decodeTime(e,t,n):"null_"===t?this._decodeNull(e,n):"bool"===t?this._decodeBool(e,n):"objDesc"===t?this._decodeStr(e,t,n):"int"===t||"enum"===t?this._decodeInt(e,r.args&&r.args[0],n):null!==r.use?this._getUse(r.use,e._reporterState.obj)._decode(e,n):e.error("unknown tag: "+t)},l.prototype._getUse=function(t,e){var n=this._baseState;return n.useDecoder=this._use(t,e),s(null===n.useDecoder._baseState.parent),n.useDecoder=n.useDecoder._baseState.children[0],n.implicit!==n.useDecoder._baseState.implicit&&(n.useDecoder=n.useDecoder.clone(),n.useDecoder._baseState.implicit=n.implicit),n.useDecoder},l.prototype._decodeChoice=function(t,e){var n=this._baseState,r=null,i=!1;return Object.keys(n.choice).some((function(o){var a=t.save(),s=n.choice[o];try{var c=s._decode(t,e);if(t.isError(c))return!1;r={type:o,value:c},i=!0}catch(e){return t.restore(a),!1}return!0}),this),i?r:t.error("Choice not matched")},l.prototype._createEncoderBuffer=function(t){return new o(t,this.reporter)},l.prototype._encode=function(t,e,n){var r=this._baseState;if(null===r.default||r.default!==t){var i=this._encodeValue(t,e,n);if(void 0!==i&&!this._skipDefault(i,e,n))return i}},l.prototype._encodeValue=function(t,e,n){var o=this._baseState;if(null===o.parent)return o.children[0]._encode(t,e||new i);var a=null;if(this.reporter=e,o.optional&&void 0===t){if(null===o.default)return;t=o.default}var s=null,c=!1;if(o.any)a=this._createEncoderBuffer(t);else if(o.choice)a=this._encodeChoice(t,e);else if(o.contains)s=this._getUse(o.contains,n)._encode(t,e),c=!0;else if(o.children)s=o.children.map((function(n){if("null_"===n._baseState.tag)return n._encode(null,e,t);if(null===n._baseState.key)return e.error("Child should have a key");var i=e.enterKey(n._baseState.key);if("object"!==r(t))return e.error("Child expected, but input is not object");var o=n._encode(t[n._baseState.key],e,t);return e.leaveKey(i),o}),this).filter((function(t){return t})),s=this._createEncoderBuffer(s);else if("seqof"===o.tag||"setof"===o.tag){if(!o.args||1!==o.args.length)return e.error("Too many args for : "+o.tag);if(!Array.isArray(t))return e.error("seqof/setof, but data is not Array");var u=this.clone();u._baseState.implicit=null,s=this._createEncoderBuffer(t.map((function(n){var r=this._baseState;return this._getUse(r.args[0],t)._encode(n,e)}),u))}else null!==o.use?a=this._getUse(o.use,n)._encode(t,e):(s=this._encodePrimitive(o.tag,t),c=!0);if(!o.any&&null===o.choice){var l=null!==o.implicit?o.implicit:o.tag,h=null===o.implicit?"universal":"context";null===l?null===o.use&&e.error("Tag could be omitted only for .use()"):null===o.use&&(a=this._encodeComposite(l,c,h,s))}return null!==o.explicit&&(a=this._encodeComposite(o.explicit,!1,"context",a)),a},l.prototype._encodeChoice=function(t,e){var n=this._baseState,r=n.choice[t.type];return r||s(!1,t.type+" not found in "+JSON.stringify(Object.keys(n.choice))),r._encode(t.value,e)},l.prototype._encodePrimitive=function(t,e){var n=this._baseState;if(/str$/.test(t))return this._encodeStr(e,t);if("objid"===t&&n.args)return this._encodeObjid(e,n.reverseArgs[0],n.args[1]);if("objid"===t)return this._encodeObjid(e,null,null);if("gentime"===t||"utctime"===t)return this._encodeTime(e,t);if("null_"===t)return this._encodeNull();if("int"===t||"enum"===t)return this._encodeInt(e,n.args&&n.reverseArgs[0]);if("bool"===t)return this._encodeBool(e);if("objDesc"===t)return this._encodeStr(e,t);throw new Error("Unsupported tag: "+t)},l.prototype._isNumstr=function(t){return/^[0-9 ]*$/.test(t)},l.prototype._isPrintstr=function(t){return/^[A-Za-z0-9 '\(\)\+,\-\.\/:=\?]*$/.test(t)}},function(t,e,n){var r=n(528);e.tagClass={0:"universal",1:"application",2:"context",3:"private"},e.tagClassByName=r._reverse(e.tagClass),e.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},e.tagByName=r._reverse(e.tag)},function(t,e,n){var r=e;r.der=n(529),r.pem=n(778)},function(t,e,n){var r=n(37),i=n(59).Buffer,o=n(529);function a(t){o.call(this,t),this.enc="pem"}r(a,o),t.exports=a,a.prototype.decode=function(t,e){for(var n=t.toString().split(/[\r\n]+/g),r=e.label.toUpperCase(),a=/^-----(BEGIN|END) ([^-]+)-----$/,s=-1,c=-1,u=0;u<n.length;u++){var l=n[u].match(a);if(null!==l&&l[2]===r){if(-1!==s){if("END"!==l[1])break;c=u;break}if("BEGIN"!==l[1])break;s=u}}if(-1===s||-1===c)throw new Error("PEM section not found for: "+r);var h=n.slice(s+1,c).join("");h.replace(/[^a-z0-9\+\/=]+/gi,"");var f=new i(h,"base64");return o.prototype.decode.call(this,f,e)}},function(t,e,n){var r=e;r.der=n(530),r.pem=n(780)},function(t,e,n){var r=n(37),i=n(530);function o(t){i.call(this,t),this.enc="pem"}r(o,i),t.exports=o,o.prototype.encode=function(t,e){for(var n=i.prototype.encode.call(this,t).toString("base64"),r=["-----BEGIN "+e.label+"-----"],o=0;o<n.length;o+=64)r.push(n.slice(o,o+64));return r.push("-----END "+e.label+"-----"),r.join("\n")}},function(t,e,n){"use strict";var r=n(293),i=r.define("Time",(function(){this.choice({utcTime:this.utctime(),generalTime:this.gentime()})})),o=r.define("AttributeTypeValue",(function(){this.seq().obj(this.key("type").objid(),this.key("value").any())})),a=r.define("AlgorithmIdentifier",(function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional())})),s=r.define("SubjectPublicKeyInfo",(function(){this.seq().obj(this.key("algorithm").use(a),this.key("subjectPublicKey").bitstr())})),c=r.define("RelativeDistinguishedName",(function(){this.setof(o)})),u=r.define("RDNSequence",(function(){this.seqof(c)})),l=r.define("Name",(function(){this.choice({rdnSequence:this.use(u)})})),h=r.define("Validity",(function(){this.seq().obj(this.key("notBefore").use(i),this.key("notAfter").use(i))})),f=r.define("Extension",(function(){this.seq().obj(this.key("extnID").objid(),this.key("critical").bool().def(!1),this.key("extnValue").octstr())})),p=r.define("TBSCertificate",(function(){this.seq().obj(this.key("version").explicit(0).int(),this.key("serialNumber").int(),this.key("signature").use(a),this.key("issuer").use(l),this.key("validity").use(h),this.key("subject").use(l),this.key("subjectPublicKeyInfo").use(s),this.key("issuerUniqueID").implicit(1).bitstr().optional(),this.key("subjectUniqueID").implicit(2).bitstr().optional(),this.key("extensions").explicit(3).seqof(f).optional())})),d=r.define("X509Certificate",(function(){this.seq().obj(this.key("tbsCertificate").use(p),this.key("signatureAlgorithm").use(a),this.key("signatureValue").bitstr())}));t.exports=d},function(t){t.exports=JSON.parse('{"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"}')},function(t,e,n){(function(e){var r=/Proc-Type: 4,ENCRYPTED[\n\r]+DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)[\n\r]+([0-9A-z\n\r\+\/\=]+)[\n\r]+/m,i=/^-----BEGIN ((?:.* KEY)|CERTIFICATE)-----/m,o=/^-----BEGIN ((?:.* KEY)|CERTIFICATE)-----([0-9A-z\n\r\+\/\=]+)-----END \1-----$/m,a=n(338),s=n(398);t.exports=function(t,n){var c,u=t.toString(),l=u.match(r);if(l){var h="aes"+l[1],f=new e(l[2],"hex"),p=new e(l[3].replace(/[\r\n]/g,""),"base64"),d=a(n,f.slice(0,8),parseInt(l[1],10)).key,y=[],m=s.createDecipheriv(h,d,f);y.push(m.update(p)),y.push(m.final()),c=e.concat(y)}else{var v=u.match(o);c=new e(v[2].replace(/[\r\n]/g,""),"base64")}return{tag:u.match(i)[1],data:c}}}).call(this,n(59).Buffer)},function(t,e,n){(function(e){var r=n(95),i=n(128).ec,o=n(340),a=n(531);function s(t,e){if(t.cmpn(0)<=0)throw new Error("invalid sig");if(t.cmp(e)>=e)throw new Error("invalid sig")}t.exports=function(t,n,c,u,l){var h=o(c);if("ec"===h.type){if("ecdsa"!==u&&"ecdsa/rsa"!==u)throw new Error("wrong public key type");return function(t,e,n){var r=a[n.data.algorithm.curve.join(".")];if(!r)throw new Error("unknown curve "+n.data.algorithm.curve.join("."));var o=new i(r),s=n.data.subjectPrivateKey.data;return o.verify(e,t,s)}(t,n,h)}if("dsa"===h.type){if("dsa"!==u)throw new Error("wrong public key type");return function(t,e,n){var i=n.data.p,a=n.data.q,c=n.data.g,u=n.data.pub_key,l=o.signature.decode(t,"der"),h=l.s,f=l.r;s(h,a),s(f,a);var p=r.mont(i),d=h.invm(a);return 0===c.toRed(p).redPow(new r(e).mul(d).mod(a)).fromRed().mul(u.toRed(p).redPow(f.mul(d).mod(a)).fromRed()).mod(i).mod(a).cmp(f)}(t,n,h)}if("rsa"!==u&&"ecdsa/rsa"!==u)throw new Error("wrong public key type");n=e.concat([l,n]);for(var f=h.modulus.byteLength(),p=[1],d=0;n.length+p.length+2<f;)p.push(255),d++;p.push(0);for(var y=-1;++y<n.length;)p.push(n[y]);p=new e(p);var m=r.mont(h.modulus);t=(t=new r(t).toRed(m)).redPow(new r(h.publicExponent)),t=new e(t.fromRed().toArray());var v=d<8?1:0;for(f=Math.min(t.length,p.length),t.length!==p.length&&(v=1),y=-1;++y<f;)v|=t[y]^p[y];return 0===v}}).call(this,n(59).Buffer)},function(t,e,n){(function(e){var r=n(128),i=n(95);t.exports=function(t){return new a(t)};var o={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};function a(t){this.curveType=o[t],this.curveType||(this.curveType={name:t}),this.curve=new r.ec(this.curveType.name),this.keys=void 0}function s(t,n,r){Array.isArray(t)||(t=t.toArray());var i=new e(t);if(r&&i.length<r){var o=new e(r-i.length);o.fill(0),i=e.concat([o,i])}return n?i.toString(n):i}o.p224=o.secp224r1,o.p256=o.secp256r1=o.prime256v1,o.p192=o.secp192r1=o.prime192v1,o.p384=o.secp384r1,o.p521=o.secp521r1,a.prototype.generateKeys=function(t,e){return this.keys=this.curve.genKeyPair(),this.getPublicKey(t,e)},a.prototype.computeSecret=function(t,n,r){return n=n||"utf8",e.isBuffer(t)||(t=new e(t,n)),s(this.curve.keyFromPublic(t).getPublic().mul(this.keys.getPrivate()).getX(),r,this.curveType.byteLength)},a.prototype.getPublicKey=function(t,e){var n=this.keys.getPublic("compressed"===e,!0);return"hybrid"===e&&(n[n.length-1]%2?n[0]=7:n[0]=6),s(n,t)},a.prototype.getPrivateKey=function(t){return s(this.keys.getPrivate(),t)},a.prototype.setPublicKey=function(t,n){return n=n||"utf8",e.isBuffer(t)||(t=new e(t,n)),this.keys._importPublic(t),this},a.prototype.setPrivateKey=function(t,n){n=n||"utf8",e.isBuffer(t)||(t=new e(t,n));var r=new i(t);return r=r.toString(16),this.keys=this.curve.genKeyPair(),this.keys._importPrivate(r),this}}).call(this,n(59).Buffer)},function(t,e,n){e.publicEncrypt=n(787),e.privateDecrypt=n(788),e.privateEncrypt=function(t,n){return e.publicEncrypt(t,n,!0)},e.publicDecrypt=function(t,n){return e.privateDecrypt(t,n,!0)}},function(t,e,n){(function(e){var r=n(340),i=n(252),o=n(289),a=n(532),s=n(533),c=n(95),u=n(534),l=n(400);t.exports=function(t,n,h){var f;f=t.padding?t.padding:h?1:4;var p,d=r(t);if(4===f)p=function(t,n){var r=t.modulus.byteLength(),u=n.length,l=o("sha1").update(new e("")).digest(),h=l.length,f=2*h;if(u>r-f-2)throw new Error("message too long");var p=new e(r-u-f-2);p.fill(0);var d=r-h-1,y=i(h),m=s(e.concat([l,p,new e([1]),n],d),a(y,d)),v=s(y,a(m,h));return new c(e.concat([new e([0]),v,m],r))}(d,n);else if(1===f)p=function(t,n,r){var o,a=n.length,s=t.modulus.byteLength();if(a>s-11)throw new Error("message too long");r?(o=new e(s-a-3)).fill(255):o=function(t,n){var r,o=new e(t),a=0,s=i(2*t),c=0;for(;a<t;)c===s.length&&(s=i(2*t),c=0),(r=s[c++])&&(o[a++]=r);return o}(s-a-3);return new c(e.concat([new e([0,r?1:2]),o,new e([0]),n],s))}(d,n,h);else{if(3!==f)throw new Error("unknown padding");if((p=new c(n)).cmp(d.modulus)>=0)throw new Error("data too long for modulus")}return h?l(p,d):u(p,d)}}).call(this,n(59).Buffer)},function(t,e,n){(function(e){var r=n(340),i=n(532),o=n(533),a=n(95),s=n(400),c=n(289),u=n(534);t.exports=function(t,n,l){var h;h=t.padding?t.padding:l?1:4;var f,p=r(t),d=p.modulus.byteLength();if(n.length>d||new a(n).cmp(p.modulus)>=0)throw new Error("decryption error");f=l?u(new a(n),p):s(n,p);var y=new e(d-f.length);if(y.fill(0),f=e.concat([y,f],d),4===h)return function(t,n){t.modulus;var r=t.modulus.byteLength(),a=(n.length,c("sha1").update(new e("")).digest()),s=a.length;if(0!==n[0])throw new Error("decryption error");var u=n.slice(1,s+1),l=n.slice(s+1),h=o(u,i(l,s)),f=o(l,i(h,r-s-1));if(function(t,n){t=new e(t),n=new e(n);var r=0,i=t.length;t.length!==n.length&&(r++,i=Math.min(t.length,n.length));var o=-1;for(;++o<i;)r+=t[o]^n[o];return r}(a,f.slice(0,s)))throw new Error("decryption error");var p=s;for(;0===f[p];)p++;if(1!==f[p++])throw new Error("decryption error");return f.slice(p)}(p,f);if(1===h)return function(t,e,n){var r=e.slice(0,2),i=2,o=0;for(;0!==e[i++];)if(i>=e.length){o++;break}var a=e.slice(2,i-1);e.slice(i-1,i);("0002"!==r.toString("hex")&&!n||"0001"!==r.toString("hex")&&n)&&o++;a.length<8&&o++;if(o)throw new Error("decryption error");return e.slice(i)}(0,f,l);if(3===h)return f;throw new Error("unknown padding")}}).call(this,n(59).Buffer)},function(t,e,n){"use strict";(function(t,r){function i(){throw new Error("secure random number generation not supported by this browser\nuse chrome, FireFox or Internet Explorer 11")}var o=n(228),a=n(252),s=o.Buffer,c=o.kMaxLength,u=t.crypto||t.msCrypto,l=Math.pow(2,32)-1;function h(t,e){if("number"!=typeof t||t!=t)throw new TypeError("offset must be a number");if(t>l||t<0)throw new TypeError("offset must be a uint32");if(t>c||t>e)throw new RangeError("offset out of range")}function f(t,e,n){if("number"!=typeof t||t!=t)throw new TypeError("size must be a number");if(t>l||t<0)throw new TypeError("size must be a uint32");if(t+e>n||t>c)throw new RangeError("buffer too small")}function p(t,e,n,i){if(r.browser){var o=t.buffer,s=new Uint8Array(o,e,n);return u.getRandomValues(s),i?void r.nextTick((function(){i(null,t)})):t}if(!i)return a(n).copy(t,e),t;a(n,(function(n,r){if(n)return i(n);r.copy(t,e),i(null,t)}))}u&&u.getRandomValues||!r.browser?(e.randomFill=function(e,n,r,i){if(!(s.isBuffer(e)||e instanceof t.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');if("function"==typeof n)i=n,n=0,r=e.length;else if("function"==typeof r)i=r,r=e.length-n;else if("function"!=typeof i)throw new TypeError('"cb" argument must be a function');return h(n,e.length),f(r,n,e.length),p(e,n,r,i)},e.randomFillSync=function(e,n,r){void 0===n&&(n=0);if(!(s.isBuffer(e)||e instanceof t.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');h(n,e.length),void 0===r&&(r=e.length-n);return f(r,n,e.length),p(e,n,r)}):(e.randomFill=i,e.randomFillSync=i)}).call(this,n(144),n(169))},function(t,e,n){(function(t,r){var i;function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(a){var s="object"==o(e)&&e&&!e.nodeType&&e,c="object"==o(t)&&t&&!t.nodeType&&t,u="object"==(void 0===r?"undefined":o(r))&&r;u.global!==u&&u.window!==u&&u.self!==u||(a=u);var l,h,f=2147483647,p=/^xn--/,d=/[^\x20-\x7E]/,y=/[\x2E\u3002\uFF0E\uFF61]/g,m={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},v=Math.floor,g=String.fromCharCode;function b(t){throw RangeError(m[t])}function w(t,e){for(var n=t.length,r=[];n--;)r[n]=e(t[n]);return r}function _(t,e){var n=t.split("@"),r="";return n.length>1&&(r=n[0]+"@",t=n[1]),r+w((t=t.replace(y,".")).split("."),e).join(".")}function x(t){for(var e,n,r=[],i=0,o=t.length;i<o;)(e=t.charCodeAt(i++))>=55296&&e<=56319&&i<o?56320==(64512&(n=t.charCodeAt(i++)))?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),i--):r.push(e);return r}function S(t){return w(t,(function(t){var e="";return t>65535&&(e+=g((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+=g(t)})).join("")}function T(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function M(t,e,n){var r=0;for(t=n?v(t/700):t>>1,t+=v(t/e);t>455;r+=36)t=v(t/35);return v(r+36*t/(t+38))}function E(t){var e,n,r,i,o,a,s,c,u,l,h,p=[],d=t.length,y=0,m=128,g=72;for((n=t.lastIndexOf("-"))<0&&(n=0),r=0;r<n;++r)t.charCodeAt(r)>=128&&b("not-basic"),p.push(t.charCodeAt(r));for(i=n>0?n+1:0;i<d;){for(o=y,a=1,s=36;i>=d&&b("invalid-input"),((c=(h=t.charCodeAt(i++))-48<10?h-22:h-65<26?h-65:h-97<26?h-97:36)>=36||c>v((f-y)/a))&&b("overflow"),y+=c*a,!(c<(u=s<=g?1:s>=g+26?26:s-g));s+=36)a>v(f/(l=36-u))&&b("overflow"),a*=l;g=M(y-o,e=p.length+1,0==o),v(y/e)>f-m&&b("overflow"),m+=v(y/e),y%=e,p.splice(y++,0,m)}return S(p)}function P(t){var e,n,r,i,o,a,s,c,u,l,h,p,d,y,m,w=[];for(p=(t=x(t)).length,e=128,n=0,o=72,a=0;a<p;++a)(h=t[a])<128&&w.push(g(h));for(r=i=w.length,i&&w.push("-");r<p;){for(s=f,a=0;a<p;++a)(h=t[a])>=e&&h<s&&(s=h);for(s-e>v((f-n)/(d=r+1))&&b("overflow"),n+=(s-e)*d,e=s,a=0;a<p;++a)if((h=t[a])<e&&++n>f&&b("overflow"),h==e){for(c=n,u=36;!(c<(l=u<=o?1:u>=o+26?26:u-o));u+=36)m=c-l,y=36-l,w.push(g(T(l+m%y,0))),c=v(m/y);w.push(g(T(c,0))),o=M(n,d,r==i),n=0,++r}++n,++e}return w.join("")}if(l={version:"1.3.2",ucs2:{decode:x,encode:S},decode:E,encode:P,toASCII:function(t){return _(t,(function(t){return d.test(t)?"xn--"+P(t):t}))},toUnicode:function(t){return _(t,(function(t){return p.test(t)?E(t.slice(4).toLowerCase()):t}))}},"object"==o(n(341))&&n(341))void 0===(i=function(){return l}.call(e,n,e,t))||(t.exports=i);else if(s&&c)if(t.exports==s)c.exports=l;else for(h in l)l.hasOwnProperty(h)&&(s[h]=l[h]);else a.punycode=l}(this)}).call(this,n(375)(t),n(144))},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}t.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"===r(t)&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},function(t,e,n){"use strict";e.decode=e.parse=n(793),e.encode=e.stringify=n(794)},function(t,e,n){"use strict";function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,n,o){e=e||"&",n=n||"=";var a={};if("string"!=typeof t||0===t.length)return a;var s=/\+/g;t=t.split(e);var c=1e3;o&&"number"==typeof o.maxKeys&&(c=o.maxKeys);var u=t.length;c>0&&u>c&&(u=c);for(var l=0;l<u;++l){var h,f,p,d,y=t[l].replace(s,"%20"),m=y.indexOf(n);m>=0?(h=y.substr(0,m),f=y.substr(m+1)):(h=y,f=""),p=decodeURIComponent(h),d=decodeURIComponent(f),r(a,p)?i(a[p])?a[p].push(d):a[p]=[a[p],d]:a[p]=d}return a};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=function(t){switch(r(t)){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,e,n,c){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"===r(t)?a(s(t),(function(r){var s=encodeURIComponent(i(r))+n;return o(t[r])?a(t[r],(function(t){return s+encodeURIComponent(i(t))})).join(e):s+encodeURIComponent(i(t[r]))})).join(e):c?encodeURIComponent(i(c))+n+encodeURIComponent(i(t)):""};var o=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function a(t,e){if(t.map)return t.map(e);for(var n=[],r=0;r<t.length;r++)n.push(e(t[r],r));return n}var s=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}},function(t,e){t.exports="varying vec3 vWorldPos;\nvoid main() {\n  vWorldPos = vec3(-position.x, -position.y, position.z);\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}"},function(t,e){t.exports="varying vec3 vWorldPos;\nuniform float alpha;\nuniform samplerCube tDiffuse;\nvoid main() {\n  vec4 texColor = textureCube(tDiffuse, vWorldPos);\n  gl_FragColor = vec4(texColor.rgb, texColor.a * alpha);\n}"},function(t,e){t.exports="varying vec2 vUv;\nuniform float alpha;\nuniform sampler2D tDiffuse;\nvoid main() {\n  vec4 texColor = texture2D(tDiffuse, vUv);\n  gl_FragColor = vec4(texColor.rgb, texColor.a * alpha);\n}"},function(t,e){t.exports="void main() {\n  gl_Position = vec4(position, 1.0);\n}\n"},function(t,e){t.exports="uniform vec3 color;\nuniform float opacity;\nvoid main() {\n  gl_FragColor = vec4(color, opacity);\n}"},function(t,e,n){t.exports=n.p+"images/outlineBasic1024.png"},function(t,e,n){t.exports=n.p+"images/outlineBasic2048.png"},function(t,e,n){t.exports=n.p+"images/outlineBasic4096.png"},function(t,e,n){t.exports=n.p+"images/outlineEnhanced1024.png"},function(t,e,n){t.exports=n.p+"images/outlineEnhanced2048.png"},function(t,e,n){t.exports=n.p+"images/outlineEnhanced4096.png"},function(t,e,n){},,function(t,e,n){var r=n(809),i=n(810),o=n(811),a=["x","e","a","o","n","s","r","c","u","m","v","w","z"],s=["m","w"],c=["H","I","N","E","F","K","L","T","U","V","W","X","Y","Z"],u="\t".charCodeAt(0),l=" ".charCodeAt(0);function h(t){this.glyphs=[],this._measure=this.computeMetrics.bind(this),this.update(t)}function f(t){return new Function(["return function "+t+"() {","  return this._"+t,"}"].join("\n"))()}function p(t,e){if(!t.chars||0===t.chars.length)return null;var n=y(t.chars,e);return n>=0?t.chars[n]:null}function d(t,e,n){if(!t.kernings||0===t.kernings.length)return 0;for(var r=t.kernings,i=0;i<r.length;i++){var o=r[i];if(o.first===e&&o.second===n)return o.amount}return 0}function y(t,e,n){for(var r=n=n||0;r<t.length;r++)if(t[r].id===e)return r;return-1}t.exports=function(t){return new h(t)},h.prototype.update=function(t){if(t=i({measure:this._measure},t),this._opt=t,this._opt.tabSize=o(this._opt.tabSize,4),!t.font)throw new Error("must provide a valid bitmap font");var e=this.glyphs,n=t.text||"",s=t.font;this._setupSpaceGlyphs(s);var u=r.lines(n,t),l=t.width||0;e.length=0;var h=u.reduce((function(t,e){return Math.max(t,e.width,l)}),0),f=0,p=0,m=o(t.lineHeight,s.common.lineHeight),v=s.common.base,g=m-v,b=t.letterSpacing||0,w=m*u.length-g,_=function(t){if("center"===t)return 1;if("right"===t)return 2;return 0}(this._opt.align);p-=w,this._width=h,this._height=w,this._descender=m-v,this._baseline=v,this._xHeight=function(t){for(var e=0;e<a.length;e++){var n=a[e].charCodeAt(0),r=y(t.chars,n);if(r>=0)return t.chars[r].height}return 0}(s),this._capHeight=function(t){for(var e=0;e<c.length;e++){var n=c[e].charCodeAt(0),r=y(t.chars,n);if(r>=0)return t.chars[r].height}return 0}(s),this._lineHeight=m,this._ascender=m-g-this._xHeight;var x=this;u.forEach((function(t,r){for(var i,o=t.start,a=t.end,c=t.width,u=o;u<a;u++){var l=n.charCodeAt(u),y=x.getGlyph(s,l);if(y){i&&(f+=d(s,i.id,y.id));var v=f;1===_?v+=(h-c)/2:2===_&&(v+=h-c),e.push({position:[v,p],data:y,index:u,line:r}),f+=y.xadvance+b,i=y}}p+=m,f=0})),this._linesTotal=u.length},h.prototype._setupSpaceGlyphs=function(t){if(this._fallbackSpaceGlyph=null,this._fallbackTabGlyph=null,t.chars&&0!==t.chars.length){var e=p(t,l)||function(t){for(var e=0;e<s.length;e++){var n=s[e].charCodeAt(0),r=y(t.chars,n);if(r>=0)return t.chars[r]}return 0}(t)||t.chars[0],n=this._opt.tabSize*e.xadvance;this._fallbackSpaceGlyph=e,this._fallbackTabGlyph=i(e,{x:0,y:0,xadvance:n,id:u,xoffset:0,yoffset:0,width:0,height:0})}},h.prototype.getGlyph=function(t,e){var n=p(t,e);return n||(e===u?this._fallbackTabGlyph:e===l?this._fallbackSpaceGlyph:null)},h.prototype.computeMetrics=function(t,e,n,r){var i,o=this._opt.letterSpacing||0,a=this._opt.font,s=0,c=0,u=0;if(!a.chars||0===a.chars.length)return{start:e,end:e,width:0};n=Math.min(t.length,n);for(var l=e;l<n;l++){var h,f=t.charCodeAt(l);if(h=this.getGlyph(a,f)){h.xoffset;var p=(s+=i?d(a,i.id,h.id):0)+h.xadvance+o,y=s+h.width;if(y>=r||p>=r)break;s=p,c=y,i=h}u++}return i&&(c+=i.xoffset),{start:e,end:e+u,width:c}},["width","height","descender","ascender","xHeight","baseline","capHeight","lineHeight"].forEach((function(t){Object.defineProperty(h.prototype,t,{get:f(t),configurable:!0})}))},function(t,e){var n=/\n/,r=/\s/;function i(t,e,n,r){var i=t.indexOf(e,n);return-1===i||i>r?r:i}function o(t){return r.test(t)}function a(t,e,n,r){return{start:e,end:e+Math.min(r,n-e)}}t.exports=function(e,n){return t.exports.lines(e,n).map((function(t){return e.substring(t.start,t.end)})).join("\n")},t.exports.lines=function(t,e){if(0===(e=e||{}).width&&"nowrap"!==e.mode)return[];t=t||"";var r="number"==typeof e.width?e.width:Number.MAX_VALUE,s=Math.max(0,e.start||0),c="number"==typeof e.end?e.end:t.length,u=e.mode,l=e.measure||a;return"pre"===u?function(t,e,r,i,o){for(var a=[],s=r,c=r;c<i&&c<e.length;c++){var u=e.charAt(c),l=n.test(u);if(l||c===i-1){var h=t(e,s,l?c:c+1,o);a.push(h),s=c+1}}return a}(l,t,s,c,r):function(t,e,n,r,a,s){var c=[],u=a;"nowrap"===s&&(u=Number.MAX_VALUE);for(;n<r&&n<e.length;){for(var l=i(e,"\n",n,r);n<l&&o(e.charAt(n));)n++;var h=t(e,n,l,u),f=n+(h.end-h.start),p=f+"\n".length;if(f<l){for(;f>n&&!o(e.charAt(f));)f--;if(f===n)p>n+"\n".length&&p--,f=p;else for(p=f;f>n&&o(e.charAt(f-"\n".length));)f--}if(f>=n){var d=t(e,n,f,u);c.push(d)}n=p}return c}(l,t,s,c,r,u)}},function(t,e){t.exports=function(){for(var t={},e=0;e<arguments.length;e++){var r=arguments[e];for(var i in r)n.call(r,i)&&(t[i]=r[i])}return t};var n=Object.prototype.hasOwnProperty},function(t,e){t.exports=function(t,e){return"number"==typeof t?t:"number"==typeof e?e:0}},function(t,e,n){var r=n(538),i=n(813),o=n(814),a=[0,2,3],s=[2,1,3];t.exports=function(t,e){t&&(i(t)||o(t))||(e=t||{},t=null);for(var n="string"==typeof(e="number"==typeof e?{count:e}:e||{}).type?e.type:"uint16",c="number"==typeof e.count?e.count:1,u=e.start||0,l=!1!==e.clockwise?a:s,h=l[0],f=l[1],p=l[2],d=6*c,y=t||new(r(n))(d),m=0,v=0;m<d;m+=6,v+=4){var g=m+u;y[g+0]=v+0,y[g+1]=v+1,y[g+2]=v+2,y[g+3]=v+h,y[g+4]=v+f,y[g+5]=v+p}return y}},function(t,e){var n=Object.prototype.toString;t.exports=function(t){return t.BYTES_PER_ELEMENT&&"[object ArrayBuffer]"===n.call(t.buffer)||Array.isArray(t)}},function(t,e){function n(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}t.exports=function(t){return null!=t&&(n(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&n(t.slice(0,0))}(t)||!!t._isBuffer)}},function(t,e,n){var r=n(816);function i(t,e,n,i){return e=r(e=e||[],i),(t=new THREE.BufferAttribute(e,n)).itemSize=n,t.needsUpdate=!0,t}t.exports.attr=function(t,e,n,r,o){"number"!=typeof r&&(r=3);"string"!=typeof o&&(o="float32");if(Array.isArray(n)&&Array.isArray(n[0])&&n[0].length!==r)throw new Error("Nested vertex array has unexpected size; expected "+r+" but found "+n[0].length);var a=i(t.getAttribute(e),n,r,o);t.setAttribute(e,a)},t.exports.index=function(t,e,n,r){"number"!=typeof n&&(n=1);"string"!=typeof r&&(r="uint16");var o=!t.index&&"function"!=typeof t.setIndex,a=i(o?t.getAttribute("index"):t.index,e,n,r);a&&(o?t.addAttribute("index",a):t.index=a)}},function(t,e,n){var r=n(538);t.exports=function(t,e,n){if(!t)throw new TypeError("must specify data as first parameter");if(n=0|+(n||0),Array.isArray(t)&&t[0]&&"number"==typeof t[0][0]){var i,o,a,s,c=t[0].length,u=t.length*c;e&&"string"!=typeof e||(e=new(r(e||"float32"))(u+n));var l=e.length-n;if(u!==l)throw new Error("source length "+u+" ("+c+"x"+t.length+") does not match destination length "+l);for(i=0,a=n;i<t.length;i++)for(o=0;o<c;o++)e[a++]=null===t[i][o]?NaN:t[i][o]}else if(e&&"string"!=typeof e)e.set(t,n);else{var h=r(e||"float32");if(Array.isArray(t)||"array"===e)for(e=new h(t.length+n),i=0,a=n,s=e.length;a<s;a++,i++)e[a]=null===t[i]?NaN:t[i];else 0===n?e=new h(t):(e=new h(t.length+n)).set(t,n)}return e}},function(t,e){t.exports.pages=function(t){var e=new Float32Array(4*t.length*1),n=0;return t.forEach((function(t){var r=t.data.page||0;e[n++]=r,e[n++]=r,e[n++]=r,e[n++]=r})),e},t.exports.uvs=function(t,e,n,r){var i=new Float32Array(4*t.length*2),o=0;return t.forEach((function(t){var a=t.data,s=a.x+a.width,c=a.y+a.height,u=a.x/e,l=a.y/n,h=s/e,f=c/n;r&&(l=(n-a.y)/n,f=(n-c)/n),i[o++]=u,i[o++]=l,i[o++]=u,i[o++]=f,i[o++]=h,i[o++]=f,i[o++]=h,i[o++]=l})),i},t.exports.positions=function(t){var e=new Float32Array(4*t.length*2),n=0;return t.forEach((function(t){var r=t.data,i=t.position[0]+r.xoffset,o=t.position[1]+r.yoffset,a=r.width,s=r.height;e[n++]=i,e[n++]=o,e[n++]=i,e[n++]=o+s,e[n++]=i+a,e[n++]=o+s,e[n++]=i+a,e[n++]=o})),e}},function(t,e){var n={min:[0,0],max:[0,0]};function r(t){var e=t.length/2;n.min[0]=t[0],n.min[1]=t[1],n.max[0]=t[0],n.max[1]=t[1];for(var r=0;r<e;r++){var i=t[2*r+0],o=t[2*r+1];n.min[0]=Math.min(i,n.min[0]),n.min[1]=Math.min(o,n.min[1]),n.max[0]=Math.max(i,n.max[0]),n.max[1]=Math.max(o,n.max[1])}}t.exports.computeBox=function(t,e){r(t),e.min.set(n.min[0],n.min[1],0),e.max.set(n.max[0],n.max[1],0)},t.exports.computeSphere=function(t,e){r(t);var i=n.min[0],o=n.min[1],a=n.max[0]-i,s=n.max[1]-o,c=Math.sqrt(a*a+s*s);e.center.set(i+a/2,o+s/2,0),e.radius=c/2}},function(t,e){t.exports="uniform float opacity;\nuniform vec3 color;\nuniform sampler2D bg;\n\nvarying vec2 vUv;\n\nvoid main() {\n  vec4 bgColor = texture2D(bg, vUv);\n  gl_FragColor = vec4(bgColor.rgb, bgColor.a * opacity);\n}\n"},function(t,e){t.exports="#include <common>\n\nuniform float linewidth;\nuniform vec2 resolution;\n\nattribute vec3 instanceStart;\nattribute vec3 instanceEnd;\n\nattribute vec3 instanceColorStart;\nattribute vec3 instanceColorEnd;\n\nvarying vec2 vUv;\n\n#ifdef USE_DASH\n\n  uniform float dashScale;\n  attribute float instanceDistanceStart;\n  attribute float instanceDistanceEnd;\n  varying float vLineDistance;\n\n#endif\n\nvoid trimSegment( const in vec4 start, inout vec4 end ) {\n\n  // trim end segment so it terminates between the camera plane and the near plane\n\n  // conservative estimate of the near plane\n  float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\n  float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\n  float nearEstimate = - 0.5 * b / a;\n\n  float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\n  end.xyz = mix( start.xyz, end.xyz, alpha );\n\n}\n\nvoid main() {\n\n  #ifdef USE_COLOR\n    vColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\n  #endif\n\n  #ifdef USE_DASH\n    vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\n  #endif\n\n  float aspect = resolution.x / resolution.y;\n  vUv = uv;\n\n  // camera space\n  vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\n  vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\n\n  // special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n  // clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n  // but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n  // perhaps there is a more elegant solution -- WestLangley\n\n  bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\n\n  if ( perspective ) {\n    if ( start.z < 0.0 && end.z >= 0.0 ) {\n      trimSegment( start, end );\n    } else if ( end.z < 0.0 && start.z >= 0.0 ) {\n      trimSegment( end, start );\n    }\n  }\n\n  // clip space\n  vec4 clipStart = projectionMatrix * start;\n  vec4 clipEnd = projectionMatrix * end;\n\n  // ndc space\n  vec2 ndcStart = clipStart.xy / clipStart.w;\n  vec2 ndcEnd = clipEnd.xy / clipEnd.w;\n\n  // direction\n  vec2 dir = ndcEnd - ndcStart;\n\n  // account for clip-space aspect ratio\n  dir.x *= aspect;\n  dir = normalize( dir );\n\n  // perpendicular to dir\n  vec2 offset = vec2( dir.y, - dir.x );\n\n  // undo aspect ratio adjustment\n  dir.x /= aspect;\n  offset.x /= aspect;\n\n  // sign flip\n  if ( position.x < 0.0 ) offset *= - 1.0;\n\n  // adjust for linewidth\n  offset *= linewidth;\n\n  // adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n  offset /= resolution.y;\n\n  // select end\n  vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\n  // convert back to clip space.\n#ifdef USE_MASK\n  // instead of choosing which clip to use based on position in the line, just merge them together, it helps with\n  // glancing angles while using alpha / uvs. the difference is it still shows some perspective instead of being strictly\n  // pixel width, but it looks better in pretty much all cases except when the line is directly on the view direction\n  // meh. - DB - 10/19\n  offset *= (clipEnd.w + clipStart.w) * 0.5;\n#else\n  // swapping the value works better for no texture though, since it stays a stable width on screen.\n  offset *= clip.w;\n#endif\n\n  clip.xy += offset;\n\n  gl_Position = clip;\n\n  #include <worldpos_vertex>\n\n}"},function(t,e){t.exports="uniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D mask;\n\n#ifdef USE_DASH\n  uniform float dashSize;\n  uniform float gapSize;\n#endif\n\nvarying float vLineDistance;\n\n#include <common>\n\nvarying vec2 vUv;\n\nvoid main() {\n  #ifdef USE_DASH\n    if ( vUv.y < -1.0 || vUv.y > 1.0 ) discard; // TODO (measure) - unused now?\n    if ( mod( vLineDistance, dashSize + gapSize ) > dashSize ) discard;\n  #endif\n\n  // TODO (measure): I don't think this ever even gets run now that uv's are between 0-2\n  // and it wasn't clear wtf it was doing to begin with?\n  //if ( abs( vUv.y ) > 1.0 ) {\n  //  float a = vUv.x;\n  //  float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n  //  float len2 = a * a + b * b;\n  //  if ( len2 > 1.0 ) discard;\n  //}\n\n  #ifdef USE_MASK\n    vec2 modUv = vec2(vUv);\n    modUv *= 2.0;\n    vec4 texelColor = texture2D( mask, modUv );\n    gl_FragColor = vec4( texelColor.rgb, min(texelColor.a, opacity) );\n  #else\n    gl_FragColor = vec4( diffuse, opacity );\n  #endif\n}"},function(t,e,n){"use strict";var r=n(403),i=Object.prototype.toString,o=Object.prototype.hasOwnProperty,a=function(t,e,n){for(var r=0,i=t.length;r<i;r++)o.call(t,r)&&(null==n?e(t[r],r,t):e.call(n,t[r],r,t))},s=function(t,e,n){for(var r=0,i=t.length;r<i;r++)null==n?e(t.charAt(r),r,t):e.call(n,t.charAt(r),r,t)},c=function(t,e,n){for(var r in t)o.call(t,r)&&(null==n?e(t[r],r,t):e.call(n,t[r],r,t))};t.exports=function(t,e,n){if(!r(e))throw new TypeError("iterator must be a function");var o;arguments.length>=3&&(o=n),"[object Array]"===i.call(t)?a(t,e,o):"string"==typeof t?s(t,e,o):c(t,e,o)}},function(t,e,n){"use strict";var r=function(){};t.exports=r},function(t,e,n){"use strict";var r=n(342);t.exports=r.call(Function.call,Object.prototype.hasOwnProperty)},function(t,e,n){"use strict";var r="Function.prototype.bind called on incompatible ",i=Array.prototype.slice,o=Object.prototype.toString;t.exports=function(t){var e=this;if("function"!=typeof e||"[object Function]"!==o.call(e))throw new TypeError(r+e);for(var n,a=i.call(arguments,1),s=function(){if(this instanceof n){var r=e.apply(this,a.concat(i.call(arguments)));return Object(r)===r?r:this}return e.apply(t,a.concat(i.call(arguments)))},c=Math.max(0,e.length-a.length),u=[],l=0;l<c;l++)u.push("$"+l);if(n=Function("binder","return function ("+u.join(",")+"){ return binder.apply(this,arguments); }")(s),e.prototype){var h=function(){};h.prototype=e.prototype,n.prototype=new h,h.prototype=null}return n}},function(t,e,n){"use strict";var r=n(342),i=n(541),o=n(542),a=n(543),s=n(838),c=r.call(Function.call,a());i(c,{getPolyfill:a,implementation:o,shim:s}),t.exports=c},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=Object.prototype.hasOwnProperty,o=Object.prototype.toString,a=Array.prototype.slice,s=n(828),c=Object.prototype.propertyIsEnumerable,u=!c.call({toString:null},"toString"),l=c.call((function(){}),"prototype"),h=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],f=function(t){var e=t.constructor;return e&&e.prototype===t},p={$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},d=function(){if("undefined"==typeof window)return!1;for(var t in window)try{if(!p["$"+t]&&i.call(window,t)&&null!==window[t]&&"object"===r(window[t]))try{f(window[t])}catch(t){return!0}}catch(t){return!0}return!1}(),y=function(t){var e=null!==t&&"object"===r(t),n="[object Function]"===o.call(t),a=s(t),c=e&&"[object String]"===o.call(t),p=[];if(!e&&!n&&!a)throw new TypeError("Object.keys called on a non-object");var y=l&&n;if(c&&t.length>0&&!i.call(t,0))for(var m=0;m<t.length;++m)p.push(String(m));if(a&&t.length>0)for(var v=0;v<t.length;++v)p.push(String(v));else for(var g in t)y&&"prototype"===g||!i.call(t,g)||p.push(String(g));if(u)for(var b=function(t){if("undefined"==typeof window||!d)return f(t);try{return f(t)}catch(t){return!1}}(t),w=0;w<h.length;++w)b&&"constructor"===h[w]||!i.call(t,h[w])||p.push(h[w]);return p};y.shim=function(){if(Object.keys){if(!function(){return 2===(Object.keys(arguments)||"").length}(1,2)){var t=Object.keys;Object.keys=function(e){return s(e)?t(a.call(e)):t(e)}}}else Object.keys=y;return Object.keys||y},t.exports=y},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=Object.prototype.toString;t.exports=function(t){var e=i.call(t),n="[object Arguments]"===e;return n||(n="[object Array]"!==e&&null!==t&&"object"===r(t)&&"number"==typeof t.length&&t.length>=0&&"[object Function]"===i.call(t.callee)),n}},function(t,e){var n=Object.prototype.hasOwnProperty,r=Object.prototype.toString;t.exports=function(t,e,i){if("[object Function]"!==r.call(e))throw new TypeError("iterator must be a function");var o=t.length;if(o===+o)for(var a=0;a<o;a++)e.call(i,t[a],a,t);else for(var s in t)n.call(t,s)&&e.call(i,t[s],s,t)}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(831),o=n(832),a=n(833),s=n(834),c=n(403),u=n(835),l=n(837),h={ToPrimitive:u,ToBoolean:function(t){return!!t},ToNumber:function(t){return Number(t)},ToInteger:function(t){var e=this.ToNumber(t);return i(e)?0:0!==e&&o(e)?a(e)*Math.floor(Math.abs(e)):e},ToInt32:function(t){return this.ToNumber(t)>>0},ToUint32:function(t){return this.ToNumber(t)>>>0},ToUint16:function(t){var e=this.ToNumber(t);if(i(e)||0===e||!o(e))return 0;var n=a(e)*Math.floor(Math.abs(e));return s(n,65536)},ToString:function(t){return String(t)},ToObject:function(t){return this.CheckObjectCoercible(t),Object(t)},CheckObjectCoercible:function(t,e){if(null==t)throw new TypeError(e||"Cannot call method on "+t);return t},IsCallable:c,SameValue:function(t,e){return t===e?0!==t||1/t==1/e:i(t)&&i(e)},Type:function(t){return null===t?"Null":void 0===t?"Undefined":"function"==typeof t||"object"===r(t)?"Object":"number"==typeof t?"Number":"boolean"==typeof t?"Boolean":"string"==typeof t?"String":void 0},IsPropertyDescriptor:function(t){if("Object"!==this.Type(t))return!1;var e={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var n in t)if(l(t,n)&&!e[n])return!1;var r=l(t,"[[Value]]"),i=l(t,"[[Get]]")||l(t,"[[Set]]");if(r&&i)throw new TypeError("Property Descriptors may not be both accessor and data descriptors");return!0},IsAccessorDescriptor:function(t){if(void 0===t)return!1;if(!this.IsPropertyDescriptor(t))throw new TypeError("Desc must be a Property Descriptor");return!(!l(t,"[[Get]]")&&!l(t,"[[Set]]"))},IsDataDescriptor:function(t){if(void 0===t)return!1;if(!this.IsPropertyDescriptor(t))throw new TypeError("Desc must be a Property Descriptor");return!(!l(t,"[[Value]]")&&!l(t,"[[Writable]]"))},IsGenericDescriptor:function(t){if(void 0===t)return!1;if(!this.IsPropertyDescriptor(t))throw new TypeError("Desc must be a Property Descriptor");return!this.IsAccessorDescriptor(t)&&!this.IsDataDescriptor(t)},FromPropertyDescriptor:function(t){if(void 0===t)return t;if(!this.IsPropertyDescriptor(t))throw new TypeError("Desc must be a Property Descriptor");if(this.IsDataDescriptor(t))return{value:t["[[Value]]"],writable:!!t["[[Writable]]"],enumerable:!!t["[[Enumerable]]"],configurable:!!t["[[Configurable]]"]};if(this.IsAccessorDescriptor(t))return{get:t["[[Get]]"],set:t["[[Set]]"],enumerable:!!t["[[Enumerable]]"],configurable:!!t["[[Configurable]]"]};throw new TypeError("FromPropertyDescriptor must be called with a fully populated Property Descriptor")},ToPropertyDescriptor:function(t){if("Object"!==this.Type(t))throw new TypeError("ToPropertyDescriptor requires an object");var e={};if(l(t,"enumerable")&&(e["[[Enumerable]]"]=this.ToBoolean(t.enumerable)),l(t,"configurable")&&(e["[[Configurable]]"]=this.ToBoolean(t.configurable)),l(t,"value")&&(e["[[Value]]"]=t.value),l(t,"writable")&&(e["[[Writable]]"]=this.ToBoolean(t.writable)),l(t,"get")){var n=t.get;if(void 0!==n&&!this.IsCallable(n))throw new TypeError("getter must be a function");e["[[Get]]"]=n}if(l(t,"set")){var r=t.set;if(void 0!==r&&!this.IsCallable(r))throw new TypeError("setter must be a function");e["[[Set]]"]=r}if((l(e,"[[Get]]")||l(e,"[[Set]]"))&&(l(e,"[[Value]]")||l(e,"[[Writable]]")))throw new TypeError("Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");return e}};t.exports=h},function(t,e){t.exports=Number.isNaN||function(t){return t!=t}},function(t,e){var n=Number.isNaN||function(t){return t!=t};t.exports=Number.isFinite||function(t){return"number"==typeof t&&!n(t)&&t!==1/0&&t!==-1/0}},function(t,e){t.exports=function(t){return t>=0?1:-1}},function(t,e){t.exports=function(t,e){var n=t%e;return Math.floor(n>=0?n:n+e)}},function(t,e,n){"use strict";var r=Object.prototype.toString,i=n(836),o=n(403),a=function(t,e){var n=e||("[object Date]"===r.call(t)?String:Number);if(n===String||n===Number){var a,s,c=n===String?["toString","valueOf"]:["valueOf","toString"];for(s=0;s<c.length;++s)if(o(t[c[s]])&&(a=t[c[s]](),i(a)))return a;throw new TypeError("No default value")}throw new TypeError("invalid [[DefaultValue]] hint supplied")};t.exports=function(t,e){return i(t)?t:a(t,e)}},function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}t.exports=function(t){return null===t||"function"!=typeof t&&"object"!==n(t)}},function(t,e,n){var r=n(342);t.exports=r.call(Function.call,Object.prototype.hasOwnProperty)},function(t,e,n){"use strict";var r=n(541),i=n(543);t.exports=function(){var t=i();return r(String.prototype,{trim:t},{trim:function(){return String.prototype.trim!==t}}),t}},function(t,e,n){},,function(t,e,n){},,function(t,e){e.read=function(t,e,n,r,i){var o,a,s=8*i-r-1,c=(1<<s)-1,u=c>>1,l=-7,h=n?i-1:0,f=n?-1:1,p=t[e+h];for(h+=f,o=p&(1<<-l)-1,p>>=-l,l+=s;l>0;o=256*o+t[e+h],h+=f,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;l>0;a=256*a+t[e+h],h+=f,l-=8);if(0===o)o=1-u;else{if(o===c)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,r),o-=u}return(p?-1:1)*a*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var a,s,c,u=8*o-i-1,l=(1<<u)-1,h=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,d=r?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=l):(a=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-a))<1&&(a--,c*=2),(e+=a+h>=1?f/c:f*Math.pow(2,1-h))*c>=2&&(a++,c/=2),a+h>=l?(s=0,a=l):a+h>=1?(s=(e*c-1)*Math.pow(2,i),a+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;t[n+p]=255&s,p+=d,s/=256,i-=8);for(a=a<<i|s,u+=i;u>0;t[n+p]=255&a,p+=d,a/=256,u-=8);t[n+p-d]|=128*y}},function(t,e){t.exports="varying vec3 vWorldPosition;\n\nvoid main() {\n  vWorldPosition = position;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n"},function(t,e){t.exports="uniform samplerCube map;\nuniform float opacity;\n\nvarying vec3 vWorldPosition;\n\nvoid main() {\n  vec4 color = textureCube( map, vec3( -vWorldPosition.x, vWorldPosition.yz ) );\n  gl_FragColor = vec4(color.rgb, opacity);\n}\n"},function(t,e){t.exports="#ifdef PANO_TEXTURE\n  uniform vec3 pano0Position;\n  uniform mat4 pano0Matrix;\n  varying vec3 pano0SweepDirection;\n#endif\n\n#ifdef PANO_TEXTURE_TRANSITION\n  uniform vec3 pano1Position;\n  uniform mat4 pano1Matrix;\n  varying vec3 pano1SweepDirection;\n#endif\n\n#ifdef MESH_PREVIEW_SPHERE\n#endif\n\n#ifdef MESH_TEXTURE\n  varying vec2 vUv;\n  varying vec3 worldPos;\n#endif\n\n#ifdef WIREFRAME\n  attribute vec3 barycentric;\n  varying vec3 vBarycentric;\n#endif\n\n#ifdef FLAT_SHADING\n  varying vec3 vNormal;\n#endif\n\nvoid main() {\n\n  vec4 worldPosition = modelMatrix * vec4(position, 1.0);\n\n  #ifdef MESH_TEXTURE\n    vUv = uv;\n    worldPos = worldPosition.xyz;\n  #endif\n\n  #ifdef WIREFRAME\n    vBarycentric = barycentric;\n  #endif\n\n\n  #ifdef FLAT_SHADING\n    vNormal = normal;\n  #endif\n\n  #ifdef PANO_TEXTURE\n    vec3 positionLocalToPanoCenter0 = worldPosition.xyz - pano0Position;\n    pano0SweepDirection = (pano0Matrix * vec4(positionLocalToPanoCenter0, 1.0)).xyz;\n    pano0SweepDirection.x *= -1.0;\n  #endif\n\n  #ifdef PANO_TEXTURE_TRANSITION\n    vec3 positionLocalToPanoCenter1 = worldPosition.xyz - pano1Position;\n    pano1SweepDirection = (pano1Matrix * vec4(positionLocalToPanoCenter1, 1.0)).xyz;\n    pano1SweepDirection.x *= -1.0;\n  #endif\n\n  vec4 projectedPosition = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\n  gl_Position = projectedPosition;\n\n}\n"},function(t,e){t.exports="#ifdef PANO_TEXTURE\n  uniform vec3 pano0Position;\n  uniform samplerCube pano0Map;\n  varying vec3 pano0SweepDirection;\n  uniform float panoOpacity;\n#endif\n\n#ifdef PANO_TEXTURE_TRANSITION\n  uniform float progress;\n\n  uniform vec3 pano1Position;\n  uniform samplerCube pano1Map;\n  varying vec3 pano1SweepDirection;\n#endif\n\n#ifdef MESH_PREVIEW_SPHERE\n  uniform vec3 meshPreviewCenter;\n  uniform float meshPreviewSize;\n#endif\n\n#ifdef MESH_TEXTURE\n  varying vec2 vUv;\n  uniform sampler2D map;\n  uniform float meshOpacity;\n  uniform float opacity;\n  uniform float transparentDiscardDist;\n  // moved down from preview sphere, in order to use for distance clip\n  varying vec3 worldPos;\n#endif\n\n#ifdef COLOR_OVERLAY\n  uniform vec4 colorOverlay;\n#endif\n\n#ifdef WIREFRAME\n  // Wireframe stuff is based on https://github.com/mattdesl/webgl-wireframes\n  varying vec3 vBarycentric;\n\n  uniform float time;\n  uniform float thickness;\n  uniform float secondThickness;\n\n  uniform float dashRepeats;\n  uniform float dashLength;\n  uniform bool dashOverlap;\n  uniform bool dashEnabled;\n  uniform bool dashAnimate;\n\n  uniform bool fillEnabled;\n  uniform bool insideAltColor;\n  uniform bool dualStroke;\n\n  uniform bool squeeze;\n  uniform float squeezeMin;\n  uniform float squeezeMax;\n  uniform float wireframeOpacity;\n\n  uniform vec3 stroke;\n  uniform vec3 fill;\n\n\n  // This is like\n  float aastep (float threshold, float dist) {\n    float afwidth = fwidth(dist) * 0.5;\n    return smoothstep(threshold - afwidth, threshold + afwidth, dist);\n  }\n\n  // This function is not currently used, but it can be useful\n  // to achieve a fixed width wireframe regardless of z-depth\n  float computeScreenSpaceWireframe (vec3 barycentric, float lineWidth) {\n    vec3 dist = fwidth(barycentric);\n    vec3 smoothed = smoothstep(\n      dist * ((lineWidth * 0.5) - 0.5),\n      dist * ((lineWidth * 0.5) + 0.5),\n      barycentric);\n    return 1.0 - min(min(smoothed.x, smoothed.y), smoothed.z);\n  }\n\n  // This function returns the fragment color for our styled wireframe effect\n  // based on the barycentric coordinates for this fragment\n  vec4 getStyledWireframe (vec3 barycentric) {\n\n    float PI = 3.14159265359;\n\n    // this will be our signed distance for the wireframe edge\n    float d = min(min(barycentric.x, barycentric.y), barycentric.z);\n\n    // for dashed rendering, we can use this to get the 0 .. 1 value of the line length\n    float positionAlong = max(barycentric.x, barycentric.y);\n    if (barycentric.y < barycentric.x && barycentric.y < barycentric.z) {\n      positionAlong = 1.0 - positionAlong;\n    }\n\n    // the thickness of the stroke\n    float computedThickness = thickness;\n\n    // if we want to shrink the thickness toward the center of the line segment\n    if (squeeze) {\n      computedThickness *= mix(squeezeMin, squeezeMax, (1.0 - sin(positionAlong * PI)));\n    }\n\n    // if we should create a dash pattern\n    if (dashEnabled) {\n      // here we offset the stroke position depending on whether it\n      // should overlap or not\n      float offset = 1.0 / dashRepeats * dashLength / 2.0;\n      if (!dashOverlap) {\n        offset += 1.0 / dashRepeats / 2.0;\n      }\n\n      // if we should animate the dash or not\n      if (dashAnimate) {\n        offset += time * 0.22;\n      }\n\n      // create the repeating dash pattern\n      float pattern = fract((positionAlong + offset) * dashRepeats);\n      computedThickness *= 1.0 - aastep(dashLength, pattern);\n    }\n\n    // Compute the anti-aliased stroke edge\n    float edge = computeScreenSpaceWireframe(barycentric, computedThickness);\n    // Replace with the folloing you want world-space thickness instead of screenspace\n    // float edge = 1.0 - aastep(computedThickness, d);\n\n    // now compute the final color of the mesh\n    vec4 outColor = vec4(0.0, 0.0, 0.0, 0.0);\n    if (!fillEnabled) {\n      outColor = vec4(stroke, edge);\n      if (insideAltColor && !gl_FrontFacing) {\n        outColor.rgb = fill;\n      }\n    } else {\n      outColor.a = 1.0;\n      if (dualStroke) {\n        float inner = 1.0 - aastep(secondThickness, d);\n        vec3 wireColor = mix(fill, stroke, abs(inner - edge));\n        outColor.rgb = wireColor;\n      } else {\n        outColor.rgb = mix(fill, stroke, edge);\n      }\n    }\n    outColor.a *= wireframeOpacity;\n    return outColor;\n  }\n#endif\n\n#ifdef FLAT_SHADING\n  varying vec3 vNormal;\n#endif\n\nvoid main() {\n  #ifdef PANO_TEXTURE_TRANSITION\n    vec4 colorFromPano0 = textureCube( pano0Map, pano0SweepDirection.xyz);\n    vec4 colorFromPano1 = textureCube( pano1Map, pano1SweepDirection.xyz);\n    vec4 color = mix(colorFromPano0, colorFromPano1, progress);\n    color.a = panoOpacity;\n  #elif defined(PANO_TEXTURE)\n    vec4 color = textureCube( pano0Map, pano0SweepDirection.xyz);\n    color.a = panoOpacity;\n  #else\n    vec4 color = vec4(0.0, 0.0, 0.0, 0.0);\n  #endif\n\n  #ifdef MESH_TEXTURE\n    vec4 colorFromTexture = texture2D( map, vUv );\n    float depth = distance(cameraPosition, worldPos.xyz);\n    if (opacity < 1.0 && depth < transparentDiscardDist) {\n      discard;\n    }\n  #endif\n\n  #ifdef MESH_PREVIEW_SPHERE\n    // the area within the previewDistance will show the mesh texture\n    float previewDistance = distance(worldPos.xyz, meshPreviewCenter.xyz);\n    float inSphere = step(previewDistance, meshPreviewSize );\n    // 20% brightness bump for in-sphere texture\n    colorFromTexture += colorFromTexture * (0.2 * inSphere);\n\n    color = mix(color, colorFromTexture, max(meshOpacity, inSphere));\n  #elif defined(MESH_TEXTURE)\n    color = mix(color, colorFromTexture, meshOpacity);\n  #endif\n\n  #ifdef FLAT_SHADING\n    float ao = 0.9 - abs(vNormal.y) * 0.1 - abs(vNormal.x) * 0.05 + abs(vNormal.z) * 0.05;\n    color.rgb = vec3(ao, ao * 1.025, ao * 1.05);\n  #endif\n\n  #ifdef COLOR_OVERLAY\n    color = mix(color, vec4(colorOverlay.rgb, 1.0), colorOverlay.a);\n  #endif\n\n  #ifdef WIREFRAME\n    vec4 colorFromWireframe = getStyledWireframe(vBarycentric);\n    color = mix(color, vec4(colorFromWireframe.rgb, 1.0), colorFromWireframe.a);\n  #endif\n\n  #ifdef MESH_TEXTURE\n    color.a = opacity;\n  #endif\n\n  gl_FragColor = color;\n}\n"},function(t,e){t.exports="varying vec2 vUv;\n\nvoid main() {\n\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n}\n"},function(t,e){t.exports="uniform sampler2D map;\nuniform float opacity;\nuniform vec4 colorOverlay;\nvarying vec2 vUv;\n\nvec4 white = vec4(0.8, 0.8, 0.8, 1.0);\nvec4 black = vec4(0.0, 0.0, 0.0, 1.0);\n\nvoid main() {\n\n  vec4 colorFromTexture = texture2D( map, vUv );\n  float whiteness = 1.0 - smoothstep(0.1, 0.2, opacity);\n  colorFromTexture = mix(colorFromTexture, vec4(colorOverlay.rgb, 1.0), colorOverlay.a);\n  colorFromTexture = mix(colorFromTexture, white, whiteness);\n  gl_FragColor = vec4(colorFromTexture.rgb, opacity);\n\n}\n"},function(t,e){t.exports="varying vec3 vWorldPosition;\n\nvoid main() {\n\n  vWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n}\n"},function(t,e){t.exports="uniform vec3 color;\nuniform float opacity;\nuniform float maxDistance;\n\nvarying vec3 vWorldPosition;\n\nvoid main() {\n\n  float distanceToCamera = distance(cameraPosition, vWorldPosition);\n  float distanceBucketed = 1.0 - clamp(distanceToCamera / maxDistance, 0.0, 1.0);\n  // If the floor is ghosted, we don't want to load any texture from it,\n  // and more importantly we don't want it to block the texture beneath the ghosted floor\n  if (opacity < 1.0) {\n    discard;\n  }\n  gl_FragColor = vec4(distanceBucketed, distanceBucketed, distanceBucketed, 1.0);\n\n}\n"},function(t,e,n){"use strict";var r=e.binary_mesh={};r.read=function(t,e){return t.readFields(r._readField,{chunk:[],quantized_chunk:[]},e)},r._readField=function(t,e,n){1===t?e.chunk.push(a.read(n,n.readVarint()+n.pos)):2===t&&e.quantized_chunk.push(l.read(n,n.readVarint()+n.pos))},r.write=function(t,e){if(t.chunk)for(var n=0;n<t.chunk.length;n++)e.writeMessage(1,a.write,t.chunk[n]);if(t.quantized_chunk)for(n=0;n<t.quantized_chunk.length;n++)e.writeMessage(2,l.write,t.quantized_chunk[n])};var i=e.vertices_simple={};i.read=function(t,e){return t.readFields(i._readField,{xyz:[],uv:[]},e)},i._readField=function(t,e,n){1===t?n.readPackedFloat(e.xyz):2===t&&n.readPackedFloat(e.uv)},i.write=function(t,e){t.xyz&&e.writePackedFloat(1,t.xyz),t.uv&&e.writePackedFloat(2,t.uv)};var o=e.faces_simple={};o.read=function(t,e){return t.readFields(o._readField,{faces:[]},e)},o._readField=function(t,e,n){1===t&&n.readPackedVarint(e.faces)},o.write=function(t,e){t.faces&&e.writePackedVarint(1,t.faces)};var a=e.chunk_simple={};a.read=function(t,e){return t.readFields(a._readField,{vertices:null,faces:null,chunk_name:"",material_name:""},e)},a._readField=function(t,e,n){1===t?e.vertices=i.read(n,n.readVarint()+n.pos):2===t?e.faces=o.read(n,n.readVarint()+n.pos):3===t?e.chunk_name=n.readString():4===t&&(e.material_name=n.readString())},a.write=function(t,e){t.vertices&&e.writeMessage(1,i.write,t.vertices),t.faces&&e.writeMessage(2,o.write,t.faces),t.chunk_name&&e.writeStringField(3,t.chunk_name),t.material_name&&e.writeStringField(4,t.material_name)};var s=e.vertices_quantized={};s.read=function(t,e){return t.readFields(s._readField,{quantization:0,translation:[],x:[],y:[],z:[]},e)},s._readField=function(t,e,n){1===t?e.quantization=n.readFloat():2===t?n.readPackedFloat(e.translation):3===t?n.readPackedSVarint(e.x):4===t?n.readPackedSVarint(e.y):5===t&&n.readPackedSVarint(e.z)},s.write=function(t,e){t.quantization&&e.writeFloatField(1,t.quantization),t.translation&&e.writePackedFloat(2,t.translation),t.x&&e.writePackedSVarint(3,t.x),t.y&&e.writePackedSVarint(4,t.y),t.z&&e.writePackedSVarint(5,t.z)};var c=e.uv_quantized={};c.read=function(t,e){return t.readFields(c._readField,{name:"",quantization:0,u:[],v:[]},e)},c._readField=function(t,e,n){1===t?e.name=n.readString():2===t?e.quantization=n.readFloat():3===t?n.readPackedSVarint(e.u):4===t&&n.readPackedSVarint(e.v)},c.write=function(t,e){t.name&&e.writeStringField(1,t.name),t.quantization&&e.writeFloatField(2,t.quantization),t.u&&e.writePackedSVarint(3,t.u),t.v&&e.writePackedSVarint(4,t.v)};var u=e.faces_compressed={};u.read=function(t,e){return t.readFields(u._readField,{faces:[]},e)},u._readField=function(t,e,n){1===t&&n.readPackedSVarint(e.faces)},u.write=function(t,e){t.faces&&e.writePackedSVarint(1,t.faces)};var l=e.chunk_quantized={};l.read=function(t,e){return t.readFields(l._readField,{chunk_name:"",material_name:"",vertices:null,uvs:[],faces:null},e)},l._readField=function(t,e,n){1===t?e.chunk_name=n.readString():2===t?e.material_name=n.readString():3===t?e.vertices=s.read(n,n.readVarint()+n.pos):4===t?e.uvs.push(c.read(n,n.readVarint()+n.pos)):5===t&&(e.faces=o.read(n,n.readVarint()+n.pos))},l.write=function(t,e){if(t.chunk_name&&e.writeStringField(1,t.chunk_name),t.material_name&&e.writeStringField(2,t.material_name),t.vertices&&e.writeMessage(3,s.write,t.vertices),t.uvs)for(var n=0;n<t.uvs.length;n++)e.writeMessage(4,c.write,t.uvs[n]);t.faces&&e.writeMessage(5,o.write,t.faces)}},function(t,e){t.exports="varying vec2 vUv;\n\nvoid main() {\n\n  vUv = uv;\n  vec4 projectedPosition = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.0);\n  gl_Position = projectedPosition;\n\n}\n"},function(t,e){t.exports="uniform float borderSize;\nuniform float textureSampleScale;\nuniform samplerCube panoTexture;\nuniform vec4 borderColor;\n\nvarying vec2 vUv;\n\nconst vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);\nconst float PI = 3.14159265359;\nconst float HALF_PI = PI / 2.0;\n\nvoid main() {\n  float fadeDist = 0.1;\n  float r = 1.0;\n  vec2 uv = (vUv * 2.0) - vec2(1.0, 1.0);\n  float d = length(uv);\n  float p = d * PI - HALF_PI;\n  float y = sin(p);\n  float h = cos(p) * textureSampleScale;\n  vec3 sampleVec = vec3(uv.x * h, y, uv.y * h);\n\n  vec4 panoColor = textureCube(panoTexture, sampleVec);\n  panoColor.a = clamp(((1.0 - d)/d) / fadeDist, 0.0, 1.0);\n\n  vec4 outColor = mix(panoColor, transparent, step(1.0, d));\n\n  // if (borderSize > 0.0 && d >= 1.0 - borderSize && d <= 1.0)\n  float isBorder = max(sign(borderSize), 0.0) * step(1.0 - borderSize, d) * step(d, 1.0);\n\n  gl_FragColor = mix(outColor, borderColor, isBorder);\n}\n"},function(t,e){t.exports="varying vec2 vUv;\n\nvoid main(){\n  vUv = vec2(1.0 - uv.x, uv.y);\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n"},function(t,e){t.exports="#define M_PI 3.14159265359\n\nuniform samplerCube cubemap;\nuniform float yaw;\n\nvarying vec2 vUv;\n\nvoid main(){\n  vec2 uv = vUv;\n  float theta = uv.x * 2.0 * M_PI + yaw;\n  float phi = uv.y * M_PI;\n\n  vec3 longitude = vec3(sin(theta), 1.0, -cos(theta));\n  vec3 latitude = vec3(sin(phi), -cos(phi), sin(phi));\n\n  vec3 dir = longitude * latitude;\n  normalize(dir);\n  gl_FragColor = vec4(textureCube(cubemap, dir).rgb, 1.0);\n}\n"},function(t,e){t.exports="varying vec2 vUv;\n\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix * vec4(position, 1.0);\n}\n"},function(t,e){t.exports="uniform sampler2D bg;\nuniform sampler2D mask;\n\nvarying vec2 vUv;\n\nvoid main() {\n  vec4 existingColor = texture2D(bg, vUv);\n  vec4 maskColor = texture2D(mask, vUv);\n  gl_FragColor = vec4(existingColor.rgb * maskColor.rgb, maskColor.a);\n}\n"},function(t,e){t.exports="varying vec2 vUv;\n\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix * vec4(position, 1.0);\n}\n"},function(t,e){t.exports="uniform sampler2D texture;\n\nvarying vec2 vUv;\n\nvoid main() {\n  vec4 color = texture2D(texture, vUv);\n  gl_FragColor = vec4(color.rgb, 1.0);\n}\n"},function(t,e,n){},,function(t,e){t.exports="varying vec4 worldPosition;\n\nvoid main() {\n  worldPosition = modelMatrix * vec4(position, 1.0);\n\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\n}\n"},function(t,e){t.exports="// gradient colorings\nuniform vec3 topColor;\nuniform vec3 bottomColor;\nuniform float radius;\n\nvarying vec4 worldPosition;\n\n// Mixed in Linear color spaces based off of https://www.shadertoy.com/view/lscGDr\n#define SRGB_TO_LINEAR(c) pow((c), vec3(2.2))\n#define LINEAR_TO_SRGB(c) pow((c), vec3(1.0 / 2.2))\n#define USE_DITHER\n\n// Gradient noise from Jorge Jimenez's presentation:\n// http://www.iryoku.com/next-generation-post-processing-in-call-of-duty-advanced-warfare\nfloat gradientNoise(in vec2 uv) {\n  const vec3 magic = vec3(0.06711056, 0.00583715, 52.9829189);\n  return fract(magic.z * fract(dot(uv, magic.xy)));\n}\n\nvoid main() {\n\n  float normalizedHeight = (worldPosition.y + radius) / (radius * 2.0);\n  float ratio = smoothstep(0.0, 0.5, normalizedHeight);\n\n  vec3 colorFromGradient = mix(SRGB_TO_LINEAR(bottomColor), SRGB_TO_LINEAR(topColor), ratio);\n  vec3 color = LINEAR_TO_SRGB(colorFromGradient);\n\n  #if defined (USE_DITHER)\n    color += (1.0/255.0) * gradientNoise(gl_FragCoord.xy) - (0.5/255.0);\n  #endif\n\n  gl_FragColor = vec4(color, 1.0);\n}\n"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(866),i=n(867);e.default={DefaultAppSyncQueryAdapter:i.default,DefaultAppSyncMutationAdapter:r.default}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e,"__esModule",{value:!0});var i=n(295),o=n(296),a=function(){function t(t){Array.isArray(t)?this.variables=o.default.resolveVariables(t):(this.variables=t.variables,this.fields=t.fields,this.operation=t.operation)}return t.prototype.mutationBuilder=function(){return this.operationWrapperTemplate(this.variables,this.operationTemplate(this.operation))},t.prototype.mutationsBuilder=function(t){var e=this,n=t.map((function(t){return e.operation=t.operation,e.variables=t.variables,e.fields=t.fields,e.operationTemplate(t.operation)}));return this.operationWrapperTemplate(o.default.resolveVariables(t),n.join("\n  "))},t.prototype.queryDataNameAndArgumentMap=function(){return this.variables&&Object.keys(this.variables).length?"("+Object.keys(this.variables).reduce((function(t,e,n){return t+(0!==n?", ":"")+e+": $"+e}),"")+")":""},t.prototype.queryDataArgumentAndTypeMap=function(t){return Object.keys(t).length?"("+Object.keys(t).reduce((function(e,n,r){return e+(0!==r?", ":"")+"$"+n+": "+o.default.queryDataType(t[n])}),"")+")":""},t.prototype.operationWrapperTemplate=function(t,e){return{query:i.default.Mutation+" "+(this.operation.charAt(0).toUpperCase()+this.operation.slice(1))+" "+this.queryDataArgumentAndTypeMap(t)+" {\n  "+e+"\n}",variables:o.default.queryVariablesMap(t)}},t.prototype.operationTemplate=function(t){return t+" "+this.queryDataNameAndArgumentMap()+" {\n    "+this.queryFieldsMap(this.fields)+"\n  }"},t.prototype.queryFieldsMap=function(t){var e=this;return Array.isArray(t)?t.map((function(t){return"object"===r(t)?Object.keys(t)[0]+" { "+e.queryFieldsMap(Object.values(t)[0])+" }":""+t})).join(", "):""},t}();e.default=a},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e,"__esModule",{value:!0});var i=n(295),o=n(296),a=function(){function t(t){this.queryDataType=function(t){var e="String",n="object"===r(t)?t.value:t;if(void 0!==t.type)e=t.type;else switch(r(n)){case"object":e="Object";break;case"boolean":e="Boolean";break;case"number":e=n%1==0?"Int":"Float"}return"object"===r(t)&&t.required&&(e+="!"),e},Array.isArray(t)?this.variables=o.default.resolveVariables(t):(this.variables=t.variables,this.fields=t.fields||[],this.operation=t.operation)}return t.prototype.queryBuilder=function(){return this.operationWrapperTemplate(this.operationTemplate())},t.prototype.queriesBuilder=function(t){var e,n=this;return this.operationWrapperTemplate((e=[],t.forEach((function(t){t&&(n.operation=t.operation,n.fields=t.fields,n.variables=t.variables,e.push(n.operationTemplate()))})),e.join(" ")))},t.prototype.queryDataNameAndArgumentMap=function(){return this.variables&&Object.keys(this.variables).length?"("+Object.keys(this.variables).reduce((function(t,e,n){return t+(0!==n?", ":"")+e+": $"+e}),"")+")":""},t.prototype.queryDataArgumentAndTypeMap=function(){var t=this;return this.variables&&Object.keys(this.variables).length?"("+Object.keys(this.variables).reduce((function(e,n,r){return e+(0!==r?", ":"")+"$"+n+": "+t.queryDataType(t.variables[n])}),"")+")":""},t.prototype.operationWrapperTemplate=function(t){return{query:i.default.Query+" "+this.operation.charAt(0).toUpperCase()+this.operation.slice(1)+" "+this.queryDataArgumentAndTypeMap()+" { "+t+" }",variables:o.default.queryVariablesMap(this.variables)}},t.prototype.operationTemplate=function(){return this.operation+" "+this.queryDataNameAndArgumentMap()+" { nodes { "+o.default.queryFieldsMap(this.fields)+" } }"},t}();e.default=a},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e,"__esModule",{value:!0});var i=n(295),o=n(296),a=function(){function t(t){Array.isArray(t)?this.variables=o.default.resolveVariables(t):(this.variables=t.variables,this.fields=t.fields,this.operation=t.operation)}return t.prototype.mutationBuilder=function(){return this.operationWrapperTemplate(i.default.Mutation,this.variables,this.operationTemplate(this.operation))},t.prototype.mutationsBuilder=function(t){var e=this,n=t.map((function(t){return e.operation=t.operation,e.variables=t.variables,e.fields=t.fields,e.operationTemplate(t.operation)}));return this.operationWrapperTemplate(i.default.Mutation,o.default.resolveVariables(t),n.join("\n  "))},t.prototype.queryDataNameAndArgumentMap=function(){return this.variables&&Object.keys(this.variables).length?"("+Object.keys(this.variables).reduce((function(t,e,n){return t+(0!==n?", ":"")+e+": $"+e}),"")+")":""},t.prototype.queryDataArgumentAndTypeMap=function(t){return t&&Object.keys(t).length?"("+Object.keys(t).reduce((function(e,n,r){return e+(0!==r?", ":"")+"$"+n+": "+o.default.queryDataType(t[n])}),"")+")":""},t.prototype.operationWrapperTemplate=function(t,e,n){return{query:t+" "+this.queryDataArgumentAndTypeMap(e)+" {\n  "+n+"\n}",variables:o.default.queryVariablesMap(e)}},t.prototype.operationTemplate=function(t){return t+" "+this.queryDataNameAndArgumentMap()+" "+(this.fields&&this.fields.length>0?"{\n    "+this.queryFieldsMap(this.fields)+"\n  }":"")},t.prototype.queryFieldsMap=function(t){var e=this;return t?t.map((function(t){return"object"===r(t)?Object.keys(t)[0]+" { "+e.queryFieldsMap(Object.values(t)[0])+" }":""+t})).join(", "):""},t}();e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(295),i=n(296),o=function(){function t(t){Array.isArray(t)?this.variables=i.default.resolveVariables(t):(this.variables=t.variables,this.fields=t.fields||[],this.operation=t.operation)}return t.prototype.queryBuilder=function(){return this.operationWrapperTemplate(this.operationTemplate())},t.prototype.queriesBuilder=function(t){var e,n=this;return this.operationWrapperTemplate((e=[],t.forEach((function(t){t&&(n.operation=t.operation,n.fields=t.fields,n.variables=t.variables,e.push(n.operationTemplate()))})),e.join(" ")))},t.prototype.queryDataNameAndArgumentMap=function(){return this.variables&&Object.keys(this.variables).length?"("+Object.keys(this.variables).reduce((function(t,e,n){return t+(0!==n?", ":"")+e+": $"+e}),"")+")":""},t.prototype.queryDataArgumentAndTypeMap=function(){var t=this;return this.variables&&Object.keys(this.variables).length?"("+Object.keys(this.variables).reduce((function(e,n,r){return e+(0!==r?", ":"")+"$"+n+": "+i.default.queryDataType(t.variables[n])}),"")+")":""},t.prototype.operationWrapperTemplate=function(t){return{query:r.default.Query+" "+this.queryDataArgumentAndTypeMap()+" { "+t+" }",variables:i.default.queryVariablesMap(this.variables)}},t.prototype.operationTemplate=function(){return this.operation+" "+this.queryDataNameAndArgumentMap()+" { "+i.default.queryFieldsMap(this.fields)+" }"},t}();e.default=o},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e,"__esModule",{value:!0});var i=n(295),o=n(296),a=function(){function t(t){Array.isArray(t)?this.variables=o.default.resolveVariables(t):(this.variables=t.variables,this.fields=t.fields,this.operation=t.operation)}return t.prototype.subscriptionBuilder=function(){return this.operationWrapperTemplate(i.default.Subscription,this.variables,this.operationTemplate(this.operation))},t.prototype.subscriptionsBuilder=function(t){var e=this,n=t.map((function(t){return e.operation=t.operation,e.variables=t.variables,e.fields=t.fields,e.operationTemplate(t.operation)}));return this.operationWrapperTemplate(i.default.Subscription,o.default.resolveVariables(t),n.join("\n  "))},t.prototype.queryDataNameAndArgumentMap=function(){return this.variables&&Object.keys(this.variables).length?"("+Object.keys(this.variables).reduce((function(t,e,n){return t+(0!==n?", ":"")+e+": $"+e}),"")+")":""},t.prototype.queryDataArgumentAndTypeMap=function(t){return Object.keys(t).length?"("+Object.keys(t).reduce((function(e,n,r){return e+(0!==r?", ":"")+"$"+n+": "+o.default.queryDataType(t[n])}),"")+")":""},t.prototype.operationWrapperTemplate=function(t,e,n){return{query:t+" "+this.queryDataArgumentAndTypeMap(e)+" {\n  "+n+"\n}",variables:o.default.queryVariablesMap(e)}},t.prototype.operationTemplate=function(t){return t+" "+this.queryDataNameAndArgumentMap()+" {\n    "+this.queryFieldsMap(this.fields)+"\n  }"},t.prototype.queryFieldsMap=function(t){var e=this;return t?t.map((function(t){return"object"===r(t)?Object.keys(t)[0]+" { "+e.queryFieldsMap(Object.values(t)[0])+" }":""+t})).join(", "):""},t}();e.default=a},function(t,e){t.exports="uniform float opacity;\nuniform vec3 color;\nuniform sampler2D bg;\nuniform sampler2D mask;\n\nvarying vec2 vUv;\n\nvoid main() {\n  vec4 maskColor = texture2D(mask, vUv);\n  vec4 bgColor = texture2D(bg, vUv);\n  vec3 mappedColor = mix(bgColor.rgb, color, maskColor.a);\n  gl_FragColor = vec4(mappedColor, bgColor.a * opacity);\n}\n"},function(t,e,n){},,function(t,e,n){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){var r,i,o;o=function(){var t,e,n=document,r=n.getElementsByTagName("head")[0],i={},o={},a={},s={};function c(t,e){for(var n=0,r=t.length;n<r;++n)if(!e(t[n]))return!1;return 1}function u(t,e){c(t,(function(t){return e(t),1}))}function l(e,n,r){e=e.push?e:[e];var f=n&&n.call,p=f?n:r,d=f?e.join(""):n,y=e.length;function m(t){return t.call?t():i[t]}function v(){if(!--y)for(var t in i[d]=1,p&&p(),a)c(t.split("|"),m)&&!u(a[t],m)&&(a[t]=[])}return setTimeout((function(){u(e,(function e(n,r){return null===n?v():(r||/^https?:\/\//.test(n)||!t||(n=-1===n.indexOf(".js")?t+n+".js":t+n),s[n]?(d&&(o[d]=1),2==s[n]?v():setTimeout((function(){e(n,!0)}),0)):(s[n]=1,d&&(o[d]=1),void h(n,v)))}))}),0),l}function h(t,i){var o,a=n.createElement("script");a.onload=a.onerror=a.onreadystatechange=function(){a.readyState&&!/^c|loade/.test(a.readyState)||o||(a.onload=a.onreadystatechange=null,o=1,s[t]=2,i())},a.async=1,a.src=e?t+(-1===t.indexOf("?")?"?":"&")+e:t,r.insertBefore(a,r.lastChild)}return l.get=h,l.order=function(t,e,n){!function r(i){i=t.shift(),t.length?l(i,r):l(i,e,n)}()},l.path=function(e){t=e},l.urlArgs=function(t){e=t},l.ready=function(t,e,n){t=t.push?t:[t];var r,o=[];return!u(t,(function(t){i[t]||o.push(t)}))&&c(t,(function(t){return i[t]}))?e():(r=t.join("|"),a[r]=a[r]||[],a[r].push(e),n&&n(o)),l},l.done=function(t){l([null],t)},l},t.exports?t.exports=o():void 0===(i="function"==typeof(r=o)?r.call(e,n,e,t):r)||(t.exports=i)},,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";n.r(e);var r,i=n(613),o=n(371),a=n(921),s=n(218),c=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},u=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};!function(t){function e(t){return c(this,void 0,Promise,(function(){return u(this,(function(e){if(t)return[2,new Promise((function(e,n){try{a(t,(function(){var t=window["sdk-client"];delete window["sdk-client"],t&&t.SdkBuilder&&"function"==typeof t.SdkBuilder&&e(t.SdkBuilder)}))}catch(e){n("Could not load the sdk from "+t)}}))];throw new Error("Unabled to load the sdk")}))}))}t.connect=function(t,n,r){return c(this,void 0,void 0,(function(){var i,o;return u(this,(function(a){switch(a.label){case 0:if("string"!=typeof n)throw Error("invalid key");if("string"!=typeof r)throw Error("invalid version");return i=window.location.protocol+"//"+window.location.host,[4,t.getModule(s.default)];case 1:return[4,a.sent().connect(n,r,i)];case 2:return[4,e((o=a.sent()).scriptUrl)];case 3:return[2,new(a.sent())(o.messengerFactory).build(o.serializedInterface)]}}))}))}}(r||(r={}));var l=n(6),h=n(614),f=n(2),p=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}c((r=r.apply(t,e||[])).next())}))},d=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},y=new f.a("bootstrap");function m(t){var e=new i.a,n=new o.b([o.a],!1,t);e.loadApplication(n,n.setError.bind(n)),l.b()||document.body.classList.add("no-touch"),function(t){var e=this;window.MP_SDK={connect:function(n,i,o){return p(e,void 0,void 0,(function(){return d(this,(function(e){return[2,r.connect(t,i,o)]}))}))}}}(e)}window.addEventListener("app-start",(function(t){var e=t.detail&&t.detail.config?t.detail.config:{},n=!1;Object(h.a)().then((function(){n=!0,m(e)})).catch((function(t){y.error(t),n||m(e)}))}),!0)}]);