(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1e3:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var o=function(t){return t.innerWidth<487||t.innerHeight<487}},1010:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var o,r,i=n(11),a=n(150),s=n(105),c=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};!function(t){t[t.OPEN=0]="OPEN",t[t.UNLOADING=1]="UNLOADING",t[t.CLOSED=2]="CLOSED"}(r||(r={}));var u=function(t){function e(e){var n=t.call(this,e)||this;return n.onTransitionEnd=function(){n.state.phase===r.UNLOADING&&n.setState({phase:r.CLOSED})},n.onClick=function(t){n.props.onClick&&n.props.onClick(t)},n.onPointerDown=function(t){n.props.onPointerDown&&n.props.onPointerDown(t)},n.onPointerUp=function(t){n.props.onPointerUp&&n.props.onPointerUp(t)},n.state={phase:e.open?r.OPEN:r.CLOSED},n}return c(e,t),e.prototype.componentWillReceiveProps=function(t){!t.open&&this.props.open?this.setState({phase:r.UNLOADING}):t.open&&!this.props.open&&this.setState({phase:r.OPEN})},e.prototype.renderChildren=function(){return this.state.phase!==r.CLOSED?this.props.children:null},e.prototype.render=function(){var t=this.props,e=t.id,n=t.appendClass;return Object(i.h)("div",{id:e,class:s(n),onTransitionEnd:this.onTransitionEnd,onClick:this.onClick,onPointerDown:this.onPointerDown,onPointerUp:this.onPointerUp},this.renderChildren())},e=l([a.b],e)}(i.Component)},1019:function(t,e,n){"use strict";n.d(e,"j",(function(){return o})),n.d(e,"m",(function(){return r})),n.d(e,"a",(function(){return i})),n.d(e,"o",(function(){return a})),n.d(e,"k",(function(){return s})),n.d(e,"p",(function(){return c})),n.d(e,"c",(function(){return l})),n.d(e,"b",(function(){return u})),n.d(e,"n",(function(){return p})),n.d(e,"l",(function(){return d})),n.d(e,"f",(function(){return h})),n.d(e,"d",(function(){return f})),n.d(e,"e",(function(){return g})),n.d(e,"g",(function(){return b})),n.d(e,"i",(function(){return v})),n.d(e,"h",(function(){return y}));var o=12,r=24,i=20,a=5,s=100,c=80,l=150,u=340,p=310,d=200,h=300,f=350,g=400,b=800,v=700,y=600},1021:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var o,r=n(11),i=n(105),a=n(150),s=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},l=function(t){function e(e){var n=t.call(this,e)||this;return n.onChange=function(t){n.props.onChange(t)},n}return s(e,t),e.prototype.render=function(){var t=this.props,e=t.id,n=t.name,o=t.value,a=t.checked,s=t.children,c=!t.enabled;return Object(r.h)("div",{class:i("radio-element","radio-button",{disabled:c})},Object(r.h)("input",{type:"radio",id:e,name:n,value:o,checked:a,onChange:this.onChange}),Object(r.h)("label",{for:e},s))},e=c([a.b],e)}(r.Component)},1044:function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return p}));var o,r=n(5),i=n(35),a=n(116),s=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function a(t){try{c(o.next(t))}catch(t){i(t)}}function s(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){t.done?r(t.value):new n((function(e){e(t.value)})).then(a,s)}c((o=o.apply(t,e||[])).next())}))},l=function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},u=function(t){function e(e){var n=t.call(this)||this;return n.id="MOVE_TO_FLOOR",n.payload=e,n}return s(e,t),e}(r.a),p=function(t,e,n){t.market.waitForData(i.b).then((function(n){return e.addBinding(u,(function(e){return c(void 0,void 0,void 0,(function(){var o,r;return l(this,(function(i){switch(i.label){case 0:if("number"!=typeof e.floorIndex||e.floorIndex<0)throw Error("floor index must be a non-negative number");i.label=1;case 1:return i.trys.push([1,3,,4]),o="boolean"==typeof e.moveCamera&&!e.moveCamera,r=o?250:void 0,[4,t.commandBinder.issueCommand(new a.a(e.floorIndex,o,r))];case 2:return i.sent(),[2,n.currentFloor];case 3:throw i.sent(),Error("Could not move to floor at index "+e.floorIndex);case 4:return[2]}}))}))}))})),n.addCommandToInterface({version:"3.x",namespace:"Floor",name:"moveTo",args:["floorIndex","moveCamera"]},(function(t){return new u(t)}))}},1045:function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return p}));var o,r=n(5),i=n(345),a=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function a(t){try{c(o.next(t))}catch(t){i(t)}}function s(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){t.done?r(t.value):new n((function(e){e(t.value)})).then(a,s)}c((o=o.apply(t,e||[])).next())}))},c=function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},l=function(t){function e(e){var n=t.call(this)||this;return n.id="MATTERTAG_OPEN",n.payload={tag:e},n}return a(e,t),e}(r.a),u=function(t){function e(e){var n=t.call(this)||this;return n.id="MATTERTAG_CLOSE",n.payload={tag:e},n}return a(e,t),e}(r.a),p=function(t,e,n){return s(void 0,void 0,void 0,(function(){var o=this;return c(this,(function(r){return n.addCommandToInterface({version:"3.x",namespace:"Mattertag",name:"closeBillboards",args:["tag"]},(function(t){return new u(t.tag)})),t.getModule(i.default).then((function(t){e.addBinding(l,(function(e){return s(o,void 0,Promise,(function(){return c(this,(function(n){return t.openBillboard(e.tag),[2]}))}))}))})),t.getModule(i.default).then((function(t){e.addBinding(u,(function(e){return s(o,void 0,Promise,(function(){return c(this,(function(n){return t.closeBillboard(e.tag),[2]}))}))}))})),[2]}))}))}},1046:function(t,e,n){},1049:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var o,r=n(11),i=n(150),a=n(105),s=n(49),c=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},u=function(t){function e(e,n){var o=t.call(this,e)||this;o.onClick=function(){o.props.enabled&&o.props.onToggle()},o.locale={onSettingString:n.locale.t(s.a.ON),offSettingString:n.locale.t(s.a.OFF)};var r=Math.max(o.props.toggleTime||300);return o.trackTransitionStyle="transition: background-color "+r+"ms",o.thumbTransitionStyle=o.trackTransitionStyle+", left "+r+"ms",o}return c(e,t),e.prototype.render=function(){var t=this.props,e=t.id,n=t.toggled,o=t.enabled,i=t.onOffLabel,s=n?this.locale.onSettingString:this.locale.offSettingString;return Object(r.h)("div",{class:a("reusable-toggle",{"toggle-on":n,enabled:o}),id:e,onClick:this.onClick},i&&Object(r.h)("span",{class:"toggle-label"},s),Object(r.h)("div",{style:this.trackTransitionStyle,class:"track"}),Object(r.h)("div",{style:this.thumbTransitionStyle,class:"thumb"}))},e=l([i.b],e)}(r.Component)},1090:function(t,e,n){"use strict";var o,r=n(11),i=n(105),a=n(150),s=n(49),c=n(243),l=n(374),u=n(285),p=n(106),d=n(2),h=(n(1178),o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),f=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},g=function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function a(t){try{c(o.next(t))}catch(t){i(t)}}function s(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){t.done?r(t.value):new n((function(e){e(t.value)})).then(a,s)}c((o=o.apply(t,e||[])).next())}))},b=function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},v=new d.a("tour-controls"),y=function(t){function e(e){var n=t.call(this,e)||this;return n.handlePlayPause=function(){return g(n,void 0,void 0,(function(){var t;return b(this,(function(e){switch(e.label){case 0:if(this.props.tourEmpty)return[2];e.label=1;case 1:return e.trys.push([1,6,,7]),this.props.tourPlaying?[4,this.stopTour()]:[3,3];case 2:return e.sent(),[3,5];case 3:return this.context.analytics.track("showcase_gui",{gui_action:"play_highlights"}),[4,this.startTour()];case 4:e.sent(),e.label=5;case 5:return[3,7];case 6:return t=e.sent(),v.debug(t),[3,7];case 7:return[2]}}))}))},n}return h(e,t),e.prototype.startTour=function(){return g(this,void 0,void 0,(function(){var t;return b(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.context.commandBinder.issueCommand(new c.b)];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),v.debug(t),[3,3];case 3:return[2]}}))}))},e.prototype.stopTour=function(){return g(this,void 0,void 0,(function(){var t;return b(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),this.context.analytics.track("showcase_gui",{gui_action:"pause_highlights"}),[4,this.context.commandBinder.issueCommand(new c.d)];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),v.debug(t),[3,3];case 3:return[2]}}))}))},e.prototype.render=function(){var t=this.props,e=t.tourEmpty,n=t.tourPlaying,o="ontouchstart"in window,a=e?p.c.DISABLED:n?p.c.ACTIVE:p.c.ENABLED;return Object(r.h)(u.a,{buttonState:a,onClick:this.handlePlayPause,appendClass:{"tour-controls":!0}},e?Object(r.h)("span",{class:"icon icon-play"}):Object(r.h)(l.a,{content:n?this.context.locale.t(s.a.PAUSE):this.context.locale.t(s.a.PLAY),position:l.b.UP,tooltipTimeout:o?1e3:void 0},Object(r.h)("span",{class:i({icon:!0,"icon-pause":n,"icon-play":!n})})))},e=f([a.b],e)}(r.Component);e.a=y},1091:function(t,e,n){"use strict";var o,r=n(11),i=n(105),a=n(6),s=n(49),c=n(374),l=n(285),u=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),p=function(t){function e(e){var n=t.call(this,e)||this;return n.handleButtonClick=function(){a.i()?(n.context.analytics.track("showcase_gui",{gui_action:"click_exit_fullscreen",interaction_source:"gui"}),a.c()):(n.context.analytics.track("showcase_gui",{gui_action:"click_enter_fullscreen",interaction_source:"gui"}),a.u(document.body))},n.onFullScreenChange=function(){n.setState({fullscreen:a.i()})},n.state={fullscreen:a.i()},document.addEventListener("fullscreenchange",n.onFullScreenChange),document.addEventListener("webkitfullscreenchange",n.onFullScreenChange),document.addEventListener("MSFullscreenChange",n.onFullScreenChange),document.addEventListener("mozfullscreenchange",n.onFullScreenChange),n}return u(e,t),e.prototype.render=function(){var t=a.b(),e=this.state.fullscreen;return Object(r.h)("div",{class:"fullscreen-mode"},Object(r.h)(l.a,{onClick:this.handleButtonClick},Object(r.h)(c.a,{content:e?this.context.locale.t(s.a.EXIT_FULLSCREEN):this.context.locale.t(s.a.VIEW_FULLSCREEN),position:c.b.UP_LEFT,tooltipTimeout:t?1e3:void 0},Object(r.h)("span",{class:i("icon",e?"icon-fullscreen-exit":"icon-fullscreen")}))))},e}(r.Component);e.a=p},1092:function(t,e,n){"use strict";var o,r=n(11),i=n(150),a=n(49),s=n(285),c=n(374),l=n(6),u=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),p=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},d=function(t){function e(e){var n=t.call(this,e)||this;return n.handleButtonClick=function(){var t=n.props.reelOpen?"hide_":"show_";n.context.analytics.track("showcase_gui",{gui_action:t+"highlight_reel"}),n.props.onToggleHLR(!n.props.reelOpen)},n}return u(e,t),e.prototype.render=function(){var t=this.props,e=t.reelEnabled,n=t.reelOpen;return e?Object(r.h)(s.a,{appendClass:{"highlight-button":!0},onClick:this.handleButtonClick},Object(r.h)(c.a,{content:n?this.context.locale.t(a.a.CLOSE_HIGHLIGHTS):this.context.locale.t(a.a.OPEN_HIGHLIGHTS),position:c.b.UP_RIGHT,tooltipTimeout:Object(l.b)()?1e3:void 0},Object(r.h)("span",{class:"icon "+(n?"icon-dpad-down":"icon-dpad-up")}))):null},e=p([i.b],e)}(r.Component);e.a=d},1093:function(t,e,n){},1094:function(t,e,n){"use strict";var o,r=n(11),i=n(105),a=n(1e3),s=n(201),c=n(986),l=n(78),u=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),p=function(t){function e(e){var n=t.call(this,e)||this;return n.onWindowResize=function(){var t=Object(a.a)(window);n.state.hideScrollbar!==t&&n.setState({hideScrollbar:t})},n.onScrollableChanged=function(t){n.setState({scrollable:t})},n.onScrollPositionChange=function(t){n.setState({scrollPosition:t})},n.getScrollableContainer=function(){return n.scrollbar?n.scrollbar.getScrollableContainer():void 0},n.handleHighlightClickable=function(){n.props.highlightClickable(!0)},n.state={scrollLeft:0,hideScrollbar:Object(a.a)(window),scrollPosition:l.c.None,scrollable:!1},n.resizeSubscription=Object(s.c)(s.b.RESIZE,n.onWindowResize),n}return u(e,t),e.prototype.componentDidMount=function(){this.resizeSubscription.renew(),this.onScrollableChanged(!0),this.onScrollPositionChange(l.c.Beginning)},e.prototype.componentWillUnmount=function(){this.resizeSubscription.cancel()},e.prototype.componentDidUpdate=function(t){var e=this.props.activeElement;null!==e&&t.activeElement!==e&&this.scrollbar.scrollToElement(e)},e.prototype.setSorting=function(t){t?(this.el.classList.add("sorting"),this.props.mobile&&this.scrollbar.pauseScrollHandling()):this.el.classList.remove("sorting")},e.prototype.render=function(){var t,e=this,n=this.props,o=n.thumbScrollingOnly,a=n.children,s=n.totalSteps,u=this.state,p=u.hideScrollbar,d=u.scrollPosition,h=u.scrollable,f=i(((t={scrollable:h})[d]=!0,t));return Object(r.h)("div",{id:"reel",class:f,ref:function(t){e.el=t}},Object(r.h)(c.a,{direction:l.b.horizontal,ref:function(t){return e.scrollbar=t},hideScrollbar:p,thumbScrollingOnly:o,waitToUpdate:0===s,handleClick:this.handleHighlightClickable,onScrollableChanged:this.onScrollableChanged,onScrollPositionChange:this.onScrollPositionChange},a))},e}(r.Component);e.a=p},1095:function(t,e,n){"use strict";var o,r=n(11),i=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.render=function(){return Object(r.h)("div",{class:"no-highlights-message"},Object(r.h)("p",null,"Your space does not have any highlights yet."),Object(r.h)("p",null,"A Highlight Reel lets your visitors get a taste of what the Space is like.",Object(r.h)("a",{class:"link",target:"_blank",href:"https://support.matterport.com/hc/en-us/articles/360019401733"},"Learn More")))},e}(r.Component);e.a=a},1096:function(t,e,n){"use strict";var o,r=n(11),i=n(105),a=n(10),s=n(33),c=n(1),l=n(374),u=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),p=function(t){function e(e){var n=t.call(this,e)||this;return n.editHighlight=function(t){t.stopPropagation(),n.props.onClickHighlight(n.props.index,!0)},n.removeHighlight=function(t){t.stopPropagation(),n.props.onRemoveHighlight&&n.props.onRemoveHighlight(n.props.highlight.snapshot.sid)},n.onClickHighlight=function(t){t.preventDefault(),n.props.onClickHighlight(n.props.index,!1)},n}return u(e,t),e.prototype.render=function(){var t=this,e=this.props,n=e.highlight,o=e.active,a=e.editable,s=e.getRef,c=e.index,l=n.snapshot,u=l.sid,p=l.thumbnailUrl,d=l.name,h=!!d||a,f={backgroundImage:"url('"+p+"')"};return Object(r.h)("div",{key:u,class:i("highlight-box",{active:o,editable:a}),onClick:this.onClickHighlight,ref:function(e){t.element=e,s(c,t.element)}},Object(r.h)("div",{class:"highlight-image",style:f}),this.renderImageBar(),a&&this.renderTransitionSettings(),Object(r.h)("div",{class:i("image-name",{shadowed:h})},Object(r.h)("span",{class:"static-text"},d)))},e.prototype.renderTransitionSettings=function(){var t=this.props,e=t.transitionType,n=t.panDirection,o=t.transitionCondition,i="pan-auto";n===s.b.Left?i="icon icon-rotate-left":n===s.b.Right&&(i="icon icon-rotate-right");var c="";return e===a.a.FadeToBlack?c="Slideshow":e===a.a.Interpolate&&(c="Walkthrough"),Object(r.h)("div",{class:"transition-settings"},Object(r.h)("span",{class:"transition-type"},c,o&&Object(r.h)("span",null,"*")),Object(r.h)("span",{class:"pan-icon "+i}))},e.prototype.renderImageBar=function(){var t=this.props,e=t.highlight,n=t.editable,o=e.snapshot.is360,a=e.snapshot.metadata.camera_mode,s=this.getMarker(a,o);return Object(r.h)("div",{class:"image-bar"},Object(r.h)("span",{class:i("highlight-marker",s)}),n&&Object(r.h)(l.a,{className:"highlight-remove",content:"Remove from Highlights",position:l.b.DOWN_RIGHT},Object(r.h)("span",{class:i("icon-delete"),onClick:this.removeHighlight})),n&&Object(r.h)(l.a,{className:"highlight-edit",content:"Edit Highlight",position:l.b.DOWN_LEFT},Object(r.h)("span",{class:i("icon-toggle-pencil"),onClick:this.editHighlight})))},e.prototype.getMarker=function(t,e){return t===c.a.Dollhouse||t===c.a.Floorplan?null:e?"icon-360":"icon-panorama"},e}(r.Component);e.a=p},1097:function(t,e,n){"use strict";var o,r=n(11),i=n(105),a=(n(1183),n(150)),s=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},l=function(t){function e(e){var n=t.call(this,e)||this;return n.handleClick=function(){n.context.analytics.track("showcase_gui",{gui_action:"tour_progress"}),n.props.reelOpen||n.props.onToggleHLR(!0)},n}return s(e,t),e.prototype.getTourSteps=function(){for(var t=this.props,e=t.totalSteps,n=t.activeStep,o=[],a=0;a<e;a++)o.push(Object(r.h)("div",{class:i({active:a===n}),key:a.toString()}));return o},e.prototype.render=function(){var t=this.props,e=t.reelOpen,n=t.tourPlaying,o=t.activeStep,a=t.totalSteps,s=o+1+"/"+a,c=-1!==o&&!e&&s,l=-1!==o&&e&&n;return a>0?Object(r.h)("div",{id:"tour-progress",class:i({"faded-in":n}),onClick:this.handleClick,"data-balloon":c,"data-balloon-pos":"right","data-balloon-size":"xs"},l&&Object(r.h)("div",{class:"progress-number"},s),-1!==o&&Object(r.h)("div",{class:"progress-bar"},this.getTourSteps())):null},e=c([a.b],e)}(r.Component);e.a=l},1098:function(t,e,n){"use strict";n.d(e,"b",(function(){return p})),n.d(e,"a",(function(){return r}));var o,r,i=n(11),a=n(1204),s=n.n(a),c=n(105),l=(n(1106),n(1211),o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),u=0,p=function(t){function e(e){var n=t.call(this,e)||this;return n.setValue=function(t){n.setState({value:t})},n.getValue=function(){var t=n.slider.getValue();return"object"==typeof t?t.value:t},n.onSliderInput=function(){var t=n.getValue();n.setState({value:t}),n.props.onInput&&n.props.onInput(t)},n.onSliderChange=function(){var t=n.getValue();n.setState({value:t}),n.props.onChange&&n.props.onChange(t)},n.getLeftOffset=function(){return 100*(n.state.value-n.props.min)/(n.props.max-n.props.min)+"%"},n.getSliderId=function(){return"slider-with-tooltip-"+n.id},n.getStyleElement=function(){return"#"+n.getSliderId()+" .mdc-slider__thumb-container {\n        left: "+n.getLeftOffset()+"\n    }"},n.getDisplayValue=function(t){var e=n.props,o=e.formatNumbers,r=e.units;return(o?o(t):t)+(r||"")},n.setActive=function(t){return function(){return n.setState({active:t})}},n.hasChanged=function(){n.setState({hasChanged:!1})},n.onMouseDown=function(t){n.props.onInputStart&&n.props.onInputStart()},n.onMouseUp=function(t){n.props.onInputEnd&&n.props.onInputEnd()},n.id=u++,n.state={value:void 0!==e.initialValue?e.initialValue:(e.max+e.min)/2,active:!1,hasChanged:!1},n.setActiveSlider=n.setActive(!0),n.setInactiveSlider=n.setActive(!1),n}return l(e,t),e.prototype.componentDidMount=function(){document.addEventListener("mouseup",this.onMouseUp),document.addEventListener("mouseleave",this.onMouseUp)},e.prototype.componentWillUnmount=function(){document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("mouseleave",this.onMouseUp)},e.prototype.componentDidUpdate=function(t,e){e.value!==this.state.value&&(clearTimeout(this.hasChangedTimeout),this.setState({hasChanged:!0}),this.hasChangedTimeout=window.setTimeout(this.hasChanged,450))},e.prototype.render=function(){var t=this,e=this.props,n=e.width,o=e.displayBounds,a=e.min,l=e.max,u=e.discrete,p=e.tooltipPosition,d=this.state,h=d.active,f=d.hasChanged,g=d.value;return Object(i.h)("div",{id:this.getSliderId(),class:c("slider-with-tooltip",{displayBounds:o}),style:"width:"+n+"px",onMouseEnter:this.setActiveSlider,onMouseLeave:this.setInactiveSlider},p===r.UP&&Object(i.h)("div",{class:c("slider-tooltip",{active:h||f}),"data-balloon":this.getDisplayValue(g),"data-balloon-pos":r.UP,style:{left:this.getLeftOffset()}}),o&&Object(i.h)("div",{class:"min-amount"},this.getDisplayValue(a)),Object(i.h)(s.a,{ref:function(e){return t.slider=e},discrete:u,min:a,max:l,value:g,onInput:this.onSliderInput,onChange:this.onSliderChange,onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp}),o&&Object(i.h)("div",{class:"max-amount"},this.getDisplayValue(l)),Object(i.h)("style",{dangerouslySetInnerHTML:{__html:this.getStyleElement()}}),p===r.DOWN&&Object(i.h)("div",{class:c("slider-tooltip",{active:h||f}),"data-balloon":this.getDisplayValue(g),"data-balloon-pos":r.DOWN,style:{left:this.getLeftOffset()}}))},e}(i.Component);!function(t){t.UP="up",t.DOWN="down"}(r||(r={}))},1107:function(t,e,n){"use strict";n.d(e,"a",(function(){return S}));var o,r=n(11),i=n(150),a=n(329),s=n(106),c=n(285),l=n(21),u=n(87),p=n(1108),d=n(1109),h=n(1049),f=n(1021),g=n(374),b=n(49),v=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),y=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},m=function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function a(t){try{c(o.next(t))}catch(t){i(t)}}function s(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){t.done?r(t.value):new n((function(e){e(t.value)})).then(a,s)}c((o=o.apply(t,e||[])).next())}))},O=function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},w=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},S=function(t){function e(e,n){var o=t.call(this)||this;return o.propertiesToRefreshUi=[u.a.UnitType,u.a.MeasurementSnapping,u.a.MeasurementContinuousLines],o.close=function(){o.setState({settingsOpen:!1})},o.updatePerSettings=function(){o.setState({units:o.context.settings.tryGetProperty(u.a.UnitType,l.c.Metric),snapping:o.context.settings.tryGetProperty(u.a.MeasurementSnapping,!1),continuousLines:o.context.settings.tryGetProperty(u.a.MeasurementContinuousLines,!1)})},o.toggleUnits=function(){var t=o.state.units!==l.c.Metric?l.c.Metric:l.c.USFractional;o.context.settings.setLocalStorageProperty(u.a.UnitType,t)},o.toggleSnapping=function(){var t=o.state.snapping;o.context.settings.setLocalStorageProperty(u.a.MeasurementSnapping,!t)},o.toggleOpen=function(t){var e=o.props.onToggle;e&&e(t,!o.state.settingsOpen),o.setState((function(t){return{settingsOpen:!t.settingsOpen}}))},o.toggleContinuousLines=function(){var t=o.state.continuousLines;o.context.settings.setLocalStorageProperty(u.a.MeasurementContinuousLines,!t)},o.locale={continuousLinesString:n.locale.t(b.a.MEASUREMENT_CONTINUOUS_LINES),snappingString:n.locale.t(b.a.MEASUREMENT_SNAPPING),unitsString:n.locale.t(b.a.MEASUREMENT_UNITS),imperialString:n.locale.t(b.a.MEASUREMENT_IMPERIAL),metricString:n.locale.t(b.a.MEASUREMENT_METRIC),settingsString:n.locale.t(b.a.MEASUREMENT_SETTINGS),closeString:n.locale.t(b.a.CLOSE)},o.state={settingsOpen:!1,units:l.c.Metric,snapping:!1,continuousLines:!1},o}return v(e,t),e.prototype.componentDidMount=function(){return m(this,void 0,void 0,(function(){var t,e,n,o,r;return O(this,(function(i){try{for(n=w(this.propertiesToRefreshUi),o=n.next();!o.done;o=n.next())r=o.value,this.context.settings.onPropertyChanged(r,this.updatePerSettings)}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return this.updatePerSettings(),[2]}))}))},e.prototype.componentWillUnmount=function(){var t,e;try{for(var n=w(this.propertiesToRefreshUi),o=n.next();!o.done;o=n.next()){var r=o.value;this.context.settings.removeOnPropertyChanged(r,this.updatePerSettings)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},e.prototype.render=function(){var t=this.props.iconButtonStyle,e=this.state.settingsOpen,n=this.locale.settingsString,o=t||c.b.OVERLAY;return Object(r.h)(c.a,{appendClass:{"measurement-settings-btn":!0},buttonStyle:o,iconClass:"icon-settings",buttonState:e?s.c.ACTIVE:s.c.ENABLED,onClick:this.toggleOpen,tooltipMsg:!e&&n||void 0,tooltipPosition:g.b.DOWN},this.renderSettingsPopup())},e.prototype.renderSettingsPopup=function(){var t=this.state,e=t.settingsOpen,n=t.units,o=t.snapping,i=t.continuousLines,s=this.locale,c=s.continuousLinesString,u=s.snappingString,g=s.unitsString,b=s.imperialString,v=s.metricString,y=n===l.c.Metric;return Object(r.h)(p.a,{appendClass:{"measurement-settings-popup":!0},arrowPosition:a.a.TOP_RIGHT,open:e,close:this.close},Object(r.h)(d.a,{label:u},Object(r.h)(h.a,{onToggle:this.toggleSnapping,enabled:!0,onOffLabel:!0,toggled:o})),Object(r.h)(d.a,{label:c},Object(r.h)(h.a,{onToggle:this.toggleContinuousLines,enabled:!0,onOffLabel:!0,toggled:i})),Object(r.h)(d.a,{label:g,appendClass:"units-setting"},Object(r.h)("div",{class:"radio-group radio-buttons"},Object(r.h)(f.a,{name:"unit",value:l.c.USFractional,id:"unit-imperial",enabled:!0,checked:!y,onChange:this.toggleUnits},b),Object(r.h)(f.a,{name:"unit",value:l.c.Metric,id:"unit-metric",enabled:!0,checked:y,onChange:this.toggleUnits},v))))},e=y([i.b],e)}(r.Component)},1108:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var o,r=n(11),i=n(150),a=n(329),s=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.stopClickPropagation=function(t){t.stopPropagation()},e}return s(e,t),e.prototype.render=function(){var t=this.props,e=t.children,n=t.open,o=t.appendClass,i=t.close,s=t.arrowPosition,c=Object(r.h)("div",{class:"settings-container settings-box",onClick:this.stopClickPropagation},e);return Object(r.h)(a.b,{open:n,message:c,appendClass:o,arrowPos:s,onClose:i})},e=c([i.b],e)}(r.Component)},1109:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var o,r=n(11),i=n(150),a=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.render=function(){var t=this.props,e=t.label,n=t.children,o=t.appendClass||"";return Object(r.h)("div",{class:"settings-toggle "+o},e&&Object(r.h)("div",{class:"settings-label"},e),n)},e=s([i.b],e)}(r.Component)},1110:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var o,r=n(11),i=n(105),a=n(150),s=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},l=function(t){function e(e){var n=t.call(this,e)||this;return n.onChange=function(t){n.setState((function(t){return{checkedValue:!t.checkedValue}}),(function(){n.props.onChange&&n.props.onChange(n.checkboxElement)}))},n.setCheckboxRef=function(t){n.checkboxElement=t},n.state={checkedValue:e.checked},n}return s(e,t),e.prototype.componentWillReceiveProps=function(t){this.setState({checkedValue:t.checked})},e.prototype.render=function(){var t=this.props,e=t.id,n=t.dataValue,o=t.enabled,a=t.error,s=t.key,c=t.helpText,l=t.label,u=this.state.checkedValue,p=!o;return Object(r.h)("div",{ref:this.setCheckboxRef,id:e,"data-value":n,class:i("checkbox-element",{checked:u,disabled:p,error:a}),onClick:this.onChange,key:s},Object(r.h)("div",{class:"checkbox icon-checkmark"}),Object(r.h)("div",{class:"checkbox-text"},l),c&&Object(r.h)("span",{className:"help-text"},c))},e.defaultProps={enabled:!0,error:!1},e=c([a.b],e)}(r.Component)},1169:function(t,e,n){"use strict";var o,r=n(11),i=n(105),a=n(2),s=n(964),c=n(34),l=n(300),u=n(137),p=n(1045),d=n(908),h=n(281),f=n(150),g=n(92),b=n(129),v=function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function a(t){try{c(o.next(t))}catch(t){i(t)}}function s(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){t.done?r(t.value):new n((function(e){e(t.value)})).then(a,s)}c((o=o.apply(t,e||[])).next())}))},y=function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},m=new a.a("embedly"),O=function(t){this.msg=t},w=function(t){this.msg=t},S=function(t){this.msg=t},C=function(){function t(e){this.key=e,this.embedEndpoint="https://api.embed.ly/1/oembed",this.imageEndpoint="https://i.embed.ly/1/display/resize",this.saveProvidersForScripts=["Flickr","Instagram"],t.queue||(t.queue=new g.RequestQueue({retries:0}))}return t.clearCache=function(){t.embedCache={},t.imageCache={}},t.prototype.getType=function(t){return v(this,void 0,Promise,(function(){var e,n,o;return y(this,(function(r){switch(r.label){case 0:return[4,this.fetchFromCache(t)];case 1:if(e=r.sent())return[2,e.type];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,this.getEmbedDetails(t)];case 3:return(n=r.sent()).type===b.a.rich||n.type===b.a.video?[2,n.type]:[3,5];case 4:return 401===(o=r.sent()).status_code||404===o.status_code||501===o.status_code||o instanceof O?[3,5]:[2,b.a.error];case 5:return r.trys.push([5,7,,8]),[4,this.getImageDetails(t)];case 6:return r.sent(),[2,b.a.photo];case 7:return r.sent(),[3,8];case 8:return[2,b.a.error]}}))}))},t.prototype.fetchFromCache=function(e){return v(this,void 0,Promise,(function(){var n,o,r,i;return y(this,(function(a){switch(a.label){case 0:return[4,this.getDisplayUrl(e)];case 1:return n=a.sent(),(o=t.imageCache[n])?[2,o]:[4,this.getOEmbedUrl(e)];case 2:return r=a.sent(),(i=t.embedCache[r])?[2,i]:[2,null]}}))}))},t.prototype.getMediaDetails=function(t,e){return v(this,void 0,void 0,(function(){return y(this,(function(n){switch(t){case b.a.photo:return[2,this.getImageDetails(e)];case b.a.rich:case b.a.video:return[2,this.getEmbedDetails(e)]}throw Error("unsupported media type")}))}))},t.prototype.getOEmbedUrl=function(t){return v(this,void 0,Promise,(function(){var e,n;return y(this,(function(o){return e=Math.max(window.screen.height,window.screen.width),n="&maxwidth="+e+"&maxheight="+e,[2,this.embedEndpoint+"?key="+this.key+"&url="+encodeURIComponent(t)+n]}))}))},t.prototype.getEmbedDetails=function(e){return v(this,void 0,void 0,(function(){var n;return y(this,(function(o){switch(o.label){case 0:return[4,this.getOEmbedUrl(e)];case 1:return n=o.sent(),t.embedCache[n]?[2,Promise.resolve(t.embedCache[n])]:[2,this.loadEmbed(n)]}}))}))},t.prototype.getDisplayUrl=function(t){return v(this,void 0,Promise,(function(){var e,n;return y(this,(function(o){return e=Math.max(window.screen.height,window.screen.width),n="&url="+encodeURIComponent(t)+"&width="+e+"&height="+e,[2,this.imageEndpoint+"?key="+this.key+n]}))}))},t.prototype.getImageDetails=function(e){return v(this,void 0,Promise,(function(){var n;return y(this,(function(o){switch(o.label){case 0:return[4,this.getDisplayUrl(e)];case 1:return n=o.sent(),t.imageCache[n]?[2,Promise.resolve(t.imageCache[n])]:[2,this.loadImage(n)]}}))}))},t.prototype.loadEmbed=function(e){var n=this;return t.queue.get(e,{responseType:"json"}).then((function(t){return n.validateAndCacheEmbed(e,t)}))},t.prototype.loadImage=function(e){var n=this;return new Promise((function(o,r){return t.queue.get(e,{responseType:"arraybuffer"}).then((function(t){return n.validateAndCacheImage(e,t)})).then(o).catch(r)}))},t.prototype.validateAndCacheEmbed=function(e,n){var o=!!(!n.html||!n.html.match(/<script/i))||this.saveProvidersForScripts.includes(n.provider_name);if(!(n.type!==b.a.photo||n.html&&o))throw new O('image can\'t be used as a "rich" type');if(!n||n.type===b.a.rich&&(!n.html||!o))throw new w("missing html or html contains Javascript");switch(n.type){case b.a.photo:n.html&&(n.type=b.a.rich);break;case b.a.rich:case b.a.video:break;case b.a.link:var r="not supporting link types because of existing link functionality";throw m.debug(r),new S(r);default:r="Did the OEmbed format extend?! Unknown type: "+n.type;throw m.debug(r),new S(r)}var i=(void 0===n.height||void 0===n.width)&&n.thumbnail_width&&n.thumbnail_height,a=i?n.thumbnail_width:n.width,s=i?n.thumbnail_height:n.height,c=n.provider_name,l={width:a,height:s,embedlyResponse:{html:n.html,src:n.url,provider:c},type:n.type};return t.embedCache[e]=l,l},t.prototype.validateAndCacheImage=function(e,n){return new Promise((function(o,r){n||r("Embedly: got an empty response when requesting image");var i=new Uint8Array(n),a=new Blob([i]),s=new Image;s.addEventListener("load",(function(n){return r=n.target,i={width:r.naturalWidth,height:r.naturalHeight,embedlyResponse:{url:c,src:e},type:b.a.photo},t.imageCache[e]=i,void o(i);var r,i}));var c=URL.createObjectURL(a);s.src=c}))},t.embedCache={},t.imageCache={},t}(),k=n(1019),P=n(16),E=n(20),_=n(1202),j=n(6);n(1046);!function(t){t[t.NOT_READY=1]="NOT_READY",t[t.CUED=2]="CUED",t[t.PLAYING=3]="PLAYING",t[t.PAUSED=4]="PAUSED"}(o||(o={}));var x,T,D=n(297),L=(x=function(t,e){return(x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}x(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),M=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},R=new a.a("mattertag-media"),A=function(t){function e(e){var n=t.call(this,e)||this;return n.playerControls=null,n.handleClick=function(){n.props.mediaType===b.a.photo&&n.props.onClickImage&&n.props.onClickImage()},n.onPlayerLoaded=function(t){n.playerControls=t,t.play()},n.setupPlayerControls=function(t){var e=o.NOT_READY;try{t.on("ready",(function(){e=o.CUED,n.onPlayerLoaded(i)})),t.on("play",(function(){e=o.PLAYING})),t.on("pause",(function(){e=o.PAUSED})),t.on("ended",(function(){}))}catch(t){R.debug(t)}var r=Object(j.n)(),i={play:function(){if(t&&e!==o.NOT_READY&&!r)try{t.play()}catch(t){R.error(t)}},pause:function(){if(t&&e!==o.NOT_READY)try{t.pause()}catch(t){R.debug(t)}}}},n.setEmbedContentRef=function(t){t&&!n.iframe&&n.createEmbed(t)},n.setContainerRef=function(t){n.mediaContainer=t,n.updateMaxDims()},n.updateMaxDims=function(){if(n.mediaContainer&&n.props.mediaAspectRatio&&n.props.mediaType===b.a.video){var t=n.mediaContainer.getBoundingClientRect();n.setState({maxWidth:t.width,maxHeight:t.height})}},n.mediaStyles=function(){var t=n.props,e=t.width,o=t.height,r=t.mediaPayload,i=t.mediaType,a=t.mediaAspectRatio,s=n.state,c=s.maxWidth,l=s.maxHeight,u={};if(r)switch(i){case b.a.photo:u.backgroundImage='url("'+r.url+'")';case b.a.rich:void 0!==e&&(u.width=e+"px"),void 0!==o&&(u.height=o+"px","Instagram"===r.provider?u.height=o+54+"px":u.height=o+"px");break;case b.a.video:if(void 0!==e&&void 0!==o){var p=Object(D.a)(e,o);u.width=e+"px",u.height=p+"px"}else if(c&&l&&void 0!==a){var d=(p=Math.min(l,Object(D.a)(c,c/a)))*a;u.width=d+"px",u.height=p+"px"}}return u},n.state={maxWidth:0,maxHeight:0},n}return L(e,t),e.prototype.componentDidMount=function(){this.props.mediaAspectRatio&&this.props.mediaType===b.a.video&&(window.addEventListener("resize",this.updateMaxDims),this.updateMaxDims())},e.prototype.componentWillUnmount=function(){this.props.mediaAspectRatio&&this.props.mediaType===b.a.video&&window.removeEventListener("resize",this.updateMaxDims)},e.prototype.componentWillReceiveProps=function(t){t.mediaPayload!==this.props.mediaPayload&&this.iframe&&this.iframe.parentNode&&(this.iframe.parentNode.removeChild(this.iframe),this.iframe=null),this.playerControls&&this.props.closing!==t.closing&&(t.closing?this.playerControls.pause():this.playerControls.play())},e.prototype.createEmbed=function(t){var e=this,n=this.props,o=n.mediaType,r=n.mediaPayload,i=n.width,a=n.height,s=r.html,c=r.provider,l=r.src,u=document.createElement("div");u.innerHTML=s;var p=u.firstChild;if("iframe"!==p.tagName.toLowerCase()){if(!("srcdoc"in(p=document.createElement("iframe"))))return R.warn("Browser does not support srcdoc, refusing to embed "+s),void(this.iframe=null);void 0!==i&&(p.width=i.toString()),void 0!==a&&(p.height=a.toString()),p.setAttribute("allow","encrypted-media; autoplay; fullscreen"),p.classList.add("tag-iframe-sandbox","loading"),p.onload=function(){return p.classList.remove("loading")};var d=void 0;d="Flickr"===c&&void 0!==l?"<img src="+l+" />":s;var h=void 0,f=(h="Instagram"===c?"\n          <style>\n            html, body { padding: 0; margin: 0; border: 0; }\n            img { display: block; max-width: 100%; height: auto; border: 0; }\n            iframe { display: block; max-width: 100%; border: 0; }\n          </style>\n        ":"\n          <style>\n            html, body { padding: 0; margin: 0; border: 0; }\n            img, iframe { display: block; max-width: 100%; height: auto; border: 0; }\n          </style>\n        ").replace(/\s+/g," ");p.srcdoc="<!doctype html>"+f+d}else{(h=p.style).maxWidth="100%",h.maxHeight="100%",h.minWidth="",h.minHeight=""}if(o===b.a.video&&p.src)try{var g=new _.Player(p);p.addEventListener("load",(function(){return e.setupPlayerControls(g)}))}catch(t){R.error(t)}this.iframe=p,t.appendChild(p)},e.prototype.render=function(){var t=this.props,e=t.mediaPayload,n=t.mediaType;if(!e)return null;var o=i({"tag-image":n===b.a.photo,"tag-embed":n===b.a.rich,"tag-video":n===b.a.video}),a=e&&e.html?Object(r.h)("div",{class:"tag-embed-content",ref:this.setEmbedContentRef}):null;return Object(r.h)("div",{ref:this.setContainerRef,class:"tag-media-content",onClick:this.handleClick},Object(r.h)("div",{className:o,style:this.mediaStyles()},a))},e=M([f.b],e)}(r.Component),I=n(906),N=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};!function(t){t.htmlToString=function(i){var a,s,c="",l=[].slice.call(i.childNodes);try{for(var u=N(l),p=u.next();!p.done;p=u.next()){var d=p.value;switch(d.nodeName){case"#text":c+=e(d);break;case"A":c+=n(d);break;case"DIV":c+=o(d);break;case"BR":c+=r(d);break;default:c+=t.htmlToString(d)}}}catch(t){a={error:t}}finally{try{p&&!p.done&&(s=u.return)&&s.call(u)}finally{if(a)throw a.error}}return c},t.renderChunks=function(t,e){var n,o;try{for(var r=N(e),i=r.next();!i.done;i=r.next()){var a=i.value;switch(a.type){case b.a.text:var s=document.createTextNode(""+a.text);t.appendChild(s);break;case b.a.link:if(a.link){var c=document.createElement("a");c.className="tagLink",c.contentEditable="true",c.href=""+a.link.url,c.textContent=""+a.link.label,t.appendChild(c)}}}}catch(t){n={error:t}}finally{try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(n)throw n.error}}};var e=function(t){var e=(t.textContent||"").replace(/\]\(/g,"]&zwnj;("),n=new RegExp(/https?:\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u00a1-\uffff][a-z0-9\u00a1-\uffff_-]{0,62})?[a-z0-9\u00a1-\uffff]\.)+(?:[a-z\u00a1-\uffff]{2,}\.?))(?::\d{2,5})?(?:[/?#]\S*)?/gi);return(e=e.replace(n,(function(t){return"["+t+"]("+t+")"}))).replace(/\<\s*br\s*\/?>/gi,"\n")},n=function(t){return"["+t.innerText+"]("+t.href+")"},o=function(e){var n="\n";return e.childNodes.length>0&&(n+=t.htmlToString(e)),n},r=function(t){return"\n"}}(T||(T={}));var U,F=n(182),H=new RegExp("^(?:(?:(?:https?|ftp):)?\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z0-9\\u00a1-\\uffff][a-z0-9\\u00a1-\\uffff_-]{0,62})?[a-z0-9\\u00a1-\\uffff]\\.)+(?:[a-z\\u00a1-\\uffff]{2,}\\.?))(?::\\d{2,5})?(?:[/?#]\\S*)?$","i"),B=function(t){return function(t){return H.test(t)}(t)&&/^https?:\/\//.test(t)},W=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),V=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},G=function(t){function e(e){var n=t.call(this,e)||this;n.getInputDiv=function(){return n.inputDiv},n.hasTextSelected=function(){return n.range&&n.range.startOffset!==n.range.endOffset},n.onSelectionChange=function(){var t=n.getCurrentSelection();t&&(n.range=t.cloneRange())},n.addFauxHighlight=function(){n.execCommand("backColor","#ff315840")},n.removeFauxHighlight=function(){n.execCommand("backColor","transparent")},n.prepareLinkSelection=function(){var t=n.getAnchorFromSelection(),e=null,o=window.getSelection();return o&&(t||n.range?(n.addFauxHighlight(),t||(e=n.range?n.range.toString():o.toString())):(n.inputDiv.focus(),o.selectAllChildren(n.inputDiv),o.collapseToEnd(),n.range=o.getRangeAt(0),e=n.range.toString())),t||(e||"")},n.onMouseDown=function(t){t.stopPropagation(),n.removeFauxHighlight(),n.range=null},n.onKeyPress=function(t){var e=t.which||t.keyCode;if(t.stopPropagation(),e===P.a.ESCAPE)return n.props.onNavigationKey(t);if(e===P.a.RETURN||e===P.a.TAB)return t.shiftKey||(t.preventDefault(),n.finalizeInput()),n.props.onNavigationKey(t);if("keydown"!==t.type){var o=n.inputDiv.innerText;n.props.maxLength&&o&&o.length>n.props.maxLength&&t.preventDefault()}},n.onInput=function(){n.props.onInput(n.inputDiv.innerText)},n.onPaste=function(t){var e=(t.clipboardData||window.clipboardData).getData("text/plain"),o=e.length,r=n.inputDiv.innerText,i=window.getSelection();if(i&&n.props.maxLength&&r&&r.length+o>n.props.maxLength){var a=n.props.maxLength-n.inputDiv.innerText.length+i.toString().length;o=Math.min(a,o)}document.execCommand("insertText",!1,e.slice(0,o)),t.preventDefault()},n.onFocus=function(t){n.props.onFocus&&n.props.onFocus()},n.onBlur=function(){n.props.onBlur&&n.props.onBlur(),n.finalizeInput()},n.setInput=function(t){n.inputDiv=t};var o=new F.a((function(){return null}),(function(t){return document.addEventListener("selectionchange",t)}),(function(t){return document.removeEventListener("selectionchange",t)}));return n.selectionSubscription=o.createSubscription(n.onSelectionChange),n}return W(e,t),e.prototype.componentDidMount=function(){T.renderChunks(this.getInputDiv(),this.props.initialContent),this.attachLinks(),this.selectionSubscription.renew()},e.prototype.attachLinks=function(){var t,n;if(this.props.onLinkClick){var o=[].slice.call(this.inputDiv.querySelectorAll("a"));try{for(var r=V(o),i=r.next();!i.done;i=r.next()){var a=i.value;e.addLinkProperties(a,this.props.linkClass,this.props.onLinkClick)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}}},e.prototype.componentWillUnmount=function(){this.selectionSubscription.cancel()},e.prototype.shouldComponentUpdate=function(){return!1},e.prototype.getCurrentSelection=function(){var t=window.getSelection();if(t&&t.rangeCount>0){var e=t.getRangeAt(0);if(this.inputDiv===e.commonAncestorContainer||this.inputDiv.compareDocumentPosition(e.commonAncestorContainer)&Node.DOCUMENT_POSITION_CONTAINED_BY)return e}return null},e.prototype.linkify=function(t,n){this.execCommand("backColor","transparent"),this.execCommand("createLink",n);var o=this.getAnchorFromSelection();o&&(o.text=t,e.addLinkProperties(o,this.props.linkClass,this.props.onLinkClick))},e.prototype.unlink=function(t){var e=t.parentNode,n=t.textContent;e&&(e.removeChild(t),n&&!B(n)&&this.execCommand("insertText",n))},e.prototype.applyRange=function(){if(this.range){var t=window.getSelection();t&&(t.removeAllRanges(),t.addRange(this.range))}},e.prototype.execCommand=function(t,e){this.range&&(this.applyRange(),document.execCommand(t,!1,e),this.onSelectionChange())},e.addLinkProperties=function(t,e,n){e&&t.classList.add(e),n&&(t.onclick=n)},e.prototype.getAnchorFromSelection=function(){var t=this.getCurrentSelection();if(!t)return null;for(var e=t.commonAncestorContainer;e&&"A"!==e.nodeName;){if(e===this.inputDiv)return null;e=e.parentNode}return e||null},e.prototype.finalizeInput=function(){this.props.onFinalizeInput(),this.inputDiv.blur()},e.prototype.render=function(){return Object(r.h)("div",{ref:this.setInput,class:"inputDiv",placeholder:this.props.placeholder,onMouseDown:this.onMouseDown,onKeyDown:this.onKeyPress,onKeyPress:this.onKeyPress,onPaste:this.onPaste,contentEditable:!0,onInput:this.onInput,onFocus:this.onFocus,onBlur:this.onBlur})},e}(r.Component),z=n(285),K=n(374),Y=n(453),q=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),X=function(t){function e(e){var n=t.call(this,e)||this;return n.onEditedUrl=function(t){var e=n.state,o=e.validUrl,r=e.currentText;if(o){var i=""!==r?r:t;n.props.onSaveLink(i,t),n.setState({editingUrl:!1})}},n.onInputUrl=function(t){n.setState({validUrl:B(t),currentUrl:t})},n.onEditedText=function(t){n.setState({editingText:!1}),n.urlInput&&(n.setState({editingUrl:!0}),n.urlInput.focusInput())},n.onInputText=function(t){n.setState({currentText:t})},n.startEditingUrl=function(){n.setState({editingUrl:!0,editingText:!1})},n.startEditingText=function(){n.setState({editingUrl:!1,editingText:!0})},n.onApply=function(t){n.state.currentUrl&&n.onEditedUrl(n.state.currentUrl),n.setState({editingUrl:!1,editingText:!1})},n.onPreviewUrl=function(){n.state.validUrl&&window.open(n.state.currentUrl,"_blank")},n.stopPropagation=function(t){t.stopPropagation()},n.setUrlInputRef=function(t){n.urlInput=t},n.state={currentUrl:e.linkUrl,currentText:e.linkText,validUrl:!0,editingUrl:!1,editingText:!1},n}return q(e,t),e.prototype.componentWillReceiveProps=function(t){this.state.currentUrl!==t.linkUrl&&this.setState({currentUrl:t.linkUrl}),this.state.currentText!==t.linkText&&this.setState({currentText:t.linkText})},e.prototype.render=function(){var t=this.props,e=t.linkUrl,n=t.linkText,o=t.onCancel,i=this.state,a=i.validUrl,s=i.currentUrl,c=i.editingUrl,l=i.editingText;return Object(r.h)("div",{class:"editable-popover link-editor",onClick:this.stopPropagation},Object(r.h)(Y.a,{buttonStyle:Y.b.LIGHT,onClose:o}),Object(r.h)("div",{class:"text-field"},Object(r.h)("label",{class:"popover-label"},"Text"),Object(r.h)(I.a,{text:n,defaultText:"",onEdited:this.onEditedText,onInput:this.onInputText,onStartEditing:this.startEditingText,editing:l,autocapitalize:"none",suppressWindowScrollReset:!0})),Object(r.h)("div",{class:"text-field url-field"},Object(r.h)("label",{class:"popover-label"},"Link to"),Object(r.h)(I.a,{ref:this.setUrlInputRef,text:e,placeholder:"https://",defaultText:"",onEdited:this.onEditedUrl,onInput:this.onInputUrl,onStartEditing:this.startEditingUrl,editing:c,autocapitalize:"none",suppressWindowScrollReset:!0}),a&&s&&Object(r.h)(z.a,{appendClass:{"preview-link":!0},iconClass:"icon-ext-link",buttonStyle:z.b.CLEAR,tooltipMsg:"Preview Link",tooltipPosition:K.b.UP,onClick:this.onPreviewUrl})),this.renderButtons())},e.prototype.renderButtons=function(){var t=this.state,e=t.validUrl,n=t.currentUrl,o=this.props,a=o.onRemoveLink,s=o.existingLink,c=!n||!e;return Object(r.h)("div",{class:"popover-footer"},this.renderValidationMessage(),s&&Object(r.h)(z.a,{iconClass:"icon-delete",buttonStyle:z.b.CLEAR,tooltipMsg:"Remove Link",tooltipPosition:K.b.UP,onClick:a}),Object(r.h)("div",{class:i("link-btn popover-btn",{disabled:c}),onClick:this.onApply},"Apply"))},e.prototype.renderValidationMessage=function(){var t=this.props,e=t.textSelected,n=t.linkUrl,o=this.state,i=o.validUrl,a=o.currentUrl,s=!e&&""===n&&""===a;return!i&&a?Object(r.h)("div",{class:"popover-message popover-message-error"},"Invalid URL"):Object(r.h)("div",{class:"popover-message"},s&&"Tip: Turn text into a link by selecting the text in the description field before clicking 'Add Link'")},e}(r.Component),Z=n(404),J=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),$=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},Q=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},tt=function(t){function e(e){var n=t.call(this,e)||this;return n.initialDesc=[],n.linkElement=null,n.onLabelEdit=function(t){n.handleTextChange("label",t)},n.onLabelKeyPress=function(t){if(t.keyCode===P.a.ESCAPE)return n.props.onNavigationKey(t);if(t.stopPropagation(),t.keyCode===P.a.TAB){var e=n.editableDescription.getInputDiv();e&&e.focus()}return!1},n.onDescriptionInput=function(t){var e=t.length;n.closeLinkEditor(),n.props.onDescriptionInput(0===e),n.setState({descriptionLength:e})},n.onDescriptionEdited=function(){var t=n.editableDescription.getInputDiv();if(t){var e=T.htmlToString(t);n.handleTextChange("description",e)}},n.onLabelFocus=function(){n.closeLinkEditor(),n.props.onFocus()},n.onDescriptionFocus=function(){n.setState({editingDescription:!0}),n.props.onFocus()},n.onDescriptionBlur=function(){n.setState({editingDescription:!1}),n.context.engine.broadcast(new Z.a)},n.closeLinkEditor=function(){n.setState({linkUrl:"",linkText:""}),n.linkElement=null,n.props.onCloseLinkEditor(),n.context.engine.broadcast(new Z.a)},n.linkClicked=function(t){n.props.linkOpen?n.closeLinkEditor():(t.stopPropagation(),n.linkElement=t.target,n.setState({linkUrl:n.linkElement.href,linkText:n.linkElement.text}),n.props.onOpenLinkEditor())},n.onRemoveLink=function(){n.onSaveLink("","")},n.onSaveLink=function(t,e){n.props.linkOpen&&(n.linkElement?""!==e?(n.linkElement.href=e,n.linkElement.text=t):n.editableDescription.unlink(n.linkElement):n.editableDescription.linkify(t,e),n.closeLinkEditor(),n.onDescriptionEdited())},n.clickOnBackground=function(t){t.stopPropagation(),n.props.onFocus()},n.state={editingDescription:!1,descriptionLength:0,linkUrl:"",linkText:""},n}return J(e,t),e.prototype.componentWillMount=function(){this.initialDesc=this.props.parsedDescription,this.updateDescriptionLength(this.props.parsedDescription)},e.prototype.componentWillReceiveProps=function(t){t.description!==this.props.description&&this.updateDescriptionLength(t.parsedDescription)},e.prototype.componentDidUpdate=function(t,e){},e.prototype.prepareNewLinkSelection=function(){var t,e,n=this.editableDescription.prepareLinkSelection();"string"==typeof n?(this.linkElement=null,t="",e=n):(this.linkElement=n,t=n.href,e=n.text),this.setState({linkUrl:t,linkText:e})},e.prototype.updateDescriptionLength=function(t){var e,n,o=0;try{for(var r=Q(t),i=r.next();!i.done;i=r.next()){var a=i.value;a.link?o+=a.link.label.length:a.text&&(o+=a.text.length)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}this.setState({descriptionLength:o})},e.prototype.handleTextChange=function(t,e){var n;this.props.modifyMattertag(this.props.id,(n={},n[t]=e,n)).then(this.props.onEdited)},e.prototype.render=function(){var t=this,e=this.state,n=e.linkUrl,o=e.linkText,a=e.editingDescription,s=e.descriptionLength,c=this.props,l=c.label,u=c.linkOpen,p=c.onNavigationKey,d=c.existingLink,h=!(!this.editableDescription||!this.editableDescription.hasTextSelected()),f=s+"/1000";return Object(r.h)("div",{class:"editable-text-content",onClick:this.clickOnBackground},Object(r.h)("div",{class:"mattertag-label-editor"},Object(r.h)(I.a,{autofocus:!0,text:l,defaultText:"",placeholder:"Title",onEdited:this.onLabelEdit,onInput:this.onLabelEdit,onKeyPress:this.onLabelKeyPress,maxLength:60,closeOnFocusOut:!0,textarea:!0,fractionalCounter:!0,onStartEditing:this.onLabelFocus})),Object(r.h)("div",{class:"editable-tag-description"},Object(r.h)("div",{class:i("modifiable-text fractional-counter",{editing:a||u,empty:0===s}),"data-fractional-counter":f},Object(r.h)(G,{ref:function(e){return t.editableDescription=e},maxLength:1e3,placeholder:"Description",initialContent:this.initialDesc,onInput:this.onDescriptionInput,onFinalizeInput:this.onDescriptionEdited,onNavigationKey:p,linkClass:"tagLink",onLinkClick:this.linkClicked,onFocus:this.onDescriptionFocus,onBlur:this.onDescriptionBlur}))),u&&Object(r.h)(X,{textSelected:h,existingLink:d,linkUrl:n,linkText:o,onCancel:this.closeLinkEditor,onSaveLink:this.onSaveLink,onRemoveLink:this.onRemoveLink}))},e=$([f.a],e)}(r.Component),et=n(1098),nt=n(172),ot=n(21),rt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),it=function(t){function e(e){var n=t.call(this,e)||this;return n.setStemValue=function(t,e){void 0===e&&(e=!0);var o=e?Object(nt.a)(t):t;o!==n.props.stemHeight&&n.props.modifyMattertag(n.props.sid,{stemHeight:o}).then((function(){n.props.onEdited()}))},n.onClickReset=function(){n.slider&&(n.setStemValue(n.state.originalStemHeight,!1),n.slider.setValue(Object(nt.b)(n.state.originalStemHeight)))},n.onToggleStemVisibility=function(){n.props.modifyMattertag(n.props.sid,{stemVisible:!n.props.stemVisible}).then(n.props.onEdited)},n.stopPropagation=function(t){t.stopPropagation()},n.updateUnits=function(){n.setState({units:n.context.settings.tryGetProperty(ot.a.Units,ot.c.USFractional)})},n.formatStemHeight=function(t){return n.state.units===ot.c.USFractional?function(t){var e="";e+=Math.floor(t)+"'";var n=Math.floor(t%1*12);return n<10&&(e+="0"),e+=n+"''"}(t):Math.round(100*Object(nt.a)(t))/100+"m"},n.state={originalStemHeight:e.stemHeight,units:ot.c.USFractional},n}return rt(e,t),e.prototype.componentWillMount=function(){this.updateUnits()},e.prototype.componentDidMount=function(){this.slider.setValue(Object(nt.b)(this.props.stemHeight)),this.context.settings.onPropertyChanged(ot.a.Units,this.updateUnits)},e.prototype.componentWillUnmount=function(){this.context.settings.removeOnPropertyChanged(ot.a.Units,this.updateUnits)},e.prototype.render=function(){var t=this,e=this.props,n=e.stemVisible,o=e.stemHeight,a=this.state.originalStemHeight!==o;return Object(r.h)("div",{class:"editable-popover stem-popover",onClick:this.stopPropagation},Object(r.h)(et.b,{ref:function(e){return t.slider=e},discrete:!1,min:0,max:9,initialValue:Object(nt.b)(o),onInput:this.setStemValue,displayBounds:!0,width:150,formatNumbers:this.formatStemHeight,tooltipPosition:et.a.DOWN}),Object(r.h)("div",{class:i("link-btn","popover-btn","stem-slider-reset",{disabled:!a}),onClick:this.onClickReset},"Reset"),Object(r.h)("hr",null),Object(r.h)("div",{class:"stem-checkbox",onClick:this.onToggleStemVisibility},Object(r.h)("div",{class:i("checkbox icon-checkmark",{checked:n})}),Object(r.h)("div",{class:"checkbox-text"},"Show Stem")))},e}(r.Component),at=n(30),st=(n(1213),function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}()),ct=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},lt=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},ut=function(t){function e(e){var n=t.call(this,e)||this;return n.colorClickHandlerMap={},n.setupColorClickHandlers=function(){var t,e;try{for(var o=lt(n.props.colors),r=o.next();!r.done;r=o.next()){var i=r.value;n.colorClickHandlerMap[i]||(n.colorClickHandlerMap[i]=n.onColorChosen(i))}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}},n.onColorChosen=function(t){return function(){n.props.onColorPicked(t),n.setState({colorChosen:t})}},n.getColorSwatch=function(t){var e={backgroundColor:t},o=i({"color-swatch":!0,"icon-checkmark":!0,chosen:n.state.colorChosen===t});return Object(r.h)("div",{class:o,style:e,onClick:n.colorClickHandlerMap[t]})},n.getColorGrid=function(){for(var t=[],e=0;e<n.props.colors.length;){for(var o=[],i=0;i<n.props.columns;i++)o.push(n.getColorSwatch(n.props.colors[e])),e++;t.push(Object(r.h)("div",{class:"color-swatch-row"},o))}return t},n.state={colorChosen:n.props.defaultColor||""},n.setupColorClickHandlers(),n}return st(e,t),e.prototype.componentWillReceiveProps=function(t){Object(at.b)(t.colors,this.props.colors)&&this.setupColorClickHandlers(),t.defaultColor&&!this.state.colorChosen&&this.setState({colorChosen:t.defaultColor})},e.prototype.render=function(){return Object(r.h)("div",{class:"color-picker"},this.getColorGrid())},e=ct([f.b],e)}(r.Component),pt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),dt=["#d44441","#f44336","#e91e63","#f78da7","#9c4b92","#673ab7","#03687d","#03a9f4","#00bcd4","#417505","#51a868","#37d67a","#cddc39","#fbcd00","#ffac17","#ff6900","#abb8c3","#607d8b"],ht=function(t){function e(e){var n=t.call(this,e)||this;return n.handleColorPicked=function(t){n.props.modifyMattertag(n.props.sid,{color:t}).then(n.props.onEdited)},n.stopPropagation=function(t){t.stopPropagation()},n}return pt(e,t),e.prototype.render=function(){var t=this.props.color;return Object(r.h)("div",{class:"editable-popover color-editor",onClick:this.stopPropagation},Object(r.h)(ut,{colors:dt,columns:6,defaultColor:t,onColorPicked:this.handleColorPicked}))},e}(r.Component),ft=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),gt=function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function a(t){try{c(o.next(t))}catch(t){i(t)}}function s(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){t.done?r(t.value):new n((function(e){e(t.value)})).then(a,s)}c((o=o.apply(t,e||[])).next())}))},bt=function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};!function(t){t[t.NONE=0]="NONE",t[t.INVALID_URL_SYNTAX=1]="INVALID_URL_SYNTAX",t[t.LOADING=2]="LOADING",t[t.LOADED=3]="LOADED",t[t.ERROR=4]="ERROR"}(U||(U={}));var vt,yt=function(t){function e(e){var n=t.call(this,e)||this;return n.onInput=function(t){var e=B(t)?U.NONE:U.INVALID_URL_SYNTAX;n.setState({validationPhase:e,currentUrl:t})},n.onApply=function(t){t.target.classList.contains("disabled")||n.onChangeMedia(n.state.currentUrl)},n.stopPropagation=function(t){t.stopPropagation()},n.onChangeMedia=function(t){return gt(n,void 0,void 0,(function(){var e,n,o,r,i;return bt(this,(function(a){switch(a.label){case 0:return e=this.props,n=e.sid,o=e.mediaSrc,r=e.onEdited,t===o?[3,4]:[4,this.loadMedia(t)];case 1:return(i=a.sent())===b.a.error?[3,3]:[4,this.props.modifyMattertag(n,{mediaSrc:t,mediaType:i})];case 2:return a.sent(),this.setState({validationPhase:U.LOADED}),r(),[3,4];case 3:this.setState({validationPhase:U.ERROR}),a.label=4;case 4:return[2]}}))}))},n.loadMedia=function(t){return gt(n,void 0,void 0,(function(){var e;return bt(this,(function(n){switch(n.label){case 0:return e=b.a.none,this.setState({validationPhase:U.NONE}),t?(this.setState({validationPhase:U.LOADING}),[4,this.props.embedlyValidator.getType(t)]):[3,2];case 1:e=n.sent(),n.label=2;case 2:return[2,e]}}))}))},n.state={currentUrl:e.mediaSrc,validationPhase:n.getInitialValidationPhase()},n}return ft(e,t),e.prototype.getInitialValidationPhase=function(){return this.props.mediaType===b.a.error?U.ERROR:this.props.mediaSrc?U.LOADED:U.NONE},e.prototype.componentWillReceiveProps=function(t){this.state.currentUrl!==t.mediaSrc&&this.setState({currentUrl:t.mediaSrc})},e.prototype.render=function(){var t=this.props,n=t.mediaSrc,o=t.onCancel;return Object(r.h)("div",{class:"editable-popover media-popover",onClick:this.stopPropagation},Object(r.h)(Y.a,{buttonStyle:Y.b.LIGHT,onClose:o}),Object(r.h)("div",{class:"text-field"},Object(r.h)("label",{class:"popover-label"},"Media link",Object(r.h)("a",{class:"link",target:"_blank",href:e.supportPage},"See supported formats")),Object(r.h)(I.a,{text:n,placeholder:"https://",defaultText:"",onEdited:this.onChangeMedia,onInput:this.onInput,editing:!0,autocapitalize:"none"})),this.renderPopoverFooter())},e.prototype.renderPopoverFooter=function(){var t=this.props.mediaSrc,e=this.state,n=e.validationPhase,o=e.currentUrl,a=n===U.ERROR||n===U.LOADING||n===U.INVALID_URL_SYNTAX&&""!==o||o===t&&""===o;return Object(r.h)("div",{class:"popover-footer"},this.renderValidationMessage(),Object(r.h)("div",{class:i("link-btn popover-btn",{disabled:a}),onClick:this.onApply},"Apply"))},e.prototype.renderValidationMessage=function(){switch(this.state.validationPhase){case U.ERROR:return Object(r.h)("div",{class:"popover-message popover-message-error"},"Can't find media. Please check URL.",Object(r.h)("a",{class:"link",target:"_blank",href:e.supportPageIssues},"Help"));case U.LOADING:return Object(r.h)("div",{class:"popover-message"},"Looking up media...");case U.INVALID_URL_SYNTAX:if(""!==this.state.currentUrl)return Object(r.h)("div",{class:"popover-message popover-message-error"},"Invalid URL")}return Object(r.h)("div",{class:"popover-message"})},e.supportPage="https://support.matterport.com/hc/en-us/articles/115006363868",e.supportPageIssues="https://support.matterport.com/hc/en-us/articles/115006363868#issues",e}(r.Component),mt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ot=function(){return(Ot=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},wt=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},St=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};!function(t){t.COLOR="color",t.STEM="stem",t.MEDIA="media",t.LINK="text-link"}(vt||(vt={}));var Ct,kt=function(t){function e(e){var n=t.call(this,e)||this;n.getColorStyle=function(){var t=n.props.getSavedData().color;if(t)return"background-color: "+t},n.toggleVisibility=function(){var t=n.props,e=t.id,o=t.manager;n.closePopover();var r={visible:!n.state.currentValues.visible};o.modifyMattertag(e,r).then(n.onEdited)},n.onEdited=function(){var t=n.props.getSavedData();t&&n.setState({currentValues:t,tagEmpty:n.props.manager.isTagEmpty(n.props.id)})},n.onMediaEdited=function(){n.onEdited(),n.closePopover()},n.onMediaCancel=function(){n.closePopover()},n.cancelEdits=function(){n.props.manager.revertChanges()},n.doneEditing=function(){var t=n.props,e=t.manager,o=t.id;e.saveMattertag(o)},n.onAddLinkClicked=function(t){t.stopPropagation(),n.setState({existingLink:!1}),n.state.popover===vt.LINK?n.setPopover(vt.LINK,!1):n.state.linkCount<5&&(n.billboardText.prepareNewLinkSelection(),n.setPopover(vt.LINK,!0))},n.onOpenLinkEditor=function(){n.setState({existingLink:!0}),n.setPopover(vt.LINK,!0)},n.onCloseLinkEditor=function(){n.state.popover===vt.LINK&&n.setPopover(vt.LINK,!1)},n.onDescriptionInput=function(t){var e=n.props.getSavedData(),o=Object(E.e)(e.label)&&Object(E.e)(e.mediaSrc)&&t;n.updateLinkCount(n.props.parsedDescription),n.setState({tagEmpty:o})},n.onFocusTextEditor=function(){n.closePopover()},n.onNavigationKey=function(t){t.keyCode===P.a.ESCAPE&&n.cancelEdits()},n.billboardClick=function(t){t.stopPropagation(),n.closePopover()},n.closePopover=function(){null!==n.state.popover&&n.setPopover(n.state.popover,!1)},n.setBillboardTextRef=function(t){n.billboardText=t};var o=e.getSavedData();return n.state={popover:null,linkCount:0,currentValues:Ot({},o),tagEmpty:e.manager.isTagEmpty(e.id),existingLink:!1},n.clickColor=n.clickMenuIcon.bind(n,vt.COLOR),n.clickStem=n.clickMenuIcon.bind(n,vt.STEM),n.clickMedia=n.clickMenuIcon.bind(n,vt.MEDIA),n}return mt(e,t),e.prototype.componentDidMount=function(){this.context.analytics.track("workshop_gui",{gui_action:"mattertag_editor_opened"}),this.updateLinkCount(this.props.parsedDescription)},e.prototype.componentDidUpdate=function(t,e){var n=this.props.manager.dataMap.mattertagsViewData.toolState;e.tagEmpty&&!this.state.tagEmpty&&n===c.b.PLACED&&this.props.manager.dataMap.mattertagsViewData.setToolState(c.b.EDITING),this.updateLinkCount(this.props.parsedDescription)},e.prototype.setPopover=function(t,e){var n=this.state.popover;if(this.setState({popover:e?t:null}),t===vt.LINK||n===vt.LINK){var o=t===vt.LINK&&e;this.context.messageBus.broadcast(new u.f(o))}},e.prototype.updateLinkCount=function(t){var e,n,o=0;try{for(var r=St(t),i=r.next();!i.done;i=r.next()){i.value.link&&o++}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}this.setState({linkCount:o})},e.prototype.clickMenuIcon=function(t,e){e.stopPropagation(),this.setPopover(t,this.state.popover!==t)},e.prototype.render=function(){var t=this.state,e=t.tagEmpty,n=t.popover,o=this.props.fullSized,a=null!==n;return Object(r.h)("div",{class:i("editable-billboard-body",{"full-sized":o,"popover-open":a})},Object(r.h)("div",{class:"editable-billboard-content",onClick:this.billboardClick},this.renderTextContent(),this.renderMattertagMedia(),this.renderActivePopover()),Object(r.h)("div",{class:"billboard-footer",onClick:this.billboardClick},this.renderMenuItems(),Object(r.h)("div",{class:"billboard-cta"},Object(r.h)("span",{class:"link-btn mattertag-btn cancel-btn",onClick:this.cancelEdits},"Cancel"),Object(r.h)("span",{class:i("link-btn","mattertag-btn","done-btn",{disabled:e}),onClick:this.doneEditing},"Done"))))},e.prototype.renderActivePopover=function(){var t=this.props,e=t.id,n=t.manager,o=this.state,i=o.popover,a=o.currentValues,s=a.stemVisible,c=a.stemHeight,l=a.color,u=a.mediaSrc,p=a.mediaType;switch(i){case vt.STEM:return Object(r.h)(it,{sid:e,stemVisible:s,stemHeight:c,onEdited:this.onEdited,modifyMattertag:n.modifyMattertag});case vt.COLOR:return Object(r.h)(ht,{sid:e,color:l,onEdited:this.onEdited,modifyMattertag:n.modifyMattertag});case vt.MEDIA:return Object(r.h)(yt,{sid:e,mediaSrc:u,mediaType:p,embedlyValidator:this.props.embedlyValidator,onEdited:this.onMediaEdited,onCancel:this.onMediaCancel,modifyMattertag:n.modifyMattertag});default:return null}},e.prototype.renderMenuItems=function(){var t=this.props,e=t.manager,n=t.id,o=t.fullSized,a=this.state,s=a.popover,c=a.currentValues,l=a.linkCount,u=c.visible,p=e.isNewTag(n),d=s===vt.COLOR,h=s===vt.STEM,f=s===vt.MEDIA,g=s===vt.LINK,b=l<5,v=b?"Add link":"You can only add up to five links",y=o?K.b.UP:K.b.DOWN;return Object(r.h)("div",{class:"billboard-menu"},Object(r.h)("div",{class:i("billboard-menu-item","add-link",{enabled:b,active:g}),onClick:this.onAddLinkClicked,"data-balloon":g?null:v,"data-balloon-pos":y},Object(r.h)("span",{class:"icon-link"})),Object(r.h)("div",{class:i("billboard-menu-item","color",{active:d}),"data-balloon":d?null:"Color","data-balloon-pos":y,onClick:this.clickColor},Object(r.h)("span",{class:"icon editable-color-disc",style:this.getColorStyle()})),Object(r.h)("div",{class:i("billboard-menu-item","stem",{active:h}),"data-balloon":h?null:"Stem","data-balloon-pos":y,onClick:this.clickStem},Object(r.h)("span",{class:"icon icon-stem-height"})),Object(r.h)("div",{class:i("billboard-menu-item","media",{active:f}),"data-balloon":f?null:"Media","data-balloon-pos":y,onClick:this.clickMedia},Object(r.h)("span",{class:"icon icon-media-mix"})),!p&&Object(r.h)("div",{class:"billboard-menu-item","data-balloon":u?"Hide":"Show","data-balloon-pos":y,onClick:this.toggleVisibility},Object(r.h)("span",{class:i("icon",u?"icon-eye-hide":"icon-eye-show")})))},e.prototype.renderTextContent=function(){var t=this.state,e=t.popover,n=t.existingLink,o=this.props,i=o.id,a=o.label,s=o.parsedDescription,c=o.description,l=o.manager,u=e===vt.LINK;return Object(r.h)(tt,{id:i,ref:this.setBillboardTextRef,label:a,parsedDescription:s,description:c,existingLink:n,linkOpen:u,onOpenLinkEditor:this.onOpenLinkEditor,onCloseLinkEditor:this.onCloseLinkEditor,onDescriptionInput:this.onDescriptionInput,onNavigationKey:this.onNavigationKey,onFocus:this.onFocusTextEditor,onEdited:this.onEdited,modifyMattertag:l.modifyMattertag})},e.prototype.renderMattertagMedia=function(){var t=this.props,e=t.id,n=t.mediaType,o=t.closing,i=t.media,a=i.hasMedia,s=i.mediaPayload,c=t.mediaAspectRatio;return a?s?Object(r.h)(A,{key:e,mediaPayload:s,mediaType:n,mediaAspectRatio:c,closing:o}):Object(r.h)("div",{class:"loadingSpinner"},Object(r.h)("div",{class:"gui-spinner-icon"})):null},e=wt([f.b],e)}(r.Component),Pt=n(876),Et=n(367),_t=n(26),jt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),xt=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},Tt=function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function a(t){try{c(o.next(t))}catch(t){i(t)}}function s(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){t.done?r(t.value):new n((function(e){e(t.value)})).then(a,s)}c((o=o.apply(t,e||[])).next())}))},Dt=function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},Lt=new a.a("mattertag-description"),Mt=function(t){function e(e){var n=t.call(this,e)||this;return n.formatLink=function(t,e){return Rt(t,e,!1)},n.linkClicked=function(t){return function(e){if(e.preventDefault(),n.props.onLinkClick(t),void 0!==t.link)switch(t.link.type){case Et.a.NAVIGATION:n.props.navigationTagClicked(t);break;case Et.a.MODEL:window.location.replace(t.link.url);break;case Et.a.EXT_LINK:var o=1===n.embeddedlinks;o?window.requestAnimationFrame((function(){try{var e=window.open(t.link.url,"mattertagEmb");e&&e.focus()}catch(e){Lt.debug("Could not load the link within an iFrame! Error: "+e),window.open(t.link.url)}})):window.open(t.link.url),n.context.messageBus.broadcast(new u.d(t.link.url,o))}}},n}return jt(e,t),e.prototype.componentDidMount=function(){return Tt(this,void 0,void 0,(function(){var t;return Dt(this,(function(e){switch(e.label){case 0:return t=this,[4,this.context.market.waitForData(_t.a)];case 1:return t.settings=e.sent(),this.embeddedlinks=this.settings.tryGetProperty("emb",0),[2]}}))}))},e.prototype.render=function(){var t=this.props,e=t.description,n=t.parsedDescription,o=e;return n&&n.length>0&&(o=At(n,this.formatLink,this.linkClicked)),o?Object(r.h)("div",{className:"tag-description"},o):null},e=xt([f.b],e)}(r.Component),Rt=function(t,e,n){if(!t.link)return null;var o=t.link,i=o.type===Et.a.NAVIGATION?"Link to position within this model":"Link to external web site";return Object(r.h)("a",{className:"tagLink",contentEditable:n,href:o.url,onClick:e(t)},o.label,Object(r.h)("i",{class:"icon-ext-link",title:i}))},At=function(t,e,n){return t.map((function(t){switch(t.type){case b.a.link:if(t.link)return e(t,n);case b.a.text:return(t.text||"").replace("&zwnj;","")}return null}))},It=n(907),Nt=n(78),Ut=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ft=function(){return(Ft=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},Ht=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},Bt=k.m+3*k.o,Wt=6*k.a+Bt,Vt=3*k.a+k.o,Gt=function(t){function e(e){var n=t.call(this,e)||this;return n.state={height:null,descriptionHeight:0,scrollable:!1,determiningScrollability:!1,scrollClass:Nt.c.None},n.onScrollPositionChange=function(){if(n.scrollbars&&!n.state.determiningScrollability){var t=n.scrollbars.scrollPosition.vertical;n.setState({scrollClass:t})}},n}return Ut(e,t),e.prototype.componentWillReceiveProps=function(t){t.tagWidth!==this.props.tagWidth&&this.setState({height:null,scrollable:!0,determiningScrollability:!0})},e.prototype.componentDidMount=function(){this.determineScrollability()},e.prototype.componentDidUpdate=function(){this.state.determiningScrollability&&this.determineScrollability()},e.prototype.determineScrollability=function(){var t=this.textContainer&&this.textContainer.querySelector(".tag-description"),e={determiningScrollability:!1};if(this.props.description&&t){var n=this.props.mediaTag?Vt:Wt;if(t.scrollHeight>n+k.j){var o=this.textContainer&&this.textContainer.querySelector(".tag-label"),r=this.props.label?n+o.scrollHeight-k.o:n;e=Ft({},e,{height:r,scrollable:!0,scrollClass:Nt.c.Beginning})}else e=Ft({},e,{height:null,scrollable:!1,scrollClass:Nt.c.None})}this.setState(e)},e.prototype.render=function(){var t,e=this,n=this.props,o=n.label,a=n.description,s=n.parsedDescription,c=n.onLinkClick,l=n.navigationTagClicked;if(o||a||s){var u=i(((t={"tag-text-content":!0,noScroll:!this.state.height||!this.state.scrollable})[this.state.scrollClass]=!0,t));return Object(r.h)("div",{class:u,style:{height:this.state.scrollable&&this.state.height||"auto"},ref:function(t){e.textContainer=t}},Object(r.h)(It.a,{name:"mattertag-text-content",forceHidden:!1,waitToUpdate:this.state.determiningScrollability,singleScrollDirection:Nt.b.vertical,ref:function(t){return e.scrollbars=t},onScrollPositionChange:this.onScrollPositionChange},o&&Object(r.h)("div",{class:"tag-label",onClick:this.onBoundClick},Object(r.h)("span",null,o)),Object(r.h)(Mt,{description:a,parsedDescription:s,onLinkClick:c,navigationTagClicked:l})))}return null},e=Ht([f.b],e)}(r.Component),zt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Kt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return zt(e,t),e.prototype.shouldComponentUpdate=function(){return!1},e.prototype.componentDidMount=function(){this.base&&this.props.widget.frame.mount(this.base)},e.prototype.componentWillUnmount=function(){this.base&&this.props.widget.frame.unmount()},e.prototype.render=function(){var t=this.props.widget.size,e=t.width,n=t.height,o={};return e&&n&&(o.width=e+"px",o.height=n+"px"),Object(r.h)("div",{class:"custom-widget-container",style:o})},e}(r.Component),Yt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),qt=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},Xt=function(t){function e(e){var n=t.call(this,e)||this;return n.clickBillboard=function(){n.props.onClickBillboard()},n.onClickImage=function(){n.props.allowTagOverlay?n.props.onOpenOverlay():n.props.onClickBillboard()},n}return Yt(e,t),e.prototype.render=function(){var t=this.props,e=t.media,n=t.style,o=t.selected,a=t.allowTagOverlay,s=t.label,c=t.description,l=t.parsedDescription;return Object(r.h)("div",{class:i("billboard-body",{expandable:a}),onClick:this.clickBillboard},Object(r.h)("div",{className:"billboard-content",style:n.bodyStyle},Object(r.h)(Gt,{label:s,description:c,parsedDescription:l,tagWidth:n.width,imgHeight:n.height,mediaTag:e.hasMedia,onLinkClick:this.props.onLinkClick,navigationTagClicked:this.props.navigationTagClicked}),this.renderMattertagMedia(),this.renderCustomWidget()),!o&&Object(r.h)(Pt.a,{sendEvents:[Pt.a.SendEvent.BUTTON],className:"hover-arrow"}))},e.prototype.renderMattertagMedia=function(){var t=this.props,e=t.id,n=t.allowTagOverlay,o=t.mediaType,i=t.style,a=i.width,s=i.height,c=i.closing,l=t.media,u=l.hasMedia,p=l.mediaPayload;return u?p?Object(r.h)(A,{key:e,mediaPayload:p,mediaType:o,width:a,height:s,onClickImage:n?this.onClickImage:void 0,closing:c}):Object(r.h)("div",{class:"loadingSpinner"},Object(r.h)("div",{class:"gui-spinner-icon"})):null},e.prototype.renderCustomWidget=function(){if(this.props.customWidget)return Object(r.h)(Kt,{widget:this.props.customWidget})},e=qt([f.a],e)}(r.Component),Zt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Jt=function(){return(Jt=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},$t=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},Qt=k.j+k.m+k.o,te=function(t){function e(e){var n=t.call(this,e)||this;return n.toggleCollapseText=function(){n.setState((function(t){return{collapsed:!t.collapsed}}))},n.onScrollPositionChange=function(){if(n.scrollbars&&!n.state.determiningScrollability){var t=n.scrollbars.scrollPosition.vertical;n.setState({scrollClass:t})}},n.updateScrollAndCollapse=function(){var t=n.textContainer?n.textContainer.scrollHeight:0,e=n.textContainer&&n.textContainer.querySelector(".tag-description"),o={determiningScrollability:!1};if(t){var r=Math.max(t-Qt-n.state.overlayHeight,0),i=r>0,a=t-r,s=e&&e.scrollHeight-r,c=i?Nt.c.Beginning:Nt.c.None;o=Jt({},o,{height:a,scrollable:i,descriptionHeight:s,scrollClass:c,collapsible:e&&t>Qt})}n.setState(o)},n.updateOverlayDimensions=function(){var t=n.props,e=t.label,o=t.description,r=t.maxWidth,i=t.maxHeight,a=t.mediaAspectRatio,s=e||o?Qt:0,c=r-2*k.j,l=i-2*k.j-s,u=a<c/l;n.setState({overlayWidth:u?l*a:c,overlayHeight:u?l:c/a})},n.stopPropagation=function(t){t.stopPropagation()},n.state={overlayWidth:0,overlayHeight:0,collapsible:!!(e.description&&e.description.length>0),collapsed:!1,height:null,descriptionHeight:0,scrollable:!1,determiningScrollability:!1,scrollClass:Nt.c.None},n}return Zt(e,t),e.prototype.componentDidMount=function(){this.updateOverlayDimensions(),this.updateScrollAndCollapse()},e.prototype.componentDidUpdate=function(t,e){var n=this,o=t.mediaAspectRatio!==this.props.mediaAspectRatio,r=t.maxWidth!==this.props.maxWidth,i=t.maxHeight!==this.props.maxHeight;(o||r||i)&&(this.setState({determiningScrollability:!0,scrollable:!1,scrollClass:Nt.c.None,height:0}),window.requestAnimationFrame((function(){n.updateOverlayDimensions(),n.updateScrollAndCollapse()})))},e.prototype.render=function(){var t=this.props,e=t.mediaPayload,n=t.mediaType,o=t.closing,a=this.state,s=a.overlayWidth,c=a.overlayHeight,l=a.collapsible;return Object(r.h)("div",{class:"billboard-body",onClick:this.stopPropagation},Object(r.h)("div",{className:i("billboard-content",{collapsible:l})},this.renderOverlayText(),Object(r.h)(A,{mediaPayload:e,mediaType:n,width:s,height:c,closing:o})))},e.prototype.renderOverlayText=function(){var t=this,e=this.props,n=e.label,o=e.description,a=e.parsedDescription,s=e.onLinkClick,c=e.navigationTagClicked,l=e.closeImageOverlay,u=this.state,p=u.collapsible,d=u.collapsed,h=u.descriptionHeight,f=u.scrollable,g=u.height,b=u.determiningScrollability,v=u.scrollClass,y=b||d?void 0:{maxHeight:g+"px"},m={};return o&&g&&f&&(m.height=h+"px",m.overflow="hidden"),Object(r.h)("div",{class:i("tag-text-content",{collapsed:d,noScroll:!g||!f}),style:y,ref:function(e){t.textContainer=e}},n&&Object(r.h)("div",{class:"tag-label",onClick:this.toggleCollapseText},Object(r.h)("div",{class:"labelText"},n)),o&&Object(r.h)("div",{style:m,class:i(v,"wrappedDesc")},Object(r.h)(It.a,{name:"mattertag-overlay-text",forceHidden:!1,waitToUpdate:b,singleScrollDirection:Nt.b.vertical,ref:function(e){return t.scrollbars=e},onScrollPositionChange:this.onScrollPositionChange},Object(r.h)("div",null,Object(r.h)(Mt,{description:o,parsedDescription:a,onLinkClick:s,navigationTagClicked:c})))),Object(r.h)("div",{class:"buttons"},p&&Object(r.h)(z.a,{appendClass:{"tag-button":!0,"tag-collapse-button":!0},iconClass:"icon-dpad-down",onClick:this.toggleCollapseText}),Object(r.h)(z.a,{appendClass:{"tag-button":!0},iconClass:"icon-close",onClick:l})))},e=$t([f.b],e)}(r.Component),ee=n(93),ne=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),oe=function(){return(oe=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},re=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},ie=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(t){r={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},ae=new a.a("billboard");!function(t){t[t.NOT_LOADED=0]="NOT_LOADED",t[t.LOADING=1]="LOADING",t[t.LOADED=2]="LOADED",t[t.FAILED=3]="FAILED",t[t.ENABLED=4]="ENABLED"}(Ct||(Ct={}));var se=function(t){function e(e,o){var r=t.call(this,e)||this;r.linkCount=0,r.linksClicked=[],r.updateForPopover=function(t){r.setState({expanded:t.expanded})},r.getSavedData=function(){var t=r.props.tag,e=t.label,n=t.description,o=t.mediaSrc,i=t.mediaType,a=t.stemVisible,s=t.enabled,c=r.props.view,l=c.stemHeight;return{visible:s,color:c.color,label:e,description:n,stemHeight:l,mediaSrc:o,mediaType:i,stemVisible:a}},r.updateBillboardSize=function(){var t=r.state,e=t.mediaWidth,n=t.mediaHeight,o=r.props.tag;if(r.adjustSizing(),o.mediaType===b.a.photo||o.mediaType===b.a.rich||o.mediaType===b.a.video){var i=r.getDimensionsForMedia(o.mediaType,e,n);r.setState(oe({},i))}},r.closeImageOverlay=function(){var t=r.props,e=t.overlay,n=t.toggleImageOverlay,o=t.tag;e&&n(o.sid,!1)},r.onOpenOverlay=function(){var t=r.props,e=t.toggleImageOverlay,n=t.allowTagOverlay,o=t.tag;n&&e(o.sid,!0)},r.onBillboardClicked=function(){var t=r.props,e=t.manager,n=t.toolOpen,o=t.tag,i=t.selected;n&&e&&!i&&e.selectMattertag(o.sid)},r.setBillboardRef=function(t){r.billboardRef=t},r.updateTagDirection=function(){var t,e=r.state.direction,o=r.props,i=o.getTagContainer,a=o.tag,s=r.props.view,c=s.navigating,l=s.navigatingPosition,u=s.position,p=s.onTagDirectionChanged,d=i(),h=ie([d.offsetWidth,d.offsetHeight],2),f=h[0],g=h[1];(t=c&&l?n.getTagDirection(l.x,l.y,f,g):u?n.getTagDirection(u.x,u.y,f,g):n.getTagDirection(0,0,f,g))!==e&&(p(a.sid,t),r.setState({direction:t}))},r.onLinkClick=function(t){if(void 0!==t.link){-1===r.linksClicked.indexOf(t.link)&&r.linksClicked.push(t.link);var e=t.link.type;r.linkCount++,r.context.analytics.track("click_mattertag_link",{link_type:e,link_count:r.linkCount,links_clicked:r.linksClicked.length})}};var i=r.getDimensionsForMedia(e.tag.mediaType,1024,1024);r.embedly=new C(o.settings.getProperty(ee.a)),r.state={width:i.width,height:190,fullSized:!1,expanded:!1,mediaWidth:0,mediaHeight:0,mediaPayload:null,landscape:!1,active:!1,mediaLoadingState:e.mediaEnabled?Ct.NOT_LOADED:Ct.ENABLED,savedData:r.getSavedData(),direction:void 0};var a=e.tag,s=new F.a((function(){}),(function(t){a.onPropertyChanged("mediaSrc",t),a.onPropertyChanged("mediaType",t)}),(function(t){a.removeOnPropertyChanged("mediaSrc",t),a.removeOnPropertyChanged("mediaType",t)}));return r.tagOnChangedSub=s.createSubscription((function(){r.loadMedia(!0)}),!1),r.updateTagDirection(),r}var n;return ne(e,t),n=e,e.prototype.componentDidMount=function(){var t=this.props,e=t.view,n=t.manager;this.loadMedia(),!e.located||e.navigating&&!e.navigatingPosition||this.setState({active:!0}),window.addEventListener("resize",this.updateBillboardSize),n&&this.context.messageBus.subscribe(u.f,this.updateForPopover),this.adjustSizing(),this.tagOnChangedSub.renew()},e.prototype.componentWillUnmount=function(){this.tagOnChangedSub.cancel(),this.props.manager&&this.context.messageBus.unsubscribe(u.f,this.updateForPopover),this.state.fullSized&&this.context.messageBus.broadcast(new u.b(!1)),window.removeEventListener("resize",this.updateBillboardSize)},e.prototype.componentDidUpdate=function(t,e){var n=this.props,o=n.editing,r=n.tag,i=n.view,a=n.overlay,s=this.state.active;if(o===t.editing&&a===t.overlay||this.updateBillboardSize(),i.closeTheTag||r&&r.mediaSrc!==t.tag.mediaSrc&&this.loadMedia(!0),s||t.view.navigatingPosition===i.navigatingPosition||this.updateTagDirection(),i.closeTheTag)s&&this.setState({active:!1});else if(s||!i.located||i.navigating&&!i.navigatingPosition||this.setState({active:!0}),o&&(!t.editing||null===this.state.savedData)){var c=this.getSavedData();c&&this.setState({savedData:c})}},e.prototype.loadMedia=function(t){var e=this;void 0===t&&(t=!1);var o=this.props.tag,r=o.mediaType,i=o.mediaSrc,a=this.state.mediaLoadingState;if(n.isMediaTag(r)&&(t||![Ct.LOADING,Ct.FAILED,Ct.ENABLED].includes(a)))return this.setState({mediaLoadingState:Ct.LOADING}),this.embedly.getMediaDetails(r,i).then((function(t){if(t&&e.billboardRef){var n=e.getDimensionsForMedia(r,t.width,t.height);e.setState(oe({},n,{mediaWidth:t.width,mediaHeight:t.height,mediaPayload:t.embedlyResponse,mediaLoadingState:Ct.LOADED}))}})).catch((function(t){if(ae.debug(t),e.billboardRef){var n=e.getDimensionsForMedia(b.a.text,1024,1024);e.setState(oe({},n,{mediaLoadingState:Ct.FAILED}))}}))},e.prototype.adjustSizing=function(){var t=this.props.editing&&(window.innerWidth<=k.i||window.innerHeight<=k.h);t!==this.state.fullSized&&(this.context.messageBus.broadcast(new u.b(t)),this.setState({fullSized:t}))},e.prototype.getDimensionsForMedia=function(t,e,n){if(t===b.a.text||t===b.a.none||t===b.a.error)return{width:k.n-k.j,height:0,landscape:!1};var o=this.props,r=o.getTagContainer,i=o.editing,a=o.overlay,s=e,c=n,l=Math.max(e,1)/Math.max(n,1),u=r();if(u)if(a)s=u.offsetWidth,c=u.offsetHeight;else{var p=t===b.a.photo,d=void 0;d=i?p?k.c:k.b:k.p;var h=u.offsetWidth-k.k,f=u.offsetHeight-d;(c=(s=p?l>1?Math.max(Math.min(e,k.e,h),k.n):Math.max(Math.min(e,k.f),k.l):Math.max(Math.min(e,k.d,h),k.n))/l)>f&&(s=(c=f)*l)}return{width:s,height:c,landscape:l>1}},e.prototype.render=function(){var t=this.props,e=t.overlay,o=t.editing,a=t.view,s=t.tag,c=a.closeTheTag,l=s.sid,u=s.mediaType,p=s.label,d=s.description,h=this.state,f=h.landscape,g=h.mediaLoadingState,v=h.active,y=h.direction,m=h.fullSized,O=h.expanded,w=n.isMediaTag(u)&&g!==Ct.FAILED&&g!==Ct.ENABLED,S=g===Ct.LOADING&&u===b.a.photo,C=o||e?void 0:this.getTagPositionStyle(),k=o||e?void 0:"tag"+y.trim().replace(/([A-Z])/g,"-$1").replace(/[-_\s]+/g,"-").toLowerCase(),P=this.isImageTag(),E=w&&u===b.a.video,_=w&&(u===b.a.rich||S),j=E||_||P,x=p.length>0||d.length>0;return Object(r.h)("div",{className:i("tag-position",{"billboard-standard-view":!o&&!e,"billboard-overlay":e,"billboard-editing":o,"media-only-mattertag":!x&&j,"media-mattertag":j,"video-mattertag":E,"embed-mattertag":_,"image-mattertag":P,"full-sized":m,"popover-expanded":O}),key:l,style:C},Object(r.h)("div",{className:i("tag-wrapper",{active:!c&&v})},Object(r.h)("div",{ref:this.setBillboardRef,className:i("tag-container",[k],{"media-landscape":j&&f,"media-portrait":j&&!f}),onClick:this.closeImageOverlay},this.renderBillboard(w))))},e.prototype.renderBillboard=function(t){var e=this.state,n=e.mediaPayload,o=e.width,i=e.height,a=e.savedData,s=e.fullSized,c=e.mediaWidth,l=e.mediaHeight,u=this.props,p=u.onNavigationLinkClicked,d=u.overlay,h=u.selected,f=u.view,g=u.tag,b=u.allowTagOverlay,v=l>0?c/l:void 0;if(d&&v){var y=g.label,m=g.description,O=g.parsedDescription,w=g.mediaType;return Object(r.h)(te,{label:y,description:m,parsedDescription:O,mediaPayload:n,mediaType:w,maxWidth:o,maxHeight:i,mediaAspectRatio:v,closing:f.closeTheTag,closeImageOverlay:this.closeImageOverlay,onLinkClick:this.onLinkClick,navigationTagClicked:p})}var S=g.sid,C={mediaPayload:n,hasMedia:t},k=t&&!n?{width:o+"px"}:{},P=this.props,E=P.editing,_=P.manager;if(E&&_)return Object(r.h)(kt,{id:S,getSavedData:this.getSavedData,manager:_,fullSized:s,mediaAspectRatio:v,media:C,mediaType:g.mediaType,closing:f.closeTheTag,label:g.label,parsedDescription:g.parsedDescription,description:g.description,originalValues:a,embedlyValidator:this.embedly,onLinkClick:this.onLinkClick,navigationTagClicked:p});var j={width:o,height:i,bodyStyle:k,closing:f.closeTheTag};return Object(r.h)(Xt,{id:S,allowTagOverlay:b,selected:h,style:j,onClickBillboard:this.onBillboardClicked,onOpenOverlay:this.onOpenOverlay,onLinkClick:this.onLinkClick,navigationTagClicked:p,media:C,mediaType:g.mediaType,mediaSrc:g.mediaSrc,label:g.label,parsedDescription:g.parsedDescription,description:g.description,customWidget:g.widgetFrame})},e.prototype.isImageTag=function(){var t=this.props.tag;return this.state.mediaLoadingState!==Ct.FAILED&&this.state.mediaLoadingState!==Ct.ENABLED&&t.mediaType===b.a.photo},e.prototype.getTagPositionStyle=function(){var t=this.props.view;if(t.located){var e=t.position;return{transform:"translate("+(e?e.x:0)+"px, "+(e?e.y:0)+"px)"}}return{pointerEvents:"none",visibility:"hidden"}},e.isMediaTag=function(t){return t===b.a.photo||t===b.a.video||t===b.a.rich},e.getTagDirection=function(t,e,n,o){var r,i=1-(t+1)/(n=n||window.innerWidth)*2,a=1-(e+1)/(o=o||window.innerHeight)*2,s=a<-.2?0:a<.2?1:2,l=i<-.2?2:i<.2?1:0,u=Math.max(t,n-t);return r=0===l?1===s?c.d.RIGHT:0===s?c.d.RIGHT_UP:c.d.RIGHT_DOWN:2===l?1===s?c.d.LEFT:0===s?c.d.LEFT_UP:c.d.LEFT_DOWN:1===s&&u>k.n?i<0?c.d.RIGHT:c.d.LEFT:2===s?c.d.DOWN:c.d.UP,ae.debug("Selected "+r+" for ["+t+", "+e+"] in "+n+"x"+o+" ("+l+", "+s+")"),r},e=n=re([f.b],e)}(r.Component),ce=(se.getTagDirection,n(566)),le=n(107),ue=n(911);n.d(e,"a",(function(){return ge}));var pe=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),de=function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function a(t){try{c(o.next(t))}catch(t){i(t)}}function s(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){t.done?r(t.value):new n((function(e){e(t.value)})).then(a,s)}c((o=o.apply(t,e||[])).next())}))},he=function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},fe=new a.a("mattertag-ui"),ge=function(t){function e(e){var n=t.call(this,e)||this;return n.bindings=[],n.onUpdateSelectedTag=function(){return n.setState({selectedTag:n.mattertagsViewData.selectedTag})},n.onUpdateToolState=function(){return n.setState({toolState:n.mattertagsViewData.toolState})},n.onUpdateScreenPosition=function(){return n.setState({screenPosition:n.mattertagsViewData.screenPosition})},n.onUpdateProgress=function(){return n.setState({creationProgress:n.mattertagsViewData.progress})},n.onUpdateBillboards=function(){return n.setState({billboards:n.mattertagsViewData.activeBillboards.keys})},n.toggleImageOverlay=function(t,e){return de(n,void 0,void 0,(function(){var n;return he(this,(function(o){return!this.props.allowTagOverlay&&e?[2]:(this.setState({overlay:e}),this.props.toggleOpenModal&&this.props.toggleOpenModal(s.a.MATTERTAG,e),e?(this.context.messageBus.broadcast(new u.g(t,l.b.OVERLAY)),n=t!==this.state.selectedTag?h.b.FLY:h.b.INSTANT,this.context.commandBinder.issueCommand(new d.a(t,n))):this.closeBillboard(t),[2])}))}))},n.getTagContainer=function(){return n.tagsRoot},n.onNavigationLinkClicked=function(t){n.context.commandBinder.issueCommand(new ce.a(t))},n.setState({billboards:[],selectedTag:null,overlay:!1,toolState:c.b.IDLE,creationProgress:0,screenPosition:null}),n}return pe(e,t),e.prototype.componentDidMount=function(){return de(this,void 0,void 0,(function(){var t,e,n,o;return he(this,(function(r){switch(r.label){case 0:return this.props.manager?(this.mattertagsData=this.props.manager.dataMap.mattertagsData,this.mattertagsViewData=this.props.manager.dataMap.mattertagsViewData,this.settingsData=this.props.manager.dataMap.settingsData,[3,6]):[3,1];case 1:return r.trys.push([1,5,,6]),t=this,[4,this.context.market.waitForData(le.a)];case 2:return t.mattertagsData=r.sent(),e=this,[4,this.context.market.waitForData(c.c)];case 3:return e.mattertagsViewData=r.sent(),n=this,[4,this.context.market.waitForData(_t.a)];case 4:return n.settingsData=r.sent(),[3,6];case 5:return o=r.sent(),fe.debug(o),[3,6];case 6:return this.bindings.push(this.mattertagsViewData.onSelectedTagChanged(this.onUpdateSelectedTag),this.mattertagsViewData.onChanged(this.onUpdateBillboards)),this.props.manager&&this.bindings.push(this.mattertagsViewData.onToolStateChanged(this.onUpdateToolState),this.mattertagsViewData.onScreenPositionChanged(this.onUpdateScreenPosition),this.mattertagsViewData.onProgressChanged(this.onUpdateProgress)),this.bindings.forEach((function(t){t.renew()})),this.setState({selectedTag:this.mattertagsViewData.selectedTag,toolState:this.mattertagsViewData.toolState,screenPosition:this.mattertagsViewData.screenPosition,creationProgress:this.mattertagsViewData.progress,billboards:this.mattertagsViewData.activeBillboards.keys}),[2]}}))}))},e.prototype.componentWillUnmount=function(){this.bindings.forEach((function(t){t.cancel()}))},e.prototype.componentDidUpdate=function(t){var e=this.props,n=e.allowTagOverlay,o=e.manager,r=e.toolOpen;if(o&&(n!==t.allowTagOverlay||r!==t.toolOpen)){var i=o.dataMap.mattertagsViewData.openTag;i&&(this.state.overlay?n||this.toggleImageOverlay(i,!1):this.closeBillboard(i))}},e.prototype.closeBillboard=function(t){this.context.commandBinder.issueCommand(new p.a(t))},e.prototype.renderBillboards=function(){var t=this,e=this.state,n=e.overlay,o=e.selectedTag,i=e.toolState,a=e.billboards,s=this.props,l=s.toolOpen,u=s.manager,p=s.allowTagOverlay,d=[],h=i===c.b.CREATING||i===c.b.PRESSING||i===c.b.PLACING,f=!(!l||i!==c.b.EDITING&&i!==c.b.PLACED);return h||a.forEach((function(e){var i=o===e,a=f&&i,s=t.mattertagsViewData.getViewData(e),c=t.mattertagsData.getTag(e),h=a||0===t.settingsData.tryGetProperty("mls",0);!c||s.closeTheTag&&a||d.push(Object(r.h)(se,{key:"billboard-"+e,editing:a,selected:i,overlay:n,allowTagOverlay:p,toolOpen:l,view:s,tag:c,manager:u,mediaEnabled:h,toggleImageOverlay:t.toggleImageOverlay,onNavigationLinkClicked:t.onNavigationLinkClicked,getTagContainer:t.getTagContainer}))})),d},e.prototype.renderProgressCircle=function(){var t=this.props.mobile,n=this.state,o=n.creationProgress,a=n.screenPosition;if(!(n.toolState===c.b.PRESSING&&o>0&&t)||!a)return null;var s={left:a.x-e.creationButtonRadius/2+"px",top:a.y-e.creationButtonRadius/2+"px"};return Object(r.h)("div",{class:"point-button-wrapper",style:s},Object(r.h)(ue.a,{appendClass:i({complete:1===o,reset:0===o}),progress:100*o,innerRadius:e.creationButtonRadius,barWidth:e.progressBarThickness},Object(r.h)("circle",{class:"point",cx:"0",cy:"0",r:"22",transform:"rotate(-90)",fill:"#fff"})))},e.prototype.render=function(){var t=this,e=this.props.toolOpen,n=this.state.toolState,o=!(!e||n!==c.b.EDITING&&n!==c.b.PLACED);return Object(r.h)("div",{className:i("overlay-layer","tags-layer",{"tag-editable":e,"tags-layer-editing":o}),ref:function(e){t.tagsRoot=e}},this.renderProgressCircle(),this.renderBillboards())},e.creationButtonRadius=132,e.progressBarThickness=8,e}(r.Component)},1170:function(t,e,n){"use strict";var o,r,i,a,s=n(11),c=n(105),l=n(150),u=n(162),p=n(135),d=n(461),h=n(911),f=n(329),g=n(106),b=n(285),v=n(374),y=n(21),m=n(87),O=n(1107),w=n(19),S=((o={})[w.a.CREATING]=!0,o[w.a.CONFIRMING_POINT]=!0,o),C=((r={})[w.a.IDLE]=!0,r[w.a.CREATING]=!0,r[w.a.CREATING_NEXT_POINT]=!0,r),k=((i={})[w.a.CREATING]=!0,i[w.a.CONFIRMING_POINT]=!0,(a={})[w.a.IDLE]=!0,a[w.a.CREATING]=!0,a[w.a.CREATING_NEXT_POINT]=!0,a),P=n(964),E=n(49);n.d(e,"a",(function(){return M}));var _,j=(_=function(t,e){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}_(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),x=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},T=function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function a(t){try{c(o.next(t))}catch(t){i(t)}}function s(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){t.done?r(t.value):new n((function(e){e(t.value)})).then(a,s)}c((o=o.apply(t,e||[])).next())}))},D=function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},L=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},M=function(t){function e(e,r){var i=t.call(this)||this;return i.bindings=[],i.propertiesToRefreshUi=[m.a.UnitType,m.a.MeasurementSnapping,m.a.MeasurementContinuousLines,"measurement-mode-add-tooltip","measurement-mode-desktop-help","measurement-mode-mobile-help"],i.onMeasurementModeDataChanged=function(){var t=i.measurementModeData,e=i.getSelectedGroup(),n=e?e.count:0,o=i.measurementModeData.phase,r=t.pressProgress>=.95?1:t.pressProgress;o===p.MeasuringPhase.CLOSED?(i.closeMeasurementHelpModal(),i.dismissAddTooltip()):o===p.MeasuringPhase.IDLE&&i.updateAddTooltipVisibility(),i.setState({phase:o,pressProgress:r,pointPosition:t.pointPosition,selectedNumPoints:n,selectedGroupIndex:t.selectedGroupIndex})},i.updatePerSettings=function(){var t=i.context.settings;i.setState({units:t.tryGetProperty(m.a.UnitType,y.c.Metric),snapping:t.tryGetProperty(m.a.MeasurementSnapping,!1),continuousLines:t.tryGetProperty(m.a.MeasurementContinuousLines,!1),addTooltipShown:t.tryGetProperty("measurement-mode-add-tooltip",!1),desktopHelpShown:t.tryGetProperty("measurement-mode-desktop-help",!1),mobileHelpShown:t.tryGetProperty("measurement-mode-mobile-help",!1)})},i.updateAddTooltipVisibility=function(){i.state.addTooltipShown||i.props.editMode||(i.setState({showAddTooltip:!0}),window.clearTimeout(i.startAddingTooltip),i.startAddingTooltip=window.setTimeout((function(){i.dismissAddTooltip()}),o.START_ADDING_TOOLTIP_TIMEOUT))},i.dismissAddTooltip=function(){i.setState({showAddTooltip:!1}),i.context.settings.setProperty("measurement-mode-add-tooltip",!0)},i.getOverlayComponents=function(){var t=i.props,e=t.mobile,n=t.editMode,o=t.openModal,r=i.state,a=r.units,c=r.mobileHelpShown,l=r.desktopHelpShown,u=o===P.a.MEASUREMENT_HELP,p=i.getSelectedGroup(),h=p?p.length:0,f=i.locale,y=f.closeString,m=f.helpString,w=n?"overlay-top-center":"overlay-bar overlay-top-bar",S=[Object(s.h)("div",{class:w},!n&&Object(s.h)("div",{class:"overlay-bar-filler"}),Object(s.h)("div",{class:"overlay-bar-center"},h>0&&Object(s.h)("div",{class:"overlay-info"},Object(d.a)(h,a))),!n&&Object(s.h)("div",{class:"overlay-bar-right"},Object(s.h)(b.a,{appendClass:{"measurement-help-btn":!0},buttonStyle:b.b.OVERLAY,iconClass:"icon-help",buttonState:u?g.c.ACTIVE:g.c.ENABLED,onClick:i.toggleHelpOpen,tooltipMsg:!u&&m||void 0,tooltipPosition:v.b.DOWN}),Object(s.h)(O.a,{ref:function(t){return i.measurementSettings=t},onToggle:i.settingsToggled}),Object(s.h)(b.a,{iconClass:"icon-close",buttonStyle:b.b.OVERLAY,tooltipMsg:y,tooltipPosition:v.b.DOWN,onClick:i.onCloseMeasurementTool})))];if(!l||!c){var C=e?i.getMobileHelp():i.getDesktopHelp();S.push(C)}return S},i.getMobileHelp=function(){var t,e,n=i.state.phase,o=i.locale.mobileHelp,r=o.pressHoldStart,a=o.pressHoldEnd,c=o.dragEdit;switch(n){case p.MeasuringPhase.CREATING_NEXT_POINT:t=Object(s.h)("div",{class:"icon icon-drag-edit"}),e=Object(s.h)("span",{class:"message"},a);break;case p.MeasuringPhase.EDITING:case p.MeasuringPhase.POINT_PLACED:t=Object(s.h)("div",{class:"icon icon-finger-drag"}),e=Object(s.h)("span",{class:"message"},c);break;case p.MeasuringPhase.CREATING:t=Object(s.h)("div",{class:"icon icon-press-hold"}),e=Object(s.h)("span",{class:"message"},r)}return Object(s.h)("div",{class:"overlay-message"},t,e)},i.getDesktopHelp=function(){var t,e,o=i.state,r=o.phase,a=o.selectedNumPoints,c=i.locale.desktopHelp,l=c.clickAnywhereString,u=c.escapeString;switch(r){case p.MeasuringPhase.CREATING:t=Object(s.h)("div",{class:"icon icon-draw-lines"}),e=Object(s.h)("span",{class:"message"},l);break;case p.MeasuringPhase.CREATING_NEXT_POINT:a>=3&&(t=Object(s.h)("div",{class:"escape-key"},Object(s.h)("img",{src:n(1215)})),e=Object(s.h)("span",{class:"message escape-message"},u))}return Object(s.h)("div",{class:"overlay-message"},t,e)},i.clickCTAButton=function(t){i.state.phase===p.MeasuringPhase.IDLE?i.onStartPointPlacement(t):i.onStopPointPlacement(t)},i.onDeleteMeasurement=function(t){t&&t.stopPropagation(),i.context.commandBinder.issueCommand(new u.c)},i.onStartPointPlacement=function(t){t&&t.stopPropagation(),i.context.commandBinder.issueCommand(new u.g),i.dismissAddTooltip()},i.onStopPointPlacement=function(t){t&&t.stopPropagation(),i.context.commandBinder.issueCommand(new u.i)},i.onCloseMeasurementTool=function(t){return T(i,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return t&&t.stopPropagation(),this.closeMeasurementHelpModal(),[4,this.context.commandBinder.issueCommand(new u.f(!1))];case 1:return e.sent(),this.measurementSettings&&this.measurementSettings.close(),this.dismissAddTooltip(),[2]}}))}))},i.settingsToggled=function(t,e){t.stopPropagation(),e&&i.closeMeasurementHelpModal()},i.toggleHelpOpen=function(t){var e=i.props,n=e.toggleOpenModal,o=e.openModal===P.a.MEASUREMENT_HELP;t.stopPropagation(),i.measurementSettings&&i.measurementSettings.close(),o||i.context.analytics.track("showcase_gui",{gui_action:"measure_mode_help_clicked"}),n&&n(P.a.MEASUREMENT_HELP,!o)},i.locale={startAddingString:r.locale.t(E.a.MEASUREMENT_START_ADDING),continuousLinesString:r.locale.t(E.a.MEASUREMENT_CONTINUOUS_LINES),snappingString:r.locale.t(E.a.MEASUREMENT_SNAPPING),unitsString:r.locale.t(E.a.MEASUREMENT_UNITS),imperialString:r.locale.t(E.a.MEASUREMENT_IMPERIAL),metricString:r.locale.t(E.a.MEASUREMENT_METRIC),desktopHelp:{clickAnywhereString:r.locale.t(E.a.MEASUREMENT_HELP_CLICK_ANYWHERE),escapeString:r.locale.t(E.a.MEASUREMENT_HELP_ESCAPE)},mobileHelp:{pressHoldStart:r.locale.t(E.a.MEASUREMENT_HELP_PRESS_START),dragEdit:r.locale.t(E.a.MEASUREMENT_HELP_DRAG_EDIT),pressHoldEnd:r.locale.t(E.a.MEASUREMENT_HELP_PRESS_END)},helpString:r.locale.t(E.a.HELP),closeString:r.locale.t(E.a.CLOSE)},i.state={units:y.c.Metric,snapping:!1,continuousLines:!1,phase:p.MeasuringPhase.CLOSED,selectedGroupIndex:-1,selectedNumPoints:0,pressProgress:0,pointPosition:null,showAddTooltip:!1,desktopHelpShown:!1,mobileHelpShown:!1,addTooltipShown:!1},i}var o;return j(e,t),o=e,e.prototype.componentDidMount=function(){return T(this,void 0,void 0,(function(){var t,e,n,o,r,i;return D(this,(function(a){switch(a.label){case 0:return n=this,[4,this.context.market.waitForData(p.MeasurementModeData)];case 1:n.measurementModeData=a.sent(),this.bindings.push(this.measurementModeData.onChanged(this.onMeasurementModeDataChanged));try{for(o=L(this.propertiesToRefreshUi),r=o.next();!r.done;r=o.next())i=r.value,this.bindings.push(this.context.settings.onPropertyChanged(i,this.updatePerSettings))}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return this.onMeasurementModeDataChanged(),this.updatePerSettings(),[2]}}))}))},e.prototype.componentWillUnmount=function(){var t,e;try{for(var n=L(this.bindings),o=n.next();!o.done;o=n.next()){o.value.cancel()}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},e.prototype.componentDidUpdate=function(){var t=this.props.mobile,e=this.state,n=e.continuousLines,o=e.selectedNumPoints;t?this.isCheckVisible()&&this.context.settings.setProperty("measurement-mode-mobile-help",!0):(n?o>3:2===o)&&this.context.settings.setProperty("measurement-mode-desktop-help",!0)},e.prototype.getSelectedGroup=function(){return this.measurementModeData?this.measurementModeData.selectedGroupInfo:null},e.prototype.renderProgressCircle=function(){var t=this.props.mobile,e=this.state,n=e.pressProgress,r=e.pointPosition,i=e.phase;if(!t||null===r||n<=0||!S[i])return null;var a={left:r.x-o.pointButtonRadius/2+"px",top:r.y-o.pointButtonRadius/2+"px"};return Object(s.h)("div",{class:"measurement-overlay"},Object(s.h)("div",{class:"point-button-wrapper",style:a},Object(s.h)(h.a,{appendClass:c({complete:1===n,reset:0===n}),progress:100*n,innerRadius:o.pointButtonRadius,barWidth:o.pressProgressBarThickness},Object(s.h)("circle",{class:"point",cx:"0",cy:"0",r:"22",transform:"rotate(-90)",fill:"#fff"}))))},e.prototype.render=function(){return Object(s.h)("div",{id:"measurement-mode-layer",class:"overlay"},this.getOverlayComponents(),this.renderProgressCircle(),this.renderOverlayCta())},e.prototype.hasCancelCta=function(){if(this.isCheckVisible())return!1;var t=this.state,e=t.phase,n=t.selectedNumPoints,o=e===p.MeasuringPhase.CREATING&&0===n,r=e===p.MeasuringPhase.CREATING_NEXT_POINT&&2===n;return o||r},e.prototype.isCheckVisible=function(){var t=this.state,e=t.phase,n=t.continuousLines;return this.isCompleteMeasurement()&&(n?e===p.MeasuringPhase.CREATING_NEXT_POINT:e===p.MeasuringPhase.CREATING)},e.prototype.isCompleteMeasurement=function(){var t=this.state,e=t.continuousLines,n=t.selectedNumPoints;return e?n>2:2===n},e.prototype.renderOverlayCta=function(){var t=this.locale.startAddingString,e=this.props,n=e.viewing360,o=e.mobile,r=this.state,i=r.phase,a=r.showAddTooltip,c=this.getSelectedGroup(),l=i===p.MeasuringPhase.EDITING,u=c&&c.count>0&&(o?!!C[i]:!!k[i])?g.c.ENABLED:g.c.DISABLED,d=this.isCheckVisible()?"icon-checkmark":"icon-plus",h=n||l?g.c.DISABLED:g.c.ENABLED,v={"overlay-cta-btn":!0,"overlay-cta-cancel":this.hasCancelCta()};return Object(s.h)("div",{class:"overlay-cta"},Object(s.h)(f.b,{appendClass:{"tooltip-simple-medium":!0},open:a,message:Object(s.h)("span",null,t),arrowPos:f.a.BOTTOM_CENTER}),Object(s.h)(b.a,{appendClass:v,iconClass:d,buttonStyle:b.b.PRIMARY,buttonState:h,onClick:this.clickCTAButton}),Object(s.h)(b.a,{appendClass:{"overlay-cta-button-outer":!0},buttonStyle:b.b.OVERLAY,iconClass:"icon-delete",buttonState:u,onClick:this.onDeleteMeasurement}))},e.prototype.closeMeasurementHelpModal=function(){var t=this.props,e=t.toggleOpenModal,n=t.openModal;e&&n===P.a.MEASUREMENT_HELP&&e(n,!1)},e.pointButtonRadius=132,e.pressProgressBarThickness=8,e.START_ADDING_TOOLTIP_TIMEOUT=5e3,e=o=x([l.b],e)}(s.Component)},1171:function(t,e,n){"use strict";var o,r=n(11),i=n(150),a=n(243),s=n(49),c=n(21),l=n(374),u=n(32),p=n(285),d=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onClick=function(){e.props.handleClick(e.viewmode,e.analyticsName,e.setPanoMode)},e.updateEnabled=function(){e.setState({enabled:e.enabled})},e}return d(e,t),Object.defineProperty(e.prototype,"tooltip",{get:function(){return this.context.locale.t(this.tooltipPhraseKey)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enabled",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.render=function(){var t;if(!this.enabled)return null;var e="mode-"+this.modeName;return Object(r.h)(p.a,{onClick:this.onClick,appendClass:(t={},t[e]=!0,t)},Object(r.h)(l.a,{content:this.tooltip,position:l.b.UP},Object(r.h)("span",{class:"icon icon-"+this.modeName})))},e}(r.Component),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.viewmode=u.b.DOLLHOUSE,e.analyticsName="click_dollhouse_mode_button",e.tooltipPhraseKey=s.a.VIEW_DOLLHOUSE,e.modeName="dollhouse",e}return d(e,t),e.prototype.componentDidMount=function(){this.context.settings.onPropertyChanged("dh",this.updateEnabled),this.context.settings.onPropertyChanged(c.a.Dollhouse,this.updateEnabled)},e.prototype.componentWillUnmount=function(){this.context.settings.removeOnPropertyChanged("dh",this.updateEnabled),this.context.settings.removeOnPropertyChanged(c.a.Dollhouse,this.updateEnabled)},Object.defineProperty(e.prototype,"enabled",{get:function(){var t=this.context.settings,e=t.checkUrlParam("dh",0,1),n=!t.tryGetProperty(c.a.Dollhouse,!1),o=e||n;return(this.props.forceEnable||!o)&&this.viewmode!==this.props.viewmode},enumerable:!0,configurable:!0}),e}(h),g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.viewmode=u.b.FLOORPLAN,e.analyticsName="click_floorplan_mode_button",e.tooltipPhraseKey=s.a.VIEW_FLOORPLAN,e.modeName="floorplan",e}return d(e,t),e.prototype.componentDidMount=function(){this.context.settings.onPropertyChanged("fp",this.updateEnabled),this.context.settings.onPropertyChanged(c.a.FloorPlan,this.updateEnabled)},e.prototype.componentWillUnmount=function(){this.context.settings.removeOnPropertyChanged("fp",this.updateEnabled),this.context.settings.removeOnPropertyChanged(c.a.FloorPlan,this.updateEnabled)},Object.defineProperty(e.prototype,"enabled",{get:function(){var t=this.context.settings,e=t.checkUrlParam("fp",0,1),n=!t.tryGetProperty(c.a.FloorPlan,!1),o=e||n;return(this.props.forceEnable||!o)&&this.viewmode!==this.props.viewmode},enumerable:!0,configurable:!0}),e}(h),b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.viewmode=u.b.INSIDE,e.setPanoMode=!0,e.analyticsName="click_inside_mode_button",e.tooltipPhraseKey=s.a.VIEW_INSIDE,e.modeName="panorama",e}return d(e,t),Object.defineProperty(e.prototype,"enabled",{get:function(){if(!this.props.allowMeshMode)return this.props.viewmode!==this.viewmode;var t=this.props.viewmode===this.viewmode&&this.props.panoMode!==this.setPanoMode,e=this.props.viewmode!==this.viewmode&&this.props.panoMode===this.setPanoMode;return t||e},enumerable:!0,configurable:!0}),e}(h),v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.viewmode=u.b.INSIDE,e.setPanoMode=!1,e.analyticsName="click_mesh_mode_button",e.tooltipPhraseKey=s.a.VIEW_INSIDE_MESH,e.modeName="mesh",e}return d(e,t),Object.defineProperty(e.prototype,"enabled",{get:function(){if(!this.props.allowMeshMode)return!1;var t=this.props.viewmode===this.viewmode&&this.props.panoMode!==this.setPanoMode,e=this.props.viewmode!==this.viewmode&&this.props.panoMode===this.setPanoMode;return t||e},enumerable:!0,configurable:!0}),e}(h),y=n(178),m=n(174),O=n(2),w=n(550),S=(n(1176),function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}()),C=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},k=function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function a(t){try{c(o.next(t))}catch(t){i(t)}}function s(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){t.done?r(t.value):new n((function(e){e(t.value)})).then(a,s)}c((o=o.apply(t,e||[])).next())}))},P=function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},E=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},_=new O.a("mode-controls"),j=function(t){function e(e){var n=t.call(this,e)||this;return n.bindings=[],n.onMeshDataUpdate=function(t){n.setState({panoMode:0===t.opacity.value})},n.changeMode=function(t,e,o){return k(n,void 0,void 0,(function(){var n;return P(this,(function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),t===this.props.viewmode?[3,3]:[4,this.context.commandBinder.issueCommand(new a.d)];case 1:return r.sent(),this.props.viewmode===u.b.TRANSITIONING||t===u.b.TRANSITIONING?[3,3]:(this.context.analytics.track("showcase_gui",{gui_action:e}),[4,this.context.commandBinder.issueCommand(new w.a({mode:t}))]);case 2:r.sent(),r.label=3;case 3:return[3,5];case 4:return n=r.sent(),_.debug(n),[3,5];case 5:return this.props.allModes&&void 0!==o&&this.state.panoMode!==o&&this.context.commandBinder.issueCommand(new y.a(o?0:1)),[2]}}))}))},n.state={panoMode:!0},n}return S(e,t),e.prototype.componentDidMount=function(){return k(this,void 0,void 0,(function(){var t=this;return P(this,(function(e){return this.context.market.waitForData(m.a).then((function(e){t.bindings.push(e.onChanged(t.onMeshDataUpdate)),t.onMeshDataUpdate(e)})),[2]}))}))},e.prototype.componentWillUnmount=function(){var t,e;try{for(var n=E(this.bindings),o=n.next();!o.done;o=n.next()){o.value.cancel()}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.bindings=[]},e.prototype.render=function(){var t=this.props,e=t.viewmode,n=t.allModes,o=this.state.panoMode;return Object(r.h)("div",{class:"mode-controls"},Object(r.h)(v,{viewmode:e,panoMode:o,handleClick:this.changeMode,allowMeshMode:n}),Object(r.h)(b,{viewmode:e,panoMode:o,handleClick:this.changeMode,allowMeshMode:n}),Object(r.h)(f,{viewmode:e,handleClick:this.changeMode,forceEnable:n}),Object(r.h)(g,{viewmode:e,handleClick:this.changeMode,forceEnable:n}))},e=C([i.b],e)}(r.Component);e.a=j},1172:function(t,e,n){"use strict";var o,r=n(11),i=n(32),a=n(35),s=n(243),c=n(1),l=n(17),u=n(909),p=n(1044),d=n(105),h=n(907),f=n(6),g=n(78),b=n(49),v=n(374),y=n(285),m=n(106),O=(n(1180),o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),w=function(t){function e(e){var n=t.call(this,e)||this;return n.floors=[],n.scrollbars=null,n.canClick=!1,n.newFloorIndex=null,n.mobile=Object(f.n)(),n.updateScrollCenter=function(t){void 0===t&&(t=n.props.currentFloor),n.floors.length<=5||n.scrollbars&&(n.newFloorIndex=null,n.scrollbars.setScrollCenter(n.floors[t]))},n.onScrollbarClick=function(){n.canClick=!0},n.onOutsideClick=function(t){n.toggleMenu(!1)},n.onIconClick=function(t){t.stopPropagation(),n.toggleMenu(),n.context.analytics.track("showcase_gui",{gui_action:"floor_controls"})},n.toggleMenu=function(t){void 0===t&&(t=void 0);var e=n.state.showMenu,o=void 0!==t?t:!e;e!==o&&(o?window.addEventListener("click",n.onOutsideClick):window.removeEventListener("click",n.onOutsideClick),n.setState({showMenu:o}))},n.onFloorClick=function(t){n.scrollbars&&!n.canClick||(t.stopPropagation(),n.toggleMenu(),n.props.handleClickFloor(t),n.context.analytics.track("showcase_gui",{gui_action:"floor_clicked"}))},n.setScrollbarRef=function(t){return n.scrollbars=t},n.state={showMenu:!1},n}return O(e,t),e.prototype.componentWillReceiveProps=function(t){this.props.currentFloor!==t.currentFloor&&(this.newFloorIndex=t.currentFloor)},e.prototype.componentDidUpdate=function(){null!==this.newFloorIndex&&this.updateScrollCenter(this.newFloorIndex)},e.prototype.getFloorMenu=function(){var t=this,e=this.props.floorNames.map((function(e,n){return Object(r.h)("div",{class:d("floor-button",{current:t.props.currentFloor===n}),key:String(n),ref:function(e){t.floors[n]=e},onClick:t.onFloorClick,"data-value":n},e||t.context.locale.t(b.a.FLOOR_NAME)+(n+1))})).reverse(),n=e.length>5,o=d("floor-menu-wrapper",{"faded-in":this.state.showMenu,scrollable:n});return n?Object(r.h)("div",{class:o},Object(r.h)(h.a,{name:"floor-menu-wrapper",forceHidden:this.mobile,ref:this.setScrollbarRef,singleScrollDirection:g.b.vertical,onScrollbarVisibilityChange:this.updateScrollCenter,handleClick:this.onScrollbarClick},e)):(this.scrollbars=null,Object(r.h)("div",{class:o},e))},e.prototype.render=function(){var t=this.props,e=t.visible,n=t.currentFloor;if(e){var o=this.state.showMenu,i=String(n+1).length>1,a=this.props.isAllFloors(n),s=a?"icon-floor-controls-all":"icon-floor-controls",c=this.context.locale.t(b.a.HELP_MORE_FLOORS_A),l=o?m.c.ACTIVE:m.c.ENABLED;return Object(r.h)(y.a,{buttonState:l,onClick:this.onIconClick,appendClass:{"floor-controls":!0}},this.getFloorMenu(),Object(r.h)(v.a,{content:c,position:v.b.UP,className:d("select-floor",{"tooltip-hidden":o,isAllFloors:a})},Object(r.h)("div",{class:d("floor-number",{twoDigit:i})},Object(r.h)("span",null,!a&&n+1)),Object(r.h)("span",{class:d("icon",s)})))}return Object(r.h)("div",{class:"floor-controls"})},e}(r.Component),S=n(2),C=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),k=function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function a(t){try{c(o.next(t))}catch(t){i(t)}}function s(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){t.done?r(t.value):new n((function(e){e(t.value)})).then(a,s)}c((o=o.apply(t,e||[])).next())}))},P=function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},E=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(t){r={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},_=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(E(arguments[e]));return t},j=new S.a("floor-controls"),x=function(t){function e(e){var n=t.call(this,e)||this;return n.originalFloors=[],n.handleClickFloor=function(t){return k(n,void 0,void 0,(function(){var e,n,o,r;return P(this,(function(i){switch(i.label){case 0:return i.trys.push([0,6,,7]),e=t.target,n=e.getAttribute("data-value"),o="string"==typeof n?parseFloat(n):-1,[4,this.context.commandBinder.issueCommand(new s.d)];case 1:return i.sent(),this.isAllFloors(o)?(this.context.analytics.track("showcase_gui",{gui_action:"click_toggle_all_floors_button"}),[4,this.context.commandBinder.issueCommand(new u.a({moveCamera:!0}))]):[3,3];case 2:return i.sent(),[3,5];case 3:return o===this.state.currentFloor?[3,5]:(this.context.analytics.track("showcase_gui",{gui_action:"click_floor_select_button"}),[4,this.context.commandBinder.issueCommand(new p.a({floorIndex:o,moveCamera:!0}))]);case 4:i.sent(),i.label=5;case 5:return[3,7];case 6:return r=i.sent(),j.debug(r),[3,7];case 7:return[2]}}))}))},n.isAllFloors=function(t){return!n.originalFloors[t]},n.setFloorNamesForMode=function(){var t=n.viewmodeData.currentMode!==c.a.Panorama?_(n.originalFloors,[n.viewData.getFloorName(-1)]):n.originalFloors;if(n.viewmodeData.currentMode!==n.state.currentMode)n.setState({floorNames:t,currentMode:n.viewmodeData.currentMode});else{var e=n.getFloorIndex(t.length);n.setState({floorNames:t,currentFloor:e})}},n.updateData=function(){n.state.floorNames===n.viewData.getFloorNames()&&n.state.currentFloor===n.viewData.currentFloor||(n.originalFloors=n.viewData.getFloorNames(),n.setFloorNamesForMode())},n.getFloorIndex=function(t){return n.viewData.currentFloor<0&&n.props.viewmode!==i.b.INSIDE?t-1:n.viewData.currentFloor},n.modeChanged=function(){n.setFloorNamesForMode()},n.state={visible:e.viewmode!==i.b.OUTSIDE,currentFloor:-2,floorNames:[],currentMode:null},n}return C(e,t),e.prototype.componentWillReceiveProps=function(t){t.viewmode!==this.props.viewmode&&this.setState({visible:t.viewmode!==i.b.OUTSIDE})},e.prototype.componentDidMount=function(){return k(this,void 0,void 0,(function(){var t,e,n;return P(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),t=this,[4,this.context.market.waitForData(l.a)];case 1:return t.viewmodeData=o.sent(),e=this,[4,this.context.market.waitForData(a.b)];case 2:return e.viewData=o.sent(),this.changeSubscription=this.viewData.onChanged(this.updateData),this.modeChangeSub=this.viewmodeData.makeModeChangeSubscription(this.modeChanged),this.updateData(),this.modeChanged(),[3,4];case 3:return n=o.sent(),j.debug(n),[3,4];case 4:return[2]}}))}))},e.prototype.componentWillUnmount=function(){this.changeSubscription&&this.changeSubscription.cancel(),this.modeChangeSub&&this.modeChangeSub.cancel()},e.prototype.render=function(){return Object(r.h)(w,{visible:this.originalFloors.length>1&&this.state.visible,floorNames:this.state.floorNames,currentFloor:this.state.currentFloor,handleClickFloor:this.handleClickFloor,isAllFloors:this.isAllFloors})},e}(r.Component);e.a=x},1173:function(t,e,n){"use strict";var o,r=n(11),i=(n(1093),n(150)),a=n(1094),s=n(1095),c=n(1010),l=n(6),u=n(243),p=n(20),d=n(1096),h=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),f=function(t){function e(e){var n=t.call(this,e)||this;return n.highlights=[],n.highlightList=function(t){var e=n.props,o=e.currentStep,i=e.onHighlightClicked;return Object(r.h)("div",{class:"hlr-container"},Object(r.h)("div",{class:"highlights"},t.items.map((function(t,e){return Object(r.h)(d.a,{highlight:t,index:e,active:e===o,editable:!1,onClickHighlight:i,getRef:n.addHighlightRef})}))))},n.addHighlightRef=function(t,e){n.highlights[t]=e,t===n.props.currentStep&&n.props.setActiveElement&&n.props.setActiveElement(e)},n}return h(e,t),e.prototype.render=function(){var t=this.props.highlights;return t&&t.length?Object(r.h)(this.highlightList,{items:t}):null},e}(r.Component),g=n(2),b=n(21);n.d(e,"a",(function(){return C}));var v,y=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),m=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},O=function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function a(t){try{c(o.next(t))}catch(t){i(t)}}function s(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){t.done?r(t.value):new n((function(e){e(t.value)})).then(a,s)}c((o=o.apply(t,e||[])).next())}))},w=function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},S=new g.a("highlight-reel"),C=400;!function(t){t[t.flash=0]="flash",t[t.expanded=1]="expanded",t[t.collapsed=2]="collapsed"}(v||(v={}));var k=function(t){function e(e){var n=t.call(this,e)||this;return n.bindings=[],n.mobile=Object(l.n)(),n.showReel=function(){if(n.props.onToggleHLR&&n.props.highlights.length>0)switch(n.hlStartupStyle){case v.expanded:case v.flash:n.props.onToggleHLR(!0)}},n.setActiveElement=function(t){n.setState({activeElement:t})},n.setHighlightClickable=function(t){return n.highlightClickable=t}.bind(n),n.onHighlightClicked=function(t){return O(n,void 0,Promise,(function(){var e;return w(this,(function(n){switch(n.label){case 0:if(!this.highlightClickable)return[2];n.label=1;case 1:return n.trys.push([1,6,,7]),this.props.tourPlaying?[4,this.context.commandBinder.issueCommand(new u.d)]:[3,3];case 2:n.sent(),n.label=3;case 3:return this.props.transition.active?[3,5]:(this.context.analytics.track("showcase_gui",{gui_action:"click_highlight"}),[4,this.context.commandBinder.issueCommand(new u.c(t))]);case 4:n.sent(),this.setHighlightClickable(!1),n.label=5;case 5:return[3,7];case 6:return e=n.sent(),S.debug(e),[3,7];case 7:return[2]}}))}))},n.state={activeElement:null},n}return y(e,t),e.prototype.componentDidMount=function(){var t=this;if(this.props.briefHlr){var e=this.context.settings.tryGetProperty(b.a.HighlightReel,!0);if(!this.props.editMode&&this.props.totalSteps>0&&e){var n=this.props.highlights.some((function(t){return t.snapshot.is360}));this.hlStartupStyle=Object(l.A)("hl",n?1:0),this.hlStartupStyle===v.collapsed&&n&&(this.hlStartupStyle=v.expanded),Object(p.d)(100).then((function(){t.showReel(),Object(p.d)(3e3).then((function(){t.dismissReel(),t.props.onBriefHLR&&t.props.onBriefHLR()}))}))}}},e.prototype.componentWillUnmount=function(){this.bindings.forEach((function(t){t.cancel()}))},e.prototype.render=function(){var t=this.props,e=t.reelOpen,n=t.activeStep,o=t.highlights,i=t.totalSteps,l=i>0,u=l?Object(r.h)(f,{highlights:o,currentStep:n,onHighlightClicked:this.onHighlightClicked,setActiveElement:this.setActiveElement}):Object(r.h)(s.a,null);return Object(r.h)(c.a,{appendClass:{"highlight-reel":!0,"reel-viewing":l,"reel-empty":!l},open:e},Object(r.h)("div",{id:"reel-container"},Object(r.h)(a.a,{totalSteps:i,activeElement:this.state.activeElement,mobile:this.mobile,highlightClickable:this.setHighlightClickable,thumbScrollingOnly:!1},u)))},e.prototype.dismissReel=function(){this.props.onToggleHLR&&this.hlStartupStyle===v.flash&&this.props.onToggleHLR(!1)},e=m([i.b],e)}(r.Component);e.b=k},1174:function(t,e,n){"use strict";var o,r,i=n(1188),a=n(105),s=n(11),c=n(285),l=n(150),u=(n(1189),o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),p=function(){return(p=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},d=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},h=function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(t);r<o.length;r++)e.indexOf(o[r])<0&&(n[o[r]]=t[o[r]])}return n};!function(t){t.UP="up",t.DOWN="down"}(r||(r={}));var f=function(t){function e(e){var n=t.call(this,e)||this;return n.onOutsideClick=function(t){n.toggleDropdown(!1)},n.onToggleClick=function(t){t.stopPropagation(),n.toggleDropdown()},n.onTransitionEnd=function(t){t&&t.target!==t.currentTarget||(window.clearTimeout(n.transitionTimeout),n.setState({transitioning:!1}))},n.toggleDropdown=function(t){var e=n.state.open,o=void 0!==t?t:!e;o?window.addEventListener("click",n.onOutsideClick):window.removeEventListener("click",n.onOutsideClick),n.transitionTimeout=window.setTimeout(n.onTransitionEnd,1e3),n.setState({open:o,transitioning:!0})},n.state={open:!1,transitioning:!1},n}return u(e,t),e.prototype.componentWillUnmount=function(){window.removeEventListener("click",this.onOutsideClick)},e.prototype.render=function(){var t=this.state,e=t.open,n=t.transitioning,o=this.props,i=o.children,l=o.className,u=o.direction,d=h(o,["children","className","direction"]),f={up:u===r.UP,open:e,transitioning:n};return Object(s.h)("div",p({className:a("dropdown",f,l)},d),Object(s.h)("div",{className:"dropdown-mask"},Object(s.h)("div",{className:"dropdown-menu",onTransitionEnd:this.onTransitionEnd},i)),Object(s.h)("div",{className:"dropdown-toggle"},Object(s.h)(c.a,{iconClass:"icon-toolbar-more-horiz",onClick:this.onToggleClick,appendClass:{"dropdown-toggle":!0}})))},e.defaultProps={direction:r.DOWN},e=d([l.b],e)}(s.Component);n(1191);n.d(e,"a",(function(){return m}));var g=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),b=function(){return(b=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},v=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},y=function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(t);r<o.length;r++)e.indexOf(o[r])<0&&(n[o[r]]=t[o[r]])}return n},m=function(t){function e(e){var n=t.call(this,e)||this;return n.onResize=function(){n.update()},n.setContentRef=function(t){n.contentRef=t},n.setCollapsedRef=function(t){n.collapsedRef=t},n.setToggleRef=function(t){n.toggleRef=t},n.state={collapsed:!1},n.observer=new i.a(n.onResize),n}return g(e,t),e.prototype.componentDidMount=function(){this.connectObserver(),this.update()},e.prototype.componentDidUpdate=function(){this.update()},e.prototype.componentWillUnmount=function(){this.disconnectObserver(),this.reset()},e.prototype.connectObserver=function(){this.observer.observe(this.contentRef)},e.prototype.disconnectObserver=function(){this.observer&&this.observer.disconnect()},e.prototype.reset=function(){if(this.contentRef){var t=this.contentRef.querySelectorAll(".collapsed");Array.from(t).forEach((function(t){return t.classList.remove("collapsed")}))}},e.prototype.update=function(){if(this.contentRef&&this.collapsedRef&&this.toggleRef){var t=this.contentRef.children,e=this.collapsedRef.children;if(t&&t.length===e.length){for(var n=this.state.collapsed,o=this.contentRef.offsetWidth,r=this.toggleRef.base&&this.toggleRef.base.offsetWidth||0,i=0,a=0,s=0;s<t.length;s++){var c=t[s].offsetWidth||0;a||s!==t.length-1||(c-=r),(i+=c)<=o?(t[s].classList.remove("collapsed"),e[s].classList.add("collapsed")):(a++,t[s].classList.add("collapsed"),e[s].classList.remove("collapsed"))}!!a!==n&&this.setState({collapsed:!n})}}},e.prototype.render=function(){var t=this.props,e=t.children,n=t.className,o=y(t,["children","className"]),i="collapsible-list "+n,c={hidden:!this.state.collapsed};return e&&Array.isArray(e)?Object(s.h)("div",b({className:a(i)},o),Object(s.h)("div",{ref:this.setContentRef,class:"collapsible-list-items"},e),Object(s.h)(f,{ref:this.setToggleRef,direction:r.UP,className:a(c)},Object(s.h)("div",{ref:this.setCollapsedRef,class:"collapsible-list-menu"},e))):{children:e}},e.defaultProps={},e=v([l.b],e)}(s.Component)},1175:function(t,e,n){"use strict";var o,r=n(11),i=n(2),a=n(32),s=n(244),c=n(18),l=n(35),u=n(910),p=n(0),d=n(98),h=n(112),f=n(320),g=n(164),b=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),v=function(t){function e(e){return t.call(this,e)||this}return b(e,t),e.prototype.render=function(){var t=this.props,e=t.sid,n=t.position,o=t.text,i=t.readOnlyText,a=t.rotation,s=t.visible,c={left:n.x+"px",top:n.y+"px",transform:a?"translate(-50%, -50%) rotate("+a+"deg) ":"translate(-50%, -50%)"},l=i?o+" "+i:o;return s?Object(r.h)("div",{id:e,class:"label",style:c},Object(r.h)("span",null,l)):null},e}(r.Component);n.d(e,"a",(function(){return C}));var y=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),m=function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function a(t){try{c(o.next(t))}catch(t){i(t)}}function s(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){t.done?r(t.value):new n((function(e){e(t.value)})).then(a,s)}c((o=o.apply(t,e||[])).next())}))},O=function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},w=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},S=new i.a("label-ui"),C=function(t){function e(e){var n=t.call(this,e)||this;return n.subscriptions=[],n.reusableVector=new p.Jc,n.inFloorPlan=function(t){return t===a.b.FLOORPLAN},n.onCameraUpdate=function(){n.inFloorPlan(n.props.viewmode)&&n.updateLabelPositions()},n.onViewTransitionStart=function(){n.setState({inModeTransition:!0})},n.onViewTransitionEnd=function(t){return m(n,void 0,void 0,(function(){return O(this,(function(e){return this.inFloorPlan(Object(a.c)(t.toMode))&&(this.setState({inModeTransition:!1}),this.updateLabelPositions()),[2]}))}))},n.updateFloorState=function(){n.setState({currentFloor:n.floorsViewData.currentFloor,topMostFloor:n.floorsViewData.totalFloors-1})},n.updateLabelPositions=function(){return m(n,void 0,void 0,(function(){var t,e,n,o,r,i,a,s;return O(this,(function(c){switch(c.label){case 0:n={},c.label=1;case 1:c.trys.push([1,6,7,8]),o=w(this.labelData.getCollection()),r=o.next(),c.label=2;case 2:return r.done?[3,5]:(i=r.value,this.reusableVector.set(i.position.x,i.position.y,i.position.z),[4,this.context.commandBinder.issueCommand(new u.a({worldPosition:this.reusableVector}))]);case 3:a=c.sent(),n[i.sid]=Object.assign({screenPosition:a},i),c.label=4;case 4:return r=o.next(),[3,2];case 5:return[3,8];case 6:return s=c.sent(),t={error:s},[3,8];case 7:try{r&&!r.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}return[7];case 8:return this.setState({labelPositions:n}),[2]}}))}))},n.clearVisibleFloor=function(){n.setState({currentFloor:void 0})},n.updateVisibleFloor=function(t){n.setState({currentFloor:t.floorIndex})},n.setState({labelPositions:{},currentFloor:-1,topMostFloor:0,inModeTransition:!1}),n}return y(e,t),e.prototype.componentDidMount=function(){return m(this,void 0,void 0,(function(){var t,e,n,o,r,i;return O(this,(function(a){switch(a.label){case 0:t=this.context.messageBus,a.label=1;case 1:return a.trys.push([1,4,,5]),e=this,[4,this.context.market.waitForData(l.b)];case 2:return e.floorsViewData=a.sent(),n=this.floorsViewData.onChanged(this.updateFloorState),this.subscriptions.push(n),this.updateFloorState(),o=this,[4,this.context.market.waitForData(s.a)];case 3:return o.labelData=a.sent(),[3,5];case 4:return r=a.sent(),S.debug(r),[3,5];case 5:return this.updateLabelPositions(),[4,this.context.market.waitForData(c.a)];case 6:return i=a.sent(),this.subscriptions.push(i.onChanged(this.onCameraUpdate),t.subscribe(f.a,this.clearVisibleFloor),t.subscribe(g.a,this.updateVisibleFloor),t.subscribe(h.a,this.onViewTransitionStart),t.subscribe(d.a,this.onViewTransitionEnd)),this.subscriptions.forEach((function(t){return t.renew()})),[2]}}))}))},e.prototype.componentWillUnmount=function(){this.subscriptions.forEach((function(t){return t.cancel()}))},e.prototype.renderLabel=function(t){var e=this.state,n=e.currentFloor,o=e.topMostFloor,i=e.labelPositions[t],a=i.floor,s=i.screenPosition,c=i.text,u=i.visible,p=i.sid,d=i.rotation;return Object(r.h)(v,{key:p,position:s,rotation:d,text:c,visible:(n===l.a&&o===a||n===a)&&u,sid:p})},e.prototype.render=function(){var t=this,e=this.state,n=e.inModeTransition,o=e.labelPositions,i=this.props.viewmode;if(!this.inFloorPlan(i)||n)return null;var a=[];return Object.keys(o).forEach((function(e){a.push(t.renderLabel(e))})),Object(r.h)("div",{class:"overlay-layer labels-layer"},a)},e}(r.Component)},1176:function(t,e,n){},1178:function(t,e,n){},1180:function(t,e,n){},1183:function(t,e,n){},1189:function(t,e,n){},1191:function(t,e,n){},1211:function(t,e,n){},1213:function(t,e,n){},1215:function(t,e,n){t.exports=n.p+"images/escape.png"},964:function(t,e,n){"use strict";var o;n.d(e,"a",(function(){return o})),function(t){t.TERMS="terms",t.VR_SELECT="vrSelect",t.MATTERTAG="mattertag",t.MATTERTAG_EMBED="mattertagEmbLink",t.HELP="help",t.CTA="cta",t.MEASUREMENT_HELP="measurementModeHelp",t.SHARE="share"}(o||(o={}))},986:function(t,e,n){"use strict";var o,r=n(11),i=n(105),a=n(7),s=n(464),c=n(78),l=n(636),u=n(637),p=n(620),d=n(57),h=n(201),f=n(285),g=n(106),b=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});r.options.debounceRendering=requestAnimationFrame;var v=function(t){function e(e){var n=t.call(this,e)||this;return n.dragStartScroll=0,n.listening=!1,n.animation=null,n.handlingPaused=!1,n.handleEvent=function(t){"mousedown"!==t.type&&"pointerdown"!==t.type&&"touchstart"!==t.type||(n.handlingPaused=!1),n.props.suppressDrag||n.handlingPaused||n.inputFilter.handleEvent(t)},n.getScrolledOffset=function(){if(!n.innerWrapper&&0===n.state.contentSize)return 0;var t=n.props.direction===c.b.vertical?"scrollTop":"scrollLeft";return n.innerWrapper[t]/n.state.contentSize},n.getScrollableContainer=function(){return n.innerWrapper},n.pauseScrollHandling=function(){n.handlingPaused=!0,n.toggleDownEventListening(!1)},n.scrollWithScrollBar=function(t){if(!n.props.suppressDrag){var e=n.getAxis();t.hasOwnProperty(e)&&n.scrollTo(t[e])}},n.scrollTo=function(t){void 0===t||isNaN(t)||(n.setScrollPosition(Math.max(Math.min(1,t)*n.state.contentSize,0)),n.setState({scrollOffset:n.getScrollPosition()}))},n.handleDragStart=function(){n.setState({scrollCenter:null})},n.handlePressStart=function(){n.dragStartScroll=n.getScrollPosition()},n.handlePressMove=function(t){if(!n.props.suppressDrag){var e=(t[n.getAxis()]+n.dragStartScroll)/n.state.contentSize;n.scrollTo(e)}},n.handleWheelEvent=function(t){n.props.suppressDrag?t.preventDefault():n.props.direction===c.b.horizontal&&0===t.deltaX&&0!==t.deltaY?(n.handlePressStart(),n.handlePressMove({x:t.deltaY,y:0})):(n.setState({scrollCenter:null}),n.handleExternalChange())},n.handleClick=function(t){n.props.handleClick&&n.props.handleClick(t)},n.handleDragEnd=function(t,e){var o=t[n.getAxis()]/e,r=Math.min(c.d,Math.abs(c.d*o)),i=n.getScrollPosition(),a=o*r/2;n.animation=new u.a({duration:r,startValue:i/n.state.contentSize,endValue:Math.max(0,Math.min((i+a)/n.state.contentSize,1)),easingFunction:d.h})},n.onManualScroll=function(){n.props.onScrolled&&n.props.onScrolled()},n.onButtonScroll=function(t){if(n.contentContainer&&n.props.steps){var e=n.props.direction===c.b.vertical?"offsetHeight":"offsetWidth",o=n.contentContainer[e]/n.props.steps,r=n.getScrollPosition(),i=void 0;i=t?(r+o)/n.state.contentSize:(r-o)/n.state.contentSize,n.scrollTo(Object(a.e)(i,0,1))}},n.onScrollBack=function(){n.onButtonScroll(!1)},n.onScrollForward=function(){n.onButtonScroll(!0)},n.onHoldScrollBack=function(){n.mouseInterval=window.setInterval(n.onScrollBack,300)},n.onHoldScrollForward=function(){n.mouseInterval=window.setInterval(n.onScrollForward,300)},n.onScrollButtonUp=function(){window.clearInterval(n.mouseInterval)},n.renderScrollBackButton=function(){var t=n.getScrollPosition(),e=n.props.direction===c.b.vertical?"icon-dpad-up":"icon-dpad-left",o=0===t?g.c.DISABLED:g.c.ENABLED;return Object(r.h)(f.a,{appendClass:{"scroll-button":!0,"scroll-back":!0},iconClass:e,buttonStyle:f.b.CLEAR,buttonState:o,onClick:n.onScrollBack,onMouseDown:n.onHoldScrollBack,onMouseUp:n.onScrollButtonUp})},n.renderScrollForwardButton=function(){var t=n.getScrollPosition(),e=n.props.direction===c.b.vertical?"offsetHeight":"offsetWidth",o=n.props.direction===c.b.vertical?"icon-dpad-down":"icon-dpad-right",i=n.contentContainer[e]-n.innerWrapper[e]-t>0?g.c.ENABLED:g.c.DISABLED;return Object(r.h)(f.a,{appendClass:{"scroll-button":!0,"scroll-forward":!0},iconClass:o,buttonStyle:f.b.CLEAR,buttonState:i,onClick:n.onScrollForward,onMouseDown:n.onHoldScrollForward,onMouseUp:n.onScrollButtonUp})},n.setOuterWrapper=function(t){return n.outerWrapper=t},n.setInnerWrapper=function(t){return n.innerWrapper=t},n.setcontentContainer=function(t){return n.contentContainer=t},n.state={scrollCenter:null,scrollOffset:0,innerSize:0,contentSize:0},n.resizeSubscription=Object(h.c)(h.b.RESIZE,(function(){return n.handleExternalChange(h.b.RESIZE)})),n.inputFilter=new p.a({handlePressStart:n.handlePressStart,handlePressMove:n.handlePressMove,handleDragStart:n.handleDragStart,handleDragEnd:n.handleDragEnd,handleClick:n.handleClick}),n}return b(e,t),e.prototype.componentDidMount=function(){this.resizeSubscription.renew(),this.props.thumbScrollingOnly?this.innerWrapper.addEventListener("click",this.handleClick):this.toggleDownEventListening(!0),this.toggleDragHandling(!0),this.innerWrapper.addEventListener("wheel",this.handleWheelEvent),this.inputFilter.setEnabled(!this.props.suppressDrag),this.handleExternalChange()},e.prototype.componentWillUnmount=function(){this.resizeSubscription.cancel(),this.innerWrapper.removeEventListener("wheel",this.handleWheelEvent),this.toggleDragHandling(!1),this.props.thumbScrollingOnly?this.innerWrapper.removeEventListener("click",this.handleClick):this.toggleDownEventListening(!1)},e.prototype.componentWillReceiveProps=function(t){t.thumbScrollingOnly&&!this.props.thumbScrollingOnly?(this.innerWrapper.addEventListener("click",this.handleClick),this.toggleDownEventListening(!1)):!t.thumbScrollingOnly&&this.props.thumbScrollingOnly&&(this.toggleDownEventListening(!0),this.innerWrapper.removeEventListener("click",this.handleClick)),t.suppressDrag!==this.props.suppressDrag&&this.inputFilter.setEnabled(!t.suppressDrag)},e.prototype.componentDidUpdate=function(t,e){var n=this,o=this.animation;if(o)if(o.isAnimating){var r=o.getUpdatedValue();window.requestAnimationFrame((function(){n.innerWrapper&&n.scrollTo(r)}))}else this.animation=null;e.scrollOffset!==this.state.scrollOffset&&this.props.onScrolled&&this.props.onScrolled()},e.prototype.toggleDownEventListening=function(t){var e=this.handleEvent;t?window.PointerEvent?this.innerWrapper.addEventListener("pointerdown",e):(this.innerWrapper.addEventListener("mousedown",e),this.innerWrapper.addEventListener("touchstart",e)):window.PointerEvent?this.innerWrapper.removeEventListener("pointerdown",e):(this.innerWrapper.removeEventListener("mousedown",e),this.innerWrapper.removeEventListener("touchstart",e))},e.prototype.toggleDragHandling=function(t){var e=this.handleEvent;!this.listening&&t?(this.listening=!0,window.PointerEvent?(window.addEventListener("pointermove",e),window.addEventListener("pointerup",e)):(window.addEventListener("mousemove",e),window.addEventListener("mouseleave",e),window.addEventListener("mouseup",e),window.addEventListener("touchmove",e),window.addEventListener("touchend",e),window.addEventListener("touchcancel",e))):this.listening&&!t&&(this.listening=!1,window.PointerEvent?(window.removeEventListener("pointermove",e),window.removeEventListener("pointerup",e)):(window.removeEventListener("mousemove",e),window.removeEventListener("mouseleave",e),window.removeEventListener("mouseup",e),window.removeEventListener("touchmove",e),window.removeEventListener("touchend",e),window.removeEventListener("touchcancel",e)))},e.prototype.getScrollPosition=function(){if(!this.innerWrapper)return 0;var t=this.props.direction===c.b.vertical?"scrollTop":"scrollLeft";return this.innerWrapper[t]},e.prototype.setScrollPosition=function(t){if(this.innerWrapper){var e=this.props.direction===c.b.vertical?"scrollTop":"scrollLeft";this.innerWrapper[e]=t}},e.prototype.getAxis=function(){return this.props.direction===c.b.vertical?"y":"x"},e.prototype.getSnapshotBeforeUpdate=function(){this.props.waitToUpdate||this.handleExternalChange()},e.prototype.scrollToPercentage=function(t,e){this.animation=new u.a({duration:e,startValue:this.getScrolledOffset(),endValue:Math.max(0,Math.min(1,t))})},e.prototype.scrollToElement=function(t){if(t&&t.compareDocumentPosition(this.innerWrapper)&Node.DOCUMENT_POSITION_CONTAINS){var e=this.props.direction===c.b.vertical;this.setState({scrollCenter:t});for(var n=e?"offsetTop":"offsetLeft",o=e?"offsetHeight":"offsetWidth",r=t[n]+t[o]/2,i=t;i.parentElement&&i!==this.innerWrapper;)r+=(i=i.parentElement)[n];var a=(r-this.outerWrapper.parentElement[o]/2)/this.state.contentSize;this.animation=new u.a({duration:c.d,startValue:this.getScrollPosition()/this.state.contentSize,endValue:Math.max(0,Math.min(1,a))})}},e.prototype.handleExternalChange=function(t){if(this.innerWrapper&&this.contentContainer){this.state.scrollCenter&&t&&t===h.b.RESIZE&&this.scrollToElement(this.state.scrollCenter);var e=this.props.direction===c.b.vertical?"clientHeight":"clientWidth",n={innerSize:Number(this.innerWrapper&&this.innerWrapper[e])||1,contentSize:Number(this.contentContainer&&this.contentContainer[e])||1,scrollOffset:this.innerWrapper&&this.getScrollPosition()};Object(s.a)(this.state,n)&&this.setState(n)}},e.prototype.needScrolling=function(){if(!this.contentContainer||!this.outerWrapper)return!1;var t=this.props.direction===c.b.vertical?"offsetHeight":"offsetWidth";return this.contentContainer[t]>this.outerWrapper[t]},e.prototype.render=function(){var t=this.props,e=t.hideScrollbar,n=t.children,o=t.onScrollableChanged,a=t.scrollButtons,s=t.steps,c=t.onScrollPositionChange,u=t.direction,p=t.className,d=this.state,h=d.innerSize,f=d.contentSize,g=d.scrollOffset,b=a&&!!s&&this.needScrolling();return Object(r.h)("div",{class:i("outerScrollbarWrapper",[u],[p],{"button-scrolling":b}),ref:this.setOuterWrapper},b&&this.renderScrollBackButton(),Object(r.h)("div",{class:"innerScrollbarWrapper",ref:this.setInnerWrapper},Object(r.h)("div",{class:"paddingScrollbarWrapper",ref:this.setcontentContainer},n)),Object(r.h)(l.a,{direction:u,wrapperLength:h,childLength:f,scrollOffset:g,scrollTo:this.scrollWithScrollBar,forceHidden:!!e,onVisibilityChange:o,onScrollPositionChange:c,onThumbDrag:this.onManualScroll}),b&&this.renderScrollForwardButton())},e}(r.Component);e.a=v}}]);